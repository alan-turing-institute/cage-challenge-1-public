{"episode_reward_max": -3.4, "episode_reward_min": -54.00000000000004, "episode_reward_mean": -11.520000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.1, -54.00000000000004, -5.3, -4.300000000000001, -4.300000000000001, -14.499999999999998, -9.7, -7.3999999999999995, -3.8000000000000007, -19.099999999999994, -8.399999999999999, -19.600000000000044, -6.3, -13.2, -3.4, -11.199999999999998, -7.699999999999999, -4.4, -6.4, -3.4, -12.7, -12.6, -15.799999999999999, -4.2, -5.2, -8.199999999999998, -3.4, -8.5, -7.0, -27.5, -3.4000000000000004, -12.600000000000001, -14.799999999999997, -31.2, -12.099999999999998, -9.399999999999999, -16.799999999999997, -21.2, -4.4, -9.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9479452441860508, "mean_inference_ms": 1.2444980613716117, "mean_action_processing_ms": 0.06840701822515254, "mean_env_wait_ms": 5.683699092426739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1588000, "timesteps_this_iter": 0, "agent_timesteps_total": 1588000, "timers": {"sample_time_ms": 8371.499, "sample_throughput": 477.812, "load_time_ms": 0.336, "load_throughput": 11898734.752, "learn_time_ms": 7350.747, "learn_throughput": 544.162, "update_time_ms": 2.05}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.21614360666373164, "policy_loss": -0.009185373448636583, "vf_loss": 22.379256873361527, "vf_explained_var": 0.24715070897533048, "kl": 0.007682076020847668, "entropy": 0.18980005460400734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1588000, "num_agent_steps_sampled": 1588000, "num_steps_trained": 1588000, "num_agent_steps_trained": 1588000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16040, "training_iteration": 397, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-13-59", "timestamp": 1643703239, "time_this_iter_s": 15.604084968566895, "time_total_s": 12275.112962007523, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15.604084968566895, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.791304347826085, "ram_util_percent": 67.59130434782605}}
{"episode_reward_max": -3.2, "episode_reward_min": -54.00000000000004, "episode_reward_mean": -11.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.1, -54.00000000000004, -5.3, -4.300000000000001, -4.300000000000001, -14.499999999999998, -9.7, -7.3999999999999995, -3.8000000000000007, -19.099999999999994, -8.399999999999999, -19.600000000000044, -6.3, -13.2, -3.4, -11.199999999999998, -7.699999999999999, -4.4, -6.4, -3.4, -12.7, -12.6, -15.799999999999999, -4.2, -5.2, -8.199999999999998, -3.4, -8.5, -7.0, -27.5, -3.4000000000000004, -12.600000000000001, -14.799999999999997, -31.2, -12.099999999999998, -9.399999999999999, -16.799999999999997, -21.2, -4.4, -9.3, -5.1000000000000005, -5.4, -7.4, -5.3, -27.60000000000001, -7.2, -9.399999999999991, -8.799999999999997, -11.399999999999999, -4.2, -20.999999999999996, -16.9, -16.5, -13.3, -24.10000000000001, -3.3, -18.799999999999997, -3.8000000000000003, -15.2, -16.599999999999998, -4.3, -8.099999999999998, -10.9, -10.3, -19.8, -16.4, -25.9, -20.0, -14.8, -18.400000000000002, -6.6, -3.2, -5.300000000000001, -11.199999999999998, -5.300000000000001, -3.2, -6.300000000000001, -18.3, -20.3, -20.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9735399862619312, "mean_inference_ms": 1.288937065543156, "mean_action_processing_ms": 0.07047951848013827, "mean_env_wait_ms": 5.881080583246503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1592000, "timesteps_this_iter": 0, "agent_timesteps_total": 1592000, "timers": {"sample_time_ms": 12518.259, "sample_throughput": 319.533, "load_time_ms": 0.381, "load_throughput": 10508747.886, "learn_time_ms": 8161.805, "learn_throughput": 490.088, "update_time_ms": 2.222}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10600458493441223, "policy_loss": -0.00957328058699126, "vf_loss": 11.377812603660809, "vf_explained_var": 0.2070203149190513, "kl": 0.00899871562644956, "entropy": 0.17398154616195668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1592000, "num_agent_steps_sampled": 1592000, "num_steps_trained": 1592000, "num_agent_steps_trained": 1592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16080, "training_iteration": 398, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-14-17", "timestamp": 1643703257, "time_this_iter_s": 18.244585037231445, "time_total_s": 12293.357547044754, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 33.84867000579834, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.83076923076923, "ram_util_percent": 67.6076923076923}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.40000000000001, "episode_reward_mean": -11.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.7, -12.6, -15.799999999999999, -4.2, -5.2, -8.199999999999998, -3.4, -8.5, -7.0, -27.5, -3.4000000000000004, -12.600000000000001, -14.799999999999997, -31.2, -12.099999999999998, -9.399999999999999, -16.799999999999997, -21.2, -4.4, -9.3, -5.1000000000000005, -5.4, -7.4, -5.3, -27.60000000000001, -7.2, -9.399999999999991, -8.799999999999997, -11.399999999999999, -4.2, -20.999999999999996, -16.9, -16.5, -13.3, -24.10000000000001, -3.3, -18.799999999999997, -3.8000000000000003, -15.2, -16.599999999999998, -4.3, -8.099999999999998, -10.9, -10.3, -19.8, -16.4, -25.9, -20.0, -14.8, -18.400000000000002, -6.6, -3.2, -5.300000000000001, -11.199999999999998, -5.300000000000001, -3.2, -6.300000000000001, -18.3, -20.3, -20.5, -13.499999999999986, -4.300000000000001, -4.4, -7.999999999999998, -21.6, -13.5, -18.0, -10.4, -19.299999999999997, -4.0, -8.600000000000001, -11.2, -3.4, -9.399999999999997, -13.699999999999978, -3.4, -9.3, -12.600000000000001, -33.40000000000001, -25.5, -22.6, -5.300000000000001, -10.3, -5.300000000000001, -13.5, -4.4, -20.5, -7.4, -3.3, -5.2, -3.3, -20.0, -12.0, -4.8999999999999995, -23.80000000000003, -12.9, -7.3, -4.300000000000001, -15.299999999999992, -9.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0059958977963492, "mean_inference_ms": 1.3220986304391849, "mean_action_processing_ms": 0.07206010101817004, "mean_env_wait_ms": 6.022372431332632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1596000, "timesteps_this_iter": 0, "agent_timesteps_total": 1596000, "timers": {"sample_time_ms": 14360.044, "sample_throughput": 278.551, "load_time_ms": 0.37, "load_throughput": 10800782.833, "learn_time_ms": 8162.688, "learn_throughput": 490.035, "update_time_ms": 2.2}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09351862750406707, "policy_loss": -0.009105070748476572, "vf_loss": 10.118365769424747, "vf_explained_var": 0.317449031401706, "kl": 0.007200208511477575, "entropy": 0.1643340110618581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1596000, "num_agent_steps_sampled": 1596000, "num_steps_trained": 1596000, "num_agent_steps_trained": 1596000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16120, "training_iteration": 399, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-14-34", "timestamp": 1643703274, "time_this_iter_s": 17.20403289794922, "time_total_s": 12310.561579942703, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 51.05270290374756, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.84166666666667, "ram_util_percent": 67.54583333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.40000000000001, "episode_reward_mean": -11.100000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -8.099999999999998, -10.9, -10.3, -19.8, -16.4, -25.9, -20.0, -14.8, -18.400000000000002, -6.6, -3.2, -5.300000000000001, -11.199999999999998, -5.300000000000001, -3.2, -6.300000000000001, -18.3, -20.3, -20.5, -13.499999999999986, -4.300000000000001, -4.4, -7.999999999999998, -21.6, -13.5, -18.0, -10.4, -19.299999999999997, -4.0, -8.600000000000001, -11.2, -3.4, -9.399999999999997, -13.699999999999978, -3.4, -9.3, -12.600000000000001, -33.40000000000001, -25.5, -22.6, -5.300000000000001, -10.3, -5.300000000000001, -13.5, -4.4, -20.5, -7.4, -3.3, -5.2, -3.3, -20.0, -12.0, -4.8999999999999995, -23.80000000000003, -12.9, -7.3, -4.300000000000001, -15.299999999999992, -9.2, -9.4, -5.699999999999999, -11.2, -10.8, -8.2, -4.2, -7.4, -18.59999999999999, -9.5, -11.799999999999999, -3.3, -6.300000000000001, -9.999999999999998, -7.099999999999999, -15.2, -9.3, -7.799999999999998, -3.2, -17.5, -18.200000000000003, -4.2, -11.099999999999998, -13.899999999999999, -14.299999999999997, -4.800000000000001, -9.799999999999997, -5.800000000000001, -3.3, -14.299999999999999, -10.799999999999997, -14.3, -21.900000000000006, -19.7, -5.4, -9.4, -5.0, -10.399999999999999, -7.2, -10.4, -11.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0184158957912788, "mean_inference_ms": 1.3307198837226857, "mean_action_processing_ms": 0.07223368209697732, "mean_env_wait_ms": 6.038856733974655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1600000, "timesteps_this_iter": 0, "agent_timesteps_total": 1600000, "timers": {"sample_time_ms": 14755.26, "sample_throughput": 271.09, "load_time_ms": 0.367, "load_throughput": 10899604.353, "learn_time_ms": 7906.171, "learn_throughput": 505.934, "update_time_ms": 1.969}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.058478635216071724, "policy_loss": -0.015177873736347562, "vf_loss": 7.231895672954539, "vf_explained_var": 0.29264691446417124, "kl": 0.006687768559173957, "entropy": 0.1758907472454412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1600000, "num_agent_steps_sampled": 1600000, "num_steps_trained": 1600000, "num_agent_steps_trained": 1600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16160, "training_iteration": 400, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-14-49", "timestamp": 1643703289, "time_this_iter_s": 14.8770010471344, "time_total_s": 12325.438580989838, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 65.92970395088196, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.28636363636363, "ram_util_percent": 67.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -26.2, "episode_reward_mean": -10.675999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.6, -5.300000000000001, -10.3, -5.300000000000001, -13.5, -4.4, -20.5, -7.4, -3.3, -5.2, -3.3, -20.0, -12.0, -4.8999999999999995, -23.80000000000003, -12.9, -7.3, -4.300000000000001, -15.299999999999992, -9.2, -9.4, -5.699999999999999, -11.2, -10.8, -8.2, -4.2, -7.4, -18.59999999999999, -9.5, -11.799999999999999, -3.3, -6.300000000000001, -9.999999999999998, -7.099999999999999, -15.2, -9.3, -7.799999999999998, -3.2, -17.5, -18.200000000000003, -4.2, -11.099999999999998, -13.899999999999999, -14.299999999999997, -4.800000000000001, -9.799999999999997, -5.800000000000001, -3.3, -14.299999999999999, -10.799999999999997, -14.3, -21.900000000000006, -19.7, -5.4, -9.4, -5.0, -10.399999999999999, -7.2, -10.4, -11.899999999999999, -7.300000000000001, -7.3, -11.8, -4.300000000000001, -8.399999999999999, -13.7, -17.0, -23.0, -4.2, -13.3, -16.8, -15.799999999999999, -12.399999999999997, -13.5, -7.4, -9.2, -6.899999999999999, -13.599999999999978, -8.2, -7.300000000000001, -24.7, -7.300000000000001, -12.899999999999999, -13.099999999999996, -26.2, -3.4, -4.300000000000001, -12.399999999999999, -5.300000000000001, -11.1, -6.4, -7.2, -4.4, -10.4, -16.399999999999977, -3.5, -23.299999999999997, -11.499999999999995, -22.700000000000003, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9989752968342682, "mean_inference_ms": 1.3119588959479664, "mean_action_processing_ms": 0.07111706692339012, "mean_env_wait_ms": 5.944012078505565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1604000, "timesteps_this_iter": 0, "agent_timesteps_total": 1604000, "timers": {"sample_time_ms": 14838.894, "sample_throughput": 269.562, "load_time_ms": 0.354, "load_throughput": 11305401.617, "learn_time_ms": 7714.638, "learn_throughput": 518.495, "update_time_ms": 1.873}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08061117896389576, "policy_loss": -0.01740397886893842, "vf_loss": 9.695665509854594, "vf_explained_var": 0.44101220318066175, "kl": 0.005292521562872085, "entropy": 0.16418171262228362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1604000, "num_agent_steps_sampled": 1604000, "num_steps_trained": 1604000, "num_agent_steps_trained": 1604000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16200, "training_iteration": 401, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-15-04", "timestamp": 1643703304, "time_this_iter_s": 14.953686952590942, "time_total_s": 12340.392267942429, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 80.8833909034729, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.03809523809524, "ram_util_percent": 67.40952380952383}}
{"episode_reward_max": -1.3, "episode_reward_min": -35.2, "episode_reward_mean": -10.656999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -11.099999999999998, -13.899999999999999, -14.299999999999997, -4.800000000000001, -9.799999999999997, -5.800000000000001, -3.3, -14.299999999999999, -10.799999999999997, -14.3, -21.900000000000006, -19.7, -5.4, -9.4, -5.0, -10.399999999999999, -7.2, -10.4, -11.899999999999999, -7.300000000000001, -7.3, -11.8, -4.300000000000001, -8.399999999999999, -13.7, -17.0, -23.0, -4.2, -13.3, -16.8, -15.799999999999999, -12.399999999999997, -13.5, -7.4, -9.2, -6.899999999999999, -13.599999999999978, -8.2, -7.300000000000001, -24.7, -7.300000000000001, -12.899999999999999, -13.099999999999996, -26.2, -3.4, -4.300000000000001, -12.399999999999999, -5.300000000000001, -11.1, -6.4, -7.2, -4.4, -10.4, -16.399999999999977, -3.5, -23.299999999999997, -11.499999999999995, -22.700000000000003, -6.300000000000001, -19.700000000000006, -13.799999999999999, -11.999999999999998, -5.8999999999999995, -14.0, -9.7, -4.2, -6.300000000000001, -5.4, -4.300000000000001, -8.3, -6.399999999999999, -6.300000000000001, -19.099999999999998, -12.899999999999999, -6.199999999999999, -4.3, -5.8999999999999995, -3.3, -11.5, -3.3000000000000003, -4.2, -13.9, -5.0, -13.599999999999989, -9.7, -20.8, -4.2, -5.300000000000001, -35.2, -6.2, -1.3, -18.4, -12.5, -19.2, -21.9, -11.599999999999998, -2.4000000000000004, -4.3, -11.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.989502279950625, "mean_inference_ms": 1.2972686967544362, "mean_action_processing_ms": 0.07022748300371945, "mean_env_wait_ms": 5.869263737940998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1608000, "timesteps_this_iter": 0, "agent_timesteps_total": 1608000, "timers": {"sample_time_ms": 14941.008, "sample_throughput": 267.72, "load_time_ms": 0.357, "load_throughput": 11218466.065, "learn_time_ms": 7629.924, "learn_throughput": 524.252, "update_time_ms": 1.846}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11652891858010202, "policy_loss": -0.006707198229888755, "vf_loss": 12.197818526962111, "vf_explained_var": 0.16089236896525147, "kl": 0.0062896824811136945, "entropy": 0.14994939588090425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1608000, "num_agent_steps_sampled": 1608000, "num_steps_trained": 1608000, "num_agent_steps_trained": 1608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16240, "training_iteration": 402, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-15-20", "timestamp": 1643703320, "time_this_iter_s": 15.67662262916565, "time_total_s": 12356.068890571594, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 96.56001353263855, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.199999999999996, "ram_util_percent": 67.48636363636363}}
{"episode_reward_max": -1.3, "episode_reward_min": -35.2, "episode_reward_mean": -10.174, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.7, -7.300000000000001, -12.899999999999999, -13.099999999999996, -26.2, -3.4, -4.300000000000001, -12.399999999999999, -5.300000000000001, -11.1, -6.4, -7.2, -4.4, -10.4, -16.399999999999977, -3.5, -23.299999999999997, -11.499999999999995, -22.700000000000003, -6.300000000000001, -19.700000000000006, -13.799999999999999, -11.999999999999998, -5.8999999999999995, -14.0, -9.7, -4.2, -6.300000000000001, -5.4, -4.300000000000001, -8.3, -6.399999999999999, -6.300000000000001, -19.099999999999998, -12.899999999999999, -6.199999999999999, -4.3, -5.8999999999999995, -3.3, -11.5, -3.3000000000000003, -4.2, -13.9, -5.0, -13.599999999999989, -9.7, -20.8, -4.2, -5.300000000000001, -35.2, -6.2, -1.3, -18.4, -12.5, -19.2, -21.9, -11.599999999999998, -2.4000000000000004, -4.3, -11.1, -13.9, -8.999999999999998, -14.799999999999999, -9.500000000000002, -5.9, -15.099999999999996, -19.4, -15.1, -3.3, -5.300000000000001, -5.3, -6.300000000000001, -15.799999999999999, -16.599999999999998, -4.3, -10.2, -4.800000000000001, -8.9, -12.399999999999999, -5.300000000000001, -5.4, -5.300000000000001, -4.4, -4.2, -24.800000000000004, -12.4, -11.500000000000002, -3.4, -5.3, -3.4, -5.0, -4.300000000000001, -14.799999999999999, -7.199999999999999, -12.600000000000001, -7.200000000000001, -9.3, -24.0, -3.3, -11.999999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9878579138222119, "mean_inference_ms": 1.2864250125991525, "mean_action_processing_ms": 0.06958581557410588, "mean_env_wait_ms": 5.815143115460455, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1612000, "timesteps_this_iter": 0, "agent_timesteps_total": 1612000, "timers": {"sample_time_ms": 14947.253, "sample_throughput": 267.608, "load_time_ms": 0.354, "load_throughput": 11303225.409, "learn_time_ms": 7609.236, "learn_throughput": 525.677, "update_time_ms": 1.79}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06482788377631736, "policy_loss": -0.012381350522440287, "vf_loss": 7.471903637596356, "vf_explained_var": 0.2545631727223755, "kl": 0.012451005862717556, "entropy": 0.19269392488384118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1612000, "num_agent_steps_sampled": 1612000, "num_steps_trained": 1612000, "num_agent_steps_trained": 1612000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16280, "training_iteration": 403, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-15-35", "timestamp": 1643703335, "time_this_iter_s": 15.230726957321167, "time_total_s": 12371.299617528915, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 111.79074048995972, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.086363636363636, "ram_util_percent": 67.5181818181818}}
{"episode_reward_max": -1.3, "episode_reward_min": -35.2, "episode_reward_mean": -10.424000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -4.2, -13.9, -5.0, -13.599999999999989, -9.7, -20.8, -4.2, -5.300000000000001, -35.2, -6.2, -1.3, -18.4, -12.5, -19.2, -21.9, -11.599999999999998, -2.4000000000000004, -4.3, -11.1, -13.9, -8.999999999999998, -14.799999999999999, -9.500000000000002, -5.9, -15.099999999999996, -19.4, -15.1, -3.3, -5.300000000000001, -5.3, -6.300000000000001, -15.799999999999999, -16.599999999999998, -4.3, -10.2, -4.800000000000001, -8.9, -12.399999999999999, -5.300000000000001, -5.4, -5.300000000000001, -4.4, -4.2, -24.800000000000004, -12.4, -11.500000000000002, -3.4, -5.3, -3.4, -5.0, -4.300000000000001, -14.799999999999999, -7.199999999999999, -12.600000000000001, -7.200000000000001, -9.3, -24.0, -3.3, -11.999999999999996, -15.099999999999998, -18.5, -9.3, -15.6, -3.3, -4.4, -4.4, -12.399999999999999, -16.5, -17.799999999999997, -7.300000000000001, -7.4, -4.300000000000001, -12.299999999999997, -24.199999999999996, -21.599999999999998, -21.0, -3.3, -14.299999999999997, -3.4, -9.6, -4.3, -6.300000000000001, -4.700000000000001, -14.2, -6.3, -3.2, -7.4, -6.299999999999999, -9.2, -7.199999999999999, -4.4, -4.4, -3.3, -7.499999999999998, -26.89999999999997, -21.999999999999996, -5.1, -26.3, -22.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9842369987403501, "mean_inference_ms": 1.2772294143878462, "mean_action_processing_ms": 0.06903325756923938, "mean_env_wait_ms": 5.7674234210632775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1616000, "timesteps_this_iter": 0, "agent_timesteps_total": 1616000, "timers": {"sample_time_ms": 15046.774, "sample_throughput": 265.838, "load_time_ms": 0.354, "load_throughput": 11307306.487, "learn_time_ms": 7562.688, "learn_throughput": 528.912, "update_time_ms": 1.809}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0868242257665242, "policy_loss": -0.02322294938788619, "vf_loss": 10.852778484423956, "vf_explained_var": 0.18133688985660512, "kl": 0.007596976459746028, "entropy": 0.17110522409840936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1616000, "num_agent_steps_sampled": 1616000, "num_steps_trained": 1616000, "num_agent_steps_trained": 1616000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16320, "training_iteration": 404, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-15-51", "timestamp": 1643703351, "time_this_iter_s": 15.463587760925293, "time_total_s": 12386.76320528984, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 127.25432825088501, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.831818181818186, "ram_util_percent": 67.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.19999999999999, "episode_reward_mean": -10.418999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -5.300000000000001, -4.4, -4.2, -24.800000000000004, -12.4, -11.500000000000002, -3.4, -5.3, -3.4, -5.0, -4.300000000000001, -14.799999999999999, -7.199999999999999, -12.600000000000001, -7.200000000000001, -9.3, -24.0, -3.3, -11.999999999999996, -15.099999999999998, -18.5, -9.3, -15.6, -3.3, -4.4, -4.4, -12.399999999999999, -16.5, -17.799999999999997, -7.300000000000001, -7.4, -4.300000000000001, -12.299999999999997, -24.199999999999996, -21.599999999999998, -21.0, -3.3, -14.299999999999997, -3.4, -9.6, -4.3, -6.300000000000001, -4.700000000000001, -14.2, -6.3, -3.2, -7.4, -6.299999999999999, -9.2, -7.199999999999999, -4.4, -4.4, -3.3, -7.499999999999998, -26.89999999999997, -21.999999999999996, -5.1, -26.3, -22.3, -9.4, -3.3, -20.0, -15.7, -7.699999999999998, -4.2, -6.1, -3.3, -15.5, -10.599999999999998, -24.90000000000001, -9.899999999999999, -8.2, -3.2, -8.3, -14.999999999999998, -10.89999999999999, -8.3, -3.3, -14.2, -8.6, -10.8, -17.4, -12.399999999999997, -5.300000000000001, -11.099999999999998, -9.799999999999999, -3.2, -4.2, -30.19999999999999, -4.4, -10.8, -18.0, -5.4, -23.6, -15.1, -4.3, -11.2, -5.2, -11.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9778224802569531, "mean_inference_ms": 1.2680677943569976, "mean_action_processing_ms": 0.06849735345948896, "mean_env_wait_ms": 5.722177484549537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1620000, "timesteps_this_iter": 0, "agent_timesteps_total": 1620000, "timers": {"sample_time_ms": 15055.744, "sample_throughput": 265.679, "load_time_ms": 0.354, "load_throughput": 11302862.789, "learn_time_ms": 7521.009, "learn_throughput": 531.844, "update_time_ms": 1.76}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08430621819770945, "policy_loss": -0.010072337759919064, "vf_loss": 9.272802354667776, "vf_explained_var": 0.3323786734893758, "kl": 0.008252672740313136, "entropy": 0.1929262159452323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1620000, "num_agent_steps_sampled": 1620000, "num_steps_trained": 1620000, "num_agent_steps_trained": 1620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16360, "training_iteration": 405, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-16-06", "timestamp": 1643703366, "time_this_iter_s": 15.038550853729248, "time_total_s": 12401.80175614357, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 142.29287910461426, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.36363636363637, "ram_util_percent": 67.50454545454545}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.19999999999999, "episode_reward_mean": -10.152999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.6, -4.3, -6.300000000000001, -4.700000000000001, -14.2, -6.3, -3.2, -7.4, -6.299999999999999, -9.2, -7.199999999999999, -4.4, -4.4, -3.3, -7.499999999999998, -26.89999999999997, -21.999999999999996, -5.1, -26.3, -22.3, -9.4, -3.3, -20.0, -15.7, -7.699999999999998, -4.2, -6.1, -3.3, -15.5, -10.599999999999998, -24.90000000000001, -9.899999999999999, -8.2, -3.2, -8.3, -14.999999999999998, -10.89999999999999, -8.3, -3.3, -14.2, -8.6, -10.8, -17.4, -12.399999999999997, -5.300000000000001, -11.099999999999998, -9.799999999999999, -3.2, -4.2, -30.19999999999999, -4.4, -10.8, -18.0, -5.4, -23.6, -15.1, -4.3, -11.2, -5.2, -11.8, -4.300000000000001, -14.6, -12.499999999999995, -3.2, -16.9, -16.799999999999997, -3.3, -13.8, -3.2, -4.300000000000001, -20.3, -16.5, -17.599999999999987, -3.4, -4.4, -4.4, -13.399999999999997, -11.200000000000001, -7.4, -15.099999999999998, -11.299999999999999, -6.0, -6.8999999999999995, -4.6000000000000005, -17.099999999999994, -4.300000000000001, -11.2, -4.300000000000001, -7.4, -6.4, -17.7, -5.0, -14.49999999999999, -4.2, -20.499999999999996, -4.6000000000000005, -3.4, -3.3, -9.999999999999998, -20.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9721150079988728, "mean_inference_ms": 1.2623613726714016, "mean_action_processing_ms": 0.06817492488717175, "mean_env_wait_ms": 5.695761049038147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1624000, "timesteps_this_iter": 0, "agent_timesteps_total": 1624000, "timers": {"sample_time_ms": 15079.469, "sample_throughput": 265.261, "load_time_ms": 0.353, "load_throughput": 11319131.021, "learn_time_ms": 7489.195, "learn_throughput": 534.103, "update_time_ms": 1.751}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09258815033789423, "policy_loss": 0.0002886515811726611, "vf_loss": 9.093467130776375, "vf_explained_var": 0.3275422343643763, "kl": 0.006824153165698608, "entropy": 0.19925703838147144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1624000, "num_agent_steps_sampled": 1624000, "num_steps_trained": 1624000, "num_agent_steps_trained": 1624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16400, "training_iteration": 406, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-16-21", "timestamp": 1643703381, "time_this_iter_s": 15.273741722106934, "time_total_s": 12417.075497865677, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 157.5666208267212, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.823809523809523, "ram_util_percent": 67.58571428571425}}
{"episode_reward_max": -3.2, "episode_reward_min": -51.3, "episode_reward_mean": -10.836999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.6, -10.8, -17.4, -12.399999999999997, -5.300000000000001, -11.099999999999998, -9.799999999999999, -3.2, -4.2, -30.19999999999999, -4.4, -10.8, -18.0, -5.4, -23.6, -15.1, -4.3, -11.2, -5.2, -11.8, -4.300000000000001, -14.6, -12.499999999999995, -3.2, -16.9, -16.799999999999997, -3.3, -13.8, -3.2, -4.300000000000001, -20.3, -16.5, -17.599999999999987, -3.4, -4.4, -4.4, -13.399999999999997, -11.200000000000001, -7.4, -15.099999999999998, -11.299999999999999, -6.0, -6.8999999999999995, -4.6000000000000005, -17.099999999999994, -4.300000000000001, -11.2, -4.300000000000001, -7.4, -6.4, -17.7, -5.0, -14.49999999999999, -4.2, -20.499999999999996, -4.6000000000000005, -3.4, -3.3, -9.999999999999998, -20.3, -21.500000000000004, -7.1, -10.1, -7.2, -4.6000000000000005, -34.500000000000014, -15.600000000000001, -8.1, -6.2, -51.3, -5.300000000000001, -3.4, -11.799999999999997, -11.099999999999998, -17.199999999999996, -23.799999999999997, -13.2, -5.4, -16.699999999999996, -5.4, -3.3, -10.499999999999998, -3.3, -5.6, -18.300000000000004, -5.6, -11.699999999999998, -12.6, -19.699999999999992, -7.6, -20.2, -3.3, -12.099999999999998, -3.6, -13.5, -4.5, -19.500000000000014, -9.9, -3.6000000000000005, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.967953597221297, "mean_inference_ms": 1.2571089253442735, "mean_action_processing_ms": 0.06787086220359631, "mean_env_wait_ms": 5.672401057200342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1628000, "timesteps_this_iter": 0, "agent_timesteps_total": 1628000, "timers": {"sample_time_ms": 15752.587, "sample_throughput": 253.927, "load_time_ms": 0.355, "load_throughput": 11265168.871, "learn_time_ms": 7476.833, "learn_throughput": 534.986, "update_time_ms": 1.703}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.19397008595537515, "policy_loss": -0.012106939141828848, "vf_loss": 20.45168109984808, "vf_explained_var": 0.14716971093608486, "kl": 0.0078010857322140985, "entropy": 0.2091157271176256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1628000, "num_agent_steps_sampled": 1628000, "num_steps_trained": 1628000, "num_agent_steps_trained": 1628000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16440, "training_iteration": 407, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-16-36", "timestamp": 1643703396, "time_this_iter_s": 15.0938880443573, "time_total_s": 12432.169385910034, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 172.6605088710785, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.272727272727273, "ram_util_percent": 67.59999999999997}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -106.3, "episode_reward_mean": -12.776, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.299999999999999, -6.0, -6.8999999999999995, -4.6000000000000005, -17.099999999999994, -4.300000000000001, -11.2, -4.300000000000001, -7.4, -6.4, -17.7, -5.0, -14.49999999999999, -4.2, -20.499999999999996, -4.6000000000000005, -3.4, -3.3, -9.999999999999998, -20.3, -21.500000000000004, -7.1, -10.1, -7.2, -4.6000000000000005, -34.500000000000014, -15.600000000000001, -8.1, -6.2, -51.3, -5.300000000000001, -3.4, -11.799999999999997, -11.099999999999998, -17.199999999999996, -23.799999999999997, -13.2, -5.4, -16.699999999999996, -5.4, -3.3, -10.499999999999998, -3.3, -5.6, -18.300000000000004, -5.6, -11.699999999999998, -12.6, -19.699999999999992, -7.6, -20.2, -3.3, -12.099999999999998, -3.6, -13.5, -4.5, -19.500000000000014, -9.9, -3.6000000000000005, -3.4, -24.6, -3.3, -30.4, -6.700000000000001, -38.400000000000006, -18.4, -12.799999999999997, -3.7, -10.3, -3.3, -6.300000000000001, -13.899999999999999, -5.300000000000001, -11.799999999999997, -21.099999999999994, -106.3, -5.1000000000000005, -4.2, -4.3, -4.4, -10.499999999999998, -25.8, -7.300000000000001, -13.799999999999999, -13.999999999999998, -2.4000000000000004, -18.9, -19.2, -9.100000000000001, -16.799999999999997, -19.099999999999998, -54.70000000000002, -6.4, -13.799999999999999, -8.0, -4.300000000000001, -4.1000000000000005, -13.4, -20.799999999999997, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.960717441717313, "mean_inference_ms": 1.2535965441453079, "mean_action_processing_ms": 0.06766577158170776, "mean_env_wait_ms": 5.655884024150419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1632000, "timesteps_this_iter": 0, "agent_timesteps_total": 1632000, "timers": {"sample_time_ms": 15618.693, "sample_throughput": 256.103, "load_time_ms": 0.348, "load_throughput": 11505428.611, "learn_time_ms": 7325.649, "learn_throughput": 546.027, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.8646022325394155, "policy_loss": -0.008990485004840358, "vf_loss": 87.23790597736195, "vf_explained_var": -0.0998045979648508, "kl": 0.006068414372876598, "entropy": 0.2046155615118883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1632000, "num_agent_steps_sampled": 1632000, "num_steps_trained": 1632000, "num_agent_steps_trained": 1632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16480, "training_iteration": 408, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-16-52", "timestamp": 1643703412, "time_this_iter_s": 15.533972978591919, "time_total_s": 12447.703358888626, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 188.1944818496704, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.80454545454546, "ram_util_percent": 67.53636363636366}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -106.3, "episode_reward_mean": -12.643000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -10.499999999999998, -3.3, -5.6, -18.300000000000004, -5.6, -11.699999999999998, -12.6, -19.699999999999992, -7.6, -20.2, -3.3, -12.099999999999998, -3.6, -13.5, -4.5, -19.500000000000014, -9.9, -3.6000000000000005, -3.4, -24.6, -3.3, -30.4, -6.700000000000001, -38.400000000000006, -18.4, -12.799999999999997, -3.7, -10.3, -3.3, -6.300000000000001, -13.899999999999999, -5.300000000000001, -11.799999999999997, -21.099999999999994, -106.3, -5.1000000000000005, -4.2, -4.3, -4.4, -10.499999999999998, -25.8, -7.300000000000001, -13.799999999999999, -13.999999999999998, -2.4000000000000004, -18.9, -19.2, -9.100000000000001, -16.799999999999997, -19.099999999999998, -54.70000000000002, -6.4, -13.799999999999999, -8.0, -4.300000000000001, -4.1000000000000005, -13.4, -20.799999999999997, -6.300000000000001, -10.0, -3.4, -3.4, -20.599999999999998, -15.7, -14.299999999999997, -8.000000000000002, -3.4, -20.199999999999996, -14.299999999999995, -5.9, -3.2, -22.199999999999985, -5.2, -9.2, -9.2, -12.1, -21.599999999999998, -3.3, -4.2, -16.9, -11.599999999999996, -13.599999999999998, -17.3, -9.5, -3.4, -18.5, -3.4, -18.8, -7.4, -19.999999999999996, -6.0, -14.299999999999999, -14.799999999999999, -3.2, -9.3, -8.2, -8.799999999999999, -31.4, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9556369681451793, "mean_inference_ms": 1.2495698127453105, "mean_action_processing_ms": 0.06744548510688317, "mean_env_wait_ms": 5.635210620869125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1636000, "timesteps_this_iter": 0, "agent_timesteps_total": 1636000, "timers": {"sample_time_ms": 15344.268, "sample_throughput": 260.684, "load_time_ms": 0.344, "load_throughput": 11644375.347, "learn_time_ms": 7248.344, "learn_throughput": 551.85, "update_time_ms": 1.551}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10249953699568587, "policy_loss": -0.02244547066348855, "vf_loss": 12.24903334045923, "vf_explained_var": 0.18967555472927708, "kl": 0.012273377830890076, "entropy": 0.19365278176001965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1636000, "num_agent_steps_sampled": 1636000, "num_steps_trained": 1636000, "num_agent_steps_trained": 1636000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16520, "training_iteration": 409, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-17-07", "timestamp": 1643703427, "time_this_iter_s": 15.198195934295654, "time_total_s": 12462.901554822922, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 203.39267778396606, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.96818181818182, "ram_util_percent": 67.43181818181819}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -54.70000000000002, "episode_reward_mean": -11.873, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.499999999999998, -25.8, -7.300000000000001, -13.799999999999999, -13.999999999999998, -2.4000000000000004, -18.9, -19.2, -9.100000000000001, -16.799999999999997, -19.099999999999998, -54.70000000000002, -6.4, -13.799999999999999, -8.0, -4.300000000000001, -4.1000000000000005, -13.4, -20.799999999999997, -6.300000000000001, -10.0, -3.4, -3.4, -20.599999999999998, -15.7, -14.299999999999997, -8.000000000000002, -3.4, -20.199999999999996, -14.299999999999995, -5.9, -3.2, -22.199999999999985, -5.2, -9.2, -9.2, -12.1, -21.599999999999998, -3.3, -4.2, -16.9, -11.599999999999996, -13.599999999999998, -17.3, -9.5, -3.4, -18.5, -3.4, -18.8, -7.4, -19.999999999999996, -6.0, -14.299999999999999, -14.799999999999999, -3.2, -9.3, -8.2, -8.799999999999999, -31.4, -3.4, -11.399999999999997, -9.799999999999997, -18.2, -4.4, -5.4, -5.5, -13.799999999999994, -11.3, -21.1, -6.3, -12.5, -9.699999999999994, -3.4, -13.799999999999999, -3.3, -32.80000000000002, -14.699999999999994, -17.6, -9.8, -3.4, -5.6000000000000005, -3.4, -4.2, -4.6000000000000005, -17.800000000000004, -3.3, -3.3, -15.899999999999997, -3.4, -5.4, -14.5, -4.4, -48.70000000000008, -17.599999999999998, -4.2, -8.999999999999998, -20.5, -12.999999999999998, -18.9, -3.5000000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9533649478695293, "mean_inference_ms": 1.2465439291602418, "mean_action_processing_ms": 0.0672826847822188, "mean_env_wait_ms": 5.619628526570434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1640000, "timesteps_this_iter": 0, "agent_timesteps_total": 1640000, "timers": {"sample_time_ms": 15303.024, "sample_throughput": 261.386, "load_time_ms": 0.342, "load_throughput": 11685739.361, "learn_time_ms": 7306.575, "learn_throughput": 547.452, "update_time_ms": 1.648}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15652766026987103, "policy_loss": -0.010181350744659862, "vf_loss": 16.495744434800198, "vf_explained_var": 0.10741828083992004, "kl": 0.008757848837666924, "entropy": 0.18068701841978616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1640000, "num_agent_steps_sampled": 1640000, "num_steps_trained": 1640000, "num_agent_steps_trained": 1640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16560, "training_iteration": 410, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-17-23", "timestamp": 1643703443, "time_this_iter_s": 15.822749853134155, "time_total_s": 12478.724304676056, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 219.21542763710022, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.927272727272726, "ram_util_percent": 67.47272727272728}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -48.70000000000008, "episode_reward_mean": -10.774, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.9, -11.599999999999996, -13.599999999999998, -17.3, -9.5, -3.4, -18.5, -3.4, -18.8, -7.4, -19.999999999999996, -6.0, -14.299999999999999, -14.799999999999999, -3.2, -9.3, -8.2, -8.799999999999999, -31.4, -3.4, -11.399999999999997, -9.799999999999997, -18.2, -4.4, -5.4, -5.5, -13.799999999999994, -11.3, -21.1, -6.3, -12.5, -9.699999999999994, -3.4, -13.799999999999999, -3.3, -32.80000000000002, -14.699999999999994, -17.6, -9.8, -3.4, -5.6000000000000005, -3.4, -4.2, -4.6000000000000005, -17.800000000000004, -3.3, -3.3, -15.899999999999997, -3.4, -5.4, -14.5, -4.4, -48.70000000000008, -17.599999999999998, -4.2, -8.999999999999998, -20.5, -12.999999999999998, -18.9, -3.5000000000000004, -12.8, -3.4, -5.3999999999999995, -4.300000000000001, -28.800000000000004, -10.2, -24.4, -6.1000000000000005, -2.4000000000000004, -10.799999999999997, -4.300000000000001, -16.8, -8.7, -4.4, -5.4, -5.300000000000001, -4.4, -10.5, -19.3, -26.799999999999997, -6.300000000000001, -10.699999999999996, -8.3, -4.300000000000001, -3.4, -8.899999999999999, -3.3, -16.099999999999998, -4.2, -5.300000000000001, -10.3, -6.3, -3.6000000000000005, -4.300000000000001, -12.399999999999999, -12.199999999999998, -25.90000000000001, -3.3, -10.999999999999998, -13.600000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9555871710989581, "mean_inference_ms": 1.2446302169604428, "mean_action_processing_ms": 0.06718767653861094, "mean_env_wait_ms": 5.610495432267329, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1644000, "timesteps_this_iter": 0, "agent_timesteps_total": 1644000, "timers": {"sample_time_ms": 15377.851, "sample_throughput": 260.114, "load_time_ms": 0.344, "load_throughput": 11621789.97, "learn_time_ms": 7358.129, "learn_throughput": 543.616, "update_time_ms": 1.649}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11097310579291755, "policy_loss": -0.004257752080397901, "vf_loss": 11.39454438279393, "vf_explained_var": 0.2748771485461984, "kl": 0.0064270786027780915, "entropy": 0.17170715221874816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1644000, "num_agent_steps_sampled": 1644000, "num_steps_trained": 1644000, "num_agent_steps_trained": 1644000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16600, "training_iteration": 411, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-17-38", "timestamp": 1643703458, "time_this_iter_s": 15.632869958877563, "time_total_s": 12494.357174634933, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 234.84829759597778, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.169565217391302, "ram_util_percent": 67.51739130434783}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -48.70000000000008, "episode_reward_mean": -9.982000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.6000000000000005, -3.4, -4.2, -4.6000000000000005, -17.800000000000004, -3.3, -3.3, -15.899999999999997, -3.4, -5.4, -14.5, -4.4, -48.70000000000008, -17.599999999999998, -4.2, -8.999999999999998, -20.5, -12.999999999999998, -18.9, -3.5000000000000004, -12.8, -3.4, -5.3999999999999995, -4.300000000000001, -28.800000000000004, -10.2, -24.4, -6.1000000000000005, -2.4000000000000004, -10.799999999999997, -4.300000000000001, -16.8, -8.7, -4.4, -5.4, -5.300000000000001, -4.4, -10.5, -19.3, -26.799999999999997, -6.300000000000001, -10.699999999999996, -8.3, -4.300000000000001, -3.4, -8.899999999999999, -3.3, -16.099999999999998, -4.2, -5.300000000000001, -10.3, -6.3, -3.6000000000000005, -4.300000000000001, -12.399999999999999, -12.199999999999998, -25.90000000000001, -3.3, -10.999999999999998, -13.600000000000001, -3.3, -6.4, -6.5, -3.900000000000001, -8.4, -18.600000000000005, -7.1999999999999975, -3.3, -7.3, -5.2, -12.299999999999999, -24.10000000000005, -9.3, -13.4, -3.4, -8.2, -3.4, -7.4, -14.999999999999998, -9.999999999999998, -11.6, -4.1000000000000005, -15.19999999999999, -3.3, -5.4, -4.4, -13.799999999999995, -16.4, -19.9, -18.9, -15.699999999999998, -24.2, -3.8000000000000003, -3.4, -16.799999999999997, -14.2, -3.3, -9.099999999999998, -4.300000000000001, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.95684403914495, "mean_inference_ms": 1.243519845125076, "mean_action_processing_ms": 0.06713013511652274, "mean_env_wait_ms": 5.606642772974869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1648000, "timesteps_this_iter": 0, "agent_timesteps_total": 1648000, "timers": {"sample_time_ms": 15395.791, "sample_throughput": 259.811, "load_time_ms": 0.341, "load_throughput": 11735601.567, "learn_time_ms": 7452.254, "learn_throughput": 536.75, "update_time_ms": 1.635}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06690591915700865, "policy_loss": -0.013427392517526945, "vf_loss": 7.8796073708162515, "vf_explained_var": 0.33380453772442314, "kl": 0.0076861894839840815, "entropy": 0.18312001494310234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1648000, "num_agent_steps_sampled": 1648000, "num_steps_trained": 1648000, "num_agent_steps_trained": 1648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16640, "training_iteration": 412, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-17-55", "timestamp": 1643703475, "time_this_iter_s": 16.284489154815674, "time_total_s": 12510.64166378975, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 251.13278675079346, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.47826086956521, "ram_util_percent": 67.5391304347826}}
{"episode_reward_max": -3.1, "episode_reward_min": -32.599999999999994, "episode_reward_mean": -9.931000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -10.699999999999996, -8.3, -4.300000000000001, -3.4, -8.899999999999999, -3.3, -16.099999999999998, -4.2, -5.300000000000001, -10.3, -6.3, -3.6000000000000005, -4.300000000000001, -12.399999999999999, -12.199999999999998, -25.90000000000001, -3.3, -10.999999999999998, -13.600000000000001, -3.3, -6.4, -6.5, -3.900000000000001, -8.4, -18.600000000000005, -7.1999999999999975, -3.3, -7.3, -5.2, -12.299999999999999, -24.10000000000005, -9.3, -13.4, -3.4, -8.2, -3.4, -7.4, -14.999999999999998, -9.999999999999998, -11.6, -4.1000000000000005, -15.19999999999999, -3.3, -5.4, -4.4, -13.799999999999995, -16.4, -19.9, -18.9, -15.699999999999998, -24.2, -3.8000000000000003, -3.4, -16.799999999999997, -14.2, -3.3, -9.099999999999998, -4.300000000000001, -4.4, -20.2, -5.300000000000001, -32.3, -12.5, -3.3, -32.599999999999994, -3.9000000000000004, -18.800000000000004, -14.1, -6.8999999999999995, -5.3, -3.4, -10.899999999999999, -12.3, -5.300000000000001, -13.7, -9.799999999999999, -3.9000000000000004, -3.3, -16.299999999999997, -11.7, -10.9, -23.700000000000006, -18.300000000000008, -8.2, -8.299999999999999, -21.39999999999999, -3.4, -15.299999999999997, -4.4, -3.3, -8.8, -3.3, -4.300000000000001, -4.700000000000001, -19.6, -11.199999999999998, -3.1, -6.300000000000001, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.958993133785722, "mean_inference_ms": 1.24559379779978, "mean_action_processing_ms": 0.06724465323523303, "mean_env_wait_ms": 5.617661401753871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1652000, "timesteps_this_iter": 0, "agent_timesteps_total": 1652000, "timers": {"sample_time_ms": 15613.989, "sample_throughput": 256.181, "load_time_ms": 0.349, "load_throughput": 11448898.594, "learn_time_ms": 7630.939, "learn_throughput": 524.182, "update_time_ms": 1.648}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1262821454674967, "policy_loss": -0.009208456227075189, "vf_loss": 13.432080054571552, "vf_explained_var": 0.2141968866830231, "kl": 0.005849021193188465, "entropy": 0.1854455201335812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1652000, "num_agent_steps_sampled": 1652000, "num_steps_trained": 1652000, "num_agent_steps_trained": 1652000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16680, "training_iteration": 413, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-18-13", "timestamp": 1643703493, "time_this_iter_s": 18.255836248397827, "time_total_s": 12528.897500038147, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 269.3886229991913, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 31.284615384615385, "ram_util_percent": 67.5}}
{"episode_reward_max": -3.1, "episode_reward_min": -32.599999999999994, "episode_reward_mean": -10.546, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.6, -4.1000000000000005, -15.19999999999999, -3.3, -5.4, -4.4, -13.799999999999995, -16.4, -19.9, -18.9, -15.699999999999998, -24.2, -3.8000000000000003, -3.4, -16.799999999999997, -14.2, -3.3, -9.099999999999998, -4.300000000000001, -4.4, -20.2, -5.300000000000001, -32.3, -12.5, -3.3, -32.599999999999994, -3.9000000000000004, -18.800000000000004, -14.1, -6.8999999999999995, -5.3, -3.4, -10.899999999999999, -12.3, -5.300000000000001, -13.7, -9.799999999999999, -3.9000000000000004, -3.3, -16.299999999999997, -11.7, -10.9, -23.700000000000006, -18.300000000000008, -8.2, -8.299999999999999, -21.39999999999999, -3.4, -15.299999999999997, -4.4, -3.3, -8.8, -3.3, -4.300000000000001, -4.700000000000001, -19.6, -11.199999999999998, -3.1, -6.300000000000001, -6.300000000000001, -4.4, -4.4, -12.2, -4.300000000000001, -8.8, -3.3, -13.899999999999999, -3.3, -32.2, -12.899999999999997, -6.4, -3.4, -22.2, -3.3, -16.8, -14.5, -4.4, -19.4, -13.099999999999998, -8.2, -5.4, -31.5, -8.3, -6.099999999999999, -4.2, -5.300000000000001, -3.4, -13.999999999999998, -3.4, -14.899999999999997, -9.8, -14.699999999999994, -3.3, -22.7, -14.600000000000001, -4.300000000000001, -12.199999999999973, -5.300000000000001, -13.599999999999994, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9642844762747882, "mean_inference_ms": 1.2513676692552982, "mean_action_processing_ms": 0.06755637353092872, "mean_env_wait_ms": 5.645720955398617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1656000, "timesteps_this_iter": 0, "agent_timesteps_total": 1656000, "timers": {"sample_time_ms": 15902.428, "sample_throughput": 251.534, "load_time_ms": 0.371, "load_throughput": 10773271.688, "learn_time_ms": 8151.731, "learn_throughput": 490.693, "update_time_ms": 1.748}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09679430517272883, "policy_loss": -0.015275359394589579, "vf_loss": 11.021652598406678, "vf_explained_var": 0.2625375000379419, "kl": 0.00926571591842316, "entropy": 0.16327067745789406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1656000, "num_agent_steps_sampled": 1656000, "num_steps_trained": 1656000, "num_agent_steps_trained": 1656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16720, "training_iteration": 414, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-18-35", "timestamp": 1643703515, "time_this_iter_s": 21.770668029785156, "time_total_s": 12550.668168067932, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 291.15929102897644, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.31290322580645, "ram_util_percent": 67.58387096774192}}
{"episode_reward_max": -3.1, "episode_reward_min": -32.2, "episode_reward_mean": -10.091, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.7, -10.9, -23.700000000000006, -18.300000000000008, -8.2, -8.299999999999999, -21.39999999999999, -3.4, -15.299999999999997, -4.4, -3.3, -8.8, -3.3, -4.300000000000001, -4.700000000000001, -19.6, -11.199999999999998, -3.1, -6.300000000000001, -6.300000000000001, -4.4, -4.4, -12.2, -4.300000000000001, -8.8, -3.3, -13.899999999999999, -3.3, -32.2, -12.899999999999997, -6.4, -3.4, -22.2, -3.3, -16.8, -14.5, -4.4, -19.4, -13.099999999999998, -8.2, -5.4, -31.5, -8.3, -6.099999999999999, -4.2, -5.300000000000001, -3.4, -13.999999999999998, -3.4, -14.899999999999997, -9.8, -14.699999999999994, -3.3, -22.7, -14.600000000000001, -4.300000000000001, -12.199999999999973, -5.300000000000001, -13.599999999999994, -3.4, -14.9, -17.500000000000004, -6.600000000000001, -20.299999999999997, -3.4, -18.6, -15.799999999999994, -6.4, -7.6, -16.299999999999997, -6.300000000000001, -5.300000000000001, -12.600000000000001, -15.799999999999999, -7.900000000000002, -12.5, -15.399999999999999, -9.4, -3.4, -8.099999999999998, -3.4, -9.600000000000001, -6.300000000000001, -13.6, -3.2, -5.300000000000001, -20.6, -6.899999999999999, -3.2, -13.299999999999997, -8.700000000000001, -3.4, -14.799999999999999, -3.3, -11.5, -14.1, -12.6, -10.3, -4.300000000000001, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9788098014893258, "mean_inference_ms": 1.2724584490282533, "mean_action_processing_ms": 0.06869019976135386, "mean_env_wait_ms": 5.745442740292018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1660000, "timesteps_this_iter": 0, "agent_timesteps_total": 1660000, "timers": {"sample_time_ms": 16976.272, "sample_throughput": 235.623, "load_time_ms": 0.386, "load_throughput": 10363343.011, "learn_time_ms": 8561.578, "learn_throughput": 467.204, "update_time_ms": 1.84}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.04873007786089695, "policy_loss": -0.012401543679817389, "vf_loss": 5.979660603644386, "vf_explained_var": 0.4749992355223625, "kl": 0.00667509469148587, "entropy": 0.1760183967930335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1660000, "num_agent_steps_sampled": 1660000, "num_steps_trained": 1660000, "num_agent_steps_trained": 1660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16760, "training_iteration": 415, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-19-00", "timestamp": 1643703540, "time_this_iter_s": 24.656865119934082, "time_total_s": 12575.325033187866, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 315.8161561489105, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 45.28, "ram_util_percent": 67.59999999999998}}
{"episode_reward_max": -2.5, "episode_reward_min": -31.5, "episode_reward_mean": -9.719, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -31.5, -8.3, -6.099999999999999, -4.2, -5.300000000000001, -3.4, -13.999999999999998, -3.4, -14.899999999999997, -9.8, -14.699999999999994, -3.3, -22.7, -14.600000000000001, -4.300000000000001, -12.199999999999973, -5.300000000000001, -13.599999999999994, -3.4, -14.9, -17.500000000000004, -6.600000000000001, -20.299999999999997, -3.4, -18.6, -15.799999999999994, -6.4, -7.6, -16.299999999999997, -6.300000000000001, -5.300000000000001, -12.600000000000001, -15.799999999999999, -7.900000000000002, -12.5, -15.399999999999999, -9.4, -3.4, -8.099999999999998, -3.4, -9.600000000000001, -6.300000000000001, -13.6, -3.2, -5.300000000000001, -20.6, -6.899999999999999, -3.2, -13.299999999999997, -8.700000000000001, -3.4, -14.799999999999999, -3.3, -11.5, -14.1, -12.6, -10.3, -4.300000000000001, -8.3, -17.0, -3.4, -17.699999999999996, -3.4, -5.4, -4.4, -11.500000000000002, -3.7, -3.4, -5.999999999999999, -19.7, -17.0, -5.1, -5.3, -11.5, -3.3, -16.1, -16.09999999999998, -9.7, -20.300000000000004, -3.3, -17.999999999999986, -5.799999999999999, -19.9, -7.599999999999999, -9.5, -3.4, -7.099999999999999, -18.7, -3.3, -2.5, -4.4, -12.799999999999999, -9.4, -3.3, -10.0, -16.799999999999997, -3.4, -8.099999999999998, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9943984572485745, "mean_inference_ms": 1.2949744223835615, "mean_action_processing_ms": 0.0698918464831647, "mean_env_wait_ms": 5.8522788715761385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1664000, "timesteps_this_iter": 0, "agent_timesteps_total": 1664000, "timers": {"sample_time_ms": 17593.86, "sample_throughput": 227.352, "load_time_ms": 0.401, "load_throughput": 9970414.215, "learn_time_ms": 8861.174, "learn_throughput": 451.407, "update_time_ms": 1.84}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.061090285688518514, "policy_loss": -0.010952055345099139, "vf_loss": 7.064750106360322, "vf_explained_var": 0.31616049428139964, "kl": 0.0069742055573570085, "entropy": 0.18383686182399592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1664000, "num_agent_steps_sampled": 1664000, "num_steps_trained": 1664000, "num_agent_steps_trained": 1664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16800, "training_iteration": 416, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-19-20", "timestamp": 1643703560, "time_this_iter_s": 20.31971311569214, "time_total_s": 12595.644746303558, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 336.13586926460266, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 33.58275862068966, "ram_util_percent": 67.59999999999998}}
{"episode_reward_max": -2.5, "episode_reward_min": -97.00000000000007, "episode_reward_mean": -10.918000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -9.600000000000001, -6.300000000000001, -13.6, -3.2, -5.300000000000001, -20.6, -6.899999999999999, -3.2, -13.299999999999997, -8.700000000000001, -3.4, -14.799999999999999, -3.3, -11.5, -14.1, -12.6, -10.3, -4.300000000000001, -8.3, -17.0, -3.4, -17.699999999999996, -3.4, -5.4, -4.4, -11.500000000000002, -3.7, -3.4, -5.999999999999999, -19.7, -17.0, -5.1, -5.3, -11.5, -3.3, -16.1, -16.09999999999998, -9.7, -20.300000000000004, -3.3, -17.999999999999986, -5.799999999999999, -19.9, -7.599999999999999, -9.5, -3.4, -7.099999999999999, -18.7, -3.3, -2.5, -4.4, -12.799999999999999, -9.4, -3.3, -10.0, -16.799999999999997, -3.4, -8.099999999999998, -3.4, -3.3, -6.2, -3.2, -11.999999999999998, -6.3, -10.7, -7.2, -7.9, -97.00000000000007, -3.3, -12.299999999999981, -3.5, -24.500000000000007, -9.399999999999999, -8.2, -9.299999999999999, -3.4, -3.3, -4.4, -28.600000000000048, -13.799999999999999, -5.2, -14.79999999999999, -11.3, -33.3, -3.3, -52.30000000000001, -15.0, -8.3, -4.4, -20.600000000000005, -8.7, -13.599999999999998, -3.4, -12.699999999999998, -10.299999999999997, -19.2, -21.3, -3.5000000000000004, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0059353926138295, "mean_inference_ms": 1.3107109355642685, "mean_action_processing_ms": 0.07077056451504485, "mean_env_wait_ms": 5.927258459289822, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1668000, "timesteps_this_iter": 0, "agent_timesteps_total": 1668000, "timers": {"sample_time_ms": 18089.52, "sample_throughput": 221.123, "load_time_ms": 0.409, "load_throughput": 9790054.269, "learn_time_ms": 9121.672, "learn_throughput": 438.516, "update_time_ms": 1.887}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5233657185539042, "policy_loss": -0.022110453228996966, "vf_loss": 54.353981680318874, "vf_explained_var": 0.09815166002960615, "kl": 0.009681845491218496, "entropy": 0.20211291511052398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1668000, "num_agent_steps_sampled": 1668000, "num_steps_trained": 1668000, "num_agent_steps_trained": 1668000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16840, "training_iteration": 417, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-19-40", "timestamp": 1643703580, "time_this_iter_s": 19.6542649269104, "time_total_s": 12615.299011230469, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 355.79013419151306, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.967857142857145, "ram_util_percent": 67.55}}
{"episode_reward_max": -2.5, "episode_reward_min": -97.00000000000007, "episode_reward_mean": -11.244000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -17.999999999999986, -5.799999999999999, -19.9, -7.599999999999999, -9.5, -3.4, -7.099999999999999, -18.7, -3.3, -2.5, -4.4, -12.799999999999999, -9.4, -3.3, -10.0, -16.799999999999997, -3.4, -8.099999999999998, -3.4, -3.3, -6.2, -3.2, -11.999999999999998, -6.3, -10.7, -7.2, -7.9, -97.00000000000007, -3.3, -12.299999999999981, -3.5, -24.500000000000007, -9.399999999999999, -8.2, -9.299999999999999, -3.4, -3.3, -4.4, -28.600000000000048, -13.799999999999999, -5.2, -14.79999999999999, -11.3, -33.3, -3.3, -52.30000000000001, -15.0, -8.3, -4.4, -20.600000000000005, -8.7, -13.599999999999998, -3.4, -12.699999999999998, -10.299999999999997, -19.2, -21.3, -3.5000000000000004, -5.4, -3.4, -4.3, -20.199999999999996, -10.9, -8.799999999999997, -9.600000000000001, -19.700000000000006, -9.699999999999998, -4.3, -3.3, -13.399999999999999, -27.2, -10.4, -14.799999999999999, -13.099999999999998, -3.3, -8.099999999999998, -18.00000000000002, -4.300000000000001, -5.3, -4.300000000000001, -12.499999999999998, -12.8, -14.499999999999998, -7.3, -4.4, -3.4, -5.800000000000001, -40.3, -9.0, -10.700000000000001, -11.6, -7.4, -3.2, -4.300000000000001, -7.5, -4.3, -5.2, -19.500000000000004, -9.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0116281073729376, "mean_inference_ms": 1.3189823197013366, "mean_action_processing_ms": 0.07123768392094706, "mean_env_wait_ms": 5.965315393773478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1672000, "timesteps_this_iter": 0, "agent_timesteps_total": 1672000, "timers": {"sample_time_ms": 18511.318, "sample_throughput": 216.084, "load_time_ms": 0.419, "load_throughput": 9540097.805, "learn_time_ms": 9381.491, "learn_throughput": 426.371, "update_time_ms": 1.928}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.098442038439054, "policy_loss": -0.0186258860943859, "vf_loss": 11.511272587763365, "vf_explained_var": 0.12708882106247768, "kl": 0.009776013691564313, "entropy": 0.19609361912614556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1672000, "num_agent_steps_sampled": 1672000, "num_steps_trained": 1672000, "num_agent_steps_trained": 1672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16880, "training_iteration": 418, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-19-59", "timestamp": 1643703599, "time_this_iter_s": 19.739166021347046, "time_total_s": 12635.038177251816, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 375.5293002128601, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.328571428571426, "ram_util_percent": 67.35357142857143}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.30000000000001, "episode_reward_mean": -10.241, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.799999999999999, -5.2, -14.79999999999999, -11.3, -33.3, -3.3, -52.30000000000001, -15.0, -8.3, -4.4, -20.600000000000005, -8.7, -13.599999999999998, -3.4, -12.699999999999998, -10.299999999999997, -19.2, -21.3, -3.5000000000000004, -5.4, -3.4, -4.3, -20.199999999999996, -10.9, -8.799999999999997, -9.600000000000001, -19.700000000000006, -9.699999999999998, -4.3, -3.3, -13.399999999999999, -27.2, -10.4, -14.799999999999999, -13.099999999999998, -3.3, -8.099999999999998, -18.00000000000002, -4.300000000000001, -5.3, -4.300000000000001, -12.499999999999998, -12.8, -14.499999999999998, -7.3, -4.4, -3.4, -5.800000000000001, -40.3, -9.0, -10.700000000000001, -11.6, -7.4, -3.2, -4.300000000000001, -7.5, -4.3, -5.2, -19.500000000000004, -9.2, -11.799999999999997, -9.299999999999997, -5.4, -4.300000000000001, -4.300000000000001, -3.4, -4.4, -17.499999999999996, -9.700000000000001, -9.9, -3.3, -3.3, -7.3, -11.999999999999996, -8.2, -4.4, -11.199999999999976, -7.199999999999999, -3.3, -6.0, -5.0, -22.9, -4.300000000000001, -21.2, -5.4, -7.899999999999998, -5.3, -4.0, -10.9, -7.3, -22.99999999999998, -10.600000000000001, -12.8, -8.6, -8.6, -3.3, -5.3, -14.299999999999985, -4.2, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.015285400773749, "mean_inference_ms": 1.3262899526974041, "mean_action_processing_ms": 0.07163996183160973, "mean_env_wait_ms": 5.999435322257056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1676000, "timesteps_this_iter": 0, "agent_timesteps_total": 1676000, "timers": {"sample_time_ms": 18965.749, "sample_throughput": 210.907, "load_time_ms": 0.434, "load_throughput": 9223318.307, "learn_time_ms": 9762.562, "learn_throughput": 409.729, "update_time_ms": 1.943}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.046016655642519236, "policy_loss": -0.013897455144693614, "vf_loss": 5.823968326773054, "vf_explained_var": 0.3704649206771645, "kl": 0.008372147096700828, "entropy": 0.16922533759667027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1676000, "num_agent_steps_sampled": 1676000, "num_steps_trained": 1676000, "num_agent_steps_trained": 1676000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16920, "training_iteration": 419, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-20-20", "timestamp": 1643703620, "time_this_iter_s": 20.951835870742798, "time_total_s": 12655.990013122559, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 396.4811360836029, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 38.23999999999999, "ram_util_percent": 67.35333333333335}}
{"episode_reward_max": -3.2, "episode_reward_min": -61.3, "episode_reward_mean": -10.434999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -12.499999999999998, -12.8, -14.499999999999998, -7.3, -4.4, -3.4, -5.800000000000001, -40.3, -9.0, -10.700000000000001, -11.6, -7.4, -3.2, -4.300000000000001, -7.5, -4.3, -5.2, -19.500000000000004, -9.2, -11.799999999999997, -9.299999999999997, -5.4, -4.300000000000001, -4.300000000000001, -3.4, -4.4, -17.499999999999996, -9.700000000000001, -9.9, -3.3, -3.3, -7.3, -11.999999999999996, -8.2, -4.4, -11.199999999999976, -7.199999999999999, -3.3, -6.0, -5.0, -22.9, -4.300000000000001, -21.2, -5.4, -7.899999999999998, -5.3, -4.0, -10.9, -7.3, -22.99999999999998, -10.600000000000001, -12.8, -8.6, -8.6, -3.3, -5.3, -14.299999999999985, -4.2, -3.3, -25.600000000000005, -9.199999999999998, -18.3, -21.400000000000002, -3.8000000000000003, -6.9, -4.4, -25.700000000000003, -7.300000000000001, -6.300000000000001, -4.2, -35.8, -6.2, -15.299999999999997, -4.800000000000001, -7.999999999999998, -61.3, -17.299999999999997, -6.1, -9.3, -16.9, -4.5, -3.2, -7.099999999999999, -13.6, -17.799999999999997, -9.7, -3.3, -19.6, -10.600000000000001, -8.499999999999996, -14.199999999999976, -4.3, -3.3, -13.2, -4.4, -10.0, -4.300000000000001, -26.5, -19.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0210852883063486, "mean_inference_ms": 1.3355748533755507, "mean_action_processing_ms": 0.07216352416155845, "mean_env_wait_ms": 6.043579498632811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1680000, "timesteps_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"sample_time_ms": 19617.054, "sample_throughput": 203.904, "load_time_ms": 0.446, "load_throughput": 8976093.307, "learn_time_ms": 10023.414, "learn_throughput": 399.066, "update_time_ms": 1.937}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.20971847447937214, "policy_loss": -0.022947750276615542, "vf_loss": 23.048438805373767, "vf_explained_var": 0.08620320135547269, "kl": 0.010909226603872002, "entropy": 0.21838499104143472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1680000, "num_agent_steps_sampled": 1680000, "num_steps_trained": 1680000, "num_agent_steps_trained": 1680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16960, "training_iteration": 420, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-20-42", "timestamp": 1643703642, "time_this_iter_s": 21.124491930007935, "time_total_s": 12677.114505052567, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 417.60562801361084, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 36.93666666666666, "ram_util_percent": 67.40000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -61.3, "episode_reward_mean": -11.257999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -22.9, -4.300000000000001, -21.2, -5.4, -7.899999999999998, -5.3, -4.0, -10.9, -7.3, -22.99999999999998, -10.600000000000001, -12.8, -8.6, -8.6, -3.3, -5.3, -14.299999999999985, -4.2, -3.3, -25.600000000000005, -9.199999999999998, -18.3, -21.400000000000002, -3.8000000000000003, -6.9, -4.4, -25.700000000000003, -7.300000000000001, -6.300000000000001, -4.2, -35.8, -6.2, -15.299999999999997, -4.800000000000001, -7.999999999999998, -61.3, -17.299999999999997, -6.1, -9.3, -16.9, -4.5, -3.2, -7.099999999999999, -13.6, -17.799999999999997, -9.7, -3.3, -19.6, -10.600000000000001, -8.499999999999996, -14.199999999999976, -4.3, -3.3, -13.2, -4.4, -10.0, -4.300000000000001, -26.5, -19.700000000000003, -6.300000000000001, -3.3, -19.000000000000004, -12.099999999999996, -3.3, -9.299999999999999, -10.299999999999999, -17.9, -10.699999999999998, -3.2, -3.5, -11.999999999999996, -24.30000000000006, -21.499999999999996, -13.7, -6.800000000000001, -7.299999999999999, -10.099999999999998, -11.299999999999999, -3.3, -3.3, -12.600000000000001, -4.4, -14.099999999999998, -3.3, -15.999999999999998, -4.300000000000001, -28.4, -9.9, -15.2, -5.300000000000001, -3.4, -13.099999999999998, -6.3, -9.4, -7.5, -12.3, -6.6000000000000005, -20.299999999999997, -20.800000000000026], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0294320123850798, "mean_inference_ms": 1.344901516549499, "mean_action_processing_ms": 0.07269390199235976, "mean_env_wait_ms": 6.086564564655256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1684000, "timesteps_this_iter": 0, "agent_timesteps_total": 1684000, "timers": {"sample_time_ms": 20067.53, "sample_throughput": 199.327, "load_time_ms": 0.464, "load_throughput": 8612976.025, "learn_time_ms": 10286.367, "learn_throughput": 388.864, "update_time_ms": 1.971}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08314137042610235, "policy_loss": -0.020937194012766405, "vf_loss": 10.171708169932007, "vf_explained_var": 0.16892154735903586, "kl": 0.011807425842639321, "entropy": 0.2249904776092178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1684000, "num_agent_steps_sampled": 1684000, "num_steps_trained": 1684000, "num_agent_steps_trained": 1684000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17000, "training_iteration": 421, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-21-02", "timestamp": 1643703662, "time_this_iter_s": 20.15404963493347, "time_total_s": 12697.2685546875, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 437.7596776485443, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.313793103448276, "ram_util_percent": 67.40000000000002}}
{"episode_reward_max": -2.8000000000000003, "episode_reward_min": -28.4, "episode_reward_mean": -10.100000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.9, -4.5, -3.2, -7.099999999999999, -13.6, -17.799999999999997, -9.7, -3.3, -19.6, -10.600000000000001, -8.499999999999996, -14.199999999999976, -4.3, -3.3, -13.2, -4.4, -10.0, -4.300000000000001, -26.5, -19.700000000000003, -6.300000000000001, -3.3, -19.000000000000004, -12.099999999999996, -3.3, -9.299999999999999, -10.299999999999999, -17.9, -10.699999999999998, -3.2, -3.5, -11.999999999999996, -24.30000000000006, -21.499999999999996, -13.7, -6.800000000000001, -7.299999999999999, -10.099999999999998, -11.299999999999999, -3.3, -3.3, -12.600000000000001, -4.4, -14.099999999999998, -3.3, -15.999999999999998, -4.300000000000001, -28.4, -9.9, -15.2, -5.300000000000001, -3.4, -13.099999999999998, -6.3, -9.4, -7.5, -12.3, -6.6000000000000005, -20.299999999999997, -20.800000000000026, -17.099999999999998, -5.000000000000002, -12.799999999999999, -4.3, -6.4, -26.600000000000044, -3.3, -6.500000000000002, -13.2, -3.3, -4.2, -20.200000000000003, -4.300000000000001, -27.500000000000004, -14.599999999999998, -5.300000000000001, -4.3, -3.2, -6.2, -7.3, -7.300000000000001, -5.300000000000001, -3.4, -3.3, -9.600000000000001, -8.399999999999999, -9.399999999999999, -10.200000000000001, -3.2, -18.5, -3.4, -4.300000000000001, -5.300000000000001, -11.5, -4.2, -2.8000000000000003, -5.4, -14.7, -25.3, -18.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0375170708846881, "mean_inference_ms": 1.3534849335266859, "mean_action_processing_ms": 0.07319500791815023, "mean_env_wait_ms": 6.127148389582008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1688000, "timesteps_this_iter": 0, "agent_timesteps_total": 1688000, "timers": {"sample_time_ms": 20555.068, "sample_throughput": 194.599, "load_time_ms": 0.477, "load_throughput": 8379809.2, "learn_time_ms": 10518.795, "learn_throughput": 380.272, "update_time_ms": 2.019}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0679541646475373, "policy_loss": -0.019042496465306768, "vf_loss": 8.534089961744124, "vf_explained_var": 0.24673418761581503, "kl": 0.008278821766200819, "entropy": 0.21932653640547106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1688000, "num_agent_steps_sampled": 1688000, "num_steps_trained": 1688000, "num_agent_steps_trained": 1688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17040, "training_iteration": 422, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-21-23", "timestamp": 1643703683, "time_this_iter_s": 20.846807956695557, "time_total_s": 12718.115362644196, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 458.60648560523987, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.550000000000004, "ram_util_percent": 67.40000000000002}}
{"episode_reward_max": -2.2, "episode_reward_min": -28.4, "episode_reward_mean": -10.04, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -12.600000000000001, -4.4, -14.099999999999998, -3.3, -15.999999999999998, -4.300000000000001, -28.4, -9.9, -15.2, -5.300000000000001, -3.4, -13.099999999999998, -6.3, -9.4, -7.5, -12.3, -6.6000000000000005, -20.299999999999997, -20.800000000000026, -17.099999999999998, -5.000000000000002, -12.799999999999999, -4.3, -6.4, -26.600000000000044, -3.3, -6.500000000000002, -13.2, -3.3, -4.2, -20.200000000000003, -4.300000000000001, -27.500000000000004, -14.599999999999998, -5.300000000000001, -4.3, -3.2, -6.2, -7.3, -7.300000000000001, -5.300000000000001, -3.4, -3.3, -9.600000000000001, -8.399999999999999, -9.399999999999999, -10.200000000000001, -3.2, -18.5, -3.4, -4.300000000000001, -5.300000000000001, -11.5, -4.2, -2.8000000000000003, -5.4, -14.7, -25.3, -18.5, -14.799999999999999, -9.8, -4.2, -17.500000000000004, -7.799999999999999, -4.300000000000001, -14.8, -3.4, -11.7, -9.2, -7.300000000000001, -14.600000000000001, -3.3, -21.799999999999997, -7.399999999999999, -3.2, -14.299999999999997, -4.2, -12.499999999999996, -25.700000000000003, -14.299999999999997, -7.199999999999999, -16.099999999999994, -9.799999999999999, -4.300000000000001, -4.3, -6.300000000000001, -16.599999999999984, -2.2, -9.499999999999998, -3.4, -10.999999999999998, -16.2, -24.000000000000025, -3.2, -4.2, -10.099999999999998, -11.899999999999999, -14.7, -16.799999999999972], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0428765378873084, "mean_inference_ms": 1.3605226056920774, "mean_action_processing_ms": 0.07359104729475523, "mean_env_wait_ms": 6.161780278892156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1692000, "timesteps_this_iter": 0, "agent_timesteps_total": 1692000, "timers": {"sample_time_ms": 20910.292, "sample_throughput": 191.293, "load_time_ms": 0.482, "load_throughput": 8303086.212, "learn_time_ms": 10645.863, "learn_throughput": 375.733, "update_time_ms": 2.051}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.076308418412803, "policy_loss": -0.014050508082233449, "vf_loss": 8.865255977005086, "vf_explained_var": 0.17510482559921922, "kl": 0.008531845877177053, "entropy": 0.1897534631232741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1692000, "num_agent_steps_sampled": 1692000, "num_steps_trained": 1692000, "num_agent_steps_trained": 1692000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17080, "training_iteration": 423, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-21-43", "timestamp": 1643703703, "time_this_iter_s": 20.75202512741089, "time_total_s": 12738.867387771606, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 479.35851073265076, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 29.982758620689655, "ram_util_percent": 67.32758620689654}}
{"episode_reward_max": -1.0, "episode_reward_min": -27.699999999999996, "episode_reward_mean": -10.215999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -5.300000000000001, -3.4, -3.3, -9.600000000000001, -8.399999999999999, -9.399999999999999, -10.200000000000001, -3.2, -18.5, -3.4, -4.300000000000001, -5.300000000000001, -11.5, -4.2, -2.8000000000000003, -5.4, -14.7, -25.3, -18.5, -14.799999999999999, -9.8, -4.2, -17.500000000000004, -7.799999999999999, -4.300000000000001, -14.8, -3.4, -11.7, -9.2, -7.300000000000001, -14.600000000000001, -3.3, -21.799999999999997, -7.399999999999999, -3.2, -14.299999999999997, -4.2, -12.499999999999996, -25.700000000000003, -14.299999999999997, -7.199999999999999, -16.099999999999994, -9.799999999999999, -4.300000000000001, -4.3, -6.300000000000001, -16.599999999999984, -2.2, -9.499999999999998, -3.4, -10.999999999999998, -16.2, -24.000000000000025, -3.2, -4.2, -10.099999999999998, -11.899999999999999, -14.7, -16.799999999999972, -14.2, -16.5, -5.2, -10.3, -15.999999999999998, -12.0, -2.2, -6.300000000000001, -14.699999999999996, -3.3, -20.0, -6.2, -5.300000000000001, -10.999999999999998, -4.6000000000000005, -4.4, -10.7, -4.300000000000001, -6.6, -27.699999999999996, -12.099999999999998, -9.399999999999997, -16.999999999999996, -3.3, -3.3, -5.2, -4.4, -14.199999999999998, -16.3, -11.2, -11.700000000000001, -16.999999999999996, -8.999999999999996, -12.899999999999997, -1.0, -27.5, -9.4, -3.8000000000000007, -14.69999999999998, -24.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0463166986547046, "mean_inference_ms": 1.3664780778089514, "mean_action_processing_ms": 0.07392685845972913, "mean_env_wait_ms": 6.193103054315288, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1696000, "timesteps_this_iter": 0, "agent_timesteps_total": 1696000, "timers": {"sample_time_ms": 21101.571, "sample_throughput": 189.559, "load_time_ms": 0.469, "load_throughput": 8532812.532, "learn_time_ms": 10468.496, "learn_throughput": 382.099, "update_time_ms": 1.976}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0690443898100526, "policy_loss": -0.017441713000817965, "vf_loss": 8.471717291653798, "vf_explained_var": 0.3549558432512386, "kl": 0.008844658930528295, "entropy": 0.20698173120617866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1696000, "num_agent_steps_sampled": 1696000, "num_steps_trained": 1696000, "num_agent_steps_trained": 1696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17120, "training_iteration": 424, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-22-04", "timestamp": 1643703724, "time_this_iter_s": 20.629637002944946, "time_total_s": 12759.497024774551, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 499.9881477355957, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.11333333333333, "ram_util_percent": 67.35333333333334}}
{"episode_reward_max": -1.0, "episode_reward_min": -114.59999999999977, "episode_reward_mean": -11.684999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.299999999999997, -7.199999999999999, -16.099999999999994, -9.799999999999999, -4.300000000000001, -4.3, -6.300000000000001, -16.599999999999984, -2.2, -9.499999999999998, -3.4, -10.999999999999998, -16.2, -24.000000000000025, -3.2, -4.2, -10.099999999999998, -11.899999999999999, -14.7, -16.799999999999972, -14.2, -16.5, -5.2, -10.3, -15.999999999999998, -12.0, -2.2, -6.300000000000001, -14.699999999999996, -3.3, -20.0, -6.2, -5.300000000000001, -10.999999999999998, -4.6000000000000005, -4.4, -10.7, -4.300000000000001, -6.6, -27.699999999999996, -12.099999999999998, -9.399999999999997, -16.999999999999996, -3.3, -3.3, -5.2, -4.4, -14.199999999999998, -16.3, -11.2, -11.700000000000001, -16.999999999999996, -8.999999999999996, -12.899999999999997, -1.0, -27.5, -9.4, -3.8000000000000007, -14.69999999999998, -24.8, -5.4, -3.3, -10.8, -6.4, -6.0, -3.2, -10.199999999999998, -5.3, -27.900000000000066, -3.4, -18.099999999999998, -12.7, -11.799999999999999, -3.3, -4.4, -5.2, -8.799999999999997, -7.799999999999999, -5.4, -71.2, -10.099999999999998, -4.300000000000001, -3.3, -17.5, -3.3, -26.6, -4.5, -5.3, -20.9, -114.59999999999977, -3.4, -3.3, -6.4, -4.2, -15.799999999999997, -3.3, -3.3, -13.799999999999995, -19.800000000000004, -18.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.048120921728517, "mean_inference_ms": 1.3718533096271692, "mean_action_processing_ms": 0.07421744753851428, "mean_env_wait_ms": 6.222538790359695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1700000, "timesteps_this_iter": 0, "agent_timesteps_total": 1700000, "timers": {"sample_time_ms": 20609.236, "sample_throughput": 194.088, "load_time_ms": 0.465, "load_throughput": 8607673.285, "learn_time_ms": 10409.142, "learn_throughput": 384.278, "update_time_ms": 1.933}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.782782349663396, "policy_loss": -0.010427518605545003, "vf_loss": 79.14915618153029, "vf_explained_var": -0.05910940221560899, "kl": 0.00859160767782586, "entropy": 0.17264053286804307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1700000, "num_agent_steps_sampled": 1700000, "num_steps_trained": 1700000, "num_agent_steps_trained": 1700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17160, "training_iteration": 425, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-22-25", "timestamp": 1643703745, "time_this_iter_s": 20.924614906311035, "time_total_s": 12780.421639680862, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 520.9127626419067, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.689999999999998, "ram_util_percent": 67.40000000000002}}
{"episode_reward_max": -1.0, "episode_reward_min": -114.59999999999977, "episode_reward_mean": -12.691999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.099999999999998, -9.399999999999997, -16.999999999999996, -3.3, -3.3, -5.2, -4.4, -14.199999999999998, -16.3, -11.2, -11.700000000000001, -16.999999999999996, -8.999999999999996, -12.899999999999997, -1.0, -27.5, -9.4, -3.8000000000000007, -14.69999999999998, -24.8, -5.4, -3.3, -10.8, -6.4, -6.0, -3.2, -10.199999999999998, -5.3, -27.900000000000066, -3.4, -18.099999999999998, -12.7, -11.799999999999999, -3.3, -4.4, -5.2, -8.799999999999997, -7.799999999999999, -5.4, -71.2, -10.099999999999998, -4.300000000000001, -3.3, -17.5, -3.3, -26.6, -4.5, -5.3, -20.9, -114.59999999999977, -3.4, -3.3, -6.4, -4.2, -15.799999999999997, -3.3, -3.3, -13.799999999999995, -19.800000000000004, -18.4, -4.4, -7.5, -12.6, -10.6, -13.999999999999998, -7.300000000000001, -9.3, -10.8, -11.099999999999998, -4.2, -8.8, -11.199999999999976, -17.8, -11.899999999999999, -24.199999999999996, -20.9, -6.0, -9.7, -18.1, -21.099999999999998, -3.2, -5.4, -4.300000000000001, -6.2, -18.500000000000004, -3.3, -7.799999999999999, -10.799999999999997, -23.600000000000037, -4.300000000000001, -14.5, -30.6, -19.5, -13.2, -5.300000000000001, -21.400000000000006, -6.2, -45.4, -14.999999999999996, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0510871285515369, "mean_inference_ms": 1.3775632756293936, "mean_action_processing_ms": 0.07452913081952502, "mean_env_wait_ms": 6.252331501174346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1704000, "timesteps_this_iter": 0, "agent_timesteps_total": 1704000, "timers": {"sample_time_ms": 20568.792, "sample_throughput": 194.469, "load_time_ms": 0.462, "load_throughput": 8660102.204, "learn_time_ms": 10444.873, "learn_throughput": 382.963, "update_time_ms": 1.958}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17140188396718073, "policy_loss": -0.0019913664928847743, "vf_loss": 17.099078288770492, "vf_explained_var": -0.029775736601121965, "kl": 0.012012343465003626, "entropy": 0.2284229172013139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1704000, "num_agent_steps_sampled": 1704000, "num_steps_trained": 1704000, "num_agent_steps_trained": 1704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17200, "training_iteration": 426, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-22-46", "timestamp": 1643703766, "time_this_iter_s": 20.887499809265137, "time_total_s": 12801.309139490128, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 541.8002624511719, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 35.86896551724137, "ram_util_percent": 67.41724137931035}}
{"episode_reward_max": -3.2, "episode_reward_min": -114.59999999999977, "episode_reward_mean": -12.633999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.099999999999998, -4.300000000000001, -3.3, -17.5, -3.3, -26.6, -4.5, -5.3, -20.9, -114.59999999999977, -3.4, -3.3, -6.4, -4.2, -15.799999999999997, -3.3, -3.3, -13.799999999999995, -19.800000000000004, -18.4, -4.4, -7.5, -12.6, -10.6, -13.999999999999998, -7.300000000000001, -9.3, -10.8, -11.099999999999998, -4.2, -8.8, -11.199999999999976, -17.8, -11.899999999999999, -24.199999999999996, -20.9, -6.0, -9.7, -18.1, -21.099999999999998, -3.2, -5.4, -4.300000000000001, -6.2, -18.500000000000004, -3.3, -7.799999999999999, -10.799999999999997, -23.600000000000037, -4.300000000000001, -14.5, -30.6, -19.5, -13.2, -5.300000000000001, -21.400000000000006, -6.2, -45.4, -14.999999999999996, -8.3, -4.300000000000001, -11.000000000000002, -3.2, -29.000000000000007, -5.300000000000001, -10.9, -4.4, -13.2, -4.4, -5.2, -8.3, -3.5000000000000004, -23.6, -3.2, -4.4, -10.7, -10.200000000000001, -7.3, -4.2, -6.2, -13.1, -16.3, -4.800000000000001, -26.5, -6.1, -27.80000000000003, -3.2, -7.5, -3.3, -32.80000000000002, -4.300000000000001, -19.5, -20.3, -4.2, -11.599999999999998, -17.8, -5.300000000000001, -17.6, -26.1, -12.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0545034849408517, "mean_inference_ms": 1.383785806359262, "mean_action_processing_ms": 0.07487017144783709, "mean_env_wait_ms": 6.282858302829648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1708000, "timesteps_this_iter": 0, "agent_timesteps_total": 1708000, "timers": {"sample_time_ms": 20679.233, "sample_throughput": 193.431, "load_time_ms": 0.467, "load_throughput": 8556311.71, "learn_time_ms": 10827.339, "learn_throughput": 369.435, "update_time_ms": 2.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16122598729274107, "policy_loss": 0.0036908680993703105, "vf_loss": 15.539343761885037, "vf_explained_var": 0.10204152817367225, "kl": 0.010708415683947134, "entropy": 0.20533448916769798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1708000, "num_agent_steps_sampled": 1708000, "num_steps_trained": 1708000, "num_agent_steps_trained": 1708000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17240, "training_iteration": 427, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-23-10", "timestamp": 1643703790, "time_this_iter_s": 24.23514986038208, "time_total_s": 12825.54428935051, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 566.035412311554, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 37.811428571428564, "ram_util_percent": 67.46000000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.4, "episode_reward_mean": -12.353, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -5.4, -4.300000000000001, -6.2, -18.500000000000004, -3.3, -7.799999999999999, -10.799999999999997, -23.600000000000037, -4.300000000000001, -14.5, -30.6, -19.5, -13.2, -5.300000000000001, -21.400000000000006, -6.2, -45.4, -14.999999999999996, -8.3, -4.300000000000001, -11.000000000000002, -3.2, -29.000000000000007, -5.300000000000001, -10.9, -4.4, -13.2, -4.4, -5.2, -8.3, -3.5000000000000004, -23.6, -3.2, -4.4, -10.7, -10.200000000000001, -7.3, -4.2, -6.2, -13.1, -16.3, -4.800000000000001, -26.5, -6.1, -27.80000000000003, -3.2, -7.5, -3.3, -32.80000000000002, -4.300000000000001, -19.5, -20.3, -4.2, -11.599999999999998, -17.8, -5.300000000000001, -17.6, -26.1, -12.4, -4.300000000000001, -30.800000000000004, -15.099999999999996, -20.800000000000004, -10.799999999999997, -7.299999999999999, -3.4, -22.200000000000003, -11.99999999999998, -3.3000000000000003, -5.4, -11.899999999999993, -4.4, -17.19999999999999, -4.4, -13.799999999999999, -8.3, -17.500000000000004, -41.2, -13.5, -3.3, -27.3, -12.999999999999998, -16.5, -7.3, -6.300000000000001, -4.300000000000001, -20.3, -4.300000000000001, -24.5, -3.3, -13.0, -11.399999999999999, -8.3, -16.299999999999997, -4.2, -4.3, -15.899999999999997, -19.499999999999986, -24.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0608733445670568, "mean_inference_ms": 1.3944418275654635, "mean_action_processing_ms": 0.07540875194349506, "mean_env_wait_ms": 6.3300074074656205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1712000, "timesteps_this_iter": 0, "agent_timesteps_total": 1712000, "timers": {"sample_time_ms": 21336.387, "sample_throughput": 187.473, "load_time_ms": 0.471, "load_throughput": 8483624.595, "learn_time_ms": 11006.506, "learn_throughput": 363.421, "update_time_ms": 2.046}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15405260724295933, "policy_loss": -0.015550874966767526, "vf_loss": 16.786413031239665, "vf_explained_var": 0.2083445962398283, "kl": 0.008696780955121062, "entropy": 0.2295537736427079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1712000, "num_agent_steps_sampled": 1712000, "num_steps_trained": 1712000, "num_agent_steps_trained": 1712000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17280, "training_iteration": 428, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-23-35", "timestamp": 1643703815, "time_this_iter_s": 24.241147994995117, "time_total_s": 12849.785437345505, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 590.2765603065491, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 40.19714285714285, "ram_util_percent": 67.5142857142857}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.2, "episode_reward_mean": -13.363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.1, -16.3, -4.800000000000001, -26.5, -6.1, -27.80000000000003, -3.2, -7.5, -3.3, -32.80000000000002, -4.300000000000001, -19.5, -20.3, -4.2, -11.599999999999998, -17.8, -5.300000000000001, -17.6, -26.1, -12.4, -4.300000000000001, -30.800000000000004, -15.099999999999996, -20.800000000000004, -10.799999999999997, -7.299999999999999, -3.4, -22.200000000000003, -11.99999999999998, -3.3000000000000003, -5.4, -11.899999999999993, -4.4, -17.19999999999999, -4.4, -13.799999999999999, -8.3, -17.500000000000004, -41.2, -13.5, -3.3, -27.3, -12.999999999999998, -16.5, -7.3, -6.300000000000001, -4.300000000000001, -20.3, -4.300000000000001, -24.5, -3.3, -13.0, -11.399999999999999, -8.3, -16.299999999999997, -4.2, -4.3, -15.899999999999997, -19.499999999999986, -24.599999999999998, -12.899999999999997, -5.2, -14.2, -5.3, -11.099999999999998, -7.2, -10.9, -17.599999999999998, -17.099999999999998, -15.299999999999995, -15.7, -3.4, -19.6, -14.4, -14.6, -8.599999999999998, -17.1, -8.3, -6.800000000000001, -19.7, -12.1, -17.8, -14.4, -3.3, -11.000000000000005, -15.900000000000011, -11.5, -14.799999999999999, -11.600000000000001, -31.80000000000006, -16.299999999999997, -10.199999999999998, -17.900000000000002, -3.3, -13.6, -10.5, -37.2, -6.300000000000001, -29.5, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0676414316310767, "mean_inference_ms": 1.4071083897701095, "mean_action_processing_ms": 0.0760716526718677, "mean_env_wait_ms": 6.387156170272516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1716000, "timesteps_this_iter": 0, "agent_timesteps_total": 1716000, "timers": {"sample_time_ms": 21699.877, "sample_throughput": 184.333, "load_time_ms": 0.475, "load_throughput": 8428644.059, "learn_time_ms": 11066.76, "learn_throughput": 361.443, "update_time_ms": 2.069}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16023778974739533, "policy_loss": -0.019722414804842842, "vf_loss": 17.742570418952614, "vf_explained_var": 0.2097529850980287, "kl": 0.012672516660199548, "entropy": 0.22339997286758115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1716000, "num_agent_steps_sampled": 1716000, "num_steps_trained": 1716000, "num_agent_steps_trained": 1716000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17320, "training_iteration": 429, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-23-58", "timestamp": 1643703838, "time_this_iter_s": 23.379659175872803, "time_total_s": 12873.165096521378, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 613.6562194824219, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 42.6969696969697, "ram_util_percent": 67.58484848484848}}
{"episode_reward_max": -3.2, "episode_reward_min": -37.2, "episode_reward_mean": -12.872000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -27.3, -12.999999999999998, -16.5, -7.3, -6.300000000000001, -4.300000000000001, -20.3, -4.300000000000001, -24.5, -3.3, -13.0, -11.399999999999999, -8.3, -16.299999999999997, -4.2, -4.3, -15.899999999999997, -19.499999999999986, -24.599999999999998, -12.899999999999997, -5.2, -14.2, -5.3, -11.099999999999998, -7.2, -10.9, -17.599999999999998, -17.099999999999998, -15.299999999999995, -15.7, -3.4, -19.6, -14.4, -14.6, -8.599999999999998, -17.1, -8.3, -6.800000000000001, -19.7, -12.1, -17.8, -14.4, -3.3, -11.000000000000005, -15.900000000000011, -11.5, -14.799999999999999, -11.600000000000001, -31.80000000000006, -16.299999999999997, -10.199999999999998, -17.900000000000002, -3.3, -13.6, -10.5, -37.2, -6.300000000000001, -29.5, -6.300000000000001, -25.500000000000018, -6.800000000000002, -10.499999999999998, -4.2, -7.1, -3.3, -10.0, -6.3, -6.2, -37.2, -8.599999999999998, -17.0, -19.099999999999998, -28.3, -4.4, -27.3, -7.499999999999999, -21.2, -11.5, -20.6, -9.1, -16.3, -25.700000000000003, -7.800000000000001, -7.3, -10.2, -17.09999999999999, -6.6999999999999975, -3.2, -13.799999999999994, -13.699999999999998, -5.899999999999999, -8.9, -3.3, -19.1, -10.499999999999998, -6.499999999999999, -9.5, -8.4, -13.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0756163323983403, "mean_inference_ms": 1.4197730728875733, "mean_action_processing_ms": 0.07673916376886959, "mean_env_wait_ms": 6.446033028844098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1720000, "timesteps_this_iter": 0, "agent_timesteps_total": 1720000, "timers": {"sample_time_ms": 21882.08, "sample_throughput": 182.798, "load_time_ms": 0.484, "load_throughput": 8258536.057, "learn_time_ms": 11598.397, "learn_throughput": 344.875, "update_time_ms": 2.1}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12977822142983636, "policy_loss": -0.01784698086720641, "vf_loss": 14.601843326963404, "vf_explained_var": 0.18635137670783586, "kl": 0.008033864214110597, "entropy": 0.24694473480665555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1720000, "num_agent_steps_sampled": 1720000, "num_steps_trained": 1720000, "num_agent_steps_trained": 1720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17360, "training_iteration": 430, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-24-26", "timestamp": 1643703866, "time_this_iter_s": 27.66813373565674, "time_total_s": 12900.833230257034, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 641.3243532180786, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 44.8051282051282, "ram_util_percent": 67.55897435897435}}
{"episode_reward_max": -3.2, "episode_reward_min": -37.2, "episode_reward_mean": -12.355000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.1, -17.8, -14.4, -3.3, -11.000000000000005, -15.900000000000011, -11.5, -14.799999999999999, -11.600000000000001, -31.80000000000006, -16.299999999999997, -10.199999999999998, -17.900000000000002, -3.3, -13.6, -10.5, -37.2, -6.300000000000001, -29.5, -6.300000000000001, -25.500000000000018, -6.800000000000002, -10.499999999999998, -4.2, -7.1, -3.3, -10.0, -6.3, -6.2, -37.2, -8.599999999999998, -17.0, -19.099999999999998, -28.3, -4.4, -27.3, -7.499999999999999, -21.2, -11.5, -20.6, -9.1, -16.3, -25.700000000000003, -7.800000000000001, -7.3, -10.2, -17.09999999999999, -6.6999999999999975, -3.2, -13.799999999999994, -13.699999999999998, -5.899999999999999, -8.9, -3.3, -19.1, -10.499999999999998, -6.499999999999999, -9.5, -8.4, -13.399999999999999, -3.4, -5.9, -5.300000000000001, -4.2, -4.300000000000001, -5.9, -12.099999999999998, -9.899999999999999, -6.299999999999999, -12.099999999999998, -6.4, -10.899999999999999, -21.599999999999998, -6.4, -19.099999999999998, -12.4, -8.3, -14.399999999999995, -5.5, -5.7, -3.8000000000000003, -15.099999999999998, -18.5, -4.3, -9.700000000000001, -28.3, -17.1, -11.899999999999999, -11.499999999999998, -24.799999999999997, -13.499999999999998, -6.3, -13.1, -5.2, -4.9, -3.3, -12.8, -15.000000000000005, -21.5, -20.500000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0834612010519433, "mean_inference_ms": 1.433900694220782, "mean_action_processing_ms": 0.07749156159915371, "mean_env_wait_ms": 6.514205747033177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1724000, "timesteps_this_iter": 0, "agent_timesteps_total": 1724000, "timers": {"sample_time_ms": 22768.092, "sample_throughput": 175.684, "load_time_ms": 0.504, "load_throughput": 7929115.743, "learn_time_ms": 11798.682, "learn_throughput": 339.021, "update_time_ms": 2.088}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08197663226815802, "policy_loss": -0.019508391344338977, "vf_loss": 9.943622298907208, "vf_explained_var": 0.11165252943192759, "kl": 0.010244025925655244, "entropy": 0.2437076178609684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1724000, "num_agent_steps_sampled": 1724000, "num_steps_trained": 1724000, "num_agent_steps_trained": 1724000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17400, "training_iteration": 431, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-24-51", "timestamp": 1643703891, "time_this_iter_s": 25.66969394683838, "time_total_s": 12926.502924203873, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 666.994047164917, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 39.283783783783775, "ram_util_percent": 67.41621621621623}}
{"episode_reward_max": -3.1, "episode_reward_min": -57.3, "episode_reward_mean": -11.309, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.1, -16.3, -25.700000000000003, -7.800000000000001, -7.3, -10.2, -17.09999999999999, -6.6999999999999975, -3.2, -13.799999999999994, -13.699999999999998, -5.899999999999999, -8.9, -3.3, -19.1, -10.499999999999998, -6.499999999999999, -9.5, -8.4, -13.399999999999999, -3.4, -5.9, -5.300000000000001, -4.2, -4.300000000000001, -5.9, -12.099999999999998, -9.899999999999999, -6.299999999999999, -12.099999999999998, -6.4, -10.899999999999999, -21.599999999999998, -6.4, -19.099999999999998, -12.4, -8.3, -14.399999999999995, -5.5, -5.7, -3.8000000000000003, -15.099999999999998, -18.5, -4.3, -9.700000000000001, -28.3, -17.1, -11.899999999999999, -11.499999999999998, -24.799999999999997, -13.499999999999998, -6.3, -13.1, -5.2, -4.9, -3.3, -12.8, -15.000000000000005, -21.5, -20.500000000000004, -3.1, -4.4, -4.300000000000001, -8.700000000000001, -4.4, -57.3, -23.500000000000004, -23.5, -4.4, -4.300000000000001, -5.800000000000001, -21.500000000000004, -5.199999999999999, -8.3, -8.8, -11.5, -15.19999999999997, -11.3, -13.799999999999994, -4.6000000000000005, -12.799999999999997, -7.2, -25.6, -16.0, -8.2, -5.2, -10.2, -5.2, -10.0, -11.099999999999987, -15.199999999999998, -7.4, -4.4, -4.2, -11.2, -6.699999999999999, -15.399999999999995, -30.3, -16.8, -6.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0914207711694497, "mean_inference_ms": 1.4451174909905553, "mean_action_processing_ms": 0.07809589638021235, "mean_env_wait_ms": 6.568858324449813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1728000, "timesteps_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"sample_time_ms": 23012.888, "sample_throughput": 173.816, "load_time_ms": 0.504, "load_throughput": 7937368.595, "learn_time_ms": 11971.002, "learn_throughput": 334.141, "update_time_ms": 2.108}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15263853907404887, "policy_loss": -0.02152814545683683, "vf_loss": 17.1904533446476, "vf_explained_var": 0.20662773482261165, "kl": 0.011310756229055518, "entropy": 0.25275699089291276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1728000, "num_agent_steps_sampled": 1728000, "num_steps_trained": 1728000, "num_agent_steps_trained": 1728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17440, "training_iteration": 432, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-25-14", "timestamp": 1643703914, "time_this_iter_s": 23.017136335372925, "time_total_s": 12949.520060539246, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 690.0111835002899, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 34.309090909090905, "ram_util_percent": 67.36363636363636}}
{"episode_reward_max": -3.1, "episode_reward_min": -57.3, "episode_reward_mean": -12.901000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000003, -15.099999999999998, -18.5, -4.3, -9.700000000000001, -28.3, -17.1, -11.899999999999999, -11.499999999999998, -24.799999999999997, -13.499999999999998, -6.3, -13.1, -5.2, -4.9, -3.3, -12.8, -15.000000000000005, -21.5, -20.500000000000004, -3.1, -4.4, -4.300000000000001, -8.700000000000001, -4.4, -57.3, -23.500000000000004, -23.5, -4.4, -4.300000000000001, -5.800000000000001, -21.500000000000004, -5.199999999999999, -8.3, -8.8, -11.5, -15.19999999999997, -11.3, -13.799999999999994, -4.6000000000000005, -12.799999999999997, -7.2, -25.6, -16.0, -8.2, -5.2, -10.2, -5.2, -10.0, -11.099999999999987, -15.199999999999998, -7.4, -4.4, -4.2, -11.2, -6.699999999999999, -15.399999999999995, -30.3, -16.8, -6.3, -15.3, -16.299999999999997, -13.600000000000001, -51.3, -8.2, -10.600000000000001, -9.899999999999999, -13.200000000000001, -7.300000000000001, -6.4, -35.1, -42.4, -8.5, -22.5, -11.6, -5.3, -14.499999999999998, -5.300000000000001, -18.699999999999992, -16.5, -16.699999999999996, -3.3, -3.3, -15.7, -15.5, -19.4, -5.2, -3.3, -10.0, -4.3, -4.7, -23.799999999999997, -19.199999999999992, -6.499999999999998, -5.4, -6.999999999999998, -9.2, -20.4, -13.899999999999999, -16.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.107823553452715, "mean_inference_ms": 1.465957538451449, "mean_action_processing_ms": 0.07927720243467035, "mean_env_wait_ms": 6.680078168256362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1732000, "timesteps_this_iter": 0, "agent_timesteps_total": 1732000, "timers": {"sample_time_ms": 24273.063, "sample_throughput": 164.792, "load_time_ms": 0.52, "load_throughput": 7689268.986, "learn_time_ms": 12418.45, "learn_throughput": 322.101, "update_time_ms": 2.164}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.18682943155928966, "policy_loss": -0.012746702026455633, "vf_loss": 19.780186913731278, "vf_explained_var": 0.06831335380513182, "kl": 0.008871335202682806, "entropy": 0.214264245323276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1732000, "num_agent_steps_sampled": 1732000, "num_steps_trained": 1732000, "num_agent_steps_trained": 1732000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17480, "training_iteration": 433, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-25-50", "timestamp": 1643703950, "time_this_iter_s": 35.43789219856262, "time_total_s": 12984.957952737808, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 725.4490756988525, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 48.83529411764707, "ram_util_percent": 67.36666666666667}}
{"episode_reward_max": -3.2, "episode_reward_min": -51.3, "episode_reward_mean": -12.580999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999997, -7.2, -25.6, -16.0, -8.2, -5.2, -10.2, -5.2, -10.0, -11.099999999999987, -15.199999999999998, -7.4, -4.4, -4.2, -11.2, -6.699999999999999, -15.399999999999995, -30.3, -16.8, -6.3, -15.3, -16.299999999999997, -13.600000000000001, -51.3, -8.2, -10.600000000000001, -9.899999999999999, -13.200000000000001, -7.300000000000001, -6.4, -35.1, -42.4, -8.5, -22.5, -11.6, -5.3, -14.499999999999998, -5.300000000000001, -18.699999999999992, -16.5, -16.699999999999996, -3.3, -3.3, -15.7, -15.5, -19.4, -5.2, -3.3, -10.0, -4.3, -4.7, -23.799999999999997, -19.199999999999992, -6.499999999999998, -5.4, -6.999999999999998, -9.2, -20.4, -13.899999999999999, -16.4, -26.9, -5.1, -9.3, -16.599999999999994, -8.4, -20.6, -17.6, -7.199999999999999, -4.3, -8.4, -4.2, -3.4, -13.599999999999998, -19.000000000000007, -4.3, -23.800000000000004, -7.999999999999998, -3.4, -15.899999999999997, -10.39999999999999, -4.2, -6.4, -6.8, -3.2, -38.3, -12.299999999999988, -8.799999999999999, -19.099999999999998, -15.799999999999988, -43.3, -10.8, -14.799999999999997, -3.3, -8.6, -4.3, -10.799999999999997, -9.899999999999999, -10.299999999999999, -6.300000000000001, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1237241571352408, "mean_inference_ms": 1.486560954227242, "mean_action_processing_ms": 0.08045372089174842, "mean_env_wait_ms": 6.788831656921628, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1736000, "timesteps_this_iter": 0, "agent_timesteps_total": 1736000, "timers": {"sample_time_ms": 24976.095, "sample_throughput": 160.153, "load_time_ms": 0.524, "load_throughput": 7626700.609, "learn_time_ms": 12544.635, "learn_throughput": 318.861, "update_time_ms": 2.216}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13366813083775142, "policy_loss": -0.013768158710852105, "vf_loss": 14.587926742210183, "vf_explained_var": 0.11798978826051117, "kl": 0.007785124544274982, "entropy": 0.25397080402540906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1736000, "num_agent_steps_sampled": 1736000, "num_steps_trained": 1736000, "num_agent_steps_trained": 1736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17520, "training_iteration": 434, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-26-14", "timestamp": 1643703974, "time_this_iter_s": 24.43295407295227, "time_total_s": 13009.39090681076, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 749.8820297718048, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 36.005714285714284, "ram_util_percent": 67.29142857142857}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.3, "episode_reward_mean": -11.184, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.699999999999996, -3.3, -3.3, -15.7, -15.5, -19.4, -5.2, -3.3, -10.0, -4.3, -4.7, -23.799999999999997, -19.199999999999992, -6.499999999999998, -5.4, -6.999999999999998, -9.2, -20.4, -13.899999999999999, -16.4, -26.9, -5.1, -9.3, -16.599999999999994, -8.4, -20.6, -17.6, -7.199999999999999, -4.3, -8.4, -4.2, -3.4, -13.599999999999998, -19.000000000000007, -4.3, -23.800000000000004, -7.999999999999998, -3.4, -15.899999999999997, -10.39999999999999, -4.2, -6.4, -6.8, -3.2, -38.3, -12.299999999999988, -8.799999999999999, -19.099999999999998, -15.799999999999988, -43.3, -10.8, -14.799999999999997, -3.3, -8.6, -4.3, -10.799999999999997, -9.899999999999999, -10.299999999999999, -6.300000000000001, -5.300000000000001, -5.3, -9.2, -27.600000000000055, -8.499999999999996, -9.8, -4.5, -7.399999999999999, -4.300000000000001, -4.800000000000001, -4.3, -26.60000000000002, -10.3, -16.499999999999996, -39.2, -14.4, -5.2, -4.4, -5.300000000000001, -13.7, -25.000000000000007, -4.3, -5.4, -9.900000000000002, -9.4, -4.800000000000001, -14.19999999999997, -4.2, -10.0, -5.2, -22.10000000000001, -4.4, -10.3, -10.3, -19.700000000000003, -8.9, -4.4, -3.3, -3.2, -3.3, -18.599999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1363208771238975, "mean_inference_ms": 1.5056791437296642, "mean_action_processing_ms": 0.08152249355694359, "mean_env_wait_ms": 6.882660849321229, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1740000, "timesteps_this_iter": 0, "agent_timesteps_total": 1740000, "timers": {"sample_time_ms": 25510.842, "sample_throughput": 156.796, "load_time_ms": 0.546, "load_throughput": 7320860.497, "learn_time_ms": 13069.905, "learn_throughput": 306.047, "update_time_ms": 2.313}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1229669297855067, "policy_loss": -0.009070456823113785, "vf_loss": 13.095094028083228, "vf_explained_var": 0.1855067248626422, "kl": 0.0054322446994780685, "entropy": 0.19717694917513479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1740000, "num_agent_steps_sampled": 1740000, "num_steps_trained": 1740000, "num_agent_steps_trained": 1740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17560, "training_iteration": 435, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-26-45", "timestamp": 1643704005, "time_this_iter_s": 30.26389193534851, "time_total_s": 13039.654798746109, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 780.1459217071533, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 44.0906976744186, "ram_util_percent": 67.34883720930232}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.3, "episode_reward_mean": -10.599, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -6.4, -6.8, -3.2, -38.3, -12.299999999999988, -8.799999999999999, -19.099999999999998, -15.799999999999988, -43.3, -10.8, -14.799999999999997, -3.3, -8.6, -4.3, -10.799999999999997, -9.899999999999999, -10.299999999999999, -6.300000000000001, -5.300000000000001, -5.3, -9.2, -27.600000000000055, -8.499999999999996, -9.8, -4.5, -7.399999999999999, -4.300000000000001, -4.800000000000001, -4.3, -26.60000000000002, -10.3, -16.499999999999996, -39.2, -14.4, -5.2, -4.4, -5.300000000000001, -13.7, -25.000000000000007, -4.3, -5.4, -9.900000000000002, -9.4, -4.800000000000001, -14.19999999999997, -4.2, -10.0, -5.2, -22.10000000000001, -4.4, -10.3, -10.3, -19.700000000000003, -8.9, -4.4, -3.3, -3.2, -3.3, -18.599999999999987, -18.799999999999997, -4.2, -4.3, -16.399999999999995, -5.0, -5.3, -9.700000000000001, -4.2, -4.300000000000001, -11.2, -8.0, -4.2, -10.599999999999996, -21.200000000000003, -26.099999999999994, -19.0, -9.700000000000001, -5.9, -22.200000000000003, -14.999999999999998, -3.4, -4.300000000000001, -13.599999999999998, -17.3, -16.799999999999986, -4.300000000000001, -8.4, -21.800000000000004, -7.3, -12.600000000000001, -11.0, -8.2, -3.3, -5.300000000000001, -3.2, -4.300000000000001, -8.7, -7.800000000000001, -5.0, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1510389310317015, "mean_inference_ms": 1.5284544181335589, "mean_action_processing_ms": 0.08276583500922133, "mean_env_wait_ms": 6.997437889900217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1744000, "timesteps_this_iter": 0, "agent_timesteps_total": 1744000, "timers": {"sample_time_ms": 27004.149, "sample_throughput": 148.125, "load_time_ms": 0.588, "load_throughput": 6801757.885, "learn_time_ms": 13559.006, "learn_throughput": 295.007, "update_time_ms": 2.385}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0735110515666004, "policy_loss": -0.015045963699919403, "vf_loss": 8.691310976589879, "vf_explained_var": 0.2230315783331471, "kl": 0.008219531649946422, "entropy": 0.19779005139585465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1744000, "num_agent_steps_sampled": 1744000, "num_steps_trained": 1744000, "num_agent_steps_trained": 1744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17600, "training_iteration": 436, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-27-20", "timestamp": 1643704040, "time_this_iter_s": 35.443419218063354, "time_total_s": 13075.098217964172, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 815.5893409252167, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 53.80980392156862, "ram_util_percent": 67.27058823529411}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.4, "episode_reward_mean": -11.387, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -5.4, -9.900000000000002, -9.4, -4.800000000000001, -14.19999999999997, -4.2, -10.0, -5.2, -22.10000000000001, -4.4, -10.3, -10.3, -19.700000000000003, -8.9, -4.4, -3.3, -3.2, -3.3, -18.599999999999987, -18.799999999999997, -4.2, -4.3, -16.399999999999995, -5.0, -5.3, -9.700000000000001, -4.2, -4.300000000000001, -11.2, -8.0, -4.2, -10.599999999999996, -21.200000000000003, -26.099999999999994, -19.0, -9.700000000000001, -5.9, -22.200000000000003, -14.999999999999998, -3.4, -4.300000000000001, -13.599999999999998, -17.3, -16.799999999999986, -4.300000000000001, -8.4, -21.800000000000004, -7.3, -12.600000000000001, -11.0, -8.2, -3.3, -5.300000000000001, -3.2, -4.300000000000001, -8.7, -7.800000000000001, -5.0, -3.2, -3.3, -5.8, -17.499999999999993, -7.199999999999999, -7.299999999999999, -5.4, -7.399999999999999, -13.299999999999999, -4.3, -12.399999999999997, -18.5, -3.3, -4.4, -10.799999999999997, -4.3, -4.300000000000001, -6.4, -4.2, -16.6, -70.3, -39.600000000000016, -5.3, -4.3, -14.099999999999998, -12.3, -3.3, -19.800000000000004, -22.999999999999996, -20.800000000000004, -3.2, -17.7, -8.8, -89.4, -4.300000000000001, -24.799999999999997, -4.300000000000001, -3.3, -3.4, -29.40000000000004, -9.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1664382112904446, "mean_inference_ms": 1.5508367594157908, "mean_action_processing_ms": 0.08397891698151123, "mean_env_wait_ms": 7.111987851203353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1748000, "timesteps_this_iter": 0, "agent_timesteps_total": 1748000, "timers": {"sample_time_ms": 27834.311, "sample_throughput": 143.708, "load_time_ms": 0.604, "load_throughput": 6618492.248, "learn_time_ms": 13876.256, "learn_throughput": 288.262, "update_time_ms": 2.381}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5840420465187861, "policy_loss": -0.008095686145687616, "vf_loss": 59.07191430484095, "vf_explained_var": 0.08989249986986961, "kl": 0.007093017652861587, "entropy": 0.18520898884663017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1748000, "num_agent_steps_sampled": 1748000, "num_steps_trained": 1748000, "num_agent_steps_trained": 1748000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17640, "training_iteration": 437, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-27-51", "timestamp": 1643704071, "time_this_iter_s": 30.806652069091797, "time_total_s": 13105.904870033264, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 846.3959929943085, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 48.66136363636363, "ram_util_percent": 67.27045454545454}}
{"episode_reward_max": -3.2, "episode_reward_min": -100.2, "episode_reward_mean": -13.76, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -4.300000000000001, -13.599999999999998, -17.3, -16.799999999999986, -4.300000000000001, -8.4, -21.800000000000004, -7.3, -12.600000000000001, -11.0, -8.2, -3.3, -5.300000000000001, -3.2, -4.300000000000001, -8.7, -7.800000000000001, -5.0, -3.2, -3.3, -5.8, -17.499999999999993, -7.199999999999999, -7.299999999999999, -5.4, -7.399999999999999, -13.299999999999999, -4.3, -12.399999999999997, -18.5, -3.3, -4.4, -10.799999999999997, -4.3, -4.300000000000001, -6.4, -4.2, -16.6, -70.3, -39.600000000000016, -5.3, -4.3, -14.099999999999998, -12.3, -3.3, -19.800000000000004, -22.999999999999996, -20.800000000000004, -3.2, -17.7, -8.8, -89.4, -4.300000000000001, -24.799999999999997, -4.300000000000001, -3.3, -3.4, -29.40000000000004, -9.599999999999998, -5.3, -3.2, -5.2, -24.099999999999998, -15.899999999999999, -11.5, -3.7, -14.1, -31.50000000000004, -5.2, -23.500000000000004, -3.2, -4.3, -17.9, -14.499999999999995, -10.3, -18.500000000000004, -7.2, -6.2, -6.2, -14.999999999999995, -3.2, -4.2, -11.399999999999999, -4.4, -17.1, -5.300000000000001, -17.2, -14.600000000000001, -3.2, -94.3, -15.0, -29.3, -25.6, -6.5, -100.2, -3.3, -19.9, -13.0, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1758661309034373, "mean_inference_ms": 1.5654298846856929, "mean_action_processing_ms": 0.08478298446144268, "mean_env_wait_ms": 7.186555898942373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1752000, "timesteps_this_iter": 0, "agent_timesteps_total": 1752000, "timers": {"sample_time_ms": 28125.965, "sample_throughput": 142.217, "load_time_ms": 0.603, "load_throughput": 6631572.789, "learn_time_ms": 13863.071, "learn_throughput": 288.536, "update_time_ms": 2.357}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.9974429549436555, "policy_loss": -0.01151485654215018, "vf_loss": 100.69262024535928, "vf_explained_var": 0.0819659560598353, "kl": 0.010158162777512504, "entropy": 0.25749228639147614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1752000, "num_agent_steps_sampled": 1752000, "num_steps_trained": 1752000, "num_agent_steps_trained": 1752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17680, "training_iteration": 438, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-28-15", "timestamp": 1643704095, "time_this_iter_s": 23.851897716522217, "time_total_s": 13129.756767749786, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 870.2478907108307, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 38.60588235294118, "ram_util_percent": 67.23235294117649}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -100.2, "episode_reward_mean": -13.770999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.600000000000016, -5.3, -4.3, -14.099999999999998, -12.3, -3.3, -19.800000000000004, -22.999999999999996, -20.800000000000004, -3.2, -17.7, -8.8, -89.4, -4.300000000000001, -24.799999999999997, -4.300000000000001, -3.3, -3.4, -29.40000000000004, -9.599999999999998, -5.3, -3.2, -5.2, -24.099999999999998, -15.899999999999999, -11.5, -3.7, -14.1, -31.50000000000004, -5.2, -23.500000000000004, -3.2, -4.3, -17.9, -14.499999999999995, -10.3, -18.500000000000004, -7.2, -6.2, -6.2, -14.999999999999995, -3.2, -4.2, -11.399999999999999, -4.4, -17.1, -5.300000000000001, -17.2, -14.600000000000001, -3.2, -94.3, -15.0, -29.3, -25.6, -6.5, -100.2, -3.3, -19.9, -13.0, -4.3, -3.3, -17.7, -11.0, -3.4, -3.3, -3.2, -15.099999999999998, -6.199999999999999, -3.3, -6.6000000000000005, -3.3, -4.4, -7.899999999999999, -13.3, -22.2, -7.3, -14.899999999999993, -4.3, -6.4, -4.2, -17.999999999999993, -10.999999999999998, -10.2, -12.3, -21.699999999999996, -4.3, -14.999999999999995, -4.300000000000001, -7.300000000000001, -22.799999999999997, -3.4, -13.199999999999973, -2.9000000000000004, -8.399999999999999, -14.5, -16.4, -13.499999999999995, -3.2, -16.6, -17.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1792500962609522, "mean_inference_ms": 1.5714502161515411, "mean_action_processing_ms": 0.08512149943069115, "mean_env_wait_ms": 7.2156539567912645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1756000, "timesteps_this_iter": 0, "agent_timesteps_total": 1756000, "timers": {"sample_time_ms": 28060.343, "sample_throughput": 142.55, "load_time_ms": 0.62, "load_throughput": 6446824.47, "learn_time_ms": 13840.56, "learn_throughput": 289.006, "update_time_ms": 2.368}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08406285080578058, "policy_loss": -0.00805659200795876, "vf_loss": 9.02928929995465, "vf_explained_var": 0.20066009676584634, "kl": 0.009132771291411936, "entropy": 0.1918135641322982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1756000, "num_agent_steps_sampled": 1756000, "num_steps_trained": 1756000, "num_agent_steps_trained": 1756000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17720, "training_iteration": 439, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-28-38", "timestamp": 1643704118, "time_this_iter_s": 22.64348816871643, "time_total_s": 13152.400255918503, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 892.8913788795471, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.006249999999994, "ram_util_percent": 67.24375}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -100.2, "episode_reward_mean": -13.427999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.999999999999995, -3.2, -4.2, -11.399999999999999, -4.4, -17.1, -5.300000000000001, -17.2, -14.600000000000001, -3.2, -94.3, -15.0, -29.3, -25.6, -6.5, -100.2, -3.3, -19.9, -13.0, -4.3, -3.3, -17.7, -11.0, -3.4, -3.3, -3.2, -15.099999999999998, -6.199999999999999, -3.3, -6.6000000000000005, -3.3, -4.4, -7.899999999999999, -13.3, -22.2, -7.3, -14.899999999999993, -4.3, -6.4, -4.2, -17.999999999999993, -10.999999999999998, -10.2, -12.3, -21.699999999999996, -4.3, -14.999999999999995, -4.300000000000001, -7.300000000000001, -22.799999999999997, -3.4, -13.199999999999973, -2.9000000000000004, -8.399999999999999, -14.5, -16.4, -13.499999999999995, -3.2, -16.6, -17.6, -16.499999999999996, -19.5, -16.9, -6.4, -14.3, -26.3, -3.3, -6.300000000000001, -22.599999999999998, -3.3, -15.199999999999996, -3.2, -12.199999999999973, -30.4, -5.300000000000001, -8.3, -5.3, -5.2, -40.4, -8.2, -20.699999999999996, -27.3, -5.4, -20.9, -30.3, -5.4, -8.600000000000001, -8.2, -5.2, -9.1, -6.300000000000001, -30.700000000000006, -12.6, -3.900000000000001, -15.499999999999996, -15.799999999999999, -6.1, -11.699999999999996, -10.799999999999999, -14.299999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1821340522776091, "mean_inference_ms": 1.5759426126745313, "mean_action_processing_ms": 0.0853766825269826, "mean_env_wait_ms": 7.237303102011908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1760000, "timesteps_this_iter": 0, "agent_timesteps_total": 1760000, "timers": {"sample_time_ms": 28066.339, "sample_throughput": 142.519, "load_time_ms": 0.616, "load_throughput": 6497004.996, "learn_time_ms": 13927.018, "learn_throughput": 287.212, "update_time_ms": 2.873}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17962991852884092, "policy_loss": -0.010646800551142904, "vf_loss": 18.871743049736946, "vf_explained_var": 0.13663779689419653, "kl": 0.007796471112608431, "entropy": 0.23116533833165323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1760000, "num_agent_steps_sampled": 1760000, "num_steps_trained": 1760000, "num_agent_steps_trained": 1760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17760, "training_iteration": 440, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-29-07", "timestamp": 1643704147, "time_this_iter_s": 28.92364001274109, "time_total_s": 13181.323895931244, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 921.8150188922882, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 44.443902439024384, "ram_util_percent": 67.2560975609756}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -40.4, "episode_reward_mean": -11.700999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.999999999999993, -10.999999999999998, -10.2, -12.3, -21.699999999999996, -4.3, -14.999999999999995, -4.300000000000001, -7.300000000000001, -22.799999999999997, -3.4, -13.199999999999973, -2.9000000000000004, -8.399999999999999, -14.5, -16.4, -13.499999999999995, -3.2, -16.6, -17.6, -16.499999999999996, -19.5, -16.9, -6.4, -14.3, -26.3, -3.3, -6.300000000000001, -22.599999999999998, -3.3, -15.199999999999996, -3.2, -12.199999999999973, -30.4, -5.300000000000001, -8.3, -5.3, -5.2, -40.4, -8.2, -20.699999999999996, -27.3, -5.4, -20.9, -30.3, -5.4, -8.600000000000001, -8.2, -5.2, -9.1, -6.300000000000001, -30.700000000000006, -12.6, -3.900000000000001, -15.499999999999996, -15.799999999999999, -6.1, -11.699999999999996, -10.799999999999999, -14.299999999999995, -2.9000000000000004, -21.20000000000007, -15.4, -14.699999999999978, -8.999999999999996, -10.2, -7.999999999999999, -6.399999999999999, -8.499999999999991, -13.799999999999999, -8.5, -4.2, -20.099999999999994, -5.2, -18.200000000000028, -22.6, -5.300000000000001, -5.300000000000001, -6.4, -5.8999999999999995, -6.300000000000001, -11.2, -3.3, -4.4, -28.00000000000001, -4.1, -3.2, -8.5, -4.3, -3.3, -5.3, -19.5, -7.5, -19.8, -3.8000000000000003, -10.099999999999996, -11.3, -20.2, -5.4, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1847117419356417, "mean_inference_ms": 1.5788165877467009, "mean_action_processing_ms": 0.0855324769280114, "mean_env_wait_ms": 7.2512550447267605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1764000, "timesteps_this_iter": 0, "agent_timesteps_total": 1764000, "timers": {"sample_time_ms": 27864.147, "sample_throughput": 143.554, "load_time_ms": 0.579, "load_throughput": 6910175.872, "learn_time_ms": 13567.035, "learn_throughput": 294.832, "update_time_ms": 2.885}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06558387688841791, "policy_loss": -0.024434157618151237, "vf_loss": 8.771023495863842, "vf_explained_var": 0.06958019701383447, "kl": 0.011539004687595748, "entropy": 0.24365640540597258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1764000, "num_agent_steps_sampled": 1764000, "num_steps_trained": 1764000, "num_agent_steps_trained": 1764000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17800, "training_iteration": 441, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-29-26", "timestamp": 1643704166, "time_this_iter_s": 19.058521270751953, "time_total_s": 13200.382417201996, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 940.8735401630402, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 35.49285714285714, "ram_util_percent": 67.275}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -48.1, "episode_reward_mean": -11.443000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.699999999999996, -27.3, -5.4, -20.9, -30.3, -5.4, -8.600000000000001, -8.2, -5.2, -9.1, -6.300000000000001, -30.700000000000006, -12.6, -3.900000000000001, -15.499999999999996, -15.799999999999999, -6.1, -11.699999999999996, -10.799999999999999, -14.299999999999995, -2.9000000000000004, -21.20000000000007, -15.4, -14.699999999999978, -8.999999999999996, -10.2, -7.999999999999999, -6.399999999999999, -8.499999999999991, -13.799999999999999, -8.5, -4.2, -20.099999999999994, -5.2, -18.200000000000028, -22.6, -5.300000000000001, -5.300000000000001, -6.4, -5.8999999999999995, -6.300000000000001, -11.2, -3.3, -4.4, -28.00000000000001, -4.1, -3.2, -8.5, -4.3, -3.3, -5.3, -19.5, -7.5, -19.8, -3.8000000000000003, -10.099999999999996, -11.3, -20.2, -5.4, -4.3, -26.500000000000004, -19.3, -5.1000000000000005, -3.2, -7.300000000000001, -11.999999999999975, -17.799999999999997, -12.3, -20.4, -17.999999999999996, -5.3, -10.699999999999996, -12.399999999999999, -4.3, -28.5, -4.300000000000001, -15.799999999999995, -16.399999999999988, -3.4, -9.099999999999996, -5.2, -20.100000000000012, -4.700000000000001, -5.4, -11.3, -3.3, -5.3, -5.300000000000001, -3.3, -8.3, -14.09999999999999, -4.4, -4.300000000000001, -14.399999999999983, -48.1, -26.400000000000002, -4.2, -8.5, -25.800000000000004, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1852760172909145, "mean_inference_ms": 1.5785057601881665, "mean_action_processing_ms": 0.08552100070916684, "mean_env_wait_ms": 7.249473492566633, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1768000, "timesteps_this_iter": 0, "agent_timesteps_total": 1768000, "timers": {"sample_time_ms": 27344.978, "sample_throughput": 146.279, "load_time_ms": 0.567, "load_throughput": 7056069.311, "learn_time_ms": 13167.658, "learn_throughput": 303.775, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16388605919776744, "policy_loss": -0.010526081350862339, "vf_loss": 17.298956410602855, "vf_explained_var": 0.17886569423060264, "kl": 0.00711288900780958, "entropy": 0.2193937655738605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1768000, "num_agent_steps_sampled": 1768000, "num_steps_trained": 1768000, "num_agent_steps_trained": 1768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17840, "training_iteration": 442, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-29-43", "timestamp": 1643704183, "time_this_iter_s": 17.429987907409668, "time_total_s": 13217.812405109406, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 958.3035280704498, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.4125, "ram_util_percent": 67.17916666666667}}
{"episode_reward_max": -3.2, "episode_reward_min": -106.09999999999985, "episode_reward_mean": -13.041999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -11.2, -3.3, -4.4, -28.00000000000001, -4.1, -3.2, -8.5, -4.3, -3.3, -5.3, -19.5, -7.5, -19.8, -3.8000000000000003, -10.099999999999996, -11.3, -20.2, -5.4, -4.3, -26.500000000000004, -19.3, -5.1000000000000005, -3.2, -7.300000000000001, -11.999999999999975, -17.799999999999997, -12.3, -20.4, -17.999999999999996, -5.3, -10.699999999999996, -12.399999999999999, -4.3, -28.5, -4.300000000000001, -15.799999999999995, -16.399999999999988, -3.4, -9.099999999999996, -5.2, -20.100000000000012, -4.700000000000001, -5.4, -11.3, -3.3, -5.3, -5.300000000000001, -3.3, -8.3, -14.09999999999999, -4.4, -4.300000000000001, -14.399999999999983, -48.1, -26.400000000000002, -4.2, -8.5, -25.800000000000004, -5.4, -14.299999999999995, -39.9, -13.500000000000002, -5.300000000000001, -3.3, -14.2, -8.899999999999999, -3.2, -19.7, -24.500000000000004, -18.799999999999997, -4.7, -11.8, -6.4, -3.4, -18.7, -5.2, -25.5, -6.300000000000001, -11.699999999999998, -8.299999999999999, -17.299999999999997, -11.9, -20.6, -8.3, -6.699999999999999, -20.599999999999998, -106.09999999999985, -13.899999999999997, -12.699999999999998, -13.699999999999998, -14.7, -5.300000000000001, -12.999999999999998, -3.3, -8.3, -9.899999999999999, -45.2, -11.3, -30.099999999999984], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.183488664363567, "mean_inference_ms": 1.575474973883976, "mean_action_processing_ms": 0.08535630082525575, "mean_env_wait_ms": 7.233741834143407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1772000, "timesteps_this_iter": 0, "agent_timesteps_total": 1772000, "timers": {"sample_time_ms": 25764.709, "sample_throughput": 155.251, "load_time_ms": 0.54, "load_throughput": 7400624.614, "learn_time_ms": 12610.625, "learn_throughput": 317.193, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.6116578163368808, "policy_loss": -0.01895077374353204, "vf_loss": 62.88372264087841, "vf_explained_var": -0.08603553131062497, "kl": 0.008856920243325054, "entropy": 0.2724284595459379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1772000, "num_agent_steps_sampled": 1772000, "num_steps_trained": 1772000, "num_agent_steps_trained": 1772000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17880, "training_iteration": 443, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-30-02", "timestamp": 1643704202, "time_this_iter_s": 18.73375630378723, "time_total_s": 13236.546161413193, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 977.0372843742371, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 41.86296296296297, "ram_util_percent": 67.0925925925926}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -106.09999999999985, "episode_reward_mean": -13.786000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -20.100000000000012, -4.700000000000001, -5.4, -11.3, -3.3, -5.3, -5.300000000000001, -3.3, -8.3, -14.09999999999999, -4.4, -4.300000000000001, -14.399999999999983, -48.1, -26.400000000000002, -4.2, -8.5, -25.800000000000004, -5.4, -14.299999999999995, -39.9, -13.500000000000002, -5.300000000000001, -3.3, -14.2, -8.899999999999999, -3.2, -19.7, -24.500000000000004, -18.799999999999997, -4.7, -11.8, -6.4, -3.4, -18.7, -5.2, -25.5, -6.300000000000001, -11.699999999999998, -8.299999999999999, -17.299999999999997, -11.9, -20.6, -8.3, -6.699999999999999, -20.599999999999998, -106.09999999999985, -13.899999999999997, -12.699999999999998, -13.699999999999998, -14.7, -5.300000000000001, -12.999999999999998, -3.3, -8.3, -9.899999999999999, -45.2, -11.3, -30.099999999999984, -7.3, -9.799999999999999, -7.199999999999999, -5.2, -20.0, -69.89999999999999, -3.2, -22.7, -4.2, -12.399999999999995, -4.700000000000001, -7.499999999999999, -37.099999999999994, -10.9, -6.1, -5.3, -5.2, -3.3000000000000003, -17.900000000000006, -4.2, -5.4, -4.2, -2.4000000000000004, -4.4, -4.2, -8.8, -4.9, -24.500000000000004, -33.2, -13.499999999999998, -24.50000000000009, -12.9, -10.600000000000001, -4.800000000000001, -11.899999999999999, -17.7, -27.200000000000035, -21.2, -5.2, -4.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1820957667113234, "mean_inference_ms": 1.5741742961715937, "mean_action_processing_ms": 0.08527262360692511, "mean_env_wait_ms": 7.226156356963635, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1776000, "timesteps_this_iter": 0, "agent_timesteps_total": 1776000, "timers": {"sample_time_ms": 25073.492, "sample_throughput": 159.531, "load_time_ms": 0.556, "load_throughput": 7195580.717, "learn_time_ms": 12189.247, "learn_throughput": 328.158, "update_time_ms": 2.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.27950165279870554, "policy_loss": -0.01623173031069699, "vf_loss": 29.410839107985137, "vf_explained_var": -0.03273922461335377, "kl": 0.008124995593589535, "entropy": 0.2188701261596013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1776000, "num_agent_steps_sampled": 1776000, "num_steps_trained": 1776000, "num_agent_steps_trained": 1776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17920, "training_iteration": 444, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-30-21", "timestamp": 1643704221, "time_this_iter_s": 18.886910915374756, "time_total_s": 13255.433072328568, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 995.9241952896118, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 44.2, "ram_util_percent": 67.08888888888887}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -106.09999999999985, "episode_reward_mean": -14.318, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.299999999999999, -17.299999999999997, -11.9, -20.6, -8.3, -6.699999999999999, -20.599999999999998, -106.09999999999985, -13.899999999999997, -12.699999999999998, -13.699999999999998, -14.7, -5.300000000000001, -12.999999999999998, -3.3, -8.3, -9.899999999999999, -45.2, -11.3, -30.099999999999984, -7.3, -9.799999999999999, -7.199999999999999, -5.2, -20.0, -69.89999999999999, -3.2, -22.7, -4.2, -12.399999999999995, -4.700000000000001, -7.499999999999999, -37.099999999999994, -10.9, -6.1, -5.3, -5.2, -3.3000000000000003, -17.900000000000006, -4.2, -5.4, -4.2, -2.4000000000000004, -4.4, -4.2, -8.8, -4.9, -24.500000000000004, -33.2, -13.499999999999998, -24.50000000000009, -12.9, -10.600000000000001, -4.800000000000001, -11.899999999999999, -17.7, -27.200000000000035, -21.2, -5.2, -4.700000000000001, -22.5, -4.2, -4.300000000000001, -8.4, -6.1, -24.700000000000003, -6.2, -10.3, -5.300000000000001, -22.1, -14.299999999999978, -13.2, -12.2, -3.3, -20.9, -4.2, -38.000000000000014, -9.4, -3.3, -25.400000000000006, -26.699999999999996, -15.599999999999998, -4.5, -4.3, -11.3, -16.3, -5.9, -9.2, -22.9, -8.599999999999998, -36.7, -5.2, -13.3, -11.999999999999998, -9.9, -17.2, -28.100000000000048, -8.299999999999999, -7.2, -18.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1795736628047089, "mean_inference_ms": 1.571588295558791, "mean_action_processing_ms": 0.0851225183250495, "mean_env_wait_ms": 7.212918883961257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1780000, "timesteps_this_iter": 0, "agent_timesteps_total": 1780000, "timers": {"sample_time_ms": 24031.236, "sample_throughput": 166.45, "load_time_ms": 0.523, "load_throughput": 7654188.603, "learn_time_ms": 11426.148, "learn_throughput": 350.074, "update_time_ms": 2.582}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1922138921515916, "policy_loss": -0.01487388857690397, "vf_loss": 20.431904805603846, "vf_explained_var": 0.16643532194117064, "kl": 0.013843693227556634, "entropy": 0.24359065113208628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1780000, "num_agent_steps_sampled": 1780000, "num_steps_trained": 1780000, "num_agent_steps_trained": 1780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17960, "training_iteration": 445, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-30-37", "timestamp": 1643704237, "time_this_iter_s": 16.421128273010254, "time_total_s": 13271.854200601578, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1012.3453235626221, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.2608695652174, "ram_util_percent": 67.09999999999997}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -38.000000000000014, "episode_reward_mean": -11.940999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -4.2, -2.4000000000000004, -4.4, -4.2, -8.8, -4.9, -24.500000000000004, -33.2, -13.499999999999998, -24.50000000000009, -12.9, -10.600000000000001, -4.800000000000001, -11.899999999999999, -17.7, -27.200000000000035, -21.2, -5.2, -4.700000000000001, -22.5, -4.2, -4.300000000000001, -8.4, -6.1, -24.700000000000003, -6.2, -10.3, -5.300000000000001, -22.1, -14.299999999999978, -13.2, -12.2, -3.3, -20.9, -4.2, -38.000000000000014, -9.4, -3.3, -25.400000000000006, -26.699999999999996, -15.599999999999998, -4.5, -4.3, -11.3, -16.3, -5.9, -9.2, -22.9, -8.599999999999998, -36.7, -5.2, -13.3, -11.999999999999998, -9.9, -17.2, -28.100000000000048, -8.299999999999999, -7.2, -18.799999999999997, -12.4, -11.599999999999998, -11.599999999999998, -5.6, -24.6, -9.3, -3.9000000000000004, -23.4, -11.600000000000001, -3.2, -8.7, -26.100000000000005, -9.599999999999998, -13.899999999999997, -8.6, -3.3, -5.300000000000001, -5.300000000000001, -13.899999999999997, -10.5, -16.89999999999999, -8.3, -7.199999999999999, -7.2, -5.300000000000001, -5.2, -8.3, -3.3, -4.2, -14.1, -11.299999999999999, -6.300000000000001, -4.300000000000001, -18.700000000000003, -12.7, -15.799999999999999, -13.799999999999999, -7.3, -5.2, -9.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1756447462010329, "mean_inference_ms": 1.5675684837265533, "mean_action_processing_ms": 0.08490128958706825, "mean_env_wait_ms": 7.193262993888668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1784000, "timesteps_this_iter": 0, "agent_timesteps_total": 1784000, "timers": {"sample_time_ms": 22156.775, "sample_throughput": 180.532, "load_time_ms": 0.469, "load_throughput": 8537588.927, "learn_time_ms": 10715.959, "learn_throughput": 373.275, "update_time_ms": 2.507}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0736170771001007, "policy_loss": -0.015909180113224574, "vf_loss": 8.83186261833355, "vf_explained_var": 0.3564482153102916, "kl": 0.006038160554272583, "entropy": 0.21061600631763858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1784000, "num_agent_steps_sampled": 1784000, "num_steps_trained": 1784000, "num_agent_steps_trained": 1784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18000, "training_iteration": 446, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-30-55", "timestamp": 1643704255, "time_this_iter_s": 17.2560977935791, "time_total_s": 13289.110298395157, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1029.6014213562012, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 31.296000000000003, "ram_util_percent": 67.1}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -103.8, "episode_reward_mean": -13.006000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.699999999999996, -15.599999999999998, -4.5, -4.3, -11.3, -16.3, -5.9, -9.2, -22.9, -8.599999999999998, -36.7, -5.2, -13.3, -11.999999999999998, -9.9, -17.2, -28.100000000000048, -8.299999999999999, -7.2, -18.799999999999997, -12.4, -11.599999999999998, -11.599999999999998, -5.6, -24.6, -9.3, -3.9000000000000004, -23.4, -11.600000000000001, -3.2, -8.7, -26.100000000000005, -9.599999999999998, -13.899999999999997, -8.6, -3.3, -5.300000000000001, -5.300000000000001, -13.899999999999997, -10.5, -16.89999999999999, -8.3, -7.199999999999999, -7.2, -5.300000000000001, -5.2, -8.3, -3.3, -4.2, -14.1, -11.299999999999999, -6.300000000000001, -4.300000000000001, -18.700000000000003, -12.7, -15.799999999999999, -13.799999999999999, -7.3, -5.2, -9.799999999999999, -16.0, -11.899999999999999, -2.3000000000000003, -16.299999999999997, -4.3, -16.4, -13.899999999999997, -15.399999999999999, -20.199999999999996, -4.300000000000001, -9.600000000000001, -3.2, -25.2, -14.4, -5.0, -29.3, -3.3, -3.3, -11.299999999999997, -23.700000000000035, -26.2, -31.500000000000004, -13.2, -8.2, -5.0, -103.8, -4.4, -15.7, -9.5, -57.60000000000001, -4.4, -12.7, -11.199999999999976, -7.300000000000001, -7.7, -3.2, -11.499999999999996, -3.2, -10.5, -14.899999999999991], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1716577788705178, "mean_inference_ms": 1.5636200900591328, "mean_action_processing_ms": 0.08467456555283957, "mean_env_wait_ms": 7.173613109513091, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1788000, "timesteps_this_iter": 0, "agent_timesteps_total": 1788000, "timers": {"sample_time_ms": 21006.613, "sample_throughput": 190.416, "load_time_ms": 0.437, "load_throughput": 9158868.872, "learn_time_ms": 9796.44, "learn_throughput": 408.312, "update_time_ms": 2.48}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.6390150647350056, "policy_loss": -0.00784790124844319, "vf_loss": 64.58317350546518, "vf_explained_var": 0.057916230668303786, "kl": 0.005156205686407393, "entropy": 0.2441462381712852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1788000, "num_agent_steps_sampled": 1788000, "num_steps_trained": 1788000, "num_agent_steps_trained": 1788000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18040, "training_iteration": 447, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-31-12", "timestamp": 1643704272, "time_this_iter_s": 17.211167097091675, "time_total_s": 13306.321465492249, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1046.8125884532928, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 33.03333333333333, "ram_util_percent": 67.16666666666667}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -103.8, "episode_reward_mean": -12.642999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.89999999999999, -8.3, -7.199999999999999, -7.2, -5.300000000000001, -5.2, -8.3, -3.3, -4.2, -14.1, -11.299999999999999, -6.300000000000001, -4.300000000000001, -18.700000000000003, -12.7, -15.799999999999999, -13.799999999999999, -7.3, -5.2, -9.799999999999999, -16.0, -11.899999999999999, -2.3000000000000003, -16.299999999999997, -4.3, -16.4, -13.899999999999997, -15.399999999999999, -20.199999999999996, -4.300000000000001, -9.600000000000001, -3.2, -25.2, -14.4, -5.0, -29.3, -3.3, -3.3, -11.299999999999997, -23.700000000000035, -26.2, -31.500000000000004, -13.2, -8.2, -5.0, -103.8, -4.4, -15.7, -9.5, -57.60000000000001, -4.4, -12.7, -11.199999999999976, -7.300000000000001, -7.7, -3.2, -11.499999999999996, -3.2, -10.5, -14.899999999999991, -3.3, -12.499999999999998, -22.600000000000005, -16.200000000000003, -7.3999999999999995, -4.4, -6.300000000000001, -11.2, -18.8, -14.7, -15.199999999999996, -23.3, -16.3, -52.4, -10.499999999999996, -3.2, -14.7, -11.799999999999999, -8.2, -6.899999999999999, -4.4, -5.3, -20.099999999999998, -9.899999999999999, -4.2, -17.199999999999996, -14.600000000000001, -10.3, -3.2, -3.3, -4.3, -15.59999999999998, -2.9000000000000004, -5.2, -4.300000000000001, -8.500000000000002, -15.1, -11.2, -14.999999999999998, -13.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1680209465004185, "mean_inference_ms": 1.5589917336769867, "mean_action_processing_ms": 0.08441134521680427, "mean_env_wait_ms": 7.150542430567454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1792000, "timesteps_this_iter": 0, "agent_timesteps_total": 1792000, "timers": {"sample_time_ms": 19644.92, "sample_throughput": 203.615, "load_time_ms": 0.415, "load_throughput": 9633220.028, "learn_time_ms": 9377.605, "learn_throughput": 426.548, "update_time_ms": 2.44}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1340174894479494, "policy_loss": -0.014183609049907455, "vf_loss": 14.637141345265091, "vf_explained_var": 0.1657124440516195, "kl": 0.009148430086270459, "entropy": 0.23385138775232017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1792000, "num_agent_steps_sampled": 1792000, "num_steps_trained": 1792000, "num_agent_steps_trained": 1792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18080, "training_iteration": 448, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-31-27", "timestamp": 1643704287, "time_this_iter_s": 15.265408992767334, "time_total_s": 13321.586874485016, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1062.0779974460602, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 26.763636363636365, "ram_util_percent": 67.20000000000002}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -103.8, "episode_reward_mean": -12.325999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.2, -31.500000000000004, -13.2, -8.2, -5.0, -103.8, -4.4, -15.7, -9.5, -57.60000000000001, -4.4, -12.7, -11.199999999999976, -7.300000000000001, -7.7, -3.2, -11.499999999999996, -3.2, -10.5, -14.899999999999991, -3.3, -12.499999999999998, -22.600000000000005, -16.200000000000003, -7.3999999999999995, -4.4, -6.300000000000001, -11.2, -18.8, -14.7, -15.199999999999996, -23.3, -16.3, -52.4, -10.499999999999996, -3.2, -14.7, -11.799999999999999, -8.2, -6.899999999999999, -4.4, -5.3, -20.099999999999998, -9.899999999999999, -4.2, -17.199999999999996, -14.600000000000001, -10.3, -3.2, -3.3, -4.3, -15.59999999999998, -2.9000000000000004, -5.2, -4.300000000000001, -8.500000000000002, -15.1, -11.2, -14.999999999999998, -13.6, -6.300000000000001, -14.999999999999991, -11.1, -4.3, -16.999999999999996, -9.4, -10.299999999999999, -5.300000000000001, -11.6, -5.300000000000001, -29.700000000000006, -6.3, -8.399999999999997, -4.300000000000001, -13.799999999999999, -18.000000000000014, -5.4, -7.300000000000001, -10.799999999999997, -3.3, -5.2, -5.2, -6.300000000000001, -3.2, -12.0, -53.99999999999993, -3.3, -11.1, -4.2, -15.5, -6.1, -4.4, -21.300000000000008, -7.2, -6.2, -4.3, -5.2, -5.300000000000001, -8.3, -11.600000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1645795751168637, "mean_inference_ms": 1.5532977423374552, "mean_action_processing_ms": 0.08410611932569267, "mean_env_wait_ms": 7.122631356710909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1796000, "timesteps_this_iter": 0, "agent_timesteps_total": 1796000, "timers": {"sample_time_ms": 18954.675, "sample_throughput": 211.03, "load_time_ms": 0.383, "load_throughput": 10445934.873, "learn_time_ms": 8952.58, "learn_throughput": 446.799, "update_time_ms": 2.445}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16631209464813834, "policy_loss": -0.015272077414838056, "vf_loss": 17.96380200161729, "vf_explained_var": 0.28408146148086877, "kl": 0.009730776728936224, "entropy": 0.2437288991946687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1796000, "num_agent_steps_sampled": 1796000, "num_steps_trained": 1796000, "num_agent_steps_trained": 1796000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18120, "training_iteration": 449, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-31-43", "timestamp": 1643704303, "time_this_iter_s": 15.685816764831543, "time_total_s": 13337.272691249847, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1077.7638142108917, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.821739130434775, "ram_util_percent": 67.16521739130431}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -56.10000000000004, "episode_reward_mean": -10.919, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -5.3, -20.099999999999998, -9.899999999999999, -4.2, -17.199999999999996, -14.600000000000001, -10.3, -3.2, -3.3, -4.3, -15.59999999999998, -2.9000000000000004, -5.2, -4.300000000000001, -8.500000000000002, -15.1, -11.2, -14.999999999999998, -13.6, -6.300000000000001, -14.999999999999991, -11.1, -4.3, -16.999999999999996, -9.4, -10.299999999999999, -5.300000000000001, -11.6, -5.300000000000001, -29.700000000000006, -6.3, -8.399999999999997, -4.300000000000001, -13.799999999999999, -18.000000000000014, -5.4, -7.300000000000001, -10.799999999999997, -3.3, -5.2, -5.2, -6.300000000000001, -3.2, -12.0, -53.99999999999993, -3.3, -11.1, -4.2, -15.5, -6.1, -4.4, -21.300000000000008, -7.2, -6.2, -4.3, -5.2, -5.300000000000001, -8.3, -11.600000000000001, -14.699999999999994, -10.3, -40.3, -10.999999999999998, -13.3, -9.799999999999999, -7.300000000000001, -26.7, -3.3, -3.2, -8.8, -4.4, -6.5, -11.7, -6.2, -17.199999999999978, -17.6, -20.5, -5.799999999999999, -17.9, -4.2, -16.799999999999997, -14.999999999999996, -5.000000000000001, -24.9, -6.300000000000001, -11.1, -4.4, -10.3, -4.3, -7.4, -8.7, -10.1, -13.799999999999999, -6.2, -56.10000000000004, -11.3, -5.4, -19.9, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1615633582079963, "mean_inference_ms": 1.5483400002305518, "mean_action_processing_ms": 0.08383514110454562, "mean_env_wait_ms": 7.098073081423626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1800000, "timesteps_this_iter": 0, "agent_timesteps_total": 1800000, "timers": {"sample_time_ms": 18201.369, "sample_throughput": 219.764, "load_time_ms": 0.366, "load_throughput": 10943327.898, "learn_time_ms": 8258.913, "learn_throughput": 484.325, "update_time_ms": 1.839}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1742966922150264, "policy_loss": -0.018685579920808475, "vf_loss": 19.091070165877703, "vf_explained_var": 0.1681922374874033, "kl": 0.010357878338508455, "entropy": 0.25395445883754764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1800000, "num_agent_steps_sampled": 1800000, "num_steps_trained": 1800000, "num_agent_steps_trained": 1800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18160, "training_iteration": 450, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-32-02", "timestamp": 1643704322, "time_this_iter_s": 18.591604948043823, "time_total_s": 13355.864296197891, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1096.3554191589355, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 42.04615384615384, "ram_util_percent": 67.05384615384615}}
{"episode_reward_max": -3.2, "episode_reward_min": -56.10000000000004, "episode_reward_mean": -11.214999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -5.2, -6.300000000000001, -3.2, -12.0, -53.99999999999993, -3.3, -11.1, -4.2, -15.5, -6.1, -4.4, -21.300000000000008, -7.2, -6.2, -4.3, -5.2, -5.300000000000001, -8.3, -11.600000000000001, -14.699999999999994, -10.3, -40.3, -10.999999999999998, -13.3, -9.799999999999999, -7.300000000000001, -26.7, -3.3, -3.2, -8.8, -4.4, -6.5, -11.7, -6.2, -17.199999999999978, -17.6, -20.5, -5.799999999999999, -17.9, -4.2, -16.799999999999997, -14.999999999999996, -5.000000000000001, -24.9, -6.300000000000001, -11.1, -4.4, -10.3, -4.3, -7.4, -8.7, -10.1, -13.799999999999999, -6.2, -56.10000000000004, -11.3, -5.4, -19.9, -3.2, -4.2, -7.299999999999999, -18.6, -11.7, -3.2, -8.299999999999999, -16.299999999999986, -6.2, -25.3, -24.6, -10.2, -3.3, -15.799999999999999, -5.300000000000001, -20.2, -3.3, -6.300000000000001, -8.3, -6.1, -3.3, -13.899999999999997, -12.2, -18.6, -4.7, -4.6000000000000005, -19.7, -4.3, -8.5, -6.300000000000001, -13.4, -7.300000000000001, -9.900000000000002, -21.7, -3.2, -10.7, -11.199999999999976, -14.499999999999998, -12.6, -4.300000000000001, -11.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1588614055985698, "mean_inference_ms": 1.5443142272200374, "mean_action_processing_ms": 0.08362389685708684, "mean_env_wait_ms": 7.077996035299049, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1804000, "timesteps_this_iter": 0, "agent_timesteps_total": 1804000, "timers": {"sample_time_ms": 17316.622, "sample_throughput": 230.992, "load_time_ms": 0.409, "load_throughput": 9791768.414, "learn_time_ms": 8164.567, "learn_throughput": 489.922, "update_time_ms": 1.806}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09230508285484487, "policy_loss": -0.008586157850360357, "vf_loss": 9.933733992294599, "vf_explained_var": 0.30565179394137476, "kl": 0.00776951296818706, "entropy": 0.20224490450114332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1804000, "num_agent_steps_sampled": 1804000, "num_steps_trained": 1804000, "num_agent_steps_trained": 1804000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18200, "training_iteration": 451, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-32-18", "timestamp": 1643704338, "time_this_iter_s": 16.36428689956665, "time_total_s": 13372.228583097458, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1112.7197060585022, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.0, "ram_util_percent": 66.97826086956522}}
{"episode_reward_max": -2.5, "episode_reward_min": -56.10000000000004, "episode_reward_mean": -10.944, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -16.799999999999997, -14.999999999999996, -5.000000000000001, -24.9, -6.300000000000001, -11.1, -4.4, -10.3, -4.3, -7.4, -8.7, -10.1, -13.799999999999999, -6.2, -56.10000000000004, -11.3, -5.4, -19.9, -3.2, -4.2, -7.299999999999999, -18.6, -11.7, -3.2, -8.299999999999999, -16.299999999999986, -6.2, -25.3, -24.6, -10.2, -3.3, -15.799999999999999, -5.300000000000001, -20.2, -3.3, -6.300000000000001, -8.3, -6.1, -3.3, -13.899999999999997, -12.2, -18.6, -4.7, -4.6000000000000005, -19.7, -4.3, -8.5, -6.300000000000001, -13.4, -7.300000000000001, -9.900000000000002, -21.7, -3.2, -10.7, -11.199999999999976, -14.499999999999998, -12.6, -4.300000000000001, -11.3, -11.699999999999998, -10.89999999999999, -3.3, -19.4, -2.5, -10.1, -8.899999999999999, -14.099999999999998, -12.299999999999999, -5.2, -10.3, -5.3, -20.1, -3.4, -9.5, -3.8000000000000003, -3.6000000000000005, -4.4, -13.5, -21.300000000000004, -10.499999999999998, -11.4, -11.799999999999999, -15.599999999999998, -9.3, -28.2, -12.799999999999997, -6.3999999999999995, -24.5, -8.699999999999998, -9.4, -8.3, -5.300000000000001, -7.699999999999999, -5.2, -21.400000000000006, -5.3, -15.4, -5.2, -13.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1563566246243382, "mean_inference_ms": 1.539981855023392, "mean_action_processing_ms": 0.08339994849155227, "mean_env_wait_ms": 7.056437592520796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1808000, "timesteps_this_iter": 0, "agent_timesteps_total": 1808000, "timers": {"sample_time_ms": 17128.39, "sample_throughput": 233.53, "load_time_ms": 0.409, "load_throughput": 9774653.927, "learn_time_ms": 8147.453, "learn_throughput": 490.951, "update_time_ms": 1.803}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08220936160394421, "policy_loss": -0.008553828298044141, "vf_loss": 8.897821865094606, "vf_explained_var": 0.21438872589859911, "kl": 0.0089248497020021, "entropy": 0.23533471662511107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1808000, "num_agent_steps_sampled": 1808000, "num_steps_trained": 1808000, "num_agent_steps_trained": 1808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18240, "training_iteration": 452, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-32-34", "timestamp": 1643704354, "time_this_iter_s": 16.324575901031494, "time_total_s": 13388.55315899849, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1129.0442819595337, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 35.520833333333336, "ram_util_percent": 66.94166666666668}}
{"episode_reward_max": -2.5, "episode_reward_min": -45.3, "episode_reward_mean": -10.910000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.899999999999997, -12.2, -18.6, -4.7, -4.6000000000000005, -19.7, -4.3, -8.5, -6.300000000000001, -13.4, -7.300000000000001, -9.900000000000002, -21.7, -3.2, -10.7, -11.199999999999976, -14.499999999999998, -12.6, -4.300000000000001, -11.3, -11.699999999999998, -10.89999999999999, -3.3, -19.4, -2.5, -10.1, -8.899999999999999, -14.099999999999998, -12.299999999999999, -5.2, -10.3, -5.3, -20.1, -3.4, -9.5, -3.8000000000000003, -3.6000000000000005, -4.4, -13.5, -21.300000000000004, -10.499999999999998, -11.4, -11.799999999999999, -15.599999999999998, -9.3, -28.2, -12.799999999999997, -6.3999999999999995, -24.5, -8.699999999999998, -9.4, -8.3, -5.300000000000001, -7.699999999999999, -5.2, -21.400000000000006, -5.3, -15.4, -5.2, -13.299999999999997, -20.0, -6.5, -7.7, -17.9, -4.9, -45.3, -19.6, -4.2, -9.999999999999998, -18.8, -4.300000000000001, -22.5, -14.3, -10.8, -17.900000000000013, -3.2, -20.400000000000006, -4.3, -22.900000000000006, -9.2, -7.5, -12.5, -3.2, -21.5, -5.2, -9.2, -8.2, -4.2, -5.2, -9.2, -3.2, -3.3, -4.2, -5.2, -5.2, -10.5, -5.300000000000001, -5.2, -14.399999999999999, -21.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1530612657994042, "mean_inference_ms": 1.5349571875232488, "mean_action_processing_ms": 0.08313548277587644, "mean_env_wait_ms": 7.031459089224203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1812000, "timesteps_this_iter": 0, "agent_timesteps_total": 1812000, "timers": {"sample_time_ms": 16985.965, "sample_throughput": 235.489, "load_time_ms": 0.404, "load_throughput": 9910340.835, "learn_time_ms": 7981.862, "learn_throughput": 501.136, "update_time_ms": 1.72}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11066266394530734, "policy_loss": -0.016892977467467707, "vf_loss": 12.582298538761755, "vf_explained_var": 0.2529194310147275, "kl": 0.008663288608893592, "entropy": 0.2064645506121138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1812000, "num_agent_steps_sampled": 1812000, "num_steps_trained": 1812000, "num_agent_steps_trained": 1812000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18280, "training_iteration": 453, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-32-50", "timestamp": 1643704370, "time_this_iter_s": 15.822245121002197, "time_total_s": 13404.375404119492, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1144.866527080536, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 32.27272727272727, "ram_util_percent": 66.95454545454548}}
{"episode_reward_max": -3.2, "episode_reward_min": -55.7, "episode_reward_mean": -11.102, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.499999999999998, -11.4, -11.799999999999999, -15.599999999999998, -9.3, -28.2, -12.799999999999997, -6.3999999999999995, -24.5, -8.699999999999998, -9.4, -8.3, -5.300000000000001, -7.699999999999999, -5.2, -21.400000000000006, -5.3, -15.4, -5.2, -13.299999999999997, -20.0, -6.5, -7.7, -17.9, -4.9, -45.3, -19.6, -4.2, -9.999999999999998, -18.8, -4.300000000000001, -22.5, -14.3, -10.8, -17.900000000000013, -3.2, -20.400000000000006, -4.3, -22.900000000000006, -9.2, -7.5, -12.5, -3.2, -21.5, -5.2, -9.2, -8.2, -4.2, -5.2, -9.2, -3.2, -3.3, -4.2, -5.2, -5.2, -10.5, -5.300000000000001, -5.2, -14.399999999999999, -21.700000000000003, -22.0, -8.3, -19.899999999999988, -3.2, -5.4, -4.300000000000001, -6.3999999999999995, -6.3, -10.3, -7.2, -21.5, -5.4, -10.799999999999999, -15.799999999999999, -4.2, -12.099999999999998, -18.799999999999997, -55.7, -5.4, -6.3, -7.300000000000001, -13.7, -3.2, -5.300000000000001, -9.899999999999997, -5.2, -8.2, -4.300000000000001, -9.499999999999996, -17.5, -13.799999999999997, -9.4, -4.2, -6.300000000000001, -6.300000000000001, -12.599999999999998, -7.3, -4.9, -9.100000000000001, -18.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.149275367567351, "mean_inference_ms": 1.5298595612966477, "mean_action_processing_ms": 0.08285264838790787, "mean_env_wait_ms": 7.006442462398796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1816000, "timesteps_this_iter": 0, "agent_timesteps_total": 1816000, "timers": {"sample_time_ms": 16517.848, "sample_throughput": 242.162, "load_time_ms": 0.376, "load_throughput": 10631949.303, "learn_time_ms": 7946.295, "learn_throughput": 503.379, "update_time_ms": 1.724}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.22932095585531123, "policy_loss": -0.011672824486008575, "vf_loss": 23.996039794753955, "vf_explained_var": 0.19851153358336418, "kl": 0.0051669564623958875, "entropy": 0.17990022883299858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1816000, "num_agent_steps_sampled": 1816000, "num_steps_trained": 1816000, "num_agent_steps_trained": 1816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18320, "training_iteration": 454, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-33-06", "timestamp": 1643704386, "time_this_iter_s": 15.522293090820312, "time_total_s": 13419.897697210312, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1160.3888201713562, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.677272727272726, "ram_util_percent": 66.96363636363638}}
{"episode_reward_max": -3.2, "episode_reward_min": -168.2, "episode_reward_mean": -11.958999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.5, -12.5, -3.2, -21.5, -5.2, -9.2, -8.2, -4.2, -5.2, -9.2, -3.2, -3.3, -4.2, -5.2, -5.2, -10.5, -5.300000000000001, -5.2, -14.399999999999999, -21.700000000000003, -22.0, -8.3, -19.899999999999988, -3.2, -5.4, -4.300000000000001, -6.3999999999999995, -6.3, -10.3, -7.2, -21.5, -5.4, -10.799999999999999, -15.799999999999999, -4.2, -12.099999999999998, -18.799999999999997, -55.7, -5.4, -6.3, -7.300000000000001, -13.7, -3.2, -5.300000000000001, -9.899999999999997, -5.2, -8.2, -4.300000000000001, -9.499999999999996, -17.5, -13.799999999999997, -9.4, -4.2, -6.300000000000001, -6.300000000000001, -12.599999999999998, -7.3, -4.9, -9.100000000000001, -18.4, -28.3, -3.6000000000000005, -3.2, -6.2, -6.4, -6.2, -12.2, -48.4, -11.9, -3.4, -14.299999999999997, -37.3, -11.299999999999999, -10.6, -11.9, -4.2, -4.300000000000001, -9.7, -4.2, -168.2, -3.9000000000000004, -12.599999999999996, -13.9, -17.799999999999972, -4.3999999999999995, -25.6, -4.800000000000001, -3.2, -10.999999999999977, -25.5, -9.099999999999998, -11.9, -3.2, -4.2, -6.300000000000001, -10.8, -3.2, -4.2, -9.600000000000001, -15.099999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1449175282801156, "mean_inference_ms": 1.524593852119307, "mean_action_processing_ms": 0.08256431550050829, "mean_env_wait_ms": 6.981427717837912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1820000, "timesteps_this_iter": 0, "agent_timesteps_total": 1820000, "timers": {"sample_time_ms": 16466.796, "sample_throughput": 242.913, "load_time_ms": 0.376, "load_throughput": 10643415.593, "learn_time_ms": 7917.399, "learn_throughput": 505.216, "update_time_ms": 1.683}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.1869329647040896, "policy_loss": -0.00962762293776357, "vf_loss": 119.53582381176692, "vf_explained_var": -0.027938188019619194, "kl": 0.006011836156436838, "entropy": 0.21736149124961388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1820000, "num_agent_steps_sampled": 1820000, "num_steps_trained": 1820000, "num_agent_steps_trained": 1820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18360, "training_iteration": 455, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-33-22", "timestamp": 1643704402, "time_this_iter_s": 15.981010913848877, "time_total_s": 13435.87870812416, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1176.369831085205, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 33.44782608695652, "ram_util_percent": 66.99565217391304}}
{"episode_reward_max": -3.2, "episode_reward_min": -168.2, "episode_reward_mean": -13.61, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -13.7, -3.2, -5.300000000000001, -9.899999999999997, -5.2, -8.2, -4.300000000000001, -9.499999999999996, -17.5, -13.799999999999997, -9.4, -4.2, -6.300000000000001, -6.300000000000001, -12.599999999999998, -7.3, -4.9, -9.100000000000001, -18.4, -28.3, -3.6000000000000005, -3.2, -6.2, -6.4, -6.2, -12.2, -48.4, -11.9, -3.4, -14.299999999999997, -37.3, -11.299999999999999, -10.6, -11.9, -4.2, -4.300000000000001, -9.7, -4.2, -168.2, -3.9000000000000004, -12.599999999999996, -13.9, -17.799999999999972, -4.3999999999999995, -25.6, -4.800000000000001, -3.2, -10.999999999999977, -25.5, -9.099999999999998, -11.9, -3.2, -4.2, -6.300000000000001, -10.8, -3.2, -4.2, -9.600000000000001, -15.099999999999996, -4.300000000000001, -5.2, -8.8, -7.2, -12.5, -5.3, -10.19999999999999, -5.300000000000001, -6.300000000000001, -6.300000000000001, -16.2, -20.499999999999993, -5.2, -13.499999999999998, -6.1, -22.30000000000001, -4.2, -12.199999999999998, -7.800000000000001, -25.100000000000016, -5.3, -147.60000000000002, -7.5999999999999925, -14.5, -18.800000000000004, -14.499999999999996, -15.899999999999997, -21.700000000000006, -12.3, -11.399999999999997, -7.2, -4.2, -14.0, -24.199999999999996, -6.3, -18.9, -6.499999999999999, -10.899999999999999, -6.2, -6.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1405251769548734, "mean_inference_ms": 1.519605507109911, "mean_action_processing_ms": 0.08229281711325223, "mean_env_wait_ms": 6.957551807293685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1824000, "timesteps_this_iter": 0, "agent_timesteps_total": 1824000, "timers": {"sample_time_ms": 16350.992, "sample_throughput": 244.633, "load_time_ms": 0.376, "load_throughput": 10642740.421, "learn_time_ms": 7808.013, "learn_throughput": 512.294, "update_time_ms": 1.652}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.9503973491561238, "policy_loss": -0.008081445728318506, "vf_loss": 95.72734611213848, "vf_explained_var": -0.1567108993248273, "kl": 0.006026707190324346, "entropy": 0.23118362230479075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1824000, "num_agent_steps_sampled": 1824000, "num_steps_trained": 1824000, "num_agent_steps_trained": 1824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18400, "training_iteration": 456, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-33-37", "timestamp": 1643704417, "time_this_iter_s": 15.290667057037354, "time_total_s": 13451.169375181198, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1191.6604981422424, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.318181818181806, "ram_util_percent": 66.94090909090913}}
{"episode_reward_max": -3.2, "episode_reward_min": -147.60000000000002, "episode_reward_mean": -13.299000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -12.599999999999996, -13.9, -17.799999999999972, -4.3999999999999995, -25.6, -4.800000000000001, -3.2, -10.999999999999977, -25.5, -9.099999999999998, -11.9, -3.2, -4.2, -6.300000000000001, -10.8, -3.2, -4.2, -9.600000000000001, -15.099999999999996, -4.300000000000001, -5.2, -8.8, -7.2, -12.5, -5.3, -10.19999999999999, -5.300000000000001, -6.300000000000001, -6.300000000000001, -16.2, -20.499999999999993, -5.2, -13.499999999999998, -6.1, -22.30000000000001, -4.2, -12.199999999999998, -7.800000000000001, -25.100000000000016, -5.3, -147.60000000000002, -7.5999999999999925, -14.5, -18.800000000000004, -14.499999999999996, -15.899999999999997, -21.700000000000006, -12.3, -11.399999999999997, -7.2, -4.2, -14.0, -24.199999999999996, -6.3, -18.9, -6.499999999999999, -10.899999999999999, -6.2, -6.0, -12.499999999999996, -19.300000000000004, -4.2, -16.799999999999997, -9.8, -13.699999999999994, -4.4, -13.4, -4.4, -15.7, -10.59999999999998, -16.9, -27.400000000000002, -9.7, -10.5, -85.3, -9.999999999999998, -4.4, -8.8, -10.0, -5.000000000000001, -4.9, -17.599999999999998, -18.799999999999997, -7.3, -7.3, -5.300000000000001, -10.3, -5.1000000000000005, -8.799999999999997, -21.900000000000006, -13.599999999999998, -12.599999999999998, -16.4, -13.099999999999998, -7.2, -25.2, -3.2, -11.999999999999996, -27.70000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1366885808001599, "mean_inference_ms": 1.5143633237608527, "mean_action_processing_ms": 0.08200900910161643, "mean_env_wait_ms": 6.932246270754925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1828000, "timesteps_this_iter": 0, "agent_timesteps_total": 1828000, "timers": {"sample_time_ms": 16039.765, "sample_throughput": 249.38, "load_time_ms": 0.373, "load_throughput": 10714104.349, "learn_time_ms": 7860.705, "learn_throughput": 508.86, "update_time_ms": 1.596}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.44329709716952376, "policy_loss": -0.011913379097998302, "vf_loss": 45.39951007007271, "vf_explained_var": 0.08297746444261202, "kl": 0.0060769254941371335, "entropy": 0.21256693975739582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1828000, "num_agent_steps_sampled": 1828000, "num_steps_trained": 1828000, "num_agent_steps_trained": 1828000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18440, "training_iteration": 457, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-33-53", "timestamp": 1643704433, "time_this_iter_s": 15.7273690700531, "time_total_s": 13466.896744251251, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1207.3878672122955, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 32.81739130434783, "ram_util_percent": 66.90000000000003}}
{"episode_reward_max": -3.2, "episode_reward_min": -147.60000000000002, "episode_reward_mean": -13.383, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -147.60000000000002, -7.5999999999999925, -14.5, -18.800000000000004, -14.499999999999996, -15.899999999999997, -21.700000000000006, -12.3, -11.399999999999997, -7.2, -4.2, -14.0, -24.199999999999996, -6.3, -18.9, -6.499999999999999, -10.899999999999999, -6.2, -6.0, -12.499999999999996, -19.300000000000004, -4.2, -16.799999999999997, -9.8, -13.699999999999994, -4.4, -13.4, -4.4, -15.7, -10.59999999999998, -16.9, -27.400000000000002, -9.7, -10.5, -85.3, -9.999999999999998, -4.4, -8.8, -10.0, -5.000000000000001, -4.9, -17.599999999999998, -18.799999999999997, -7.3, -7.3, -5.300000000000001, -10.3, -5.1000000000000005, -8.799999999999997, -21.900000000000006, -13.599999999999998, -12.599999999999998, -16.4, -13.099999999999998, -7.2, -25.2, -3.2, -11.999999999999996, -27.70000000000002, -13.5, -3.8000000000000003, -7.6000000000000005, -11.399999999999999, -4.2, -17.699999999999985, -15.799999999999999, -8.1, -5.300000000000001, -7.4, -5.2, -22.2, -13.999999999999998, -7.300000000000001, -18.8, -6.499999999999999, -14.7, -9.3, -3.3, -14.199999999999998, -10.7, -23.4, -14.899999999999999, -5.000000000000001, -3.4, -5.300000000000001, -15.099999999999989, -7.2, -23.1, -6.700000000000001, -8.2, -9.899999999999999, -16.3, -10.499999999999998, -5.300000000000001, -10.500000000000002, -7.499999999999999, -7.300000000000001, -6.2, -6.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1339848216760966, "mean_inference_ms": 1.509473968847795, "mean_action_processing_ms": 0.08174493908118455, "mean_env_wait_ms": 6.908510434439578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1832000, "timesteps_this_iter": 0, "agent_timesteps_total": 1832000, "timers": {"sample_time_ms": 16136.948, "sample_throughput": 247.878, "load_time_ms": 0.382, "load_throughput": 10470054.918, "learn_time_ms": 7869.301, "learn_throughput": 508.304, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07293532282534626, "policy_loss": -0.01628265430930481, "vf_loss": 8.709170110251314, "vf_explained_var": 0.1705258734123681, "kl": 0.010631395932242644, "entropy": 0.2207960648041579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1832000, "num_agent_steps_sampled": 1832000, "num_steps_trained": 1832000, "num_agent_steps_trained": 1832000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18480, "training_iteration": 458, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-34-09", "timestamp": 1643704449, "time_this_iter_s": 15.813403844833374, "time_total_s": 13482.710148096085, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1223.201271057129, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.67727272727273, "ram_util_percent": 66.90000000000003}}
{"episode_reward_max": -1.3, "episode_reward_min": -27.70000000000002, "episode_reward_mean": -10.384, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.000000000000001, -4.9, -17.599999999999998, -18.799999999999997, -7.3, -7.3, -5.300000000000001, -10.3, -5.1000000000000005, -8.799999999999997, -21.900000000000006, -13.599999999999998, -12.599999999999998, -16.4, -13.099999999999998, -7.2, -25.2, -3.2, -11.999999999999996, -27.70000000000002, -13.5, -3.8000000000000003, -7.6000000000000005, -11.399999999999999, -4.2, -17.699999999999985, -15.799999999999999, -8.1, -5.300000000000001, -7.4, -5.2, -22.2, -13.999999999999998, -7.300000000000001, -18.8, -6.499999999999999, -14.7, -9.3, -3.3, -14.199999999999998, -10.7, -23.4, -14.899999999999999, -5.000000000000001, -3.4, -5.300000000000001, -15.099999999999989, -7.2, -23.1, -6.700000000000001, -8.2, -9.899999999999999, -16.3, -10.499999999999998, -5.300000000000001, -10.500000000000002, -7.499999999999999, -7.300000000000001, -6.2, -6.4, -10.799999999999999, -20.000000000000007, -4.3, -6.9, -17.8, -1.3, -16.3, -3.2, -8.2, -5.2, -4.700000000000001, -18.400000000000002, -12.199999999999998, -10.099999999999998, -3.3, -4.300000000000001, -9.7, -14.3, -9.9, -5.300000000000001, -3.4, -7.300000000000001, -5.300000000000001, -11.2, -14.8, -4.3, -8.5, -9.9, -9.2, -7.4, -11.799999999999999, -11.999999999999996, -3.3, -11.5, -4.2, -18.100000000000012, -21.3, -12.7, -6.3, -13.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.131383076689207, "mean_inference_ms": 1.5048661843817834, "mean_action_processing_ms": 0.08149662213983638, "mean_env_wait_ms": 6.886346165224185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1836000, "timesteps_this_iter": 0, "agent_timesteps_total": 1836000, "timers": {"sample_time_ms": 16121.642, "sample_throughput": 248.114, "load_time_ms": 0.383, "load_throughput": 10434240.935, "learn_time_ms": 7919.937, "learn_throughput": 505.055, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.045944743548389726, "policy_loss": -0.02034792694293203, "vf_loss": 6.437999520891456, "vf_explained_var": 0.2574862758318583, "kl": 0.009563395675143261, "entropy": 0.21854013799018757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1836000, "num_agent_steps_sampled": 1836000, "num_steps_trained": 1836000, "num_agent_steps_trained": 1836000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18520, "training_iteration": 459, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-34-25", "timestamp": 1643704465, "time_this_iter_s": 15.940237998962402, "time_total_s": 13498.650386095047, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1239.1415090560913, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 36.19130434782608, "ram_util_percent": 66.81739130434781}}
{"episode_reward_max": -1.3, "episode_reward_min": -33.600000000000016, "episode_reward_mean": -11.092, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.7, -23.4, -14.899999999999999, -5.000000000000001, -3.4, -5.300000000000001, -15.099999999999989, -7.2, -23.1, -6.700000000000001, -8.2, -9.899999999999999, -16.3, -10.499999999999998, -5.300000000000001, -10.500000000000002, -7.499999999999999, -7.300000000000001, -6.2, -6.4, -10.799999999999999, -20.000000000000007, -4.3, -6.9, -17.8, -1.3, -16.3, -3.2, -8.2, -5.2, -4.700000000000001, -18.400000000000002, -12.199999999999998, -10.099999999999998, -3.3, -4.300000000000001, -9.7, -14.3, -9.9, -5.300000000000001, -3.4, -7.300000000000001, -5.300000000000001, -11.2, -14.8, -4.3, -8.5, -9.9, -9.2, -7.4, -11.799999999999999, -11.999999999999996, -3.3, -11.5, -4.2, -18.100000000000012, -21.3, -12.7, -6.3, -13.2, -21.30000000000001, -10.299999999999997, -13.5, -17.7, -10.4, -19.500000000000007, -19.5, -6.5, -20.799999999999997, -25.1, -22.900000000000034, -3.4, -14.399999999999999, -5.300000000000001, -16.699999999999996, -8.4, -14.099999999999996, -33.600000000000016, -30.6, -3.3, -28.1, -9.699999999999998, -21.799999999999997, -7.299999999999999, -6.3, -6.3, -13.799999999999999, -31.800000000000008, -5.3, -9.399999999999997, -5.4, -11.5, -4.3, -11.599999999999998, -3.3, -7.299999999999999, -5.699999999999999, -5.300000000000001, -8.600000000000001, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1285603297956295, "mean_inference_ms": 1.5008945964780063, "mean_action_processing_ms": 0.08128102772064114, "mean_env_wait_ms": 6.867326262995973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1840000, "timesteps_this_iter": 0, "agent_timesteps_total": 1840000, "timers": {"sample_time_ms": 16104.347, "sample_throughput": 248.38, "load_time_ms": 0.384, "load_throughput": 10425811.583, "learn_time_ms": 7687.152, "learn_throughput": 520.349, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1703487992687251, "policy_loss": -0.016363887060233343, "vf_loss": 18.476188855530115, "vf_explained_var": 0.11586156814329086, "kl": 0.009754017340475105, "entropy": 0.2319401571426981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1840000, "num_agent_steps_sampled": 1840000, "num_steps_trained": 1840000, "num_agent_steps_trained": 1840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18560, "training_iteration": 460, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-34-40", "timestamp": 1643704480, "time_this_iter_s": 15.593125104904175, "time_total_s": 13514.243511199951, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1254.7346341609955, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 29.300000000000008, "ram_util_percent": 66.77272727272728}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.600000000000016, "episode_reward_mean": -11.032000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -7.300000000000001, -5.300000000000001, -11.2, -14.8, -4.3, -8.5, -9.9, -9.2, -7.4, -11.799999999999999, -11.999999999999996, -3.3, -11.5, -4.2, -18.100000000000012, -21.3, -12.7, -6.3, -13.2, -21.30000000000001, -10.299999999999997, -13.5, -17.7, -10.4, -19.500000000000007, -19.5, -6.5, -20.799999999999997, -25.1, -22.900000000000034, -3.4, -14.399999999999999, -5.300000000000001, -16.699999999999996, -8.4, -14.099999999999996, -33.600000000000016, -30.6, -3.3, -28.1, -9.699999999999998, -21.799999999999997, -7.299999999999999, -6.3, -6.3, -13.799999999999999, -31.800000000000008, -5.3, -9.399999999999997, -5.4, -11.5, -4.3, -11.599999999999998, -3.3, -7.299999999999999, -5.699999999999999, -5.300000000000001, -8.600000000000001, -4.3, -6.1, -11.0, -3.3, -15.3, -7.499999999999994, -5.300000000000001, -11.9, -10.899999999999999, -15.499999999999998, -26.8, -3.3, -7.300000000000001, -7.199999999999999, -9.2, -6.899999999999999, -9.8, -4.4, -11.3, -5.300000000000001, -31.69999999999996, -3.4, -4.2, -12.799999999999999, -3.2, -6.2, -14.899999999999999, -3.2, -24.6, -7.299999999999999, -16.9, -7.0, -10.7, -3.9000000000000004, -9.2, -22.100000000000005, -4.300000000000001, -4.2, -3.4, -6.2, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1254936445744022, "mean_inference_ms": 1.4967620288914167, "mean_action_processing_ms": 0.08105790959456897, "mean_env_wait_ms": 6.847420916166563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1844000, "timesteps_this_iter": 0, "agent_timesteps_total": 1844000, "timers": {"sample_time_ms": 15778.501, "sample_throughput": 253.51, "load_time_ms": 0.341, "load_throughput": 11733959.994, "learn_time_ms": 7714.043, "learn_throughput": 518.535, "update_time_ms": 1.588}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08273867208821079, "policy_loss": -0.02396660294503935, "vf_loss": 10.377635480191119, "vf_explained_var": 0.20233670940963172, "kl": 0.014644607986040963, "entropy": 0.2243631512287163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1844000, "num_agent_steps_sampled": 1844000, "num_steps_trained": 1844000, "num_agent_steps_trained": 1844000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18600, "training_iteration": 461, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-34-56", "timestamp": 1643704496, "time_this_iter_s": 15.697478771209717, "time_total_s": 13529.94098997116, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1270.4321129322052, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 25.095454545454547, "ram_util_percent": 66.6681818181818}}
{"episode_reward_max": -3.2, "episode_reward_min": -32.900000000000006, "episode_reward_mean": -10.445000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.1, -9.699999999999998, -21.799999999999997, -7.299999999999999, -6.3, -6.3, -13.799999999999999, -31.800000000000008, -5.3, -9.399999999999997, -5.4, -11.5, -4.3, -11.599999999999998, -3.3, -7.299999999999999, -5.699999999999999, -5.300000000000001, -8.600000000000001, -4.3, -6.1, -11.0, -3.3, -15.3, -7.499999999999994, -5.300000000000001, -11.9, -10.899999999999999, -15.499999999999998, -26.8, -3.3, -7.300000000000001, -7.199999999999999, -9.2, -6.899999999999999, -9.8, -4.4, -11.3, -5.300000000000001, -31.69999999999996, -3.4, -4.2, -12.799999999999999, -3.2, -6.2, -14.899999999999999, -3.2, -24.6, -7.299999999999999, -16.9, -7.0, -10.7, -3.9000000000000004, -9.2, -22.100000000000005, -4.300000000000001, -4.2, -3.4, -6.2, -5.4, -23.90000000000001, -3.3, -5.5, -4.4, -7.199999999999999, -7.4, -9.2, -11.2, -5.300000000000001, -8.2, -4.300000000000001, -11.700000000000001, -5.2, -32.900000000000006, -22.6, -9.3, -16.5, -15.099999999999998, -6.7, -20.599999999999994, -7.5, -3.3, -24.299999999999997, -7.300000000000001, -14.999999999999998, -6.199999999999999, -10.6, -5.300000000000001, -4.2, -4.300000000000001, -16.599999999999998, -4.5, -7.800000000000001, -4.2, -24.4, -4.300000000000001, -12.699999999999998, -25.90000000000002, -30.000000000000007, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1224178203083666, "mean_inference_ms": 1.4926579136583387, "mean_action_processing_ms": 0.08083604132579722, "mean_env_wait_ms": 6.827739129094931, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1848000, "timesteps_this_iter": 0, "agent_timesteps_total": 1848000, "timers": {"sample_time_ms": 15791.68, "sample_throughput": 253.298, "load_time_ms": 0.341, "load_throughput": 11717569.493, "learn_time_ms": 7650.798, "learn_throughput": 522.821, "update_time_ms": 1.578}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10392608678228753, "policy_loss": -0.011970633256339258, "vf_loss": 11.435765106831827, "vf_explained_var": 0.21544077466892939, "kl": 0.007695343378712839, "entropy": 0.1914171122214807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1848000, "num_agent_steps_sampled": 1848000, "num_steps_trained": 1848000, "num_agent_steps_trained": 1848000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18640, "training_iteration": 462, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-35-12", "timestamp": 1643704512, "time_this_iter_s": 15.560596942901611, "time_total_s": 13545.501586914062, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1285.9927098751068, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 23.099999999999998, "ram_util_percent": 66.6173913043478}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -33.5, "episode_reward_mean": -10.635, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -4.2, -12.799999999999999, -3.2, -6.2, -14.899999999999999, -3.2, -24.6, -7.299999999999999, -16.9, -7.0, -10.7, -3.9000000000000004, -9.2, -22.100000000000005, -4.300000000000001, -4.2, -3.4, -6.2, -5.4, -23.90000000000001, -3.3, -5.5, -4.4, -7.199999999999999, -7.4, -9.2, -11.2, -5.300000000000001, -8.2, -4.300000000000001, -11.700000000000001, -5.2, -32.900000000000006, -22.6, -9.3, -16.5, -15.099999999999998, -6.7, -20.599999999999994, -7.5, -3.3, -24.299999999999997, -7.300000000000001, -14.999999999999998, -6.199999999999999, -10.6, -5.300000000000001, -4.2, -4.300000000000001, -16.599999999999998, -4.5, -7.800000000000001, -4.2, -24.4, -4.300000000000001, -12.699999999999998, -25.90000000000002, -30.000000000000007, -5.4, -14.499999999999998, -9.7, -14.499999999999998, -13.4, -5.4, -15.399999999999997, -19.199999999999996, -9.5, -8.2, -16.199999999999996, -3.2, -22.099999999999984, -7.2, -6.8999999999999995, -3.3, -5.300000000000001, -6.1, -18.7, -16.0, -3.3, -27.90000000000005, -5.399999999999996, -33.5, -9.2, -11.399999999999999, -5.300000000000001, -11.0, -18.799999999999997, -3.4, -4.2, -3.8000000000000003, -11.6, -12.3, -2.5000000000000004, -3.3, -7.299999999999999, -3.3, -23.7, -14.799999999999999, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.118915364916831, "mean_inference_ms": 1.4884514938921223, "mean_action_processing_ms": 0.08060610902389465, "mean_env_wait_ms": 6.807414401771316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1852000, "timesteps_this_iter": 0, "agent_timesteps_total": 1852000, "timers": {"sample_time_ms": 15712.547, "sample_throughput": 254.574, "load_time_ms": 0.336, "load_throughput": 11895360.182, "learn_time_ms": 7665.689, "learn_throughput": 521.806, "update_time_ms": 1.599}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11442457462851238, "policy_loss": -0.011194238187595, "vf_loss": 12.40328128709588, "vf_explained_var": 0.15679748654365538, "kl": 0.007930016830414919, "entropy": 0.23027386390554008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1852000, "num_agent_steps_sampled": 1852000, "num_steps_trained": 1852000, "num_agent_steps_trained": 1852000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18680, "training_iteration": 463, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-35-28", "timestamp": 1643704528, "time_this_iter_s": 15.802114725112915, "time_total_s": 13561.303701639175, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1301.7948246002197, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 27.686363636363637, "ram_util_percent": 66.6090909090909}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -41.20000000000001, "episode_reward_mean": -11.238999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.5, -3.3, -24.299999999999997, -7.300000000000001, -14.999999999999998, -6.199999999999999, -10.6, -5.300000000000001, -4.2, -4.300000000000001, -16.599999999999998, -4.5, -7.800000000000001, -4.2, -24.4, -4.300000000000001, -12.699999999999998, -25.90000000000002, -30.000000000000007, -5.4, -14.499999999999998, -9.7, -14.499999999999998, -13.4, -5.4, -15.399999999999997, -19.199999999999996, -9.5, -8.2, -16.199999999999996, -3.2, -22.099999999999984, -7.2, -6.8999999999999995, -3.3, -5.300000000000001, -6.1, -18.7, -16.0, -3.3, -27.90000000000005, -5.399999999999996, -33.5, -9.2, -11.399999999999999, -5.300000000000001, -11.0, -18.799999999999997, -3.4, -4.2, -3.8000000000000003, -11.6, -12.3, -2.5000000000000004, -3.3, -7.299999999999999, -3.3, -23.7, -14.799999999999999, -5.3, -8.100000000000001, -4.300000000000001, -4.4, -24.6, -18.799999999999997, -7.099999999999999, -3.3, -11.5, -3.3, -9.3, -7.0, -5.8999999999999995, -20.799999999999997, -15.399999999999997, -4.3, -10.8, -4.6, -24.800000000000008, -14.4, -13.1, -4.2, -4.300000000000001, -11.3, -9.2, -11.7, -11.899999999999986, -10.2, -3.2, -3.3, -12.899999999999999, -3.2, -25.4, -16.5, -3.3, -10.6, -39.10000000000001, -41.20000000000001, -11.1, -4.6000000000000005, -10.999999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.116299467588948, "mean_inference_ms": 1.4847506992087423, "mean_action_processing_ms": 0.08042110907665831, "mean_env_wait_ms": 6.789017365077723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1856000, "timesteps_this_iter": 0, "agent_timesteps_total": 1856000, "timers": {"sample_time_ms": 15754.195, "sample_throughput": 253.901, "load_time_ms": 0.336, "load_throughput": 11913944.042, "learn_time_ms": 7680.401, "learn_throughput": 520.806, "update_time_ms": 1.594}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15141793262734207, "policy_loss": -0.0075768775376741605, "vf_loss": 15.77163526229961, "vf_explained_var": 0.14426263013193685, "kl": 0.006392298354071227, "entropy": 0.2372000950959421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1856000, "num_agent_steps_sampled": 1856000, "num_steps_trained": 1856000, "num_agent_steps_trained": 1856000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18720, "training_iteration": 464, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-35-43", "timestamp": 1643704543, "time_this_iter_s": 15.933303117752075, "time_total_s": 13577.237004756927, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1317.7281277179718, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.66521739130435, "ram_util_percent": 66.67391304347827}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -41.20000000000001, "episode_reward_mean": -11.338000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.90000000000005, -5.399999999999996, -33.5, -9.2, -11.399999999999999, -5.300000000000001, -11.0, -18.799999999999997, -3.4, -4.2, -3.8000000000000003, -11.6, -12.3, -2.5000000000000004, -3.3, -7.299999999999999, -3.3, -23.7, -14.799999999999999, -5.3, -8.100000000000001, -4.300000000000001, -4.4, -24.6, -18.799999999999997, -7.099999999999999, -3.3, -11.5, -3.3, -9.3, -7.0, -5.8999999999999995, -20.799999999999997, -15.399999999999997, -4.3, -10.8, -4.6, -24.800000000000008, -14.4, -13.1, -4.2, -4.300000000000001, -11.3, -9.2, -11.7, -11.899999999999986, -10.2, -3.2, -3.3, -12.899999999999999, -3.2, -25.4, -16.5, -3.3, -10.6, -39.10000000000001, -41.20000000000001, -11.1, -4.6000000000000005, -10.999999999999996, -14.099999999999996, -3.7, -7.2, -3.6, -4.4, -16.5, -28.100000000000012, -3.2, -20.2, -18.299999999999997, -3.3, -31.800000000000008, -12.7, -3.2, -9.2, -11.600000000000001, -14.999999999999998, -14.7, -15.999999999999998, -23.200000000000003, -18.799999999999997, -11.3, -24.200000000000003, -4.800000000000001, -19.5, -9.399999999999999, -3.4, -3.3, -4.4, -14.5, -3.2, -13.7, -4.4, -3.2, -4.2, -10.199999999999998, -19.7, -10.1, -6.3, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1136837114573113, "mean_inference_ms": 1.4808496018070867, "mean_action_processing_ms": 0.08022477059515248, "mean_env_wait_ms": 6.769758782194656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1860000, "timesteps_this_iter": 0, "agent_timesteps_total": 1860000, "timers": {"sample_time_ms": 15743.535, "sample_throughput": 254.073, "load_time_ms": 0.336, "load_throughput": 11902955.658, "learn_time_ms": 7682.983, "learn_throughput": 520.631, "update_time_ms": 1.609}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10847631290114375, "policy_loss": -0.013353558149068587, "vf_loss": 12.075257597334923, "vf_explained_var": 0.2709106918945107, "kl": 0.005386494808653107, "entropy": 0.2149245213116369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1860000, "num_agent_steps_sampled": 1860000, "num_steps_trained": 1860000, "num_agent_steps_trained": 1860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18760, "training_iteration": 465, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-35-59", "timestamp": 1643704559, "time_this_iter_s": 15.750180006027222, "time_total_s": 13592.987184762955, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1333.478307723999, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 24.345454545454547, "ram_util_percent": 66.64090909090906}}
{"episode_reward_max": -2.5, "episode_reward_min": -41.20000000000001, "episode_reward_mean": -10.854999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -4.300000000000001, -11.3, -9.2, -11.7, -11.899999999999986, -10.2, -3.2, -3.3, -12.899999999999999, -3.2, -25.4, -16.5, -3.3, -10.6, -39.10000000000001, -41.20000000000001, -11.1, -4.6000000000000005, -10.999999999999996, -14.099999999999996, -3.7, -7.2, -3.6, -4.4, -16.5, -28.100000000000012, -3.2, -20.2, -18.299999999999997, -3.3, -31.800000000000008, -12.7, -3.2, -9.2, -11.600000000000001, -14.999999999999998, -14.7, -15.999999999999998, -23.200000000000003, -18.799999999999997, -11.3, -24.200000000000003, -4.800000000000001, -19.5, -9.399999999999999, -3.4, -3.3, -4.4, -14.5, -3.2, -13.7, -4.4, -3.2, -4.2, -10.199999999999998, -19.7, -10.1, -6.3, -3.2, -4.2, -4.2, -13.399999999999999, -7.3, -15.5, -21.500000000000004, -5.3, -5.700000000000001, -15.5, -21.299999999999997, -8.3, -5.300000000000001, -9.6, -24.3, -11.999999999999996, -14.299999999999997, -6.1, -3.2, -7.1, -3.2, -10.3, -7.199999999999999, -7.3, -14.2, -9.099999999999998, -6.0, -3.7, -12.899999999999999, -6.3999999999999995, -9.3, -4.300000000000001, -9.200000000000001, -2.5, -13.199999999999998, -11.799999999999997, -3.3, -8.999999999999998, -21.599999999999998, -13.599999999999998, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1109703861460383, "mean_inference_ms": 1.4770631442481092, "mean_action_processing_ms": 0.08002509423668334, "mean_env_wait_ms": 6.75110501643595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1864000, "timesteps_this_iter": 0, "agent_timesteps_total": 1864000, "timers": {"sample_time_ms": 15752.785, "sample_throughput": 253.923, "load_time_ms": 0.336, "load_throughput": 11921563.277, "learn_time_ms": 7724.856, "learn_throughput": 517.809, "update_time_ms": 1.659}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06236736317570772, "policy_loss": -0.017573666551540936, "vf_loss": 7.835417416243143, "vf_explained_var": 0.16432304773279416, "kl": 0.007934275390587317, "entropy": 0.20953812279528186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1864000, "num_agent_steps_sampled": 1864000, "num_steps_trained": 1864000, "num_agent_steps_trained": 1864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18800, "training_iteration": 466, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-36-15", "timestamp": 1643704575, "time_this_iter_s": 15.777765989303589, "time_total_s": 13608.764950752258, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1349.2560737133026, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.052173913043475, "ram_util_percent": 66.58695652173911}}
{"episode_reward_max": -2.5, "episode_reward_min": -42.3, "episode_reward_mean": -10.829, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.799999999999997, -11.3, -24.200000000000003, -4.800000000000001, -19.5, -9.399999999999999, -3.4, -3.3, -4.4, -14.5, -3.2, -13.7, -4.4, -3.2, -4.2, -10.199999999999998, -19.7, -10.1, -6.3, -3.2, -4.2, -4.2, -13.399999999999999, -7.3, -15.5, -21.500000000000004, -5.3, -5.700000000000001, -15.5, -21.299999999999997, -8.3, -5.300000000000001, -9.6, -24.3, -11.999999999999996, -14.299999999999997, -6.1, -3.2, -7.1, -3.2, -10.3, -7.199999999999999, -7.3, -14.2, -9.099999999999998, -6.0, -3.7, -12.899999999999999, -6.3999999999999995, -9.3, -4.300000000000001, -9.200000000000001, -2.5, -13.199999999999998, -11.799999999999997, -3.3, -8.999999999999998, -21.599999999999998, -13.599999999999998, -3.3, -10.3, -4.3, -4.9, -4.2, -8.2, -11.1, -8.399999999999999, -13.999999999999998, -3.3, -11.499999999999998, -14.000000000000002, -6.1, -16.299999999999997, -6.300000000000001, -24.700000000000003, -15.9, -19.500000000000007, -14.499999999999998, -3.3, -22.400000000000006, -22.800000000000008, -10.2, -9.699999999999998, -7.9, -5.300000000000001, -10.799999999999999, -7.800000000000001, -9.799999999999999, -5.7, -14.700000000000001, -18.5, -21.799999999999997, -22.4, -42.3, -10.1, -12.199999999999998, -9.3, -15.399999999999999, -11.2, -14.499999999999979], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1077398083501244, "mean_inference_ms": 1.4732260323646715, "mean_action_processing_ms": 0.07981348333507268, "mean_env_wait_ms": 6.732308527671357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1868000, "timesteps_this_iter": 0, "agent_timesteps_total": 1868000, "timers": {"sample_time_ms": 15828.013, "sample_throughput": 252.716, "load_time_ms": 0.34, "load_throughput": 11750396.414, "learn_time_ms": 7722.646, "learn_throughput": 517.957, "update_time_ms": 1.665}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12347799306635254, "policy_loss": -0.014685140627746781, "vf_loss": 13.599025193593835, "vf_explained_var": 0.17538417846925797, "kl": 0.010864427221225692, "entropy": 0.2633732239885997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1868000, "num_agent_steps_sampled": 1868000, "num_steps_trained": 1868000, "num_agent_steps_trained": 1868000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18840, "training_iteration": 467, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-36-31", "timestamp": 1643704591, "time_this_iter_s": 16.032758235931396, "time_total_s": 13624.79770898819, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1365.288831949234, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 29.63478260869566, "ram_util_percent": 66.59999999999997}}
{"episode_reward_max": -2.5, "episode_reward_min": -42.3, "episode_reward_mean": -11.115, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -7.199999999999999, -7.3, -14.2, -9.099999999999998, -6.0, -3.7, -12.899999999999999, -6.3999999999999995, -9.3, -4.300000000000001, -9.200000000000001, -2.5, -13.199999999999998, -11.799999999999997, -3.3, -8.999999999999998, -21.599999999999998, -13.599999999999998, -3.3, -10.3, -4.3, -4.9, -4.2, -8.2, -11.1, -8.399999999999999, -13.999999999999998, -3.3, -11.499999999999998, -14.000000000000002, -6.1, -16.299999999999997, -6.300000000000001, -24.700000000000003, -15.9, -19.500000000000007, -14.499999999999998, -3.3, -22.400000000000006, -22.800000000000008, -10.2, -9.699999999999998, -7.9, -5.300000000000001, -10.799999999999999, -7.800000000000001, -9.799999999999999, -5.7, -14.700000000000001, -18.5, -21.799999999999997, -22.4, -42.3, -10.1, -12.199999999999998, -9.3, -15.399999999999999, -11.2, -14.499999999999979, -11.399999999999979, -8.3, -8.299999999999999, -3.0, -15.399999999999995, -24.600000000000005, -15.7, -8.2, -10.2, -11.0, -7.5, -14.999999999999998, -9.7, -19.2, -6.3, -3.7, -4.4, -8.2, -6.3, -22.099999999999994, -21.000000000000007, -9.1, -13.6, -5.3, -6.699999999999999, -12.299999999999997, -12.2, -12.599999999999978, -5.300000000000001, -5.300000000000001, -6.3, -25.3, -6.4, -12.199999999999998, -16.9, -4.2, -12.0, -4.4, -14.799999999999974, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1059217140413748, "mean_inference_ms": 1.470600884446088, "mean_action_processing_ms": 0.07967676054503711, "mean_env_wait_ms": 6.7196736211230474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1872000, "timesteps_this_iter": 0, "agent_timesteps_total": 1872000, "timers": {"sample_time_ms": 15947.021, "sample_throughput": 250.831, "load_time_ms": 0.339, "load_throughput": 11799983.12, "learn_time_ms": 7810.759, "learn_throughput": 512.114, "update_time_ms": 1.63}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07471557363407105, "policy_loss": -0.013503288840174033, "vf_loss": 8.573730173931327, "vf_explained_var": 0.17299460288017027, "kl": 0.012407802020294637, "entropy": 0.2611087581242925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1872000, "num_agent_steps_sampled": 1872000, "num_steps_trained": 1872000, "num_agent_steps_trained": 1872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18880, "training_iteration": 468, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-36-49", "timestamp": 1643704609, "time_this_iter_s": 17.901652097702026, "time_total_s": 13642.699361085892, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1383.190484046936, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 45.46, "ram_util_percent": 66.688}}
{"episode_reward_max": -3.0, "episode_reward_min": -42.3, "episode_reward_mean": -11.550999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.800000000000008, -10.2, -9.699999999999998, -7.9, -5.300000000000001, -10.799999999999999, -7.800000000000001, -9.799999999999999, -5.7, -14.700000000000001, -18.5, -21.799999999999997, -22.4, -42.3, -10.1, -12.199999999999998, -9.3, -15.399999999999999, -11.2, -14.499999999999979, -11.399999999999979, -8.3, -8.299999999999999, -3.0, -15.399999999999995, -24.600000000000005, -15.7, -8.2, -10.2, -11.0, -7.5, -14.999999999999998, -9.7, -19.2, -6.3, -3.7, -4.4, -8.2, -6.3, -22.099999999999994, -21.000000000000007, -9.1, -13.6, -5.3, -6.699999999999999, -12.299999999999997, -12.2, -12.599999999999978, -5.300000000000001, -5.300000000000001, -6.3, -25.3, -6.4, -12.199999999999998, -16.9, -4.2, -12.0, -4.4, -14.799999999999974, -3.3, -6.700000000000001, -6.4, -4.3, -12.999999999999998, -4.3, -14.6, -7.300000000000001, -29.3, -5.3, -9.2, -5.300000000000001, -7.2, -4.2, -14.299999999999999, -8.399999999999999, -5.3, -7.2, -4.300000000000001, -17.3, -5.2, -15.6, -3.2, -13.599999999999998, -8.699999999999994, -16.2, -3.2, -14.3, -10.2, -6.3, -18.699999999999996, -29.0, -20.6, -17.0, -13.799999999999999, -15.099999999999994, -8.499999999999998, -13.999999999999998, -17.4, -6.300000000000001, -14.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1044457867930182, "mean_inference_ms": 1.46871606606193, "mean_action_processing_ms": 0.07958447617523044, "mean_env_wait_ms": 6.710858178024024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1876000, "timesteps_this_iter": 0, "agent_timesteps_total": 1876000, "timers": {"sample_time_ms": 16101.531, "sample_throughput": 248.424, "load_time_ms": 0.343, "load_throughput": 11661372.072, "learn_time_ms": 7852.095, "learn_throughput": 509.418, "update_time_ms": 1.637}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1113188896378282, "policy_loss": -0.001362076993550985, "vf_loss": 11.113623881852755, "vf_explained_var": 0.3624701592230028, "kl": 0.0077236482322162936, "entropy": 0.2511475458340619, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1876000, "num_agent_steps_sampled": 1876000, "num_steps_trained": 1876000, "num_agent_steps_trained": 1876000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18920, "training_iteration": 469, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-37-06", "timestamp": 1643704626, "time_this_iter_s": 17.03019905090332, "time_total_s": 13659.729560136795, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1400.2206830978394, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 37.676, "ram_util_percent": 66.724}}
{"episode_reward_max": -3.2, "episode_reward_min": -35.20000000000002, "episode_reward_mean": -10.425999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.000000000000007, -9.1, -13.6, -5.3, -6.699999999999999, -12.299999999999997, -12.2, -12.599999999999978, -5.300000000000001, -5.300000000000001, -6.3, -25.3, -6.4, -12.199999999999998, -16.9, -4.2, -12.0, -4.4, -14.799999999999974, -3.3, -6.700000000000001, -6.4, -4.3, -12.999999999999998, -4.3, -14.6, -7.300000000000001, -29.3, -5.3, -9.2, -5.300000000000001, -7.2, -4.2, -14.299999999999999, -8.399999999999999, -5.3, -7.2, -4.300000000000001, -17.3, -5.2, -15.6, -3.2, -13.599999999999998, -8.699999999999994, -16.2, -3.2, -14.3, -10.2, -6.3, -18.699999999999996, -29.0, -20.6, -17.0, -13.799999999999999, -15.099999999999994, -8.499999999999998, -13.999999999999998, -17.4, -6.300000000000001, -14.199999999999998, -7.2, -14.6, -3.2, -3.3, -6.300000000000001, -6.300000000000001, -7.8999999999999915, -30.9, -4.3, -7.3999999999999995, -5.300000000000001, -16.9, -5.8999999999999995, -3.7000000000000006, -3.2, -4.300000000000001, -4.2, -10.000000000000002, -12.1, -3.3, -14.699999999999998, -9.6, -3.900000000000001, -35.20000000000002, -12.2, -3.3, -5.4, -5.3, -19.2, -11.899999999999999, -3.3, -22.000000000000007, -5.800000000000001, -17.3, -3.8000000000000003, -17.200000000000003, -9.2, -19.29999999999996, -5.2, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1026652577380458, "mean_inference_ms": 1.4661439539196268, "mean_action_processing_ms": 0.07944909361607672, "mean_env_wait_ms": 6.69887056693576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1880000, "timesteps_this_iter": 0, "agent_timesteps_total": 1880000, "timers": {"sample_time_ms": 16082.073, "sample_throughput": 248.724, "load_time_ms": 0.343, "load_throughput": 11668671.582, "learn_time_ms": 7939.835, "learn_throughput": 503.789, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08951715014183954, "policy_loss": -0.018318511382927016, "vf_loss": 10.622450432565904, "vf_explained_var": 0.15451395633400128, "kl": 0.008055778804755049, "entropy": 0.23131193461757835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1880000, "num_agent_steps_sampled": 1880000, "num_steps_trained": 1880000, "num_agent_steps_trained": 1880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18960, "training_iteration": 470, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-37-22", "timestamp": 1643704642, "time_this_iter_s": 15.851037979125977, "time_total_s": 13675.580598115921, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1416.0717210769653, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 31.772727272727273, "ram_util_percent": 66.70000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -35.20000000000002, "episode_reward_mean": -11.312999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.6, -3.2, -13.599999999999998, -8.699999999999994, -16.2, -3.2, -14.3, -10.2, -6.3, -18.699999999999996, -29.0, -20.6, -17.0, -13.799999999999999, -15.099999999999994, -8.499999999999998, -13.999999999999998, -17.4, -6.300000000000001, -14.199999999999998, -7.2, -14.6, -3.2, -3.3, -6.300000000000001, -6.300000000000001, -7.8999999999999915, -30.9, -4.3, -7.3999999999999995, -5.300000000000001, -16.9, -5.8999999999999995, -3.7000000000000006, -3.2, -4.300000000000001, -4.2, -10.000000000000002, -12.1, -3.3, -14.699999999999998, -9.6, -3.900000000000001, -35.20000000000002, -12.2, -3.3, -5.4, -5.3, -19.2, -11.899999999999999, -3.3, -22.000000000000007, -5.800000000000001, -17.3, -3.8000000000000003, -17.200000000000003, -9.2, -19.29999999999996, -5.2, -4.3, -12.0, -10.799999999999999, -6.1, -7.2, -20.099999999999994, -16.299999999999997, -11.799999999999999, -5.3, -18.200000000000003, -7.300000000000001, -8.2, -4.699999999999999, -15.7, -21.4, -6.300000000000001, -5.2, -14.6, -12.299999999999995, -3.3, -5.300000000000001, -4.0, -22.5, -16.5, -30.500000000000007, -5.2, -34.6, -3.3, -6.300000000000001, -3.3, -10.8, -16.3, -8.899999999999999, -19.000000000000007, -10.5, -18.5, -9.200000000000001, -17.1, -8.3, -5.300000000000001, -14.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.100747354817287, "mean_inference_ms": 1.4631817350223673, "mean_action_processing_ms": 0.07928321039617385, "mean_env_wait_ms": 6.684337245143188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1884000, "timesteps_this_iter": 0, "agent_timesteps_total": 1884000, "timers": {"sample_time_ms": 16231.403, "sample_throughput": 246.436, "load_time_ms": 0.343, "load_throughput": 11651653.587, "learn_time_ms": 7929.154, "learn_throughput": 504.467, "update_time_ms": 1.695}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13539531125476764, "policy_loss": -0.004241040997928189, "vf_loss": 13.821846846611269, "vf_explained_var": 0.2440450943285419, "kl": 0.007089426468924043, "entropy": 0.2212169218648185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1884000, "num_agent_steps_sampled": 1884000, "num_steps_trained": 1884000, "num_agent_steps_trained": 1884000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19000, "training_iteration": 471, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-37-38", "timestamp": 1643704658, "time_this_iter_s": 16.21429204940796, "time_total_s": 13691.794890165329, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1432.2860131263733, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 34.15217391304349, "ram_util_percent": 66.78695652173911}}
{"episode_reward_max": -3.2, "episode_reward_min": -35.20000000000002, "episode_reward_mean": -11.578999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.699999999999998, -9.6, -3.900000000000001, -35.20000000000002, -12.2, -3.3, -5.4, -5.3, -19.2, -11.899999999999999, -3.3, -22.000000000000007, -5.800000000000001, -17.3, -3.8000000000000003, -17.200000000000003, -9.2, -19.29999999999996, -5.2, -4.3, -12.0, -10.799999999999999, -6.1, -7.2, -20.099999999999994, -16.299999999999997, -11.799999999999999, -5.3, -18.200000000000003, -7.300000000000001, -8.2, -4.699999999999999, -15.7, -21.4, -6.300000000000001, -5.2, -14.6, -12.299999999999995, -3.3, -5.300000000000001, -4.0, -22.5, -16.5, -30.500000000000007, -5.2, -34.6, -3.3, -6.300000000000001, -3.3, -10.8, -16.3, -8.899999999999999, -19.000000000000007, -10.5, -18.5, -9.200000000000001, -17.1, -8.3, -5.300000000000001, -14.799999999999999, -6.999999999999999, -3.3, -11.099999999999998, -18.200000000000003, -15.599999999999998, -16.29999999999998, -3.2, -15.799999999999999, -15.9, -15.499999999999996, -4.2, -25.7, -17.4, -23.000000000000007, -10.2, -14.4, -16.699999999999996, -11.099999999999998, -4.2, -20.399999999999995, -5.4, -4.2, -9.4, -4.2, -6.300000000000001, -3.3, -20.5, -3.3, -9.399999999999999, -17.299999999999997, -14.299999999999999, -11.5, -6.2, -10.2, -6.4, -3.2, -14.099999999999996, -19.799999999999997, -8.2, -6.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0986383800387984, "mean_inference_ms": 1.460029525759963, "mean_action_processing_ms": 0.07910643802131646, "mean_env_wait_ms": 6.669107666492944, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1888000, "timesteps_this_iter": 0, "agent_timesteps_total": 1888000, "timers": {"sample_time_ms": 16197.361, "sample_throughput": 246.954, "load_time_ms": 0.343, "load_throughput": 11675167.711, "learn_time_ms": 7988.878, "learn_throughput": 500.696, "update_time_ms": 1.701}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0723560835284892, "policy_loss": -0.01444724279065286, "vf_loss": 8.523290639410737, "vf_explained_var": 0.29351550571380125, "kl": 0.007852113321309303, "entropy": 0.20351456217067215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1888000, "num_agent_steps_sampled": 1888000, "num_steps_trained": 1888000, "num_agent_steps_trained": 1888000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19040, "training_iteration": 472, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-37-54", "timestamp": 1643704674, "time_this_iter_s": 15.904700756072998, "time_total_s": 13707.699590921402, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1448.1907138824463, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 33.291304347826085, "ram_util_percent": 65.7695652173913}}
{"episode_reward_max": -2.5, "episode_reward_min": -36.30000000000006, "episode_reward_mean": -11.494999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -22.5, -16.5, -30.500000000000007, -5.2, -34.6, -3.3, -6.300000000000001, -3.3, -10.8, -16.3, -8.899999999999999, -19.000000000000007, -10.5, -18.5, -9.200000000000001, -17.1, -8.3, -5.300000000000001, -14.799999999999999, -6.999999999999999, -3.3, -11.099999999999998, -18.200000000000003, -15.599999999999998, -16.29999999999998, -3.2, -15.799999999999999, -15.9, -15.499999999999996, -4.2, -25.7, -17.4, -23.000000000000007, -10.2, -14.4, -16.699999999999996, -11.099999999999998, -4.2, -20.399999999999995, -5.4, -4.2, -9.4, -4.2, -6.300000000000001, -3.3, -20.5, -3.3, -9.399999999999999, -17.299999999999997, -14.299999999999999, -11.5, -6.2, -10.2, -6.4, -3.2, -14.099999999999996, -19.799999999999997, -8.2, -6.4, -4.300000000000001, -7.2, -8.599999999999998, -14.5, -8.2, -6.5, -2.5, -16.4, -12.699999999999998, -11.1, -15.4, -16.7, -4.300000000000001, -4.2, -4.300000000000001, -6.300000000000001, -11.2, -13.399999999999999, -13.49999999999998, -3.4, -6.4, -8.399999999999999, -10.599999999999996, -4.700000000000001, -29.7, -12.199999999999973, -4.300000000000001, -8.2, -21.5, -4.4, -18.3, -4.800000000000001, -7.3, -17.699999999999996, -19.499999999999964, -19.0, -3.3, -36.30000000000006, -6.2, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0966228596744754, "mean_inference_ms": 1.4571242560086564, "mean_action_processing_ms": 0.07894149639594623, "mean_env_wait_ms": 6.654624802082781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1892000, "timesteps_this_iter": 0, "agent_timesteps_total": 1892000, "timers": {"sample_time_ms": 16286.067, "sample_throughput": 245.609, "load_time_ms": 0.351, "load_throughput": 11385962.674, "learn_time_ms": 7974.625, "learn_throughput": 501.591, "update_time_ms": 1.686}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11807457621569835, "policy_loss": -0.01537962697886972, "vf_loss": 13.179708961325307, "vf_explained_var": 0.1809770913534267, "kl": 0.008285602780423701, "entropy": 0.24029765258873662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1892000, "num_agent_steps_sampled": 1892000, "num_steps_trained": 1892000, "num_agent_steps_trained": 1892000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19080, "training_iteration": 473, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-38-10", "timestamp": 1643704690, "time_this_iter_s": 15.960348129272461, "time_total_s": 13723.659939050674, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1464.1510620117188, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 32.95217391304348, "ram_util_percent": 65.5}}
{"episode_reward_max": -2.5, "episode_reward_min": -47.3, "episode_reward_mean": -10.905, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -4.2, -9.4, -4.2, -6.300000000000001, -3.3, -20.5, -3.3, -9.399999999999999, -17.299999999999997, -14.299999999999999, -11.5, -6.2, -10.2, -6.4, -3.2, -14.099999999999996, -19.799999999999997, -8.2, -6.4, -4.300000000000001, -7.2, -8.599999999999998, -14.5, -8.2, -6.5, -2.5, -16.4, -12.699999999999998, -11.1, -15.4, -16.7, -4.300000000000001, -4.2, -4.300000000000001, -6.300000000000001, -11.2, -13.399999999999999, -13.49999999999998, -3.4, -6.4, -8.399999999999999, -10.599999999999996, -4.700000000000001, -29.7, -12.199999999999973, -4.300000000000001, -8.2, -21.5, -4.4, -18.3, -4.800000000000001, -7.3, -17.699999999999996, -19.499999999999964, -19.0, -3.3, -36.30000000000006, -6.2, -4.3, -8.7, -11.1, -5.2, -7.4, -14.999999999999998, -17.199999999999996, -5.2, -23.4, -3.2, -16.299999999999997, -12.299999999999999, -5.1000000000000005, -6.4, -10.6, -18.799999999999997, -7.3, -15.899999999999999, -9.2, -5.2, -6.2, -15.7, -5.3, -10.3, -9.899999999999997, -4.2, -12.099999999999998, -12.700000000000001, -31.400000000000073, -5.799999999999999, -15.499999999999998, -17.099999999999998, -9.2, -47.3, -9.899999999999999, -3.3, -3.5000000000000004, -15.5, -14.399999999999997, -7.2, -15.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.094269643670832, "mean_inference_ms": 1.453917519055035, "mean_action_processing_ms": 0.07876067638016208, "mean_env_wait_ms": 6.638891693862085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1896000, "timesteps_this_iter": 0, "agent_timesteps_total": 1896000, "timers": {"sample_time_ms": 16199.495, "sample_throughput": 246.921, "load_time_ms": 0.341, "load_throughput": 11725759.016, "learn_time_ms": 8022.481, "learn_throughput": 498.599, "update_time_ms": 1.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1535985714330348, "policy_loss": -0.0037151584982551555, "vf_loss": 15.60847929703292, "vf_explained_var": 0.17108325195568863, "kl": 0.0061447070262415525, "entropy": 0.1951713496078086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1896000, "num_agent_steps_sampled": 1896000, "num_steps_trained": 1896000, "num_agent_steps_trained": 1896000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19120, "training_iteration": 474, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-38-26", "timestamp": 1643704706, "time_this_iter_s": 15.682785987854004, "time_total_s": 13739.342725038528, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1479.8338479995728, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 30.113636363636363, "ram_util_percent": 65.58636363636361}}
{"episode_reward_max": -3.2, "episode_reward_min": -47.3, "episode_reward_mean": -11.302999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -8.399999999999999, -10.599999999999996, -4.700000000000001, -29.7, -12.199999999999973, -4.300000000000001, -8.2, -21.5, -4.4, -18.3, -4.800000000000001, -7.3, -17.699999999999996, -19.499999999999964, -19.0, -3.3, -36.30000000000006, -6.2, -4.3, -8.7, -11.1, -5.2, -7.4, -14.999999999999998, -17.199999999999996, -5.2, -23.4, -3.2, -16.299999999999997, -12.299999999999999, -5.1000000000000005, -6.4, -10.6, -18.799999999999997, -7.3, -15.899999999999999, -9.2, -5.2, -6.2, -15.7, -5.3, -10.3, -9.899999999999997, -4.2, -12.099999999999998, -12.700000000000001, -31.400000000000073, -5.799999999999999, -15.499999999999998, -17.099999999999998, -9.2, -47.3, -9.899999999999999, -3.3, -3.5000000000000004, -15.5, -14.399999999999997, -7.2, -15.1, -4.2, -17.699999999999996, -3.3, -5.2, -6.2, -5.0, -5.699999999999996, -6.5, -4.2, -12.5, -12.8, -16.7, -8.799999999999999, -7.300000000000001, -8.2, -7.2, -17.3, -7.6, -4.3, -4.2, -10.8, -13.099999999999994, -4.300000000000001, -31.200000000000006, -6.2, -19.500000000000004, -12.0, -33.9, -3.2, -17.900000000000002, -12.399999999999999, -10.0, -4.2, -7.8, -10.2, -10.799999999999999, -3.8000000000000007, -7.1, -4.300000000000001, -20.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0918937761004404, "mean_inference_ms": 1.450949499180167, "mean_action_processing_ms": 0.07859317906585832, "mean_env_wait_ms": 6.624593154710696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1900000, "timesteps_this_iter": 0, "agent_timesteps_total": 1900000, "timers": {"sample_time_ms": 16307.569, "sample_throughput": 245.285, "load_time_ms": 0.341, "load_throughput": 11726578.598, "learn_time_ms": 7962.415, "learn_throughput": 502.36, "update_time_ms": 1.686}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09713935087790453, "policy_loss": -0.01268678027735923, "vf_loss": 10.781341934332284, "vf_explained_var": 0.2485716378176084, "kl": 0.010063578440484137, "entropy": 0.20902744737123288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1900000, "num_agent_steps_sampled": 1900000, "num_steps_trained": 1900000, "num_agent_steps_trained": 1900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19160, "training_iteration": 475, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-38-42", "timestamp": 1643704722, "time_this_iter_s": 15.762332916259766, "time_total_s": 13755.105057954788, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1495.5961809158325, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 28.677272727272733, "ram_util_percent": 65.59999999999997}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -69.2, "episode_reward_mean": -12.008, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.7, -5.3, -10.3, -9.899999999999997, -4.2, -12.099999999999998, -12.700000000000001, -31.400000000000073, -5.799999999999999, -15.499999999999998, -17.099999999999998, -9.2, -47.3, -9.899999999999999, -3.3, -3.5000000000000004, -15.5, -14.399999999999997, -7.2, -15.1, -4.2, -17.699999999999996, -3.3, -5.2, -6.2, -5.0, -5.699999999999996, -6.5, -4.2, -12.5, -12.8, -16.7, -8.799999999999999, -7.300000000000001, -8.2, -7.2, -17.3, -7.6, -4.3, -4.2, -10.8, -13.099999999999994, -4.300000000000001, -31.200000000000006, -6.2, -19.500000000000004, -12.0, -33.9, -3.2, -17.900000000000002, -12.399999999999999, -10.0, -4.2, -7.8, -10.2, -10.799999999999999, -3.8000000000000007, -7.1, -4.300000000000001, -20.5, -9.0, -3.2, -4.300000000000001, -41.5, -5.000000000000001, -16.9, -4.800000000000001, -3.3, -11.299999999999999, -2.3000000000000003, -69.2, -9.3, -7.799999999999998, -4.300000000000001, -7.2, -12.4, -7.299999999999999, -12.899999999999999, -3.3, -13.599999999999994, -15.4, -18.599999999999998, -20.299999999999997, -8.0, -17.2, -6.4, -9.2, -7.699999999999998, -17.3, -9.2, -17.2, -5.300000000000001, -13.3, -32.3, -34.8, -19.100000000000012, -5.300000000000001, -11.2, -5.3, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0898623984035383, "mean_inference_ms": 1.4479121192538855, "mean_action_processing_ms": 0.07842526138702156, "mean_env_wait_ms": 6.609778671686402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1904000, "timesteps_this_iter": 0, "agent_timesteps_total": 1904000, "timers": {"sample_time_ms": 16216.881, "sample_throughput": 246.657, "load_time_ms": 0.341, "load_throughput": 11716751.17, "learn_time_ms": 8018.342, "learn_throughput": 498.856, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3193386318354857, "policy_loss": -0.018240674979664306, "vf_loss": 33.576349325462054, "vf_explained_var": -0.006197867470402871, "kl": 0.009079093289519169, "entropy": 0.2380119341355498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1904000, "num_agent_steps_sampled": 1904000, "num_steps_trained": 1904000, "num_agent_steps_trained": 1904000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19200, "training_iteration": 476, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-38-58", "timestamp": 1643704738, "time_this_iter_s": 16.022502899169922, "time_total_s": 13771.127560853958, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1511.6186838150024, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 32.26521739130435, "ram_util_percent": 65.59999999999997}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -71.50000000000003, "episode_reward_mean": -12.488000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.8, -13.099999999999994, -4.300000000000001, -31.200000000000006, -6.2, -19.500000000000004, -12.0, -33.9, -3.2, -17.900000000000002, -12.399999999999999, -10.0, -4.2, -7.8, -10.2, -10.799999999999999, -3.8000000000000007, -7.1, -4.300000000000001, -20.5, -9.0, -3.2, -4.300000000000001, -41.5, -5.000000000000001, -16.9, -4.800000000000001, -3.3, -11.299999999999999, -2.3000000000000003, -69.2, -9.3, -7.799999999999998, -4.300000000000001, -7.2, -12.4, -7.299999999999999, -12.899999999999999, -3.3, -13.599999999999994, -15.4, -18.599999999999998, -20.299999999999997, -8.0, -17.2, -6.4, -9.2, -7.699999999999998, -17.3, -9.2, -17.2, -5.300000000000001, -13.3, -32.3, -34.8, -19.100000000000012, -5.300000000000001, -11.2, -5.3, -5.300000000000001, -13.2, -10.799999999999997, -10.3, -4.2, -7.299999999999999, -18.800000000000004, -14.799999999999999, -7.399999999999999, -12.3, -4.3, -5.3, -16.0, -4.2, -8.3, -3.9000000000000004, -12.5, -4.3, -4.2, -20.4, -5.2, -11.4, -15.399999999999999, -12.099999999999996, -8.3, -27.50000000000002, -6.199999999999999, -3.2, -11.399999999999999, -20.2, -7.4, -71.50000000000003, -14.799999999999999, -5.4, -10.8, -3.2, -16.2, -29.9, -5.2, -7.2, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0880277849932312, "mean_inference_ms": 1.4453224134016753, "mean_action_processing_ms": 0.07828294964679261, "mean_env_wait_ms": 6.596919458214575, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1908000, "timesteps_this_iter": 0, "agent_timesteps_total": 1908000, "timers": {"sample_time_ms": 16328.172, "sample_throughput": 244.975, "load_time_ms": 0.332, "load_throughput": 12056062.087, "learn_time_ms": 7992.809, "learn_throughput": 500.45, "update_time_ms": 1.683}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2681797331980159, "policy_loss": -0.022162714990241434, "vf_loss": 28.881158334593618, "vf_explained_var": -0.013759550099731774, "kl": 0.00765435495030298, "entropy": 0.19051609163482983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1908000, "num_agent_steps_sampled": 1908000, "num_steps_trained": 1908000, "num_agent_steps_trained": 1908000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19240, "training_iteration": 477, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-39-14", "timestamp": 1643704754, "time_this_iter_s": 16.341530799865723, "time_total_s": 13787.469091653824, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1527.9602146148682, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 35.21739130434783, "ram_util_percent": 65.61739130434782}}
{"episode_reward_max": -1.3, "episode_reward_min": -76.89999999999995, "episode_reward_mean": -12.356000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.4, -18.599999999999998, -20.299999999999997, -8.0, -17.2, -6.4, -9.2, -7.699999999999998, -17.3, -9.2, -17.2, -5.300000000000001, -13.3, -32.3, -34.8, -19.100000000000012, -5.300000000000001, -11.2, -5.3, -5.300000000000001, -13.2, -10.799999999999997, -10.3, -4.2, -7.299999999999999, -18.800000000000004, -14.799999999999999, -7.399999999999999, -12.3, -4.3, -5.3, -16.0, -4.2, -8.3, -3.9000000000000004, -12.5, -4.3, -4.2, -20.4, -5.2, -11.4, -15.399999999999999, -12.099999999999996, -8.3, -27.50000000000002, -6.199999999999999, -3.2, -11.399999999999999, -20.2, -7.4, -71.50000000000003, -14.799999999999999, -5.4, -10.8, -3.2, -16.2, -29.9, -5.2, -7.2, -3.3, -10.8, -4.300000000000001, -15.0, -21.6, -8.2, -4.2, -4.2, -4.4, -17.1, -9.799999999999999, -6.7, -18.599999999999998, -41.3, -11.2, -12.799999999999999, -8.700000000000001, -7.3, -4.4, -26.500000000000075, -5.300000000000001, -4.2, -8.8, -14.7, -6.0, -1.3, -8.8, -4.2, -12.3, -15.5, -4.3, -11.599999999999998, -7.2, -19.1, -76.89999999999995, -2.5, -3.3, -11.4, -6.0, -3.2, -15.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.086380836104423, "mean_inference_ms": 1.4425941847067423, "mean_action_processing_ms": 0.07813271206970629, "mean_env_wait_ms": 6.58355462701227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1912000, "timesteps_this_iter": 0, "agent_timesteps_total": 1912000, "timers": {"sample_time_ms": 16158.877, "sample_throughput": 247.542, "load_time_ms": 0.335, "load_throughput": 11954692.889, "learn_time_ms": 7949.302, "learn_throughput": 503.189, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.37301868207211936, "policy_loss": -0.01865046052262187, "vf_loss": 38.942949316322164, "vf_explained_var": -0.09501406813180575, "kl": 0.011198299333698973, "entropy": 0.20016286738857786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1912000, "num_agent_steps_sampled": 1912000, "num_steps_trained": 1912000, "num_agent_steps_trained": 1912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19280, "training_iteration": 478, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-39-30", "timestamp": 1643704770, "time_this_iter_s": 16.02596402168274, "time_total_s": 13803.495055675507, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1543.986178636551, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 30.465217391304346, "ram_util_percent": 65.70000000000002}}
{"episode_reward_max": -1.3, "episode_reward_min": -76.89999999999995, "episode_reward_mean": -11.361, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.4, -15.399999999999999, -12.099999999999996, -8.3, -27.50000000000002, -6.199999999999999, -3.2, -11.399999999999999, -20.2, -7.4, -71.50000000000003, -14.799999999999999, -5.4, -10.8, -3.2, -16.2, -29.9, -5.2, -7.2, -3.3, -10.8, -4.300000000000001, -15.0, -21.6, -8.2, -4.2, -4.2, -4.4, -17.1, -9.799999999999999, -6.7, -18.599999999999998, -41.3, -11.2, -12.799999999999999, -8.700000000000001, -7.3, -4.4, -26.500000000000075, -5.300000000000001, -4.2, -8.8, -14.7, -6.0, -1.3, -8.8, -4.2, -12.3, -15.5, -4.3, -11.599999999999998, -7.2, -19.1, -76.89999999999995, -2.5, -3.3, -11.4, -6.0, -3.2, -15.2, -18.5, -13.999999999999998, -11.2, -11.999999999999996, -9.3, -14.2, -21.799999999999997, -15.399999999999986, -18.7, -6.4, -4.4, -11.2, -15.8, -3.3, -9.799999999999999, -3.2, -12.799999999999997, -11.5, -4.300000000000001, -5.4, -8.999999999999998, -3.2, -8.7, -7.399999999999999, -6.699999999999998, -14.3, -11.700000000000001, -7.7, -4.300000000000001, -5.300000000000001, -4.6000000000000005, -3.2, -5.4, -12.2, -8.3, -5.2, -9.3, -9.299999999999999, -4.2, -3.4000000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0848636033563206, "mean_inference_ms": 1.4398110559513793, "mean_action_processing_ms": 0.07797909159754181, "mean_env_wait_ms": 6.570038982967041, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1916000, "timesteps_this_iter": 0, "agent_timesteps_total": 1916000, "timers": {"sample_time_ms": 16036.331, "sample_throughput": 249.434, "load_time_ms": 0.33, "load_throughput": 12114388.042, "learn_time_ms": 7906.668, "learn_throughput": 505.902, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06960817352488076, "policy_loss": -0.013937164578706987, "vf_loss": 8.064544691225533, "vf_explained_var": 0.21994295056148241, "kl": 0.014499452581968565, "entropy": 0.2374509664152258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1916000, "num_agent_steps_sampled": 1916000, "num_steps_trained": 1916000, "num_agent_steps_trained": 1916000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19320, "training_iteration": 479, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-39-46", "timestamp": 1643704786, "time_this_iter_s": 15.816412210464478, "time_total_s": 13819.311467885971, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1559.8025908470154, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.965217391304346, "ram_util_percent": 65.70434782608697}}
{"episode_reward_max": -1.3, "episode_reward_min": -76.89999999999995, "episode_reward_mean": -10.738999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -8.8, -14.7, -6.0, -1.3, -8.8, -4.2, -12.3, -15.5, -4.3, -11.599999999999998, -7.2, -19.1, -76.89999999999995, -2.5, -3.3, -11.4, -6.0, -3.2, -15.2, -18.5, -13.999999999999998, -11.2, -11.999999999999996, -9.3, -14.2, -21.799999999999997, -15.399999999999986, -18.7, -6.4, -4.4, -11.2, -15.8, -3.3, -9.799999999999999, -3.2, -12.799999999999997, -11.5, -4.300000000000001, -5.4, -8.999999999999998, -3.2, -8.7, -7.399999999999999, -6.699999999999998, -14.3, -11.700000000000001, -7.7, -4.300000000000001, -5.300000000000001, -4.6000000000000005, -3.2, -5.4, -12.2, -8.3, -5.2, -9.3, -9.299999999999999, -4.2, -3.4000000000000004, -8.399999999999999, -7.2, -10.299999999999995, -14.299999999999999, -15.7, -4.6000000000000005, -3.6000000000000005, -17.3, -7.3, -8.199999999999998, -24.3, -7.5, -5.3, -5.2, -11.799999999999999, -15.2, -6.2, -23.40000000000003, -37.100000000000094, -23.700000000000006, -14.4, -11.199999999999998, -5.2, -17.6, -6.1, -3.4, -11.5, -12.799999999999997, -14.899999999999999, -3.7000000000000006, -4.2, -23.199999999999996, -7.4, -18.500000000000004, -3.7, -4.300000000000001, -13.999999999999998, -13.599999999999996, -10.1, -14.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0829980720337298, "mean_inference_ms": 1.436588580519886, "mean_action_processing_ms": 0.0778069423305875, "mean_env_wait_ms": 6.5546864275650725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1920000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 15963.226, "sample_throughput": 250.576, "load_time_ms": 0.332, "load_throughput": 12044810.108, "learn_time_ms": 7871.954, "learn_throughput": 508.133, "update_time_ms": 1.685}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11536805439209666, "policy_loss": -0.010933021411940616, "vf_loss": 12.485278430036319, "vf_explained_var": 0.17763126575818625, "kl": 0.007241477463642488, "entropy": 0.23408804253865315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1920000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 1920000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19360, "training_iteration": 480, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-40-01", "timestamp": 1643704801, "time_this_iter_s": 15.208138227462769, "time_total_s": 13834.519606113434, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1575.0107290744781, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 32.52857142857143, "ram_util_percent": 65.70952380952383}}
{"episode_reward_max": -3.2, "episode_reward_min": -65.3, "episode_reward_mean": -10.879000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.999999999999998, -3.2, -8.7, -7.399999999999999, -6.699999999999998, -14.3, -11.700000000000001, -7.7, -4.300000000000001, -5.300000000000001, -4.6000000000000005, -3.2, -5.4, -12.2, -8.3, -5.2, -9.3, -9.299999999999999, -4.2, -3.4000000000000004, -8.399999999999999, -7.2, -10.299999999999995, -14.299999999999999, -15.7, -4.6000000000000005, -3.6000000000000005, -17.3, -7.3, -8.199999999999998, -24.3, -7.5, -5.3, -5.2, -11.799999999999999, -15.2, -6.2, -23.40000000000003, -37.100000000000094, -23.700000000000006, -14.4, -11.199999999999998, -5.2, -17.6, -6.1, -3.4, -11.5, -12.799999999999997, -14.899999999999999, -3.7000000000000006, -4.2, -23.199999999999996, -7.4, -18.500000000000004, -3.7, -4.300000000000001, -13.999999999999998, -13.599999999999996, -10.1, -14.4, -6.2, -11.399999999999999, -9.699999999999998, -43.3, -5.4, -5.300000000000001, -6.300000000000001, -17.79999999999998, -8.3, -7.2, -12.5, -8.899999999999999, -10.299999999999997, -13.5, -11.2, -19.0, -5.2, -13.699999999999998, -7.300000000000001, -3.3, -19.0, -6.599999999999999, -65.3, -4.2, -4.2, -6.2, -6.300000000000001, -12.1, -11.799999999999999, -5.300000000000001, -8.699999999999998, -13.599999999999996, -3.2, -8.399999999999999, -6.300000000000001, -13.2, -10.899999999999999, -9.9, -16.3, -16.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0809959060105812, "mean_inference_ms": 1.433550990077047, "mean_action_processing_ms": 0.07764341552065523, "mean_env_wait_ms": 6.54046371805429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1924000, "timesteps_this_iter": 0, "agent_timesteps_total": 1924000, "timers": {"sample_time_ms": 15878.387, "sample_throughput": 251.915, "load_time_ms": 0.333, "load_throughput": 12027540.325, "learn_time_ms": 7894.97, "learn_throughput": 506.652, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2445454695344632, "policy_loss": -0.021129626231969043, "vf_loss": 26.330083805002193, "vf_explained_var": 0.28090739897502365, "kl": 0.01187134016094066, "entropy": 0.23688614140114478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1924000, "num_agent_steps_sampled": 1924000, "num_steps_trained": 1924000, "num_agent_steps_trained": 1924000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19400, "training_iteration": 481, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-40-17", "timestamp": 1643704817, "time_this_iter_s": 15.943335771560669, "time_total_s": 13850.462941884995, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1590.9540648460388, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 31.173913043478265, "ram_util_percent": 65.70000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -65.3, "episode_reward_mean": -12.021, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.4, -11.199999999999998, -5.2, -17.6, -6.1, -3.4, -11.5, -12.799999999999997, -14.899999999999999, -3.7000000000000006, -4.2, -23.199999999999996, -7.4, -18.500000000000004, -3.7, -4.300000000000001, -13.999999999999998, -13.599999999999996, -10.1, -14.4, -6.2, -11.399999999999999, -9.699999999999998, -43.3, -5.4, -5.300000000000001, -6.300000000000001, -17.79999999999998, -8.3, -7.2, -12.5, -8.899999999999999, -10.299999999999997, -13.5, -11.2, -19.0, -5.2, -13.699999999999998, -7.300000000000001, -3.3, -19.0, -6.599999999999999, -65.3, -4.2, -4.2, -6.2, -6.300000000000001, -12.1, -11.799999999999999, -5.300000000000001, -8.699999999999998, -13.599999999999996, -3.2, -8.399999999999999, -6.300000000000001, -13.2, -10.899999999999999, -9.9, -16.3, -16.4, -4.300000000000001, -14.399999999999999, -5.8999999999999995, -9.5, -14.2, -7.3, -12.399999999999999, -4.2, -7.300000000000001, -6.300000000000001, -4.300000000000001, -27.600000000000087, -5.2, -60.30000000000005, -7.300000000000001, -33.5, -12.299999999999999, -13.3, -5.300000000000001, -12.0, -8.3, -4.300000000000001, -34.400000000000006, -7.5, -12.1, -23.5, -6.2, -5.3, -11.600000000000001, -4.300000000000001, -8.799999999999997, -51.2, -7.800000000000001, -14.3, -3.3, -16.0, -5.2, -15.799999999999992, -4.2, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0793014359536002, "mean_inference_ms": 1.4306130646674442, "mean_action_processing_ms": 0.07748585955192881, "mean_env_wait_ms": 6.526628352153707, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1928000, "timesteps_this_iter": 0, "agent_timesteps_total": 1928000, "timers": {"sample_time_ms": 15906.746, "sample_throughput": 251.466, "load_time_ms": 0.337, "load_throughput": 11885247.946, "learn_time_ms": 7877.832, "learn_throughput": 507.754, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2607880868548427, "policy_loss": -0.015677117066638123, "vf_loss": 27.517620686690012, "vf_explained_var": 0.08811519511284367, "kl": 0.006445008768142658, "entropy": 0.23861827032380206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1928000, "num_agent_steps_sampled": 1928000, "num_steps_trained": 1928000, "num_agent_steps_trained": 1928000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19440, "training_iteration": 482, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-40-33", "timestamp": 1643704833, "time_this_iter_s": 15.801833868026733, "time_total_s": 13866.264775753021, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1606.7558987140656, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 65.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -168.3, "episode_reward_mean": -13.207000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, -6.599999999999999, -65.3, -4.2, -4.2, -6.2, -6.300000000000001, -12.1, -11.799999999999999, -5.300000000000001, -8.699999999999998, -13.599999999999996, -3.2, -8.399999999999999, -6.300000000000001, -13.2, -10.899999999999999, -9.9, -16.3, -16.4, -4.300000000000001, -14.399999999999999, -5.8999999999999995, -9.5, -14.2, -7.3, -12.399999999999999, -4.2, -7.300000000000001, -6.300000000000001, -4.300000000000001, -27.600000000000087, -5.2, -60.30000000000005, -7.300000000000001, -33.5, -12.299999999999999, -13.3, -5.300000000000001, -12.0, -8.3, -4.300000000000001, -34.400000000000006, -7.5, -12.1, -23.5, -6.2, -5.3, -11.600000000000001, -4.300000000000001, -8.799999999999997, -51.2, -7.800000000000001, -14.3, -3.3, -16.0, -5.2, -15.799999999999992, -4.2, -3.2, -9.3, -6.300000000000001, -4.3, -19.0, -10.4, -12.399999999999999, -3.2, -7.299999999999999, -3.2, -9.600000000000001, -5.3, -8.399999999999999, -25.1, -15.2, -9.999999999999996, -6.3, -5.2, -13.3, -15.3, -6.2, -23.3, -11.600000000000001, -5.799999999999999, -168.3, -3.3, -7.300000000000001, -10.6, -10.5, -11.299999999999999, -6.5, -5.2, -7.2, -12.8, -10.299999999999999, -9.6, -3.2, -16.9, -15.399999999999997, -16.9, -7.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0776610111305012, "mean_inference_ms": 1.4279803543881775, "mean_action_processing_ms": 0.07735951901347325, "mean_env_wait_ms": 6.514306268054498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1932000, "timesteps_this_iter": 0, "agent_timesteps_total": 1932000, "timers": {"sample_time_ms": 15884.887, "sample_throughput": 251.812, "load_time_ms": 0.334, "load_throughput": 11966630.528, "learn_time_ms": 7870.954, "learn_throughput": 508.198, "update_time_ms": 1.656}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.4686144248534856, "policy_loss": -0.017263704094339805, "vf_loss": 148.46117305178797, "vf_explained_var": -0.048895418643951416, "kl": 0.006332365304924079, "entropy": 0.2520729672684464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1932000, "num_agent_steps_sampled": 1932000, "num_steps_trained": 1932000, "num_agent_steps_trained": 1932000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19480, "training_iteration": 483, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-40-49", "timestamp": 1643704849, "time_this_iter_s": 15.843440055847168, "time_total_s": 13882.108215808868, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1622.5993387699127, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 33.4, "ram_util_percent": 65.7608695652174}}
{"episode_reward_max": -3.2, "episode_reward_min": -168.3, "episode_reward_mean": -12.789000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -4.300000000000001, -34.400000000000006, -7.5, -12.1, -23.5, -6.2, -5.3, -11.600000000000001, -4.300000000000001, -8.799999999999997, -51.2, -7.800000000000001, -14.3, -3.3, -16.0, -5.2, -15.799999999999992, -4.2, -3.2, -9.3, -6.300000000000001, -4.3, -19.0, -10.4, -12.399999999999999, -3.2, -7.299999999999999, -3.2, -9.600000000000001, -5.3, -8.399999999999999, -25.1, -15.2, -9.999999999999996, -6.3, -5.2, -13.3, -15.3, -6.2, -23.3, -11.600000000000001, -5.799999999999999, -168.3, -3.3, -7.300000000000001, -10.6, -10.5, -11.299999999999999, -6.5, -5.2, -7.2, -12.8, -10.299999999999999, -9.6, -3.2, -16.9, -15.399999999999997, -16.9, -7.300000000000001, -14.499999999999998, -18.1, -6.3, -3.3, -14.499999999999998, -10.399999999999999, -6.2, -6.2, -21.1, -9.7, -6.2, -18.600000000000005, -24.000000000000004, -9.2, -18.0, -18.5, -9.4, -6.1, -3.8000000000000003, -19.3, -14.499999999999996, -10.5, -5.300000000000001, -15.899999999999999, -26.6, -10.200000000000001, -5.499999999999999, -28.10000000000004, -16.5, -9.4, -5.4, -16.4, -3.8000000000000007, -14.799999999999999, -3.3, -8.299999999999997, -3.4, -16.199999999999996, -7.199999999999999, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.075922209259604, "mean_inference_ms": 1.4252343236350224, "mean_action_processing_ms": 0.07722628569651156, "mean_env_wait_ms": 6.501351326903719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1936000, "timesteps_this_iter": 0, "agent_timesteps_total": 1936000, "timers": {"sample_time_ms": 15872.222, "sample_throughput": 252.013, "load_time_ms": 0.352, "load_throughput": 11348225.108, "learn_time_ms": 7822.437, "learn_throughput": 511.35, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12565152943534877, "policy_loss": -0.014306533559956537, "vf_loss": 13.81789695626946, "vf_explained_var": 0.08768258370378966, "kl": 0.008895485618434078, "entropy": 0.2481740176998159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1936000, "num_agent_steps_sampled": 1936000, "num_steps_trained": 1936000, "num_agent_steps_trained": 1936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19520, "training_iteration": 484, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-41-04", "timestamp": 1643704864, "time_this_iter_s": 15.142251968383789, "time_total_s": 13897.250467777252, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1637.7415907382965, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 32.647619047619045, "ram_util_percent": 65.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -168.3, "episode_reward_mean": -12.869000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.3, -11.600000000000001, -5.799999999999999, -168.3, -3.3, -7.300000000000001, -10.6, -10.5, -11.299999999999999, -6.5, -5.2, -7.2, -12.8, -10.299999999999999, -9.6, -3.2, -16.9, -15.399999999999997, -16.9, -7.300000000000001, -14.499999999999998, -18.1, -6.3, -3.3, -14.499999999999998, -10.399999999999999, -6.2, -6.2, -21.1, -9.7, -6.2, -18.600000000000005, -24.000000000000004, -9.2, -18.0, -18.5, -9.4, -6.1, -3.8000000000000003, -19.3, -14.499999999999996, -10.5, -5.300000000000001, -15.899999999999999, -26.6, -10.200000000000001, -5.499999999999999, -28.10000000000004, -16.5, -9.4, -5.4, -16.4, -3.8000000000000007, -14.799999999999999, -3.3, -8.299999999999997, -3.4, -16.199999999999996, -7.199999999999999, -8.3, -29.2, -3.3, -12.7, -4.9, -12.999999999999998, -21.4, -3.2, -6.4, -14.89999999999998, -3.2, -13.7, -11.099999999999998, -15.5, -4.4, -12.6, -5.3, -15.7, -6.300000000000001, -17.9, -4.3, -3.2, -5.2, -18.6, -13.299999999999992, -11.499999999999988, -15.8, -18.6, -16.3, -6.0, -32.10000000000004, -11.599999999999998, -29.8, -10.2, -3.7, -5.8999999999999995, -3.4, -12.899999999999999, -3.3, -4.800000000000001, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.074120774983313, "mean_inference_ms": 1.4227301571652935, "mean_action_processing_ms": 0.07710478750214833, "mean_env_wait_ms": 6.4896976968210005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1940000, "timesteps_this_iter": 0, "agent_timesteps_total": 1940000, "timers": {"sample_time_ms": 15809.909, "sample_throughput": 253.006, "load_time_ms": 0.353, "load_throughput": 11338255.052, "learn_time_ms": 7840.481, "learn_throughput": 510.173, "update_time_ms": 1.646}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12776822729076268, "policy_loss": -0.014416151091216071, "vf_loss": 14.064469318236075, "vf_explained_var": 0.14632265663916064, "kl": 0.007698439673265872, "entropy": 0.23487184889694696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1940000, "num_agent_steps_sampled": 1940000, "num_steps_trained": 1940000, "num_agent_steps_trained": 1940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19560, "training_iteration": 485, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-41-20", "timestamp": 1643704880, "time_this_iter_s": 15.802160739898682, "time_total_s": 13913.05262851715, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1653.5437514781952, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 35.18695652173914, "ram_util_percent": 65.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -80.5, "episode_reward_mean": -11.432999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.499999999999996, -10.5, -5.300000000000001, -15.899999999999999, -26.6, -10.200000000000001, -5.499999999999999, -28.10000000000004, -16.5, -9.4, -5.4, -16.4, -3.8000000000000007, -14.799999999999999, -3.3, -8.299999999999997, -3.4, -16.199999999999996, -7.199999999999999, -8.3, -29.2, -3.3, -12.7, -4.9, -12.999999999999998, -21.4, -3.2, -6.4, -14.89999999999998, -3.2, -13.7, -11.099999999999998, -15.5, -4.4, -12.6, -5.3, -15.7, -6.300000000000001, -17.9, -4.3, -3.2, -5.2, -18.6, -13.299999999999992, -11.499999999999988, -15.8, -18.6, -16.3, -6.0, -32.10000000000004, -11.599999999999998, -29.8, -10.2, -3.7, -5.8999999999999995, -3.4, -12.899999999999999, -3.3, -4.800000000000001, -5.4, -3.7000000000000006, -31.50000000000001, -12.4, -9.799999999999997, -9.5, -3.8000000000000007, -15.2, -6.899999999999999, -6.3999999999999995, -6.199999999999999, -11.3, -16.599999999999998, -11.999999999999998, -3.3000000000000007, -3.3, -4.800000000000001, -3.2, -17.599999999999998, -18.5, -3.2, -11.899999999999999, -15.299999999999995, -11.8, -15.300000000000015, -8.4, -4.1, -3.2, -9.299999999999995, -4.4, -4.2, -19.2, -7.3, -25.5, -80.5, -3.8000000000000003, -5.0, -3.3, -3.3, -19.799999999999997, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0724213391148607, "mean_inference_ms": 1.4201047656033803, "mean_action_processing_ms": 0.07696393645064893, "mean_env_wait_ms": 6.477297873234379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1944000, "timesteps_this_iter": 0, "agent_timesteps_total": 1944000, "timers": {"sample_time_ms": 15818.073, "sample_throughput": 252.875, "load_time_ms": 0.368, "load_throughput": 10863258.223, "learn_time_ms": 7799.469, "learn_throughput": 512.855, "update_time_ms": 1.653}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3648643457859014, "policy_loss": -0.02642989345295455, "vf_loss": 38.84751803285332, "vf_explained_var": -0.015816278996006135, "kl": 0.01409533718744108, "entropy": 0.24213115141917302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1944000, "num_agent_steps_sampled": 1944000, "num_steps_trained": 1944000, "num_agent_steps_trained": 1944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19600, "training_iteration": 486, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-41-36", "timestamp": 1643704896, "time_this_iter_s": 15.518968105316162, "time_total_s": 13928.571596622467, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1669.0627195835114, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.677272727272726, "ram_util_percent": 65.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -80.5, "episode_reward_mean": -12.145999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -5.2, -18.6, -13.299999999999992, -11.499999999999988, -15.8, -18.6, -16.3, -6.0, -32.10000000000004, -11.599999999999998, -29.8, -10.2, -3.7, -5.8999999999999995, -3.4, -12.899999999999999, -3.3, -4.800000000000001, -5.4, -3.7000000000000006, -31.50000000000001, -12.4, -9.799999999999997, -9.5, -3.8000000000000007, -15.2, -6.899999999999999, -6.3999999999999995, -6.199999999999999, -11.3, -16.599999999999998, -11.999999999999998, -3.3000000000000007, -3.3, -4.800000000000001, -3.2, -17.599999999999998, -18.5, -3.2, -11.899999999999999, -15.299999999999995, -11.8, -15.300000000000015, -8.4, -4.1, -3.2, -9.299999999999995, -4.4, -4.2, -19.2, -7.3, -25.5, -80.5, -3.8000000000000003, -5.0, -3.3, -3.3, -19.799999999999997, -8.3, -7.800000000000001, -21.800000000000004, -15.7, -8.2, -15.1, -8.2, -10.5, -3.4, -24.4, -6.0, -8.799999999999999, -11.5, -3.2, -43.3, -4.5, -24.3, -19.7, -30.600000000000005, -23.3, -23.9, -4.2, -4.2, -14.099999999999998, -14.999999999999998, -9.0, -4.300000000000001, -4.300000000000001, -32.800000000000004, -11.6, -3.3, -7.3, -12.7, -3.6000000000000005, -12.999999999999998, -5.2, -5.300000000000001, -15.3, -5.2, -24.600000000000005, -10.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0706502625070602, "mean_inference_ms": 1.4176189323665784, "mean_action_processing_ms": 0.07682861851050853, "mean_env_wait_ms": 6.465458218003262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1948000, "timesteps_this_iter": 0, "agent_timesteps_total": 1948000, "timers": {"sample_time_ms": 15720.555, "sample_throughput": 254.444, "load_time_ms": 0.369, "load_throughput": 10850611.823, "learn_time_ms": 7796.231, "learn_throughput": 513.068, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1862118677466467, "policy_loss": -0.01187504404474811, "vf_loss": 19.673027157527144, "vf_explained_var": 0.1426951378263453, "kl": 0.006783217184732295, "entropy": 0.1943204599602889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1948000, "num_agent_steps_sampled": 1948000, "num_steps_trained": 1948000, "num_agent_steps_trained": 1948000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19640, "training_iteration": 487, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-41-51", "timestamp": 1643704911, "time_this_iter_s": 15.74008297920227, "time_total_s": 13944.31167960167, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1684.8028025627136, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 32.449999999999996, "ram_util_percent": 65.75909090909092}}
{"episode_reward_max": -1.2, "episode_reward_min": -80.5, "episode_reward_mean": -12.452000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999999, -15.299999999999995, -11.8, -15.300000000000015, -8.4, -4.1, -3.2, -9.299999999999995, -4.4, -4.2, -19.2, -7.3, -25.5, -80.5, -3.8000000000000003, -5.0, -3.3, -3.3, -19.799999999999997, -8.3, -7.800000000000001, -21.800000000000004, -15.7, -8.2, -15.1, -8.2, -10.5, -3.4, -24.4, -6.0, -8.799999999999999, -11.5, -3.2, -43.3, -4.5, -24.3, -19.7, -30.600000000000005, -23.3, -23.9, -4.2, -4.2, -14.099999999999998, -14.999999999999998, -9.0, -4.300000000000001, -4.300000000000001, -32.800000000000004, -11.6, -3.3, -7.3, -12.7, -3.6000000000000005, -12.999999999999998, -5.2, -5.300000000000001, -15.3, -5.2, -24.600000000000005, -10.700000000000001, -7.699999999999998, -27.700000000000024, -12.5, -5.2, -4.2, -9.3, -10.3, -14.299999999999997, -7.2, -11.6, -13.3, -1.2, -17.8, -20.500000000000004, -3.3, -20.5, -26.200000000000017, -3.2, -5.8, -5.1, -8.599999999999998, -4.6000000000000005, -6.399999999999999, -28.90000000000001, -9.2, -8.8, -5.000000000000001, -6.499999999999999, -7.9, -17.3, -13.899999999999997, -14.1, -5.0, -20.3, -9.3, -11.7, -8.2, -28.399999999999984, -6.199999999999999, -14.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0694403495808924, "mean_inference_ms": 1.415211823848593, "mean_action_processing_ms": 0.07669739170143455, "mean_env_wait_ms": 6.453601401186868, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1952000, "timesteps_this_iter": 0, "agent_timesteps_total": 1952000, "timers": {"sample_time_ms": 15709.161, "sample_throughput": 254.628, "load_time_ms": 0.367, "load_throughput": 10886520.018, "learn_time_ms": 7756.777, "learn_throughput": 515.678, "update_time_ms": 1.648}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12610547631298022, "policy_loss": -0.016965997918078336, "vf_loss": 14.15861054287162, "vf_explained_var": 0.08252601751717188, "kl": 0.007426866414588851, "entropy": 0.21580087232493586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1952000, "num_agent_steps_sampled": 1952000, "num_steps_trained": 1952000, "num_agent_steps_trained": 1952000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19680, "training_iteration": 488, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-42-07", "timestamp": 1643704927, "time_this_iter_s": 15.557225942611694, "time_total_s": 13959.868905544281, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1700.3600285053253, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 31.4, "ram_util_percent": 65.77272727272727}}
{"episode_reward_max": -1.2, "episode_reward_min": -32.800000000000004, "episode_reward_mean": -10.831000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -4.2, -14.099999999999998, -14.999999999999998, -9.0, -4.300000000000001, -4.300000000000001, -32.800000000000004, -11.6, -3.3, -7.3, -12.7, -3.6000000000000005, -12.999999999999998, -5.2, -5.300000000000001, -15.3, -5.2, -24.600000000000005, -10.700000000000001, -7.699999999999998, -27.700000000000024, -12.5, -5.2, -4.2, -9.3, -10.3, -14.299999999999997, -7.2, -11.6, -13.3, -1.2, -17.8, -20.500000000000004, -3.3, -20.5, -26.200000000000017, -3.2, -5.8, -5.1, -8.599999999999998, -4.6000000000000005, -6.399999999999999, -28.90000000000001, -9.2, -8.8, -5.000000000000001, -6.499999999999999, -7.9, -17.3, -13.899999999999997, -14.1, -5.0, -20.3, -9.3, -11.7, -8.2, -28.399999999999984, -6.199999999999999, -14.2, -11.3, -10.2, -4.300000000000001, -20.2, -4.3, -4.6000000000000005, -3.4, -11.3, -7.2, -3.3, -22.599999999999998, -12.099999999999996, -21.1, -6.4, -5.300000000000001, -8.3, -9.1, -8.2, -16.2, -12.4, -3.2, -10.899999999999999, -2.6000000000000005, -15.099999999999998, -2.4000000000000004, -6.3999999999999995, -5.2, -20.3, -6.9, -22.3, -21.600000000000005, -12.6, -6.199999999999999, -5.3, -4.2, -13.3, -6.1, -18.399999999999988, -12.5, -18.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.06828337301887, "mean_inference_ms": 1.4129840719427156, "mean_action_processing_ms": 0.07657392129591202, "mean_env_wait_ms": 6.4426923509424405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1956000, "timesteps_this_iter": 0, "agent_timesteps_total": 1956000, "timers": {"sample_time_ms": 15664.121, "sample_throughput": 255.361, "load_time_ms": 0.365, "load_throughput": 10951900.255, "learn_time_ms": 7759.926, "learn_throughput": 515.469, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08785556638413058, "policy_loss": -0.011845458605857466, "vf_loss": 9.801959601973975, "vf_explained_var": 0.11090970154731504, "kl": 0.008407159312420425, "entropy": 0.17677886042223181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1956000, "num_agent_steps_sampled": 1956000, "num_steps_trained": 1956000, "num_agent_steps_trained": 1956000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19720, "training_iteration": 489, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-42-23", "timestamp": 1643704943, "time_this_iter_s": 15.78639817237854, "time_total_s": 13975.65530371666, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1716.1464266777039, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.778260869565226, "ram_util_percent": 65.77391304347826}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -28.90000000000001, "episode_reward_mean": -10.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.599999999999998, -4.6000000000000005, -6.399999999999999, -28.90000000000001, -9.2, -8.8, -5.000000000000001, -6.499999999999999, -7.9, -17.3, -13.899999999999997, -14.1, -5.0, -20.3, -9.3, -11.7, -8.2, -28.399999999999984, -6.199999999999999, -14.2, -11.3, -10.2, -4.300000000000001, -20.2, -4.3, -4.6000000000000005, -3.4, -11.3, -7.2, -3.3, -22.599999999999998, -12.099999999999996, -21.1, -6.4, -5.300000000000001, -8.3, -9.1, -8.2, -16.2, -12.4, -3.2, -10.899999999999999, -2.6000000000000005, -15.099999999999998, -2.4000000000000004, -6.3999999999999995, -5.2, -20.3, -6.9, -22.3, -21.600000000000005, -12.6, -6.199999999999999, -5.3, -4.2, -13.3, -6.1, -18.399999999999988, -12.5, -18.700000000000003, -9.0, -12.3, -8.600000000000001, -22.7, -5.2, -10.3, -9.5, -10.100000000000001, -7.199999999999999, -4.4, -14.5, -10.2, -5.0, -7.1, -5.3, -8.3, -8.199999999999998, -7.799999999999998, -10.399999999999999, -3.3, -4.300000000000001, -5.2, -14.199999999999996, -3.3, -5.300000000000001, -10.699999999999992, -8.3, -12.600000000000001, -5.3, -3.6, -14.299999999999997, -13.8, -15.899999999999999, -7.2, -20.6, -15.6, -6.799999999999999, -19.799999999999997, -6.3, -12.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0671045332835578, "mean_inference_ms": 1.410944148885465, "mean_action_processing_ms": 0.0764616230886903, "mean_env_wait_ms": 6.432639346655158, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1960000, "timesteps_this_iter": 0, "agent_timesteps_total": 1960000, "timers": {"sample_time_ms": 15741.201, "sample_throughput": 254.11, "load_time_ms": 0.374, "load_throughput": 10685444.239, "learn_time_ms": 7775.398, "learn_throughput": 514.443, "update_time_ms": 1.627}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.05217840372915229, "policy_loss": -0.00667178474506864, "vf_loss": 5.758588236906836, "vf_explained_var": 0.38320545329842515, "kl": 0.00632155092805729, "entropy": 0.18147321606195102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1960000, "num_agent_steps_sampled": 1960000, "num_steps_trained": 1960000, "num_agent_steps_trained": 1960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19760, "training_iteration": 490, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-42-39", "timestamp": 1643704959, "time_this_iter_s": 16.10509991645813, "time_total_s": 13991.760403633118, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1732.251526594162, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 29.308695652173913, "ram_util_percent": 65.79999999999998}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -25.4, "episode_reward_mean": -9.905999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -10.899999999999999, -2.6000000000000005, -15.099999999999998, -2.4000000000000004, -6.3999999999999995, -5.2, -20.3, -6.9, -22.3, -21.600000000000005, -12.6, -6.199999999999999, -5.3, -4.2, -13.3, -6.1, -18.399999999999988, -12.5, -18.700000000000003, -9.0, -12.3, -8.600000000000001, -22.7, -5.2, -10.3, -9.5, -10.100000000000001, -7.199999999999999, -4.4, -14.5, -10.2, -5.0, -7.1, -5.3, -8.3, -8.199999999999998, -7.799999999999998, -10.399999999999999, -3.3, -4.300000000000001, -5.2, -14.199999999999996, -3.3, -5.300000000000001, -10.699999999999992, -8.3, -12.600000000000001, -5.3, -3.6, -14.299999999999997, -13.8, -15.899999999999999, -7.2, -20.6, -15.6, -6.799999999999999, -19.799999999999997, -6.3, -12.0, -10.899999999999999, -6.4, -5.300000000000001, -3.2, -25.4, -7.2, -17.5, -15.100000000000001, -4.2, -4.300000000000001, -10.2, -11.5, -4.3, -12.700000000000001, -2.6000000000000005, -18.3, -3.4, -4.2, -6.2, -7.700000000000003, -20.100000000000005, -4.2, -12.399999999999999, -3.3, -16.599999999999994, -2.5, -4.2, -12.499999999999998, -9.5, -3.4, -9.2, -3.4, -22.0, -9.2, -5.300000000000001, -15.1, -14.799999999999999, -17.3, -16.799999999999997, -9.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0657527534424196, "mean_inference_ms": 1.4090403985740665, "mean_action_processing_ms": 0.07635968378293762, "mean_env_wait_ms": 6.4231667677850695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1964000, "timesteps_this_iter": 0, "agent_timesteps_total": 1964000, "timers": {"sample_time_ms": 15761.509, "sample_throughput": 253.783, "load_time_ms": 0.372, "load_throughput": 10751179.75, "learn_time_ms": 7744.302, "learn_throughput": 516.509, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06325160622076001, "policy_loss": -0.00977402095913246, "vf_loss": 7.08424548601271, "vf_explained_var": 0.3862651931342258, "kl": 0.010915855050279295, "entropy": 0.1967992933447002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1964000, "num_agent_steps_sampled": 1964000, "num_steps_trained": 1964000, "num_agent_steps_trained": 1964000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19800, "training_iteration": 491, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-42-55", "timestamp": 1643704975, "time_this_iter_s": 15.680798292160034, "time_total_s": 14007.441201925278, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1747.932324886322, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.722727272727273, "ram_util_percent": 65.75909090909092}}
{"episode_reward_max": -2.5, "episode_reward_min": -31.900000000000063, "episode_reward_mean": -10.476999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -5.2, -14.199999999999996, -3.3, -5.300000000000001, -10.699999999999992, -8.3, -12.600000000000001, -5.3, -3.6, -14.299999999999997, -13.8, -15.899999999999999, -7.2, -20.6, -15.6, -6.799999999999999, -19.799999999999997, -6.3, -12.0, -10.899999999999999, -6.4, -5.300000000000001, -3.2, -25.4, -7.2, -17.5, -15.100000000000001, -4.2, -4.300000000000001, -10.2, -11.5, -4.3, -12.700000000000001, -2.6000000000000005, -18.3, -3.4, -4.2, -6.2, -7.700000000000003, -20.100000000000005, -4.2, -12.399999999999999, -3.3, -16.599999999999994, -2.5, -4.2, -12.499999999999998, -9.5, -3.4, -9.2, -3.4, -22.0, -9.2, -5.300000000000001, -15.1, -14.799999999999999, -17.3, -16.799999999999997, -9.5, -4.2, -7.5, -4.2, -4.300000000000001, -17.5, -8.5, -2.7, -3.2, -10.2, -8.3, -18.600000000000023, -28.8, -4.300000000000001, -18.399999999999995, -9.099999999999998, -14.299999999999997, -9.3, -6.4, -10.599999999999998, -16.099999999999984, -3.6000000000000005, -12.899999999999999, -16.6, -9.700000000000001, -3.3, -14.8, -17.900000000000006, -12.599999999999994, -9.5, -19.2, -10.700000000000001, -31.900000000000063, -9.0, -3.3, -6.4, -15.999999999999998, -10.3, -8.5, -19.2, -8.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0644259022529219, "mean_inference_ms": 1.4071066979908198, "mean_action_processing_ms": 0.07625759432570613, "mean_env_wait_ms": 6.413957742504085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1968000, "timesteps_this_iter": 0, "agent_timesteps_total": 1968000, "timers": {"sample_time_ms": 15733.254, "sample_throughput": 254.239, "load_time_ms": 0.37, "load_throughput": 10824010.323, "learn_time_ms": 7711.425, "learn_throughput": 518.711, "update_time_ms": 1.638}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09850512036830888, "policy_loss": -0.012839700766809044, "vf_loss": 10.953018167839256, "vf_explained_var": 0.36351422750821677, "kl": 0.009073198106392545, "entropy": 0.2136763686214083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1968000, "num_agent_steps_sampled": 1968000, "num_steps_trained": 1968000, "num_agent_steps_trained": 1968000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19840, "training_iteration": 492, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-43-10", "timestamp": 1643704990, "time_this_iter_s": 15.498780012130737, "time_total_s": 14022.939981937408, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1763.4311048984528, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.963636363636372, "ram_util_percent": 65.79999999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -31.900000000000063, "episode_reward_mean": -10.559000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.100000000000005, -4.2, -12.399999999999999, -3.3, -16.599999999999994, -2.5, -4.2, -12.499999999999998, -9.5, -3.4, -9.2, -3.4, -22.0, -9.2, -5.300000000000001, -15.1, -14.799999999999999, -17.3, -16.799999999999997, -9.5, -4.2, -7.5, -4.2, -4.300000000000001, -17.5, -8.5, -2.7, -3.2, -10.2, -8.3, -18.600000000000023, -28.8, -4.300000000000001, -18.399999999999995, -9.099999999999998, -14.299999999999997, -9.3, -6.4, -10.599999999999998, -16.099999999999984, -3.6000000000000005, -12.899999999999999, -16.6, -9.700000000000001, -3.3, -14.8, -17.900000000000006, -12.599999999999994, -9.5, -19.2, -10.700000000000001, -31.900000000000063, -9.0, -3.3, -6.4, -15.999999999999998, -10.3, -8.5, -19.2, -8.799999999999997, -5.2, -13.599999999999996, -18.20000000000001, -5.999999999999999, -3.4, -10.799999999999999, -5.3, -14.899999999999999, -4.300000000000001, -8.3, -6.3, -10.199999999999998, -19.599999999999998, -4.3, -22.800000000000008, -11.7, -9.4, -8.600000000000001, -4.2, -16.2, -2.2, -10.6, -4.5, -18.4, -20.100000000000016, -3.7000000000000006, -6.8, -6.5, -5.300000000000001, -20.799999999999997, -22.4, -11.6, -9.999999999999998, -15.099999999999998, -3.3, -5.2, -9.1, -5.4, -4.4, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0632848670525363, "mean_inference_ms": 1.4059953992994332, "mean_action_processing_ms": 0.0761721911068578, "mean_env_wait_ms": 6.40638673168056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1972000, "timesteps_this_iter": 0, "agent_timesteps_total": 1972000, "timers": {"sample_time_ms": 15772.416, "sample_throughput": 253.607, "load_time_ms": 0.365, "load_throughput": 10966934.24, "learn_time_ms": 7723.113, "learn_throughput": 517.926, "update_time_ms": 1.655}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07946953658885773, "policy_loss": -0.015880548269037276, "vf_loss": 9.330008622651459, "vf_explained_var": 0.22426439273741938, "kl": 0.010250001512588949, "entropy": 0.21314878435705298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1972000, "num_agent_steps_sampled": 1972000, "num_steps_trained": 1972000, "num_agent_steps_trained": 1972000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19880, "training_iteration": 493, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-43-27", "timestamp": 1643705007, "time_this_iter_s": 16.680658102035522, "time_total_s": 14039.620640039444, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1780.1117630004883, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 34.475, "ram_util_percent": 65.81666666666666}}
{"episode_reward_max": -2.2, "episode_reward_min": -43.6, "episode_reward_mean": -11.836000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -12.899999999999999, -16.6, -9.700000000000001, -3.3, -14.8, -17.900000000000006, -12.599999999999994, -9.5, -19.2, -10.700000000000001, -31.900000000000063, -9.0, -3.3, -6.4, -15.999999999999998, -10.3, -8.5, -19.2, -8.799999999999997, -5.2, -13.599999999999996, -18.20000000000001, -5.999999999999999, -3.4, -10.799999999999999, -5.3, -14.899999999999999, -4.300000000000001, -8.3, -6.3, -10.199999999999998, -19.599999999999998, -4.3, -22.800000000000008, -11.7, -9.4, -8.600000000000001, -4.2, -16.2, -2.2, -10.6, -4.5, -18.4, -20.100000000000016, -3.7000000000000006, -6.8, -6.5, -5.300000000000001, -20.799999999999997, -22.4, -11.6, -9.999999999999998, -15.099999999999998, -3.3, -5.2, -9.1, -5.4, -4.4, -5.2, -30.500000000000053, -7.3999999999999995, -14.399999999999999, -4.2, -11.799999999999999, -5.4, -43.6, -10.200000000000001, -9.0, -12.39999999999998, -12.2, -16.6, -7.3, -16.499999999999993, -6.300000000000001, -4.2, -23.900000000000002, -4.3, -4.300000000000001, -7.699999999999999, -10.7, -4.300000000000001, -4.300000000000001, -33.5, -7.099999999999999, -3.2, -10.2, -25.70000000000001, -3.2, -24.7, -18.999999999999986, -35.3, -15.7, -17.299999999999997, -19.5, -12.5, -2.5, -26.2, -10.1, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0628747878809504, "mean_inference_ms": 1.4051239665816582, "mean_action_processing_ms": 0.07609552625897305, "mean_env_wait_ms": 6.399569304953753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1976000, "timesteps_this_iter": 0, "agent_timesteps_total": 1976000, "timers": {"sample_time_ms": 15849.266, "sample_throughput": 252.378, "load_time_ms": 0.357, "load_throughput": 11210220.5, "learn_time_ms": 7706.344, "learn_throughput": 519.053, "update_time_ms": 1.722}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2097700818291595, "policy_loss": -0.009971138714782654, "vf_loss": 21.79490482608477, "vf_explained_var": 0.21008154858825026, "kl": 0.008960872892680147, "entropy": 0.22371879473168363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1976000, "num_agent_steps_sampled": 1976000, "num_steps_trained": 1976000, "num_agent_steps_trained": 1976000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19920, "training_iteration": 494, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-43-43", "timestamp": 1643705023, "time_this_iter_s": 15.630990028381348, "time_total_s": 14055.251630067825, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1795.7427530288696, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 32.58636363636364, "ram_util_percent": 65.8818181818182}}
{"episode_reward_max": -2.2, "episode_reward_min": -43.6, "episode_reward_mean": -11.425999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2, -10.6, -4.5, -18.4, -20.100000000000016, -3.7000000000000006, -6.8, -6.5, -5.300000000000001, -20.799999999999997, -22.4, -11.6, -9.999999999999998, -15.099999999999998, -3.3, -5.2, -9.1, -5.4, -4.4, -5.2, -30.500000000000053, -7.3999999999999995, -14.399999999999999, -4.2, -11.799999999999999, -5.4, -43.6, -10.200000000000001, -9.0, -12.39999999999998, -12.2, -16.6, -7.3, -16.499999999999993, -6.300000000000001, -4.2, -23.900000000000002, -4.3, -4.300000000000001, -7.699999999999999, -10.7, -4.300000000000001, -4.300000000000001, -33.5, -7.099999999999999, -3.2, -10.2, -25.70000000000001, -3.2, -24.7, -18.999999999999986, -35.3, -15.7, -17.299999999999997, -19.5, -12.5, -2.5, -26.2, -10.1, -8.3, -11.9, -10.200000000000001, -10.7, -5.3, -5.899999999999999, -8.6, -3.4, -34.5, -4.4, -19.3, -9.6, -3.2, -5.300000000000001, -4.2, -12.799999999999999, -5.3, -11.1, -3.5000000000000004, -4.6000000000000005, -9.899999999999999, -3.2, -13.6, -8.899999999999999, -15.999999999999998, -15.0, -3.3, -5.300000000000001, -7.2, -18.099999999999998, -17.5, -7.0, -9.299999999999999, -13.899999999999999, -27.800000000000004, -6.2, -5.5, -11.5, -11.6, -17.7, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0613494743530112, "mean_inference_ms": 1.4037167444996848, "mean_action_processing_ms": 0.07600731571583735, "mean_env_wait_ms": 6.392212992483649, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1980000, "timesteps_this_iter": 0, "agent_timesteps_total": 1980000, "timers": {"sample_time_ms": 15781.84, "sample_throughput": 253.456, "load_time_ms": 0.353, "load_throughput": 11322186.53, "learn_time_ms": 7748.29, "learn_throughput": 516.243, "update_time_ms": 1.711}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08995571685103719, "policy_loss": -0.016927493841297204, "vf_loss": 10.539900322787224, "vf_explained_var": 0.15603007167898197, "kl": 0.0074210559410902354, "entropy": 0.24781795160905007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1980000, "num_agent_steps_sampled": 1980000, "num_steps_trained": 1980000, "num_agent_steps_trained": 1980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19960, "training_iteration": 495, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-43-58", "timestamp": 1643705038, "time_this_iter_s": 15.701923131942749, "time_total_s": 14070.953553199768, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1811.4446761608124, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.31363636363636, "ram_util_percent": 65.90000000000003}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -35.3, "episode_reward_mean": -11.481000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.7, -4.300000000000001, -4.300000000000001, -33.5, -7.099999999999999, -3.2, -10.2, -25.70000000000001, -3.2, -24.7, -18.999999999999986, -35.3, -15.7, -17.299999999999997, -19.5, -12.5, -2.5, -26.2, -10.1, -8.3, -11.9, -10.200000000000001, -10.7, -5.3, -5.899999999999999, -8.6, -3.4, -34.5, -4.4, -19.3, -9.6, -3.2, -5.300000000000001, -4.2, -12.799999999999999, -5.3, -11.1, -3.5000000000000004, -4.6000000000000005, -9.899999999999999, -3.2, -13.6, -8.899999999999999, -15.999999999999998, -15.0, -3.3, -5.300000000000001, -7.2, -18.099999999999998, -17.5, -7.0, -9.299999999999999, -13.899999999999999, -27.800000000000004, -6.2, -5.5, -11.5, -11.6, -17.7, -4.2, -8.3, -12.0, -13.899999999999999, -34.3, -11.7, -6.2, -18.400000000000002, -15.6, -24.5, -18.6, -20.7, -4.3, -5.2, -4.2, -4.2, -4.4, -4.300000000000001, -4.300000000000001, -12.199999999999973, -13.699999999999998, -3.2, -15.399999999999999, -21.400000000000002, -16.4, -14.999999999999996, -6.3, -11.3, -2.4000000000000004, -4.2, -4.300000000000001, -10.2, -15.999999999999998, -9.3, -25.600000000000005, -3.3, -13.899999999999999, -3.2, -5.300000000000001, -16.4, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.059635761825553, "mean_inference_ms": 1.4019984696076206, "mean_action_processing_ms": 0.07591005993714797, "mean_env_wait_ms": 6.384053483480321, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1984000, "timesteps_this_iter": 0, "agent_timesteps_total": 1984000, "timers": {"sample_time_ms": 15859.349, "sample_throughput": 252.217, "load_time_ms": 0.338, "load_throughput": 11820767.984, "learn_time_ms": 7755.977, "learn_throughput": 515.731, "update_time_ms": 1.731}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10190568979709379, "policy_loss": -0.01939245288570722, "vf_loss": 11.980002442482979, "vf_explained_var": 0.06832408648665234, "kl": 0.007490606965039481, "entropy": 0.204227496395188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1984000, "num_agent_steps_sampled": 1984000, "num_steps_trained": 1984000, "num_agent_steps_trained": 1984000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20000, "training_iteration": 496, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-44-14", "timestamp": 1643705054, "time_this_iter_s": 15.9514319896698, "time_total_s": 14086.904985189438, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1827.3961081504822, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 30.21739130434782, "ram_util_percent": 65.76521739130436}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -113.7000000000001, "episode_reward_mean": -11.969999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -13.6, -8.899999999999999, -15.999999999999998, -15.0, -3.3, -5.300000000000001, -7.2, -18.099999999999998, -17.5, -7.0, -9.299999999999999, -13.899999999999999, -27.800000000000004, -6.2, -5.5, -11.5, -11.6, -17.7, -4.2, -8.3, -12.0, -13.899999999999999, -34.3, -11.7, -6.2, -18.400000000000002, -15.6, -24.5, -18.6, -20.7, -4.3, -5.2, -4.2, -4.2, -4.4, -4.300000000000001, -4.300000000000001, -12.199999999999973, -13.699999999999998, -3.2, -15.399999999999999, -21.400000000000002, -16.4, -14.999999999999996, -6.3, -11.3, -2.4000000000000004, -4.2, -4.300000000000001, -10.2, -15.999999999999998, -9.3, -25.600000000000005, -3.3, -13.899999999999999, -3.2, -5.300000000000001, -16.4, -4.2, -3.3, -3.2, -13.19999999999997, -7.300000000000001, -5.300000000000001, -5.899999999999998, -27.100000000000005, -3.2, -10.3, -11.4, -14.0, -17.3, -8.4, -14.5, -113.7000000000001, -14.499999999999998, -24.199999999999996, -5.299999999999999, -4.2, -11.2, -4.300000000000001, -19.199999999999996, -5.300000000000001, -4.6000000000000005, -4.300000000000001, -5.300000000000001, -8.0, -21.2, -3.3, -4.300000000000001, -4.4, -9.8, -22.3, -4.300000000000001, -18.999999999999996, -5.799999999999999, -13.600000000000001, -19.599999999999962, -16.099999999999994, -13.699999999999978], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0579521489341193, "mean_inference_ms": 1.400047607726672, "mean_action_processing_ms": 0.07580086664776395, "mean_env_wait_ms": 6.374764685177342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1988000, "timesteps_this_iter": 0, "agent_timesteps_total": 1988000, "timers": {"sample_time_ms": 15862.255, "sample_throughput": 252.171, "load_time_ms": 0.345, "load_throughput": 11601698.361, "learn_time_ms": 7771.459, "learn_throughput": 514.704, "update_time_ms": 1.735}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.7112295783012205, "policy_loss": -0.024060070566752904, "vf_loss": 73.33551652239215, "vf_explained_var": 0.09671631775876527, "kl": 0.009672558957583902, "entropy": 0.23192159270326937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1988000, "num_agent_steps_sampled": 1988000, "num_steps_trained": 1988000, "num_agent_steps_trained": 1988000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20040, "training_iteration": 497, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-44-30", "timestamp": 1643705070, "time_this_iter_s": 15.839043855667114, "time_total_s": 14102.744029045105, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1843.2351520061493, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 26.6304347826087, "ram_util_percent": 65.81304347826085}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -113.7000000000001, "episode_reward_mean": -12.266000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -15.399999999999999, -21.400000000000002, -16.4, -14.999999999999996, -6.3, -11.3, -2.4000000000000004, -4.2, -4.300000000000001, -10.2, -15.999999999999998, -9.3, -25.600000000000005, -3.3, -13.899999999999999, -3.2, -5.300000000000001, -16.4, -4.2, -3.3, -3.2, -13.19999999999997, -7.300000000000001, -5.300000000000001, -5.899999999999998, -27.100000000000005, -3.2, -10.3, -11.4, -14.0, -17.3, -8.4, -14.5, -113.7000000000001, -14.499999999999998, -24.199999999999996, -5.299999999999999, -4.2, -11.2, -4.300000000000001, -19.199999999999996, -5.300000000000001, -4.6000000000000005, -4.300000000000001, -5.300000000000001, -8.0, -21.2, -3.3, -4.300000000000001, -4.4, -9.8, -22.3, -4.300000000000001, -18.999999999999996, -5.799999999999999, -13.600000000000001, -19.599999999999962, -16.099999999999994, -13.699999999999978, -17.9, -13.1, -14.19999999999997, -17.299999999999997, -14.899999999999999, -9.099999999999998, -15.1, -14.2, -9.499999999999996, -12.999999999999998, -4.300000000000001, -16.4, -11.299999999999999, -10.4, -15.3, -15.999999999999996, -19.1, -28.0, -5.300000000000001, -10.100000000000001, -6.199999999999999, -7.4, -3.8000000000000003, -16.599999999999998, -2.8000000000000003, -24.2, -5.2, -12.8, -11.5, -17.099999999999998, -22.900000000000002, -13.199999999999998, -3.3, -4.2, -15.7, -8.3, -12.099999999999996, -4.9, -6.3, -20.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0567088363413446, "mean_inference_ms": 1.3981658857348451, "mean_action_processing_ms": 0.07569705959114317, "mean_env_wait_ms": 6.365245857836221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1992000, "timesteps_this_iter": 0, "agent_timesteps_total": 1992000, "timers": {"sample_time_ms": 15889.941, "sample_throughput": 251.732, "load_time_ms": 0.351, "load_throughput": 11409191.431, "learn_time_ms": 7741.12, "learn_throughput": 516.721, "update_time_ms": 1.709}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10478890705653417, "policy_loss": -0.019533743052392877, "vf_loss": 12.229073363606648, "vf_explained_var": 0.1221331137482838, "kl": 0.010159593791380046, "entropy": 0.2562700858199468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1992000, "num_agent_steps_sampled": 1992000, "num_steps_trained": 1992000, "num_agent_steps_trained": 1992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20080, "training_iteration": 498, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-44-46", "timestamp": 1643705086, "time_this_iter_s": 15.37160611152649, "time_total_s": 14118.115635156631, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1858.6067581176758, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 32.45454545454545, "ram_util_percent": 65.86363636363636}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -43.6, "episode_reward_mean": -11.881999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -19.199999999999996, -5.300000000000001, -4.6000000000000005, -4.300000000000001, -5.300000000000001, -8.0, -21.2, -3.3, -4.300000000000001, -4.4, -9.8, -22.3, -4.300000000000001, -18.999999999999996, -5.799999999999999, -13.600000000000001, -19.599999999999962, -16.099999999999994, -13.699999999999978, -17.9, -13.1, -14.19999999999997, -17.299999999999997, -14.899999999999999, -9.099999999999998, -15.1, -14.2, -9.499999999999996, -12.999999999999998, -4.300000000000001, -16.4, -11.299999999999999, -10.4, -15.3, -15.999999999999996, -19.1, -28.0, -5.300000000000001, -10.100000000000001, -6.199999999999999, -7.4, -3.8000000000000003, -16.599999999999998, -2.8000000000000003, -24.2, -5.2, -12.8, -11.5, -17.099999999999998, -22.900000000000002, -13.199999999999998, -3.3, -4.2, -15.7, -8.3, -12.099999999999996, -4.9, -6.3, -20.4, -15.899999999999984, -8.100000000000001, -21.699999999999996, -3.2, -4.300000000000001, -4.300000000000001, -21.400000000000002, -3.3, -19.700000000000006, -19.9, -18.9, -7.4, -16.1, -10.6, -20.0, -14.899999999999999, -20.6, -43.6, -4.2, -16.8, -5.3, -9.799999999999999, -18.7, -10.799999999999999, -5.3, -5.2, -4.3, -4.3999999999999995, -24.700000000000017, -11.600000000000001, -5.300000000000001, -12.2, -10.8, -2.3000000000000003, -14.899999999999997, -3.4, -12.599999999999996, -10.899999999999999, -10.5, -8.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.055155205995563, "mean_inference_ms": 1.3962923123673447, "mean_action_processing_ms": 0.07559432166934621, "mean_env_wait_ms": 6.3558560561775925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1996000, "timesteps_this_iter": 0, "agent_timesteps_total": 1996000, "timers": {"sample_time_ms": 15853.2, "sample_throughput": 252.315, "load_time_ms": 0.353, "load_throughput": 11338255.052, "learn_time_ms": 7747.951, "learn_throughput": 516.266, "update_time_ms": 1.718}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12937120104819455, "policy_loss": -0.016606126222459057, "vf_loss": 14.433007690406615, "vf_explained_var": 0.18884860783494928, "kl": 0.008236260365273243, "entropy": 0.2719894607461268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1996000, "num_agent_steps_sampled": 1996000, "num_steps_trained": 1996000, "num_agent_steps_trained": 1996000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20120, "training_iteration": 499, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-45-01", "timestamp": 1643705101, "time_this_iter_s": 15.794504880905151, "time_total_s": 14133.910140037537, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1874.401262998581, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 26.422727272727276, "ram_util_percent": 65.79999999999998}}
{"episode_reward_max": -1.2, "episode_reward_min": -59.599999999999994, "episode_reward_mean": -12.486999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.199999999999999, -7.4, -3.8000000000000003, -16.599999999999998, -2.8000000000000003, -24.2, -5.2, -12.8, -11.5, -17.099999999999998, -22.900000000000002, -13.199999999999998, -3.3, -4.2, -15.7, -8.3, -12.099999999999996, -4.9, -6.3, -20.4, -15.899999999999984, -8.100000000000001, -21.699999999999996, -3.2, -4.300000000000001, -4.300000000000001, -21.400000000000002, -3.3, -19.700000000000006, -19.9, -18.9, -7.4, -16.1, -10.6, -20.0, -14.899999999999999, -20.6, -43.6, -4.2, -16.8, -5.3, -9.799999999999999, -18.7, -10.799999999999999, -5.3, -5.2, -4.3, -4.3999999999999995, -24.700000000000017, -11.600000000000001, -5.300000000000001, -12.2, -10.8, -2.3000000000000003, -14.899999999999997, -3.4, -12.599999999999996, -10.899999999999999, -10.5, -8.5, -14.999999999999975, -13.5, -8.2, -14.5, -16.5, -19.200000000000003, -8.599999999999998, -8.4, -19.90000000000001, -8.2, -17.700000000000006, -8.3, -3.3, -17.7, -59.599999999999994, -1.2, -15.5, -14.0, -3.3, -3.3, -11.0, -10.800000000000002, -6.7, -4.3, -10.3, -24.5, -3.2, -29.5, -22.5, -6.2, -17.799999999999997, -10.8, -39.499999999999964, -10.799999999999999, -7.499999999999998, -10.799999999999997, -9.9, -5.300000000000001, -18.799999999999997, -7.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0539907338612224, "mean_inference_ms": 1.3947100877207763, "mean_action_processing_ms": 0.07550705031714004, "mean_env_wait_ms": 6.347899063614802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2000000, "timesteps_this_iter": 0, "agent_timesteps_total": 2000000, "timers": {"sample_time_ms": 15877.822, "sample_throughput": 251.924, "load_time_ms": 0.34, "load_throughput": 11758631.904, "learn_time_ms": 7697.865, "learn_throughput": 519.625, "update_time_ms": 1.769}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.205767641128141, "policy_loss": -0.020967820781954034, "vf_loss": 22.48515477436845, "vf_explained_var": 0.08856494702318664, "kl": 0.009419615654586388, "entropy": 0.24957281669141143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2000000, "num_agent_steps_sampled": 2000000, "num_steps_trained": 2000000, "num_agent_steps_trained": 2000000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20160, "training_iteration": 500, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-45-17", "timestamp": 1643705117, "time_this_iter_s": 15.78823184967041, "time_total_s": 14149.698371887207, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1890.1894948482513, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 30.6, "ram_util_percent": 65.82173913043475}}
{"episode_reward_max": -1.2, "episode_reward_min": -59.599999999999994, "episode_reward_mean": -11.139000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -9.799999999999999, -18.7, -10.799999999999999, -5.3, -5.2, -4.3, -4.3999999999999995, -24.700000000000017, -11.600000000000001, -5.300000000000001, -12.2, -10.8, -2.3000000000000003, -14.899999999999997, -3.4, -12.599999999999996, -10.899999999999999, -10.5, -8.5, -14.999999999999975, -13.5, -8.2, -14.5, -16.5, -19.200000000000003, -8.599999999999998, -8.4, -19.90000000000001, -8.2, -17.700000000000006, -8.3, -3.3, -17.7, -59.599999999999994, -1.2, -15.5, -14.0, -3.3, -3.3, -11.0, -10.800000000000002, -6.7, -4.3, -10.3, -24.5, -3.2, -29.5, -22.5, -6.2, -17.799999999999997, -10.8, -39.499999999999964, -10.799999999999999, -7.499999999999998, -10.799999999999997, -9.9, -5.300000000000001, -18.799999999999997, -7.3, -17.6, -8.799999999999997, -13.49999999999999, -7.5, -9.4, -4.3, -5.2, -14.499999999999996, -7.0, -3.3, -7.2, -6.700000000000001, -3.3, -4.300000000000001, -18.700000000000003, -8.3, -19.4, -9.3, -18.9, -8.2, -7.399999999999999, -7.699999999999995, -4.700000000000001, -8.2, -8.3, -10.999999999999998, -14.6, -12.7, -3.3, -16.099999999999994, -3.2, -8.3, -8.3, -9.0, -12.999999999999998, -11.999999999999996, -3.2, -5.9, -16.399999999999995, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.053008650382247, "mean_inference_ms": 1.3931286869270536, "mean_action_processing_ms": 0.07542249065690103, "mean_env_wait_ms": 6.340138732811903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2004000, "timesteps_this_iter": 0, "agent_timesteps_total": 2004000, "timers": {"sample_time_ms": 15825.773, "sample_throughput": 252.752, "load_time_ms": 0.341, "load_throughput": 11716751.17, "learn_time_ms": 7873.198, "learn_throughput": 508.053, "update_time_ms": 1.815}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0476966316566392, "policy_loss": -0.016219596682937557, "vf_loss": 6.2329159508469285, "vf_explained_var": 0.30283320981969114, "kl": 0.007935362705627128, "entropy": 0.22164863134103438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2004000, "num_agent_steps_sampled": 2004000, "num_steps_trained": 2004000, "num_agent_steps_trained": 2004000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20200, "training_iteration": 501, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-45-35", "timestamp": 1643705135, "time_this_iter_s": 17.406291961669922, "time_total_s": 14167.104663848877, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1907.5957868099213, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 36.59166666666667, "ram_util_percent": 65.8875}}
{"episode_reward_max": -3.2, "episode_reward_min": -39.499999999999964, "episode_reward_mean": -10.943000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -10.800000000000002, -6.7, -4.3, -10.3, -24.5, -3.2, -29.5, -22.5, -6.2, -17.799999999999997, -10.8, -39.499999999999964, -10.799999999999999, -7.499999999999998, -10.799999999999997, -9.9, -5.300000000000001, -18.799999999999997, -7.3, -17.6, -8.799999999999997, -13.49999999999999, -7.5, -9.4, -4.3, -5.2, -14.499999999999996, -7.0, -3.3, -7.2, -6.700000000000001, -3.3, -4.300000000000001, -18.700000000000003, -8.3, -19.4, -9.3, -18.9, -8.2, -7.399999999999999, -7.699999999999995, -4.700000000000001, -8.2, -8.3, -10.999999999999998, -14.6, -12.7, -3.3, -16.099999999999994, -3.2, -8.3, -8.3, -9.0, -12.999999999999998, -11.999999999999996, -3.2, -5.9, -16.399999999999995, -10.3, -28.2, -4.2, -13.899999999999999, -7.2, -5.2, -4.300000000000001, -18.8, -4.3, -10.899999999999999, -10.099999999999998, -9.8, -3.2, -9.299999999999999, -15.49999999999999, -31.400000000000002, -21.50000000000007, -7.699999999999999, -3.4, -16.2, -10.200000000000001, -5.2, -17.6, -7.800000000000001, -18.999999999999996, -4.4, -5.2, -5.3, -16.4, -4.6000000000000005, -13.499999999999996, -32.20000000000001, -23.60000000000002, -4.3, -6.4, -14.199999999999998, -9.8, -3.2, -10.6, -4.9, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0520094745701227, "mean_inference_ms": 1.3918271141089187, "mean_action_processing_ms": 0.07535432842340155, "mean_env_wait_ms": 6.333608397109085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2008000, "timesteps_this_iter": 0, "agent_timesteps_total": 2008000, "timers": {"sample_time_ms": 16050.833, "sample_throughput": 249.208, "load_time_ms": 0.339, "load_throughput": 11802473.444, "learn_time_ms": 8227.519, "learn_throughput": 486.173, "update_time_ms": 1.841}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1144158885338574, "policy_loss": -0.011086493629401409, "vf_loss": 12.425074415245364, "vf_explained_var": 0.17771374826790184, "kl": 0.006258216165848971, "entropy": 0.21767801646423596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2008000, "num_agent_steps_sampled": 2008000, "num_steps_trained": 2008000, "num_agent_steps_trained": 2008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20240, "training_iteration": 502, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-45-54", "timestamp": 1643705154, "time_this_iter_s": 19.526131868362427, "time_total_s": 14186.63079571724, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1927.1219186782837, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 43.489285714285714, "ram_util_percent": 66.61071428571428}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -32.20000000000001, "episode_reward_mean": -10.479000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.399999999999999, -7.699999999999995, -4.700000000000001, -8.2, -8.3, -10.999999999999998, -14.6, -12.7, -3.3, -16.099999999999994, -3.2, -8.3, -8.3, -9.0, -12.999999999999998, -11.999999999999996, -3.2, -5.9, -16.399999999999995, -10.3, -28.2, -4.2, -13.899999999999999, -7.2, -5.2, -4.300000000000001, -18.8, -4.3, -10.899999999999999, -10.099999999999998, -9.8, -3.2, -9.299999999999999, -15.49999999999999, -31.400000000000002, -21.50000000000007, -7.699999999999999, -3.4, -16.2, -10.200000000000001, -5.2, -17.6, -7.800000000000001, -18.999999999999996, -4.4, -5.2, -5.3, -16.4, -4.6000000000000005, -13.499999999999996, -32.20000000000001, -23.60000000000002, -4.3, -6.4, -14.199999999999998, -9.8, -3.2, -10.6, -4.9, -4.3, -7.2, -2.3000000000000003, -22.400000000000073, -7.3, -6.3, -4.4, -14.7, -4.800000000000001, -7.3, -4.300000000000001, -14.399999999999999, -3.4, -6.300000000000001, -14.899999999999999, -5.999999999999999, -10.2, -3.2, -23.3, -6.300000000000001, -14.8, -15.799999999999997, -10.399999999999995, -18.5, -5.2, -17.4, -9.0, -9.099999999999998, -13.299999999999999, -10.2, -7.300000000000001, -20.0, -8.3, -14.0, -5.2, -6.300000000000001, -8.899999999999999, -8.3, -15.499999999999996, -12.2, -17.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0545800833538583, "mean_inference_ms": 1.3961424484725233, "mean_action_processing_ms": 0.07553937679152398, "mean_env_wait_ms": 6.356551343906419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2012000, "timesteps_this_iter": 0, "agent_timesteps_total": 2012000, "timers": {"sample_time_ms": 17396.226, "sample_throughput": 229.935, "load_time_ms": 0.408, "load_throughput": 9812958.999, "learn_time_ms": 9173.421, "learn_throughput": 436.042, "update_time_ms": 1.889}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06683624380328242, "policy_loss": -0.010976340056407035, "vf_loss": 7.640648593473178, "vf_explained_var": 0.3171750848652214, "kl": 0.007030497454485669, "entropy": 0.2570555251292003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2012000, "num_agent_steps_sampled": 2012000, "num_steps_trained": 2012000, "num_agent_steps_trained": 2012000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20280, "training_iteration": 503, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-46-30", "timestamp": 1643705190, "time_this_iter_s": 36.05697298049927, "time_total_s": 14222.687768697739, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1963.178891658783, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 62.83653846153845, "ram_util_percent": 55.23846153846154}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -32.20000000000001, "episode_reward_mean": -10.41, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -17.6, -7.800000000000001, -18.999999999999996, -4.4, -5.2, -5.3, -16.4, -4.6000000000000005, -13.499999999999996, -32.20000000000001, -23.60000000000002, -4.3, -6.4, -14.199999999999998, -9.8, -3.2, -10.6, -4.9, -4.3, -7.2, -2.3000000000000003, -22.400000000000073, -7.3, -6.3, -4.4, -14.7, -4.800000000000001, -7.3, -4.300000000000001, -14.399999999999999, -3.4, -6.300000000000001, -14.899999999999999, -5.999999999999999, -10.2, -3.2, -23.3, -6.300000000000001, -14.8, -15.799999999999997, -10.399999999999995, -18.5, -5.2, -17.4, -9.0, -9.099999999999998, -13.299999999999999, -10.2, -7.300000000000001, -20.0, -8.3, -14.0, -5.2, -6.300000000000001, -8.899999999999999, -8.3, -15.499999999999996, -12.2, -17.8, -15.399999999999988, -9.3, -18.0, -5.2, -11.2, -6.2, -6.5, -12.7, -8.399999999999999, -4.2, -10.4, -9.399999999999999, -13.5, -3.7, -3.2, -13.3, -6.300000000000001, -13.1, -9.199999999999998, -6.299999999999999, -12.1, -16.5, -7.9, -3.3, -15.799999999999999, -4.800000000000001, -6.3, -14.1, -4.2, -13.899999999999997, -3.2, -22.9, -10.2, -11.999999999999998, -17.4, -18.9, -5.2, -12.1, -13.999999999999998, -11.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0577244371371093, "mean_inference_ms": 1.401724407621394, "mean_action_processing_ms": 0.07579265175831333, "mean_env_wait_ms": 6.38531806447648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2016000, "timesteps_this_iter": 0, "agent_timesteps_total": 2016000, "timers": {"sample_time_ms": 18555.816, "sample_throughput": 215.566, "load_time_ms": 0.411, "load_throughput": 9731563.805, "learn_time_ms": 9329.908, "learn_throughput": 428.729, "update_time_ms": 1.846}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.05495383571783301, "policy_loss": -0.009611016946534316, "vf_loss": 6.32931344022033, "vf_explained_var": 0.40109080345399917, "kl": 0.006358598289559552, "entropy": 0.23680053171451373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2016000, "num_agent_steps_sampled": 2016000, "num_steps_trained": 2016000, "num_agent_steps_trained": 2016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20320, "training_iteration": 504, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-46-50", "timestamp": 1643705210, "time_this_iter_s": 19.292759895324707, "time_total_s": 14241.980528593063, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1982.4716515541077, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 41.74444444444445, "ram_util_percent": 55.03333333333332}}
{"episode_reward_max": -3.2, "episode_reward_min": -24.2, "episode_reward_mean": -10.760999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999997, -10.399999999999995, -18.5, -5.2, -17.4, -9.0, -9.099999999999998, -13.299999999999999, -10.2, -7.300000000000001, -20.0, -8.3, -14.0, -5.2, -6.300000000000001, -8.899999999999999, -8.3, -15.499999999999996, -12.2, -17.8, -15.399999999999988, -9.3, -18.0, -5.2, -11.2, -6.2, -6.5, -12.7, -8.399999999999999, -4.2, -10.4, -9.399999999999999, -13.5, -3.7, -3.2, -13.3, -6.300000000000001, -13.1, -9.199999999999998, -6.299999999999999, -12.1, -16.5, -7.9, -3.3, -15.799999999999999, -4.800000000000001, -6.3, -14.1, -4.2, -13.899999999999997, -3.2, -22.9, -10.2, -11.999999999999998, -17.4, -18.9, -5.2, -12.1, -13.999999999999998, -11.7, -10.2, -14.100000000000001, -7.1, -3.3, -4.2, -3.3, -4.700000000000001, -13.19999999999997, -13.799999999999997, -17.0, -17.800000000000008, -8.3, -10.0, -7.2, -5.2, -4.300000000000001, -4.300000000000001, -7.199999999999999, -8.7, -19.499999999999996, -21.499999999999993, -9.799999999999999, -5.2, -10.7, -17.2, -6.300000000000001, -10.2, -3.2, -10.0, -3.3, -13.099999999999994, -11.8, -17.599999999999998, -24.2, -3.3, -14.9, -6.300000000000001, -19.1, -19.2, -21.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0591787440755493, "mean_inference_ms": 1.4045607570790777, "mean_action_processing_ms": 0.07592917237630395, "mean_env_wait_ms": 6.399423668046709, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2020000, "timesteps_this_iter": 0, "agent_timesteps_total": 2020000, "timers": {"sample_time_ms": 18793.365, "sample_throughput": 212.841, "load_time_ms": 0.417, "load_throughput": 9600146.487, "learn_time_ms": 9830.37, "learn_throughput": 406.902, "update_time_ms": 1.907}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06849922031534696, "policy_loss": -0.014511460740800185, "vf_loss": 8.148067414183771, "vf_explained_var": 0.3065084118355987, "kl": 0.007650028611370543, "entropy": 0.20015616615613302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2020000, "num_agent_steps_sampled": 2020000, "num_steps_trained": 2020000, "num_agent_steps_trained": 2020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20360, "training_iteration": 505, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-47-11", "timestamp": 1643705231, "time_this_iter_s": 21.534815073013306, "time_total_s": 14263.515343666077, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2004.006466627121, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 32.79354838709677, "ram_util_percent": 55.10322580645161}}
{"episode_reward_max": -3.2, "episode_reward_min": -68.3, "episode_reward_mean": -11.638999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.1, -16.5, -7.9, -3.3, -15.799999999999999, -4.800000000000001, -6.3, -14.1, -4.2, -13.899999999999997, -3.2, -22.9, -10.2, -11.999999999999998, -17.4, -18.9, -5.2, -12.1, -13.999999999999998, -11.7, -10.2, -14.100000000000001, -7.1, -3.3, -4.2, -3.3, -4.700000000000001, -13.19999999999997, -13.799999999999997, -17.0, -17.800000000000008, -8.3, -10.0, -7.2, -5.2, -4.300000000000001, -4.300000000000001, -7.199999999999999, -8.7, -19.499999999999996, -21.499999999999993, -9.799999999999999, -5.2, -10.7, -17.2, -6.300000000000001, -10.2, -3.2, -10.0, -3.3, -13.099999999999994, -11.8, -17.599999999999998, -24.2, -3.3, -14.9, -6.300000000000001, -19.1, -19.2, -21.1, -7.3, -15.699999999999998, -3.3, -4.300000000000001, -5.300000000000001, -10.6, -19.5, -21.5, -18.500000000000004, -3.3, -5.300000000000001, -16.799999999999997, -3.2, -5.300000000000001, -14.0, -12.899999999999999, -7.2, -13.199999999999996, -17.599999999999998, -12.3, -9.799999999999999, -14.499999999999996, -10.5, -16.199999999999996, -9.1, -68.3, -7.7, -3.4, -8.5, -12.3, -11.9, -19.0, -3.5000000000000004, -29.800000000000047, -7.199999999999998, -10.999999999999998, -21.499999999999996, -4.1000000000000005, -11.3, -9.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0587016989544755, "mean_inference_ms": 1.4043311696524803, "mean_action_processing_ms": 0.07591654723303677, "mean_env_wait_ms": 6.3977104069387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2024000, "timesteps_this_iter": 0, "agent_timesteps_total": 2024000, "timers": {"sample_time_ms": 19359.962, "sample_throughput": 206.612, "load_time_ms": 0.417, "load_throughput": 9598498.77, "learn_time_ms": 10229.473, "learn_throughput": 391.027, "update_time_ms": 2.044}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2531796915516738, "policy_loss": -0.008018976395889636, "vf_loss": 26.00999292865876, "vf_explained_var": 0.232561634625158, "kl": 0.005493759334258288, "entropy": 0.23192392700622158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2024000, "num_agent_steps_sampled": 2024000, "num_steps_trained": 2024000, "num_agent_steps_trained": 2024000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20400, "training_iteration": 506, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-47-32", "timestamp": 1643705252, "time_this_iter_s": 20.601617097854614, "time_total_s": 14284.116960763931, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2024.6080837249756, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 40.71379310344827, "ram_util_percent": 55.50689655172415}}
{"episode_reward_max": -3.2, "episode_reward_min": -68.3, "episode_reward_mean": -12.672000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.499999999999993, -9.799999999999999, -5.2, -10.7, -17.2, -6.300000000000001, -10.2, -3.2, -10.0, -3.3, -13.099999999999994, -11.8, -17.599999999999998, -24.2, -3.3, -14.9, -6.300000000000001, -19.1, -19.2, -21.1, -7.3, -15.699999999999998, -3.3, -4.300000000000001, -5.300000000000001, -10.6, -19.5, -21.5, -18.500000000000004, -3.3, -5.300000000000001, -16.799999999999997, -3.2, -5.300000000000001, -14.0, -12.899999999999999, -7.2, -13.199999999999996, -17.599999999999998, -12.3, -9.799999999999999, -14.499999999999996, -10.5, -16.199999999999996, -9.1, -68.3, -7.7, -3.4, -8.5, -12.3, -11.9, -19.0, -3.5000000000000004, -29.800000000000047, -7.199999999999998, -10.999999999999998, -21.499999999999996, -4.1000000000000005, -11.3, -9.3, -13.4, -36.40000000000007, -33.30000000000002, -6.4, -11.899999999999999, -10.5, -27.800000000000043, -35.4, -4.800000000000001, -16.299999999999997, -4.2, -15.3, -4.3, -16.799999999999997, -8.3, -4.300000000000001, -4.300000000000001, -10.5, -16.4, -5.2, -13.299999999999997, -15.7, -15.899999999999997, -4.2, -23.700000000000003, -20.5, -27.80000000000006, -10.3, -20.9, -3.3, -8.7, -9.1, -5.6, -3.2, -7.2, -4.2, -7.2, -4.300000000000001, -12.899999999999999, -9.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0615372456288812, "mean_inference_ms": 1.4085775611306093, "mean_action_processing_ms": 0.07614788047320088, "mean_env_wait_ms": 6.418285320651919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2028000, "timesteps_this_iter": 0, "agent_timesteps_total": 2028000, "timers": {"sample_time_ms": 20791.568, "sample_throughput": 192.386, "load_time_ms": 0.438, "load_throughput": 9133440.035, "learn_time_ms": 10419.863, "learn_throughput": 383.882, "update_time_ms": 2.065}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15245189329869643, "policy_loss": -0.02473418351403007, "vf_loss": 17.511631894367998, "vf_explained_var": 0.12206730009407125, "kl": 0.010348808073836183, "entropy": 0.2358958135529231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2028000, "num_agent_steps_sampled": 2028000, "num_steps_trained": 2028000, "num_agent_steps_trained": 2028000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20440, "training_iteration": 507, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-48-00", "timestamp": 1643705280, "time_this_iter_s": 28.03514814376831, "time_total_s": 14312.1521089077, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2052.643231868744, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 57.3725, "ram_util_percent": 56.46500000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -68.3, "episode_reward_mean": -12.964000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999999, -14.499999999999996, -10.5, -16.199999999999996, -9.1, -68.3, -7.7, -3.4, -8.5, -12.3, -11.9, -19.0, -3.5000000000000004, -29.800000000000047, -7.199999999999998, -10.999999999999998, -21.499999999999996, -4.1000000000000005, -11.3, -9.3, -13.4, -36.40000000000007, -33.30000000000002, -6.4, -11.899999999999999, -10.5, -27.800000000000043, -35.4, -4.800000000000001, -16.299999999999997, -4.2, -15.3, -4.3, -16.799999999999997, -8.3, -4.300000000000001, -4.300000000000001, -10.5, -16.4, -5.2, -13.299999999999997, -15.7, -15.899999999999997, -4.2, -23.700000000000003, -20.5, -27.80000000000006, -10.3, -20.9, -3.3, -8.7, -9.1, -5.6, -3.2, -7.2, -4.2, -7.2, -4.300000000000001, -12.899999999999999, -9.399999999999999, -3.3, -18.099999999999998, -6.099999999999999, -7.3, -27.90000000000004, -18.3, -3.3, -14.899999999999999, -12.399999999999997, -4.2, -16.7, -4.3, -9.399999999999999, -15.9, -8.700000000000001, -15.399999999999999, -7.699999999999998, -3.4, -9.2, -4.2, -17.3, -12.799999999999997, -24.7, -12.399999999999999, -16.099999999999998, -8.7, -4.300000000000001, -15.199999999999992, -3.3, -14.499999999999991, -9.1, -8.8, -16.099999999999998, -13.3, -23.5, -8.599999999999998, -12.3, -10.3, -7.499999999999998, -44.80000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0640712347866228, "mean_inference_ms": 1.4126042766325038, "mean_action_processing_ms": 0.0763659450685172, "mean_env_wait_ms": 6.4378837601923395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2032000, "timesteps_this_iter": 0, "agent_timesteps_total": 2032000, "timers": {"sample_time_ms": 21008.367, "sample_throughput": 190.4, "load_time_ms": 0.421, "load_throughput": 9499584.395, "learn_time_ms": 10692.098, "learn_throughput": 374.108, "update_time_ms": 2.15}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1318657818200287, "policy_loss": -0.0015485429660647466, "vf_loss": 13.182669404886102, "vf_explained_var": 0.3214777420284928, "kl": 0.007938166427581626, "entropy": 0.23848442303878004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2032000, "num_agent_steps_sampled": 2032000, "num_steps_trained": 2032000, "num_agent_steps_trained": 2032000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20480, "training_iteration": 508, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-48-18", "timestamp": 1643705298, "time_this_iter_s": 18.36651611328125, "time_total_s": 14330.51862502098, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2071.009747982025, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 22.444444444444443, "ram_util_percent": 56.411111111111126}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.80000000000008, "episode_reward_mean": -11.169, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.299999999999997, -15.7, -15.899999999999997, -4.2, -23.700000000000003, -20.5, -27.80000000000006, -10.3, -20.9, -3.3, -8.7, -9.1, -5.6, -3.2, -7.2, -4.2, -7.2, -4.300000000000001, -12.899999999999999, -9.399999999999999, -3.3, -18.099999999999998, -6.099999999999999, -7.3, -27.90000000000004, -18.3, -3.3, -14.899999999999999, -12.399999999999997, -4.2, -16.7, -4.3, -9.399999999999999, -15.9, -8.700000000000001, -15.399999999999999, -7.699999999999998, -3.4, -9.2, -4.2, -17.3, -12.799999999999997, -24.7, -12.399999999999999, -16.099999999999998, -8.7, -4.300000000000001, -15.199999999999992, -3.3, -14.499999999999991, -9.1, -8.8, -16.099999999999998, -13.3, -23.5, -8.599999999999998, -12.3, -10.3, -7.499999999999998, -44.80000000000008, -10.3, -9.9, -24.400000000000006, -10.700000000000001, -4.300000000000001, -11.599999999999993, -9.0, -5.6, -15.2, -6.1, -11.699999999999998, -6.8999999999999995, -3.3, -11.399999999999999, -3.2, -4.4, -3.3, -4.2, -4.2, -10.5, -3.3, -22.3, -40.1, -13.5, -3.3, -4.2, -13.59999999999998, -5.0, -12.9, -13.8, -8.700000000000001, -9.799999999999999, -3.3, -15.899999999999999, -5.3, -3.2, -11.999999999999996, -12.599999999999998, -14.999999999999998, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0646849203989144, "mean_inference_ms": 1.4140940198117966, "mean_action_processing_ms": 0.07644679653829449, "mean_env_wait_ms": 6.445215559939644, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2036000, "timesteps_this_iter": 0, "agent_timesteps_total": 2036000, "timers": {"sample_time_ms": 21358.89, "sample_throughput": 187.276, "load_time_ms": 0.42, "load_throughput": 9527095.968, "learn_time_ms": 10719.104, "learn_throughput": 373.166, "update_time_ms": 2.301}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0785569696782297, "policy_loss": -0.020861383713781833, "vf_loss": 9.797272192150034, "vf_explained_var": 0.1578299412163355, "kl": 0.0072281516030051245, "entropy": 0.23144095869314285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2036000, "num_agent_steps_sampled": 2036000, "num_steps_trained": 2036000, "num_agent_steps_trained": 2036000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20520, "training_iteration": 509, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-48-35", "timestamp": 1643705315, "time_this_iter_s": 16.826401948928833, "time_total_s": 14347.34502696991, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2087.836149930954, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 24.837499999999995, "ram_util_percent": 56.31666666666666}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.80000000000008, "episode_reward_mean": -11.178000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.3, -12.799999999999997, -24.7, -12.399999999999999, -16.099999999999998, -8.7, -4.300000000000001, -15.199999999999992, -3.3, -14.499999999999991, -9.1, -8.8, -16.099999999999998, -13.3, -23.5, -8.599999999999998, -12.3, -10.3, -7.499999999999998, -44.80000000000008, -10.3, -9.9, -24.400000000000006, -10.700000000000001, -4.300000000000001, -11.599999999999993, -9.0, -5.6, -15.2, -6.1, -11.699999999999998, -6.8999999999999995, -3.3, -11.399999999999999, -3.2, -4.4, -3.3, -4.2, -4.2, -10.5, -3.3, -22.3, -40.1, -13.5, -3.3, -4.2, -13.59999999999998, -5.0, -12.9, -13.8, -8.700000000000001, -9.799999999999999, -3.3, -15.899999999999999, -5.3, -3.2, -11.999999999999996, -12.599999999999998, -14.999999999999998, -7.2, -4.2, -11.0, -4.300000000000001, -7.300000000000001, -4.300000000000001, -14.599999999999998, -3.2, -5.4, -5.300000000000001, -27.0, -6.3, -3.2, -4.2, -18.2, -9.2, -27.800000000000004, -18.200000000000003, -4.4, -3.3000000000000003, -28.40000000000001, -13.999999999999973, -15.099999999999998, -4.3, -12.3, -17.900000000000016, -10.7, -7.800000000000001, -10.099999999999996, -4.4, -20.099999999999998, -31.3, -3.3, -7.4, -4.4, -9.899999999999999, -15.299999999999995, -7.699999999999999, -11.2, -13.299999999999997, -8.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0645801162573938, "mean_inference_ms": 1.4148733844390424, "mean_action_processing_ms": 0.07647902156690392, "mean_env_wait_ms": 6.448315011307482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2040000, "timesteps_this_iter": 0, "agent_timesteps_total": 2040000, "timers": {"sample_time_ms": 21724.982, "sample_throughput": 184.12, "load_time_ms": 0.422, "load_throughput": 9468489.192, "learn_time_ms": 10728.2, "learn_throughput": 372.849, "update_time_ms": 2.274}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09315650635148569, "policy_loss": -0.01708258382515401, "vf_loss": 10.87274454511622, "vf_explained_var": 0.2011855976555937, "kl": 0.007558236270945432, "entropy": 0.21942420567395868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2040000, "num_agent_steps_sampled": 2040000, "num_steps_trained": 2040000, "num_agent_steps_trained": 2040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20560, "training_iteration": 510, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-48-55", "timestamp": 1643705335, "time_this_iter_s": 19.23412823677063, "time_total_s": 14366.57915520668, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2107.0702781677246, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 25.944444444444443, "ram_util_percent": 56.400000000000006}}
{"episode_reward_max": -3.2, "episode_reward_min": -54.7, "episode_reward_mean": -10.959000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -22.3, -40.1, -13.5, -3.3, -4.2, -13.59999999999998, -5.0, -12.9, -13.8, -8.700000000000001, -9.799999999999999, -3.3, -15.899999999999999, -5.3, -3.2, -11.999999999999996, -12.599999999999998, -14.999999999999998, -7.2, -4.2, -11.0, -4.300000000000001, -7.300000000000001, -4.300000000000001, -14.599999999999998, -3.2, -5.4, -5.300000000000001, -27.0, -6.3, -3.2, -4.2, -18.2, -9.2, -27.800000000000004, -18.200000000000003, -4.4, -3.3000000000000003, -28.40000000000001, -13.999999999999973, -15.099999999999998, -4.3, -12.3, -17.900000000000016, -10.7, -7.800000000000001, -10.099999999999996, -4.4, -20.099999999999998, -31.3, -3.3, -7.4, -4.4, -9.899999999999999, -15.299999999999995, -7.699999999999999, -11.2, -13.299999999999997, -8.7, -6.999999999999999, -3.3, -17.8, -9.2, -22.200000000000003, -19.1, -15.2, -54.7, -8.2, -6.2, -3.2, -4.300000000000001, -10.899999999999999, -10.899999999999999, -3.2, -29.799999999999997, -21.400000000000002, -7.999999999999998, -19.6, -11.7, -6.999999999999999, -3.4, -11.299999999999985, -20.3, -4.2, -4.2, -7.9, -5.7, -4.9, -3.3, -22.4, -3.4, -7.8999999999999995, -4.2, -4.4, -6.300000000000001, -8.7, -4.3, -8.899999999999995, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0642411538195304, "mean_inference_ms": 1.4152086291933597, "mean_action_processing_ms": 0.0764912640565695, "mean_env_wait_ms": 6.449622382259704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2044000, "timesteps_this_iter": 0, "agent_timesteps_total": 2044000, "timers": {"sample_time_ms": 21708.089, "sample_throughput": 184.263, "load_time_ms": 0.422, "load_throughput": 9473300.96, "learn_time_ms": 10848.963, "learn_throughput": 368.699, "update_time_ms": 2.204}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.18750248097524208, "policy_loss": -0.018063366517264357, "vf_loss": 20.401578457733635, "vf_explained_var": 0.1091488871523129, "kl": 0.007750330951221988, "entropy": 0.2275693118572235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2044000, "num_agent_steps_sampled": 2044000, "num_steps_trained": 2044000, "num_agent_steps_trained": 2044000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20600, "training_iteration": 511, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-49-13", "timestamp": 1643705353, "time_this_iter_s": 18.349351167678833, "time_total_s": 14384.92850637436, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2125.4196293354034, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 23.476923076923075, "ram_util_percent": 56.35384615384616}}
{"episode_reward_max": -2.2, "episode_reward_min": -54.7, "episode_reward_mean": -11.01, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.999999999999973, -15.099999999999998, -4.3, -12.3, -17.900000000000016, -10.7, -7.800000000000001, -10.099999999999996, -4.4, -20.099999999999998, -31.3, -3.3, -7.4, -4.4, -9.899999999999999, -15.299999999999995, -7.699999999999999, -11.2, -13.299999999999997, -8.7, -6.999999999999999, -3.3, -17.8, -9.2, -22.200000000000003, -19.1, -15.2, -54.7, -8.2, -6.2, -3.2, -4.300000000000001, -10.899999999999999, -10.899999999999999, -3.2, -29.799999999999997, -21.400000000000002, -7.999999999999998, -19.6, -11.7, -6.999999999999999, -3.4, -11.299999999999985, -20.3, -4.2, -4.2, -7.9, -5.7, -4.9, -3.3, -22.4, -3.4, -7.8999999999999995, -4.2, -4.4, -6.300000000000001, -8.7, -4.3, -8.899999999999995, -3.3, -9.2, -22.20000000000007, -12.8, -2.2, -3.4, -21.600000000000062, -6.900000000000001, -4.4, -9.799999999999999, -10.2, -19.0, -10.9, -10.0, -3.4, -8.599999999999998, -9.299999999999997, -4.3, -14.0, -17.7, -3.2, -20.6, -23.0, -11.799999999999997, -10.1, -26.2, -13.3, -4.4, -5.300000000000001, -5.2, -14.3, -9.5, -5.3, -12.499999999999998, -9.600000000000001, -20.2, -4.4, -4.300000000000001, -8.6, -4.4, -23.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.063417506770133, "mean_inference_ms": 1.4143036658115204, "mean_action_processing_ms": 0.07644082384397045, "mean_env_wait_ms": 6.444938029299387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2048000, "timesteps_this_iter": 0, "agent_timesteps_total": 2048000, "timers": {"sample_time_ms": 21772.038, "sample_throughput": 183.722, "load_time_ms": 0.438, "load_throughput": 9136424.332, "learn_time_ms": 10758.773, "learn_throughput": 371.79, "update_time_ms": 2.261}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08355614982910894, "policy_loss": -0.01660302563580454, "vf_loss": 9.820845178618868, "vf_explained_var": 0.2287800153737427, "kl": 0.00975362891937132, "entropy": 0.2000119644747947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2048000, "num_agent_steps_sampled": 2048000, "num_steps_trained": 2048000, "num_agent_steps_trained": 2048000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20640, "training_iteration": 512, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-49-31", "timestamp": 1643705371, "time_this_iter_s": 18.080311059951782, "time_total_s": 14403.008817434311, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2143.499940395355, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 20.965384615384615, "ram_util_percent": 56.465384615384615}}
{"episode_reward_max": -2.2, "episode_reward_min": -93.0, "episode_reward_mean": -11.173000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999999, -3.4, -11.299999999999985, -20.3, -4.2, -4.2, -7.9, -5.7, -4.9, -3.3, -22.4, -3.4, -7.8999999999999995, -4.2, -4.4, -6.300000000000001, -8.7, -4.3, -8.899999999999995, -3.3, -9.2, -22.20000000000007, -12.8, -2.2, -3.4, -21.600000000000062, -6.900000000000001, -4.4, -9.799999999999999, -10.2, -19.0, -10.9, -10.0, -3.4, -8.599999999999998, -9.299999999999997, -4.3, -14.0, -17.7, -3.2, -20.6, -23.0, -11.799999999999997, -10.1, -26.2, -13.3, -4.4, -5.300000000000001, -5.2, -14.3, -9.5, -5.3, -12.499999999999998, -9.600000000000001, -20.2, -4.4, -4.300000000000001, -8.6, -4.4, -23.799999999999997, -10.3, -14.8, -16.9, -16.699999999999985, -9.0, -4.2, -16.699999999999992, -5.1000000000000005, -16.099999999999994, -13.699999999999998, -10.099999999999998, -13.399999999999997, -6.1, -14.5, -3.4, -4.4, -20.4, -9.600000000000001, -16.9, -6.8, -16.199999999999996, -8.2, -4.300000000000001, -4.300000000000001, -5.2, -16.6, -7.4, -24.199999999999967, -93.0, -8.3, -14.7, -10.799999999999999, -4.2, -7.1, -6.300000000000001, -7.300000000000001, -4.2, -23.500000000000004, -18.700000000000003, -17.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0620865604086895, "mean_inference_ms": 1.412607256627978, "mean_action_processing_ms": 0.07634741998464832, "mean_env_wait_ms": 6.436660893270296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2052000, "timesteps_this_iter": 0, "agent_timesteps_total": 2052000, "timers": {"sample_time_ms": 20618.374, "sample_throughput": 194.002, "load_time_ms": 0.373, "load_throughput": 10721635.992, "learn_time_ms": 9924.366, "learn_throughput": 403.048, "update_time_ms": 2.254}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4193003555269091, "policy_loss": -0.01215561335125277, "vf_loss": 43.05588678057476, "vf_explained_var": 0.2948659385404279, "kl": 0.004485535685977, "entropy": 0.2343236122080075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2052000, "num_agent_steps_sampled": 2052000, "num_steps_trained": 2052000, "num_agent_steps_trained": 2052000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20680, "training_iteration": 513, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-49-48", "timestamp": 1643705388, "time_this_iter_s": 17.071965217590332, "time_total_s": 14420.080782651901, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2160.5719056129456, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 23.087499999999995, "ram_util_percent": 56.5}}
{"episode_reward_max": -1.4000000000000001, "episode_reward_min": -93.0, "episode_reward_mean": -11.635, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.6, -23.0, -11.799999999999997, -10.1, -26.2, -13.3, -4.4, -5.300000000000001, -5.2, -14.3, -9.5, -5.3, -12.499999999999998, -9.600000000000001, -20.2, -4.4, -4.300000000000001, -8.6, -4.4, -23.799999999999997, -10.3, -14.8, -16.9, -16.699999999999985, -9.0, -4.2, -16.699999999999992, -5.1000000000000005, -16.099999999999994, -13.699999999999998, -10.099999999999998, -13.399999999999997, -6.1, -14.5, -3.4, -4.4, -20.4, -9.600000000000001, -16.9, -6.8, -16.199999999999996, -8.2, -4.300000000000001, -4.300000000000001, -5.2, -16.6, -7.4, -24.199999999999967, -93.0, -8.3, -14.7, -10.799999999999999, -4.2, -7.1, -6.300000000000001, -7.300000000000001, -4.2, -23.500000000000004, -18.700000000000003, -17.799999999999997, -6.4, -5.4, -4.300000000000001, -25.200000000000003, -10.3, -7.3, -4.300000000000001, -11.799999999999988, -4.2, -9.9, -13.2, -7.699999999999999, -1.4000000000000001, -4.5, -9.299999999999999, -11.399999999999999, -9.799999999999997, -9.3, -7.2, -17.3, -15.2, -5.3, -4.2, -9.6, -20.70000000000006, -7.199999999999999, -6.199999999999999, -14.4, -10.399999999999999, -6.0, -12.099999999999998, -25.50000000000003, -8.5, -4.3, -6.300000000000001, -5.2, -25.1, -5.9, -15.899999999999999, -7.1000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0618391534628586, "mean_inference_ms": 1.4124293954436422, "mean_action_processing_ms": 0.07633452628988943, "mean_env_wait_ms": 6.435408693156201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2056000, "timesteps_this_iter": 0, "agent_timesteps_total": 2056000, "timers": {"sample_time_ms": 19796.203, "sample_throughput": 202.059, "load_time_ms": 0.368, "load_throughput": 10863961.665, "learn_time_ms": 9845.644, "learn_throughput": 406.271, "update_time_ms": 2.32}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.07241796457849603, "policy_loss": -0.026290035124627815, "vf_loss": 9.71702927991908, "vf_explained_var": 0.246990773113825, "kl": 0.015377111173839475, "entropy": 0.24515393951567271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2056000, "num_agent_steps_sampled": 2056000, "num_steps_trained": 2056000, "num_agent_steps_trained": 2056000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20720, "training_iteration": 514, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-50-07", "timestamp": 1643705407, "time_this_iter_s": 18.643455982208252, "time_total_s": 14438.72423863411, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2179.215361595154, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 35.86666666666667, "ram_util_percent": 56.411111111111126}}
{"episode_reward_max": -1.4000000000000001, "episode_reward_min": -93.0, "episode_reward_mean": -11.676999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.199999999999996, -8.2, -4.300000000000001, -4.300000000000001, -5.2, -16.6, -7.4, -24.199999999999967, -93.0, -8.3, -14.7, -10.799999999999999, -4.2, -7.1, -6.300000000000001, -7.300000000000001, -4.2, -23.500000000000004, -18.700000000000003, -17.799999999999997, -6.4, -5.4, -4.300000000000001, -25.200000000000003, -10.3, -7.3, -4.300000000000001, -11.799999999999988, -4.2, -9.9, -13.2, -7.699999999999999, -1.4000000000000001, -4.5, -9.299999999999999, -11.399999999999999, -9.799999999999997, -9.3, -7.2, -17.3, -15.2, -5.3, -4.2, -9.6, -20.70000000000006, -7.199999999999999, -6.199999999999999, -14.4, -10.399999999999999, -6.0, -12.099999999999998, -25.50000000000003, -8.5, -4.3, -6.300000000000001, -5.2, -25.1, -5.9, -15.899999999999999, -7.1000000000000005, -3.3, -5.300000000000001, -18.0, -12.799999999999999, -10.3, -3.3, -10.2, -8.8, -3.2, -4.4, -18.200000000000003, -18.599999999999998, -4.2, -8.2, -18.9, -3.2, -17.799999999999997, -3.8000000000000003, -6.199999999999999, -3.4, -51.90000000000003, -18.200000000000003, -14.700000000000001, -26.0, -6.2, -5.2, -5.300000000000001, -4.6000000000000005, -7.4, -9.2, -16.9, -6.4, -13.4, -19.500000000000004, -4.1000000000000005, -24.9, -21.3, -6.0, -15.5, -11.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0620828892439185, "mean_inference_ms": 1.413343500755617, "mean_action_processing_ms": 0.0763786592651387, "mean_env_wait_ms": 6.4393995904989625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2060000, "timesteps_this_iter": 0, "agent_timesteps_total": 2060000, "timers": {"sample_time_ms": 19874.805, "sample_throughput": 201.26, "load_time_ms": 0.366, "load_throughput": 10935481.684, "learn_time_ms": 9290.794, "learn_throughput": 430.534, "update_time_ms": 2.262}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.13320200785704117, "policy_loss": -0.017857288901183394, "vf_loss": 14.971016193333492, "vf_explained_var": 0.09822732498568873, "kl": 0.013491364756777606, "entropy": 0.2204362755901711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2060000, "num_agent_steps_sampled": 2060000, "num_steps_trained": 2060000, "num_agent_steps_trained": 2060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20760, "training_iteration": 515, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-50-24", "timestamp": 1643705424, "time_this_iter_s": 17.521104097366333, "time_total_s": 14456.245342731476, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2196.73646569252, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 38.455999999999996, "ram_util_percent": 56.348}}
{"episode_reward_max": -3.2, "episode_reward_min": -51.90000000000003, "episode_reward_mean": -10.924000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.2, -5.3, -4.2, -9.6, -20.70000000000006, -7.199999999999999, -6.199999999999999, -14.4, -10.399999999999999, -6.0, -12.099999999999998, -25.50000000000003, -8.5, -4.3, -6.300000000000001, -5.2, -25.1, -5.9, -15.899999999999999, -7.1000000000000005, -3.3, -5.300000000000001, -18.0, -12.799999999999999, -10.3, -3.3, -10.2, -8.8, -3.2, -4.4, -18.200000000000003, -18.599999999999998, -4.2, -8.2, -18.9, -3.2, -17.799999999999997, -3.8000000000000003, -6.199999999999999, -3.4, -51.90000000000003, -18.200000000000003, -14.700000000000001, -26.0, -6.2, -5.2, -5.300000000000001, -4.6000000000000005, -7.4, -9.2, -16.9, -6.4, -13.4, -19.500000000000004, -4.1000000000000005, -24.9, -21.3, -6.0, -15.5, -11.3, -26.2, -4.2, -13.799999999999999, -21.900000000000006, -4.300000000000001, -5.4, -19.799999999999997, -18.9, -15.799999999999999, -3.3, -4.2, -10.600000000000001, -3.3, -5.300000000000001, -4.4, -25.799999999999997, -14.499999999999995, -15.6, -3.3, -9.3, -11.3, -15.899999999999999, -3.3, -4.300000000000001, -9.0, -4.300000000000001, -5.2, -17.3, -19.3, -10.4, -21.5, -3.3, -4.300000000000001, -10.999999999999996, -4.2, -6.300000000000001, -6.2, -5.300000000000001, -11.6, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0620505545234311, "mean_inference_ms": 1.413523590368651, "mean_action_processing_ms": 0.07638492200994981, "mean_env_wait_ms": 6.439956144322991, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2064000, "timesteps_this_iter": 0, "agent_timesteps_total": 2064000, "timers": {"sample_time_ms": 19263.958, "sample_throughput": 207.642, "load_time_ms": 0.364, "load_throughput": 10994964.283, "learn_time_ms": 9090.344, "learn_throughput": 440.027, "update_time_ms": 2.195}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.05428059984759618, "policy_loss": -0.01657279346098182, "vf_loss": 7.011267150553965, "vf_explained_var": 0.4715013269455202, "kl": 0.007407228389613345, "entropy": 0.18753003588206665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2064000, "num_agent_steps_sampled": 2064000, "num_steps_trained": 2064000, "num_agent_steps_trained": 2064000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20800, "training_iteration": 516, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-50-43", "timestamp": 1643705443, "time_this_iter_s": 18.04811429977417, "time_total_s": 14474.29345703125, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2214.7845799922943, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 31.234615384615385, "ram_util_percent": 56.400000000000006}}
{"episode_reward_max": -3.2, "episode_reward_min": -51.90000000000003, "episode_reward_mean": -11.159999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.90000000000003, -18.200000000000003, -14.700000000000001, -26.0, -6.2, -5.2, -5.300000000000001, -4.6000000000000005, -7.4, -9.2, -16.9, -6.4, -13.4, -19.500000000000004, -4.1000000000000005, -24.9, -21.3, -6.0, -15.5, -11.3, -26.2, -4.2, -13.799999999999999, -21.900000000000006, -4.300000000000001, -5.4, -19.799999999999997, -18.9, -15.799999999999999, -3.3, -4.2, -10.600000000000001, -3.3, -5.300000000000001, -4.4, -25.799999999999997, -14.499999999999995, -15.6, -3.3, -9.3, -11.3, -15.899999999999999, -3.3, -4.300000000000001, -9.0, -4.300000000000001, -5.2, -17.3, -19.3, -10.4, -21.5, -3.3, -4.300000000000001, -10.999999999999996, -4.2, -6.300000000000001, -6.2, -5.300000000000001, -11.6, -3.3, -9.0, -4.4, -6.2, -16.599999999999998, -8.5, -15.999999999999993, -3.3, -18.4, -4.3, -20.000000000000007, -9.7, -15.599999999999998, -3.3, -5.699999999999999, -11.299999999999999, -7.300000000000001, -24.900000000000002, -10.599999999999998, -3.2, -4.300000000000001, -8.2, -14.5, -12.7, -11.8, -4.2, -4.300000000000001, -7.300000000000001, -6.000000000000001, -17.4, -3.3, -10.100000000000001, -16.3, -10.7, -10.099999999999996, -4.4, -19.5, -22.300000000000004, -4.3, -25.6, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0618840933299714, "mean_inference_ms": 1.4131038837804182, "mean_action_processing_ms": 0.07635975823004924, "mean_env_wait_ms": 6.437971849158649, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2068000, "timesteps_this_iter": 0, "agent_timesteps_total": 2068000, "timers": {"sample_time_ms": 18182.103, "sample_throughput": 219.997, "load_time_ms": 0.336, "load_throughput": 11916482.705, "learn_time_ms": 9022.543, "learn_throughput": 443.334, "update_time_ms": 2.237}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.06615098819176676, "policy_loss": -0.019057784469858292, "vf_loss": 8.425764175945071, "vf_explained_var": 0.2965305652669681, "kl": 0.009511336219016798, "entropy": 0.21536623284380924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2068000, "num_agent_steps_sampled": 2068000, "num_steps_trained": 2068000, "num_agent_steps_trained": 2068000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20840, "training_iteration": 517, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-51-01", "timestamp": 1643705461, "time_this_iter_s": 18.558309078216553, "time_total_s": 14492.851766109467, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2233.342889070511, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 38.20384615384615, "ram_util_percent": 56.47692307692308}}
{"episode_reward_max": -3.2, "episode_reward_min": -28.7, "episode_reward_mean": -10.573999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -15.899999999999999, -3.3, -4.300000000000001, -9.0, -4.300000000000001, -5.2, -17.3, -19.3, -10.4, -21.5, -3.3, -4.300000000000001, -10.999999999999996, -4.2, -6.300000000000001, -6.2, -5.300000000000001, -11.6, -3.3, -9.0, -4.4, -6.2, -16.599999999999998, -8.5, -15.999999999999993, -3.3, -18.4, -4.3, -20.000000000000007, -9.7, -15.599999999999998, -3.3, -5.699999999999999, -11.299999999999999, -7.300000000000001, -24.900000000000002, -10.599999999999998, -3.2, -4.300000000000001, -8.2, -14.5, -12.7, -11.8, -4.2, -4.300000000000001, -7.300000000000001, -6.000000000000001, -17.4, -3.3, -10.100000000000001, -16.3, -10.7, -10.099999999999996, -4.4, -19.5, -22.300000000000004, -4.3, -25.6, -5.2, -21.900000000000006, -12.3, -5.300000000000001, -6.2, -12.0, -5.300000000000001, -7.300000000000001, -21.1, -14.799999999999999, -7.2, -8.8, -18.2, -3.3, -20.10000000000004, -14.399999999999993, -15.799999999999999, -21.5, -8.299999999999999, -4.2, -7.899999999999999, -14.899999999999999, -4.300000000000001, -6.2, -18.099999999999998, -3.2, -21.099999999999998, -17.5, -4.2, -10.999999999999998, -12.3, -11.2, -16.5, -8.3, -28.7, -15.599999999999998, -8.399999999999999, -7.300000000000001, -4.300000000000001, -4.300000000000001, -6.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0618217446393488, "mean_inference_ms": 1.412863975432669, "mean_action_processing_ms": 0.07634190061965958, "mean_env_wait_ms": 6.436372509903154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2072000, "timesteps_this_iter": 0, "agent_timesteps_total": 2072000, "timers": {"sample_time_ms": 18226.336, "sample_throughput": 219.463, "load_time_ms": 0.343, "load_throughput": 11666237.397, "learn_time_ms": 8754.265, "learn_throughput": 456.92, "update_time_ms": 2.15}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.08886004515112408, "policy_loss": -0.006846971207007926, "vf_loss": 9.437837182642312, "vf_explained_var": 0.3371526486771081, "kl": 0.013286473856520072, "entropy": 0.23841753919278422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2072000, "num_agent_steps_sampled": 2072000, "num_steps_trained": 2072000, "num_agent_steps_trained": 2072000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20880, "training_iteration": 518, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-51-18", "timestamp": 1643705478, "time_this_iter_s": 16.7742600440979, "time_total_s": 14509.626026153564, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2250.1171491146088, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 35.4125, "ram_util_percent": 56.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -60.4, "episode_reward_mean": -11.718, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -14.5, -12.7, -11.8, -4.2, -4.300000000000001, -7.300000000000001, -6.000000000000001, -17.4, -3.3, -10.100000000000001, -16.3, -10.7, -10.099999999999996, -4.4, -19.5, -22.300000000000004, -4.3, -25.6, -5.2, -21.900000000000006, -12.3, -5.300000000000001, -6.2, -12.0, -5.300000000000001, -7.300000000000001, -21.1, -14.799999999999999, -7.2, -8.8, -18.2, -3.3, -20.10000000000004, -14.399999999999993, -15.799999999999999, -21.5, -8.299999999999999, -4.2, -7.899999999999999, -14.899999999999999, -4.300000000000001, -6.2, -18.099999999999998, -3.2, -21.099999999999998, -17.5, -4.2, -10.999999999999998, -12.3, -11.2, -16.5, -8.3, -28.7, -15.599999999999998, -8.399999999999999, -7.300000000000001, -4.300000000000001, -4.300000000000001, -6.0, -5.000000000000001, -20.199999999999996, -15.6, -4.300000000000001, -9.799999999999999, -10.9, -3.2, -20.90000000000001, -4.300000000000001, -7.5, -4.300000000000001, -7.2, -10.3, -12.6, -5.3, -4.300000000000001, -18.0, -16.999999999999996, -6.4, -8.2, -21.0, -3.3, -17.299999999999997, -5.000000000000001, -6.300000000000001, -11.200000000000001, -6.300000000000001, -10.4, -27.00000000000001, -11.899999999999997, -60.4, -10.899999999999999, -18.4, -24.7, -14.8, -5.300000000000001, -4.4, -4.2, -13.6, -22.60000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.062669735587577, "mean_inference_ms": 1.413635517326395, "mean_action_processing_ms": 0.07637901114286869, "mean_env_wait_ms": 6.439324777236301, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2076000, "timesteps_this_iter": 0, "agent_timesteps_total": 2076000, "timers": {"sample_time_ms": 18166.533, "sample_throughput": 220.185, "load_time_ms": 0.366, "load_throughput": 10934768.95, "learn_time_ms": 8676.971, "learn_throughput": 460.99, "update_time_ms": 1.993}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.18866681230344598, "policy_loss": -0.017839647942693323, "vf_loss": 20.544486273745054, "vf_explained_var": 0.12170772385853593, "kl": 0.01061598294704008, "entropy": 0.2370012507643751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2076000, "num_agent_steps_sampled": 2076000, "num_steps_trained": 2076000, "num_agent_steps_trained": 2076000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20920, "training_iteration": 519, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-51-36", "timestamp": 1643705496, "time_this_iter_s": 18.157857179641724, "time_total_s": 14527.783883333206, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2268.2750062942505, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 37.18846153846154, "ram_util_percent": 56.28461538461538}}
{"episode_reward_max": -3.2, "episode_reward_min": -63.2, "episode_reward_mean": -12.349000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.899999999999999, -4.300000000000001, -6.2, -18.099999999999998, -3.2, -21.099999999999998, -17.5, -4.2, -10.999999999999998, -12.3, -11.2, -16.5, -8.3, -28.7, -15.599999999999998, -8.399999999999999, -7.300000000000001, -4.300000000000001, -4.300000000000001, -6.0, -5.000000000000001, -20.199999999999996, -15.6, -4.300000000000001, -9.799999999999999, -10.9, -3.2, -20.90000000000001, -4.300000000000001, -7.5, -4.300000000000001, -7.2, -10.3, -12.6, -5.3, -4.300000000000001, -18.0, -16.999999999999996, -6.4, -8.2, -21.0, -3.3, -17.299999999999997, -5.000000000000001, -6.300000000000001, -11.200000000000001, -6.300000000000001, -10.4, -27.00000000000001, -11.899999999999997, -60.4, -10.899999999999999, -18.4, -24.7, -14.8, -5.300000000000001, -4.4, -4.2, -13.6, -22.60000000000002, -4.4, -6.300000000000001, -20.5, -25.3, -13.799999999999999, -6.2, -10.2, -25.199999999999996, -14.7, -8.3, -12.299999999999997, -10.999999999999998, -11.9, -18.7, -9.2, -5.300000000000001, -10.099999999999998, -14.1, -3.3, -20.5, -9.5, -20.2, -4.300000000000001, -16.5, -5.2, -5.2, -63.2, -7.5, -15.099999999999998, -16.700000000000003, -14.999999999999996, -11.8, -4.2, -6.000000000000001, -11.4, -15.799999999999999, -8.2, -5.2, -16.69999999999999, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0628830988254097, "mean_inference_ms": 1.4138532476518286, "mean_action_processing_ms": 0.07638863936747713, "mean_env_wait_ms": 6.439885270074191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2080000, "timesteps_this_iter": 0, "agent_timesteps_total": 2080000, "timers": {"sample_time_ms": 17747.259, "sample_throughput": 225.387, "load_time_ms": 0.361, "load_throughput": 11091640.883, "learn_time_ms": 8900.134, "learn_throughput": 449.431, "update_time_ms": 1.977}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.2595403004212365, "policy_loss": -0.014056358612593143, "vf_loss": 27.213417850386712, "vf_explained_var": 0.04998714757222001, "kl": 0.014624909924500806, "entropy": 0.25963954944764417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2080000, "num_agent_steps_sampled": 2080000, "num_steps_trained": 2080000, "num_agent_steps_trained": 2080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20960, "training_iteration": 520, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-51-54", "timestamp": 1643705514, "time_this_iter_s": 18.07583212852478, "time_total_s": 14545.859715461731, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2286.3508384227753, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 30.803846153846152, "ram_util_percent": 56.29999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.40000000000003, "episode_reward_mean": -12.946000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.0, -3.3, -17.299999999999997, -5.000000000000001, -6.300000000000001, -11.200000000000001, -6.300000000000001, -10.4, -27.00000000000001, -11.899999999999997, -60.4, -10.899999999999999, -18.4, -24.7, -14.8, -5.300000000000001, -4.4, -4.2, -13.6, -22.60000000000002, -4.4, -6.300000000000001, -20.5, -25.3, -13.799999999999999, -6.2, -10.2, -25.199999999999996, -14.7, -8.3, -12.299999999999997, -10.999999999999998, -11.9, -18.7, -9.2, -5.300000000000001, -10.099999999999998, -14.1, -3.3, -20.5, -9.5, -20.2, -4.300000000000001, -16.5, -5.2, -5.2, -63.2, -7.5, -15.099999999999998, -16.700000000000003, -14.999999999999996, -11.8, -4.2, -6.000000000000001, -11.4, -15.799999999999999, -8.2, -5.2, -16.69999999999999, -8.2, -4.300000000000001, -5.300000000000001, -11.299999999999997, -14.9, -8.299999999999999, -5.4, -9.6, -13.999999999999996, -4.300000000000001, -36.2, -22.200000000000003, -3.3, -9.2, -8.2, -7.2, -9.8, -11.3, -8.3, -6.300000000000001, -11.3, -3.2, -7.800000000000001, -13.8, -3.8000000000000003, -75.40000000000003, -10.599999999999998, -34.499999999999986, -10.799999999999997, -6.2, -10.600000000000001, -4.2, -13.19999999999997, -5.300000000000001, -16.4, -12.3, -9.8, -12.5, -3.3, -8.799999999999995, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0622903293570067, "mean_inference_ms": 1.4133771673361928, "mean_action_processing_ms": 0.07636309351580771, "mean_env_wait_ms": 6.437434892659078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2084000, "timesteps_this_iter": 0, "agent_timesteps_total": 2084000, "timers": {"sample_time_ms": 18053.585, "sample_throughput": 221.563, "load_time_ms": 0.361, "load_throughput": 11082848.461, "learn_time_ms": 8654.752, "learn_throughput": 462.174, "update_time_ms": 1.997}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.31909520832911853, "policy_loss": -0.021814685202734444, "vf_loss": 33.99294741333172, "vf_explained_var": 0.12249478402958121, "kl": 0.009804281176342017, "entropy": 0.24082956068538208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2084000, "num_agent_steps_sampled": 2084000, "num_steps_trained": 2084000, "num_agent_steps_trained": 2084000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21000, "training_iteration": 521, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-52-11", "timestamp": 1643705531, "time_this_iter_s": 16.739069938659668, "time_total_s": 14562.59878540039, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2303.089908361435, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 35.56666666666666, "ram_util_percent": 56.30416666666665}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.40000000000003, "episode_reward_mean": -11.938000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -20.2, -4.300000000000001, -16.5, -5.2, -5.2, -63.2, -7.5, -15.099999999999998, -16.700000000000003, -14.999999999999996, -11.8, -4.2, -6.000000000000001, -11.4, -15.799999999999999, -8.2, -5.2, -16.69999999999999, -8.2, -4.300000000000001, -5.300000000000001, -11.299999999999997, -14.9, -8.299999999999999, -5.4, -9.6, -13.999999999999996, -4.300000000000001, -36.2, -22.200000000000003, -3.3, -9.2, -8.2, -7.2, -9.8, -11.3, -8.3, -6.300000000000001, -11.3, -3.2, -7.800000000000001, -13.8, -3.8000000000000003, -75.40000000000003, -10.599999999999998, -34.499999999999986, -10.799999999999997, -6.2, -10.600000000000001, -4.2, -13.19999999999997, -5.300000000000001, -16.4, -12.3, -9.8, -12.5, -3.3, -8.799999999999995, -5.2, -4.4, -13.600000000000001, -15.099999999999998, -9.5, -28.100000000000005, -3.3, -14.2, -7.300000000000001, -8.2, -9.8, -4.300000000000001, -18.100000000000012, -18.7, -11.399999999999999, -19.4, -5.3, -17.9, -4.2, -4.4, -10.700000000000001, -22.3, -4.0, -29.90000000000002, -7.599999999999999, -15.1, -6.2, -16.4, -3.2, -12.799999999999997, -4.4, -11.099999999999998, -13.699999999999996, -4.0, -6.300000000000001, -16.29999999999999, -5.799999999999999, -19.000000000000004, -16.799999999999997, -3.3, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0618561494727259, "mean_inference_ms": 1.4127497608407658, "mean_action_processing_ms": 0.0763296852269657, "mean_env_wait_ms": 6.434297230744574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2088000, "timesteps_this_iter": 0, "agent_timesteps_total": 2088000, "timers": {"sample_time_ms": 17945.923, "sample_throughput": 222.892, "load_time_ms": 0.356, "load_throughput": 11228977.98, "learn_time_ms": 8700.418, "learn_throughput": 459.748, "update_time_ms": 1.941}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.07751255535911168, "policy_loss": -0.0269483485544521, "vf_loss": 10.278435400480864, "vf_explained_var": 0.2666434225215707, "kl": 0.01676551386146313, "entropy": 0.2451006108474347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2088000, "num_agent_steps_sampled": 2088000, "num_steps_trained": 2088000, "num_agent_steps_trained": 2088000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21040, "training_iteration": 522, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-52-31", "timestamp": 1643705551, "time_this_iter_s": 19.912270069122314, "time_total_s": 14582.511055469513, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2323.0021784305573, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 34.78928571428571, "ram_util_percent": 56.453571428571436}}
{"episode_reward_max": -2.2, "episode_reward_min": -75.40000000000003, "episode_reward_mean": -11.624999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -7.800000000000001, -13.8, -3.8000000000000003, -75.40000000000003, -10.599999999999998, -34.499999999999986, -10.799999999999997, -6.2, -10.600000000000001, -4.2, -13.19999999999997, -5.300000000000001, -16.4, -12.3, -9.8, -12.5, -3.3, -8.799999999999995, -5.2, -4.4, -13.600000000000001, -15.099999999999998, -9.5, -28.100000000000005, -3.3, -14.2, -7.300000000000001, -8.2, -9.8, -4.300000000000001, -18.100000000000012, -18.7, -11.399999999999999, -19.4, -5.3, -17.9, -4.2, -4.4, -10.700000000000001, -22.3, -4.0, -29.90000000000002, -7.599999999999999, -15.1, -6.2, -16.4, -3.2, -12.799999999999997, -4.4, -11.099999999999998, -13.699999999999996, -4.0, -6.300000000000001, -16.29999999999999, -5.799999999999999, -19.000000000000004, -16.799999999999997, -3.3, -3.4, -25.5, -16.799999999999997, -3.3, -9.999999999999998, -10.1, -4.2, -12.5, -20.3, -10.199999999999998, -16.099999999999998, -8.899999999999999, -10.899999999999999, -8.3, -2.2, -3.3, -10.1, -19.10000000000001, -3.3, -17.199999999999996, -15.399999999999995, -12.899999999999999, -3.3, -6.300000000000001, -24.600000000000005, -8.600000000000001, -5.4, -10.4, -41.2, -9.799999999999999, -15.499999999999984, -22.7, -4.3, -4.2, -4.4, -8.799999999999999, -3.4, -5.300000000000001, -6.300000000000001, -5.2, -14.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0619492643858428, "mean_inference_ms": 1.4127877650194598, "mean_action_processing_ms": 0.07632909825806322, "mean_env_wait_ms": 6.434355208925763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2092000, "timesteps_this_iter": 0, "agent_timesteps_total": 2092000, "timers": {"sample_time_ms": 18168.295, "sample_throughput": 220.164, "load_time_ms": 0.37, "load_throughput": 10808668.986, "learn_time_ms": 8855.576, "learn_throughput": 451.693, "update_time_ms": 1.878}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.11296254723503064, "policy_loss": -0.01627526043924273, "vf_loss": 12.810112857754513, "vf_explained_var": 0.15380512661831353, "kl": 0.011366807911101657, "entropy": 0.23788452323486087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2092000, "num_agent_steps_sampled": 2092000, "num_steps_trained": 2092000, "num_agent_steps_trained": 2092000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21080, "training_iteration": 523, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-52-51", "timestamp": 1643705571, "time_this_iter_s": 20.375001907348633, "time_total_s": 14602.886057376862, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2343.377180337906, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 28.7, "ram_util_percent": 56.40000000000001}}
{"episode_reward_max": -2.2, "episode_reward_min": -41.2, "episode_reward_mean": -11.058, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.3, -4.0, -29.90000000000002, -7.599999999999999, -15.1, -6.2, -16.4, -3.2, -12.799999999999997, -4.4, -11.099999999999998, -13.699999999999996, -4.0, -6.300000000000001, -16.29999999999999, -5.799999999999999, -19.000000000000004, -16.799999999999997, -3.3, -3.4, -25.5, -16.799999999999997, -3.3, -9.999999999999998, -10.1, -4.2, -12.5, -20.3, -10.199999999999998, -16.099999999999998, -8.899999999999999, -10.899999999999999, -8.3, -2.2, -3.3, -10.1, -19.10000000000001, -3.3, -17.199999999999996, -15.399999999999995, -12.899999999999999, -3.3, -6.300000000000001, -24.600000000000005, -8.600000000000001, -5.4, -10.4, -41.2, -9.799999999999999, -15.499999999999984, -22.7, -4.3, -4.2, -4.4, -8.799999999999999, -3.4, -5.300000000000001, -6.300000000000001, -5.2, -14.999999999999998, -14.2, -3.2, -26.3, -9.4, -12.2, -9.2, -4.800000000000001, -36.19999999999997, -4.2, -10.8, -9.9, -3.3, -8.3, -12.7, -4.0, -10.6, -4.2, -7.899999999999999, -9.799999999999999, -5.2, -14.3, -6.799999999999999, -14.3, -4.300000000000001, -15.7, -4.4, -17.299999999999997, -9.700000000000001, -20.000000000000004, -5.2, -11.3, -11.199999999999998, -10.999999999999977, -10.799999999999997, -4.4, -6.300000000000001, -4.3, -17.5, -39.5, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.062145035042615, "mean_inference_ms": 1.4130097945713374, "mean_action_processing_ms": 0.07633846300941573, "mean_env_wait_ms": 6.435405427753293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2096000, "timesteps_this_iter": 0, "agent_timesteps_total": 2096000, "timers": {"sample_time_ms": 18214.18, "sample_throughput": 219.609, "load_time_ms": 0.381, "load_throughput": 10500197.772, "learn_time_ms": 9088.478, "learn_throughput": 440.118, "update_time_ms": 1.818}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.13400862283143467, "policy_loss": -0.02110343982054982, "vf_loss": 15.397367901571336, "vf_explained_var": 0.25372475430529606, "kl": 0.01138388674942197, "entropy": 0.23850075949424057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2096000, "num_agent_steps_sampled": 2096000, "num_steps_trained": 2096000, "num_agent_steps_trained": 2096000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21120, "training_iteration": 524, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-53-11", "timestamp": 1643705591, "time_this_iter_s": 19.89641809463501, "time_total_s": 14622.782475471497, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2363.273598432541, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 29.360714285714284, "ram_util_percent": 56.43214285714287}}
{"episode_reward_max": -3.2, "episode_reward_min": -99.6, "episode_reward_mean": -12.657, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999999, -3.3, -6.300000000000001, -24.600000000000005, -8.600000000000001, -5.4, -10.4, -41.2, -9.799999999999999, -15.499999999999984, -22.7, -4.3, -4.2, -4.4, -8.799999999999999, -3.4, -5.300000000000001, -6.300000000000001, -5.2, -14.999999999999998, -14.2, -3.2, -26.3, -9.4, -12.2, -9.2, -4.800000000000001, -36.19999999999997, -4.2, -10.8, -9.9, -3.3, -8.3, -12.7, -4.0, -10.6, -4.2, -7.899999999999999, -9.799999999999999, -5.2, -14.3, -6.799999999999999, -14.3, -4.300000000000001, -15.7, -4.4, -17.299999999999997, -9.700000000000001, -20.000000000000004, -5.2, -11.3, -11.199999999999998, -10.999999999999977, -10.799999999999997, -4.4, -6.300000000000001, -4.3, -17.5, -39.5, -4.2, -5.2, -4.9, -6.499999999999999, -7.199999999999999, -15.899999999999999, -4.300000000000001, -16.799999999999997, -9.5, -14.899999999999997, -9.2, -5.2, -14.599999999999998, -99.6, -13.899999999999979, -12.799999999999997, -13.7, -19.900000000000006, -14.7, -83.5, -12.899999999999999, -7.2, -13.2, -9.2, -8.899999999999999, -9.6, -4.4, -6.300000000000001, -12.599999999999998, -19.900000000000045, -15.899999999999997, -24.3, -3.3, -7.600000000000001, -11.3, -15.299999999999997, -15.1, -18.099999999999998, -4.4, -5.2, -12.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0619408782915363, "mean_inference_ms": 1.4133605415484596, "mean_action_processing_ms": 0.0763398423874599, "mean_env_wait_ms": 6.436047200651819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2100000, "timesteps_this_iter": 0, "agent_timesteps_total": 2100000, "timers": {"sample_time_ms": 18371.709, "sample_throughput": 217.726, "load_time_ms": 0.389, "load_throughput": 10275749.372, "learn_time_ms": 9412.578, "learn_throughput": 424.963, "update_time_ms": 1.916}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.7562778725186162, "policy_loss": -0.013439788621029146, "vf_loss": 76.78613013785373, "vf_explained_var": 0.06826232921692633, "kl": 0.018563805689184355, "entropy": 0.2897768384987308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2100000, "num_agent_steps_sampled": 2100000, "num_steps_trained": 2100000, "num_agent_steps_trained": 2100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21160, "training_iteration": 525, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-53-31", "timestamp": 1643705611, "time_this_iter_s": 20.04216718673706, "time_total_s": 14642.824642658234, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2383.315765619278, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 31.35862068965517, "ram_util_percent": 56.403448275862075}}
{"episode_reward_max": -3.2, "episode_reward_min": -99.6, "episode_reward_mean": -13.878000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.3, -6.799999999999999, -14.3, -4.300000000000001, -15.7, -4.4, -17.299999999999997, -9.700000000000001, -20.000000000000004, -5.2, -11.3, -11.199999999999998, -10.999999999999977, -10.799999999999997, -4.4, -6.300000000000001, -4.3, -17.5, -39.5, -4.2, -5.2, -4.9, -6.499999999999999, -7.199999999999999, -15.899999999999999, -4.300000000000001, -16.799999999999997, -9.5, -14.899999999999997, -9.2, -5.2, -14.599999999999998, -99.6, -13.899999999999979, -12.799999999999997, -13.7, -19.900000000000006, -14.7, -83.5, -12.899999999999999, -7.2, -13.2, -9.2, -8.899999999999999, -9.6, -4.4, -6.300000000000001, -12.599999999999998, -19.900000000000045, -15.899999999999997, -24.3, -3.3, -7.600000000000001, -11.3, -15.299999999999997, -15.1, -18.099999999999998, -4.4, -5.2, -12.199999999999998, -20.799999999999997, -48.80000000000002, -7.2, -10.099999999999998, -11.2, -3.3, -10.3, -18.1, -27.3, -16.599999999999998, -8.3, -4.300000000000001, -18.5, -23.400000000000002, -4.300000000000001, -9.3, -16.4, -4.300000000000001, -18.700000000000006, -10.599999999999998, -11.899999999999997, -5.3, -14.299999999999997, -18.799999999999997, -12.699999999999996, -15.5, -6.300000000000001, -19.4, -11.800000000000002, -13.199999999999998, -9.899999999999999, -14.799999999999999, -9.299999999999997, -21.5, -13.399999999999997, -18.699999999999996, -3.2, -22.400000000000002, -4.300000000000001, -7.600000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0619351529325696, "mean_inference_ms": 1.4136106745040236, "mean_action_processing_ms": 0.0763372240937953, "mean_env_wait_ms": 6.436019558751018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2104000, "timesteps_this_iter": 0, "agent_timesteps_total": 2104000, "timers": {"sample_time_ms": 18814.085, "sample_throughput": 212.607, "load_time_ms": 0.398, "load_throughput": 10046237.126, "learn_time_ms": 9451.152, "learn_throughput": 423.229, "update_time_ms": 1.877}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.16293893822178404, "policy_loss": -0.013478396545534814, "vf_loss": 17.5277167580461, "vf_explained_var": 0.1407811544274771, "kl": 0.011401699681164716, "entropy": 0.24910487091989927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2104000, "num_agent_steps_sampled": 2104000, "num_steps_trained": 2104000, "num_agent_steps_trained": 2104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21200, "training_iteration": 526, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-53-51", "timestamp": 1643705631, "time_this_iter_s": 19.587728023529053, "time_total_s": 14662.412370681763, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2402.903493642807, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 29.317857142857147, "ram_util_percent": 56.40714285714285}}
{"episode_reward_max": -3.2, "episode_reward_min": -48.80000000000002, "episode_reward_mean": -12.907000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -13.2, -9.2, -8.899999999999999, -9.6, -4.4, -6.300000000000001, -12.599999999999998, -19.900000000000045, -15.899999999999997, -24.3, -3.3, -7.600000000000001, -11.3, -15.299999999999997, -15.1, -18.099999999999998, -4.4, -5.2, -12.199999999999998, -20.799999999999997, -48.80000000000002, -7.2, -10.099999999999998, -11.2, -3.3, -10.3, -18.1, -27.3, -16.599999999999998, -8.3, -4.300000000000001, -18.5, -23.400000000000002, -4.300000000000001, -9.3, -16.4, -4.300000000000001, -18.700000000000006, -10.599999999999998, -11.899999999999997, -5.3, -14.299999999999997, -18.799999999999997, -12.699999999999996, -15.5, -6.300000000000001, -19.4, -11.800000000000002, -13.199999999999998, -9.899999999999999, -14.799999999999999, -9.299999999999997, -21.5, -13.399999999999997, -18.699999999999996, -3.2, -22.400000000000002, -4.300000000000001, -7.600000000000002, -21.500000000000004, -15.0, -13.699999999999998, -14.799999999999999, -23.6, -13.6, -22.800000000000004, -14.899999999999997, -22.4, -4.4, -3.3, -4.4, -9.799999999999999, -24.599999999999998, -4.300000000000001, -16.199999999999996, -20.900000000000002, -5.300000000000001, -6.2, -18.400000000000002, -18.2, -29.60000000000001, -5.3, -5.4, -8.799999999999999, -17.4, -6.6000000000000005, -4.2, -5.300000000000001, -19.299999999999997, -10.600000000000001, -8.3, -8.600000000000001, -20.5, -16.4, -3.3, -12.899999999999999, -13.699999999999998, -6.2, -19.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0620975846554017, "mean_inference_ms": 1.4137471690592194, "mean_action_processing_ms": 0.0763372375615538, "mean_env_wait_ms": 6.4359382122270725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2108000, "timesteps_this_iter": 0, "agent_timesteps_total": 2108000, "timers": {"sample_time_ms": 18854.272, "sample_throughput": 212.154, "load_time_ms": 0.415, "load_throughput": 9629902.422, "learn_time_ms": 9581.94, "learn_throughput": 417.452, "update_time_ms": 1.876}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.10447392322283278, "policy_loss": -0.017854470344040023, "vf_loss": 12.090715250308795, "vf_explained_var": 0.3010241354665449, "kl": 0.014212448251705033, "entropy": 0.28892866147141305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2108000, "num_agent_steps_sampled": 2108000, "num_steps_trained": 2108000, "num_agent_steps_trained": 2108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21240, "training_iteration": 527, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-54-11", "timestamp": 1643705651, "time_this_iter_s": 19.904403924942017, "time_total_s": 14682.316774606705, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2422.807897567749, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 29.15714285714285, "ram_util_percent": 56.335714285714296}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.30000000000008, "episode_reward_mean": -12.640000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999997, -5.3, -14.299999999999997, -18.799999999999997, -12.699999999999996, -15.5, -6.300000000000001, -19.4, -11.800000000000002, -13.199999999999998, -9.899999999999999, -14.799999999999999, -9.299999999999997, -21.5, -13.399999999999997, -18.699999999999996, -3.2, -22.400000000000002, -4.300000000000001, -7.600000000000002, -21.500000000000004, -15.0, -13.699999999999998, -14.799999999999999, -23.6, -13.6, -22.800000000000004, -14.899999999999997, -22.4, -4.4, -3.3, -4.4, -9.799999999999999, -24.599999999999998, -4.300000000000001, -16.199999999999996, -20.900000000000002, -5.300000000000001, -6.2, -18.400000000000002, -18.2, -29.60000000000001, -5.3, -5.4, -8.799999999999999, -17.4, -6.6000000000000005, -4.2, -5.300000000000001, -19.299999999999997, -10.600000000000001, -8.3, -8.600000000000001, -20.5, -16.4, -3.3, -12.899999999999999, -13.699999999999998, -6.2, -19.9, -4.4, -9.2, -4.4, -5.2, -11.699999999999998, -4.300000000000001, -5.300000000000001, -4.2, -5.4, -9.8, -3.3, -17.0, -28.0, -12.799999999999997, -24.600000000000005, -8.7, -6.2, -20.8, -4.2, -9.1, -3.4, -28.8, -17.2, -14.8, -23.099999999999994, -4.2, -3.8000000000000007, -27.9, -23.2, -30.30000000000008, -16.5, -6.300000000000001, -7.499999999999999, -10.6, -14.799999999999999, -4.4, -4.4, -16.199999999999996, -21.6, -11.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0626808268793162, "mean_inference_ms": 1.413982941421004, "mean_action_processing_ms": 0.076350606001616, "mean_env_wait_ms": 6.43686889832422, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2112000, "timesteps_this_iter": 0, "agent_timesteps_total": 2112000, "timers": {"sample_time_ms": 19034.607, "sample_throughput": 210.144, "load_time_ms": 0.428, "load_throughput": 9346638.44, "learn_time_ms": 9921.271, "learn_throughput": 403.174, "update_time_ms": 1.888}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.13198272569145086, "policy_loss": -0.01967541910006955, "vf_loss": 15.040885016995091, "vf_explained_var": 0.30352177350751813, "kl": 0.012492985172201506, "entropy": 0.2741230581035858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2112000, "num_agent_steps_sampled": 2112000, "num_steps_trained": 2112000, "num_agent_steps_trained": 2112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21280, "training_iteration": 528, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-54-32", "timestamp": 1643705672, "time_this_iter_s": 20.66413187980652, "time_total_s": 14702.980906486511, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2443.4720294475555, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 36.08965517241379, "ram_util_percent": 56.54137931034482}}
{"episode_reward_max": -3.2, "episode_reward_min": -82.1, "episode_reward_mean": -12.513, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.2, -29.60000000000001, -5.3, -5.4, -8.799999999999999, -17.4, -6.6000000000000005, -4.2, -5.300000000000001, -19.299999999999997, -10.600000000000001, -8.3, -8.600000000000001, -20.5, -16.4, -3.3, -12.899999999999999, -13.699999999999998, -6.2, -19.9, -4.4, -9.2, -4.4, -5.2, -11.699999999999998, -4.300000000000001, -5.300000000000001, -4.2, -5.4, -9.8, -3.3, -17.0, -28.0, -12.799999999999997, -24.600000000000005, -8.7, -6.2, -20.8, -4.2, -9.1, -3.4, -28.8, -17.2, -14.8, -23.099999999999994, -4.2, -3.8000000000000007, -27.9, -23.2, -30.30000000000008, -16.5, -6.300000000000001, -7.499999999999999, -10.6, -14.799999999999999, -4.4, -4.4, -16.199999999999996, -21.6, -11.5, -16.3, -18.200000000000003, -24.3, -3.2, -5.300000000000001, -5.4, -4.4, -5.300000000000001, -5.2, -5.300000000000001, -38.899999999999956, -5.2, -16.7, -5.599999999999999, -24.599999999999955, -4.3, -6.300000000000001, -33.40000000000004, -4.4, -26.400000000000038, -23.6, -10.899999999999997, -22.700000000000003, -4.2, -6.300000000000001, -5.300000000000001, -16.699999999999996, -82.1, -4.300000000000001, -12.099999999999998, -5.4, -4.2, -12.799999999999999, -4.5, -3.3, -8.3, -5.4, -5.2, -17.1, -8.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0634636097172325, "mean_inference_ms": 1.4144677551327218, "mean_action_processing_ms": 0.076378885134034, "mean_env_wait_ms": 6.439363548859435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2116000, "timesteps_this_iter": 0, "agent_timesteps_total": 2116000, "timers": {"sample_time_ms": 19318.418, "sample_throughput": 207.056, "load_time_ms": 0.416, "load_throughput": 9616654.821, "learn_time_ms": 10250.55, "learn_throughput": 390.223, "update_time_ms": 1.904}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.41451242252112797, "policy_loss": -0.015480703463958155, "vf_loss": 42.89539594054222, "vf_explained_var": 0.10980892348033126, "kl": 0.01039185391672076, "entropy": 0.2419954799035544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2116000, "num_agent_steps_sampled": 2116000, "num_steps_trained": 2116000, "num_agent_steps_trained": 2116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21320, "training_iteration": 529, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-54-53", "timestamp": 1643705693, "time_this_iter_s": 20.891932725906372, "time_total_s": 14723.872839212418, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2464.363962173462, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 34.86333333333334, "ram_util_percent": 56.519999999999996}}
{"episode_reward_max": -3.2, "episode_reward_min": -85.3, "episode_reward_mean": -15.213000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -28.8, -17.2, -14.8, -23.099999999999994, -4.2, -3.8000000000000007, -27.9, -23.2, -30.30000000000008, -16.5, -6.300000000000001, -7.499999999999999, -10.6, -14.799999999999999, -4.4, -4.4, -16.199999999999996, -21.6, -11.5, -16.3, -18.200000000000003, -24.3, -3.2, -5.300000000000001, -5.4, -4.4, -5.300000000000001, -5.2, -5.300000000000001, -38.899999999999956, -5.2, -16.7, -5.599999999999999, -24.599999999999955, -4.3, -6.300000000000001, -33.40000000000004, -4.4, -26.400000000000038, -23.6, -10.899999999999997, -22.700000000000003, -4.2, -6.300000000000001, -5.300000000000001, -16.699999999999996, -82.1, -4.300000000000001, -12.099999999999998, -5.4, -4.2, -12.799999999999999, -4.5, -3.3, -8.3, -5.4, -5.2, -17.1, -8.599999999999998, -27.799999999999997, -5.7, -16.7, -5.4, -18.2, -25.5, -5.300000000000001, -10.3, -9.3, -17.4, -5.4, -27.2, -11.899999999999997, -15.999999999999998, -27.99999999999995, -5.300000000000001, -16.1, -4.800000000000001, -7.2, -24.0, -18.7, -5.300000000000001, -18.5, -22.0, -10.0, -14.099999999999998, -4.300000000000001, -12.099999999999998, -19.3, -85.3, -26.700000000000003, -20.2, -9.2, -4.300000000000001, -7.300000000000001, -21.7, -14.799999999999976, -65.4, -25.100000000000037, -17.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0641050823500513, "mean_inference_ms": 1.4149706809777953, "mean_action_processing_ms": 0.0764094382659988, "mean_env_wait_ms": 6.442063377438979, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2120000, "timesteps_this_iter": 0, "agent_timesteps_total": 2120000, "timers": {"sample_time_ms": 19781.406, "sample_throughput": 202.21, "load_time_ms": 0.43, "load_throughput": 9310847.439, "learn_time_ms": 10312.213, "learn_throughput": 387.89, "update_time_ms": 1.915}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.5166769750413776, "policy_loss": -0.022016684260840216, "vf_loss": 53.73500385053696, "vf_explained_var": 0.101693425063164, "kl": 0.013436340172861619, "entropy": 0.3078161457052795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2120000, "num_agent_steps_sampled": 2120000, "num_steps_trained": 2120000, "num_agent_steps_trained": 2120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21360, "training_iteration": 530, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-55-13", "timestamp": 1643705713, "time_this_iter_s": 20.02532720565796, "time_total_s": 14743.898166418076, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2484.38928937912, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 31.732142857142858, "ram_util_percent": 56.5}}
{"episode_reward_max": -3.3, "episode_reward_min": -129.8000000000001, "episode_reward_mean": -17.428, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.6, -10.899999999999997, -22.700000000000003, -4.2, -6.300000000000001, -5.300000000000001, -16.699999999999996, -82.1, -4.300000000000001, -12.099999999999998, -5.4, -4.2, -12.799999999999999, -4.5, -3.3, -8.3, -5.4, -5.2, -17.1, -8.599999999999998, -27.799999999999997, -5.7, -16.7, -5.4, -18.2, -25.5, -5.300000000000001, -10.3, -9.3, -17.4, -5.4, -27.2, -11.899999999999997, -15.999999999999998, -27.99999999999995, -5.300000000000001, -16.1, -4.800000000000001, -7.2, -24.0, -18.7, -5.300000000000001, -18.5, -22.0, -10.0, -14.099999999999998, -4.300000000000001, -12.099999999999998, -19.3, -85.3, -26.700000000000003, -20.2, -9.2, -4.300000000000001, -7.300000000000001, -21.7, -14.799999999999976, -65.4, -25.100000000000037, -17.3, -3.4, -6.300000000000001, -63.20000000000004, -7.700000000000001, -6.300000000000001, -25.000000000000085, -28.300000000000008, -9.9, -24.80000000000003, -21.2, -129.8000000000001, -24.500000000000007, -15.7, -8.1, -16.4, -8.3, -6.4, -16.1, -5.4, -4.4, -36.2, -34.3, -23.4, -7.1, -12.499999999999998, -6.2, -18.799999999999997, -32.700000000000024, -19.600000000000005, -36.50000000000001, -4.300000000000001, -20.3, -19.099999999999998, -6.300000000000001, -4.300000000000001, -10.399999999999999, -14.3, -22.299999999999997, -6.5, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0646629435560921, "mean_inference_ms": 1.4154243769317094, "mean_action_processing_ms": 0.0764379749778803, "mean_env_wait_ms": 6.4443544806285935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2124000, "timesteps_this_iter": 0, "agent_timesteps_total": 2124000, "timers": {"sample_time_ms": 19967.783, "sample_throughput": 200.323, "load_time_ms": 0.439, "load_throughput": 9114584.669, "learn_time_ms": 10541.802, "learn_throughput": 379.442, "update_time_ms": 1.947}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.9843945036902623, "policy_loss": -0.031101017311635996, "vf_loss": 101.37855927354546, "vf_explained_var": -0.12238741235066486, "kl": 0.01709950774047208, "entropy": 0.3090601994465756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2124000, "num_agent_steps_sampled": 2124000, "num_steps_trained": 2124000, "num_agent_steps_trained": 2124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21400, "training_iteration": 531, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-55-33", "timestamp": 1643705733, "time_this_iter_s": 20.280532121658325, "time_total_s": 14764.178698539734, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2504.669821500778, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 27.72413793103449, "ram_util_percent": 56.468965517241394}}
{"episode_reward_max": -3.2, "episode_reward_min": -129.8000000000001, "episode_reward_mean": -17.129000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.7, -5.300000000000001, -18.5, -22.0, -10.0, -14.099999999999998, -4.300000000000001, -12.099999999999998, -19.3, -85.3, -26.700000000000003, -20.2, -9.2, -4.300000000000001, -7.300000000000001, -21.7, -14.799999999999976, -65.4, -25.100000000000037, -17.3, -3.4, -6.300000000000001, -63.20000000000004, -7.700000000000001, -6.300000000000001, -25.000000000000085, -28.300000000000008, -9.9, -24.80000000000003, -21.2, -129.8000000000001, -24.500000000000007, -15.7, -8.1, -16.4, -8.3, -6.4, -16.1, -5.4, -4.4, -36.2, -34.3, -23.4, -7.1, -12.499999999999998, -6.2, -18.799999999999997, -32.700000000000024, -19.600000000000005, -36.50000000000001, -4.300000000000001, -20.3, -19.099999999999998, -6.300000000000001, -4.300000000000001, -10.399999999999999, -14.3, -22.299999999999997, -6.5, -4.4, -4.5, -5.4, -6.4, -14.5, -24.199999999999996, -3.3, -12.7, -17.999999999999996, -12.3, -15.899999999999979, -12.299999999999997, -18.8, -5.300000000000001, -21.9, -18.600000000000005, -9.6, -11.199999999999998, -19.099999999999998, -3.2, -5.300000000000001, -44.10000000000001, -6.4, -5.300000000000001, -7.300000000000001, -6.2, -8.3, -28.600000000000005, -3.3, -11.399999999999999, -23.900000000000006, -4.300000000000001, -14.999999999999998, -19.4, -12.3, -23.2, -5.4, -20.2, -15.699999999999998, -4.2, -13.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.065506048186848, "mean_inference_ms": 1.4162952325014806, "mean_action_processing_ms": 0.07648800029743186, "mean_env_wait_ms": 6.448681650564762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2128000, "timesteps_this_iter": 0, "agent_timesteps_total": 2128000, "timers": {"sample_time_ms": 20346.297, "sample_throughput": 196.596, "load_time_ms": 0.44, "load_throughput": 9097286.628, "learn_time_ms": 10572.369, "learn_throughput": 378.345, "update_time_ms": 1.934}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.14492814796407186, "policy_loss": -0.017071920606277644, "vf_loss": 16.08199281115686, "vf_explained_var": 0.12345859235332858, "kl": 0.011801448237620788, "entropy": 0.24806467545449093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2128000, "num_agent_steps_sampled": 2128000, "num_steps_trained": 2128000, "num_agent_steps_trained": 2128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21440, "training_iteration": 532, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-55-55", "timestamp": 1643705755, "time_this_iter_s": 21.693626165390015, "time_total_s": 14785.872324705124, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2526.363447666168, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 33.76451612903226, "ram_util_percent": 56.477419354838716}}
{"episode_reward_max": -3.2, "episode_reward_min": -72.89999999999999, "episode_reward_mean": -14.319, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.2, -34.3, -23.4, -7.1, -12.499999999999998, -6.2, -18.799999999999997, -32.700000000000024, -19.600000000000005, -36.50000000000001, -4.300000000000001, -20.3, -19.099999999999998, -6.300000000000001, -4.300000000000001, -10.399999999999999, -14.3, -22.299999999999997, -6.5, -4.4, -4.5, -5.4, -6.4, -14.5, -24.199999999999996, -3.3, -12.7, -17.999999999999996, -12.3, -15.899999999999979, -12.299999999999997, -18.8, -5.300000000000001, -21.9, -18.600000000000005, -9.6, -11.199999999999998, -19.099999999999998, -3.2, -5.300000000000001, -44.10000000000001, -6.4, -5.300000000000001, -7.300000000000001, -6.2, -8.3, -28.600000000000005, -3.3, -11.399999999999999, -23.900000000000006, -4.300000000000001, -14.999999999999998, -19.4, -12.3, -23.2, -5.4, -20.2, -15.699999999999998, -4.2, -13.6, -8.5, -13.09999999999998, -16.3, -13.699999999999998, -5.2, -18.800000000000004, -4.300000000000001, -10.999999999999998, -23.500000000000004, -20.6, -12.5, -7.300000000000001, -12.5, -9.399999999999997, -15.799999999999997, -13.4, -10.7, -25.6, -5.300000000000001, -3.4, -8.9, -10.200000000000001, -4.4, -6.2, -14.899999999999999, -28.8, -10.5, -45.3, -18.3, -3.3, -3.4, -19.3, -10.3, -8.3, -4.1, -6.2, -72.89999999999999, -11.299999999999999, -16.7, -17.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.06639585919143, "mean_inference_ms": 1.4172158886019457, "mean_action_processing_ms": 0.07653968993573669, "mean_env_wait_ms": 6.453315964426093, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2132000, "timesteps_this_iter": 0, "agent_timesteps_total": 2132000, "timers": {"sample_time_ms": 20380.124, "sample_throughput": 196.27, "load_time_ms": 0.439, "load_throughput": 9116565.777, "learn_time_ms": 10576.709, "learn_throughput": 378.189, "update_time_ms": 1.944}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.3621989285645966, "policy_loss": -0.03467531481216992, "vf_loss": 39.546842650957004, "vf_explained_var": 0.028645361431183354, "kl": 0.014058359718270137, "entropy": 0.2744261989430074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2132000, "num_agent_steps_sampled": 2132000, "num_steps_trained": 2132000, "num_agent_steps_trained": 2132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21480, "training_iteration": 533, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-56-15", "timestamp": 1643705775, "time_this_iter_s": 20.457065105438232, "time_total_s": 14806.329389810562, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2546.8205127716064, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 31.924137931034487, "ram_util_percent": 56.5}}
{"episode_reward_max": -3.3, "episode_reward_min": -112.5, "episode_reward_mean": -15.680000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.10000000000001, -6.4, -5.300000000000001, -7.300000000000001, -6.2, -8.3, -28.600000000000005, -3.3, -11.399999999999999, -23.900000000000006, -4.300000000000001, -14.999999999999998, -19.4, -12.3, -23.2, -5.4, -20.2, -15.699999999999998, -4.2, -13.6, -8.5, -13.09999999999998, -16.3, -13.699999999999998, -5.2, -18.800000000000004, -4.300000000000001, -10.999999999999998, -23.500000000000004, -20.6, -12.5, -7.300000000000001, -12.5, -9.399999999999997, -15.799999999999997, -13.4, -10.7, -25.6, -5.300000000000001, -3.4, -8.9, -10.200000000000001, -4.4, -6.2, -14.899999999999999, -28.8, -10.5, -45.3, -18.3, -3.3, -3.4, -19.3, -10.3, -8.3, -4.1, -6.2, -72.89999999999999, -11.299999999999999, -16.7, -17.599999999999998, -8.5, -4.2, -9.2, -14.999999999999998, -26.10000000000001, -8.3, -12.1, -49.3, -11.1, -23.799999999999997, -32.7, -22.4, -6.300000000000001, -91.4, -15.699999999999996, -11.5, -3.3, -11.899999999999999, -16.399999999999988, -4.300000000000001, -5.4, -7.699999999999998, -12.0, -8.299999999999997, -10.3, -15.199999999999998, -6.300000000000001, -9.6, -112.5, -14.799999999999999, -18.200000000000003, -26.4, -12.2, -10.4, -16.799999999999997, -13.599999999999998, -13.2, -5.4, -10.9, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.067270376732096, "mean_inference_ms": 1.4179540539105324, "mean_action_processing_ms": 0.07658516272471932, "mean_env_wait_ms": 6.456989551676059, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2136000, "timesteps_this_iter": 0, "agent_timesteps_total": 2136000, "timers": {"sample_time_ms": 20429.524, "sample_throughput": 195.795, "load_time_ms": 0.438, "load_throughput": 9132445.702, "learn_time_ms": 10576.024, "learn_throughput": 378.214, "update_time_ms": 1.981}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 1.1748805639779656, "policy_loss": -0.021345497684813634, "vf_loss": 119.51564525122284, "vf_explained_var": 0.055754351679996775, "kl": 0.010696436391624514, "entropy": 0.2906022004542812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2136000, "num_agent_steps_sampled": 2136000, "num_steps_trained": 2136000, "num_agent_steps_trained": 2136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21520, "training_iteration": 534, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-56-36", "timestamp": 1643705796, "time_this_iter_s": 20.342549085617065, "time_total_s": 14826.67193889618, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2567.1630618572235, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 36.12413793103449, "ram_util_percent": 56.455172413793115}}
{"episode_reward_max": -3.3, "episode_reward_min": -112.5, "episode_reward_mean": -16.206, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.9, -10.200000000000001, -4.4, -6.2, -14.899999999999999, -28.8, -10.5, -45.3, -18.3, -3.3, -3.4, -19.3, -10.3, -8.3, -4.1, -6.2, -72.89999999999999, -11.299999999999999, -16.7, -17.599999999999998, -8.5, -4.2, -9.2, -14.999999999999998, -26.10000000000001, -8.3, -12.1, -49.3, -11.1, -23.799999999999997, -32.7, -22.4, -6.300000000000001, -91.4, -15.699999999999996, -11.5, -3.3, -11.899999999999999, -16.399999999999988, -4.300000000000001, -5.4, -7.699999999999998, -12.0, -8.299999999999997, -10.3, -15.199999999999998, -6.300000000000001, -9.6, -112.5, -14.799999999999999, -18.200000000000003, -26.4, -12.2, -10.4, -16.799999999999997, -13.599999999999998, -13.2, -5.4, -10.9, -5.4, -22.2, -6.300000000000001, -22.4, -3.4, -10.299999999999997, -4.300000000000001, -21.4, -22.600000000000005, -7.5, -13.5, -12.2, -6.4, -6.6, -9.6, -21.500000000000004, -29.600000000000005, -3.3000000000000003, -14.999999999999998, -17.799999999999997, -11.099999999999998, -57.6, -21.6, -29.2, -17.699999999999996, -3.4, -6.300000000000001, -5.300000000000001, -21.2, -13.4, -16.8, -23.99999999999999, -6.300000000000001, -6.2, -6.300000000000001, -14.3, -5.4, -11.099999999999993, -20.099999999999998, -12.0, -16.39999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0681223306191054, "mean_inference_ms": 1.418498140795544, "mean_action_processing_ms": 0.0766179570585279, "mean_env_wait_ms": 6.459652173510943, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2140000, "timesteps_this_iter": 0, "agent_timesteps_total": 2140000, "timers": {"sample_time_ms": 20489.666, "sample_throughput": 195.22, "load_time_ms": 0.439, "load_throughput": 9109635.663, "learn_time_ms": 10526.257, "learn_throughput": 380.002, "update_time_ms": 1.912}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.2897026871085688, "policy_loss": -0.021622624749477994, "vf_loss": 30.998411971522916, "vf_explained_var": 0.08155403739662581, "kl": 0.013411987038263167, "entropy": 0.29181837183974124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2140000, "num_agent_steps_sampled": 2140000, "num_steps_trained": 2140000, "num_agent_steps_trained": 2140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21560, "training_iteration": 535, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-56-56", "timestamp": 1643705816, "time_this_iter_s": 20.148029088974, "time_total_s": 14846.819967985153, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2587.3110909461975, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 32.55172413793104, "ram_util_percent": 56.43793103448276}}
{"episode_reward_max": -3.3000000000000003, "episode_reward_min": -112.5, "episode_reward_mean": -15.308000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -7.699999999999998, -12.0, -8.299999999999997, -10.3, -15.199999999999998, -6.300000000000001, -9.6, -112.5, -14.799999999999999, -18.200000000000003, -26.4, -12.2, -10.4, -16.799999999999997, -13.599999999999998, -13.2, -5.4, -10.9, -5.4, -22.2, -6.300000000000001, -22.4, -3.4, -10.299999999999997, -4.300000000000001, -21.4, -22.600000000000005, -7.5, -13.5, -12.2, -6.4, -6.6, -9.6, -21.500000000000004, -29.600000000000005, -3.3000000000000003, -14.999999999999998, -17.799999999999997, -11.099999999999998, -57.6, -21.6, -29.2, -17.699999999999996, -3.4, -6.300000000000001, -5.300000000000001, -21.2, -13.4, -16.8, -23.99999999999999, -6.300000000000001, -6.2, -6.300000000000001, -14.3, -5.4, -11.099999999999993, -20.099999999999998, -12.0, -16.39999999999999, -13.299999999999999, -10.5, -4.3, -11.700000000000001, -15.19999999999997, -23.700000000000006, -15.3, -17.6, -18.3, -12.5, -30.70000000000001, -11.3, -18.4, -4.300000000000001, -23.700000000000003, -15.099999999999973, -94.3, -16.2, -22.900000000000006, -5.3, -11.299999999999999, -19.199999999999996, -6.300000000000001, -5.300000000000001, -14.499999999999998, -22.5, -5.4, -6.2, -5.4, -12.2, -12.5, -12.79999999999998, -16.4, -5.4, -6.300000000000001, -6.4, -6.4, -15.899999999999999, -23.900000000000006, -15.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.068904444974871, "mean_inference_ms": 1.4190799433923926, "mean_action_processing_ms": 0.07665237524131324, "mean_env_wait_ms": 6.462515174568575, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2144000, "timesteps_this_iter": 0, "agent_timesteps_total": 2144000, "timers": {"sample_time_ms": 20511.448, "sample_throughput": 195.013, "load_time_ms": 0.442, "load_throughput": 9057993.737, "learn_time_ms": 10541.131, "learn_throughput": 379.466, "update_time_ms": 1.918}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.48731466777026855, "policy_loss": -0.015125082230936455, "vf_loss": 50.123394413084114, "vf_explained_var": 0.1440485346060927, "kl": 0.012058191232728905, "entropy": 0.2592162237051995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2144000, "num_agent_steps_sampled": 2144000, "num_steps_trained": 2144000, "num_agent_steps_trained": 2144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21600, "training_iteration": 536, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-57-16", "timestamp": 1643705836, "time_this_iter_s": 20.465473175048828, "time_total_s": 14867.285441160202, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2607.7765641212463, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 35.45172413793104, "ram_util_percent": 56.524137931034474}}
{"episode_reward_max": -3.4, "episode_reward_min": -122.2, "episode_reward_mean": -15.550000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.6, -21.6, -29.2, -17.699999999999996, -3.4, -6.300000000000001, -5.300000000000001, -21.2, -13.4, -16.8, -23.99999999999999, -6.300000000000001, -6.2, -6.300000000000001, -14.3, -5.4, -11.099999999999993, -20.099999999999998, -12.0, -16.39999999999999, -13.299999999999999, -10.5, -4.3, -11.700000000000001, -15.19999999999997, -23.700000000000006, -15.3, -17.6, -18.3, -12.5, -30.70000000000001, -11.3, -18.4, -4.300000000000001, -23.700000000000003, -15.099999999999973, -94.3, -16.2, -22.900000000000006, -5.3, -11.299999999999999, -19.199999999999996, -6.300000000000001, -5.300000000000001, -14.499999999999998, -22.5, -5.4, -6.2, -5.4, -12.2, -12.5, -12.79999999999998, -16.4, -5.4, -6.300000000000001, -6.4, -6.4, -15.899999999999999, -23.900000000000006, -15.7, -18.9, -22.39999999999999, -24.400000000000002, -6.299999999999998, -7.300000000000001, -122.2, -15.2, -4.4, -6.300000000000001, -17.19999999999999, -10.0, -7.799999999999999, -33.599999999999994, -7.300000000000001, -4.2, -13.599999999999998, -25.299999999999997, -8.3, -11.7, -13.3, -14.3, -7.4, -19.9, -5.2, -12.3, -18.800000000000004, -20.799999999999997, -4.4, -17.6, -14.399999999999999, -11.499999999999996, -10.4, -5.300000000000001, -12.799999999999999, -20.799999999999997, -8.7, -17.3, -5.4, -6.4, -12.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.069711404733051, "mean_inference_ms": 1.4196696259632555, "mean_action_processing_ms": 0.07668702892695149, "mean_env_wait_ms": 6.465343631760714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2148000, "timesteps_this_iter": 0, "agent_timesteps_total": 2148000, "timers": {"sample_time_ms": 20580.604, "sample_throughput": 194.358, "load_time_ms": 0.443, "load_throughput": 9025346.172, "learn_time_ms": 10569.741, "learn_throughput": 378.439, "update_time_ms": 1.903}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.4864826000288069, "policy_loss": -0.018982736614873253, "vf_loss": 50.41687114507921, "vf_explained_var": 0.1614615785819228, "kl": 0.012966386947860361, "entropy": 0.2554706106823619, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2148000, "num_agent_steps_sampled": 2148000, "num_steps_trained": 2148000, "num_agent_steps_trained": 2148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21640, "training_iteration": 537, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-57-37", "timestamp": 1643705857, "time_this_iter_s": 20.735039949417114, "time_total_s": 14888.02048110962, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2628.5116040706635, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 34.237931034482756, "ram_util_percent": 56.50344827586206}}
{"episode_reward_max": -4.2, "episode_reward_min": -122.2, "episode_reward_mean": -13.889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.299999999999999, -19.199999999999996, -6.300000000000001, -5.300000000000001, -14.499999999999998, -22.5, -5.4, -6.2, -5.4, -12.2, -12.5, -12.79999999999998, -16.4, -5.4, -6.300000000000001, -6.4, -6.4, -15.899999999999999, -23.900000000000006, -15.7, -18.9, -22.39999999999999, -24.400000000000002, -6.299999999999998, -7.300000000000001, -122.2, -15.2, -4.4, -6.300000000000001, -17.19999999999999, -10.0, -7.799999999999999, -33.599999999999994, -7.300000000000001, -4.2, -13.599999999999998, -25.299999999999997, -8.3, -11.7, -13.3, -14.3, -7.4, -19.9, -5.2, -12.3, -18.800000000000004, -20.799999999999997, -4.4, -17.6, -14.399999999999999, -11.499999999999996, -10.4, -5.300000000000001, -12.799999999999999, -20.799999999999997, -8.7, -17.3, -5.4, -6.4, -12.4, -4.300000000000001, -8.5, -23.3, -10.199999999999998, -10.999999999999996, -39.200000000000024, -8.3, -15.599999999999998, -24.0, -8.199999999999998, -4.2, -10.2, -24.0, -16.3, -9.4, -5.4, -18.900000000000002, -12.3, -6.300000000000001, -16.89999999999999, -4.300000000000001, -6.300000000000001, -5.899999999999999, -15.199999999999998, -18.599999999999998, -35.4, -5.4, -32.400000000000006, -26.699999999999996, -13.399999999999999, -6.4, -8.4, -15.19999999999997, -5.999999999999999, -9.5, -5.4, -7.300000000000001, -6.300000000000001, -14.2, -14.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0704803514840933, "mean_inference_ms": 1.42018973330948, "mean_action_processing_ms": 0.07671936682718075, "mean_env_wait_ms": 6.467850249587665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2152000, "timesteps_this_iter": 0, "agent_timesteps_total": 2152000, "timers": {"sample_time_ms": 20600.442, "sample_throughput": 194.171, "load_time_ms": 0.442, "load_throughput": 9047735.534, "learn_time_ms": 10540.939, "learn_throughput": 379.473, "update_time_ms": 1.907}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.18046114083419565, "policy_loss": -0.013602526447865911, "vf_loss": 19.27399324896515, "vf_explained_var": 0.10816336754829653, "kl": 0.01323740442764538, "entropy": 0.24049320429243068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2152000, "num_agent_steps_sampled": 2152000, "num_steps_trained": 2152000, "num_agent_steps_trained": 2152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21680, "training_iteration": 538, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-57-57", "timestamp": 1643705877, "time_this_iter_s": 20.300992965698242, "time_total_s": 14908.321474075317, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2648.8125970363617, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 32.10344827586207, "ram_util_percent": 56.50689655172414}}
{"episode_reward_max": -3.4, "episode_reward_min": -80.4, "episode_reward_mean": -13.400000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.3, -7.4, -19.9, -5.2, -12.3, -18.800000000000004, -20.799999999999997, -4.4, -17.6, -14.399999999999999, -11.499999999999996, -10.4, -5.300000000000001, -12.799999999999999, -20.799999999999997, -8.7, -17.3, -5.4, -6.4, -12.4, -4.300000000000001, -8.5, -23.3, -10.199999999999998, -10.999999999999996, -39.200000000000024, -8.3, -15.599999999999998, -24.0, -8.199999999999998, -4.2, -10.2, -24.0, -16.3, -9.4, -5.4, -18.900000000000002, -12.3, -6.300000000000001, -16.89999999999999, -4.300000000000001, -6.300000000000001, -5.899999999999999, -15.199999999999998, -18.599999999999998, -35.4, -5.4, -32.400000000000006, -26.699999999999996, -13.399999999999999, -6.4, -8.4, -15.19999999999997, -5.999999999999999, -9.5, -5.4, -7.300000000000001, -6.300000000000001, -14.2, -14.3, -5.4, -80.4, -6.6000000000000005, -11.999999999999998, -24.7, -9.500000000000002, -15.899999999999999, -11.399999999999999, -5.2, -5.4, -12.799999999999997, -13.299999999999994, -21.6, -9.699999999999998, -18.900000000000002, -4.3, -14.999999999999998, -12.200000000000003, -5.4, -27.3, -7.300000000000001, -4.300000000000001, -5.4, -5.4, -23.099999999999998, -16.3, -4.300000000000001, -15.3, -15.899999999999999, -9.7, -4.300000000000001, -22.5, -12.899999999999999, -18.299999999999997, -6.300000000000001, -9.3, -6.300000000000001, -31.1, -3.4, -22.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0709355398336917, "mean_inference_ms": 1.4206662458094286, "mean_action_processing_ms": 0.0767490241068088, "mean_env_wait_ms": 6.47040934841978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2156000, "timesteps_this_iter": 0, "agent_timesteps_total": 2156000, "timers": {"sample_time_ms": 20546.768, "sample_throughput": 194.678, "load_time_ms": 0.442, "load_throughput": 9045784.224, "learn_time_ms": 10527.194, "learn_throughput": 379.968, "update_time_ms": 1.934}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.4005501851058936, "policy_loss": -0.012257675842071573, "vf_loss": 41.18235579581671, "vf_explained_var": 0.22687156719546164, "kl": 0.009843157747985297, "entropy": 0.23798951420091813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2156000, "num_agent_steps_sampled": 2156000, "num_steps_trained": 2156000, "num_agent_steps_trained": 2156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21720, "training_iteration": 539, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-58-18", "timestamp": 1643705898, "time_this_iter_s": 20.50733709335327, "time_total_s": 14928.82881116867, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2669.319934129715, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 33.327586206896555, "ram_util_percent": 56.48620689655172}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -129.1999999999999, "episode_reward_mean": -15.331999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -6.300000000000001, -5.899999999999999, -15.199999999999998, -18.599999999999998, -35.4, -5.4, -32.400000000000006, -26.699999999999996, -13.399999999999999, -6.4, -8.4, -15.19999999999997, -5.999999999999999, -9.5, -5.4, -7.300000000000001, -6.300000000000001, -14.2, -14.3, -5.4, -80.4, -6.6000000000000005, -11.999999999999998, -24.7, -9.500000000000002, -15.899999999999999, -11.399999999999999, -5.2, -5.4, -12.799999999999997, -13.299999999999994, -21.6, -9.699999999999998, -18.900000000000002, -4.3, -14.999999999999998, -12.200000000000003, -5.4, -27.3, -7.300000000000001, -4.300000000000001, -5.4, -5.4, -23.099999999999998, -16.3, -4.300000000000001, -15.3, -15.899999999999999, -9.7, -4.300000000000001, -22.5, -12.899999999999999, -18.299999999999997, -6.300000000000001, -9.3, -6.300000000000001, -31.1, -3.4, -22.4, -9.6, -21.200000000000003, -8.6, -24.500000000000007, -4.300000000000001, -17.5, -11.499999999999998, -9.2, -16.9, -2.4000000000000004, -19.900000000000006, -16.699999999999996, -20.7, -24.400000000000002, -8.799999999999999, -3.4, -9.5, -3.4, -18.4, -6.2, -77.2, -13.899999999999999, -15.7, -18.099999999999994, -4.700000000000001, -5.300000000000001, -129.1999999999999, -13.3, -6.300000000000001, -4.2, -7.099999999999998, -16.699999999999996, -16.799999999999997, -17.7, -20.999999999999996, -7.1, -28.300000000000004, -22.1, -14.799999999999999, -19.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0714426473633571, "mean_inference_ms": 1.421176645932154, "mean_action_processing_ms": 0.07677751965615308, "mean_env_wait_ms": 6.473089857243931, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2160000, "timesteps_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"sample_time_ms": 20572.474, "sample_throughput": 194.435, "load_time_ms": 0.443, "load_throughput": 9029232.011, "learn_time_ms": 10554.126, "learn_throughput": 378.999, "update_time_ms": 1.965}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 1.0621230748547141, "policy_loss": -0.025098095286727674, "vf_loss": 108.56763653216824, "vf_explained_var": 0.05550703124333453, "kl": 0.015448270890389288, "entropy": 0.2711058451603818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2160000, "num_agent_steps_sampled": 2160000, "num_steps_trained": 2160000, "num_agent_steps_trained": 2160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21760, "training_iteration": 540, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-58-39", "timestamp": 1643705919, "time_this_iter_s": 20.689597129821777, "time_total_s": 14949.518408298492, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2690.0095312595367, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 30.610344827586204, "ram_util_percent": 56.5}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -157.6, "episode_reward_mean": -15.930999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -4.300000000000001, -5.4, -5.4, -23.099999999999998, -16.3, -4.300000000000001, -15.3, -15.899999999999999, -9.7, -4.300000000000001, -22.5, -12.899999999999999, -18.299999999999997, -6.300000000000001, -9.3, -6.300000000000001, -31.1, -3.4, -22.4, -9.6, -21.200000000000003, -8.6, -24.500000000000007, -4.300000000000001, -17.5, -11.499999999999998, -9.2, -16.9, -2.4000000000000004, -19.900000000000006, -16.699999999999996, -20.7, -24.400000000000002, -8.799999999999999, -3.4, -9.5, -3.4, -18.4, -6.2, -77.2, -13.899999999999999, -15.7, -18.099999999999994, -4.700000000000001, -5.300000000000001, -129.1999999999999, -13.3, -6.300000000000001, -4.2, -7.099999999999998, -16.699999999999996, -16.799999999999997, -17.7, -20.999999999999996, -7.1, -28.300000000000004, -22.1, -14.799999999999999, -19.2, -9.199999999999998, -26.7, -7.300000000000001, -5.300000000000001, -21.700000000000003, -157.6, -11.699999999999998, -9.3, -16.9, -17.7, -24.3, -12.3, -4.3, -12.699999999999998, -3.3, -12.5, -5.4, -10.6, -9.899999999999999, -9.6, -12.699999999999998, -4.300000000000001, -24.8, -4.4, -39.2, -4.1, -6.899999999999999, -16.199999999999996, -4.3, -7.4, -18.2, -5.1000000000000005, -7.300000000000001, -11.199999999999998, -27.500000000000043, -3.3, -11.299999999999999, -15.399999999999997, -4.300000000000001, -17.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0718472041420575, "mean_inference_ms": 1.4216783860739775, "mean_action_processing_ms": 0.0768050603343531, "mean_env_wait_ms": 6.475670700477728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2164000, "timesteps_this_iter": 0, "agent_timesteps_total": 2164000, "timers": {"sample_time_ms": 20601.658, "sample_throughput": 194.159, "load_time_ms": 0.443, "load_throughput": 9023889.845, "learn_time_ms": 10549.88, "learn_throughput": 379.151, "update_time_ms": 1.961}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.9731263466111775, "policy_loss": -0.020830636016613936, "vf_loss": 99.25346473173428, "vf_explained_var": -0.06235606708834248, "kl": 0.014223617709298876, "entropy": 0.27202281621835567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2164000, "num_agent_steps_sampled": 2164000, "num_steps_trained": 2164000, "num_agent_steps_trained": 2164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21800, "training_iteration": 541, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-58-59", "timestamp": 1643705939, "time_this_iter_s": 20.2601900100708, "time_total_s": 14969.778598308563, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2710.2697212696075, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 27.086206896551722, "ram_util_percent": 56.531034482758606}}
{"episode_reward_max": -3.3, "episode_reward_min": -157.6, "episode_reward_mean": -15.785, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-77.2, -13.899999999999999, -15.7, -18.099999999999994, -4.700000000000001, -5.300000000000001, -129.1999999999999, -13.3, -6.300000000000001, -4.2, -7.099999999999998, -16.699999999999996, -16.799999999999997, -17.7, -20.999999999999996, -7.1, -28.300000000000004, -22.1, -14.799999999999999, -19.2, -9.199999999999998, -26.7, -7.300000000000001, -5.300000000000001, -21.700000000000003, -157.6, -11.699999999999998, -9.3, -16.9, -17.7, -24.3, -12.3, -4.3, -12.699999999999998, -3.3, -12.5, -5.4, -10.6, -9.899999999999999, -9.6, -12.699999999999998, -4.300000000000001, -24.8, -4.4, -39.2, -4.1, -6.899999999999999, -16.199999999999996, -4.3, -7.4, -18.2, -5.1000000000000005, -7.300000000000001, -11.199999999999998, -27.500000000000043, -3.3, -11.299999999999999, -15.399999999999997, -4.300000000000001, -17.299999999999997, -3.4, -10.6, -27.69999999999997, -10.7, -10.8, -5.300000000000001, -5.300000000000001, -15.999999999999998, -5.4, -4.4, -10.999999999999998, -13.899999999999999, -11.2, -3.3, -5.2, -7.999999999999997, -20.800000000000004, -10.799999999999999, -12.3, -17.7, -3.3, -12.7, -17.0, -6.300000000000001, -12.599999999999996, -22.4, -12.299999999999999, -34.2, -5.300000000000001, -17.500000000000004, -13.899999999999997, -14.899999999999999, -17.3, -20.30000000000001, -10.399999999999999, -13.099999999999998, -4.300000000000001, -6.9, -4.300000000000001, -23.500000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0727097718882157, "mean_inference_ms": 1.4229989357581838, "mean_action_processing_ms": 0.07688066403632295, "mean_env_wait_ms": 6.482505565997626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2168000, "timesteps_this_iter": 0, "agent_timesteps_total": 2168000, "timers": {"sample_time_ms": 20727.64, "sample_throughput": 192.979, "load_time_ms": 0.446, "load_throughput": 8967936.712, "learn_time_ms": 10706.058, "learn_throughput": 373.62, "update_time_ms": 2.073}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.11236616867263952, "policy_loss": -0.012540900864468147, "vf_loss": 12.394807703136117, "vf_explained_var": 0.25733952682505373, "kl": 0.009589952165772221, "entropy": 0.24058503579067927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2168000, "num_agent_steps_sampled": 2168000, "num_steps_trained": 2168000, "num_agent_steps_trained": 2168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21840, "training_iteration": 542, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-59-24", "timestamp": 1643705964, "time_this_iter_s": 24.560009002685547, "time_total_s": 14994.338607311249, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2734.829730272293, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 36.04571428571428, "ram_util_percent": 56.77428571428572}}
{"episode_reward_max": -3.3, "episode_reward_min": -46.2, "episode_reward_mean": -13.349, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.699999999999998, -4.300000000000001, -24.8, -4.4, -39.2, -4.1, -6.899999999999999, -16.199999999999996, -4.3, -7.4, -18.2, -5.1000000000000005, -7.300000000000001, -11.199999999999998, -27.500000000000043, -3.3, -11.299999999999999, -15.399999999999997, -4.300000000000001, -17.299999999999997, -3.4, -10.6, -27.69999999999997, -10.7, -10.8, -5.300000000000001, -5.300000000000001, -15.999999999999998, -5.4, -4.4, -10.999999999999998, -13.899999999999999, -11.2, -3.3, -5.2, -7.999999999999997, -20.800000000000004, -10.799999999999999, -12.3, -17.7, -3.3, -12.7, -17.0, -6.300000000000001, -12.599999999999996, -22.4, -12.299999999999999, -34.2, -5.300000000000001, -17.500000000000004, -13.899999999999997, -14.899999999999999, -17.3, -20.30000000000001, -10.399999999999999, -13.099999999999998, -4.300000000000001, -6.9, -4.300000000000001, -23.500000000000004, -15.5, -5.2, -14.399999999999997, -37.3, -46.2, -38.3, -4.2, -19.799999999999997, -15.199999999999996, -9.799999999999997, -10.3, -22.1, -10.7, -16.5, -9.9, -27.3, -8.600000000000001, -4.4, -21.6, -4.4, -5.4, -9.799999999999997, -15.2, -8.3, -9.3, -10.5, -33.2, -9.799999999999999, -5.9, -9.3, -13.099999999999989, -22.2, -6.300000000000001, -38.300000000000004, -9.8, -17.0, -4.4, -5.2, -22.3, -6.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.074309037311983, "mean_inference_ms": 1.425721944987057, "mean_action_processing_ms": 0.07703039636006219, "mean_env_wait_ms": 6.495830125400385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2172000, "timesteps_this_iter": 0, "agent_timesteps_total": 2172000, "timers": {"sample_time_ms": 21206.544, "sample_throughput": 188.621, "load_time_ms": 0.453, "load_throughput": 8820828.601, "learn_time_ms": 10879.763, "learn_throughput": 367.655, "update_time_ms": 2.095}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.22180425699760195, "policy_loss": -0.024808295418117795, "vf_loss": 24.529619643444654, "vf_explained_var": -0.004918957653866019, "kl": 0.013163600453777902, "entropy": 0.2794312165709593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2172000, "num_agent_steps_sampled": 2172000, "num_steps_trained": 2172000, "num_agent_steps_trained": 2172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21880, "training_iteration": 543, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_08-59-49", "timestamp": 1643705989, "time_this_iter_s": 25.410218000411987, "time_total_s": 15019.74882531166, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2760.239948272705, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 44.17499999999999, "ram_util_percent": 56.766666666666666}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -46.2, "episode_reward_mean": -13.803999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -12.7, -17.0, -6.300000000000001, -12.599999999999996, -22.4, -12.299999999999999, -34.2, -5.300000000000001, -17.500000000000004, -13.899999999999997, -14.899999999999999, -17.3, -20.30000000000001, -10.399999999999999, -13.099999999999998, -4.300000000000001, -6.9, -4.300000000000001, -23.500000000000004, -15.5, -5.2, -14.399999999999997, -37.3, -46.2, -38.3, -4.2, -19.799999999999997, -15.199999999999996, -9.799999999999997, -10.3, -22.1, -10.7, -16.5, -9.9, -27.3, -8.600000000000001, -4.4, -21.6, -4.4, -5.4, -9.799999999999997, -15.2, -8.3, -9.3, -10.5, -33.2, -9.799999999999999, -5.9, -9.3, -13.099999999999989, -22.2, -6.300000000000001, -38.300000000000004, -9.8, -17.0, -4.4, -5.2, -22.3, -6.399999999999999, -41.4, -16.4, -4.2, -5.300000000000001, -4.300000000000001, -15.699999999999996, -4.4, -6.800000000000001, -14.5, -11.599999999999989, -11.700000000000001, -9.100000000000001, -7.300000000000001, -45.2, -6.4, -5.300000000000001, -13.999999999999998, -7.499999999999999, -3.2, -4.6, -21.4, -7.699999999999999, -9.5, -3.2, -15.1, -3.1, -15.899999999999993, -13.7, -13.199999999999998, -9.2, -8.4, -17.0, -13.399999999999999, -8.4, -15.899999999999999, -8.2, -19.3, -37.3, -23.1, -2.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0759530192781965, "mean_inference_ms": 1.4284302398991415, "mean_action_processing_ms": 0.07717827252044879, "mean_env_wait_ms": 6.508857189717028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2176000, "timesteps_this_iter": 0, "agent_timesteps_total": 2176000, "timers": {"sample_time_ms": 21506.967, "sample_throughput": 185.986, "load_time_ms": 0.457, "load_throughput": 8759576.046, "learn_time_ms": 10917.571, "learn_throughput": 366.382, "update_time_ms": 2.077}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1705232064254702, "policy_loss": -0.017668951281111046, "vf_loss": 18.716989404924455, "vf_explained_var": -0.0018447809321905978, "kl": 0.01022266107893089, "entropy": 0.26435347486247296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2176000, "num_agent_steps_sampled": 2176000, "num_steps_trained": 2176000, "num_agent_steps_trained": 2176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21920, "training_iteration": 544, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-00-11", "timestamp": 1643706011, "time_this_iter_s": 21.981800317764282, "time_total_s": 15041.730625629425, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2782.2217485904694, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 33.0875, "ram_util_percent": 56.615625}}
{"episode_reward_max": -2.3, "episode_reward_min": -45.2, "episode_reward_mean": -11.711999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -9.799999999999997, -15.2, -8.3, -9.3, -10.5, -33.2, -9.799999999999999, -5.9, -9.3, -13.099999999999989, -22.2, -6.300000000000001, -38.300000000000004, -9.8, -17.0, -4.4, -5.2, -22.3, -6.399999999999999, -41.4, -16.4, -4.2, -5.300000000000001, -4.300000000000001, -15.699999999999996, -4.4, -6.800000000000001, -14.5, -11.599999999999989, -11.700000000000001, -9.100000000000001, -7.300000000000001, -45.2, -6.4, -5.300000000000001, -13.999999999999998, -7.499999999999999, -3.2, -4.6, -21.4, -7.699999999999999, -9.5, -3.2, -15.1, -3.1, -15.899999999999993, -13.7, -13.199999999999998, -9.2, -8.4, -17.0, -13.399999999999999, -8.4, -15.899999999999999, -8.2, -19.3, -37.3, -23.1, -2.6000000000000005, -8.5, -3.3, -4.9, -19.1, -5.300000000000001, -4.3, -6.999999999999999, -3.8000000000000003, -21.6, -5.300000000000001, -20.9, -17.499999999999996, -30.3, -5.300000000000001, -3.3, -12.6, -16.599999999999998, -9.299999999999999, -8.100000000000001, -14.2, -4.300000000000001, -15.2, -28.500000000000007, -7.4, -3.3, -3.4, -12.799999999999999, -4.300000000000001, -4.300000000000001, -13.699999999999998, -12.2, -17.4, -10.999999999999998, -2.7, -5.999999999999998, -4.3, -8.3, -9.100000000000001, -13.299999999999995, -2.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0771768293634454, "mean_inference_ms": 1.43005709334761, "mean_action_processing_ms": 0.07726846587539592, "mean_env_wait_ms": 6.516453236548075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2180000, "timesteps_this_iter": 0, "agent_timesteps_total": 2180000, "timers": {"sample_time_ms": 21566.474, "sample_throughput": 185.473, "load_time_ms": 0.457, "load_throughput": 8762320.99, "learn_time_ms": 10945.923, "learn_throughput": 365.433, "update_time_ms": 2.085}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.09159821285665916, "policy_loss": -0.014928392517150089, "vf_loss": 10.477823485610305, "vf_explained_var": 0.21536901932890698, "kl": 0.017483727068084688, "entropy": 0.23878660640649257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2180000, "num_agent_steps_sampled": 2180000, "num_steps_trained": 2180000, "num_agent_steps_trained": 2180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 21960, "training_iteration": 545, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-00-32", "timestamp": 1643706032, "time_this_iter_s": 20.647681951522827, "time_total_s": 15062.378307580948, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2802.869430541992, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 31.344827586206897, "ram_util_percent": 56.58620689655172}}
{"episode_reward_max": -2.3, "episode_reward_min": -73.29999999999997, "episode_reward_mean": -12.652000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.4, -7.699999999999999, -9.5, -3.2, -15.1, -3.1, -15.899999999999993, -13.7, -13.199999999999998, -9.2, -8.4, -17.0, -13.399999999999999, -8.4, -15.899999999999999, -8.2, -19.3, -37.3, -23.1, -2.6000000000000005, -8.5, -3.3, -4.9, -19.1, -5.300000000000001, -4.3, -6.999999999999999, -3.8000000000000003, -21.6, -5.300000000000001, -20.9, -17.499999999999996, -30.3, -5.300000000000001, -3.3, -12.6, -16.599999999999998, -9.299999999999999, -8.100000000000001, -14.2, -4.300000000000001, -15.2, -28.500000000000007, -7.4, -3.3, -3.4, -12.799999999999999, -4.300000000000001, -4.300000000000001, -13.699999999999998, -12.2, -17.4, -10.999999999999998, -2.7, -5.999999999999998, -4.3, -8.3, -9.100000000000001, -13.299999999999995, -2.3, -14.9, -27.2, -9.2, -7.300000000000001, -5.4, -31.5, -23.500000000000007, -10.1, -15.7, -7.299999999999999, -25.300000000000004, -2.5, -8.3, -9.499999999999998, -4.300000000000001, -27.200000000000003, -2.3000000000000003, -13.299999999999995, -18.9, -10.799999999999999, -4.3, -13.999999999999996, -3.2, -17.1, -23.3, -18.099999999999998, -73.29999999999997, -11.999999999999998, -10.2, -5.2, -12.099999999999998, -4.300000000000001, -7.699999999999998, -6.300000000000001, -19.0, -67.80000000000005, -4.700000000000001, -9.5, -3.6000000000000005, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.077949808553186, "mean_inference_ms": 1.4308041325655227, "mean_action_processing_ms": 0.07731063188480113, "mean_env_wait_ms": 6.519793478886477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2184000, "timesteps_this_iter": 0, "agent_timesteps_total": 2184000, "timers": {"sample_time_ms": 21592.688, "sample_throughput": 185.248, "load_time_ms": 0.457, "load_throughput": 8762320.99, "learn_time_ms": 10972.166, "learn_throughput": 364.559, "update_time_ms": 2.072}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.38903765974626425, "policy_loss": -0.02396822297965647, "vf_loss": 41.165322130694186, "vf_explained_var": -0.20043772106529564, "kl": 0.013526724085577108, "entropy": 0.25971923923139933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2184000, "num_agent_steps_sampled": 2184000, "num_steps_trained": 2184000, "num_agent_steps_trained": 2184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22000, "training_iteration": 546, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-00-52", "timestamp": 1643706052, "time_this_iter_s": 20.706373929977417, "time_total_s": 15083.084681510925, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2823.5758044719696, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 31.855172413793106, "ram_util_percent": 56.6896551724138}}
{"episode_reward_max": -2.3, "episode_reward_min": -91.3, "episode_reward_mean": -13.676000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -15.2, -28.500000000000007, -7.4, -3.3, -3.4, -12.799999999999999, -4.300000000000001, -4.300000000000001, -13.699999999999998, -12.2, -17.4, -10.999999999999998, -2.7, -5.999999999999998, -4.3, -8.3, -9.100000000000001, -13.299999999999995, -2.3, -14.9, -27.2, -9.2, -7.300000000000001, -5.4, -31.5, -23.500000000000007, -10.1, -15.7, -7.299999999999999, -25.300000000000004, -2.5, -8.3, -9.499999999999998, -4.300000000000001, -27.200000000000003, -2.3000000000000003, -13.299999999999995, -18.9, -10.799999999999999, -4.3, -13.999999999999996, -3.2, -17.1, -23.3, -18.099999999999998, -73.29999999999997, -11.999999999999998, -10.2, -5.2, -12.099999999999998, -4.300000000000001, -7.699999999999998, -6.300000000000001, -19.0, -67.80000000000005, -4.700000000000001, -9.5, -3.6000000000000005, -4.4, -4.4, -3.3, -4.4, -14.999999999999982, -4.4, -88.4, -18.7, -14.2, -3.4, -24.899999999999974, -3.3, -11.199999999999976, -8.599999999999998, -14.799999999999997, -28.2, -7.4, -17.6, -7.4, -5.300000000000001, -19.799999999999997, -11.799999999999999, -5.4, -91.3, -6.899999999999999, -3.2, -11.999999999999998, -3.4, -20.4, -8.499999999999996, -4.2, -5.2, -17.6, -3.3, -16.699999999999996, -5.3, -15.7, -4.2, -24.700000000000003, -17.4, -7.299999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0783233469706577, "mean_inference_ms": 1.43126399166607, "mean_action_processing_ms": 0.0773365344586315, "mean_env_wait_ms": 6.5220560302429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2188000, "timesteps_this_iter": 0, "agent_timesteps_total": 2188000, "timers": {"sample_time_ms": 21615.064, "sample_throughput": 185.056, "load_time_ms": 0.456, "load_throughput": 8770107.684, "learn_time_ms": 10934.842, "learn_throughput": 365.803, "update_time_ms": 2.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.7978569590020925, "policy_loss": -0.012172866748866215, "vf_loss": 80.91653085549673, "vf_explained_var": -0.023525623736842985, "kl": 0.008645359079827821, "entropy": 0.22046000462786486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2188000, "num_agent_steps_sampled": 2188000, "num_steps_trained": 2188000, "num_agent_steps_trained": 2188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22040, "training_iteration": 547, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-01-13", "timestamp": 1643706073, "time_this_iter_s": 20.320708990097046, "time_total_s": 15103.405390501022, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2843.8965134620667, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 32.36206896551724, "ram_util_percent": 56.603448275862064}}
{"episode_reward_max": -3.2, "episode_reward_min": -91.3, "episode_reward_mean": -13.574000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -13.999999999999996, -3.2, -17.1, -23.3, -18.099999999999998, -73.29999999999997, -11.999999999999998, -10.2, -5.2, -12.099999999999998, -4.300000000000001, -7.699999999999998, -6.300000000000001, -19.0, -67.80000000000005, -4.700000000000001, -9.5, -3.6000000000000005, -4.4, -4.4, -3.3, -4.4, -14.999999999999982, -4.4, -88.4, -18.7, -14.2, -3.4, -24.899999999999974, -3.3, -11.199999999999976, -8.599999999999998, -14.799999999999997, -28.2, -7.4, -17.6, -7.4, -5.300000000000001, -19.799999999999997, -11.799999999999999, -5.4, -91.3, -6.899999999999999, -3.2, -11.999999999999998, -3.4, -20.4, -8.499999999999996, -4.2, -5.2, -17.6, -3.3, -16.699999999999996, -5.3, -15.7, -4.2, -24.700000000000003, -17.4, -7.299999999999998, -7.300000000000001, -18.5, -9.6, -11.9, -11.1, -7.999999999999997, -6.0, -12.399999999999999, -5.4, -11.2, -5.800000000000001, -10.2, -6.3, -9.100000000000001, -9.5, -18.0, -7.300000000000001, -16.7, -14.099999999999998, -9.3, -7.299999999999999, -18.699999999999996, -11.799999999999994, -25.200000000000003, -9.2, -10.899999999999999, -22.700000000000006, -17.900000000000006, -6.300000000000001, -8.0, -11.2, -4.800000000000001, -15.899999999999997, -8.4, -10.3, -8.899999999999999, -5.300000000000001, -19.400000000000006, -13.899999999999999, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0786456683390584, "mean_inference_ms": 1.4316397095305626, "mean_action_processing_ms": 0.07735894561180301, "mean_env_wait_ms": 6.52406080678339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2192000, "timesteps_this_iter": 0, "agent_timesteps_total": 2192000, "timers": {"sample_time_ms": 21600.501, "sample_throughput": 185.181, "load_time_ms": 0.457, "load_throughput": 8751351.521, "learn_time_ms": 10951.58, "learn_throughput": 365.244, "update_time_ms": 2.047}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.09222469688443247, "policy_loss": -0.016360628391586005, "vf_loss": 10.69081602942559, "vf_explained_var": 0.17663224691985757, "kl": 0.016771681851381226, "entropy": 0.25229635282710033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2192000, "num_agent_steps_sampled": 2192000, "num_steps_trained": 2192000, "num_agent_steps_trained": 2192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22080, "training_iteration": 548, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-01-34", "timestamp": 1643706094, "time_this_iter_s": 20.701127767562866, "time_total_s": 15124.106518268585, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2864.5976412296295, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 34.13666666666666, "ram_util_percent": 56.59333333333332}}
{"episode_reward_max": -3.2, "episode_reward_min": -91.3, "episode_reward_mean": -11.979, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.799999999999999, -5.4, -91.3, -6.899999999999999, -3.2, -11.999999999999998, -3.4, -20.4, -8.499999999999996, -4.2, -5.2, -17.6, -3.3, -16.699999999999996, -5.3, -15.7, -4.2, -24.700000000000003, -17.4, -7.299999999999998, -7.300000000000001, -18.5, -9.6, -11.9, -11.1, -7.999999999999997, -6.0, -12.399999999999999, -5.4, -11.2, -5.800000000000001, -10.2, -6.3, -9.100000000000001, -9.5, -18.0, -7.300000000000001, -16.7, -14.099999999999998, -9.3, -7.299999999999999, -18.699999999999996, -11.799999999999994, -25.200000000000003, -9.2, -10.899999999999999, -22.700000000000006, -17.900000000000006, -6.300000000000001, -8.0, -11.2, -4.800000000000001, -15.899999999999997, -8.4, -10.3, -8.899999999999999, -5.300000000000001, -19.400000000000006, -13.899999999999999, -4.3, -30.29999999999997, -6.2, -6.3, -15.1, -4.4, -18.6, -6.4, -4.4, -19.5, -10.8, -13.899999999999993, -15.799999999999999, -5.3, -10.499999999999998, -23.699999999999996, -15.099999999999998, -10.399999999999999, -4.4, -6.3, -10.899999999999999, -9.6, -3.3, -8.4, -29.4, -18.2, -14.3, -5.300000000000001, -21.5, -12.099999999999996, -11.999999999999998, -5.300000000000001, -17.599999999999994, -6.0, -7.2, -9.1, -8.5, -7.300000000000001, -9.9, -16.7, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0791238984880487, "mean_inference_ms": 1.4319833693670654, "mean_action_processing_ms": 0.07737943172182667, "mean_env_wait_ms": 6.525875918592574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2196000, "timesteps_this_iter": 0, "agent_timesteps_total": 2196000, "timers": {"sample_time_ms": 21602.841, "sample_throughput": 185.161, "load_time_ms": 0.458, "load_throughput": 8728132.348, "learn_time_ms": 10933.598, "learn_throughput": 365.845, "update_time_ms": 2.06}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.10571713531565081, "policy_loss": -0.017073893824452034, "vf_loss": 12.183658300804835, "vf_explained_var": 0.20875649176618105, "kl": 0.009544488223951904, "entropy": 0.23806339298044482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2196000, "num_agent_steps_sampled": 2196000, "num_steps_trained": 2196000, "num_agent_steps_trained": 2196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22120, "training_iteration": 549, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-01-54", "timestamp": 1643706114, "time_this_iter_s": 20.182410955429077, "time_total_s": 15144.288929224014, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2884.7800521850586, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 31.721428571428568, "ram_util_percent": 56.61071428571428}}
{"episode_reward_max": -2.5, "episode_reward_min": -55.800000000000026, "episode_reward_mean": -11.292, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.299999999999999, -18.699999999999996, -11.799999999999994, -25.200000000000003, -9.2, -10.899999999999999, -22.700000000000006, -17.900000000000006, -6.300000000000001, -8.0, -11.2, -4.800000000000001, -15.899999999999997, -8.4, -10.3, -8.899999999999999, -5.300000000000001, -19.400000000000006, -13.899999999999999, -4.3, -30.29999999999997, -6.2, -6.3, -15.1, -4.4, -18.6, -6.4, -4.4, -19.5, -10.8, -13.899999999999993, -15.799999999999999, -5.3, -10.499999999999998, -23.699999999999996, -15.099999999999998, -10.399999999999999, -4.4, -6.3, -10.899999999999999, -9.6, -3.3, -8.4, -29.4, -18.2, -14.3, -5.300000000000001, -21.5, -12.099999999999996, -11.999999999999998, -5.300000000000001, -17.599999999999994, -6.0, -7.2, -9.1, -8.5, -7.300000000000001, -9.9, -16.7, -5.300000000000001, -12.7, -5.199999999999999, -8.2, -6.300000000000001, -4.300000000000001, -12.299999999999999, -2.5, -6.299999999999999, -9.499999999999998, -8.3, -9.2, -18.0, -6.5, -9.200000000000001, -8.699999999999998, -4.3, -11.399999999999999, -4.2, -12.599999999999994, -8.399999999999999, -5.4, -6.300000000000001, -13.399999999999999, -4.300000000000001, -9.2, -7.4, -7.2, -11.899999999999999, -29.300000000000015, -14.099999999999998, -13.699999999999996, -7.6, -6.300000000000001, -55.800000000000026, -10.6, -4.0, -12.799999999999999, -7.300000000000001, -17.400000000000006, -11.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.079816347271679, "mean_inference_ms": 1.432459187193104, "mean_action_processing_ms": 0.07740773620803594, "mean_env_wait_ms": 6.528298636992527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2200000, "timesteps_this_iter": 0, "agent_timesteps_total": 2200000, "timers": {"sample_time_ms": 21605.448, "sample_throughput": 185.138, "load_time_ms": 0.46, "load_throughput": 8697815.335, "learn_time_ms": 10931.346, "learn_throughput": 365.92, "update_time_ms": 2.039}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1245599652615486, "policy_loss": -0.013342173551760053, "vf_loss": 13.678619778669008, "vf_explained_var": 0.18197374363099375, "kl": 0.011159450013422376, "entropy": 0.2533600216671344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2200000, "num_agent_steps_sampled": 2200000, "num_steps_trained": 2200000, "num_agent_steps_trained": 2200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22160, "training_iteration": 550, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-02-15", "timestamp": 1643706135, "time_this_iter_s": 20.872242212295532, "time_total_s": 15165.16117143631, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2905.652294397354, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 35.94333333333334, "ram_util_percent": 56.64666666666666}}
{"episode_reward_max": -2.5, "episode_reward_min": -55.800000000000026, "episode_reward_mean": -11.982000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.6, -3.3, -8.4, -29.4, -18.2, -14.3, -5.300000000000001, -21.5, -12.099999999999996, -11.999999999999998, -5.300000000000001, -17.599999999999994, -6.0, -7.2, -9.1, -8.5, -7.300000000000001, -9.9, -16.7, -5.300000000000001, -12.7, -5.199999999999999, -8.2, -6.300000000000001, -4.300000000000001, -12.299999999999999, -2.5, -6.299999999999999, -9.499999999999998, -8.3, -9.2, -18.0, -6.5, -9.200000000000001, -8.699999999999998, -4.3, -11.399999999999999, -4.2, -12.599999999999994, -8.399999999999999, -5.4, -6.300000000000001, -13.399999999999999, -4.300000000000001, -9.2, -7.4, -7.2, -11.899999999999999, -29.300000000000015, -14.099999999999998, -13.699999999999996, -7.6, -6.300000000000001, -55.800000000000026, -10.6, -4.0, -12.799999999999999, -7.300000000000001, -17.400000000000006, -11.399999999999999, -16.299999999999997, -7.3, -17.799999999999997, -6.6000000000000005, -17.799999999999997, -27.2, -14.0, -6.2, -9.499999999999998, -14.299999999999999, -13.799999999999995, -8.799999999999999, -34.2, -12.0, -8.9, -7.3, -20.7, -16.1, -4.300000000000001, -13.5, -13.899999999999995, -16.0, -14.7, -8.2, -23.799999999999997, -6.4, -8.3, -22.0, -10.9, -5.2, -13.899999999999999, -12.1, -8.3, -10.899999999999999, -8.3, -6.2, -25.4, -29.3, -18.6, -8.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.080318396312115, "mean_inference_ms": 1.4329467512628478, "mean_action_processing_ms": 0.07743677720395738, "mean_env_wait_ms": 6.530734903625175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2204000, "timesteps_this_iter": 0, "agent_timesteps_total": 2204000, "timers": {"sample_time_ms": 21603.5, "sample_throughput": 185.155, "load_time_ms": 0.46, "load_throughput": 8695561.314, "learn_time_ms": 10942.729, "learn_throughput": 365.54, "update_time_ms": 2.049}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1489659128630514, "policy_loss": -0.011808369460926262, "vf_loss": 15.95830597595502, "vf_explained_var": 0.2997636423316053, "kl": 0.011912267357480522, "entropy": 0.2624048046927939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2204000, "num_agent_steps_sampled": 2204000, "num_steps_trained": 2204000, "num_agent_steps_trained": 2204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22200, "training_iteration": 551, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-02-35", "timestamp": 1643706155, "time_this_iter_s": 20.37258815765381, "time_total_s": 15185.533759593964, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2926.024882555008, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 30.617241379310347, "ram_util_percent": 56.70000000000002}}
{"episode_reward_max": -3.3, "episode_reward_min": -55.800000000000026, "episode_reward_mean": -13.235999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -6.300000000000001, -13.399999999999999, -4.300000000000001, -9.2, -7.4, -7.2, -11.899999999999999, -29.300000000000015, -14.099999999999998, -13.699999999999996, -7.6, -6.300000000000001, -55.800000000000026, -10.6, -4.0, -12.799999999999999, -7.300000000000001, -17.400000000000006, -11.399999999999999, -16.299999999999997, -7.3, -17.799999999999997, -6.6000000000000005, -17.799999999999997, -27.2, -14.0, -6.2, -9.499999999999998, -14.299999999999999, -13.799999999999995, -8.799999999999999, -34.2, -12.0, -8.9, -7.3, -20.7, -16.1, -4.300000000000001, -13.5, -13.899999999999995, -16.0, -14.7, -8.2, -23.799999999999997, -6.4, -8.3, -22.0, -10.9, -5.2, -13.899999999999999, -12.1, -8.3, -10.899999999999999, -8.3, -6.2, -25.4, -29.3, -18.6, -8.7, -13.1, -6.3, -26.100000000000037, -10.799999999999999, -21.30000000000003, -4.3, -23.5, -5.4, -26.799999999999997, -13.600000000000001, -12.799999999999999, -32.300000000000004, -16.6, -18.3, -4.0, -6.3, -11.3, -5.2, -3.3, -9.2, -6.999999999999999, -5.4, -19.699999999999996, -5.3, -12.2, -11.59999999999998, -6.3, -6.8, -14.399999999999997, -10.2, -15.499999999999998, -9.3, -29.2, -17.8, -6.4, -5.4, -6.3, -9.599999999999998, -40.3, -11.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0807099215979339, "mean_inference_ms": 1.4333676288092463, "mean_action_processing_ms": 0.07746039822701924, "mean_env_wait_ms": 6.532898804929882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2208000, "timesteps_this_iter": 0, "agent_timesteps_total": 2208000, "timers": {"sample_time_ms": 21405.13, "sample_throughput": 186.871, "load_time_ms": 0.456, "load_throughput": 8776071.559, "learn_time_ms": 10735.992, "learn_throughput": 372.579, "update_time_ms": 1.94}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.15727583705798112, "policy_loss": -0.018145822467763098, "vf_loss": 17.426658822900507, "vf_explained_var": 0.26212024413129337, "kl": 0.011550781287951926, "entropy": 0.22868221507918451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2208000, "num_agent_steps_sampled": 2208000, "num_steps_trained": 2208000, "num_agent_steps_trained": 2208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22240, "training_iteration": 552, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-02-56", "timestamp": 1643706176, "time_this_iter_s": 20.392065048217773, "time_total_s": 15205.925824642181, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2946.4169476032257, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 35.393103448275866, "ram_util_percent": 56.71034482758621}}
{"episode_reward_max": -3.3, "episode_reward_min": -40.3, "episode_reward_mean": -12.890999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.899999999999995, -16.0, -14.7, -8.2, -23.799999999999997, -6.4, -8.3, -22.0, -10.9, -5.2, -13.899999999999999, -12.1, -8.3, -10.899999999999999, -8.3, -6.2, -25.4, -29.3, -18.6, -8.7, -13.1, -6.3, -26.100000000000037, -10.799999999999999, -21.30000000000003, -4.3, -23.5, -5.4, -26.799999999999997, -13.600000000000001, -12.799999999999999, -32.300000000000004, -16.6, -18.3, -4.0, -6.3, -11.3, -5.2, -3.3, -9.2, -6.999999999999999, -5.4, -19.699999999999996, -5.3, -12.2, -11.59999999999998, -6.3, -6.8, -14.399999999999997, -10.2, -15.499999999999998, -9.3, -29.2, -17.8, -6.4, -5.4, -6.3, -9.599999999999998, -40.3, -11.299999999999999, -9.1, -15.5, -5.999999999999999, -5.3, -6.3, -3.3, -16.9, -10.7, -4.3, -19.299999999999997, -3.3, -19.099999999999998, -23.7, -13.7, -26.9, -8.6, -11.699999999999998, -8.2, -6.3, -7.300000000000001, -10.1, -9.2, -15.899999999999999, -10.900000000000002, -17.400000000000002, -21.6, -24.3, -8.3, -3.3, -8.3, -16.2, -5.4, -21.400000000000006, -19.10000000000001, -7.599999999999998, -8.700000000000001, -16.3, -11.899999999999999, -14.799999999999999, -21.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.08106288700077, "mean_inference_ms": 1.4336800534344536, "mean_action_processing_ms": 0.07747771353639611, "mean_env_wait_ms": 6.534220789531796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2212000, "timesteps_this_iter": 0, "agent_timesteps_total": 2212000, "timers": {"sample_time_ms": 20855.16, "sample_throughput": 191.799, "load_time_ms": 0.449, "load_throughput": 8917884.442, "learn_time_ms": 10536.453, "learn_throughput": 379.634, "update_time_ms": 1.901}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.09782019304061529, "policy_loss": -0.017275926354591565, "vf_loss": 11.427003881944124, "vf_explained_var": 0.23473386732480858, "kl": 0.008260836195696113, "entropy": 0.21426859377853333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2212000, "num_agent_steps_sampled": 2212000, "num_steps_trained": 2212000, "num_agent_steps_trained": 2212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22280, "training_iteration": 553, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-03-16", "timestamp": 1643706196, "time_this_iter_s": 19.995535850524902, "time_total_s": 15225.921360492706, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2966.4124834537506, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 32.84285714285714, "ram_util_percent": 56.79999999999999}}
{"episode_reward_max": -3.3, "episode_reward_min": -50.700000000000074, "episode_reward_mean": -12.337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999999, -5.4, -19.699999999999996, -5.3, -12.2, -11.59999999999998, -6.3, -6.8, -14.399999999999997, -10.2, -15.499999999999998, -9.3, -29.2, -17.8, -6.4, -5.4, -6.3, -9.599999999999998, -40.3, -11.299999999999999, -9.1, -15.5, -5.999999999999999, -5.3, -6.3, -3.3, -16.9, -10.7, -4.3, -19.299999999999997, -3.3, -19.099999999999998, -23.7, -13.7, -26.9, -8.6, -11.699999999999998, -8.2, -6.3, -7.300000000000001, -10.1, -9.2, -15.899999999999999, -10.900000000000002, -17.400000000000002, -21.6, -24.3, -8.3, -3.3, -8.3, -16.2, -5.4, -21.400000000000006, -19.10000000000001, -7.599999999999998, -8.700000000000001, -16.3, -11.899999999999999, -14.799999999999999, -21.300000000000004, -4.3, -15.199999999999998, -11.3, -50.700000000000074, -13.799999999999999, -10.1, -4.300000000000001, -17.1, -12.0, -4.2, -6.300000000000001, -18.00000000000001, -28.3, -9.6, -5.4, -12.4, -18.5, -18.3, -4.2, -4.4, -3.3, -13.399999999999972, -4.1000000000000005, -23.799999999999997, -16.5, -6.2, -17.7, -10.1, -15.299999999999992, -4.2, -3.3, -8.4, -5.3, -17.099999999999994, -9.2, -11.6, -11.2, -7.3, -18.200000000000003, -11.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0817709356197198, "mean_inference_ms": 1.4339666362025565, "mean_action_processing_ms": 0.07749335637271573, "mean_env_wait_ms": 6.535550986666035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2216000, "timesteps_this_iter": 0, "agent_timesteps_total": 2216000, "timers": {"sample_time_ms": 20538.438, "sample_throughput": 194.757, "load_time_ms": 0.445, "load_throughput": 8990041.796, "learn_time_ms": 10541.232, "learn_throughput": 379.462, "update_time_ms": 1.913}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.13675333915368443, "policy_loss": -0.015356036546009201, "vf_loss": 15.093995675797103, "vf_explained_var": 0.32291555814845585, "kl": 0.011694191446786894, "entropy": 0.20582398688921363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2216000, "num_agent_steps_sampled": 2216000, "num_steps_trained": 2216000, "num_agent_steps_trained": 2216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22320, "training_iteration": 554, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-03-36", "timestamp": 1643706216, "time_this_iter_s": 20.865024089813232, "time_total_s": 15246.78638458252, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2987.277507543564, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 32.486666666666665, "ram_util_percent": 56.79999999999998}}
{"episode_reward_max": -2.5, "episode_reward_min": -50.700000000000074, "episode_reward_mean": -11.911000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -9.2, -15.899999999999999, -10.900000000000002, -17.400000000000002, -21.6, -24.3, -8.3, -3.3, -8.3, -16.2, -5.4, -21.400000000000006, -19.10000000000001, -7.599999999999998, -8.700000000000001, -16.3, -11.899999999999999, -14.799999999999999, -21.300000000000004, -4.3, -15.199999999999998, -11.3, -50.700000000000074, -13.799999999999999, -10.1, -4.300000000000001, -17.1, -12.0, -4.2, -6.300000000000001, -18.00000000000001, -28.3, -9.6, -5.4, -12.4, -18.5, -18.3, -4.2, -4.4, -3.3, -13.399999999999972, -4.1000000000000005, -23.799999999999997, -16.5, -6.2, -17.7, -10.1, -15.299999999999992, -4.2, -3.3, -8.4, -5.3, -17.099999999999994, -9.2, -11.6, -11.2, -7.3, -18.200000000000003, -11.599999999999998, -8.7, -12.1, -20.6, -18.3, -4.3, -11.9, -5.300000000000001, -10.0, -7.2, -3.3, -9.7, -18.099999999999998, -4.3, -6.0, -14.5, -6.899999999999998, -18.799999999999997, -12.2, -6.300000000000001, -8.599999999999998, -22.3, -2.5, -16.3, -6.3, -8.399999999999999, -4.3, -4.800000000000001, -6.300000000000001, -30.200000000000045, -5.5, -10.7, -18.5, -12.399999999999999, -19.600000000000005, -14.299999999999995, -4.3, -4.4, -8.2, -13.199999999999998, -13.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0825614844086218, "mean_inference_ms": 1.4343797440069361, "mean_action_processing_ms": 0.07751529227226608, "mean_env_wait_ms": 6.537243315290978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2220000, "timesteps_this_iter": 0, "agent_timesteps_total": 2220000, "timers": {"sample_time_ms": 20539.363, "sample_throughput": 194.748, "load_time_ms": 0.447, "load_throughput": 8943078.891, "learn_time_ms": 10563.68, "learn_throughput": 378.656, "update_time_ms": 1.897}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.08815709437113456, "policy_loss": -0.0114987789307751, "vf_loss": 9.839270560651697, "vf_explained_var": 0.26414514869771977, "kl": 0.012631698103437486, "entropy": 0.2196633052361268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2220000, "num_agent_steps_sampled": 2220000, "num_steps_trained": 2220000, "num_agent_steps_trained": 2220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22360, "training_iteration": 555, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-03-57", "timestamp": 1643706237, "time_this_iter_s": 20.832812070846558, "time_total_s": 15267.619196653366, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3008.1103196144104, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 33.37666666666667, "ram_util_percent": 56.843333333333355}}
{"episode_reward_max": -2.5, "episode_reward_min": -68.40000000000002, "episode_reward_mean": -11.993, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -13.399999999999972, -4.1000000000000005, -23.799999999999997, -16.5, -6.2, -17.7, -10.1, -15.299999999999992, -4.2, -3.3, -8.4, -5.3, -17.099999999999994, -9.2, -11.6, -11.2, -7.3, -18.200000000000003, -11.599999999999998, -8.7, -12.1, -20.6, -18.3, -4.3, -11.9, -5.300000000000001, -10.0, -7.2, -3.3, -9.7, -18.099999999999998, -4.3, -6.0, -14.5, -6.899999999999998, -18.799999999999997, -12.2, -6.300000000000001, -8.599999999999998, -22.3, -2.5, -16.3, -6.3, -8.399999999999999, -4.3, -4.800000000000001, -6.300000000000001, -30.200000000000045, -5.5, -10.7, -18.5, -12.399999999999999, -19.600000000000005, -14.299999999999995, -4.3, -4.4, -8.2, -13.199999999999998, -13.299999999999999, -5.699999999999998, -10.3, -12.599999999999998, -7.6999999999999975, -3.3, -10.999999999999998, -9.2, -10.4, -4.300000000000001, -13.999999999999998, -18.9, -4.3, -5.300000000000001, -40.3, -4.300000000000001, -17.6, -6.599999999999999, -9.3, -13.3, -3.3, -18.200000000000003, -7.199999999999999, -18.299999999999997, -23.3, -5.2, -3.4, -4.2, -68.40000000000002, -12.1, -57.2, -10.600000000000001, -8.3, -13.599999999999998, -5.4, -16.4, -4.4, -13.999999999999998, -17.9, -7.300000000000001, -21.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.083030689790934, "mean_inference_ms": 1.4348813971725047, "mean_action_processing_ms": 0.07754297502488154, "mean_env_wait_ms": 6.539576706615951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2224000, "timesteps_this_iter": 0, "agent_timesteps_total": 2224000, "timers": {"sample_time_ms": 20558.997, "sample_throughput": 194.562, "load_time_ms": 0.447, "load_throughput": 8955490.552, "learn_time_ms": 10479.71, "learn_throughput": 381.69, "update_time_ms": 1.867}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.3035239617456682, "policy_loss": -0.023237853300988032, "vf_loss": 32.55279239403304, "vf_explained_var": 0.05467389008050324, "kl": 0.012338955401815534, "entropy": 0.21439118611235772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2224000, "num_agent_steps_sampled": 2224000, "num_steps_trained": 2224000, "num_agent_steps_trained": 2224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22400, "training_iteration": 556, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-04-17", "timestamp": 1643706257, "time_this_iter_s": 19.83549404144287, "time_total_s": 15287.454690694809, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3027.9458136558533, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 35.99642857142857, "ram_util_percent": 56.896428571428565}}
{"episode_reward_max": -1.4, "episode_reward_min": -68.40000000000002, "episode_reward_mean": -12.886000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.3, -2.5, -16.3, -6.3, -8.399999999999999, -4.3, -4.800000000000001, -6.300000000000001, -30.200000000000045, -5.5, -10.7, -18.5, -12.399999999999999, -19.600000000000005, -14.299999999999995, -4.3, -4.4, -8.2, -13.199999999999998, -13.299999999999999, -5.699999999999998, -10.3, -12.599999999999998, -7.6999999999999975, -3.3, -10.999999999999998, -9.2, -10.4, -4.300000000000001, -13.999999999999998, -18.9, -4.3, -5.300000000000001, -40.3, -4.300000000000001, -17.6, -6.599999999999999, -9.3, -13.3, -3.3, -18.200000000000003, -7.199999999999999, -18.299999999999997, -23.3, -5.2, -3.4, -4.2, -68.40000000000002, -12.1, -57.2, -10.600000000000001, -8.3, -13.599999999999998, -5.4, -16.4, -4.4, -13.999999999999998, -17.9, -7.300000000000001, -21.5, -12.600000000000001, -6.3, -16.9, -1.4, -11.3, -9.3, -17.299999999999997, -23.0, -6.3, -5.3, -18.60000000000001, -14.399999999999999, -18.700000000000003, -3.5000000000000004, -13.4, -5.3, -7.3, -13.899999999999999, -11.399999999999999, -11.3, -3.3, -4.300000000000001, -13.999999999999996, -7.8999999999999995, -9.8, -4.300000000000001, -9.9, -13.899999999999995, -7.9, -16.699999999999996, -42.3, -11.4, -30.2, -17.099999999999998, -22.200000000000003, -5.300000000000001, -21.500000000000004, -7.4, -14.899999999999997, -22.400000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0831591647026293, "mean_inference_ms": 1.4347778498703705, "mean_action_processing_ms": 0.07753854409703957, "mean_env_wait_ms": 6.538651187894478, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2228000, "timesteps_this_iter": 0, "agent_timesteps_total": 2228000, "timers": {"sample_time_ms": 20309.971, "sample_throughput": 196.948, "load_time_ms": 0.433, "load_throughput": 9228391.639, "learn_time_ms": 10206.924, "learn_throughput": 391.891, "update_time_ms": 1.851}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.14042273321394277, "policy_loss": -0.015707279406287657, "vf_loss": 15.48540662257902, "vf_explained_var": 0.17739689625719543, "kl": 0.012759522721346533, "entropy": 0.26233521853723835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2228000, "num_agent_steps_sampled": 2228000, "num_steps_trained": 2228000, "num_agent_steps_trained": 2228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22440, "training_iteration": 557, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-04-33", "timestamp": 1643706273, "time_this_iter_s": 15.95056676864624, "time_total_s": 15303.405257463455, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3043.8963804244995, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 34.34545454545455, "ram_util_percent": 57.0}}
{"episode_reward_max": -1.4, "episode_reward_min": -68.40000000000002, "episode_reward_mean": -13.456999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.200000000000003, -7.199999999999999, -18.299999999999997, -23.3, -5.2, -3.4, -4.2, -68.40000000000002, -12.1, -57.2, -10.600000000000001, -8.3, -13.599999999999998, -5.4, -16.4, -4.4, -13.999999999999998, -17.9, -7.300000000000001, -21.5, -12.600000000000001, -6.3, -16.9, -1.4, -11.3, -9.3, -17.299999999999997, -23.0, -6.3, -5.3, -18.60000000000001, -14.399999999999999, -18.700000000000003, -3.5000000000000004, -13.4, -5.3, -7.3, -13.899999999999999, -11.399999999999999, -11.3, -3.3, -4.300000000000001, -13.999999999999996, -7.8999999999999995, -9.8, -4.300000000000001, -9.9, -13.899999999999995, -7.9, -16.699999999999996, -42.3, -11.4, -30.2, -17.099999999999998, -22.200000000000003, -5.300000000000001, -21.500000000000004, -7.4, -14.899999999999997, -22.400000000000002, -11.3, -15.599999999999998, -34.4, -23.800000000000004, -35.90000000000001, -16.099999999999998, -8.8, -8.999999999999996, -19.500000000000004, -11.9, -12.3, -12.499999999999998, -14.999999999999996, -9.2, -11.5, -20.00000000000001, -3.4, -5.3, -4.4, -11.999999999999998, -7.800000000000001, -8.599999999999998, -16.4, -9.3, -4.300000000000001, -4.300000000000001, -5.2, -32.3, -13.2, -4.4, -4.2, -4.4, -14.399999999999999, -15.799999999999974, -4.700000000000001, -5.1000000000000005, -25.200000000000003, -4.3, -7.1000000000000005, -11.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0828467616323565, "mean_inference_ms": 1.4338531375085717, "mean_action_processing_ms": 0.07748996820496654, "mean_env_wait_ms": 6.533940020030216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2232000, "timesteps_this_iter": 0, "agent_timesteps_total": 2232000, "timers": {"sample_time_ms": 19828.411, "sample_throughput": 201.731, "load_time_ms": 0.423, "load_throughput": 9457280.722, "learn_time_ms": 9945.398, "learn_throughput": 402.196, "update_time_ms": 1.776}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1325996748642415, "policy_loss": -0.014548464179018974, "vf_loss": 14.626668999592463, "vf_explained_var": 0.12073914376638269, "kl": 0.00881456281177762, "entropy": 0.23610271805476757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2232000, "num_agent_steps_sampled": 2232000, "num_steps_trained": 2232000, "num_agent_steps_trained": 2232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22480, "training_iteration": 558, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-04-49", "timestamp": 1643706289, "time_this_iter_s": 15.996187925338745, "time_total_s": 15319.401445388794, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3059.8925683498383, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 31.9304347826087, "ram_util_percent": 57.02173913043478}}
{"episode_reward_max": -3.2, "episode_reward_min": -54.4, "episode_reward_mean": -13.278000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -4.300000000000001, -13.999999999999996, -7.8999999999999995, -9.8, -4.300000000000001, -9.9, -13.899999999999995, -7.9, -16.699999999999996, -42.3, -11.4, -30.2, -17.099999999999998, -22.200000000000003, -5.300000000000001, -21.500000000000004, -7.4, -14.899999999999997, -22.400000000000002, -11.3, -15.599999999999998, -34.4, -23.800000000000004, -35.90000000000001, -16.099999999999998, -8.8, -8.999999999999996, -19.500000000000004, -11.9, -12.3, -12.499999999999998, -14.999999999999996, -9.2, -11.5, -20.00000000000001, -3.4, -5.3, -4.4, -11.999999999999998, -7.800000000000001, -8.599999999999998, -16.4, -9.3, -4.300000000000001, -4.300000000000001, -5.2, -32.3, -13.2, -4.4, -4.2, -4.4, -14.399999999999999, -15.799999999999974, -4.700000000000001, -5.1000000000000005, -25.200000000000003, -4.3, -7.1000000000000005, -11.7, -54.4, -17.700000000000003, -4.2, -13.8, -11.299999999999997, -4.6, -18.70000000000002, -4.300000000000001, -20.5, -22.9, -9.499999999999998, -8.8, -44.2, -23.90000000000001, -3.4, -26.4, -13.7, -5.0, -17.6, -6.2, -17.7, -5.3, -11.4, -22.1, -6.6000000000000005, -16.599999999999984, -4.3, -4.4, -19.69999999999999, -13.899999999999997, -4.3, -25.500000000000014, -7.800000000000001, -3.2, -14.600000000000001, -7.499999999999999, -3.4, -13.69999999999998, -4.2, -9.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0825000074536437, "mean_inference_ms": 1.4328085266591544, "mean_action_processing_ms": 0.07743308897528556, "mean_env_wait_ms": 6.528722082886614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2236000, "timesteps_this_iter": 0, "agent_timesteps_total": 2236000, "timers": {"sample_time_ms": 19466.991, "sample_throughput": 205.476, "load_time_ms": 0.423, "load_throughput": 9456214.632, "learn_time_ms": 9758.46, "learn_throughput": 409.901, "update_time_ms": 1.735}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.17309225183581153, "policy_loss": -0.020597258975268692, "vf_loss": 19.233280078441865, "vf_explained_var": 0.1676897462337248, "kl": 0.013567157112863248, "entropy": 0.24370731431790577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2236000, "num_agent_steps_sampled": 2236000, "num_steps_trained": 2236000, "num_agent_steps_trained": 2236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22520, "training_iteration": 559, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-05-07", "timestamp": 1643706307, "time_this_iter_s": 17.32164692878723, "time_total_s": 15336.723092317581, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3077.2142152786255, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 37.72, "ram_util_percent": 57.023999999999994}}
{"episode_reward_max": -3.2, "episode_reward_min": -61.59999999999999, "episode_reward_mean": -12.644, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.800000000000001, -8.599999999999998, -16.4, -9.3, -4.300000000000001, -4.300000000000001, -5.2, -32.3, -13.2, -4.4, -4.2, -4.4, -14.399999999999999, -15.799999999999974, -4.700000000000001, -5.1000000000000005, -25.200000000000003, -4.3, -7.1000000000000005, -11.7, -54.4, -17.700000000000003, -4.2, -13.8, -11.299999999999997, -4.6, -18.70000000000002, -4.300000000000001, -20.5, -22.9, -9.499999999999998, -8.8, -44.2, -23.90000000000001, -3.4, -26.4, -13.7, -5.0, -17.6, -6.2, -17.7, -5.3, -11.4, -22.1, -6.6000000000000005, -16.599999999999984, -4.3, -4.4, -19.69999999999999, -13.899999999999997, -4.3, -25.500000000000014, -7.800000000000001, -3.2, -14.600000000000001, -7.499999999999999, -3.4, -13.69999999999998, -4.2, -9.2, -14.099999999999998, -9.899999999999999, -5.499999999999999, -4.2, -16.699999999999996, -3.4, -4.4, -12.19999999999997, -22.5, -4.8999999999999995, -16.599999999999994, -8.6, -11.7, -9.9, -25.1, -11.399999999999999, -17.4, -17.599999999999973, -5.699999999999999, -13.7, -5.3, -17.8, -5.0, -8.4, -11.999999999999996, -4.4, -9.2, -6.4, -35.3, -17.799999999999997, -13.299999999999995, -10.399999999999997, -3.3, -61.59999999999999, -9.1, -8.999999999999998, -8.1, -5.4, -28.2, -9.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0821154075403436, "mean_inference_ms": 1.4319260952791877, "mean_action_processing_ms": 0.07738490075840454, "mean_env_wait_ms": 6.524320505232615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2240000, "timesteps_this_iter": 0, "agent_timesteps_total": 2240000, "timers": {"sample_time_ms": 19099.834, "sample_throughput": 209.426, "load_time_ms": 0.412, "load_throughput": 9720287.37, "learn_time_ms": 9504.426, "learn_throughput": 420.857, "update_time_ms": 1.705}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.23363547776775656, "policy_loss": -0.014426717756977004, "vf_loss": 24.699333099139633, "vf_explained_var": 0.05443194655961888, "kl": 0.010688688804658559, "entropy": 0.24332351206291106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2240000, "num_agent_steps_sampled": 2240000, "num_steps_trained": 2240000, "num_agent_steps_trained": 2240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22560, "training_iteration": 560, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-05-23", "timestamp": 1643706323, "time_this_iter_s": 16.5322003364563, "time_total_s": 15353.255292654037, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3093.746415615082, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 35.89565217391304, "ram_util_percent": 57.11304347826088}}
{"episode_reward_max": -1.3, "episode_reward_min": -142.3, "episode_reward_mean": -13.061999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.7, -5.3, -11.4, -22.1, -6.6000000000000005, -16.599999999999984, -4.3, -4.4, -19.69999999999999, -13.899999999999997, -4.3, -25.500000000000014, -7.800000000000001, -3.2, -14.600000000000001, -7.499999999999999, -3.4, -13.69999999999998, -4.2, -9.2, -14.099999999999998, -9.899999999999999, -5.499999999999999, -4.2, -16.699999999999996, -3.4, -4.4, -12.19999999999997, -22.5, -4.8999999999999995, -16.599999999999994, -8.6, -11.7, -9.9, -25.1, -11.399999999999999, -17.4, -17.599999999999973, -5.699999999999999, -13.7, -5.3, -17.8, -5.0, -8.4, -11.999999999999996, -4.4, -9.2, -6.4, -35.3, -17.799999999999997, -13.299999999999995, -10.399999999999997, -3.3, -61.59999999999999, -9.1, -8.999999999999998, -8.1, -5.4, -28.2, -9.7, -12.599999999999996, -1.3, -9.899999999999999, -5.3, -10.899999999999997, -9.0, -3.3, -15.499999999999998, -20.9, -18.600000000000005, -20.9, -5.1, -10.2, -12.799999999999999, -4.4, -4.4, -10.999999999999998, -20.6, -17.6, -15.199999999999998, -7.499999999999999, -6.199999999999999, -8.100000000000001, -5.3, -9.4, -142.3, -4.3, -11.499999999999996, -4.300000000000001, -26.0, -5.3, -12.899999999999999, -5.300000000000001, -4.300000000000001, -17.6, -26.40000000000004, -18.6, -16.1, -11.3, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0815983389690158, "mean_inference_ms": 1.4313410291978692, "mean_action_processing_ms": 0.0773541256773376, "mean_env_wait_ms": 6.521471165181646, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2244000, "timesteps_this_iter": 0, "agent_timesteps_total": 2244000, "timers": {"sample_time_ms": 18772.841, "sample_throughput": 213.074, "load_time_ms": 0.413, "load_throughput": 9690530.815, "learn_time_ms": 9309.063, "learn_throughput": 429.689, "update_time_ms": 1.656}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.7609076060462362, "policy_loss": -0.018499369866975774, "vf_loss": 77.83078521990006, "vf_explained_var": 0.014094669331786453, "kl": 0.010991399116453046, "entropy": 0.23090925623652755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2244000, "num_agent_steps_sampled": 2244000, "num_steps_trained": 2244000, "num_agent_steps_trained": 2244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22600, "training_iteration": 561, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-05-41", "timestamp": 1643706341, "time_this_iter_s": 17.699912071228027, "time_total_s": 15370.955204725266, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3111.44632768631, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 32.973076923076924, "ram_util_percent": 57.36923076923077}}
{"episode_reward_max": -1.3, "episode_reward_min": -142.3, "episode_reward_mean": -12.991999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -17.8, -5.0, -8.4, -11.999999999999996, -4.4, -9.2, -6.4, -35.3, -17.799999999999997, -13.299999999999995, -10.399999999999997, -3.3, -61.59999999999999, -9.1, -8.999999999999998, -8.1, -5.4, -28.2, -9.7, -12.599999999999996, -1.3, -9.899999999999999, -5.3, -10.899999999999997, -9.0, -3.3, -15.499999999999998, -20.9, -18.600000000000005, -20.9, -5.1, -10.2, -12.799999999999999, -4.4, -4.4, -10.999999999999998, -20.6, -17.6, -15.199999999999998, -7.499999999999999, -6.199999999999999, -8.100000000000001, -5.3, -9.4, -142.3, -4.3, -11.499999999999996, -4.300000000000001, -26.0, -5.3, -12.899999999999999, -5.300000000000001, -4.300000000000001, -17.6, -26.40000000000004, -18.6, -16.1, -11.3, -3.4, -10.099999999999998, -6.300000000000001, -3.3, -16.599999999999994, -10.799999999999999, -3.4, -9.3, -5.300000000000001, -13.399999999999972, -29.2, -9.100000000000001, -14.6, -3.4, -15.099999999999996, -18.3, -20.799999999999997, -13.0, -6.800000000000001, -15.599999999999998, -5.300000000000001, -5.2, -12.899999999999999, -7.899999999999997, -4.4, -18.0, -4.300000000000001, -10.3, -21.1, -15.5, -14.099999999999996, -17.8, -10.699999999999998, -7.6, -8.7, -11.799999999999999, -8.4, -3.3, -14.999999999999993, -12.799999999999983, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0810362713148012, "mean_inference_ms": 1.4309174913587848, "mean_action_processing_ms": 0.0773329020985136, "mean_env_wait_ms": 6.519503256431549, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2248000, "timesteps_this_iter": 0, "agent_timesteps_total": 2248000, "timers": {"sample_time_ms": 18488.788, "sample_throughput": 216.347, "load_time_ms": 0.403, "load_throughput": 9934989.045, "learn_time_ms": 9037.367, "learn_throughput": 442.607, "update_time_ms": 1.641}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.0660401305714522, "policy_loss": -0.03292643132879929, "vf_loss": 9.579989819372853, "vf_explained_var": 0.20366122575216397, "kl": 0.03166664304311276, "entropy": 0.25638787288178677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2248000, "num_agent_steps_sampled": 2248000, "num_steps_trained": 2248000, "num_agent_steps_trained": 2248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22640, "training_iteration": 562, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-05-58", "timestamp": 1643706358, "time_this_iter_s": 16.79457712173462, "time_total_s": 15387.749781847, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3128.2409048080444, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 38.275, "ram_util_percent": 57.541666666666664}}
{"episode_reward_max": -3.3, "episode_reward_min": -142.3, "episode_reward_mean": -13.008000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.499999999999999, -6.199999999999999, -8.100000000000001, -5.3, -9.4, -142.3, -4.3, -11.499999999999996, -4.300000000000001, -26.0, -5.3, -12.899999999999999, -5.300000000000001, -4.300000000000001, -17.6, -26.40000000000004, -18.6, -16.1, -11.3, -3.4, -10.099999999999998, -6.300000000000001, -3.3, -16.599999999999994, -10.799999999999999, -3.4, -9.3, -5.300000000000001, -13.399999999999972, -29.2, -9.100000000000001, -14.6, -3.4, -15.099999999999996, -18.3, -20.799999999999997, -13.0, -6.800000000000001, -15.599999999999998, -5.300000000000001, -5.2, -12.899999999999999, -7.899999999999997, -4.4, -18.0, -4.300000000000001, -10.3, -21.1, -15.5, -14.099999999999996, -17.8, -10.699999999999998, -7.6, -8.7, -11.799999999999999, -8.4, -3.3, -14.999999999999993, -12.799999999999983, -4.4, -12.2, -10.299999999999999, -6.2, -5.4, -10.1, -15.5, -12.4, -15.799999999999978, -19.700000000000003, -12.099999999999998, -8.2, -22.5, -6.4, -18.900000000000006, -12.199999999999998, -4.4, -23.9, -13.799999999999999, -3.3, -5.6, -4.2, -12.6, -29.200000000000003, -27.90000000000001, -18.5, -4.2, -17.5, -17.499999999999996, -7.699999999999998, -19.5, -13.199999999999976, -10.799999999999997, -22.80000000000006, -6.999999999999999, -3.3, -5.4, -18.900000000000002, -3.3, -12.2, -16.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0803803261921732, "mean_inference_ms": 1.4301202998276203, "mean_action_processing_ms": 0.07728981759199058, "mean_env_wait_ms": 6.515685465271011, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2252000, "timesteps_this_iter": 0, "agent_timesteps_total": 2252000, "timers": {"sample_time_ms": 18026.863, "sample_throughput": 221.891, "load_time_ms": 0.39, "load_throughput": 10253141.844, "learn_time_ms": 8786.783, "learn_throughput": 455.229, "update_time_ms": 1.6}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.13143636314649015, "policy_loss": 0.0007967291209566336, "vf_loss": 12.90557718430796, "vf_explained_var": 0.02727071335238795, "kl": 0.010559079931695487, "entropy": 0.24116694879948453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2252000, "num_agent_steps_sampled": 2252000, "num_steps_trained": 2252000, "num_agent_steps_trained": 2252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22680, "training_iteration": 563, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-06-13", "timestamp": 1643706373, "time_this_iter_s": 15.591622114181519, "time_total_s": 15403.341403961182, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3143.832526922226, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 33.54545454545453, "ram_util_percent": 57.554545454545455}}
{"episode_reward_max": -3.3, "episode_reward_min": -35.500000000000064, "episode_reward_mean": -12.802999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -12.899999999999999, -7.899999999999997, -4.4, -18.0, -4.300000000000001, -10.3, -21.1, -15.5, -14.099999999999996, -17.8, -10.699999999999998, -7.6, -8.7, -11.799999999999999, -8.4, -3.3, -14.999999999999993, -12.799999999999983, -4.4, -12.2, -10.299999999999999, -6.2, -5.4, -10.1, -15.5, -12.4, -15.799999999999978, -19.700000000000003, -12.099999999999998, -8.2, -22.5, -6.4, -18.900000000000006, -12.199999999999998, -4.4, -23.9, -13.799999999999999, -3.3, -5.6, -4.2, -12.6, -29.200000000000003, -27.90000000000001, -18.5, -4.2, -17.5, -17.499999999999996, -7.699999999999998, -19.5, -13.199999999999976, -10.799999999999997, -22.80000000000006, -6.999999999999999, -3.3, -5.4, -18.900000000000002, -3.3, -12.2, -16.2, -8.4, -29.3, -19.600000000000005, -11.299999999999999, -24.4, -5.4, -10.7, -5.300000000000001, -22.700000000000014, -4.4, -11.4, -18.999999999999996, -3.3, -21.1, -5.300000000000001, -17.3, -4.2, -11.2, -10.2, -23.9, -15.3, -18.4, -5.300000000000001, -7.4, -16.699999999999996, -4.4, -17.200000000000003, -14.199999999999998, -15.800000000000004, -23.00000000000001, -10.9, -14.099999999999998, -4.300000000000001, -8.2, -5.1, -21.9, -3.3, -35.500000000000064, -20.6, -25.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.079609658485642, "mean_inference_ms": 1.4290396806884138, "mean_action_processing_ms": 0.07723038557973723, "mean_env_wait_ms": 6.510181205131293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2256000, "timesteps_this_iter": 0, "agent_timesteps_total": 2256000, "timers": {"sample_time_ms": 17593.165, "sample_throughput": 227.361, "load_time_ms": 0.37, "load_throughput": 10798233.893, "learn_time_ms": 8455.493, "learn_throughput": 473.065, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.12408255710697141, "policy_loss": -0.01353073352346978, "vf_loss": 13.616822847884189, "vf_explained_var": 0.2276892416579749, "kl": 0.00963375378439253, "entropy": 0.25319135040845925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2256000, "num_agent_steps_sampled": 2256000, "num_steps_trained": 2256000, "num_agent_steps_trained": 2256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22720, "training_iteration": 564, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-06-29", "timestamp": 1643706389, "time_this_iter_s": 15.727317810058594, "time_total_s": 15419.06872177124, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3159.5598447322845, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 29.477272727272727, "ram_util_percent": 57.59999999999998}}
{"episode_reward_max": -3.3, "episode_reward_min": -75.5, "episode_reward_mean": -15.037, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -12.6, -29.200000000000003, -27.90000000000001, -18.5, -4.2, -17.5, -17.499999999999996, -7.699999999999998, -19.5, -13.199999999999976, -10.799999999999997, -22.80000000000006, -6.999999999999999, -3.3, -5.4, -18.900000000000002, -3.3, -12.2, -16.2, -8.4, -29.3, -19.600000000000005, -11.299999999999999, -24.4, -5.4, -10.7, -5.300000000000001, -22.700000000000014, -4.4, -11.4, -18.999999999999996, -3.3, -21.1, -5.300000000000001, -17.3, -4.2, -11.2, -10.2, -23.9, -15.3, -18.4, -5.300000000000001, -7.4, -16.699999999999996, -4.4, -17.200000000000003, -14.199999999999998, -15.800000000000004, -23.00000000000001, -10.9, -14.099999999999998, -4.300000000000001, -8.2, -5.1, -21.9, -3.3, -35.500000000000064, -20.6, -25.3, -16.199999999999996, -18.799999999999997, -6.2, -13.6, -7.2, -16.799999999999997, -75.5, -9.4, -9.3, -46.799999999999926, -29.699999999999996, -3.4, -6.4, -9.4, -9.1, -12.199999999999998, -12.799999999999997, -20.2, -6.699999999999998, -8.799999999999999, -7.499999999999999, -14.499999999999998, -3.3, -14.7, -13.0, -25.800000000000004, -4.4, -3.4, -6.2, -28.500000000000004, -72.4, -3.3, -51.79999999999994, -14.799999999999999, -16.299999999999997, -15.799999999999999, -12.099999999999998, -6.899999999999999, -16.699999999999996, -6.599999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.078606360410314, "mean_inference_ms": 1.4277491854832292, "mean_action_processing_ms": 0.07715945680664951, "mean_env_wait_ms": 6.503706513346408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2260000, "timesteps_this_iter": 0, "agent_timesteps_total": 2260000, "timers": {"sample_time_ms": 17044.326, "sample_throughput": 234.682, "load_time_ms": 0.358, "load_throughput": 11178848.614, "learn_time_ms": 8110.29, "learn_throughput": 493.201, "update_time_ms": 1.651}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.4939356142831516, "policy_loss": -0.021443472399566604, "vf_loss": 51.375845955136, "vf_explained_var": 0.13360203485335073, "kl": 0.010804284643331219, "entropy": 0.2503163552893105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2260000, "num_agent_steps_sampled": 2260000, "num_steps_trained": 2260000, "num_agent_steps_trained": 2260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22760, "training_iteration": 565, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-06-44", "timestamp": 1643706404, "time_this_iter_s": 15.210661172866821, "time_total_s": 15434.279382944107, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3174.7705059051514, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 28.28636363636364, "ram_util_percent": 57.59999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.5, "episode_reward_mean": -13.617, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.3, -18.4, -5.300000000000001, -7.4, -16.699999999999996, -4.4, -17.200000000000003, -14.199999999999998, -15.800000000000004, -23.00000000000001, -10.9, -14.099999999999998, -4.300000000000001, -8.2, -5.1, -21.9, -3.3, -35.500000000000064, -20.6, -25.3, -16.199999999999996, -18.799999999999997, -6.2, -13.6, -7.2, -16.799999999999997, -75.5, -9.4, -9.3, -46.799999999999926, -29.699999999999996, -3.4, -6.4, -9.4, -9.1, -12.199999999999998, -12.799999999999997, -20.2, -6.699999999999998, -8.799999999999999, -7.499999999999999, -14.499999999999998, -3.3, -14.7, -13.0, -25.800000000000004, -4.4, -3.4, -6.2, -28.500000000000004, -72.4, -3.3, -51.79999999999994, -14.799999999999999, -16.299999999999997, -15.799999999999999, -12.099999999999998, -6.899999999999999, -16.699999999999996, -6.599999999999999, -4.300000000000001, -24.099999999999994, -4.300000000000001, -15.5, -10.799999999999999, -15.799999999999997, -17.499999999999996, -10.5, -9.0, -18.4, -3.4, -4.300000000000001, -4.4, -11.399999999999999, -5.2, -4.4, -3.3, -22.6, -14.2, -3.3, -16.89999999999999, -34.899999999999984, -3.2, -10.799999999999999, -14.199999999999998, -5.300000000000001, -4.300000000000001, -5.4, -6.2, -4.5, -14.199999999999998, -8.899999999999999, -4.5, -5.300000000000001, -7.800000000000001, -21.3, -9.3, -4.300000000000001, -4.4, -5.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0777090045404298, "mean_inference_ms": 1.4265570782483268, "mean_action_processing_ms": 0.07709481934986144, "mean_env_wait_ms": 6.497791598324049, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2264000, "timesteps_this_iter": 0, "agent_timesteps_total": 2264000, "timers": {"sample_time_ms": 16518.712, "sample_throughput": 242.15, "load_time_ms": 0.346, "load_throughput": 11546604.267, "learn_time_ms": 7871.354, "learn_throughput": 508.172, "update_time_ms": 1.634}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.07954106360613819, "policy_loss": -0.02721534839040169, "vf_loss": 10.452445926845714, "vf_explained_var": 0.09199760972812611, "kl": 0.014879694133660476, "entropy": 0.22039489911128116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2264000, "num_agent_steps_sampled": 2264000, "num_steps_trained": 2264000, "num_agent_steps_trained": 2264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22800, "training_iteration": 566, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-07-00", "timestamp": 1643706420, "time_this_iter_s": 15.655026912689209, "time_total_s": 15449.934409856796, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3190.4255328178406, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 32.05909090909091, "ram_util_percent": 57.50454545454547}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.4, "episode_reward_mean": -13.083999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.499999999999999, -14.499999999999998, -3.3, -14.7, -13.0, -25.800000000000004, -4.4, -3.4, -6.2, -28.500000000000004, -72.4, -3.3, -51.79999999999994, -14.799999999999999, -16.299999999999997, -15.799999999999999, -12.099999999999998, -6.899999999999999, -16.699999999999996, -6.599999999999999, -4.300000000000001, -24.099999999999994, -4.300000000000001, -15.5, -10.799999999999999, -15.799999999999997, -17.499999999999996, -10.5, -9.0, -18.4, -3.4, -4.300000000000001, -4.4, -11.399999999999999, -5.2, -4.4, -3.3, -22.6, -14.2, -3.3, -16.89999999999999, -34.899999999999984, -3.2, -10.799999999999999, -14.199999999999998, -5.300000000000001, -4.300000000000001, -5.4, -6.2, -4.5, -14.199999999999998, -8.899999999999999, -4.5, -5.300000000000001, -7.800000000000001, -21.3, -9.3, -4.300000000000001, -4.4, -5.9, -13.499999999999998, -7.3, -16.4, -6.300000000000001, -12.3, -7.300000000000001, -15.899999999999999, -19.2, -9.899999999999997, -42.4, -15.399999999999997, -12.899999999999999, -21.0, -4.300000000000001, -9.9, -14.3, -23.0, -10.200000000000001, -6.699999999999999, -25.3, -15.799999999999999, -16.5, -6.4, -5.3, -25.30000000000001, -74.4, -6.2, -9.6, -4.3, -15.499999999999998, -9.4, -13.999999999999998, -5.300000000000001, -8.2, -14.899999999999999, -9.199999999999998, -6.1000000000000005, -17.500000000000004, -3.4, -11.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0768195004809595, "mean_inference_ms": 1.4252729068759555, "mean_action_processing_ms": 0.07702466054963689, "mean_env_wait_ms": 6.491515532143978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2268000, "timesteps_this_iter": 0, "agent_timesteps_total": 2268000, "timers": {"sample_time_ms": 16227.777, "sample_throughput": 246.491, "load_time_ms": 0.35, "load_throughput": 11440310.944, "learn_time_ms": 7875.452, "learn_throughput": 507.907, "update_time_ms": 1.659}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.2752076860209326, "policy_loss": -0.01592158097573506, "vf_loss": 28.95175556277716, "vf_explained_var": 0.1747879716016913, "kl": 0.010744783361422195, "entropy": 0.277459405106242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2268000, "num_agent_steps_sampled": 2268000, "num_steps_trained": 2268000, "num_agent_steps_trained": 2268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22840, "training_iteration": 567, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-07-16", "timestamp": 1643706436, "time_this_iter_s": 15.47045087814331, "time_total_s": 15465.40486073494, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3205.895983695984, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 31.345454545454547, "ram_util_percent": 57.51363636363637}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.4, "episode_reward_mean": -12.853, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.89999999999999, -34.899999999999984, -3.2, -10.799999999999999, -14.199999999999998, -5.300000000000001, -4.300000000000001, -5.4, -6.2, -4.5, -14.199999999999998, -8.899999999999999, -4.5, -5.300000000000001, -7.800000000000001, -21.3, -9.3, -4.300000000000001, -4.4, -5.9, -13.499999999999998, -7.3, -16.4, -6.300000000000001, -12.3, -7.300000000000001, -15.899999999999999, -19.2, -9.899999999999997, -42.4, -15.399999999999997, -12.899999999999999, -21.0, -4.300000000000001, -9.9, -14.3, -23.0, -10.200000000000001, -6.699999999999999, -25.3, -15.799999999999999, -16.5, -6.4, -5.3, -25.30000000000001, -74.4, -6.2, -9.6, -4.3, -15.499999999999998, -9.4, -13.999999999999998, -5.300000000000001, -8.2, -14.899999999999999, -9.199999999999998, -6.1000000000000005, -17.500000000000004, -3.4, -11.3, -11.3, -6.2, -6.300000000000001, -4.2, -13.5, -6.999999999999999, -8.4, -6.7, -24.5, -9.2, -17.4, -7.499999999999999, -12.299999999999999, -6.300000000000001, -12.7, -16.2, -16.799999999999997, -3.4, -23.9, -6.499999999999999, -23.500000000000004, -15.5, -5.300000000000001, -4.4, -10.2, -24.2, -21.000000000000004, -5.3, -12.899999999999999, -21.099999999999998, -15.7, -18.799999999999997, -19.799999999999997, -5.3, -21.500000000000004, -9.3, -19.2, -17.2, -22.3, -8.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.075955249226515, "mean_inference_ms": 1.4240894552458485, "mean_action_processing_ms": 0.07695958052790472, "mean_env_wait_ms": 6.485492058997198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2272000, "timesteps_this_iter": 0, "agent_timesteps_total": 2272000, "timers": {"sample_time_ms": 16252.779, "sample_throughput": 246.112, "load_time_ms": 0.35, "load_throughput": 11430178.498, "learn_time_ms": 7855.281, "learn_throughput": 509.212, "update_time_ms": 1.705}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.11835266195277694, "policy_loss": -0.01241616863577116, "vf_loss": 12.925077214548665, "vf_explained_var": 0.15792241340042443, "kl": 0.010120412359288553, "entropy": 0.26784684099657563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2272000, "num_agent_steps_sampled": 2272000, "num_steps_trained": 2272000, "num_agent_steps_trained": 2272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22880, "training_iteration": 568, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-07-32", "timestamp": 1643706452, "time_this_iter_s": 16.012851238250732, "time_total_s": 15481.41771197319, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3221.9088349342346, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 31.1304347826087, "ram_util_percent": 57.53043478260869}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -74.4, "episode_reward_mean": -11.872, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999999, -16.5, -6.4, -5.3, -25.30000000000001, -74.4, -6.2, -9.6, -4.3, -15.499999999999998, -9.4, -13.999999999999998, -5.300000000000001, -8.2, -14.899999999999999, -9.199999999999998, -6.1000000000000005, -17.500000000000004, -3.4, -11.3, -11.3, -6.2, -6.300000000000001, -4.2, -13.5, -6.999999999999999, -8.4, -6.7, -24.5, -9.2, -17.4, -7.499999999999999, -12.299999999999999, -6.300000000000001, -12.7, -16.2, -16.799999999999997, -3.4, -23.9, -6.499999999999999, -23.500000000000004, -15.5, -5.300000000000001, -4.4, -10.2, -24.2, -21.000000000000004, -5.3, -12.899999999999999, -21.099999999999998, -15.7, -18.799999999999997, -19.799999999999997, -5.3, -21.500000000000004, -9.3, -19.2, -17.2, -22.3, -8.8, -13.099999999999998, -21.5, -6.300000000000001, -4.4, -7.300000000000001, -4.300000000000001, -4.4, -6.300000000000001, -19.599999999999998, -3.3, -7.3, -14.100000000000001, -4.4, -11.999999999999998, -7.300000000000001, -9.200000000000001, -12.699999999999998, -6.4, -3.4, -20.699999999999992, -22.700000000000003, -6.4, -7.4, -8.2, -12.7, -9.4, -6.999999999999998, -7.4, -5.2, -18.9, -21.6, -5.5, -2.9000000000000004, -9.7, -12.899999999999999, -12.199999999999992, -10.1, -5.300000000000001, -7.2, -6.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0750637412533086, "mean_inference_ms": 1.4228249442512797, "mean_action_processing_ms": 0.0768908174781741, "mean_env_wait_ms": 6.479117980588742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2276000, "timesteps_this_iter": 0, "agent_timesteps_total": 2276000, "timers": {"sample_time_ms": 16134.406, "sample_throughput": 247.917, "load_time_ms": 0.34, "load_throughput": 11775964.063, "learn_time_ms": 7776.912, "learn_throughput": 514.343, "update_time_ms": 1.685}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.05148142338329826, "policy_loss": -0.00805899005743765, "vf_loss": 5.800411149955565, "vf_explained_var": 0.36328928156565593, "kl": 0.010242027735426122, "entropy": 0.252863110177299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2276000, "num_agent_steps_sampled": 2276000, "num_steps_trained": 2276000, "num_agent_steps_trained": 2276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22920, "training_iteration": 569, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-07-47", "timestamp": 1643706467, "time_this_iter_s": 15.548903942108154, "time_total_s": 15496.966615915298, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3237.457738876343, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 33.45909090909091, "ram_util_percent": 57.427272727272744}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -45.2, "episode_reward_mean": -12.040000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.500000000000004, -15.5, -5.300000000000001, -4.4, -10.2, -24.2, -21.000000000000004, -5.3, -12.899999999999999, -21.099999999999998, -15.7, -18.799999999999997, -19.799999999999997, -5.3, -21.500000000000004, -9.3, -19.2, -17.2, -22.3, -8.8, -13.099999999999998, -21.5, -6.300000000000001, -4.4, -7.300000000000001, -4.300000000000001, -4.4, -6.300000000000001, -19.599999999999998, -3.3, -7.3, -14.100000000000001, -4.4, -11.999999999999998, -7.300000000000001, -9.200000000000001, -12.699999999999998, -6.4, -3.4, -20.699999999999992, -22.700000000000003, -6.4, -7.4, -8.2, -12.7, -9.4, -6.999999999999998, -7.4, -5.2, -18.9, -21.6, -5.5, -2.9000000000000004, -9.7, -12.899999999999999, -12.199999999999992, -10.1, -5.300000000000001, -7.2, -6.299999999999997, -11.6, -18.3, -7.300000000000001, -5.4, -6.199999999999998, -5.300000000000001, -16.199999999999996, -13.399999999999995, -18.500000000000004, -13.799999999999999, -4.2, -4.3, -12.4, -19.800000000000008, -19.90000000000001, -26.5, -19.3, -12.899999999999999, -4.0, -5.300000000000001, -23.0, -20.000000000000004, -5.2, -5.2, -27.100000000000005, -25.30000000000001, -4.4, -5.300000000000001, -7.300000000000001, -3.4, -5.300000000000001, -4.2, -21.3, -45.2, -12.099999999999998, -6.899999999999999, -11.299999999999995, -3.3, -18.9, -16.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0741089461705586, "mean_inference_ms": 1.421638470156931, "mean_action_processing_ms": 0.07682591691141574, "mean_env_wait_ms": 6.473119949353952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2280000, "timesteps_this_iter": 0, "agent_timesteps_total": 2280000, "timers": {"sample_time_ms": 16019.157, "sample_throughput": 249.701, "load_time_ms": 0.34, "load_throughput": 11779271.221, "learn_time_ms": 7698.018, "learn_throughput": 519.614, "update_time_ms": 1.711}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.12392935835736334, "policy_loss": -0.016998365104839364, "vf_loss": 13.949458703943478, "vf_explained_var": 0.16352008523479586, "kl": 0.009554259193461579, "entropy": 0.21962292437912315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2280000, "num_agent_steps_sampled": 2280000, "num_steps_trained": 2280000, "num_agent_steps_trained": 2280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 22960, "training_iteration": 570, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-08-03", "timestamp": 1643706483, "time_this_iter_s": 15.382827997207642, "time_total_s": 15512.349443912506, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3252.8405668735504, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 32.209090909090904, "ram_util_percent": 57.40000000000002}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -90.4, "episode_reward_mean": -13.274, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.700000000000003, -6.4, -7.4, -8.2, -12.7, -9.4, -6.999999999999998, -7.4, -5.2, -18.9, -21.6, -5.5, -2.9000000000000004, -9.7, -12.899999999999999, -12.199999999999992, -10.1, -5.300000000000001, -7.2, -6.299999999999997, -11.6, -18.3, -7.300000000000001, -5.4, -6.199999999999998, -5.300000000000001, -16.199999999999996, -13.399999999999995, -18.500000000000004, -13.799999999999999, -4.2, -4.3, -12.4, -19.800000000000008, -19.90000000000001, -26.5, -19.3, -12.899999999999999, -4.0, -5.300000000000001, -23.0, -20.000000000000004, -5.2, -5.2, -27.100000000000005, -25.30000000000001, -4.4, -5.300000000000001, -7.300000000000001, -3.4, -5.300000000000001, -4.2, -21.3, -45.2, -12.099999999999998, -6.899999999999999, -11.299999999999995, -3.3, -18.9, -16.4, -5.3, -13.599999999999998, -12.499999999999991, -7.699999999999999, -8.8, -16.7, -6.800000000000001, -9.9, -6.2, -4.300000000000001, -8.3, -3.4, -12.8, -90.4, -5.300000000000001, -10.7, -16.799999999999997, -80.6, -9.799999999999999, -4.4, -18.299999999999997, -25.3, -17.2, -16.199999999999996, -21.3, -5.300000000000001, -15.599999999999996, -5.4, -11.899999999999995, -10.400000000000002, -14.3, -13.199999999999998, -6.699999999999999, -14.899999999999997, -21.0, -3.3, -9.099999999999998, -16.4, -15.600000000000001, -17.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.073010703447599, "mean_inference_ms": 1.420371992559219, "mean_action_processing_ms": 0.07675681496568193, "mean_env_wait_ms": 6.466829392543705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2284000, "timesteps_this_iter": 0, "agent_timesteps_total": 2284000, "timers": {"sample_time_ms": 15793.239, "sample_throughput": 253.273, "load_time_ms": 0.319, "load_throughput": 12547465.41, "learn_time_ms": 7589.737, "learn_throughput": 527.027, "update_time_ms": 1.726}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.44765146961886315, "policy_loss": -0.026397181378667475, "vf_loss": 47.15109700951525, "vf_explained_var": 0.12853869641980817, "kl": 0.01691794612654827, "entropy": 0.28155698847546373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2284000, "num_agent_steps_sampled": 2284000, "num_steps_trained": 2284000, "num_agent_steps_trained": 2284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23000, "training_iteration": 571, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-08-18", "timestamp": 1643706498, "time_this_iter_s": 15.1388680934906, "time_total_s": 15527.488312005997, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3267.979434967041, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 31.354545454545452, "ram_util_percent": 57.40000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.4, "episode_reward_mean": -13.320000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -20.000000000000004, -5.2, -5.2, -27.100000000000005, -25.30000000000001, -4.4, -5.300000000000001, -7.300000000000001, -3.4, -5.300000000000001, -4.2, -21.3, -45.2, -12.099999999999998, -6.899999999999999, -11.299999999999995, -3.3, -18.9, -16.4, -5.3, -13.599999999999998, -12.499999999999991, -7.699999999999999, -8.8, -16.7, -6.800000000000001, -9.9, -6.2, -4.300000000000001, -8.3, -3.4, -12.8, -90.4, -5.300000000000001, -10.7, -16.799999999999997, -80.6, -9.799999999999999, -4.4, -18.299999999999997, -25.3, -17.2, -16.199999999999996, -21.3, -5.300000000000001, -15.599999999999996, -5.4, -11.899999999999995, -10.400000000000002, -14.3, -13.199999999999998, -6.699999999999999, -14.899999999999997, -21.0, -3.3, -9.099999999999998, -16.4, -15.600000000000001, -17.0, -12.5, -24.699999999999996, -12.999999999999996, -3.4, -26.000000000000014, -15.999999999999998, -3.3, -11.999999999999998, -6.2, -20.3, -6.2, -7.2, -3.2, -22.4, -6.300000000000001, -6.2, -15.6, -5.2, -13.999999999999998, -14.5, -10.5, -13.7, -5.4, -5.300000000000001, -14.399999999999977, -18.4, -4.300000000000001, -13.6, -63.3, -4.3, -5.300000000000001, -6.2, -4.6000000000000005, -4.300000000000001, -6.4, -4.4, -7.300000000000001, -3.7, -11.399999999999999, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0722367904213375, "mean_inference_ms": 1.4193964285305092, "mean_action_processing_ms": 0.0767018566118942, "mean_env_wait_ms": 6.461849633849429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2288000, "timesteps_this_iter": 0, "agent_timesteps_total": 2288000, "timers": {"sample_time_ms": 15635.358, "sample_throughput": 255.83, "load_time_ms": 0.317, "load_throughput": 12626790.096, "learn_time_ms": 7647.484, "learn_throughput": 523.048, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.16697467462089594, "policy_loss": -0.025227110107399284, "vf_loss": 19.090897043802403, "vf_explained_var": 0.09339762054463868, "kl": 0.008618782262690227, "entropy": 0.2201893772208883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2288000, "num_agent_steps_sampled": 2288000, "num_steps_trained": 2288000, "num_agent_steps_trained": 2288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23040, "training_iteration": 572, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-08-35", "timestamp": 1643706515, "time_this_iter_s": 16.884193897247314, "time_total_s": 15544.372505903244, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3284.8636288642883, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 34.766666666666666, "ram_util_percent": 57.52916666666667}}
{"episode_reward_max": -3.2, "episode_reward_min": -63.3, "episode_reward_mean": -12.811999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.299999999999997, -25.3, -17.2, -16.199999999999996, -21.3, -5.300000000000001, -15.599999999999996, -5.4, -11.899999999999995, -10.400000000000002, -14.3, -13.199999999999998, -6.699999999999999, -14.899999999999997, -21.0, -3.3, -9.099999999999998, -16.4, -15.600000000000001, -17.0, -12.5, -24.699999999999996, -12.999999999999996, -3.4, -26.000000000000014, -15.999999999999998, -3.3, -11.999999999999998, -6.2, -20.3, -6.2, -7.2, -3.2, -22.4, -6.300000000000001, -6.2, -15.6, -5.2, -13.999999999999998, -14.5, -10.5, -13.7, -5.4, -5.300000000000001, -14.399999999999977, -18.4, -4.300000000000001, -13.6, -63.3, -4.3, -5.300000000000001, -6.2, -4.6000000000000005, -4.300000000000001, -6.4, -4.4, -7.300000000000001, -3.7, -11.399999999999999, -3.2, -15.5, -9.3, -13.799999999999997, -10.299999999999999, -9.2, -19.9, -4.300000000000001, -17.799999999999997, -16.2, -11.2, -3.3, -9.3, -6.8, -6.2, -7.4, -23.5, -10.2, -10.7, -63.3, -4.300000000000001, -54.60000000000003, -8.2, -10.8, -17.199999999999996, -4.2, -7.2, -15.4, -3.3, -14.999999999999998, -3.4, -10.6, -43.3, -10.2, -3.3, -12.5, -5.4, -5.300000000000001, -16.7, -14.999999999999996, -20.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0716887972405578, "mean_inference_ms": 1.4189782425355366, "mean_action_processing_ms": 0.07668020056903066, "mean_env_wait_ms": 6.459680915370783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2292000, "timesteps_this_iter": 0, "agent_timesteps_total": 2292000, "timers": {"sample_time_ms": 15872.565, "sample_throughput": 252.007, "load_time_ms": 0.319, "load_throughput": 12554977.176, "learn_time_ms": 7714.971, "learn_throughput": 518.472, "update_time_ms": 1.769}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.29321221532400255, "policy_loss": -0.0194217291147378, "vf_loss": 31.109088667105603, "vf_explained_var": 0.15234857259258147, "kl": 0.010287081920347274, "entropy": 0.25972744071034976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2292000, "num_agent_steps_sampled": 2292000, "num_steps_trained": 2292000, "num_agent_steps_trained": 2292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23080, "training_iteration": 573, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-08-53", "timestamp": 1643706533, "time_this_iter_s": 18.05740714073181, "time_total_s": 15562.429913043976, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3302.92103600502, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 29.41153846153846, "ram_util_percent": 57.849999999999994}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -73.3, "episode_reward_mean": -13.818000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -13.7, -5.4, -5.300000000000001, -14.399999999999977, -18.4, -4.300000000000001, -13.6, -63.3, -4.3, -5.300000000000001, -6.2, -4.6000000000000005, -4.300000000000001, -6.4, -4.4, -7.300000000000001, -3.7, -11.399999999999999, -3.2, -15.5, -9.3, -13.799999999999997, -10.299999999999999, -9.2, -19.9, -4.300000000000001, -17.799999999999997, -16.2, -11.2, -3.3, -9.3, -6.8, -6.2, -7.4, -23.5, -10.2, -10.7, -63.3, -4.300000000000001, -54.60000000000003, -8.2, -10.8, -17.199999999999996, -4.2, -7.2, -15.4, -3.3, -14.999999999999998, -3.4, -10.6, -43.3, -10.2, -3.3, -12.5, -5.4, -5.300000000000001, -16.7, -14.999999999999996, -20.5, -10.2, -13.799999999999999, -3.9000000000000004, -13.799999999999997, -12.399999999999997, -8.500000000000002, -13.699999999999994, -22.799999999999986, -3.2, -22.800000000000008, -13.299999999999999, -2.4000000000000004, -23.6, -5.300000000000001, -3.4, -14.299999999999997, -11.3, -4.4, -20.799999999999997, -7.6, -13.5, -73.3, -6.699999999999999, -20.4, -3.2, -5.2, -7.4, -12.799999999999997, -70.4, -9.2, -6.0, -3.4, -71.3, -16.5, -13.500000000000002, -4.3, -12.999999999999998, -16.4, -14.8, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0710977853267796, "mean_inference_ms": 1.4184871900545317, "mean_action_processing_ms": 0.07665440508410266, "mean_env_wait_ms": 6.457233445404621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2296000, "timesteps_this_iter": 0, "agent_timesteps_total": 2296000, "timers": {"sample_time_ms": 15916.152, "sample_throughput": 251.317, "load_time_ms": 0.328, "load_throughput": 12177699.064, "learn_time_ms": 7721.528, "learn_throughput": 518.032, "update_time_ms": 1.726}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.4127134846212963, "policy_loss": -0.019267499671187453, "vf_loss": 42.992491416777334, "vf_explained_var": 0.028445562111434116, "kl": 0.013707194686691628, "entropy": 0.2734606365042348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2296000, "num_agent_steps_sampled": 2296000, "num_steps_trained": 2296000, "num_agent_steps_trained": 2296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23120, "training_iteration": 574, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-09-08", "timestamp": 1643706548, "time_this_iter_s": 15.550424098968506, "time_total_s": 15577.980337142944, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3318.4714601039886, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 24.836363636363636, "ram_util_percent": 57.84545454545455}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -86.4, "episode_reward_mean": -14.261, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.60000000000003, -8.2, -10.8, -17.199999999999996, -4.2, -7.2, -15.4, -3.3, -14.999999999999998, -3.4, -10.6, -43.3, -10.2, -3.3, -12.5, -5.4, -5.300000000000001, -16.7, -14.999999999999996, -20.5, -10.2, -13.799999999999999, -3.9000000000000004, -13.799999999999997, -12.399999999999997, -8.500000000000002, -13.699999999999994, -22.799999999999986, -3.2, -22.800000000000008, -13.299999999999999, -2.4000000000000004, -23.6, -5.300000000000001, -3.4, -14.299999999999997, -11.3, -4.4, -20.799999999999997, -7.6, -13.5, -73.3, -6.699999999999999, -20.4, -3.2, -5.2, -7.4, -12.799999999999997, -70.4, -9.2, -6.0, -3.4, -71.3, -16.5, -13.500000000000002, -4.3, -12.999999999999998, -16.4, -14.8, -4.4, -16.3, -14.999999999999998, -9.9, -4.300000000000001, -4.300000000000001, -18.700000000000003, -10.8, -28.3, -8.9, -17.4, -9.0, -3.3, -15.7, -17.599999999999998, -4.0, -5.4, -16.799999999999997, -30.200000000000035, -5.3, -10.6, -5.4, -13.0, -15.099999999999998, -12.7, -11.399999999999995, -13.700000000000001, -18.700000000000003, -5.2, -5.4, -14.89999999999998, -86.4, -4.300000000000001, -14.799999999999999, -17.59999999999999, -6.4, -4.2, -6.2, -6.300000000000001, -7.300000000000001, -6.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0706562242302495, "mean_inference_ms": 1.4180489299741266, "mean_action_processing_ms": 0.07663233783883322, "mean_env_wait_ms": 6.455204962057864, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2300000, "timesteps_this_iter": 0, "agent_timesteps_total": 2300000, "timers": {"sample_time_ms": 16057.731, "sample_throughput": 249.101, "load_time_ms": 0.332, "load_throughput": 12049135.306, "learn_time_ms": 7753.151, "learn_throughput": 515.919, "update_time_ms": 1.694}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.4253486536688582, "policy_loss": -0.011950410996633833, "vf_loss": 43.614337947932626, "vf_explained_var": 0.09047055520037169, "kl": 0.00770463253191487, "entropy": 0.24729150749983325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2300000, "num_agent_steps_sampled": 2300000, "num_steps_trained": 2300000, "num_agent_steps_trained": 2300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23160, "training_iteration": 575, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-09-25", "timestamp": 1643706565, "time_this_iter_s": 16.884305000305176, "time_total_s": 15594.86464214325, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3335.355765104294, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 32.55833333333333, "ram_util_percent": 57.7125}}
{"episode_reward_max": -3.2, "episode_reward_min": -86.4, "episode_reward_mean": -13.252, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.5, -73.3, -6.699999999999999, -20.4, -3.2, -5.2, -7.4, -12.799999999999997, -70.4, -9.2, -6.0, -3.4, -71.3, -16.5, -13.500000000000002, -4.3, -12.999999999999998, -16.4, -14.8, -4.4, -16.3, -14.999999999999998, -9.9, -4.300000000000001, -4.300000000000001, -18.700000000000003, -10.8, -28.3, -8.9, -17.4, -9.0, -3.3, -15.7, -17.599999999999998, -4.0, -5.4, -16.799999999999997, -30.200000000000035, -5.3, -10.6, -5.4, -13.0, -15.099999999999998, -12.7, -11.399999999999995, -13.700000000000001, -18.700000000000003, -5.2, -5.4, -14.89999999999998, -86.4, -4.300000000000001, -14.799999999999999, -17.59999999999999, -6.4, -4.2, -6.2, -6.300000000000001, -7.300000000000001, -6.0, -12.299999999999999, -4.3, -10.1, -11.499999999999996, -3.4, -5.4, -18.2, -9.399999999999999, -13.8, -7.699999999999999, -11.899999999999999, -5.4, -4.300000000000001, -4.300000000000001, -7.4, -6.4, -3.3000000000000003, -36.7, -14.499999999999988, -5.3, -11.999999999999998, -20.799999999999997, -4.4, -10.799999999999999, -7.2, -3.4, -4.4, -11.799999999999997, -12.199999999999998, -9.099999999999996, -3.4, -14.5, -6.3, -14.7, -8.799999999999999, -40.60000000000005, -15.299999999999994, -7.899999999999999, -4.2, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.070210994777478, "mean_inference_ms": 1.4173282134289458, "mean_action_processing_ms": 0.07659440634851493, "mean_env_wait_ms": 6.451730593628902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2304000, "timesteps_this_iter": 0, "agent_timesteps_total": 2304000, "timers": {"sample_time_ms": 16056.768, "sample_throughput": 249.116, "load_time_ms": 0.334, "load_throughput": 11973462.746, "learn_time_ms": 7818.198, "learn_throughput": 511.627, "update_time_ms": 1.68}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.09316914995871885, "policy_loss": -0.02276461973425842, "vf_loss": 11.4436735554408, "vf_explained_var": 0.05977529082247006, "kl": 0.009980243650665107, "entropy": 0.24080477697394229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2304000, "num_agent_steps_sampled": 2304000, "num_steps_trained": 2304000, "num_agent_steps_trained": 2304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23200, "training_iteration": 576, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-09-41", "timestamp": 1643706581, "time_this_iter_s": 15.972666025161743, "time_total_s": 15610.837308168411, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3351.3284311294556, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 28.721739130434777, "ram_util_percent": 57.51304347826087}}
{"episode_reward_max": -1.2, "episode_reward_min": -141.8, "episode_reward_mean": -12.633, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -13.0, -15.099999999999998, -12.7, -11.399999999999995, -13.700000000000001, -18.700000000000003, -5.2, -5.4, -14.89999999999998, -86.4, -4.300000000000001, -14.799999999999999, -17.59999999999999, -6.4, -4.2, -6.2, -6.300000000000001, -7.300000000000001, -6.0, -12.299999999999999, -4.3, -10.1, -11.499999999999996, -3.4, -5.4, -18.2, -9.399999999999999, -13.8, -7.699999999999999, -11.899999999999999, -5.4, -4.300000000000001, -4.300000000000001, -7.4, -6.4, -3.3000000000000003, -36.7, -14.499999999999988, -5.3, -11.999999999999998, -20.799999999999997, -4.4, -10.799999999999999, -7.2, -3.4, -4.4, -11.799999999999997, -12.199999999999998, -9.099999999999996, -3.4, -14.5, -6.3, -14.7, -8.799999999999999, -40.60000000000005, -15.299999999999994, -7.899999999999999, -4.2, -5.300000000000001, -14.399999999999999, -11.3, -9.799999999999999, -1.2, -4.2, -25.300000000000022, -5.2, -3.4, -5.4, -5.2, -4.3, -11.399999999999999, -4.700000000000001, -14.4, -11.8, -11.9, -5.300000000000001, -11.899999999999999, -10.9, -13.999999999999998, -9.2, -4.4, -16.3, -20.500000000000004, -58.4, -3.2, -4.3, -5.4, -16.199999999999996, -141.8, -15.599999999999998, -15.399999999999995, -7.3, -6.9, -9.099999999999998, -11.7, -9.3, -4.3, -12.1, -18.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.069821477750883, "mean_inference_ms": 1.4166373980454607, "mean_action_processing_ms": 0.07655787362595254, "mean_env_wait_ms": 6.448408200921035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2308000, "timesteps_this_iter": 0, "agent_timesteps_total": 2308000, "timers": {"sample_time_ms": 16220.334, "sample_throughput": 246.604, "load_time_ms": 0.336, "load_throughput": 11919869.272, "learn_time_ms": 7910.12, "learn_throughput": 505.681, "update_time_ms": 1.686}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 1.015411049422748, "policy_loss": -0.012636386639919252, "vf_loss": 102.65732806632596, "vf_explained_var": -0.009521837901043636, "kl": 0.00982775585639788, "entropy": 0.2705807388870306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2308000, "num_agent_steps_sampled": 2308000, "num_steps_trained": 2308000, "num_agent_steps_trained": 2308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23240, "training_iteration": 577, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-09-59", "timestamp": 1643706599, "time_this_iter_s": 17.37862229347229, "time_total_s": 15628.215930461884, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3368.707053422928, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 28.708000000000002, "ram_util_percent": 57.715999999999994}}
{"episode_reward_max": -1.2, "episode_reward_min": -141.8, "episode_reward_mean": -13.045, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.999999999999998, -20.799999999999997, -4.4, -10.799999999999999, -7.2, -3.4, -4.4, -11.799999999999997, -12.199999999999998, -9.099999999999996, -3.4, -14.5, -6.3, -14.7, -8.799999999999999, -40.60000000000005, -15.299999999999994, -7.899999999999999, -4.2, -5.300000000000001, -14.399999999999999, -11.3, -9.799999999999999, -1.2, -4.2, -25.300000000000022, -5.2, -3.4, -5.4, -5.2, -4.3, -11.399999999999999, -4.700000000000001, -14.4, -11.8, -11.9, -5.300000000000001, -11.899999999999999, -10.9, -13.999999999999998, -9.2, -4.4, -16.3, -20.500000000000004, -58.4, -3.2, -4.3, -5.4, -16.199999999999996, -141.8, -15.599999999999998, -15.399999999999995, -7.3, -6.9, -9.099999999999998, -11.7, -9.3, -4.3, -12.1, -18.2, -37.50000000000001, -9.7, -5.2, -13.2, -8.3, -14.2, -21.000000000000004, -15.099999999999998, -5.4, -22.8, -14.9, -15.299999999999997, -9.3, -9.099999999999998, -17.9, -14.2, -20.799999999999997, -24.4, -5.3, -4.699999999999999, -27.800000000000022, -2.5, -3.3, -14.6, -10.399999999999999, -9.5, -24.4, -6.7, -5.4, -12.399999999999999, -15.699999999999976, -11.199999999999998, -10.899999999999999, -3.4, -5.3, -27.9, -10.799999999999999, -8.3, -4.4, -8.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0693648862937841, "mean_inference_ms": 1.4161066098952317, "mean_action_processing_ms": 0.07652663749576227, "mean_env_wait_ms": 6.445469605466035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2312000, "timesteps_this_iter": 0, "agent_timesteps_total": 2312000, "timers": {"sample_time_ms": 16388.488, "sample_throughput": 244.074, "load_time_ms": 0.34, "load_throughput": 11772658.761, "learn_time_ms": 7937.671, "learn_throughput": 503.926, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.14591077444974773, "policy_loss": -0.018577312695122854, "vf_loss": 16.265611616257697, "vf_explained_var": 0.11702680978723752, "kl": 0.012213149012087567, "entropy": 0.2741853931177688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2312000, "num_agent_steps_sampled": 2312000, "num_steps_trained": 2312000, "num_agent_steps_trained": 2312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23280, "training_iteration": 578, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-10-16", "timestamp": 1643706616, "time_this_iter_s": 17.04590606689453, "time_total_s": 15645.261836528778, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3385.7529594898224, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 36.24583333333334, "ram_util_percent": 57.604166666666664}}
{"episode_reward_max": -2.5, "episode_reward_min": -141.8, "episode_reward_mean": -13.626, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -4.4, -16.3, -20.500000000000004, -58.4, -3.2, -4.3, -5.4, -16.199999999999996, -141.8, -15.599999999999998, -15.399999999999995, -7.3, -6.9, -9.099999999999998, -11.7, -9.3, -4.3, -12.1, -18.2, -37.50000000000001, -9.7, -5.2, -13.2, -8.3, -14.2, -21.000000000000004, -15.099999999999998, -5.4, -22.8, -14.9, -15.299999999999997, -9.3, -9.099999999999998, -17.9, -14.2, -20.799999999999997, -24.4, -5.3, -4.699999999999999, -27.800000000000022, -2.5, -3.3, -14.6, -10.399999999999999, -9.5, -24.4, -6.7, -5.4, -12.399999999999999, -15.699999999999976, -11.199999999999998, -10.899999999999999, -3.4, -5.3, -27.9, -10.799999999999999, -8.3, -4.4, -8.599999999999998, -14.299999999999997, -20.7, -3.3, -7.300000000000001, -8.3, -11.5, -4.300000000000001, -21.899999999999952, -6.599999999999999, -13.999999999999998, -7.3, -8.299999999999997, -11.7, -10.599999999999998, -13.5, -7.3, -6.699999999999999, -3.4, -15.599999999999994, -4.6000000000000005, -4.300000000000001, -9.8, -11.9, -12.599999999999998, -4.4, -62.3, -5.300000000000001, -9.699999999999998, -12.2, -11.7, -6.499999999999999, -10.4, -3.4, -10.200000000000001, -19.3, -4.3, -18.200000000000003, -20.799999999999997, -12.5, -10.200000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0688905672303495, "mean_inference_ms": 1.4157383104434826, "mean_action_processing_ms": 0.07650552868158247, "mean_env_wait_ms": 6.443041616503686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2316000, "timesteps_this_iter": 0, "agent_timesteps_total": 2316000, "timers": {"sample_time_ms": 16494.877, "sample_throughput": 242.5, "load_time_ms": 0.339, "load_throughput": 11804134.243, "learn_time_ms": 8041.713, "learn_throughput": 497.406, "update_time_ms": 1.69}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.14812844402997966, "policy_loss": -0.016261435608549785, "vf_loss": 16.29674202101205, "vf_explained_var": 0.11648071267271555, "kl": 0.009483080114123339, "entropy": 0.2500981985080627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2316000, "num_agent_steps_sampled": 2316000, "num_steps_trained": 2316000, "num_agent_steps_trained": 2316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23320, "training_iteration": 579, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-10-33", "timestamp": 1643706633, "time_this_iter_s": 17.378512859344482, "time_total_s": 15662.640349388123, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3403.131472349167, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 39.988, "ram_util_percent": 57.62799999999999}}
{"episode_reward_max": -2.5, "episode_reward_min": -83.4, "episode_reward_mean": -12.131999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.800000000000022, -2.5, -3.3, -14.6, -10.399999999999999, -9.5, -24.4, -6.7, -5.4, -12.399999999999999, -15.699999999999976, -11.199999999999998, -10.899999999999999, -3.4, -5.3, -27.9, -10.799999999999999, -8.3, -4.4, -8.599999999999998, -14.299999999999997, -20.7, -3.3, -7.300000000000001, -8.3, -11.5, -4.300000000000001, -21.899999999999952, -6.599999999999999, -13.999999999999998, -7.3, -8.299999999999997, -11.7, -10.599999999999998, -13.5, -7.3, -6.699999999999999, -3.4, -15.599999999999994, -4.6000000000000005, -4.300000000000001, -9.8, -11.9, -12.599999999999998, -4.4, -62.3, -5.300000000000001, -9.699999999999998, -12.2, -11.7, -6.499999999999999, -10.4, -3.4, -10.200000000000001, -19.3, -4.3, -18.200000000000003, -20.799999999999997, -12.5, -10.200000000000001, -19.7, -4.800000000000001, -18.5, -9.3, -4.2, -17.2, -4.4, -3.3, -9.600000000000001, -46.2, -3.2, -3.4, -32.2, -5.6, -21.6, -3.3, -83.4, -18.700000000000003, -3.4, -8.9, -16.799999999999997, -8.3, -3.3, -18.799999999999997, -6.4, -6.2, -17.3, -10.600000000000001, -7.2, -8.1, -8.799999999999999, -8.100000000000001, -5.2, -9.999999999999998, -15.0, -5.4, -10.299999999999999, -4.3, -20.600000000000016, -16.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.068365025141372, "mean_inference_ms": 1.415286654820191, "mean_action_processing_ms": 0.0764859111962431, "mean_env_wait_ms": 6.440427002581469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2320000, "timesteps_this_iter": 0, "agent_timesteps_total": 2320000, "timers": {"sample_time_ms": 16656.003, "sample_throughput": 240.154, "load_time_ms": 0.336, "load_throughput": 11888616.78, "learn_time_ms": 8102.079, "learn_throughput": 493.7, "update_time_ms": 1.657}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.457545449638549, "policy_loss": -0.017287750868627463, "vf_loss": 47.29913917536376, "vf_explained_var": 0.1795767120776638, "kl": 0.012278854634507654, "entropy": 0.28437474725707884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2320000, "num_agent_steps_sampled": 2320000, "num_steps_trained": 2320000, "num_agent_steps_trained": 2320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23360, "training_iteration": 580, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-10-50", "timestamp": 1643706650, "time_this_iter_s": 16.549633026123047, "time_total_s": 15679.189982414246, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3419.68110537529, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 39.09565217391304, "ram_util_percent": 58.17391304347825}}
{"episode_reward_max": -2.7, "episode_reward_min": -90.4, "episode_reward_mean": -14.167, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -9.8, -11.9, -12.599999999999998, -4.4, -62.3, -5.300000000000001, -9.699999999999998, -12.2, -11.7, -6.499999999999999, -10.4, -3.4, -10.200000000000001, -19.3, -4.3, -18.200000000000003, -20.799999999999997, -12.5, -10.200000000000001, -19.7, -4.800000000000001, -18.5, -9.3, -4.2, -17.2, -4.4, -3.3, -9.600000000000001, -46.2, -3.2, -3.4, -32.2, -5.6, -21.6, -3.3, -83.4, -18.700000000000003, -3.4, -8.9, -16.799999999999997, -8.3, -3.3, -18.799999999999997, -6.4, -6.2, -17.3, -10.600000000000001, -7.2, -8.1, -8.799999999999999, -8.100000000000001, -5.2, -9.999999999999998, -15.0, -5.4, -10.299999999999999, -4.3, -20.600000000000016, -16.9, -6.4, -16.69999999999999, -10.3, -6.3, -36.3, -20.6, -12.999999999999998, -15.399999999999999, -8.3, -10.4, -8.4, -40.4, -16.1, -20.5, -6.299999999999999, -18.8, -12.4, -11.5, -11.9, -9.3, -2.7, -5.899999999999999, -7.3, -4.3, -6.300000000000001, -33.20000000000001, -9.3, -14.899999999999988, -26.4, -13.4, -9.2, -36.4, -8.3, -6.6, -6.3, -90.4, -7.4, -16.199999999999996, -13.099999999999998, -11.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.067811942151983, "mean_inference_ms": 1.414514946998485, "mean_action_processing_ms": 0.07644951581377954, "mean_env_wait_ms": 6.436663853510084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2324000, "timesteps_this_iter": 0, "agent_timesteps_total": 2324000, "timers": {"sample_time_ms": 16746.955, "sample_throughput": 238.849, "load_time_ms": 0.347, "load_throughput": 11527563.556, "learn_time_ms": 8051.982, "learn_throughput": 496.772, "update_time_ms": 1.723}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.4710048008169378, "policy_loss": -0.01918001099519672, "vf_loss": 48.85654032102195, "vf_explained_var": 0.09493428673795475, "kl": 0.010796100807114893, "entropy": 0.26637442842606573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2324000, "num_agent_steps_sampled": 2324000, "num_steps_trained": 2324000, "num_agent_steps_trained": 2324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23400, "training_iteration": 581, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-11-05", "timestamp": 1643706665, "time_this_iter_s": 14.95193886756897, "time_total_s": 15694.141921281815, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3434.633044242859, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 34.61904761904762, "ram_util_percent": 58.209523809523795}}
{"episode_reward_max": -2.7, "episode_reward_min": -90.4, "episode_reward_mean": -14.084999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.799999999999997, -8.3, -3.3, -18.799999999999997, -6.4, -6.2, -17.3, -10.600000000000001, -7.2, -8.1, -8.799999999999999, -8.100000000000001, -5.2, -9.999999999999998, -15.0, -5.4, -10.299999999999999, -4.3, -20.600000000000016, -16.9, -6.4, -16.69999999999999, -10.3, -6.3, -36.3, -20.6, -12.999999999999998, -15.399999999999999, -8.3, -10.4, -8.4, -40.4, -16.1, -20.5, -6.299999999999999, -18.8, -12.4, -11.5, -11.9, -9.3, -2.7, -5.899999999999999, -7.3, -4.3, -6.300000000000001, -33.20000000000001, -9.3, -14.899999999999988, -26.4, -13.4, -9.2, -36.4, -8.3, -6.6, -6.3, -90.4, -7.4, -16.199999999999996, -13.099999999999998, -11.3, -24.700000000000024, -6.3, -10.3, -11.600000000000001, -20.500000000000004, -13.499999999999996, -4.300000000000001, -34.2, -14.19999999999999, -9.3, -18.200000000000003, -10.3, -9.3, -9.4, -8.4, -21.299999999999997, -19.3, -12.3, -24.200000000000014, -11.799999999999999, -16.299999999999997, -13.1, -10.3, -6.2, -11.2, -10.799999999999999, -7.3, -12.600000000000001, -7.3999999999999995, -9.299999999999999, -19.200000000000003, -11.4, -5.4, -22.500000000000007, -5.4, -21.400000000000016, -16.6, -45.3, -20.3, -7.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0672141653873817, "mean_inference_ms": 1.4135524236878654, "mean_action_processing_ms": 0.07639689099975314, "mean_env_wait_ms": 6.431927515002681, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2328000, "timesteps_this_iter": 0, "agent_timesteps_total": 2328000, "timers": {"sample_time_ms": 16640.232, "sample_throughput": 240.381, "load_time_ms": 0.35, "load_throughput": 11416178.552, "learn_time_ms": 7955.62, "learn_throughput": 502.789, "update_time_ms": 1.719}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.14597306646136265, "policy_loss": -0.016460775303584273, "vf_loss": 16.118706670884162, "vf_explained_var": 0.20157083817707594, "kl": 0.00831187011934908, "entropy": 0.2476683583150628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2328000, "num_agent_steps_sampled": 2328000, "num_steps_trained": 2328000, "num_agent_steps_trained": 2328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23440, "training_iteration": 582, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-11-20", "timestamp": 1643706680, "time_this_iter_s": 15.347662210464478, "time_total_s": 15709.489583492279, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3449.9807064533234, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 34.304545454545455, "ram_util_percent": 58.181818181818194}}
{"episode_reward_max": -2.7, "episode_reward_min": -90.4, "episode_reward_mean": -13.668999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.7, -5.899999999999999, -7.3, -4.3, -6.300000000000001, -33.20000000000001, -9.3, -14.899999999999988, -26.4, -13.4, -9.2, -36.4, -8.3, -6.6, -6.3, -90.4, -7.4, -16.199999999999996, -13.099999999999998, -11.3, -24.700000000000024, -6.3, -10.3, -11.600000000000001, -20.500000000000004, -13.499999999999996, -4.300000000000001, -34.2, -14.19999999999999, -9.3, -18.200000000000003, -10.3, -9.3, -9.4, -8.4, -21.299999999999997, -19.3, -12.3, -24.200000000000014, -11.799999999999999, -16.299999999999997, -13.1, -10.3, -6.2, -11.2, -10.799999999999999, -7.3, -12.600000000000001, -7.3999999999999995, -9.299999999999999, -19.200000000000003, -11.4, -5.4, -22.500000000000007, -5.4, -21.400000000000016, -16.6, -45.3, -20.3, -7.3, -14.299999999999997, -7.3, -21.200000000000006, -37.3, -4.2, -7.199999999999999, -8.2, -6.3, -18.5, -8.4, -12.3, -11.7, -13.4, -6.3, -9.9, -12.2, -13.499999999999995, -5.2, -4.4, -18.400000000000016, -15.2, -25.599999999999998, -15.299999999999997, -9.3, -24.200000000000017, -5.300000000000001, -13.5, -8.799999999999997, -9.399999999999999, -7.699999999999999, -3.4, -11.3, -10.4, -6.3, -8.2, -15.299999999999999, -15.299999999999974, -7.1000000000000005, -9.100000000000001, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0665644020033591, "mean_inference_ms": 1.4123940952685763, "mean_action_processing_ms": 0.07633356905254107, "mean_env_wait_ms": 6.426231183885227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2332000, "timesteps_this_iter": 0, "agent_timesteps_total": 2332000, "timers": {"sample_time_ms": 16351.333, "sample_throughput": 244.628, "load_time_ms": 0.368, "load_throughput": 10863961.665, "learn_time_ms": 7866.103, "learn_throughput": 508.511, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.08630328983749433, "policy_loss": -0.013480275088260251, "vf_loss": 9.822339571804129, "vf_explained_var": 0.27646031975746155, "kl": 0.01040113820051324, "entropy": 0.2404392850174699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2332000, "num_agent_steps_sampled": 2332000, "num_steps_trained": 2332000, "num_agent_steps_trained": 2332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23480, "training_iteration": 583, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-11-35", "timestamp": 1643706695, "time_this_iter_s": 15.246082067489624, "time_total_s": 15724.735665559769, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3465.226788520813, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 31.87272727272727, "ram_util_percent": 58.209090909090925}}
{"episode_reward_max": -2.2, "episode_reward_min": -45.3, "episode_reward_mean": -11.825000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.299999999999997, -13.1, -10.3, -6.2, -11.2, -10.799999999999999, -7.3, -12.600000000000001, -7.3999999999999995, -9.299999999999999, -19.200000000000003, -11.4, -5.4, -22.500000000000007, -5.4, -21.400000000000016, -16.6, -45.3, -20.3, -7.3, -14.299999999999997, -7.3, -21.200000000000006, -37.3, -4.2, -7.199999999999999, -8.2, -6.3, -18.5, -8.4, -12.3, -11.7, -13.4, -6.3, -9.9, -12.2, -13.499999999999995, -5.2, -4.4, -18.400000000000016, -15.2, -25.599999999999998, -15.299999999999997, -9.3, -24.200000000000017, -5.300000000000001, -13.5, -8.799999999999997, -9.399999999999999, -7.699999999999999, -3.4, -11.3, -10.4, -6.3, -8.2, -15.299999999999999, -15.299999999999974, -7.1000000000000005, -9.100000000000001, -4.4, -7.3, -29.3, -13.600000000000001, -7.700000000000001, -7.2, -7.3, -17.6, -7.3, -4.5, -2.2, -9.399999999999999, -22.600000000000005, -10.0, -3.4, -8.3, -21.6, -14.7, -14.6, -6.9, -5.8, -3.4, -16.0, -6.2, -13.299999999999997, -14.7, -10.2, -7.4, -17.299999999999997, -5.300000000000001, -6.3, -6.699999999999999, -10.299999999999999, -6.300000000000001, -7.300000000000001, -15.599999999999996, -12.2, -11.4, -10.8, -11.2, -24.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0660012982935747, "mean_inference_ms": 1.4114865546848143, "mean_action_processing_ms": 0.07628364939291048, "mean_env_wait_ms": 6.421712373683975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2336000, "timesteps_this_iter": 0, "agent_timesteps_total": 2336000, "timers": {"sample_time_ms": 16337.632, "sample_throughput": 244.834, "load_time_ms": 0.361, "load_throughput": 11086510.276, "learn_time_ms": 7949.397, "learn_throughput": 503.183, "update_time_ms": 1.653}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.08786191875115038, "policy_loss": -0.017173819283964813, "vf_loss": 10.400804004105188, "vf_explained_var": 0.27156444826433734, "kl": 0.006851333586809998, "entropy": 0.23462740750082078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2336000, "num_agent_steps_sampled": 2336000, "num_steps_trained": 2336000, "num_agent_steps_trained": 2336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23520, "training_iteration": 584, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-11-53", "timestamp": 1643706713, "time_this_iter_s": 17.144312858581543, "time_total_s": 15741.87997841835, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3482.3711013793945, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 33.244, "ram_util_percent": 58.368}}
{"episode_reward_max": -2.2, "episode_reward_min": -29.3, "episode_reward_mean": -10.542, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.2, -25.599999999999998, -15.299999999999997, -9.3, -24.200000000000017, -5.300000000000001, -13.5, -8.799999999999997, -9.399999999999999, -7.699999999999999, -3.4, -11.3, -10.4, -6.3, -8.2, -15.299999999999999, -15.299999999999974, -7.1000000000000005, -9.100000000000001, -4.4, -7.3, -29.3, -13.600000000000001, -7.700000000000001, -7.2, -7.3, -17.6, -7.3, -4.5, -2.2, -9.399999999999999, -22.600000000000005, -10.0, -3.4, -8.3, -21.6, -14.7, -14.6, -6.9, -5.8, -3.4, -16.0, -6.2, -13.299999999999997, -14.7, -10.2, -7.4, -17.299999999999997, -5.300000000000001, -6.3, -6.699999999999999, -10.299999999999999, -6.300000000000001, -7.300000000000001, -15.599999999999996, -12.2, -11.4, -10.8, -11.2, -24.7, -6.2, -5.4, -22.799999999999997, -13.999999999999972, -5.4, -12.899999999999999, -14.3, -22.800000000000008, -10.799999999999999, -4.3, -6.3, -7.3, -15.399999999999997, -3.4, -9.4, -7.3, -13.5, -6.000000000000001, -5.4, -14.8, -10.799999999999999, -7.1, -4.3, -10.7, -8.3, -13.3, -7.4, -12.399999999999997, -5.4, -9.3, -5.300000000000001, -13.2, -5.3, -13.5, -17.9, -9.3, -3.9000000000000004, -3.4, -17.5, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0657336596181197, "mean_inference_ms": 1.4110119475643086, "mean_action_processing_ms": 0.07625999371716746, "mean_env_wait_ms": 6.419297350563457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2340000, "timesteps_this_iter": 0, "agent_timesteps_total": 2340000, "timers": {"sample_time_ms": 16421.692, "sample_throughput": 243.58, "load_time_ms": 0.359, "load_throughput": 11144689.783, "learn_time_ms": 7989.687, "learn_throughput": 500.645, "update_time_ms": 1.74}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.04452945789502513, "policy_loss": -0.014534768544297706, "vf_loss": 5.756769475244707, "vf_explained_var": 0.5077299460288017, "kl": 0.009976889211329984, "entropy": 0.2099783042986547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2340000, "num_agent_steps_sampled": 2340000, "num_steps_trained": 2340000, "num_agent_steps_trained": 2340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23560, "training_iteration": 585, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-12-10", "timestamp": 1643706730, "time_this_iter_s": 17.290421962738037, "time_total_s": 15759.170400381088, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3499.6615233421326, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 40.04583333333333, "ram_util_percent": 58.57083333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -58.2, "episode_reward_mean": -10.861999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -16.0, -6.2, -13.299999999999997, -14.7, -10.2, -7.4, -17.299999999999997, -5.300000000000001, -6.3, -6.699999999999999, -10.299999999999999, -6.300000000000001, -7.300000000000001, -15.599999999999996, -12.2, -11.4, -10.8, -11.2, -24.7, -6.2, -5.4, -22.799999999999997, -13.999999999999972, -5.4, -12.899999999999999, -14.3, -22.800000000000008, -10.799999999999999, -4.3, -6.3, -7.3, -15.399999999999997, -3.4, -9.4, -7.3, -13.5, -6.000000000000001, -5.4, -14.8, -10.799999999999999, -7.1, -4.3, -10.7, -8.3, -13.3, -7.4, -12.399999999999997, -5.4, -9.3, -5.300000000000001, -13.2, -5.3, -13.5, -17.9, -9.3, -3.9000000000000004, -3.4, -17.5, -5.2, -15.699999999999998, -16.999999999999996, -7.4, -5.2, -24.800000000000008, -18.200000000000006, -10.699999999999976, -5.4, -15.599999999999977, -22.89999999999999, -3.2, -21.1, -8.3, -13.6, -11.799999999999999, -6.1, -6.9, -24.500000000000004, -5.2, -5.4, -10.0, -6.999999999999998, -19.5, -4.4, -7.100000000000001, -6.1, -3.4, -5.4, -21.800000000000004, -8.4, -8.2, -23.8, -58.2, -4.3, -8.8, -10.700000000000001, -5.6000000000000005, -8.2, -3.3, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.06535505932518, "mean_inference_ms": 1.4105129078142473, "mean_action_processing_ms": 0.07623475807451205, "mean_env_wait_ms": 6.416758531200546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2344000, "timesteps_this_iter": 0, "agent_timesteps_total": 2344000, "timers": {"sample_time_ms": 16477.182, "sample_throughput": 242.76, "load_time_ms": 0.359, "load_throughput": 11152839.194, "learn_time_ms": 7963.929, "learn_throughput": 502.265, "update_time_ms": 1.753}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.15766686733376475, "policy_loss": -0.019703324846122215, "vf_loss": 17.57937980883865, "vf_explained_var": 0.24933019421433888, "kl": 0.010509339372801678, "entropy": 0.2494007930439967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2344000, "num_agent_steps_sampled": 2344000, "num_steps_trained": 2344000, "num_agent_steps_trained": 2344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23600, "training_iteration": 586, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-12-26", "timestamp": 1643706746, "time_this_iter_s": 15.865769147872925, "time_total_s": 15775.036169528961, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3515.5272924900055, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 34.64782608695651, "ram_util_percent": 58.59130434782608}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.0, "episode_reward_mean": -12.517999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.799999999999999, -7.1, -4.3, -10.7, -8.3, -13.3, -7.4, -12.399999999999997, -5.4, -9.3, -5.300000000000001, -13.2, -5.3, -13.5, -17.9, -9.3, -3.9000000000000004, -3.4, -17.5, -5.2, -15.699999999999998, -16.999999999999996, -7.4, -5.2, -24.800000000000008, -18.200000000000006, -10.699999999999976, -5.4, -15.599999999999977, -22.89999999999999, -3.2, -21.1, -8.3, -13.6, -11.799999999999999, -6.1, -6.9, -24.500000000000004, -5.2, -5.4, -10.0, -6.999999999999998, -19.5, -4.4, -7.100000000000001, -6.1, -3.4, -5.4, -21.800000000000004, -8.4, -8.2, -23.8, -58.2, -4.3, -8.8, -10.700000000000001, -5.6000000000000005, -8.2, -3.3, -5.2, -12.899999999999999, -5.4, -9.799999999999997, -5.300000000000001, -19.000000000000007, -23.2, -9.0, -16.5, -21.2, -8.3, -20.4, -23.3, -6.0, -7.4, -9.3, -15.5, -8.0, -9.3, -10.4, -22.6, -11.099999999999998, -13.3, -12.8, -5.300000000000001, -24.3, -9.2, -17.799999999999997, -17.299999999999997, -8.8, -9.3, -90.0, -12.5, -20.599999999999998, -24.2, -4.300000000000001, -8.2, -13.5, -7.499999999999999, -9.2, -7.8999999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0647996029885471, "mean_inference_ms": 1.4098278073362667, "mean_action_processing_ms": 0.07619905182114879, "mean_env_wait_ms": 6.41322814977313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2348000, "timesteps_this_iter": 0, "agent_timesteps_total": 2348000, "timers": {"sample_time_ms": 16420.921, "sample_throughput": 243.592, "load_time_ms": 0.358, "load_throughput": 11175125.558, "learn_time_ms": 7940.128, "learn_throughput": 503.77, "update_time_ms": 1.749}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.4112624982752467, "policy_loss": -0.011149885675679611, "vf_loss": 42.09879667784578, "vf_explained_var": 0.22087061770500677, "kl": 0.009496213068410454, "entropy": 0.2457887519912053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2348000, "num_agent_steps_sampled": 2348000, "num_steps_trained": 2348000, "num_agent_steps_trained": 2348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23640, "training_iteration": 587, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-12-43", "timestamp": 1643706763, "time_this_iter_s": 16.833745002746582, "time_total_s": 15791.869914531708, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3532.361037492752, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 35.37916666666666, "ram_util_percent": 58.54583333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.0, "episode_reward_mean": -12.532000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -6.999999999999998, -19.5, -4.4, -7.100000000000001, -6.1, -3.4, -5.4, -21.800000000000004, -8.4, -8.2, -23.8, -58.2, -4.3, -8.8, -10.700000000000001, -5.6000000000000005, -8.2, -3.3, -5.2, -12.899999999999999, -5.4, -9.799999999999997, -5.300000000000001, -19.000000000000007, -23.2, -9.0, -16.5, -21.2, -8.3, -20.4, -23.3, -6.0, -7.4, -9.3, -15.5, -8.0, -9.3, -10.4, -22.6, -11.099999999999998, -13.3, -12.8, -5.300000000000001, -24.3, -9.2, -17.799999999999997, -17.299999999999997, -8.8, -9.3, -90.0, -12.5, -20.599999999999998, -24.2, -4.300000000000001, -8.2, -13.5, -7.499999999999999, -9.2, -7.8999999999999995, -8.999999999999998, -29.1, -6.300000000000001, -10.199999999999998, -6.300000000000001, -5.4, -5.4, -7.3, -8.2, -24.4, -9.4, -9.4, -13.899999999999999, -5.3, -8.4, -12.7, -16.6, -7.4, -14.099999999999998, -11.0, -6.0, -6.4, -20.800000000000004, -9.3, -7.699999999999998, -19.6, -16.799999999999997, -18.4, -14.499999999999977, -12.6, -9.4, -10.499999999999998, -5.700000000000001, -7.2, -6.3, -8.0, -3.2, -21.4, -4.9, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.064262522658089, "mean_inference_ms": 1.4089370677273596, "mean_action_processing_ms": 0.07615156309070156, "mean_env_wait_ms": 6.4085217219287305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2352000, "timesteps_this_iter": 0, "agent_timesteps_total": 2352000, "timers": {"sample_time_ms": 16299.528, "sample_throughput": 245.406, "load_time_ms": 0.358, "load_throughput": 11166200.333, "learn_time_ms": 7926.736, "learn_throughput": 504.621, "update_time_ms": 1.732}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.08675279801771525, "policy_loss": -0.015296411758629225, "vf_loss": 10.048183124872946, "vf_explained_var": 0.23965397816832348, "kl": 0.010449209980715636, "entropy": 0.2822990432221402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2352000, "num_agent_steps_sampled": 2352000, "num_steps_trained": 2352000, "num_agent_steps_trained": 2352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23680, "training_iteration": 588, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-12-59", "timestamp": 1643706779, "time_this_iter_s": 15.9360671043396, "time_total_s": 15807.805981636047, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3548.2971045970917, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 30.456521739130434, "ram_util_percent": 58.53043478260871}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.0, "episode_reward_mean": -12.842, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.099999999999998, -13.3, -12.8, -5.300000000000001, -24.3, -9.2, -17.799999999999997, -17.299999999999997, -8.8, -9.3, -90.0, -12.5, -20.599999999999998, -24.2, -4.300000000000001, -8.2, -13.5, -7.499999999999999, -9.2, -7.8999999999999995, -8.999999999999998, -29.1, -6.300000000000001, -10.199999999999998, -6.300000000000001, -5.4, -5.4, -7.3, -8.2, -24.4, -9.4, -9.4, -13.899999999999999, -5.3, -8.4, -12.7, -16.6, -7.4, -14.099999999999998, -11.0, -6.0, -6.4, -20.800000000000004, -9.3, -7.699999999999998, -19.6, -16.799999999999997, -18.4, -14.499999999999977, -12.6, -9.4, -10.499999999999998, -5.700000000000001, -7.2, -6.3, -8.0, -3.2, -21.4, -4.9, -5.4, -13.999999999999998, -7.300000000000001, -5.3, -21.7, -9.9, -7.2, -29.300000000000075, -18.4, -7.4, -12.3, -9.3, -6.4, -10.899999999999999, -14.6, -17.600000000000005, -14.399999999999999, -17.6, -12.4, -23.300000000000004, -9.2, -24.9, -5.9, -23.199999999999996, -11.699999999999998, -13.2, -7.300000000000001, -20.799999999999997, -8.5, -16.39999999999999, -5.1, -19.7, -13.6, -7.399999999999999, -9.200000000000001, -4.3, -15.399999999999986, -12.6, -9.7, -7.2, -18.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0636017736722336, "mean_inference_ms": 1.408039822526021, "mean_action_processing_ms": 0.07610390840720728, "mean_env_wait_ms": 6.403935113378811, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2356000, "timesteps_this_iter": 0, "agent_timesteps_total": 2356000, "timers": {"sample_time_ms": 16235.817, "sample_throughput": 246.369, "load_time_ms": 0.353, "load_throughput": 11327537.641, "learn_time_ms": 7785.741, "learn_throughput": 513.76, "update_time_ms": 1.705}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.09230797146196647, "policy_loss": -0.015073899114103888, "vf_loss": 10.574684278554814, "vf_explained_var": 0.2806409240409892, "kl": 0.010900213501298099, "entropy": 0.2584753651772776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2356000, "num_agent_steps_sampled": 2356000, "num_steps_trained": 2356000, "num_agent_steps_trained": 2356000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23720, "training_iteration": 589, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-13-14", "timestamp": 1643706794, "time_this_iter_s": 15.472661972045898, "time_total_s": 15823.278643608093, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3563.7697665691376, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 33.61363636363636, "ram_util_percent": 58.40000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.300000000000004, "episode_reward_mean": -12.792999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -6.4, -20.800000000000004, -9.3, -7.699999999999998, -19.6, -16.799999999999997, -18.4, -14.499999999999977, -12.6, -9.4, -10.499999999999998, -5.700000000000001, -7.2, -6.3, -8.0, -3.2, -21.4, -4.9, -5.4, -13.999999999999998, -7.300000000000001, -5.3, -21.7, -9.9, -7.2, -29.300000000000075, -18.4, -7.4, -12.3, -9.3, -6.4, -10.899999999999999, -14.6, -17.600000000000005, -14.399999999999999, -17.6, -12.4, -23.300000000000004, -9.2, -24.9, -5.9, -23.199999999999996, -11.699999999999998, -13.2, -7.300000000000001, -20.799999999999997, -8.5, -16.39999999999999, -5.1, -19.7, -13.6, -7.399999999999999, -9.200000000000001, -4.3, -15.399999999999986, -12.6, -9.7, -7.2, -18.6, -12.600000000000001, -12.2, -4.4, -29.00000000000005, -16.4, -4.3, -4.4, -26.700000000000003, -21.700000000000003, -13.399999999999997, -19.3, -7.3, -12.299999999999999, -10.3, -20.60000000000002, -6.2, -4.4, -7.3, -21.6, -12.299999999999997, -9.4, -14.0, -8.2, -18.500000000000004, -14.7, -12.899999999999999, -16.099999999999984, -9.099999999999998, -12.2, -4.4, -6.300000000000001, -7.2, -5.4, -42.300000000000004, -24.600000000000005, -14.799999999999999, -9.600000000000001, -8.2, -32.1, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0628289799428048, "mean_inference_ms": 1.4072272690599075, "mean_action_processing_ms": 0.07604951042374991, "mean_env_wait_ms": 6.399148222798564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2360000, "timesteps_this_iter": 0, "agent_timesteps_total": 2360000, "timers": {"sample_time_ms": 16022.255, "sample_throughput": 249.653, "load_time_ms": 0.371, "load_throughput": 10780886.775, "learn_time_ms": 7752.742, "learn_throughput": 515.947, "update_time_ms": 1.781}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.15490184567458126, "policy_loss": -0.01776773912571771, "vf_loss": 17.116892513921183, "vf_explained_var": 0.20398086969570448, "kl": 0.010004418886152198, "entropy": 0.21614858662729622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2360000, "num_agent_steps_sampled": 2360000, "num_steps_trained": 2360000, "num_agent_steps_trained": 2360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23760, "training_iteration": 590, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-13-30", "timestamp": 1643706810, "time_this_iter_s": 15.49641227722168, "time_total_s": 15838.775055885315, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3579.2661788463593, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 28.913636363636364, "ram_util_percent": 58.42272727272727}}
{"episode_reward_max": -3.4, "episode_reward_min": -98.99999999999994, "episode_reward_mean": -14.158000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.9, -5.9, -23.199999999999996, -11.699999999999998, -13.2, -7.300000000000001, -20.799999999999997, -8.5, -16.39999999999999, -5.1, -19.7, -13.6, -7.399999999999999, -9.200000000000001, -4.3, -15.399999999999986, -12.6, -9.7, -7.2, -18.6, -12.600000000000001, -12.2, -4.4, -29.00000000000005, -16.4, -4.3, -4.4, -26.700000000000003, -21.700000000000003, -13.399999999999997, -19.3, -7.3, -12.299999999999999, -10.3, -20.60000000000002, -6.2, -4.4, -7.3, -21.6, -12.299999999999997, -9.4, -14.0, -8.2, -18.500000000000004, -14.7, -12.899999999999999, -16.099999999999984, -9.099999999999998, -12.2, -4.4, -6.300000000000001, -7.2, -5.4, -42.300000000000004, -24.600000000000005, -14.799999999999999, -9.600000000000001, -8.2, -32.1, -5.300000000000001, -9.7, -6.4, -8.2, -18.199999999999996, -12.8, -4.4, -12.4, -28.10000000000004, -10.999999999999996, -11.3, -8.5, -37.00000000000005, -28.6, -7.199999999999999, -7.799999999999998, -8.3, -32.3, -7.1000000000000005, -13.2, -8.3, -5.4, -29.400000000000052, -5.3, -12.399999999999995, -3.4, -14.099999999999998, -6.300000000000001, -17.6, -14.399999999999999, -10.399999999999999, -7.2, -17.6, -21.400000000000002, -33.0, -7.4, -5.4, -4.4, -20.5, -98.99999999999994, -3.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0623296677516691, "mean_inference_ms": 1.4064523357817282, "mean_action_processing_ms": 0.0759966834678223, "mean_env_wait_ms": 6.394489561715684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2364000, "timesteps_this_iter": 0, "agent_timesteps_total": 2364000, "timers": {"sample_time_ms": 16006.894, "sample_throughput": 249.892, "load_time_ms": 0.371, "load_throughput": 10790594.289, "learn_time_ms": 7820.802, "learn_throughput": 511.457, "update_time_ms": 1.713}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.5957478944412483, "policy_loss": -0.025040948697395864, "vf_loss": 61.90593746644194, "vf_explained_var": 0.09975452711505274, "kl": 0.01152982195291476, "entropy": 0.24170546038176424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2364000, "num_agent_steps_sampled": 2364000, "num_steps_trained": 2364000, "num_agent_steps_trained": 2364000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23800, "training_iteration": 591, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-13-45", "timestamp": 1643706825, "time_this_iter_s": 15.80460786819458, "time_total_s": 15854.57966375351, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3595.070786714554, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 32.099999999999994, "ram_util_percent": 58.5}}
{"episode_reward_max": -3.3, "episode_reward_min": -98.99999999999994, "episode_reward_mean": -14.573000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.4, -14.0, -8.2, -18.500000000000004, -14.7, -12.899999999999999, -16.099999999999984, -9.099999999999998, -12.2, -4.4, -6.300000000000001, -7.2, -5.4, -42.300000000000004, -24.600000000000005, -14.799999999999999, -9.600000000000001, -8.2, -32.1, -5.300000000000001, -9.7, -6.4, -8.2, -18.199999999999996, -12.8, -4.4, -12.4, -28.10000000000004, -10.999999999999996, -11.3, -8.5, -37.00000000000005, -28.6, -7.199999999999999, -7.799999999999998, -8.3, -32.3, -7.1000000000000005, -13.2, -8.3, -5.4, -29.400000000000052, -5.3, -12.399999999999995, -3.4, -14.099999999999998, -6.300000000000001, -17.6, -14.399999999999999, -10.399999999999999, -7.2, -17.6, -21.400000000000002, -33.0, -7.4, -5.4, -4.4, -20.5, -98.99999999999994, -3.7, -7.4, -26.699999999999996, -7.999999999999998, -85.50000000000004, -18.5, -6.3, -24.4, -20.699999999999996, -15.4, -9.3, -5.300000000000001, -4.800000000000001, -3.3, -13.3, -15.499999999999998, -14.4, -8.399999999999999, -11.7, -6.300000000000001, -11.899999999999999, -8.3, -20.9, -7.300000000000001, -12.899999999999999, -5.300000000000001, -7.300000000000001, -10.1, -15.2, -13.3, -6.3, -19.200000000000003, -9.7, -16.099999999999998, -4.3, -19.700000000000006, -31.3, -9.7, -12.499999999999998, -7.4, -9.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0617100952543237, "mean_inference_ms": 1.4054681485105427, "mean_action_processing_ms": 0.07593824731185811, "mean_env_wait_ms": 6.3893313517208075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2368000, "timesteps_this_iter": 0, "agent_timesteps_total": 2368000, "timers": {"sample_time_ms": 16011.632, "sample_throughput": 249.818, "load_time_ms": 0.367, "load_throughput": 10898542.289, "learn_time_ms": 7821.331, "learn_throughput": 511.422, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.2887753105754914, "policy_loss": -0.025690355339658355, "vf_loss": 31.26370410118052, "vf_explained_var": 0.09580804968392977, "kl": 0.01219087663090907, "entropy": 0.22830402786212584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2368000, "num_agent_steps_sampled": 2368000, "num_steps_trained": 2368000, "num_agent_steps_trained": 2368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23840, "training_iteration": 592, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-14-00", "timestamp": 1643706840, "time_this_iter_s": 14.719426155090332, "time_total_s": 15869.2990899086, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3609.790212869644, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 33.909523809523805, "ram_util_percent": 58.528571428571425}}
{"episode_reward_max": -3.3, "episode_reward_min": -98.99999999999994, "episode_reward_mean": -14.11, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -29.400000000000052, -5.3, -12.399999999999995, -3.4, -14.099999999999998, -6.300000000000001, -17.6, -14.399999999999999, -10.399999999999999, -7.2, -17.6, -21.400000000000002, -33.0, -7.4, -5.4, -4.4, -20.5, -98.99999999999994, -3.7, -7.4, -26.699999999999996, -7.999999999999998, -85.50000000000004, -18.5, -6.3, -24.4, -20.699999999999996, -15.4, -9.3, -5.300000000000001, -4.800000000000001, -3.3, -13.3, -15.499999999999998, -14.4, -8.399999999999999, -11.7, -6.300000000000001, -11.899999999999999, -8.3, -20.9, -7.300000000000001, -12.899999999999999, -5.300000000000001, -7.300000000000001, -10.1, -15.2, -13.3, -6.3, -19.200000000000003, -9.7, -16.099999999999998, -4.3, -19.700000000000006, -31.3, -9.7, -12.499999999999998, -7.4, -9.0, -20.6, -5.2, -13.899999999999999, -14.6, -17.299999999999997, -27.20000000000001, -15.499999999999998, -10.4, -4.3, -5.4, -40.3, -9.799999999999999, -14.600000000000001, -6.2, -5.4, -13.099999999999996, -6.4, -6.2, -17.800000000000004, -17.5, -5.4, -14.19999999999999, -7.4, -6.300000000000001, -10.8, -7.3, -14.899999999999999, -9.3, -5.4, -16.4, -9.0, -20.5, -9.4, -10.4, -16.799999999999997, -29.3, -8.3, -7.300000000000001, -26.10000000000001, -3.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.060858606077464, "mean_inference_ms": 1.4044824717301194, "mean_action_processing_ms": 0.07588541288855796, "mean_env_wait_ms": 6.384605001102125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2372000, "timesteps_this_iter": 0, "agent_timesteps_total": 2372000, "timers": {"sample_time_ms": 16060.3, "sample_throughput": 249.061, "load_time_ms": 0.34, "load_throughput": 11764403.618, "learn_time_ms": 7807.467, "learn_throughput": 512.33, "update_time_ms": 1.787}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.12853194912545063, "policy_loss": -0.01766832651149842, "vf_loss": 14.458454739919272, "vf_explained_var": 0.2421238903076418, "kl": 0.010771554349717957, "entropy": 0.2727434758617673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2372000, "num_agent_steps_sampled": 2372000, "num_steps_trained": 2372000, "num_agent_steps_trained": 2372000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23880, "training_iteration": 593, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-14-16", "timestamp": 1643706856, "time_this_iter_s": 15.59171199798584, "time_total_s": 15884.890801906586, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3625.38192486763, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 34.13478260869566, "ram_util_percent": 58.539130434782614}}
{"episode_reward_max": -3.3, "episode_reward_min": -66.4, "episode_reward_mean": -12.763000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -20.9, -7.300000000000001, -12.899999999999999, -5.300000000000001, -7.300000000000001, -10.1, -15.2, -13.3, -6.3, -19.200000000000003, -9.7, -16.099999999999998, -4.3, -19.700000000000006, -31.3, -9.7, -12.499999999999998, -7.4, -9.0, -20.6, -5.2, -13.899999999999999, -14.6, -17.299999999999997, -27.20000000000001, -15.499999999999998, -10.4, -4.3, -5.4, -40.3, -9.799999999999999, -14.600000000000001, -6.2, -5.4, -13.099999999999996, -6.4, -6.2, -17.800000000000004, -17.5, -5.4, -14.19999999999999, -7.4, -6.300000000000001, -10.8, -7.3, -14.899999999999999, -9.3, -5.4, -16.4, -9.0, -20.5, -9.4, -10.4, -16.799999999999997, -29.3, -8.3, -7.300000000000001, -26.10000000000001, -3.6000000000000005, -17.5, -7.3, -11.499999999999996, -17.799999999999997, -13.799999999999997, -9.7, -13.899999999999999, -7.300000000000001, -15.1, -6.3, -11.4, -10.2, -7.4, -13.5, -4.4, -10.799999999999999, -11.2, -7.2, -6.1, -5.800000000000001, -7.499999999999999, -11.0, -14.2, -11.600000000000001, -3.3, -15.799999999999997, -7.699999999999999, -22.000000000000014, -13.5, -24.9, -7.499999999999999, -5.8999999999999995, -8.3, -10.5, -13.8, -16.099999999999998, -21.0, -16.7, -14.799999999999999, -66.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0600546438587304, "mean_inference_ms": 1.40344786901992, "mean_action_processing_ms": 0.07583025679632795, "mean_env_wait_ms": 6.379635541998802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2376000, "timesteps_this_iter": 0, "agent_timesteps_total": 2376000, "timers": {"sample_time_ms": 15941.527, "sample_throughput": 250.917, "load_time_ms": 0.341, "load_throughput": 11715932.961, "learn_time_ms": 7733.989, "learn_throughput": 517.198, "update_time_ms": 1.775}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.16055868594176187, "policy_loss": -0.031192392545441785, "vf_loss": 18.992909346857378, "vf_explained_var": 0.25628192482456086, "kl": 0.012146573061616489, "entropy": 0.2838794366486611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2376000, "num_agent_steps_sampled": 2376000, "num_steps_trained": 2376000, "num_agent_steps_trained": 2376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23920, "training_iteration": 594, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-14-31", "timestamp": 1643706871, "time_this_iter_s": 15.356344938278198, "time_total_s": 15900.247146844864, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3640.738269805908, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 30.02380952380953, "ram_util_percent": 58.59999999999999}}
{"episode_reward_max": -3.3, "episode_reward_min": -87.6000000000001, "episode_reward_mean": -13.485000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -14.19999999999999, -7.4, -6.300000000000001, -10.8, -7.3, -14.899999999999999, -9.3, -5.4, -16.4, -9.0, -20.5, -9.4, -10.4, -16.799999999999997, -29.3, -8.3, -7.300000000000001, -26.10000000000001, -3.6000000000000005, -17.5, -7.3, -11.499999999999996, -17.799999999999997, -13.799999999999997, -9.7, -13.899999999999999, -7.300000000000001, -15.1, -6.3, -11.4, -10.2, -7.4, -13.5, -4.4, -10.799999999999999, -11.2, -7.2, -6.1, -5.800000000000001, -7.499999999999999, -11.0, -14.2, -11.600000000000001, -3.3, -15.799999999999997, -7.699999999999999, -22.000000000000014, -13.5, -24.9, -7.499999999999999, -5.8999999999999995, -8.3, -10.5, -13.8, -16.099999999999998, -21.0, -16.7, -14.799999999999999, -66.4, -5.4, -6.799999999999999, -23.800000000000036, -9.099999999999998, -10.599999999999998, -3.6000000000000005, -10.3, -6.5, -5.3, -20.9, -4.300000000000001, -6.4, -13.799999999999999, -8.2, -3.6, -20.499999999999996, -16.599999999999998, -23.3, -66.3, -26.800000000000004, -9.399999999999999, -13.1, -4.2, -19.200000000000003, -19.100000000000026, -5.300000000000001, -15.199999999999998, -6.1, -8.3, -6.8, -20.700000000000003, -87.6000000000001, -12.600000000000001, -7.300000000000001, -6.3, -10.8, -3.4, -19.7, -10.3, -12.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0594887095439103, "mean_inference_ms": 1.4025550981741688, "mean_action_processing_ms": 0.0757833744761385, "mean_env_wait_ms": 6.375222325775497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2380000, "timesteps_this_iter": 0, "agent_timesteps_total": 2380000, "timers": {"sample_time_ms": 15769.882, "sample_throughput": 253.648, "load_time_ms": 0.34, "load_throughput": 11757807.835, "learn_time_ms": 7706.001, "learn_throughput": 519.076, "update_time_ms": 1.696}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.5050126729327785, "policy_loss": -0.019948815344332127, "vf_loss": 52.39522759017124, "vf_explained_var": -0.09162207348372346, "kl": 0.006728074962597299, "entropy": 0.2532676156089511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2380000, "num_agent_steps_sampled": 2380000, "num_steps_trained": 2380000, "num_agent_steps_trained": 2380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 23960, "training_iteration": 595, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-14-47", "timestamp": 1643706887, "time_this_iter_s": 16.034634828567505, "time_total_s": 15916.281781673431, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3656.7729046344757, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 36.31739130434782, "ram_util_percent": 58.59999999999998}}
{"episode_reward_max": -3.3, "episode_reward_min": -87.6000000000001, "episode_reward_mean": -13.925000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.499999999999999, -11.0, -14.2, -11.600000000000001, -3.3, -15.799999999999997, -7.699999999999999, -22.000000000000014, -13.5, -24.9, -7.499999999999999, -5.8999999999999995, -8.3, -10.5, -13.8, -16.099999999999998, -21.0, -16.7, -14.799999999999999, -66.4, -5.4, -6.799999999999999, -23.800000000000036, -9.099999999999998, -10.599999999999998, -3.6000000000000005, -10.3, -6.5, -5.3, -20.9, -4.300000000000001, -6.4, -13.799999999999999, -8.2, -3.6, -20.499999999999996, -16.599999999999998, -23.3, -66.3, -26.800000000000004, -9.399999999999999, -13.1, -4.2, -19.200000000000003, -19.100000000000026, -5.300000000000001, -15.199999999999998, -6.1, -8.3, -6.8, -20.700000000000003, -87.6000000000001, -12.600000000000001, -7.300000000000001, -6.3, -10.8, -3.4, -19.7, -10.3, -12.2, -22.699999999999996, -8.3, -18.099999999999994, -5.300000000000001, -4.4, -8.399999999999999, -14.9, -12.3, -17.3, -7.099999999999998, -23.299999999999997, -16.1, -9.4, -6.4, -9.3, -5.4, -18.199999999999996, -13.600000000000001, -5.300000000000001, -10.6, -31.2, -15.7, -14.2, -27.2, -6.2, -8.2, -4.4, -19.1, -4.2, -5.2, -3.6000000000000005, -16.3, -7.6000000000000005, -4.4, -16.799999999999997, -15.600000000000001, -16.4, -6.5, -17.2, -13.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0589134389500041, "mean_inference_ms": 1.401618910322337, "mean_action_processing_ms": 0.07573418332142204, "mean_env_wait_ms": 6.370525086739933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2384000, "timesteps_this_iter": 0, "agent_timesteps_total": 2384000, "timers": {"sample_time_ms": 15715.816, "sample_throughput": 254.521, "load_time_ms": 0.344, "load_throughput": 11639528.236, "learn_time_ms": 7676.583, "learn_throughput": 521.065, "update_time_ms": 1.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.08827152408043583, "policy_loss": -0.02004046767689688, "vf_loss": 10.641293487818011, "vf_explained_var": 0.268771598351899, "kl": 0.012660401541666486, "entropy": 0.23626066296091003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2384000, "num_agent_steps_sampled": 2384000, "num_steps_trained": 2384000, "num_agent_steps_trained": 2384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24000, "training_iteration": 596, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-15-03", "timestamp": 1643706903, "time_this_iter_s": 15.312138080596924, "time_total_s": 15931.593919754028, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3672.0850427150726, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 31.83181818181818, "ram_util_percent": 58.44545454545457}}
{"episode_reward_max": -3.2, "episode_reward_min": -87.6000000000001, "episode_reward_mean": -12.363000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.399999999999999, -13.1, -4.2, -19.200000000000003, -19.100000000000026, -5.300000000000001, -15.199999999999998, -6.1, -8.3, -6.8, -20.700000000000003, -87.6000000000001, -12.600000000000001, -7.300000000000001, -6.3, -10.8, -3.4, -19.7, -10.3, -12.2, -22.699999999999996, -8.3, -18.099999999999994, -5.300000000000001, -4.4, -8.399999999999999, -14.9, -12.3, -17.3, -7.099999999999998, -23.299999999999997, -16.1, -9.4, -6.4, -9.3, -5.4, -18.199999999999996, -13.600000000000001, -5.300000000000001, -10.6, -31.2, -15.7, -14.2, -27.2, -6.2, -8.2, -4.4, -19.1, -4.2, -5.2, -3.6000000000000005, -16.3, -7.6000000000000005, -4.4, -16.799999999999997, -15.600000000000001, -16.4, -6.5, -17.2, -13.899999999999999, -7.300000000000001, -27.900000000000045, -6.800000000000001, -15.299999999999997, -4.300000000000001, -3.4, -5.2, -3.3, -8.4, -11.700000000000001, -18.900000000000006, -3.2, -13.199999999999976, -15.5, -9.599999999999998, -6.2, -9.3, -15.7, -9.2, -3.4, -4.4, -5.300000000000001, -10.799999999999997, -17.700000000000003, -24.6, -15.8, -17.299999999999997, -8.799999999999999, -5.300000000000001, -5.2, -11.2, -5.300000000000001, -5.300000000000001, -17.999999999999996, -4.2, -27.600000000000005, -10.4, -19.799999999999997, -12.899999999999999, -20.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0583884738101559, "mean_inference_ms": 1.4006940810536295, "mean_action_processing_ms": 0.07568479206552611, "mean_env_wait_ms": 6.365771981012062, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2388000, "timesteps_this_iter": 0, "agent_timesteps_total": 2388000, "timers": {"sample_time_ms": 15651.944, "sample_throughput": 255.559, "load_time_ms": 0.342, "load_throughput": 11689810.479, "learn_time_ms": 7604.231, "learn_throughput": 526.023, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.07296430340377233, "policy_loss": -0.0127557239685488, "vf_loss": 8.449703822437153, "vf_explained_var": 0.3051572416418342, "kl": 0.008153280191358081, "entropy": 0.20826718913371203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2388000, "num_agent_steps_sampled": 2388000, "num_steps_trained": 2388000, "num_agent_steps_trained": 2388000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24040, "training_iteration": 597, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-15-18", "timestamp": 1643706918, "time_this_iter_s": 15.764229774475098, "time_total_s": 15947.358149528503, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3687.8492724895477, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 30.413043478260878, "ram_util_percent": 58.40000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -61.3, "episode_reward_mean": -12.856, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.2, -15.7, -14.2, -27.2, -6.2, -8.2, -4.4, -19.1, -4.2, -5.2, -3.6000000000000005, -16.3, -7.6000000000000005, -4.4, -16.799999999999997, -15.600000000000001, -16.4, -6.5, -17.2, -13.899999999999999, -7.300000000000001, -27.900000000000045, -6.800000000000001, -15.299999999999997, -4.300000000000001, -3.4, -5.2, -3.3, -8.4, -11.700000000000001, -18.900000000000006, -3.2, -13.199999999999976, -15.5, -9.599999999999998, -6.2, -9.3, -15.7, -9.2, -3.4, -4.4, -5.300000000000001, -10.799999999999997, -17.700000000000003, -24.6, -15.8, -17.299999999999997, -8.799999999999999, -5.300000000000001, -5.2, -11.2, -5.300000000000001, -5.300000000000001, -17.999999999999996, -4.2, -27.600000000000005, -10.4, -19.799999999999997, -12.899999999999999, -20.7, -20.599999999999998, -6.2, -6.4, -13.799999999999994, -9.7, -4.3, -46.1, -61.3, -5.4, -20.799999999999997, -5.300000000000001, -21.6, -15.9, -14.799999999999997, -7.999999999999998, -8.0, -35.2, -13.899999999999999, -11.199999999999987, -6.4, -14.399999999999999, -21.099999999999994, -5.1, -21.599999999999998, -6.2, -28.300000000000004, -16.19999999999997, -5.300000000000001, -4.3, -15.499999999999998, -8.700000000000001, -17.0, -10.6, -8.2, -7.999999999999998, -6.1, -7.300000000000001, -26.099999999999994, -5.4, -13.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0576637683124828, "mean_inference_ms": 1.399671021877836, "mean_action_processing_ms": 0.07562971974382152, "mean_env_wait_ms": 6.360621185541861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2392000, "timesteps_this_iter": 0, "agent_timesteps_total": 2392000, "timers": {"sample_time_ms": 15555.187, "sample_throughput": 257.149, "load_time_ms": 0.335, "load_throughput": 11937680.376, "learn_time_ms": 7545.525, "learn_throughput": 530.116, "update_time_ms": 1.718}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.22027114521366575, "policy_loss": -0.021341338237967862, "vf_loss": 23.981973576289352, "vf_explained_var": 0.16036877850050568, "kl": 0.011951693704761122, "entropy": 0.24724077782643739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2392000, "num_agent_steps_sampled": 2392000, "num_steps_trained": 2392000, "num_agent_steps_trained": 2392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24080, "training_iteration": 598, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-15-34", "timestamp": 1643706934, "time_this_iter_s": 15.111339092254639, "time_total_s": 15962.469488620758, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3702.9606115818024, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 33.01428571428572, "ram_util_percent": 58.40476190476191}}
{"episode_reward_max": -2.5, "episode_reward_min": -61.3, "episode_reward_mean": -12.903999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -5.300000000000001, -10.799999999999997, -17.700000000000003, -24.6, -15.8, -17.299999999999997, -8.799999999999999, -5.300000000000001, -5.2, -11.2, -5.300000000000001, -5.300000000000001, -17.999999999999996, -4.2, -27.600000000000005, -10.4, -19.799999999999997, -12.899999999999999, -20.7, -20.599999999999998, -6.2, -6.4, -13.799999999999994, -9.7, -4.3, -46.1, -61.3, -5.4, -20.799999999999997, -5.300000000000001, -21.6, -15.9, -14.799999999999997, -7.999999999999998, -8.0, -35.2, -13.899999999999999, -11.199999999999987, -6.4, -14.399999999999999, -21.099999999999994, -5.1, -21.599999999999998, -6.2, -28.300000000000004, -16.19999999999997, -5.300000000000001, -4.3, -15.499999999999998, -8.700000000000001, -17.0, -10.6, -8.2, -7.999999999999998, -6.1, -7.300000000000001, -26.099999999999994, -5.4, -13.0, -12.099999999999984, -10.9, -7.300000000000001, -4.300000000000001, -3.4, -20.4, -4.3, -14.7, -17.2, -4.300000000000001, -22.199999999999996, -7.4, -18.0, -19.3, -6.3, -9.4, -2.5, -3.3, -6.300000000000001, -39.1, -8.399999999999999, -13.999999999999996, -6.4, -5.4, -12.1, -5.5, -5.3999999999999995, -6.4, -5.1, -7.2, -14.5, -9.3, -14.399999999999983, -14.19999999999997, -21.1, -33.60000000000001, -12.6, -14.799999999999999, -5.3, -8.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0569115575077572, "mean_inference_ms": 1.3987205674784888, "mean_action_processing_ms": 0.07557880102386944, "mean_env_wait_ms": 6.355914130532748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2396000, "timesteps_this_iter": 0, "agent_timesteps_total": 2396000, "timers": {"sample_time_ms": 15495.875, "sample_throughput": 258.133, "load_time_ms": 0.331, "load_throughput": 12096046.143, "learn_time_ms": 7575.819, "learn_throughput": 527.996, "update_time_ms": 1.732}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.10555785061360928, "policy_loss": -0.025878128171547925, "vf_loss": 12.99852739444343, "vf_explained_var": 0.2641385989804422, "kl": 0.009671378747332274, "entropy": 0.2601579245740688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2396000, "num_agent_steps_sampled": 2396000, "num_steps_trained": 2396000, "num_agent_steps_trained": 2396000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24120, "training_iteration": 599, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-15-49", "timestamp": 1643706949, "time_this_iter_s": 15.761145114898682, "time_total_s": 15978.230633735657, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3718.721756696701, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 33.27826086956522, "ram_util_percent": 58.5}}
{"episode_reward_max": -2.5, "episode_reward_min": -39.1, "episode_reward_mean": -11.704, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.399999999999999, -21.099999999999994, -5.1, -21.599999999999998, -6.2, -28.300000000000004, -16.19999999999997, -5.300000000000001, -4.3, -15.499999999999998, -8.700000000000001, -17.0, -10.6, -8.2, -7.999999999999998, -6.1, -7.300000000000001, -26.099999999999994, -5.4, -13.0, -12.099999999999984, -10.9, -7.300000000000001, -4.300000000000001, -3.4, -20.4, -4.3, -14.7, -17.2, -4.300000000000001, -22.199999999999996, -7.4, -18.0, -19.3, -6.3, -9.4, -2.5, -3.3, -6.300000000000001, -39.1, -8.399999999999999, -13.999999999999996, -6.4, -5.4, -12.1, -5.5, -5.3999999999999995, -6.4, -5.1, -7.2, -14.5, -9.3, -14.399999999999983, -14.19999999999997, -21.1, -33.60000000000001, -12.6, -14.799999999999999, -5.3, -8.1, -18.3, -8.3, -5.3, -30.00000000000006, -4.4, -9.3, -13.699999999999998, -3.900000000000001, -4.800000000000001, -19.5, -7.599999999999999, -11.4, -17.9, -3.4, -18.1, -5.300000000000001, -4.2, -18.799999999999997, -17.2, -16.5, -3.4, -6.1, -12.199999999999974, -5.4, -13.700000000000001, -24.3, -12.399999999999999, -3.3, -20.7, -11.899999999999999, -12.8, -5.3, -35.10000000000009, -4.300000000000001, -4.700000000000001, -6.5, -6.2, -14.999999999999979, -20.5, -3.8000000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0560655757735273, "mean_inference_ms": 1.3977402015769378, "mean_action_processing_ms": 0.07552508027360176, "mean_env_wait_ms": 6.351327992249882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2400000, "timesteps_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"sample_time_ms": 15508.508, "sample_throughput": 257.923, "load_time_ms": 0.319, "load_throughput": 12531532.716, "learn_time_ms": 7552.393, "learn_throughput": 529.633, "update_time_ms": 1.661}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.10675520741941548, "policy_loss": -0.014432050444446103, "vf_loss": 11.964060415631982, "vf_explained_var": 0.18266322670444365, "kl": 0.010311033336229836, "entropy": 0.22751342554086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2400000, "num_agent_steps_sampled": 2400000, "num_steps_trained": 2400000, "num_agent_steps_trained": 2400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24160, "training_iteration": 600, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-16-04", "timestamp": 1643706964, "time_this_iter_s": 15.08665680885315, "time_total_s": 15993.31729054451, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3733.808413505554, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 30.938095238095237, "ram_util_percent": 58.39047619047619}}
{"episode_reward_max": -3.3, "episode_reward_min": -71.10000000000002, "episode_reward_mean": -12.427, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.399999999999999, -13.999999999999996, -6.4, -5.4, -12.1, -5.5, -5.3999999999999995, -6.4, -5.1, -7.2, -14.5, -9.3, -14.399999999999983, -14.19999999999997, -21.1, -33.60000000000001, -12.6, -14.799999999999999, -5.3, -8.1, -18.3, -8.3, -5.3, -30.00000000000006, -4.4, -9.3, -13.699999999999998, -3.900000000000001, -4.800000000000001, -19.5, -7.599999999999999, -11.4, -17.9, -3.4, -18.1, -5.300000000000001, -4.2, -18.799999999999997, -17.2, -16.5, -3.4, -6.1, -12.199999999999974, -5.4, -13.700000000000001, -24.3, -12.399999999999999, -3.3, -20.7, -11.899999999999999, -12.8, -5.3, -35.10000000000009, -4.300000000000001, -4.700000000000001, -6.5, -6.2, -14.999999999999979, -20.5, -3.8000000000000003, -71.10000000000002, -4.2, -13.700000000000001, -4.6000000000000005, -14.39999999999999, -23.000000000000007, -6.4, -6.2, -4.4, -7.1, -39.3, -26.2, -12.499999999999998, -16.5, -10.3, -14.899999999999999, -4.4, -17.1, -5.300000000000001, -42.4, -13.4, -3.3, -15.5, -4.2, -3.4, -4.2, -27.000000000000007, -4.4, -5.2, -15.6, -14.199999999999998, -5.300000000000001, -13.599999999999996, -10.3, -25.7, -6.300000000000001, -13.899999999999999, -3.8000000000000003, -5.1, -14.999999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0553687370011822, "mean_inference_ms": 1.3968015555617146, "mean_action_processing_ms": 0.07547281632097123, "mean_env_wait_ms": 6.34685593569777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2404000, "timesteps_this_iter": 0, "agent_timesteps_total": 2404000, "timers": {"sample_time_ms": 15483.637, "sample_throughput": 258.337, "load_time_ms": 0.328, "load_throughput": 12206938.3, "learn_time_ms": 7552.978, "learn_throughput": 529.592, "update_time_ms": 1.664}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.3469631559558473, "policy_loss": -0.01866338948609047, "vf_loss": 36.41440963995072, "vf_explained_var": 0.27982428099519463, "kl": 0.009883043664069195, "entropy": 0.21760572749440388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2404000, "num_agent_steps_sampled": 2404000, "num_steps_trained": 2404000, "num_agent_steps_trained": 2404000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24200, "training_iteration": 601, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-16-20", "timestamp": 1643706980, "time_this_iter_s": 15.802103042602539, "time_total_s": 16009.119393587112, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3749.6105165481567, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 32.30000000000001, "ram_util_percent": 58.41304347826088}}
{"episode_reward_max": -3.3, "episode_reward_min": -71.10000000000002, "episode_reward_mean": -12.116, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -6.1, -12.199999999999974, -5.4, -13.700000000000001, -24.3, -12.399999999999999, -3.3, -20.7, -11.899999999999999, -12.8, -5.3, -35.10000000000009, -4.300000000000001, -4.700000000000001, -6.5, -6.2, -14.999999999999979, -20.5, -3.8000000000000003, -71.10000000000002, -4.2, -13.700000000000001, -4.6000000000000005, -14.39999999999999, -23.000000000000007, -6.4, -6.2, -4.4, -7.1, -39.3, -26.2, -12.499999999999998, -16.5, -10.3, -14.899999999999999, -4.4, -17.1, -5.300000000000001, -42.4, -13.4, -3.3, -15.5, -4.2, -3.4, -4.2, -27.000000000000007, -4.4, -5.2, -15.6, -14.199999999999998, -5.300000000000001, -13.599999999999996, -10.3, -25.7, -6.300000000000001, -13.899999999999999, -3.8000000000000003, -5.1, -14.999999999999996, -50.100000000000115, -17.799999999999997, -5.300000000000001, -18.0, -4.2, -14.399999999999999, -4.3, -29.2, -10.399999999999999, -3.3, -11.4, -4.2, -5.300000000000001, -22.8, -10.3, -10.2, -16.699999999999996, -3.3, -6.2, -7.4, -15.399999999999999, -4.2, -12.199999999999998, -8.3, -6.3, -9.2, -4.4, -3.4, -5.499999999999999, -7.599999999999999, -16.799999999999997, -17.199999999999996, -3.8000000000000007, -13.6, -3.4, -14.299999999999997, -16.3, -4.3, -5.300000000000001, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.054704297542174, "mean_inference_ms": 1.3958120227445505, "mean_action_processing_ms": 0.07541824525753413, "mean_env_wait_ms": 6.342180045553571, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2408000, "timesteps_this_iter": 0, "agent_timesteps_total": 2408000, "timers": {"sample_time_ms": 15512.808, "sample_throughput": 257.851, "load_time_ms": 0.355, "load_throughput": 11259876.51, "learn_time_ms": 7566.075, "learn_throughput": 528.676, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.12153023313806062, "policy_loss": -0.02384826190248933, "vf_loss": 14.39372276971417, "vf_explained_var": 0.08565805265980382, "kl": 0.009608481412493501, "entropy": 0.2366864944617915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2408000, "num_agent_steps_sampled": 2408000, "num_steps_trained": 2408000, "num_agent_steps_trained": 2408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24240, "training_iteration": 602, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-16-35", "timestamp": 1643706995, "time_this_iter_s": 15.136695861816406, "time_total_s": 16024.256089448929, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3764.747212409973, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 32.46666666666666, "ram_util_percent": 58.40000000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -50.100000000000115, "episode_reward_mean": -10.818000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.4, -3.3, -15.5, -4.2, -3.4, -4.2, -27.000000000000007, -4.4, -5.2, -15.6, -14.199999999999998, -5.300000000000001, -13.599999999999996, -10.3, -25.7, -6.300000000000001, -13.899999999999999, -3.8000000000000003, -5.1, -14.999999999999996, -50.100000000000115, -17.799999999999997, -5.300000000000001, -18.0, -4.2, -14.399999999999999, -4.3, -29.2, -10.399999999999999, -3.3, -11.4, -4.2, -5.300000000000001, -22.8, -10.3, -10.2, -16.699999999999996, -3.3, -6.2, -7.4, -15.399999999999999, -4.2, -12.199999999999998, -8.3, -6.3, -9.2, -4.4, -3.4, -5.499999999999999, -7.599999999999999, -16.799999999999997, -17.199999999999996, -3.8000000000000007, -13.6, -3.4, -14.299999999999997, -16.3, -4.3, -5.300000000000001, -4.300000000000001, -19.5, -8.7, -6.3, -4.2, -9.4, -5.3, -17.599999999999998, -3.2, -6.1, -22.3, -4.9, -14.3, -10.299999999999997, -13.799999999999997, -10.599999999999998, -3.3, -22.400000000000002, -21.599999999999998, -17.0, -5.300000000000001, -3.4, -14.4, -16.099999999999998, -5.300000000000001, -4.5, -16.9, -5.2, -16.4, -5.300000000000001, -11.899999999999999, -25.700000000000085, -9.3, -14.799999999999997, -7.4, -16.299999999999997, -3.3, -7.2, -6.300000000000001, -16.0, -10.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0540853347017798, "mean_inference_ms": 1.395001872291, "mean_action_processing_ms": 0.07537396665434767, "mean_env_wait_ms": 6.338406019857453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2412000, "timesteps_this_iter": 0, "agent_timesteps_total": 2412000, "timers": {"sample_time_ms": 15555.056, "sample_throughput": 257.151, "load_time_ms": 0.36, "load_throughput": 11097510.253, "learn_time_ms": 7672.665, "learn_throughput": 521.331, "update_time_ms": 1.593}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.07629322791484595, "policy_loss": -0.011319818068796427, "vf_loss": 8.5459765898925, "vf_explained_var": 0.27109597299688604, "kl": 0.01435521201231488, "entropy": 0.23007977516740882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2412000, "num_agent_steps_sampled": 2412000, "num_steps_trained": 2412000, "num_agent_steps_trained": 2412000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24280, "training_iteration": 603, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-16-52", "timestamp": 1643707012, "time_this_iter_s": 16.94852614402771, "time_total_s": 16041.204615592957, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3781.695738554001, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 36.256, "ram_util_percent": 58.44}}
{"episode_reward_max": -3.2, "episode_reward_min": -37.6, "episode_reward_mean": -10.784, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.399999999999999, -4.2, -12.199999999999998, -8.3, -6.3, -9.2, -4.4, -3.4, -5.499999999999999, -7.599999999999999, -16.799999999999997, -17.199999999999996, -3.8000000000000007, -13.6, -3.4, -14.299999999999997, -16.3, -4.3, -5.300000000000001, -4.300000000000001, -19.5, -8.7, -6.3, -4.2, -9.4, -5.3, -17.599999999999998, -3.2, -6.1, -22.3, -4.9, -14.3, -10.299999999999997, -13.799999999999997, -10.599999999999998, -3.3, -22.400000000000002, -21.599999999999998, -17.0, -5.300000000000001, -3.4, -14.4, -16.099999999999998, -5.300000000000001, -4.5, -16.9, -5.2, -16.4, -5.300000000000001, -11.899999999999999, -25.700000000000085, -9.3, -14.799999999999997, -7.4, -16.299999999999997, -3.3, -7.2, -6.300000000000001, -16.0, -10.0, -6.3, -4.2, -12.09999999999999, -16.099999999999994, -7.4, -5.3, -4.2, -6.2, -15.799999999999999, -13.3, -31.79999999999999, -5.299999999999999, -14.999999999999998, -22.5, -21.20000000000001, -4.2, -4.300000000000001, -5.9, -12.3, -4.4, -5.300000000000001, -37.6, -6.4, -10.3, -22.800000000000004, -9.9, -8.999999999999998, -10.7, -16.799999999999972, -10.5, -7.600000000000001, -10.999999999999998, -8.7, -9.7, -10.399999999999999, -11.2, -15.700000000000001, -6.9, -8.3, -14.199999999999976], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0536145801507888, "mean_inference_ms": 1.3944306548677008, "mean_action_processing_ms": 0.07534286189516509, "mean_env_wait_ms": 6.335694170467648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2416000, "timesteps_this_iter": 0, "agent_timesteps_total": 2416000, "timers": {"sample_time_ms": 15762.877, "sample_throughput": 253.761, "load_time_ms": 0.367, "load_throughput": 10903500.357, "learn_time_ms": 7692.064, "learn_throughput": 520.016, "update_time_ms": 1.592}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.09991928526170311, "policy_loss": -0.01672599527744516, "vf_loss": 11.444652304630125, "vf_explained_var": 0.23463600226627884, "kl": 0.014658401531042458, "entropy": 0.29737215259623145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2416000, "num_agent_steps_sampled": 2416000, "num_steps_trained": 2416000, "num_agent_steps_trained": 2416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24320, "training_iteration": 604, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-17-09", "timestamp": 1643707029, "time_this_iter_s": 16.565653085708618, "time_total_s": 16057.770268678665, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3798.2613916397095, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 30.178260869565218, "ram_util_percent": 58.53043478260869}}
{"episode_reward_max": -3.3, "episode_reward_min": -87.80000000000005, "episode_reward_mean": -12.001999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -14.4, -16.099999999999998, -5.300000000000001, -4.5, -16.9, -5.2, -16.4, -5.300000000000001, -11.899999999999999, -25.700000000000085, -9.3, -14.799999999999997, -7.4, -16.299999999999997, -3.3, -7.2, -6.300000000000001, -16.0, -10.0, -6.3, -4.2, -12.09999999999999, -16.099999999999994, -7.4, -5.3, -4.2, -6.2, -15.799999999999999, -13.3, -31.79999999999999, -5.299999999999999, -14.999999999999998, -22.5, -21.20000000000001, -4.2, -4.300000000000001, -5.9, -12.3, -4.4, -5.300000000000001, -37.6, -6.4, -10.3, -22.800000000000004, -9.9, -8.999999999999998, -10.7, -16.799999999999972, -10.5, -7.600000000000001, -10.999999999999998, -8.7, -9.7, -10.399999999999999, -11.2, -15.700000000000001, -6.9, -8.3, -14.199999999999976, -28.3, -22.700000000000006, -8.0, -5.1, -10.3, -21.3, -3.4, -6.4, -10.999999999999998, -22.6, -20.4, -17.5, -12.7, -25.2, -8.5, -12.2, -9.4, -10.899999999999997, -12.2, -5.7, -14.299999999999997, -4.4, -14.799999999999997, -6.300000000000001, -3.4, -4.2, -3.3, -6.300000000000001, -7.099999999999999, -87.80000000000005, -10.2, -22.300000000000015, -4.4, -14.799999999999999, -12.2, -11.600000000000001, -3.8000000000000007, -3.3, -9.099999999999998, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.053161040092925, "mean_inference_ms": 1.3939325975192298, "mean_action_processing_ms": 0.07531674413872942, "mean_env_wait_ms": 6.333323278674352, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2420000, "timesteps_this_iter": 0, "agent_timesteps_total": 2420000, "timers": {"sample_time_ms": 15801.626, "sample_throughput": 253.139, "load_time_ms": 0.368, "load_throughput": 10882989.102, "learn_time_ms": 7697.349, "learn_throughput": 519.659, "update_time_ms": 1.597}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.4280489499770826, "policy_loss": -0.02785366954862751, "vf_loss": 45.44318980603449, "vf_explained_var": 0.14692851298598833, "kl": 0.009804821342885295, "entropy": 0.25617632200160334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2420000, "num_agent_steps_sampled": 2420000, "num_steps_trained": 2420000, "num_agent_steps_trained": 2420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24360, "training_iteration": 605, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-17-25", "timestamp": 1643707045, "time_this_iter_s": 16.27164888381958, "time_total_s": 16074.041917562485, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3814.533040523529, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 29.97826086956521, "ram_util_percent": 58.591304347826075}}
{"episode_reward_max": -3.2, "episode_reward_min": -87.80000000000005, "episode_reward_mean": -11.527000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -37.6, -6.4, -10.3, -22.800000000000004, -9.9, -8.999999999999998, -10.7, -16.799999999999972, -10.5, -7.600000000000001, -10.999999999999998, -8.7, -9.7, -10.399999999999999, -11.2, -15.700000000000001, -6.9, -8.3, -14.199999999999976, -28.3, -22.700000000000006, -8.0, -5.1, -10.3, -21.3, -3.4, -6.4, -10.999999999999998, -22.6, -20.4, -17.5, -12.7, -25.2, -8.5, -12.2, -9.4, -10.899999999999997, -12.2, -5.7, -14.299999999999997, -4.4, -14.799999999999997, -6.300000000000001, -3.4, -4.2, -3.3, -6.300000000000001, -7.099999999999999, -87.80000000000005, -10.2, -22.300000000000015, -4.4, -14.799999999999999, -12.2, -11.600000000000001, -3.8000000000000007, -3.3, -9.099999999999998, -6.300000000000001, -5.1, -18.5, -5.3, -10.799999999999999, -10.1, -4.300000000000001, -12.299999999999997, -10.7, -3.4, -11.899999999999997, -4.300000000000001, -10.7, -18.1, -4.2, -15.199999999999998, -6.2, -8.299999999999997, -13.799999999999999, -11.699999999999998, -10.199999999999998, -5.2, -4.300000000000001, -6.3, -6.300000000000001, -15.999999999999998, -10.2, -3.2, -7.4, -11.999999999999998, -3.4, -37.3, -5.2, -17.5, -3.4, -4.2, -5.300000000000001, -8.700000000000001, -14.2, -15.5, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.052572729712994, "mean_inference_ms": 1.393520789261709, "mean_action_processing_ms": 0.0752944680649658, "mean_env_wait_ms": 6.331395515211326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2424000, "timesteps_this_iter": 0, "agent_timesteps_total": 2424000, "timers": {"sample_time_ms": 15907.2, "sample_throughput": 251.458, "load_time_ms": 0.362, "load_throughput": 11053640.796, "learn_time_ms": 7775.507, "learn_throughput": 514.436, "update_time_ms": 1.604}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.05059978566382842, "policy_loss": -0.021410759057729475, "vf_loss": 7.054736209364347, "vf_explained_var": 0.5084609838583136, "kl": 0.009754561071412256, "entropy": 0.22377707774760902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2424000, "num_agent_steps_sampled": 2424000, "num_steps_trained": 2424000, "num_agent_steps_trained": 2424000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24400, "training_iteration": 606, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-17-43", "timestamp": 1643707063, "time_this_iter_s": 17.10104203224182, "time_total_s": 16091.142959594727, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3831.634082555771, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 32.20400000000001, "ram_util_percent": 58.69200000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -102.4, "episode_reward_mean": -11.923000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.299999999999997, -4.4, -14.799999999999997, -6.300000000000001, -3.4, -4.2, -3.3, -6.300000000000001, -7.099999999999999, -87.80000000000005, -10.2, -22.300000000000015, -4.4, -14.799999999999999, -12.2, -11.600000000000001, -3.8000000000000007, -3.3, -9.099999999999998, -6.300000000000001, -5.1, -18.5, -5.3, -10.799999999999999, -10.1, -4.300000000000001, -12.299999999999997, -10.7, -3.4, -11.899999999999997, -4.300000000000001, -10.7, -18.1, -4.2, -15.199999999999998, -6.2, -8.299999999999997, -13.799999999999999, -11.699999999999998, -10.199999999999998, -5.2, -4.300000000000001, -6.3, -6.300000000000001, -15.999999999999998, -10.2, -3.2, -7.4, -11.999999999999998, -3.4, -37.3, -5.2, -17.5, -3.4, -4.2, -5.300000000000001, -8.700000000000001, -14.2, -15.5, -5.300000000000001, -16.099999999999998, -3.2, -13.399999999999972, -4.3, -26.1, -6.4, -10.1, -21.8, -14.499999999999998, -13.1, -3.3, -13.7, -6.2, -14.299999999999997, -16.4, -4.300000000000001, -23.3, -17.2, -4.2, -3.3, -14.799999999999999, -10.899999999999997, -10.0, -23.0, -3.2, -7.2, -9.499999999999998, -15.399999999999999, -13.1, -9.7, -16.4, -11.3, -7.9, -12.5, -5.3, -17.6, -23.4, -102.4, -3.4, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0519719733845343, "mean_inference_ms": 1.3929185707043756, "mean_action_processing_ms": 0.07526220678020842, "mean_env_wait_ms": 6.328754286095605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2428000, "timesteps_this_iter": 0, "agent_timesteps_total": 2428000, "timers": {"sample_time_ms": 15972.926, "sample_throughput": 250.424, "load_time_ms": 0.362, "load_throughput": 11042000.79, "learn_time_ms": 7719.624, "learn_throughput": 518.16, "update_time_ms": 1.63}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.488715981931666, "policy_loss": -0.007819081858922076, "vf_loss": 49.54608826271949, "vf_explained_var": 0.14098107154651354, "kl": 0.007161276838643502, "entropy": 0.24356796190703428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2428000, "num_agent_steps_sampled": 2428000, "num_steps_trained": 2428000, "num_agent_steps_trained": 2428000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24440, "training_iteration": 607, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-17-58", "timestamp": 1643707078, "time_this_iter_s": 15.075005054473877, "time_total_s": 16106.2179646492, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3846.7090876102448, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 34.31904761904762, "ram_util_percent": 58.55238095238095}}
{"episode_reward_max": -3.2, "episode_reward_min": -102.4, "episode_reward_mean": -14.007999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -4.300000000000001, -6.3, -6.300000000000001, -15.999999999999998, -10.2, -3.2, -7.4, -11.999999999999998, -3.4, -37.3, -5.2, -17.5, -3.4, -4.2, -5.300000000000001, -8.700000000000001, -14.2, -15.5, -5.300000000000001, -16.099999999999998, -3.2, -13.399999999999972, -4.3, -26.1, -6.4, -10.1, -21.8, -14.499999999999998, -13.1, -3.3, -13.7, -6.2, -14.299999999999997, -16.4, -4.300000000000001, -23.3, -17.2, -4.2, -3.3, -14.799999999999999, -10.899999999999997, -10.0, -23.0, -3.2, -7.2, -9.499999999999998, -15.399999999999999, -13.1, -9.7, -16.4, -11.3, -7.9, -12.5, -5.3, -17.6, -23.4, -102.4, -3.4, -4.2, -25.300000000000008, -22.9, -12.7, -4.9, -13.899999999999997, -4.1, -61.8, -9.899999999999999, -12.899999999999999, -14.899999999999999, -16.2, -23.7, -3.3, -5.4, -5.300000000000001, -5.300000000000001, -17.2, -3.2, -5.300000000000001, -15.799999999999999, -27.500000000000004, -16.2, -5.3, -14.7, -84.00000000000004, -7.4, -3.3, -10.8, -15.5, -8.3, -16.7, -15.2, -15.199999999999998, -5.300000000000001, -38.89999999999995, -29.3, -4.3, -10.099999999999998, -10.199999999999998, -31.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0514237022473352, "mean_inference_ms": 1.3921843650098071, "mean_action_processing_ms": 0.07522153439993173, "mean_env_wait_ms": 6.325186994816827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2432000, "timesteps_this_iter": 0, "agent_timesteps_total": 2432000, "timers": {"sample_time_ms": 15953.673, "sample_throughput": 250.726, "load_time_ms": 0.365, "load_throughput": 10969085.322, "learn_time_ms": 7715.765, "learn_throughput": 518.419, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.5733034014781957, "policy_loss": -0.02504975321472332, "vf_loss": 59.66415412368313, "vf_explained_var": -0.19321110729248292, "kl": 0.011410833906791372, "entropy": 0.2540121476256078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2432000, "num_agent_steps_sampled": 2432000, "num_steps_trained": 2432000, "num_agent_steps_trained": 2432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24480, "training_iteration": 608, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-18-13", "timestamp": 1643707093, "time_this_iter_s": 15.439566850662231, "time_total_s": 16121.657531499863, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3862.148654460907, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 33.481818181818184, "ram_util_percent": 58.568181818181806}}
{"episode_reward_max": -2.5, "episode_reward_min": -102.4, "episode_reward_mean": -14.498000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.799999999999999, -10.899999999999997, -10.0, -23.0, -3.2, -7.2, -9.499999999999998, -15.399999999999999, -13.1, -9.7, -16.4, -11.3, -7.9, -12.5, -5.3, -17.6, -23.4, -102.4, -3.4, -4.2, -25.300000000000008, -22.9, -12.7, -4.9, -13.899999999999997, -4.1, -61.8, -9.899999999999999, -12.899999999999999, -14.899999999999999, -16.2, -23.7, -3.3, -5.4, -5.300000000000001, -5.300000000000001, -17.2, -3.2, -5.300000000000001, -15.799999999999999, -27.500000000000004, -16.2, -5.3, -14.7, -84.00000000000004, -7.4, -3.3, -10.8, -15.5, -8.3, -16.7, -15.2, -15.199999999999998, -5.300000000000001, -38.89999999999995, -29.3, -4.3, -10.099999999999998, -10.199999999999998, -31.3, -9.799999999999999, -21.5, -7.199999999999999, -4.3999999999999995, -5.2, -14.899999999999997, -36.20000000000004, -3.3, -19.0, -2.5, -20.3, -4.300000000000001, -12.699999999999996, -15.299999999999997, -26.800000000000004, -6.2, -10.099999999999994, -4.4, -15.799999999999999, -5.1, -10.799999999999999, -5.2, -10.5, -21.10000000000001, -4.300000000000001, -16.199999999999996, -6.3, -4.2, -18.000000000000007, -10.5, -12.2, -4.3, -4.4, -16.799999999999997, -8.100000000000001, -21.2, -6.5, -9.3, -23.5, -16.699999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0507734890687752, "mean_inference_ms": 1.391249294092083, "mean_action_processing_ms": 0.07517052093161397, "mean_env_wait_ms": 6.32063390741858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2436000, "timesteps_this_iter": 0, "agent_timesteps_total": 2436000, "timers": {"sample_time_ms": 15912.307, "sample_throughput": 251.378, "load_time_ms": 0.375, "load_throughput": 10658968.234, "learn_time_ms": 7708.474, "learn_throughput": 518.909, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.13233611339162435, "policy_loss": -0.022262331482864196, "vf_loss": 15.257136632486056, "vf_explained_var": 0.1749179147904919, "kl": 0.013513888051661172, "entropy": 0.25129823465981793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2436000, "num_agent_steps_sampled": 2436000, "num_steps_trained": 2436000, "num_agent_steps_trained": 2436000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24520, "training_iteration": 609, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-18-28", "timestamp": 1643707108, "time_this_iter_s": 15.320805311203003, "time_total_s": 16136.978336811066, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3877.46945977211, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 24.681818181818183, "ram_util_percent": 58.58181818181818}}
{"episode_reward_max": -2.5, "episode_reward_min": -84.00000000000004, "episode_reward_mean": -13.358000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.500000000000004, -16.2, -5.3, -14.7, -84.00000000000004, -7.4, -3.3, -10.8, -15.5, -8.3, -16.7, -15.2, -15.199999999999998, -5.300000000000001, -38.89999999999995, -29.3, -4.3, -10.099999999999998, -10.199999999999998, -31.3, -9.799999999999999, -21.5, -7.199999999999999, -4.3999999999999995, -5.2, -14.899999999999997, -36.20000000000004, -3.3, -19.0, -2.5, -20.3, -4.300000000000001, -12.699999999999996, -15.299999999999997, -26.800000000000004, -6.2, -10.099999999999994, -4.4, -15.799999999999999, -5.1, -10.799999999999999, -5.2, -10.5, -21.10000000000001, -4.300000000000001, -16.199999999999996, -6.3, -4.2, -18.000000000000007, -10.5, -12.2, -4.3, -4.4, -16.799999999999997, -8.100000000000001, -21.2, -6.5, -9.3, -23.5, -16.699999999999996, -18.599999999999998, -18.000000000000004, -6.300000000000001, -5.4, -7.300000000000001, -9.4, -14.3, -21.4, -18.3, -8.9, -6.300000000000001, -12.999999999999998, -3.3, -5.1, -28.50000000000001, -8.5, -7.2, -4.300000000000001, -9.3, -5.300000000000001, -7.4, -6.2, -6.999999999999998, -6.300000000000001, -11.9, -10.5, -14.899999999999999, -5.300000000000001, -39.4, -5.699999999999999, -17.699999999999992, -3.6, -15.799999999999999, -4.300000000000001, -66.2, -8.3, -8.5, -5.4, -23.9, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0501391824747643, "mean_inference_ms": 1.390330046083555, "mean_action_processing_ms": 0.07512010710831891, "mean_env_wait_ms": 6.316236582809331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2440000, "timesteps_this_iter": 0, "agent_timesteps_total": 2440000, "timers": {"sample_time_ms": 15936.542, "sample_throughput": 250.995, "load_time_ms": 0.371, "load_throughput": 10780194.05, "learn_time_ms": 7835.448, "learn_throughput": 510.501, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.19809742439513206, "policy_loss": -0.02405925736561047, "vf_loss": 22.066154083192988, "vf_explained_var": 0.14500087993119354, "kl": 0.009967654750555275, "entropy": 0.28258485702737685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2440000, "num_agent_steps_sampled": 2440000, "num_steps_trained": 2440000, "num_agent_steps_trained": 2440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24560, "training_iteration": 610, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-18-45", "timestamp": 1643707125, "time_this_iter_s": 16.673206090927124, "time_total_s": 16153.651542901993, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3894.142665863037, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 30.245833333333326, "ram_util_percent": 58.4}}
{"episode_reward_max": -3.2, "episode_reward_min": -66.2, "episode_reward_mean": -12.007, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.799999999999999, -5.2, -10.5, -21.10000000000001, -4.300000000000001, -16.199999999999996, -6.3, -4.2, -18.000000000000007, -10.5, -12.2, -4.3, -4.4, -16.799999999999997, -8.100000000000001, -21.2, -6.5, -9.3, -23.5, -16.699999999999996, -18.599999999999998, -18.000000000000004, -6.300000000000001, -5.4, -7.300000000000001, -9.4, -14.3, -21.4, -18.3, -8.9, -6.300000000000001, -12.999999999999998, -3.3, -5.1, -28.50000000000001, -8.5, -7.2, -4.300000000000001, -9.3, -5.300000000000001, -7.4, -6.2, -6.999999999999998, -6.300000000000001, -11.9, -10.5, -14.899999999999999, -5.300000000000001, -39.4, -5.699999999999999, -17.699999999999992, -3.6, -15.799999999999999, -4.300000000000001, -66.2, -8.3, -8.5, -5.4, -23.9, -4.2, -5.4, -8.5, -14.4, -10.799999999999999, -4.3, -12.7, -8.3, -18.5, -12.2, -11.4, -8.3, -7.4, -3.6000000000000005, -16.199999999999996, -11.4, -10.0, -16.6, -5.4, -10.7, -22.7, -20.5, -15.799999999999999, -11.399999999999999, -6.9, -19.9, -10.2, -6.799999999999999, -15.899999999999995, -10.2, -19.5, -24.10000000000001, -4.3, -14.999999999999998, -13.999999999999996, -10.3, -18.700000000000003, -15.899999999999995, -3.2, -3.3, -14.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0498239576535284, "mean_inference_ms": 1.389717539951716, "mean_action_processing_ms": 0.07508512404991256, "mean_env_wait_ms": 6.313192610554717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2444000, "timesteps_this_iter": 0, "agent_timesteps_total": 2444000, "timers": {"sample_time_ms": 16144.77, "sample_throughput": 247.758, "load_time_ms": 0.363, "load_throughput": 11020241.724, "learn_time_ms": 8354.342, "learn_throughput": 478.793, "update_time_ms": 1.783}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.08051156424566783, "policy_loss": -0.015272670328336698, "vf_loss": 9.35234525280614, "vf_explained_var": 0.22835673420659958, "kl": 0.015071887126460834, "entropy": 0.27037143305905403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2444000, "num_agent_steps_sampled": 2444000, "num_steps_trained": 2444000, "num_agent_steps_trained": 2444000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24600, "training_iteration": 611, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-19-07", "timestamp": 1643707147, "time_this_iter_s": 21.810114860534668, "time_total_s": 16175.461657762527, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3915.952780723572, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 27.577419354838714, "ram_util_percent": 58.4258064516129}}
{"episode_reward_max": -3.2, "episode_reward_min": -81.3, "episode_reward_mean": -13.322000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -6.2, -6.999999999999998, -6.300000000000001, -11.9, -10.5, -14.899999999999999, -5.300000000000001, -39.4, -5.699999999999999, -17.699999999999992, -3.6, -15.799999999999999, -4.300000000000001, -66.2, -8.3, -8.5, -5.4, -23.9, -4.2, -5.4, -8.5, -14.4, -10.799999999999999, -4.3, -12.7, -8.3, -18.5, -12.2, -11.4, -8.3, -7.4, -3.6000000000000005, -16.199999999999996, -11.4, -10.0, -16.6, -5.4, -10.7, -22.7, -20.5, -15.799999999999999, -11.399999999999999, -6.9, -19.9, -10.2, -6.799999999999999, -15.899999999999995, -10.2, -19.5, -24.10000000000001, -4.3, -14.999999999999998, -13.999999999999996, -10.3, -18.700000000000003, -15.899999999999995, -3.2, -3.3, -14.7, -3.3, -7.800000000000001, -16.6, -13.19999999999997, -8.2, -17.2, -9.099999999999998, -8.3, -19.2, -11.799999999999997, -10.099999999999998, -6.2, -81.3, -12.4, -5.800000000000001, -3.2, -12.4, -15.899999999999999, -41.900000000000006, -4.300000000000001, -10.1, -9.399999999999999, -5.2, -6.300000000000001, -56.10000000000001, -3.3, -8.2, -19.700000000000003, -5.3, -18.3, -4.4, -15.6, -15.2, -3.3, -28.8, -14.999999999999998, -21.3, -8.9, -12.5, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.049884844850916, "mean_inference_ms": 1.3897185809253514, "mean_action_processing_ms": 0.07508515979248524, "mean_env_wait_ms": 6.313023934243049, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2448000, "timesteps_this_iter": 0, "agent_timesteps_total": 2448000, "timers": {"sample_time_ms": 16881.605, "sample_throughput": 236.944, "load_time_ms": 0.329, "load_throughput": 12154760.559, "learn_time_ms": 8366.985, "learn_throughput": 478.069, "update_time_ms": 1.805}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.5233010353555563, "policy_loss": -0.01496582690586326, "vf_loss": 53.69979326648097, "vf_explained_var": 0.20562256388766792, "kl": 0.008459616038044312, "entropy": 0.251003951571321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2448000, "num_agent_steps_sampled": 2448000, "num_steps_trained": 2448000, "num_agent_steps_trained": 2448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24640, "training_iteration": 612, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-19-24", "timestamp": 1643707164, "time_this_iter_s": 17.420394897460938, "time_total_s": 16192.882052659988, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3933.3731756210327, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 32.808, "ram_util_percent": 58.644000000000005}}
{"episode_reward_max": -3.2, "episode_reward_min": -81.3, "episode_reward_mean": -13.483000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.5, -15.799999999999999, -11.399999999999999, -6.9, -19.9, -10.2, -6.799999999999999, -15.899999999999995, -10.2, -19.5, -24.10000000000001, -4.3, -14.999999999999998, -13.999999999999996, -10.3, -18.700000000000003, -15.899999999999995, -3.2, -3.3, -14.7, -3.3, -7.800000000000001, -16.6, -13.19999999999997, -8.2, -17.2, -9.099999999999998, -8.3, -19.2, -11.799999999999997, -10.099999999999998, -6.2, -81.3, -12.4, -5.800000000000001, -3.2, -12.4, -15.899999999999999, -41.900000000000006, -4.300000000000001, -10.1, -9.399999999999999, -5.2, -6.300000000000001, -56.10000000000001, -3.3, -8.2, -19.700000000000003, -5.3, -18.3, -4.4, -15.6, -15.2, -3.3, -28.8, -14.999999999999998, -21.3, -8.9, -12.5, -5.2, -4.4, -16.6, -12.499999999999998, -4.3, -7.4, -20.8, -44.3, -13.2, -12.099999999999998, -3.4, -5.300000000000001, -3.5, -28.40000000000005, -8.2, -6.4, -9.3, -7.199999999999999, -7.6000000000000005, -18.2, -5.799999999999999, -9.8, -14.200000000000012, -7.3, -41.3, -10.299999999999992, -16.299999999999997, -9.4, -5.300000000000001, -21.5, -5.2, -13.299999999999997, -20.999999999999996, -13.299999999999995, -6.1, -21.6, -3.2, -6.2, -11.899999999999999, -16.6, -14.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0498505537015201, "mean_inference_ms": 1.3895623874928544, "mean_action_processing_ms": 0.07507764954259243, "mean_env_wait_ms": 6.312099153305997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2452000, "timesteps_this_iter": 0, "agent_timesteps_total": 2452000, "timers": {"sample_time_ms": 16853.092, "sample_throughput": 237.345, "load_time_ms": 0.327, "load_throughput": 12222055.802, "learn_time_ms": 8252.965, "learn_throughput": 484.674, "update_time_ms": 1.827}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.17802118850591522, "policy_loss": -0.017493747333965956, "vf_loss": 19.361560556773217, "vf_explained_var": 0.2615666009405608, "kl": 0.012662223222811976, "entropy": 0.2610974843864159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2452000, "num_agent_steps_sampled": 2452000, "num_steps_trained": 2452000, "num_agent_steps_trained": 2452000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24680, "training_iteration": 613, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-19-40", "timestamp": 1643707180, "time_this_iter_s": 15.390115022659302, "time_total_s": 16208.272167682648, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3948.763290643692, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 29.986363636363635, "ram_util_percent": 58.73181818181817}}
{"episode_reward_max": -3.2, "episode_reward_min": -87.89999999999992, "episode_reward_mean": -14.002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -9.399999999999999, -5.2, -6.300000000000001, -56.10000000000001, -3.3, -8.2, -19.700000000000003, -5.3, -18.3, -4.4, -15.6, -15.2, -3.3, -28.8, -14.999999999999998, -21.3, -8.9, -12.5, -5.2, -4.4, -16.6, -12.499999999999998, -4.3, -7.4, -20.8, -44.3, -13.2, -12.099999999999998, -3.4, -5.300000000000001, -3.5, -28.40000000000005, -8.2, -6.4, -9.3, -7.199999999999999, -7.6000000000000005, -18.2, -5.799999999999999, -9.8, -14.200000000000012, -7.3, -41.3, -10.299999999999992, -16.299999999999997, -9.4, -5.300000000000001, -21.5, -5.2, -13.299999999999997, -20.999999999999996, -13.299999999999995, -6.1, -21.6, -3.2, -6.2, -11.899999999999999, -16.6, -14.7, -87.89999999999992, -9.3, -6.2, -25.0, -23.700000000000035, -4.2, -35.3, -13.2, -7.300000000000001, -19.599999999999998, -6.2, -21.599999999999998, -5.4, -7.299999999999999, -6.2, -10.3, -26.700000000000006, -11.700000000000001, -20.2, -4.2, -7.8, -14.6, -7.999999999999997, -15.999999999999995, -10.099999999999998, -8.2, -30.2, -7.299999999999999, -5.300000000000001, -6.4, -8.3, -14.2, -6.2, -26.200000000000056, -7.2, -16.1, -24.6, -4.2, -17.5, -30.800000000000033], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0503554218420894, "mean_inference_ms": 1.3901804458153078, "mean_action_processing_ms": 0.07511130701952333, "mean_env_wait_ms": 6.314731783868706, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2456000, "timesteps_this_iter": 0, "agent_timesteps_total": 2456000, "timers": {"sample_time_ms": 17090.214, "sample_throughput": 234.052, "load_time_ms": 0.346, "load_throughput": 11551374.277, "learn_time_ms": 8253.257, "learn_throughput": 484.657, "update_time_ms": 1.85}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.42870629315054226, "policy_loss": -0.024269274172062674, "vf_loss": 45.119876761590284, "vf_explained_var": 0.08666470909631381, "kl": 0.011845410079044034, "entropy": 0.255520029358005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2456000, "num_agent_steps_sampled": 2456000, "num_steps_trained": 2456000, "num_agent_steps_trained": 2456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24720, "training_iteration": 614, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-20-00", "timestamp": 1643707200, "time_this_iter_s": 20.080036640167236, "time_total_s": 16228.352204322815, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3968.8433272838593, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 41.714285714285715, "ram_util_percent": 58.77499999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -87.89999999999992, "episode_reward_mean": -14.875000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.8, -14.200000000000012, -7.3, -41.3, -10.299999999999992, -16.299999999999997, -9.4, -5.300000000000001, -21.5, -5.2, -13.299999999999997, -20.999999999999996, -13.299999999999995, -6.1, -21.6, -3.2, -6.2, -11.899999999999999, -16.6, -14.7, -87.89999999999992, -9.3, -6.2, -25.0, -23.700000000000035, -4.2, -35.3, -13.2, -7.300000000000001, -19.599999999999998, -6.2, -21.599999999999998, -5.4, -7.299999999999999, -6.2, -10.3, -26.700000000000006, -11.700000000000001, -20.2, -4.2, -7.8, -14.6, -7.999999999999997, -15.999999999999995, -10.099999999999998, -8.2, -30.2, -7.299999999999999, -5.300000000000001, -6.4, -8.3, -14.2, -6.2, -26.200000000000056, -7.2, -16.1, -24.6, -4.2, -17.5, -30.800000000000033, -7.2, -9.2, -15.899999999999999, -13.4, -13.999999999999998, -44.4, -18.5, -14.299999999999999, -3.3, -13.8, -6.1, -10.700000000000001, -22.999999999999996, -40.2, -25.799999999999997, -6.300000000000001, -11.2, -10.9, -29.200000000000003, -9.5, -8.700000000000001, -3.3, -13.5, -23.599999999999998, -4.300000000000001, -29.600000000000005, -5.2, -9.600000000000001, -3.3, -16.799999999999997, -7.300000000000001, -15.999999999999998, -7.3, -20.1, -37.00000000000004, -8.600000000000001, -18.199999999999996, -9.3, -11.999999999999998, -17.699999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0508280541392283, "mean_inference_ms": 1.3908012981971176, "mean_action_processing_ms": 0.07514343972318996, "mean_env_wait_ms": 6.3173220779228805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2460000, "timesteps_this_iter": 0, "agent_timesteps_total": 2460000, "timers": {"sample_time_ms": 17131.036, "sample_throughput": 233.494, "load_time_ms": 0.367, "load_throughput": 10885107.377, "learn_time_ms": 8486.066, "learn_throughput": 471.361, "update_time_ms": 1.918}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 0.19503659695682307, "policy_loss": -0.033614689669001004, "vf_loss": 22.527771792360532, "vf_explained_var": 0.1836100891072263, "kl": 0.022490493969902242, "entropy": 0.2638201668538073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2460000, "num_agent_steps_sampled": 2460000, "num_steps_trained": 2460000, "num_agent_steps_trained": 2460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24760, "training_iteration": 615, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-20-19", "timestamp": 1643707219, "time_this_iter_s": 19.014450788497925, "time_total_s": 16247.366655111313, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3987.857778072357, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 34.075, "ram_util_percent": 58.71785714285714}}
{"episode_reward_max": -3.3, "episode_reward_min": -44.4, "episode_reward_mean": -13.008, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.8, -14.6, -7.999999999999997, -15.999999999999995, -10.099999999999998, -8.2, -30.2, -7.299999999999999, -5.300000000000001, -6.4, -8.3, -14.2, -6.2, -26.200000000000056, -7.2, -16.1, -24.6, -4.2, -17.5, -30.800000000000033, -7.2, -9.2, -15.899999999999999, -13.4, -13.999999999999998, -44.4, -18.5, -14.299999999999999, -3.3, -13.8, -6.1, -10.700000000000001, -22.999999999999996, -40.2, -25.799999999999997, -6.300000000000001, -11.2, -10.9, -29.200000000000003, -9.5, -8.700000000000001, -3.3, -13.5, -23.599999999999998, -4.300000000000001, -29.600000000000005, -5.2, -9.600000000000001, -3.3, -16.799999999999997, -7.300000000000001, -15.999999999999998, -7.3, -20.1, -37.00000000000004, -8.600000000000001, -18.199999999999996, -9.3, -11.999999999999998, -17.699999999999996, -21.799999999999997, -4.4, -10.899999999999999, -20.299999999999997, -4.2, -6.300000000000001, -5.2, -7.899999999999998, -8.2, -10.0, -3.3, -8.3, -22.700000000000003, -8.999999999999996, -7.499999999999999, -17.699999999999996, -7.2, -15.299999999999997, -12.8, -7.3, -20.2, -4.3, -16.699999999999985, -8.9, -10.0, -8.2, -24.4, -17.5, -7.1, -9.099999999999998, -7.199999999999998, -3.5000000000000004, -7.799999999999999, -8.1, -3.6000000000000005, -21.2, -15.3, -17.299999999999997, -7.4, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0516685084578734, "mean_inference_ms": 1.3920384921303213, "mean_action_processing_ms": 0.07520665473781257, "mean_env_wait_ms": 6.322605621873504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2464000, "timesteps_this_iter": 0, "agent_timesteps_total": 2464000, "timers": {"sample_time_ms": 17705.262, "sample_throughput": 225.922, "load_time_ms": 0.37, "load_throughput": 10824010.323, "learn_time_ms": 8423.42, "learn_throughput": 474.866, "update_time_ms": 1.886}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.06447943198314357, "policy_loss": -0.027815854289038208, "vf_loss": 8.880451253280844, "vf_explained_var": 0.1270293940139073, "kl": 0.01551456109205754, "entropy": 0.2786942763914985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2464000, "num_agent_steps_sampled": 2464000, "num_steps_trained": 2464000, "num_agent_steps_trained": 2464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24800, "training_iteration": 616, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-20-39", "timestamp": 1643707239, "time_this_iter_s": 19.861592054367065, "time_total_s": 16267.22824716568, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4007.7193701267242, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 40.29285714285714, "ram_util_percent": 58.77857142857142}}
{"episode_reward_max": -3.3, "episode_reward_min": -77.3, "episode_reward_mean": -12.142999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.700000000000001, -3.3, -13.5, -23.599999999999998, -4.300000000000001, -29.600000000000005, -5.2, -9.600000000000001, -3.3, -16.799999999999997, -7.300000000000001, -15.999999999999998, -7.3, -20.1, -37.00000000000004, -8.600000000000001, -18.199999999999996, -9.3, -11.999999999999998, -17.699999999999996, -21.799999999999997, -4.4, -10.899999999999999, -20.299999999999997, -4.2, -6.300000000000001, -5.2, -7.899999999999998, -8.2, -10.0, -3.3, -8.3, -22.700000000000003, -8.999999999999996, -7.499999999999999, -17.699999999999996, -7.2, -15.299999999999997, -12.8, -7.3, -20.2, -4.3, -16.699999999999985, -8.9, -10.0, -8.2, -24.4, -17.5, -7.1, -9.099999999999998, -7.199999999999998, -3.5000000000000004, -7.799999999999999, -8.1, -3.6000000000000005, -21.2, -15.3, -17.299999999999997, -7.4, -5.2, -7.1, -32.3, -7.300000000000001, -8.7, -21.8, -6.6000000000000005, -7.499999999999999, -4.4, -5.300000000000001, -77.3, -6.0, -4.3, -8.8, -4.3, -6.999999999999998, -17.3, -3.4, -6.300000000000001, -6.2, -9.2, -9.100000000000001, -13.799999999999999, -20.30000000000001, -51.3, -14.799999999999999, -19.5, -5.2, -11.0, -4.2, -3.4, -4.4, -6.300000000000001, -24.800000000000004, -5.2, -6.300000000000001, -7.300000000000001, -5.2, -18.0, -6.499999999999999, -21.900000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0525314786407232, "mean_inference_ms": 1.3933673914691243, "mean_action_processing_ms": 0.07527449148660818, "mean_env_wait_ms": 6.328446610304305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2468000, "timesteps_this_iter": 0, "agent_timesteps_total": 2468000, "timers": {"sample_time_ms": 17958.645, "sample_throughput": 222.734, "load_time_ms": 0.39, "load_throughput": 10267574.051, "learn_time_ms": 8806.865, "learn_throughput": 454.191, "update_time_ms": 1.946}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.2985300380456191, "policy_loss": -0.012211756594479085, "vf_loss": 30.909845839841392, "vf_explained_var": 0.05009460910674064, "kl": 0.007303725230495388, "entropy": 0.26371774973087414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2468000, "num_agent_steps_sampled": 2468000, "num_steps_trained": 2468000, "num_agent_steps_trained": 2468000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24840, "training_iteration": 617, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-21-01", "timestamp": 1643707261, "time_this_iter_s": 22.085262060165405, "time_total_s": 16289.313509225845, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4029.8046321868896, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 44.567741935483866, "ram_util_percent": 58.90322580645162}}
{"episode_reward_max": -3.3, "episode_reward_min": -77.3, "episode_reward_mean": -11.75, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.2, -4.3, -16.699999999999985, -8.9, -10.0, -8.2, -24.4, -17.5, -7.1, -9.099999999999998, -7.199999999999998, -3.5000000000000004, -7.799999999999999, -8.1, -3.6000000000000005, -21.2, -15.3, -17.299999999999997, -7.4, -5.2, -7.1, -32.3, -7.300000000000001, -8.7, -21.8, -6.6000000000000005, -7.499999999999999, -4.4, -5.300000000000001, -77.3, -6.0, -4.3, -8.8, -4.3, -6.999999999999998, -17.3, -3.4, -6.300000000000001, -6.2, -9.2, -9.100000000000001, -13.799999999999999, -20.30000000000001, -51.3, -14.799999999999999, -19.5, -5.2, -11.0, -4.2, -3.4, -4.4, -6.300000000000001, -24.800000000000004, -5.2, -6.300000000000001, -7.300000000000001, -5.2, -18.0, -6.499999999999999, -21.900000000000006, -5.2, -7.299999999999999, -16.099999999999984, -12.899999999999999, -11.299999999999997, -6.199999999999999, -12.799999999999995, -4.4, -5.300000000000001, -9.0, -39.2, -21.1, -3.3, -7.300000000000001, -13.399999999999999, -4.800000000000001, -29.400000000000052, -4.9, -5.300000000000001, -5.3, -8.2, -19.5, -7.699999999999999, -5.0, -20.0, -25.8, -6.1, -7.499999999999999, -6.4, -13.799999999999999, -8.3, -7.499999999999999, -7.2, -5.300000000000001, -6.300000000000001, -23.200000000000003, -11.099999999999984, -7.2, -14.5, -7.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0534463923337265, "mean_inference_ms": 1.3947727436968538, "mean_action_processing_ms": 0.0753479833284423, "mean_env_wait_ms": 6.335068041013703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2472000, "timesteps_this_iter": 0, "agent_timesteps_total": 2472000, "timers": {"sample_time_ms": 18649.393, "sample_throughput": 214.484, "load_time_ms": 0.38, "load_throughput": 10518630.721, "learn_time_ms": 9187.768, "learn_throughput": 435.361, "update_time_ms": 1.925}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.11127836310094402, "policy_loss": -0.022888244416124078, "vf_loss": 13.157736810817513, "vf_explained_var": 0.2107249472089993, "kl": 0.011507745876048655, "entropy": 0.2761949218409036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2472000, "num_agent_steps_sampled": 2472000, "num_steps_trained": 2472000, "num_agent_steps_trained": 2472000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24880, "training_iteration": 618, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-21-23", "timestamp": 1643707283, "time_this_iter_s": 22.293133974075317, "time_total_s": 16311.60664319992, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4052.097766160965, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 41.6125, "ram_util_percent": 58.696875}}
{"episode_reward_max": -3.2, "episode_reward_min": -92.2, "episode_reward_mean": -12.559000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.100000000000001, -13.799999999999999, -20.30000000000001, -51.3, -14.799999999999999, -19.5, -5.2, -11.0, -4.2, -3.4, -4.4, -6.300000000000001, -24.800000000000004, -5.2, -6.300000000000001, -7.300000000000001, -5.2, -18.0, -6.499999999999999, -21.900000000000006, -5.2, -7.299999999999999, -16.099999999999984, -12.899999999999999, -11.299999999999997, -6.199999999999999, -12.799999999999995, -4.4, -5.300000000000001, -9.0, -39.2, -21.1, -3.3, -7.300000000000001, -13.399999999999999, -4.800000000000001, -29.400000000000052, -4.9, -5.300000000000001, -5.3, -8.2, -19.5, -7.699999999999999, -5.0, -20.0, -25.8, -6.1, -7.499999999999999, -6.4, -13.799999999999999, -8.3, -7.499999999999999, -7.2, -5.300000000000001, -6.300000000000001, -23.200000000000003, -11.099999999999984, -7.2, -14.5, -7.300000000000001, -4.3, -35.4, -92.2, -4.2, -24.200000000000003, -7.3, -10.2, -14.199999999999998, -14.199999999999998, -18.5, -6.3, -4.3, -8.3, -15.700000000000008, -7.300000000000001, -13.899999999999999, -27.00000000000005, -9.7, -13.9, -9.5, -15.999999999999972, -9.0, -10.399999999999999, -10.599999999999998, -17.6, -15.599999999999994, -4.4, -6.999999999999999, -3.2, -8.299999999999999, -6.800000000000001, -22.500000000000004, -6.300000000000001, -11.700000000000001, -4.300000000000001, -7.4, -13.5, -10.3, -6.300000000000001, -23.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0540242819733996, "mean_inference_ms": 1.3957526312738548, "mean_action_processing_ms": 0.07539834562792871, "mean_env_wait_ms": 6.3400233147238945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2476000, "timesteps_this_iter": 0, "agent_timesteps_total": 2476000, "timers": {"sample_time_ms": 19270.841, "sample_throughput": 207.567, "load_time_ms": 0.398, "load_throughput": 10061298.951, "learn_time_ms": 9815.368, "learn_throughput": 407.524, "update_time_ms": 1.992}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.45605651509136924, "policy_loss": -0.010908916478686194, "vf_loss": 46.53733571998535, "vf_explained_var": 0.16481717171207552, "kl": 0.007075943184446457, "entropy": 0.2590474112379936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2476000, "num_agent_steps_sampled": 2476000, "num_steps_trained": 2476000, "num_agent_steps_trained": 2476000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24920, "training_iteration": 619, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-21-47", "timestamp": 1643707307, "time_this_iter_s": 23.998995065689087, "time_total_s": 16335.60563826561, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4076.096761226654, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 36.75, "ram_util_percent": 58.81764705882353}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -92.2, "episode_reward_mean": -11.970000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -19.5, -7.699999999999999, -5.0, -20.0, -25.8, -6.1, -7.499999999999999, -6.4, -13.799999999999999, -8.3, -7.499999999999999, -7.2, -5.300000000000001, -6.300000000000001, -23.200000000000003, -11.099999999999984, -7.2, -14.5, -7.300000000000001, -4.3, -35.4, -92.2, -4.2, -24.200000000000003, -7.3, -10.2, -14.199999999999998, -14.199999999999998, -18.5, -6.3, -4.3, -8.3, -15.700000000000008, -7.300000000000001, -13.899999999999999, -27.00000000000005, -9.7, -13.9, -9.5, -15.999999999999972, -9.0, -10.399999999999999, -10.599999999999998, -17.6, -15.599999999999994, -4.4, -6.999999999999999, -3.2, -8.299999999999999, -6.800000000000001, -22.500000000000004, -6.300000000000001, -11.700000000000001, -4.300000000000001, -7.4, -13.5, -10.3, -6.300000000000001, -23.2, -4.3, -4.4, -4.300000000000001, -13.8, -3.4, -17.799999999999997, -3.3, -12.1, -5.4, -8.2, -11.8, -7.7, -12.199999999999998, -8.2, -30.700000000000003, -9.299999999999999, -7.300000000000001, -17.299999999999997, -2.4000000000000004, -13.799999999999997, -5.300000000000001, -34.5, -15.799999999999997, -5.3, -4.300000000000001, -8.2, -8.9, -3.2, -7.099999999999998, -4.300000000000001, -10.5, -9.1, -4.3, -4.300000000000001, -27.600000000000005, -6.1, -31.90000000000001, -4.2, -12.899999999999999, -18.599999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0544159555804058, "mean_inference_ms": 1.396224321224746, "mean_action_processing_ms": 0.0754246423559918, "mean_env_wait_ms": 6.342449404995022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2480000, "timesteps_this_iter": 0, "agent_timesteps_total": 2480000, "timers": {"sample_time_ms": 20010.819, "sample_throughput": 199.892, "load_time_ms": 0.416, "load_throughput": 9624930.297, "learn_time_ms": 9818.207, "learn_throughput": 407.406, "update_time_ms": 2.0}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.12072344041199133, "policy_loss": -0.02171034952024779, "vf_loss": 14.021308533991537, "vf_explained_var": 0.0688209609318805, "kl": 0.009869805424574146, "entropy": 0.2633350980297853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2480000, "num_agent_steps_sampled": 2480000, "num_steps_trained": 2480000, "num_agent_steps_trained": 2480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 24960, "training_iteration": 620, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-22-05", "timestamp": 1643707325, "time_this_iter_s": 17.820334911346436, "time_total_s": 16353.425973176956, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4093.9170961380005, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 32.330769230769235, "ram_util_percent": 58.70384615384616}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -83.4, "episode_reward_mean": -12.666000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.999999999999972, -9.0, -10.399999999999999, -10.599999999999998, -17.6, -15.599999999999994, -4.4, -6.999999999999999, -3.2, -8.299999999999999, -6.800000000000001, -22.500000000000004, -6.300000000000001, -11.700000000000001, -4.300000000000001, -7.4, -13.5, -10.3, -6.300000000000001, -23.2, -4.3, -4.4, -4.300000000000001, -13.8, -3.4, -17.799999999999997, -3.3, -12.1, -5.4, -8.2, -11.8, -7.7, -12.199999999999998, -8.2, -30.700000000000003, -9.299999999999999, -7.300000000000001, -17.299999999999997, -2.4000000000000004, -13.799999999999997, -5.300000000000001, -34.5, -15.799999999999997, -5.3, -4.300000000000001, -8.2, -8.9, -3.2, -7.099999999999998, -4.300000000000001, -10.5, -9.1, -4.3, -4.300000000000001, -27.600000000000005, -6.1, -31.90000000000001, -4.2, -12.899999999999999, -18.599999999999994, -24.800000000000004, -5.2, -7.799999999999999, -3.4, -9.3, -18.400000000000006, -14.899999999999999, -3.3, -17.5, -83.4, -21.0, -8.899999999999999, -17.300000000000004, -4.4, -21.5, -15.7, -3.4, -3.3, -24.700000000000003, -16.399999999999984, -11.2, -4.2, -18.4, -3.4, -23.0, -9.899999999999999, -9.3, -28.800000000000004, -13.999999999999998, -28.5, -6.800000000000001, -7.300000000000001, -23.4, -40.8, -19.5, -3.2, -14.799999999999983, -10.7, -9.5, -16.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.055412904852389, "mean_inference_ms": 1.397458310744244, "mean_action_processing_ms": 0.07548688171137603, "mean_env_wait_ms": 6.348085886251576, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2484000, "timesteps_this_iter": 0, "agent_timesteps_total": 2484000, "timers": {"sample_time_ms": 20470.461, "sample_throughput": 195.404, "load_time_ms": 0.414, "load_throughput": 9653173.763, "learn_time_ms": 9484.173, "learn_throughput": 421.755, "update_time_ms": 1.824}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.5182557420900231, "policy_loss": -0.015267087246782036, "vf_loss": 53.146150526180065, "vf_explained_var": 0.15233078233657343, "kl": 0.009161489585255046, "entropy": 0.2870158326401505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2484000, "num_agent_steps_sampled": 2484000, "num_steps_trained": 2484000, "num_agent_steps_trained": 2484000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25000, "training_iteration": 621, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-22-28", "timestamp": 1643707348, "time_this_iter_s": 23.018274784088135, "time_total_s": 16376.444247961044, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4116.935370922089, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 47.228125, "ram_util_percent": 58.8125}}
{"episode_reward_max": -3.2, "episode_reward_min": -155.3, "episode_reward_mean": -13.948, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -34.5, -15.799999999999997, -5.3, -4.300000000000001, -8.2, -8.9, -3.2, -7.099999999999998, -4.300000000000001, -10.5, -9.1, -4.3, -4.300000000000001, -27.600000000000005, -6.1, -31.90000000000001, -4.2, -12.899999999999999, -18.599999999999994, -24.800000000000004, -5.2, -7.799999999999999, -3.4, -9.3, -18.400000000000006, -14.899999999999999, -3.3, -17.5, -83.4, -21.0, -8.899999999999999, -17.300000000000004, -4.4, -21.5, -15.7, -3.4, -3.3, -24.700000000000003, -16.399999999999984, -11.2, -4.2, -18.4, -3.4, -23.0, -9.899999999999999, -9.3, -28.800000000000004, -13.999999999999998, -28.5, -6.800000000000001, -7.300000000000001, -23.4, -40.8, -19.5, -3.2, -14.799999999999983, -10.7, -9.5, -16.799999999999997, -6.3999999999999995, -15.699999999999996, -6.2, -8.3, -4.300000000000001, -7.300000000000001, -12.399999999999999, -9.3, -6.3, -4.300000000000001, -3.3, -6.300000000000001, -16.099999999999994, -5.4, -6.300000000000001, -6.300000000000001, -6.2, -11.9, -20.600000000000005, -6.2, -4.300000000000001, -5.4, -31.6, -11.7, -9.099999999999998, -25.0, -14.599999999999998, -5.800000000000001, -5.1, -15.899999999999999, -6.300000000000001, -10.9, -6.2, -5.300000000000001, -14.699999999999998, -10.2, -14.3, -10.5, -9.0, -155.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0559214434041138, "mean_inference_ms": 1.398243150797013, "mean_action_processing_ms": 0.07552535101085732, "mean_env_wait_ms": 6.351657026144274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2488000, "timesteps_this_iter": 0, "agent_timesteps_total": 2488000, "timers": {"sample_time_ms": 19950.731, "sample_throughput": 200.494, "load_time_ms": 0.44, "load_throughput": 9087923.731, "learn_time_ms": 9879.757, "learn_throughput": 404.868, "update_time_ms": 1.883}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 1.0024648099831026, "policy_loss": -0.037132618772817316, "vf_loss": 103.71125357468281, "vf_explained_var": 0.1848145850243107, "kl": 0.011044038971553267, "entropy": 0.2571905820680562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2488000, "num_agent_steps_sampled": 2488000, "num_steps_trained": 2488000, "num_agent_steps_trained": 2488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25040, "training_iteration": 622, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-22-48", "timestamp": 1643707368, "time_this_iter_s": 19.55088520050049, "time_total_s": 16395.995133161545, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4136.486256122589, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 29.925, "ram_util_percent": 58.967857142857156}}
{"episode_reward_max": -1.2, "episode_reward_min": -155.3, "episode_reward_mean": -13.991000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -4.2, -18.4, -3.4, -23.0, -9.899999999999999, -9.3, -28.800000000000004, -13.999999999999998, -28.5, -6.800000000000001, -7.300000000000001, -23.4, -40.8, -19.5, -3.2, -14.799999999999983, -10.7, -9.5, -16.799999999999997, -6.3999999999999995, -15.699999999999996, -6.2, -8.3, -4.300000000000001, -7.300000000000001, -12.399999999999999, -9.3, -6.3, -4.300000000000001, -3.3, -6.300000000000001, -16.099999999999994, -5.4, -6.300000000000001, -6.300000000000001, -6.2, -11.9, -20.600000000000005, -6.2, -4.300000000000001, -5.4, -31.6, -11.7, -9.099999999999998, -25.0, -14.599999999999998, -5.800000000000001, -5.1, -15.899999999999999, -6.300000000000001, -10.9, -6.2, -5.300000000000001, -14.699999999999998, -10.2, -14.3, -10.5, -9.0, -155.3, -10.799999999999999, -9.799999999999999, -14.099999999999996, -4.2, -6.2, -5.300000000000001, -6.300000000000001, -2.5, -4.3, -8.0, -8.600000000000001, -5.3, -29.300000000000004, -3.3, -4.300000000000001, -42.50000000000008, -4.4, -18.699999999999996, -14.2, -1.2, -13.699999999999998, -7.2, -4.2, -24.5, -7.3, -5.4, -13.899999999999999, -15.999999999999998, -42.6, -24.2, -37.5, -12.399999999999995, -18.4, -10.2, -24.700000000000003, -5.799999999999999, -4.4, -31.300000000000068, -25.7, -22.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0556796879957824, "mean_inference_ms": 1.3981715544926985, "mean_action_processing_ms": 0.07552058861511707, "mean_env_wait_ms": 6.351385323293056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2492000, "timesteps_this_iter": 0, "agent_timesteps_total": 2492000, "timers": {"sample_time_ms": 20354.69, "sample_throughput": 196.515, "load_time_ms": 0.447, "load_throughput": 8956924.884, "learn_time_ms": 10135.688, "learn_throughput": 394.645, "update_time_ms": 1.947}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.22291544885900352, "policy_loss": -0.021439026400286665, "vf_loss": 24.19928535767781, "vf_explained_var": -0.126735996302738, "kl": 0.010496120089356424, "entropy": 0.2641105537252721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2492000, "num_agent_steps_sampled": 2492000, "num_steps_trained": 2492000, "num_agent_steps_trained": 2492000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25080, "training_iteration": 623, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-23-06", "timestamp": 1643707386, "time_this_iter_s": 18.00639796257019, "time_total_s": 16414.001531124115, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4154.492654085159, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 32.400000000000006, "ram_util_percent": 58.93076923076923}}
{"episode_reward_max": -1.2, "episode_reward_min": -155.3, "episode_reward_mean": -15.952000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -5.4, -31.6, -11.7, -9.099999999999998, -25.0, -14.599999999999998, -5.800000000000001, -5.1, -15.899999999999999, -6.300000000000001, -10.9, -6.2, -5.300000000000001, -14.699999999999998, -10.2, -14.3, -10.5, -9.0, -155.3, -10.799999999999999, -9.799999999999999, -14.099999999999996, -4.2, -6.2, -5.300000000000001, -6.300000000000001, -2.5, -4.3, -8.0, -8.600000000000001, -5.3, -29.300000000000004, -3.3, -4.300000000000001, -42.50000000000008, -4.4, -18.699999999999996, -14.2, -1.2, -13.699999999999998, -7.2, -4.2, -24.5, -7.3, -5.4, -13.899999999999999, -15.999999999999998, -42.6, -24.2, -37.5, -12.399999999999995, -18.4, -10.2, -24.700000000000003, -5.799999999999999, -4.4, -31.300000000000068, -25.7, -22.6, -5.1000000000000005, -15.799999999999997, -14.199999999999987, -7.1, -6.300000000000001, -13.9, -32.90000000000003, -3.4, -28.000000000000007, -8.099999999999998, -19.7, -18.0, -20.4, -17.0, -16.2, -12.1, -12.6, -14.7, -13.499999999999998, -17.9, -79.3, -5.2, -12.699999999999973, -8.7, -11.700000000000001, -5.300000000000001, -80.2000000000001, -5.4, -15.6, -6.1, -17.200000000000017, -18.800000000000004, -21.2, -6.6, -12.2, -8.7, -28.500000000000007, -17.900000000000002, -5.2, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0550436914126422, "mean_inference_ms": 1.3974542659109213, "mean_action_processing_ms": 0.0754823180031405, "mean_env_wait_ms": 6.348036438215806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2496000, "timesteps_this_iter": 0, "agent_timesteps_total": 2496000, "timers": {"sample_time_ms": 20219.629, "sample_throughput": 197.828, "load_time_ms": 0.417, "load_throughput": 9583147.313, "learn_time_ms": 10272.415, "learn_throughput": 389.392, "update_time_ms": 2.214}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.6433357976611093, "policy_loss": -0.027120798955401107, "vf_loss": 66.76106319222399, "vf_explained_var": -0.054800901233509024, "kl": 0.012648778202824607, "entropy": 0.3093634254749744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2496000, "num_agent_steps_sampled": 2496000, "num_steps_trained": 2496000, "num_agent_steps_trained": 2496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25120, "training_iteration": 624, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-23-24", "timestamp": 1643707404, "time_this_iter_s": 17.519853115081787, "time_total_s": 16431.521384239197, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4172.012507200241, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 36.68000000000001, "ram_util_percent": 59.0}}
{"episode_reward_max": -3.3, "episode_reward_min": -80.2000000000001, "episode_reward_mean": -15.018000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.699999999999998, -7.2, -4.2, -24.5, -7.3, -5.4, -13.899999999999999, -15.999999999999998, -42.6, -24.2, -37.5, -12.399999999999995, -18.4, -10.2, -24.700000000000003, -5.799999999999999, -4.4, -31.300000000000068, -25.7, -22.6, -5.1000000000000005, -15.799999999999997, -14.199999999999987, -7.1, -6.300000000000001, -13.9, -32.90000000000003, -3.4, -28.000000000000007, -8.099999999999998, -19.7, -18.0, -20.4, -17.0, -16.2, -12.1, -12.6, -14.7, -13.499999999999998, -17.9, -79.3, -5.2, -12.699999999999973, -8.7, -11.700000000000001, -5.300000000000001, -80.2000000000001, -5.4, -15.6, -6.1, -17.200000000000017, -18.800000000000004, -21.2, -6.6, -12.2, -8.7, -28.500000000000007, -17.900000000000002, -5.2, -5.300000000000001, -8.299999999999999, -6.2, -6.300000000000001, -18.700000000000003, -23.6, -4.1, -9.3, -32.7, -20.400000000000002, -8.7, -7.2, -18.2, -4.2, -7.2, -6.4, -7.3, -11.5, -7.4, -19.3, -4.4, -4.6, -3.3, -15.699999999999998, -23.40000000000001, -16.9, -6.1, -5.0, -18.3, -6.300000000000001, -8.2, -4.9, -10.0, -18.5, -5.3, -24.800000000000008, -27.400000000000006, -10.999999999999998, -15.3, -19.4, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0548748864458595, "mean_inference_ms": 1.3976704545550966, "mean_action_processing_ms": 0.07549186510947768, "mean_env_wait_ms": 6.348832660257248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2500000, "timesteps_this_iter": 0, "agent_timesteps_total": 2500000, "timers": {"sample_time_ms": 20582.16, "sample_throughput": 194.343, "load_time_ms": 0.388, "load_throughput": 10306048.283, "learn_time_ms": 10103.325, "learn_throughput": 395.909, "update_time_ms": 2.265}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.1263649095485728, "policy_loss": -0.022690899141373174, "vf_loss": 14.664178515634228, "vf_explained_var": -0.00548562099856715, "kl": 0.010728994373405453, "entropy": 0.28142592147473366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2500000, "num_agent_steps_sampled": 2500000, "num_steps_trained": 2500000, "num_agent_steps_trained": 2500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25160, "training_iteration": 625, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-23-43", "timestamp": 1643707423, "time_this_iter_s": 19.5489718914032, "time_total_s": 16451.0703561306, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4191.561479091644, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 40.871428571428574, "ram_util_percent": 58.88928571428573}}
{"episode_reward_max": -3.3, "episode_reward_min": -80.2000000000001, "episode_reward_mean": -14.170000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.3, -5.2, -12.699999999999973, -8.7, -11.700000000000001, -5.300000000000001, -80.2000000000001, -5.4, -15.6, -6.1, -17.200000000000017, -18.800000000000004, -21.2, -6.6, -12.2, -8.7, -28.500000000000007, -17.900000000000002, -5.2, -5.300000000000001, -8.299999999999999, -6.2, -6.300000000000001, -18.700000000000003, -23.6, -4.1, -9.3, -32.7, -20.400000000000002, -8.7, -7.2, -18.2, -4.2, -7.2, -6.4, -7.3, -11.5, -7.4, -19.3, -4.4, -4.6, -3.3, -15.699999999999998, -23.40000000000001, -16.9, -6.1, -5.0, -18.3, -6.300000000000001, -8.2, -4.9, -10.0, -18.5, -5.3, -24.800000000000008, -27.400000000000006, -10.999999999999998, -15.3, -19.4, -5.3, -23.600000000000005, -15.399999999999999, -4.2, -32.0, -4.1000000000000005, -27.099999999999998, -14.1, -13.999999999999996, -15.199999999999982, -54.3, -5.300000000000001, -7.199999999999999, -11.999999999999998, -6.3, -13.6, -15.1, -10.8, -4.6, -21.299999999999997, -5.2, -19.2, -9.2, -17.599999999999994, -10.7, -10.2, -11.899999999999999, -4.300000000000001, -12.999999999999998, -17.5, -9.499999999999998, -18.5, -13.299999999999995, -5.3, -20.2, -10.7, -19.9, -9.2, -3.3, -18.999999999999996, -16.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0554946723577532, "mean_inference_ms": 1.398744397288572, "mean_action_processing_ms": 0.07554653838803507, "mean_env_wait_ms": 6.353602654038189, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2504000, "timesteps_this_iter": 0, "agent_timesteps_total": 2504000, "timers": {"sample_time_ms": 20344.57, "sample_throughput": 196.613, "load_time_ms": 0.408, "load_throughput": 9807796.095, "learn_time_ms": 10138.63, "learn_throughput": 394.531, "update_time_ms": 2.29}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.21710334835543987, "policy_loss": -0.024128276577359567, "vf_loss": 23.890990964058908, "vf_explained_var": 0.07375483435969199, "kl": 0.010318746431709309, "entropy": 0.28321562133409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2504000, "num_agent_steps_sampled": 2504000, "num_steps_trained": 2504000, "num_agent_steps_trained": 2504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25200, "training_iteration": 626, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-24-03", "timestamp": 1643707443, "time_this_iter_s": 19.531417846679688, "time_total_s": 16470.60177397728, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4211.092896938324, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 41.88928571428572, "ram_util_percent": 58.971428571428575}}
{"episode_reward_max": -2.900000000000001, "episode_reward_min": -94.49999999999987, "episode_reward_mean": -15.626, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.6, -3.3, -15.699999999999998, -23.40000000000001, -16.9, -6.1, -5.0, -18.3, -6.300000000000001, -8.2, -4.9, -10.0, -18.5, -5.3, -24.800000000000008, -27.400000000000006, -10.999999999999998, -15.3, -19.4, -5.3, -23.600000000000005, -15.399999999999999, -4.2, -32.0, -4.1000000000000005, -27.099999999999998, -14.1, -13.999999999999996, -15.199999999999982, -54.3, -5.300000000000001, -7.199999999999999, -11.999999999999998, -6.3, -13.6, -15.1, -10.8, -4.6, -21.299999999999997, -5.2, -19.2, -9.2, -17.599999999999994, -10.7, -10.2, -11.899999999999999, -4.300000000000001, -12.999999999999998, -17.5, -9.499999999999998, -18.5, -13.299999999999995, -5.3, -20.2, -10.7, -19.9, -9.2, -3.3, -18.999999999999996, -16.2, -39.5, -28.5, -5.1, -4.800000000000001, -15.499999999999982, -16.999999999999996, -5.3, -94.49999999999987, -4.3, -15.699999999999998, -21.900000000000006, -8.1, -5.000000000000001, -11.9, -5.300000000000001, -23.000000000000007, -17.4, -34.00000000000005, -23.900000000000034, -4.3, -15.8, -9.2, -13.5, -17.0, -16.2, -2.900000000000001, -4.4, -22.2, -15.099999999999994, -4.300000000000001, -87.9, -23.300000000000004, -32.7, -35.6, -7.3, -13.899999999999999, -3.2, -5.300000000000001, -13.399999999999999, -20.599999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.056210488587045, "mean_inference_ms": 1.3998423628066332, "mean_action_processing_ms": 0.07562034585995715, "mean_env_wait_ms": 6.358772158352021, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2508000, "timesteps_this_iter": 0, "agent_timesteps_total": 2508000, "timers": {"sample_time_ms": 20265.489, "sample_throughput": 197.38, "load_time_ms": 0.387, "load_throughput": 10326982.642, "learn_time_ms": 10308.385, "learn_throughput": 388.034, "update_time_ms": 2.211}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.7913409926337741, "policy_loss": -0.022987700180120526, "vf_loss": 81.18547710141829, "vf_explained_var": -0.014159805159414968, "kl": 0.010995286786393658, "entropy": 0.2826615375737029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2508000, "num_agent_steps_sampled": 2508000, "num_steps_trained": 2508000, "num_agent_steps_trained": 2508000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25240, "training_iteration": 627, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-24-25", "timestamp": 1643707465, "time_this_iter_s": 22.62600016593933, "time_total_s": 16493.22777414322, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4233.718897104263, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 42.628125, "ram_util_percent": 59.49375}}
{"episode_reward_max": -2.900000000000001, "episode_reward_min": -94.49999999999987, "episode_reward_mean": -15.048, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.2, -9.2, -17.599999999999994, -10.7, -10.2, -11.899999999999999, -4.300000000000001, -12.999999999999998, -17.5, -9.499999999999998, -18.5, -13.299999999999995, -5.3, -20.2, -10.7, -19.9, -9.2, -3.3, -18.999999999999996, -16.2, -39.5, -28.5, -5.1, -4.800000000000001, -15.499999999999982, -16.999999999999996, -5.3, -94.49999999999987, -4.3, -15.699999999999998, -21.900000000000006, -8.1, -5.000000000000001, -11.9, -5.300000000000001, -23.000000000000007, -17.4, -34.00000000000005, -23.900000000000034, -4.3, -15.8, -9.2, -13.5, -17.0, -16.2, -2.900000000000001, -4.4, -22.2, -15.099999999999994, -4.300000000000001, -87.9, -23.300000000000004, -32.7, -35.6, -7.3, -13.899999999999999, -3.2, -5.300000000000001, -13.399999999999999, -20.599999999999994, -3.3, -5.300000000000001, -25.90000000000001, -9.100000000000001, -16.2, -5.300000000000001, -10.6, -11.999999999999998, -11.1, -7.2, -7.299999999999999, -18.0, -8.2, -17.199999999999996, -12.999999999999996, -11.999999999999996, -4.3, -5.300000000000001, -21.100000000000048, -17.999999999999996, -6.8999999999999995, -3.8000000000000003, -18.299999999999997, -3.8000000000000007, -11.2, -8.099999999999998, -11.7, -9.4, -4.300000000000001, -30.500000000000014, -6.999999999999999, -31.00000000000001, -40.10000000000001, -14.2, -4.1, -33.40000000000001, -7.3, -7.300000000000001, -11.2, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0566269149355119, "mean_inference_ms": 1.4003121789881532, "mean_action_processing_ms": 0.07566302480519008, "mean_env_wait_ms": 6.361247361800516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2512000, "timesteps_this_iter": 0, "agent_timesteps_total": 2512000, "timers": {"sample_time_ms": 20240.548, "sample_throughput": 197.623, "load_time_ms": 0.4, "load_throughput": 10010869.384, "learn_time_ms": 10137.147, "learn_throughput": 394.588, "update_time_ms": 2.333}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.16107322089273923, "policy_loss": -0.031603354085437074, "vf_loss": 18.929990267881784, "vf_explained_var": 0.06357838979331396, "kl": 0.015007450548542061, "entropy": 0.2774969572421684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2512000, "num_agent_steps_sampled": 2512000, "num_steps_trained": 2512000, "num_agent_steps_trained": 2512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25280, "training_iteration": 628, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-24-44", "timestamp": 1643707484, "time_this_iter_s": 18.66494584083557, "time_total_s": 16511.892719984055, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4252.383842945099, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 45.611111111111114, "ram_util_percent": 62.062962962962956}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -87.9, "episode_reward_mean": -14.509, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.8, -9.2, -13.5, -17.0, -16.2, -2.900000000000001, -4.4, -22.2, -15.099999999999994, -4.300000000000001, -87.9, -23.300000000000004, -32.7, -35.6, -7.3, -13.899999999999999, -3.2, -5.300000000000001, -13.399999999999999, -20.599999999999994, -3.3, -5.300000000000001, -25.90000000000001, -9.100000000000001, -16.2, -5.300000000000001, -10.6, -11.999999999999998, -11.1, -7.2, -7.299999999999999, -18.0, -8.2, -17.199999999999996, -12.999999999999996, -11.999999999999996, -4.3, -5.300000000000001, -21.100000000000048, -17.999999999999996, -6.8999999999999995, -3.8000000000000003, -18.299999999999997, -3.8000000000000007, -11.2, -8.099999999999998, -11.7, -9.4, -4.300000000000001, -30.500000000000014, -6.999999999999999, -31.00000000000001, -40.10000000000001, -14.2, -4.1, -33.40000000000001, -7.3, -7.300000000000001, -11.2, -3.3, -8.2, -4.300000000000001, -2.3000000000000003, -4.300000000000001, -12.599999999999993, -3.3, -3.4000000000000004, -5.2, -25.200000000000003, -5.3, -20.9, -10.899999999999999, -10.0, -4.3, -9.5, -4.300000000000001, -17.29999999999999, -32.3, -4.4, -20.4, -13.3, -9.800000000000002, -10.799999999999999, -28.6, -8.2, -15.399999999999999, -14.199999999999998, -10.799999999999999, -13.099999999999998, -72.5, -3.3, -9.2, -30.4, -43.10000000000005, -4.5, -18.7, -12.699999999999998, -12.3, -28.300000000000004, -22.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0572154327999355, "mean_inference_ms": 1.4013491403026668, "mean_action_processing_ms": 0.07571896849303814, "mean_env_wait_ms": 6.366053206016207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2516000, "timesteps_this_iter": 0, "agent_timesteps_total": 2516000, "timers": {"sample_time_ms": 20324.202, "sample_throughput": 196.81, "load_time_ms": 0.383, "load_throughput": 10443984.064, "learn_time_ms": 9521.207, "learn_throughput": 420.115, "update_time_ms": 2.27}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.39686121615150605, "policy_loss": -0.0169519048164128, "vf_loss": 41.12523421343937, "vf_explained_var": -0.0212540110593201, "kl": 0.011381281618984994, "entropy": 0.3086341156433987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2516000, "num_agent_steps_sampled": 2516000, "num_steps_trained": 2516000, "num_agent_steps_trained": 2516000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25320, "training_iteration": 629, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-25-05", "timestamp": 1643707505, "time_this_iter_s": 20.354936122894287, "time_total_s": 16532.24765610695, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4272.738779067993, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 42.50689655172414, "ram_util_percent": 61.81724137931035}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -72.5, "episode_reward_mean": -13.624999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.8999999999999995, -3.8000000000000003, -18.299999999999997, -3.8000000000000007, -11.2, -8.099999999999998, -11.7, -9.4, -4.300000000000001, -30.500000000000014, -6.999999999999999, -31.00000000000001, -40.10000000000001, -14.2, -4.1, -33.40000000000001, -7.3, -7.300000000000001, -11.2, -3.3, -8.2, -4.300000000000001, -2.3000000000000003, -4.300000000000001, -12.599999999999993, -3.3, -3.4000000000000004, -5.2, -25.200000000000003, -5.3, -20.9, -10.899999999999999, -10.0, -4.3, -9.5, -4.300000000000001, -17.29999999999999, -32.3, -4.4, -20.4, -13.3, -9.800000000000002, -10.799999999999999, -28.6, -8.2, -15.399999999999999, -14.199999999999998, -10.799999999999999, -13.099999999999998, -72.5, -3.3, -9.2, -30.4, -43.10000000000005, -4.5, -18.7, -12.699999999999998, -12.3, -28.300000000000004, -22.2, -5.300000000000001, -27.900000000000002, -10.0, -4.3, -15.7, -4.2, -39.2, -14.299999999999999, -7.3, -5.2, -6.1, -7.2, -3.3, -15.299999999999997, -3.5000000000000004, -14.199999999999998, -5.1, -20.8, -7.499999999999998, -8.1, -17.3, -6.0, -13.199999999999998, -13.799999999999997, -18.7, -51.800000000000075, -3.3, -25.9, -38.3, -3.2, -6.300000000000001, -15.199999999999996, -4.300000000000001, -4.3, -7.3, -10.100000000000001, -9.3, -15.599999999999985, -13.1, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0575241297799105, "mean_inference_ms": 1.4020987045065447, "mean_action_processing_ms": 0.07575749832477897, "mean_env_wait_ms": 6.369426201994363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2520000, "timesteps_this_iter": 0, "agent_timesteps_total": 2520000, "timers": {"sample_time_ms": 19641.525, "sample_throughput": 203.65, "load_time_ms": 0.372, "load_throughput": 10758763.627, "learn_time_ms": 9682.395, "learn_throughput": 413.121, "update_time_ms": 2.294}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.18910864531513183, "policy_loss": -0.024940105270273905, "vf_loss": 21.193334533322243, "vf_explained_var": 0.06663085638835865, "kl": 0.009401823681871044, "entropy": 0.2730502992868423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2520000, "num_agent_steps_sampled": 2520000, "num_steps_trained": 2520000, "num_agent_steps_trained": 2520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25360, "training_iteration": 630, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-25-23", "timestamp": 1643707523, "time_this_iter_s": 18.766237258911133, "time_total_s": 16551.01389336586, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4291.505016326904, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 34.98076923076923, "ram_util_percent": 59.849999999999994}}
{"episode_reward_max": -2.2, "episode_reward_min": -72.5, "episode_reward_mean": -13.13, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.3, -9.800000000000002, -10.799999999999999, -28.6, -8.2, -15.399999999999999, -14.199999999999998, -10.799999999999999, -13.099999999999998, -72.5, -3.3, -9.2, -30.4, -43.10000000000005, -4.5, -18.7, -12.699999999999998, -12.3, -28.300000000000004, -22.2, -5.300000000000001, -27.900000000000002, -10.0, -4.3, -15.7, -4.2, -39.2, -14.299999999999999, -7.3, -5.2, -6.1, -7.2, -3.3, -15.299999999999997, -3.5000000000000004, -14.199999999999998, -5.1, -20.8, -7.499999999999998, -8.1, -17.3, -6.0, -13.199999999999998, -13.799999999999997, -18.7, -51.800000000000075, -3.3, -25.9, -38.3, -3.2, -6.300000000000001, -15.199999999999996, -4.300000000000001, -4.3, -7.3, -10.100000000000001, -9.3, -15.599999999999985, -13.1, -4.3, -7.4, -9.700000000000001, -8.399999999999999, -4.3, -7.700000000000001, -5.2, -15.199999999999998, -9.2, -4.2, -2.2, -11.099999999999998, -10.0, -7.2, -4.300000000000001, -6.300000000000001, -9.3, -5.0, -12.2, -14.599999999999996, -11.2, -5.0, -8.799999999999999, -3.3, -5.4, -32.6, -5.2, -23.900000000000006, -10.799999999999999, -11.099999999999998, -4.3, -18.7, -20.300000000000004, -20.2, -4.300000000000001, -17.800000000000004, -16.9, -3.4, -21.099999999999998, -12.199999999999973, -15.799999999999983], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.057790535277519, "mean_inference_ms": 1.4027290568533117, "mean_action_processing_ms": 0.07578871067009249, "mean_env_wait_ms": 6.372303715843779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2524000, "timesteps_this_iter": 0, "agent_timesteps_total": 2524000, "timers": {"sample_time_ms": 19498.84, "sample_throughput": 205.14, "load_time_ms": 0.404, "load_throughput": 9893976.529, "learn_time_ms": 9982.293, "learn_throughput": 400.71, "update_time_ms": 2.375}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.10190373482883618, "policy_loss": -0.008982364673127411, "vf_loss": 10.883315082711558, "vf_explained_var": 0.14820845902607005, "kl": 0.009124231880951133, "entropy": 0.29694222645253265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2524000, "num_agent_steps_sampled": 2524000, "num_steps_trained": 2524000, "num_agent_steps_trained": 2524000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25400, "training_iteration": 631, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-25-46", "timestamp": 1643707546, "time_this_iter_s": 22.980101823806763, "time_total_s": 16573.993995189667, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4314.485118150711, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 40.118181818181824, "ram_util_percent": 59.724242424242426}}
{"episode_reward_max": -2.2, "episode_reward_min": -51.800000000000075, "episode_reward_mean": -11.488, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.3, -6.0, -13.199999999999998, -13.799999999999997, -18.7, -51.800000000000075, -3.3, -25.9, -38.3, -3.2, -6.300000000000001, -15.199999999999996, -4.300000000000001, -4.3, -7.3, -10.100000000000001, -9.3, -15.599999999999985, -13.1, -4.3, -7.4, -9.700000000000001, -8.399999999999999, -4.3, -7.700000000000001, -5.2, -15.199999999999998, -9.2, -4.2, -2.2, -11.099999999999998, -10.0, -7.2, -4.300000000000001, -6.300000000000001, -9.3, -5.0, -12.2, -14.599999999999996, -11.2, -5.0, -8.799999999999999, -3.3, -5.4, -32.6, -5.2, -23.900000000000006, -10.799999999999999, -11.099999999999998, -4.3, -18.7, -20.300000000000004, -20.2, -4.300000000000001, -17.800000000000004, -16.9, -3.4, -21.099999999999998, -12.199999999999973, -15.799999999999983, -7.300000000000001, -7.300000000000001, -7.4, -4.4, -9.899999999999999, -19.900000000000006, -22.5, -3.3, -9.2, -18.799999999999997, -8.499999999999998, -16.2, -20.8, -6.1, -12.599999999999998, -3.3, -9.3, -28.600000000000026, -18.4, -10.5, -4.300000000000001, -12.299999999999997, -3.2, -4.300000000000001, -4.4, -6.5, -31.6, -18.299999999999997, -7.499999999999998, -5.300000000000001, -14.3, -10.799999999999999, -11.2, -10.399999999999999, -6.2, -6.7, -10.6, -9.3, -3.3, -16.899999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0584114278036152, "mean_inference_ms": 1.4036540789807368, "mean_action_processing_ms": 0.0758365967164038, "mean_env_wait_ms": 6.376766736477005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2528000, "timesteps_this_iter": 0, "agent_timesteps_total": 2528000, "timers": {"sample_time_ms": 20206.543, "sample_throughput": 197.956, "load_time_ms": 0.402, "load_throughput": 9947949.007, "learn_time_ms": 9965.079, "learn_throughput": 401.402, "update_time_ms": 2.358}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.11721726290641292, "policy_loss": -0.01583015540294269, "vf_loss": 13.131769910422705, "vf_explained_var": 0.22060145011512183, "kl": 0.007687653496301701, "entropy": 0.2575994147007824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2528000, "num_agent_steps_sampled": 2528000, "num_steps_trained": 2528000, "num_agent_steps_trained": 2528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25440, "training_iteration": 632, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-26-10", "timestamp": 1643707570, "time_this_iter_s": 23.431835889816284, "time_total_s": 16597.425831079483, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4337.916954040527, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 38.25294117647059, "ram_util_percent": 60.09411764705883}}
{"episode_reward_max": -2.5, "episode_reward_min": -35.20000000000001, "episode_reward_mean": -11.835, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -8.799999999999999, -3.3, -5.4, -32.6, -5.2, -23.900000000000006, -10.799999999999999, -11.099999999999998, -4.3, -18.7, -20.300000000000004, -20.2, -4.300000000000001, -17.800000000000004, -16.9, -3.4, -21.099999999999998, -12.199999999999973, -15.799999999999983, -7.300000000000001, -7.300000000000001, -7.4, -4.4, -9.899999999999999, -19.900000000000006, -22.5, -3.3, -9.2, -18.799999999999997, -8.499999999999998, -16.2, -20.8, -6.1, -12.599999999999998, -3.3, -9.3, -28.600000000000026, -18.4, -10.5, -4.300000000000001, -12.299999999999997, -3.2, -4.300000000000001, -4.4, -6.5, -31.6, -18.299999999999997, -7.499999999999998, -5.300000000000001, -14.3, -10.799999999999999, -11.2, -10.399999999999999, -6.2, -6.7, -10.6, -9.3, -3.3, -16.899999999999995, -3.4, -17.9, -11.5, -6.2, -7.3, -17.699999999999996, -6.199999999999999, -4.2, -10.699999999999998, -6.1, -7.299999999999999, -35.20000000000001, -13.3, -3.3, -14.799999999999997, -7.2, -11.999999999999998, -6.3999999999999995, -33.8, -10.699999999999998, -20.099999999999998, -5.3, -9.3, -13.899999999999999, -2.6000000000000005, -18.0, -6.1, -13.600000000000001, -12.099999999999998, -5.2, -2.5, -11.799999999999999, -32.400000000000006, -9.399999999999997, -19.3, -14.799999999999999, -23.000000000000007, -16.5, -4.3, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.059218102105052, "mean_inference_ms": 1.404880570608737, "mean_action_processing_ms": 0.07590298343603183, "mean_env_wait_ms": 6.382811986769095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2532000, "timesteps_this_iter": 0, "agent_timesteps_total": 2532000, "timers": {"sample_time_ms": 20451.668, "sample_throughput": 195.583, "load_time_ms": 0.413, "load_throughput": 9676557.85, "learn_time_ms": 10061.632, "learn_throughput": 397.55, "update_time_ms": 2.272}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.1558284477671228, "policy_loss": -0.015818094354002707, "vf_loss": 16.977013689151374, "vf_explained_var": 0.10961201133266572, "kl": 0.008339592429552702, "entropy": 0.29527529551777787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2532000, "num_agent_steps_sampled": 2532000, "num_steps_trained": 2532000, "num_agent_steps_trained": 2532000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25480, "training_iteration": 633, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-26-31", "timestamp": 1643707591, "time_this_iter_s": 21.618727922439575, "time_total_s": 16619.044559001923, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4359.535681962967, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 38.79, "ram_util_percent": 59.990000000000016}}
{"episode_reward_max": -2.5, "episode_reward_min": -75.5, "episode_reward_mean": -12.378, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -12.299999999999997, -3.2, -4.300000000000001, -4.4, -6.5, -31.6, -18.299999999999997, -7.499999999999998, -5.300000000000001, -14.3, -10.799999999999999, -11.2, -10.399999999999999, -6.2, -6.7, -10.6, -9.3, -3.3, -16.899999999999995, -3.4, -17.9, -11.5, -6.2, -7.3, -17.699999999999996, -6.199999999999999, -4.2, -10.699999999999998, -6.1, -7.299999999999999, -35.20000000000001, -13.3, -3.3, -14.799999999999997, -7.2, -11.999999999999998, -6.3999999999999995, -33.8, -10.699999999999998, -20.099999999999998, -5.3, -9.3, -13.899999999999999, -2.6000000000000005, -18.0, -6.1, -13.600000000000001, -12.099999999999998, -5.2, -2.5, -11.799999999999999, -32.400000000000006, -9.399999999999997, -19.3, -14.799999999999999, -23.000000000000007, -16.5, -4.3, -5.300000000000001, -5.300000000000001, -3.4, -12.3, -6.2, -4.3, -39.5, -5.3, -21.3, -12.399999999999999, -4.3, -3.3, -75.5, -8.7, -9.9, -8.700000000000001, -24.599999999999994, -13.2, -7.3, -8.399999999999999, -23.000000000000007, -12.899999999999999, -27.200000000000003, -3.3, -4.700000000000001, -28.200000000000003, -11.600000000000001, -20.2, -13.999999999999998, -38.5, -4.300000000000001, -8.3, -13.1, -5.300000000000001, -7.3, -11.8, -9.499999999999998, -14.8, -6.2, -4.3, -17.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0597805481863027, "mean_inference_ms": 1.405767843289297, "mean_action_processing_ms": 0.0759517822346219, "mean_env_wait_ms": 6.387134584434336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2536000, "timesteps_this_iter": 0, "agent_timesteps_total": 2536000, "timers": {"sample_time_ms": 20716.73, "sample_throughput": 193.081, "load_time_ms": 0.44, "load_throughput": 9094327.84, "learn_time_ms": 10374.778, "learn_throughput": 385.55, "update_time_ms": 2.038}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.39877905718611695, "policy_loss": -0.010061495442704488, "vf_loss": 40.69905890463501, "vf_explained_var": 0.007213094029375302, "kl": 0.00822212377577356, "entropy": 0.27356337761526467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2536000, "num_agent_steps_sampled": 2536000, "num_steps_trained": 2536000, "num_agent_steps_trained": 2536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25520, "training_iteration": 634, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-26-54", "timestamp": 1643707614, "time_this_iter_s": 22.3508038520813, "time_total_s": 16641.395362854004, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4381.886485815048, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 40.803125, "ram_util_percent": 59.940625}}
{"episode_reward_max": -2.5, "episode_reward_min": -75.5, "episode_reward_mean": -13.49, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.099999999999998, -5.3, -9.3, -13.899999999999999, -2.6000000000000005, -18.0, -6.1, -13.600000000000001, -12.099999999999998, -5.2, -2.5, -11.799999999999999, -32.400000000000006, -9.399999999999997, -19.3, -14.799999999999999, -23.000000000000007, -16.5, -4.3, -5.300000000000001, -5.300000000000001, -3.4, -12.3, -6.2, -4.3, -39.5, -5.3, -21.3, -12.399999999999999, -4.3, -3.3, -75.5, -8.7, -9.9, -8.700000000000001, -24.599999999999994, -13.2, -7.3, -8.399999999999999, -23.000000000000007, -12.899999999999999, -27.200000000000003, -3.3, -4.700000000000001, -28.200000000000003, -11.600000000000001, -20.2, -13.999999999999998, -38.5, -4.300000000000001, -8.3, -13.1, -5.300000000000001, -7.3, -11.8, -9.499999999999998, -14.8, -6.2, -4.3, -17.299999999999997, -4.800000000000001, -4.3, -7.399999999999999, -8.2, -6.1, -33.5, -22.799999999999997, -13.599999999999978, -19.099999999999998, -3.3, -27.2, -4.4, -22.0, -18.599999999999998, -5.2, -20.1, -17.199999999999996, -22.3, -11.399999999999999, -4.4, -4.2, -11.3, -14.7, -13.999999999999998, -3.2, -6.3, -6.5, -16.8, -30.7, -4.3, -3.2, -11.0, -15.0, -24.90000000000002, -4.300000000000001, -4.9, -32.60000000000001, -13.2, -21.500000000000007, -25.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0606316636676407, "mean_inference_ms": 1.4072016561451444, "mean_action_processing_ms": 0.07603042516253333, "mean_env_wait_ms": 6.394184047232402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2540000, "timesteps_this_iter": 0, "agent_timesteps_total": 2540000, "timers": {"sample_time_ms": 21281.258, "sample_throughput": 187.959, "load_time_ms": 0.465, "load_throughput": 8608998.358, "learn_time_ms": 10979.809, "learn_throughput": 364.305, "update_time_ms": 2.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.17723334101629593, "policy_loss": -0.013821227805468664, "vf_loss": 18.86920003807673, "vf_explained_var": 0.21092864627479224, "kl": 0.010500323665307405, "entropy": 0.2774180435525474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2540000, "num_agent_steps_sampled": 2540000, "num_steps_trained": 2540000, "num_agent_steps_trained": 2540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25560, "training_iteration": 635, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-27-22", "timestamp": 1643707642, "time_this_iter_s": 28.132265090942383, "time_total_s": 16669.527627944946, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4410.018750905991, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 39.03, "ram_util_percent": 60.295}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.5, "episode_reward_mean": -13.154000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999999, -27.200000000000003, -3.3, -4.700000000000001, -28.200000000000003, -11.600000000000001, -20.2, -13.999999999999998, -38.5, -4.300000000000001, -8.3, -13.1, -5.300000000000001, -7.3, -11.8, -9.499999999999998, -14.8, -6.2, -4.3, -17.299999999999997, -4.800000000000001, -4.3, -7.399999999999999, -8.2, -6.1, -33.5, -22.799999999999997, -13.599999999999978, -19.099999999999998, -3.3, -27.2, -4.4, -22.0, -18.599999999999998, -5.2, -20.1, -17.199999999999996, -22.3, -11.399999999999999, -4.4, -4.2, -11.3, -14.7, -13.999999999999998, -3.2, -6.3, -6.5, -16.8, -30.7, -4.3, -3.2, -11.0, -15.0, -24.90000000000002, -4.300000000000001, -4.9, -32.60000000000001, -13.2, -21.500000000000007, -25.300000000000004, -26.3, -15.199999999999996, -5.2, -5.1, -32.3, -13.3, -5.2, -7.3, -5.699999999999999, -21.3, -4.2, -5.300000000000001, -7.2, -9.0, -23.2, -25.1, -5.300000000000001, -5.2, -6.3, -16.299999999999997, -6.4, -24.3, -16.6, -8.2, -19.3, -4.700000000000001, -23.70000000000001, -9.200000000000001, -15.199999999999998, -14.499999999999996, -23.4, -7.699999999999998, -12.0, -6.9, -4.2, -14.099999999999996, -17.9, -5.2, -20.900000000000002, -10.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0618264954696697, "mean_inference_ms": 1.409113492219446, "mean_action_processing_ms": 0.07613474437692981, "mean_env_wait_ms": 6.403473486750784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2544000, "timesteps_this_iter": 0, "agent_timesteps_total": 2544000, "timers": {"sample_time_ms": 21987.578, "sample_throughput": 181.921, "load_time_ms": 0.463, "load_throughput": 8642703.482, "learn_time_ms": 11272.157, "learn_throughput": 354.857, "update_time_ms": 2.04}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.1597631102374014, "policy_loss": -0.011539541336116932, "vf_loss": 16.90222355152971, "vf_explained_var": 0.18172118586878622, "kl": 0.010135201711979713, "entropy": 0.28208292476752755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2544000, "num_agent_steps_sampled": 2544000, "num_steps_trained": 2544000, "num_agent_steps_trained": 2544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25600, "training_iteration": 636, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-27-46", "timestamp": 1643707666, "time_this_iter_s": 23.469000101089478, "time_total_s": 16692.996628046036, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4433.48775100708, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 35.98823529411765, "ram_util_percent": 60.60294117647057}}
{"episode_reward_max": -3.2, "episode_reward_min": -36.1, "episode_reward_mean": -11.991, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -11.3, -14.7, -13.999999999999998, -3.2, -6.3, -6.5, -16.8, -30.7, -4.3, -3.2, -11.0, -15.0, -24.90000000000002, -4.300000000000001, -4.9, -32.60000000000001, -13.2, -21.500000000000007, -25.300000000000004, -26.3, -15.199999999999996, -5.2, -5.1, -32.3, -13.3, -5.2, -7.3, -5.699999999999999, -21.3, -4.2, -5.300000000000001, -7.2, -9.0, -23.2, -25.1, -5.300000000000001, -5.2, -6.3, -16.299999999999997, -6.4, -24.3, -16.6, -8.2, -19.3, -4.700000000000001, -23.70000000000001, -9.200000000000001, -15.199999999999998, -14.499999999999996, -23.4, -7.699999999999998, -12.0, -6.9, -4.2, -14.099999999999996, -17.9, -5.2, -20.900000000000002, -10.399999999999999, -10.499999999999998, -3.3, -9.100000000000001, -4.0, -36.1, -15.899999999999997, -14.299999999999994, -6.8, -15.600000000000001, -11.8, -16.299999999999997, -13.399999999999999, -10.899999999999999, -16.5, -3.2, -18.000000000000004, -3.4, -11.89999999999998, -4.300000000000001, -22.1, -3.3, -4.4, -11.6, -6.3, -6.400000000000002, -7.099999999999998, -9.499999999999998, -5.1000000000000005, -3.3, -4.3, -13.2, -15.2, -33.50000000000004, -5.4, -8.6, -9.5, -3.3, -7.6000000000000005, -4.3, -13.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.062643945067112, "mean_inference_ms": 1.4104554649992997, "mean_action_processing_ms": 0.07620803361761411, "mean_env_wait_ms": 6.4100294678927785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2548000, "timesteps_this_iter": 0, "agent_timesteps_total": 2548000, "timers": {"sample_time_ms": 22236.862, "sample_throughput": 179.881, "load_time_ms": 0.472, "load_throughput": 8476766.37, "learn_time_ms": 11207.715, "learn_throughput": 356.897, "update_time_ms": 2.202}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.12627560549605918, "policy_loss": -0.009251962020312266, "vf_loss": 13.33628908318858, "vf_explained_var": 0.12860919000000082, "kl": 0.009620806098094065, "entropy": 0.27685943241882066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2548000, "num_agent_steps_sampled": 2548000, "num_steps_trained": 2548000, "num_agent_steps_trained": 2548000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25640, "training_iteration": 637, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-28-07", "timestamp": 1643707687, "time_this_iter_s": 21.557183027267456, "time_total_s": 16714.553811073303, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4455.0449340343475, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 33.49354838709678, "ram_util_percent": 60.53225806451612}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -102.8, "episode_reward_mean": -13.030000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -24.3, -16.6, -8.2, -19.3, -4.700000000000001, -23.70000000000001, -9.200000000000001, -15.199999999999998, -14.499999999999996, -23.4, -7.699999999999998, -12.0, -6.9, -4.2, -14.099999999999996, -17.9, -5.2, -20.900000000000002, -10.399999999999999, -10.499999999999998, -3.3, -9.100000000000001, -4.0, -36.1, -15.899999999999997, -14.299999999999994, -6.8, -15.600000000000001, -11.8, -16.299999999999997, -13.399999999999999, -10.899999999999999, -16.5, -3.2, -18.000000000000004, -3.4, -11.89999999999998, -4.300000000000001, -22.1, -3.3, -4.4, -11.6, -6.3, -6.400000000000002, -7.099999999999998, -9.499999999999998, -5.1000000000000005, -3.3, -4.3, -13.2, -15.2, -33.50000000000004, -5.4, -8.6, -9.5, -3.3, -7.6000000000000005, -4.3, -13.1, -102.8, -17.699999999999996, -3.3, -4.4, -7.3, -4.300000000000001, -6.999999999999998, -3.2, -26.000000000000007, -22.6, -13.499999999999998, -5.5, -20.800000000000008, -34.1, -3.3, -24.100000000000005, -26.500000000000007, -13.799999999999999, -12.099999999999998, -10.7, -5.3, -6.1, -21.800000000000004, -16.099999999999994, -2.5000000000000004, -22.299999999999997, -3.2, -5.4, -20.300000000000004, -12.799999999999999, -3.7, -17.1, -17.599999999999998, -6.1, -9.7, -10.1, -36.5, -12.099999999999998, -20.700000000000003, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0631860636300308, "mean_inference_ms": 1.4112280422475971, "mean_action_processing_ms": 0.07624938963245986, "mean_env_wait_ms": 6.4136152900389725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2552000, "timesteps_this_iter": 0, "agent_timesteps_total": 2552000, "timers": {"sample_time_ms": 22318.655, "sample_throughput": 179.222, "load_time_ms": 0.482, "load_throughput": 8302675.311, "learn_time_ms": 11591.818, "learn_throughput": 345.071, "update_time_ms": 2.153}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.5949455477429995, "policy_loss": -0.017176883300185523, "vf_loss": 61.00369078510551, "vf_explained_var": -0.13565530950023283, "kl": 0.009269071045235368, "entropy": 0.2751033123382317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2552000, "num_agent_steps_sampled": 2552000, "num_steps_trained": 2552000, "num_agent_steps_trained": 2552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25680, "training_iteration": 638, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-28-31", "timestamp": 1643707711, "time_this_iter_s": 23.94977307319641, "time_total_s": 16738.5035841465, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4478.994707107544, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 32.36764705882353, "ram_util_percent": 60.332352941176474}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -102.8, "episode_reward_mean": -13.918999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -4.4, -11.6, -6.3, -6.400000000000002, -7.099999999999998, -9.499999999999998, -5.1000000000000005, -3.3, -4.3, -13.2, -15.2, -33.50000000000004, -5.4, -8.6, -9.5, -3.3, -7.6000000000000005, -4.3, -13.1, -102.8, -17.699999999999996, -3.3, -4.4, -7.3, -4.300000000000001, -6.999999999999998, -3.2, -26.000000000000007, -22.6, -13.499999999999998, -5.5, -20.800000000000008, -34.1, -3.3, -24.100000000000005, -26.500000000000007, -13.799999999999999, -12.099999999999998, -10.7, -5.3, -6.1, -21.800000000000004, -16.099999999999994, -2.5000000000000004, -22.299999999999997, -3.2, -5.4, -20.300000000000004, -12.799999999999999, -3.7, -17.1, -17.599999999999998, -6.1, -9.7, -10.1, -36.5, -12.099999999999998, -20.700000000000003, -3.4, -13.899999999999997, -3.4, -20.199999999999996, -22.4, -4.2, -12.3, -3.4, -25.699999999999996, -2.7000000000000006, -14.699999999999998, -5.1, -5.8, -7.2, -37.39999999999999, -14.399999999999999, -3.3, -12.599999999999998, -4.6000000000000005, -5.1000000000000005, -48.80000000000001, -13.399999999999999, -4.800000000000001, -19.3, -11.599999999999998, -28.7, -5.3, -3.3, -18.9, -19.099999999999998, -5.300000000000001, -18.3, -79.79999999999998, -10.799999999999999, -4.3, -26.8, -40.300000000000054, -7.099999999999998, -5.300000000000001, -3.2, -8.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.064153534136341, "mean_inference_ms": 1.4127766488481752, "mean_action_processing_ms": 0.07633064743141618, "mean_env_wait_ms": 6.421341591611139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2556000, "timesteps_this_iter": 0, "agent_timesteps_total": 2556000, "timers": {"sample_time_ms": 22862.028, "sample_throughput": 174.963, "load_time_ms": 0.497, "load_throughput": 8053965.724, "learn_time_ms": 12248.573, "learn_throughput": 326.569, "update_time_ms": 2.235}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.42291614867256133, "policy_loss": -0.01873817562566249, "vf_loss": 43.96451804586636, "vf_explained_var": 0.0247628568321146, "kl": 0.008929566485190844, "entropy": 0.25582783341568005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2556000, "num_agent_steps_sampled": 2556000, "num_steps_trained": 2556000, "num_agent_steps_trained": 2556000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25720, "training_iteration": 639, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-29-00", "timestamp": 1643707740, "time_this_iter_s": 28.538789749145508, "time_total_s": 16767.042373895645, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4507.533496856689, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 38.614634146341466, "ram_util_percent": 60.38536585365853}}
{"episode_reward_max": -2.5000000000000004, "episode_reward_min": -79.79999999999998, "episode_reward_mean": -14.208000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -6.1, -21.800000000000004, -16.099999999999994, -2.5000000000000004, -22.299999999999997, -3.2, -5.4, -20.300000000000004, -12.799999999999999, -3.7, -17.1, -17.599999999999998, -6.1, -9.7, -10.1, -36.5, -12.099999999999998, -20.700000000000003, -3.4, -13.899999999999997, -3.4, -20.199999999999996, -22.4, -4.2, -12.3, -3.4, -25.699999999999996, -2.7000000000000006, -14.699999999999998, -5.1, -5.8, -7.2, -37.39999999999999, -14.399999999999999, -3.3, -12.599999999999998, -4.6000000000000005, -5.1000000000000005, -48.80000000000001, -13.399999999999999, -4.800000000000001, -19.3, -11.599999999999998, -28.7, -5.3, -3.3, -18.9, -19.099999999999998, -5.300000000000001, -18.3, -79.79999999999998, -10.799999999999999, -4.3, -26.8, -40.300000000000054, -7.099999999999998, -5.300000000000001, -3.2, -8.299999999999997, -20.6, -5.2, -26.699999999999996, -10.6, -4.3, -9.500000000000002, -25.500000000000007, -4.4, -3.4, -20.499999999999996, -3.4, -24.200000000000003, -14.099999999999973, -15.299999999999997, -24.9, -17.499999999999996, -3.3, -3.1, -14.5, -5.4, -13.799999999999999, -3.3, -10.799999999999999, -17.900000000000006, -4.2, -4.4, -19.8, -4.2, -30.700000000000003, -19.699999999999996, -20.599999999999998, -3.4, -5.4, -25.900000000000006, -24.200000000000006, -10.2, -11.700000000000001, -12.599999999999998, -35.29999999999998, -32.400000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0665944579403785, "mean_inference_ms": 1.4159101892450194, "mean_action_processing_ms": 0.07649921412167345, "mean_env_wait_ms": 6.437563546007152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2560000, "timesteps_this_iter": 0, "agent_timesteps_total": 2560000, "timers": {"sample_time_ms": 24414.832, "sample_throughput": 163.835, "load_time_ms": 0.525, "load_throughput": 7626007.273, "learn_time_ms": 12577.94, "learn_throughput": 318.017, "update_time_ms": 2.252}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.15487094274571828, "policy_loss": -0.018448308078191613, "vf_loss": 17.144092489827063, "vf_explained_var": 0.2606287896633148, "kl": 0.008348132441595801, "entropy": 0.2408982152539876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2560000, "num_agent_steps_sampled": 2560000, "num_steps_trained": 2560000, "num_agent_steps_trained": 2560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25760, "training_iteration": 640, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-29-31", "timestamp": 1643707771, "time_this_iter_s": 31.011073112487793, "time_total_s": 16798.053447008133, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4538.544569969177, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 45.95454545454545, "ram_util_percent": 60.99090909090907}}
{"episode_reward_max": -3.1, "episode_reward_min": -79.79999999999998, "episode_reward_mean": -13.988999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.399999999999999, -4.800000000000001, -19.3, -11.599999999999998, -28.7, -5.3, -3.3, -18.9, -19.099999999999998, -5.300000000000001, -18.3, -79.79999999999998, -10.799999999999999, -4.3, -26.8, -40.300000000000054, -7.099999999999998, -5.300000000000001, -3.2, -8.299999999999997, -20.6, -5.2, -26.699999999999996, -10.6, -4.3, -9.500000000000002, -25.500000000000007, -4.4, -3.4, -20.499999999999996, -3.4, -24.200000000000003, -14.099999999999973, -15.299999999999997, -24.9, -17.499999999999996, -3.3, -3.1, -14.5, -5.4, -13.799999999999999, -3.3, -10.799999999999999, -17.900000000000006, -4.2, -4.4, -19.8, -4.2, -30.700000000000003, -19.699999999999996, -20.599999999999998, -3.4, -5.4, -25.900000000000006, -24.200000000000006, -10.2, -11.700000000000001, -12.599999999999998, -35.29999999999998, -32.400000000000006, -4.2, -4.3, -13.399999999999999, -4.3, -23.000000000000004, -8.8, -9.3, -24.200000000000006, -16.1, -13.699999999999998, -4.3, -5.3, -42.3, -41.00000000000002, -3.3, -14.7, -5.300000000000001, -18.0, -10.7, -4.4, -10.899999999999999, -12.4, -8.6, -14.6, -3.3, -29.20000000000001, -13.199999999999998, -4.2, -11.199999999999976, -3.4, -5.2, -9.9, -12.0, -4.4, -27.000000000000007, -10.2, -13.0, -15.799999999999994, -7.299999999999999, -11.699999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0692568485585248, "mean_inference_ms": 1.4192229045880134, "mean_action_processing_ms": 0.07667735522331869, "mean_env_wait_ms": 6.454311106039938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2564000, "timesteps_this_iter": 0, "agent_timesteps_total": 2564000, "timers": {"sample_time_ms": 24996.633, "sample_throughput": 160.022, "load_time_ms": 0.509, "load_throughput": 7863705.648, "learn_time_ms": 12657.333, "learn_throughput": 316.022, "update_time_ms": 2.263}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.14307617860075125, "policy_loss": -0.02064960224614028, "vf_loss": 16.016533376196378, "vf_explained_var": 0.16943960119319218, "kl": 0.01582423033465006, "entropy": 0.24855329125959386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2564000, "num_agent_steps_sampled": 2564000, "num_steps_trained": 2564000, "num_agent_steps_trained": 2564000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25800, "training_iteration": 641, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-29-57", "timestamp": 1643707797, "time_this_iter_s": 26.29932403564453, "time_total_s": 16824.352771043777, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4564.843894004822, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 45.21081081081081, "ram_util_percent": 61.20270270270269}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.399999999999984, "episode_reward_mean": -14.095999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.799999999999999, -3.3, -10.799999999999999, -17.900000000000006, -4.2, -4.4, -19.8, -4.2, -30.700000000000003, -19.699999999999996, -20.599999999999998, -3.4, -5.4, -25.900000000000006, -24.200000000000006, -10.2, -11.700000000000001, -12.599999999999998, -35.29999999999998, -32.400000000000006, -4.2, -4.3, -13.399999999999999, -4.3, -23.000000000000004, -8.8, -9.3, -24.200000000000006, -16.1, -13.699999999999998, -4.3, -5.3, -42.3, -41.00000000000002, -3.3, -14.7, -5.300000000000001, -18.0, -10.7, -4.4, -10.899999999999999, -12.4, -8.6, -14.6, -3.3, -29.20000000000001, -13.199999999999998, -4.2, -11.199999999999976, -3.4, -5.2, -9.9, -12.0, -4.4, -27.000000000000007, -10.2, -13.0, -15.799999999999994, -7.299999999999999, -11.699999999999998, -5.2, -11.399999999999999, -27.2, -13.700000000000001, -15.5, -4.4, -4.300000000000001, -16.799999999999997, -4.2, -46.399999999999984, -25.000000000000007, -37.300000000000004, -15.399999999999997, -18.700000000000003, -18.4, -14.699999999999996, -4.2, -4.3, -13.399999999999997, -19.9, -11.999999999999998, -16.799999999999997, -12.399999999999997, -3.2, -11.9, -23.099999999999998, -10.599999999999998, -10.5, -15.4, -5.2, -32.0, -3.3, -15.8, -3.3, -14.0, -33.8, -23.7, -4.0, -16.099999999999998, -13.499999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0712154959816502, "mean_inference_ms": 1.4217026102948886, "mean_action_processing_ms": 0.07681223970155901, "mean_env_wait_ms": 6.466486391612273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2568000, "timesteps_this_iter": 0, "agent_timesteps_total": 2568000, "timers": {"sample_time_ms": 25071.004, "sample_throughput": 159.547, "load_time_ms": 0.509, "load_throughput": 7863705.648, "learn_time_ms": 12773.344, "learn_throughput": 313.152, "update_time_ms": 2.272}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.22428195687731908, "policy_loss": -0.015140576406772579, "vf_loss": 23.76095689650505, "vf_explained_var": 0.11736816597241227, "kl": 0.008057641440754552, "entropy": 0.26979464351810434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2568000, "num_agent_steps_sampled": 2568000, "num_steps_trained": 2568000, "num_agent_steps_trained": 2568000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25840, "training_iteration": 642, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-30-22", "timestamp": 1643707822, "time_this_iter_s": 24.537622928619385, "time_total_s": 16848.890393972397, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4589.381516933441, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 40.63142857142857, "ram_util_percent": 61.15142857142856}}
{"episode_reward_max": -2.5, "episode_reward_min": -126.2, "episode_reward_mean": -14.587000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.899999999999999, -12.4, -8.6, -14.6, -3.3, -29.20000000000001, -13.199999999999998, -4.2, -11.199999999999976, -3.4, -5.2, -9.9, -12.0, -4.4, -27.000000000000007, -10.2, -13.0, -15.799999999999994, -7.299999999999999, -11.699999999999998, -5.2, -11.399999999999999, -27.2, -13.700000000000001, -15.5, -4.4, -4.300000000000001, -16.799999999999997, -4.2, -46.399999999999984, -25.000000000000007, -37.300000000000004, -15.399999999999997, -18.700000000000003, -18.4, -14.699999999999996, -4.2, -4.3, -13.399999999999997, -19.9, -11.999999999999998, -16.799999999999997, -12.399999999999997, -3.2, -11.9, -23.099999999999998, -10.599999999999998, -10.5, -15.4, -5.2, -32.0, -3.3, -15.8, -3.3, -14.0, -33.8, -23.7, -4.0, -16.099999999999998, -13.499999999999996, -9.3, -21.3, -16.699999999999996, -17.900000000000006, -126.2, -16.299999999999997, -7.300000000000001, -28.800000000000004, -3.3, -11.099999999999998, -9.0, -5.1000000000000005, -21.9, -7.300000000000001, -7.9, -26.0, -3.3, -3.2, -8.5, -13.799999999999997, -38.39999999999997, -3.900000000000001, -3.6000000000000005, -17.900000000000006, -2.5, -6.2, -14.1, -5.4, -44.100000000000065, -6.199999999999999, -11.2, -4.4, -5.1000000000000005, -5.800000000000001, -18.699999999999996, -19.500000000000007, -6.4, -15.9, -25.900000000000006, -10.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0725127547768567, "mean_inference_ms": 1.423296747304046, "mean_action_processing_ms": 0.07689776140833589, "mean_env_wait_ms": 6.473859569498911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2572000, "timesteps_this_iter": 0, "agent_timesteps_total": 2572000, "timers": {"sample_time_ms": 25247.566, "sample_throughput": 158.431, "load_time_ms": 0.572, "load_throughput": 6991089.257, "learn_time_ms": 13006.719, "learn_throughput": 307.533, "update_time_ms": 2.323}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.8952583497680563, "policy_loss": -0.022045868792400884, "vf_loss": 91.48726091384887, "vf_explained_var": -0.1527558309416617, "kl": 0.010807268760361734, "entropy": 0.282241153164256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2572000, "num_agent_steps_sampled": 2572000, "num_steps_trained": 2572000, "num_agent_steps_trained": 2572000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25880, "training_iteration": 643, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-30-46", "timestamp": 1643707846, "time_this_iter_s": 24.55773687362671, "time_total_s": 16873.448130846024, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4613.939253807068, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 45.168571428571425, "ram_util_percent": 61.31428571428572}}
{"episode_reward_max": -2.5, "episode_reward_min": -126.2, "episode_reward_mean": -13.793000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.999999999999998, -16.799999999999997, -12.399999999999997, -3.2, -11.9, -23.099999999999998, -10.599999999999998, -10.5, -15.4, -5.2, -32.0, -3.3, -15.8, -3.3, -14.0, -33.8, -23.7, -4.0, -16.099999999999998, -13.499999999999996, -9.3, -21.3, -16.699999999999996, -17.900000000000006, -126.2, -16.299999999999997, -7.300000000000001, -28.800000000000004, -3.3, -11.099999999999998, -9.0, -5.1000000000000005, -21.9, -7.300000000000001, -7.9, -26.0, -3.3, -3.2, -8.5, -13.799999999999997, -38.39999999999997, -3.900000000000001, -3.6000000000000005, -17.900000000000006, -2.5, -6.2, -14.1, -5.4, -44.100000000000065, -6.199999999999999, -11.2, -4.4, -5.1000000000000005, -5.800000000000001, -18.699999999999996, -19.500000000000007, -6.4, -15.9, -25.900000000000006, -10.799999999999999, -30.400000000000002, -3.3, -23.000000000000004, -4.4, -12.799999999999992, -14.1, -4.2, -5.0, -42.4, -5.4, -11.100000000000001, -15.79999999999998, -4.4, -3.2, -4.800000000000001, -4.4, -9.999999999999998, -10.3, -4.3, -43.100000000000016, -8.599999999999998, -33.3, -4.4, -15.2, -16.9, -3.3, -12.200000000000001, -11.6, -4.3, -5.999999999999999, -4.300000000000001, -11.5, -21.2, -18.3, -10.100000000000001, -7.6000000000000005, -7.2, -6.799999999999999, -4.9, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.073800487096515, "mean_inference_ms": 1.4250134273595825, "mean_action_processing_ms": 0.07698994629259694, "mean_env_wait_ms": 6.481726804068457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2576000, "timesteps_this_iter": 0, "agent_timesteps_total": 2576000, "timers": {"sample_time_ms": 25794.972, "sample_throughput": 155.069, "load_time_ms": 0.573, "load_throughput": 6986140.329, "learn_time_ms": 13233.573, "learn_throughput": 302.262, "update_time_ms": 2.358}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.2177251716419774, "policy_loss": -0.025750524706898197, "vf_loss": 24.12367224744571, "vf_explained_var": -0.16159601076956717, "kl": 0.009951014177681346, "entropy": 0.28817989247780973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2576000, "num_agent_steps_sampled": 2576000, "num_steps_trained": 2576000, "num_agent_steps_trained": 2576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25920, "training_iteration": 644, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-31-14", "timestamp": 1643707874, "time_this_iter_s": 27.75647473335266, "time_total_s": 16901.204605579376, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4641.6957285404205, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 47.14, "ram_util_percent": 61.730000000000004}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -71.2, "episode_reward_mean": -13.102000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.39999999999997, -3.900000000000001, -3.6000000000000005, -17.900000000000006, -2.5, -6.2, -14.1, -5.4, -44.100000000000065, -6.199999999999999, -11.2, -4.4, -5.1000000000000005, -5.800000000000001, -18.699999999999996, -19.500000000000007, -6.4, -15.9, -25.900000000000006, -10.799999999999999, -30.400000000000002, -3.3, -23.000000000000004, -4.4, -12.799999999999992, -14.1, -4.2, -5.0, -42.4, -5.4, -11.100000000000001, -15.79999999999998, -4.4, -3.2, -4.800000000000001, -4.4, -9.999999999999998, -10.3, -4.3, -43.100000000000016, -8.599999999999998, -33.3, -4.4, -15.2, -16.9, -3.3, -12.200000000000001, -11.6, -4.3, -5.999999999999999, -4.300000000000001, -11.5, -21.2, -18.3, -10.100000000000001, -7.6000000000000005, -7.2, -6.799999999999999, -4.9, -4.4, -14.299999999999999, -11.3, -16.799999999999997, -14.899999999999999, -3.3, -14.099999999999996, -4.2, -4.300000000000001, -21.299999999999997, -10.200000000000001, -11.4, -28.7, -17.699999999999996, -17.599999999999998, -9.3, -7.800000000000001, -19.3, -3.2, -3.4, -4.3, -5.4, -28.1, -6.6000000000000005, -27.799999999999997, -22.6, -32.2, -8.599999999999998, -15.3, -17.5, -3.4, -4.3, -71.2, -25.900000000000002, -2.4000000000000004, -5.1, -5.4, -12.299999999999997, -4.2, -19.900000000000006, -20.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0755049171070228, "mean_inference_ms": 1.4275765698183478, "mean_action_processing_ms": 0.07712642684990963, "mean_env_wait_ms": 6.493724384449776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2580000, "timesteps_this_iter": 0, "agent_timesteps_total": 2580000, "timers": {"sample_time_ms": 26171.301, "sample_throughput": 152.839, "load_time_ms": 0.575, "load_throughput": 6952269.186, "learn_time_ms": 13188.314, "learn_throughput": 303.299, "update_time_ms": 2.306}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.32062463173742894, "policy_loss": -0.020471570456040002, "vf_loss": 33.91688538597476, "vf_explained_var": -0.07627564328973012, "kl": 0.008566021697497548, "entropy": 0.26520214470163467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2580000, "num_agent_steps_sampled": 2580000, "num_steps_trained": 2580000, "num_agent_steps_trained": 2580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 25960, "training_iteration": 645, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-31-43", "timestamp": 1643707903, "time_this_iter_s": 29.153090953826904, "time_total_s": 16930.357696533203, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4670.848819494247, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 48.00000000000001, "ram_util_percent": 62.390243902439025}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -71.2, "episode_reward_mean": -12.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.599999999999998, -33.3, -4.4, -15.2, -16.9, -3.3, -12.200000000000001, -11.6, -4.3, -5.999999999999999, -4.300000000000001, -11.5, -21.2, -18.3, -10.100000000000001, -7.6000000000000005, -7.2, -6.799999999999999, -4.9, -4.4, -14.299999999999999, -11.3, -16.799999999999997, -14.899999999999999, -3.3, -14.099999999999996, -4.2, -4.300000000000001, -21.299999999999997, -10.200000000000001, -11.4, -28.7, -17.699999999999996, -17.599999999999998, -9.3, -7.800000000000001, -19.3, -3.2, -3.4, -4.3, -5.4, -28.1, -6.6000000000000005, -27.799999999999997, -22.6, -32.2, -8.599999999999998, -15.3, -17.5, -3.4, -4.3, -71.2, -25.900000000000002, -2.4000000000000004, -5.1, -5.4, -12.299999999999997, -4.2, -19.900000000000006, -20.099999999999998, -8.5, -9.3, -6.3, -7.4, -3.7, -4.9, -3.4, -7.499999999999996, -3.3, -27.3, -3.4, -8.3, -5.0, -21.4, -5.300000000000001, -8.4, -41.3, -6.4, -23.700000000000003, -4.300000000000001, -25.6, -9.2, -3.3, -20.799999999999997, -23.699999999999996, -7.2, -27.2, -24.400000000000006, -24.900000000000006, -17.799999999999997, -10.7, -7.1, -10.1, -8.6, -16.699999999999996, -4.4, -14.999999999999996, -16.3, -4.700000000000001, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0771151835208892, "mean_inference_ms": 1.429938279228819, "mean_action_processing_ms": 0.0772516597872505, "mean_env_wait_ms": 6.50473387072708, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2584000, "timesteps_this_iter": 0, "agent_timesteps_total": 2584000, "timers": {"sample_time_ms": 26020.34, "sample_throughput": 153.726, "load_time_ms": 0.567, "load_throughput": 7052509.984, "learn_time_ms": 13142.779, "learn_throughput": 304.35, "update_time_ms": 2.288}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.14916749271534144, "policy_loss": -0.024112573251008025, "vf_loss": 17.11631496125652, "vf_explained_var": 0.0022606706747444727, "kl": 0.00940852813539594, "entropy": 0.27781777377090144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2584000, "num_agent_steps_sampled": 2584000, "num_steps_trained": 2584000, "num_agent_steps_trained": 2584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26000, "training_iteration": 646, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-32-05", "timestamp": 1643707925, "time_this_iter_s": 21.963361978530884, "time_total_s": 16952.321058511734, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4692.812181472778, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 36.41875, "ram_util_percent": 62.309375}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -91.69999999999997, "episode_reward_mean": -14.243999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -28.1, -6.6000000000000005, -27.799999999999997, -22.6, -32.2, -8.599999999999998, -15.3, -17.5, -3.4, -4.3, -71.2, -25.900000000000002, -2.4000000000000004, -5.1, -5.4, -12.299999999999997, -4.2, -19.900000000000006, -20.099999999999998, -8.5, -9.3, -6.3, -7.4, -3.7, -4.9, -3.4, -7.499999999999996, -3.3, -27.3, -3.4, -8.3, -5.0, -21.4, -5.300000000000001, -8.4, -41.3, -6.4, -23.700000000000003, -4.300000000000001, -25.6, -9.2, -3.3, -20.799999999999997, -23.699999999999996, -7.2, -27.2, -24.400000000000006, -24.900000000000006, -17.799999999999997, -10.7, -7.1, -10.1, -8.6, -16.699999999999996, -4.4, -14.999999999999996, -16.3, -4.700000000000001, -5.4, -27.2, -5.4, -4.3, -8.100000000000001, -3.4, -6.4, -10.999999999999998, -10.8, -26.700000000000003, -11.599999999999996, -4.3, -3.3, -8.899999999999993, -5.3, -3.2, -30.9, -26.3, -4.2, -9.9, -8.1, -23.69999999999997, -7.4, -3.3, -37.3, -11.299999999999997, -23.2, -4.300000000000001, -21.7, -18.9, -11.6, -16.2, -13.199999999999996, -91.69999999999997, -17.3, -18.1, -10.2, -5.2, -4.4, -4.3, -31.300000000000033], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0779945053151294, "mean_inference_ms": 1.4312031212132683, "mean_action_processing_ms": 0.07731832500541777, "mean_env_wait_ms": 6.510466488577221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2588000, "timesteps_this_iter": 0, "agent_timesteps_total": 2588000, "timers": {"sample_time_ms": 26002.944, "sample_throughput": 153.829, "load_time_ms": 0.569, "load_throughput": 7027400.519, "learn_time_ms": 12990.811, "learn_throughput": 307.91, "update_time_ms": 2.276}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.4467807800619192, "policy_loss": -0.015171062586809038, "vf_loss": 46.05243124112647, "vf_explained_var": 0.004987284573175574, "kl": 0.006344630165669186, "entropy": 0.24499123755001254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2588000, "num_agent_steps_sampled": 2588000, "num_steps_trained": 2588000, "num_agent_steps_trained": 2588000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26040, "training_iteration": 647, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-32-26", "timestamp": 1643707946, "time_this_iter_s": 20.308115005493164, "time_total_s": 16972.629173517227, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4713.1202964782715, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 30.910344827586197, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -91.69999999999997, "episode_reward_mean": -13.854, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.6, -9.2, -3.3, -20.799999999999997, -23.699999999999996, -7.2, -27.2, -24.400000000000006, -24.900000000000006, -17.799999999999997, -10.7, -7.1, -10.1, -8.6, -16.699999999999996, -4.4, -14.999999999999996, -16.3, -4.700000000000001, -5.4, -27.2, -5.4, -4.3, -8.100000000000001, -3.4, -6.4, -10.999999999999998, -10.8, -26.700000000000003, -11.599999999999996, -4.3, -3.3, -8.899999999999993, -5.3, -3.2, -30.9, -26.3, -4.2, -9.9, -8.1, -23.69999999999997, -7.4, -3.3, -37.3, -11.299999999999997, -23.2, -4.300000000000001, -21.7, -18.9, -11.6, -16.2, -13.199999999999996, -91.69999999999997, -17.3, -18.1, -10.2, -5.2, -4.4, -4.3, -31.300000000000033, -21.5, -14.2, -14.299999999999994, -4.3, -8.9, -10.2, -13.499999999999977, -7.700000000000001, -4.4, -11.599999999999998, -21.700000000000006, -15.099999999999998, -16.099999999999998, -9.999999999999998, -10.199999999999998, -53.09999999999997, -11.299999999999999, -4.3, -4.300000000000001, -3.3, -4.300000000000001, -23.500000000000004, -28.600000000000005, -3.3, -33.3, -8.399999999999999, -7.4, -10.299999999999997, -3.900000000000001, -10.4, -10.1, -3.2, -12.1, -8.2, -6.8, -20.5, -14.599999999999998, -21.5, -6.199999999999999, -11.800000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0782661609113497, "mean_inference_ms": 1.4316627127142032, "mean_action_processing_ms": 0.07734144535267062, "mean_env_wait_ms": 6.512236025594219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2592000, "timesteps_this_iter": 0, "agent_timesteps_total": 2592000, "timers": {"sample_time_ms": 25777.187, "sample_throughput": 155.176, "load_time_ms": 0.568, "load_throughput": 7036242.241, "learn_time_ms": 12739.179, "learn_throughput": 313.992, "update_time_ms": 2.256}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.22705825770484103, "policy_loss": -0.020320152819296847, "vf_loss": 24.529568072672813, "vf_explained_var": 0.015182300793227329, "kl": 0.009256599727242782, "entropy": 0.2745655093302009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2592000, "num_agent_steps_sampled": 2592000, "num_steps_trained": 2592000, "num_agent_steps_trained": 2592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26080, "training_iteration": 648, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-32-46", "timestamp": 1643707966, "time_this_iter_s": 20.704264879226685, "time_total_s": 16993.333438396454, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4733.824561357498, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 33.34827586206897, "ram_util_percent": 62.21724137931035}}
{"episode_reward_max": -3.2, "episode_reward_min": -91.69999999999997, "episode_reward_mean": -13.121000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.69999999999997, -7.4, -3.3, -37.3, -11.299999999999997, -23.2, -4.300000000000001, -21.7, -18.9, -11.6, -16.2, -13.199999999999996, -91.69999999999997, -17.3, -18.1, -10.2, -5.2, -4.4, -4.3, -31.300000000000033, -21.5, -14.2, -14.299999999999994, -4.3, -8.9, -10.2, -13.499999999999977, -7.700000000000001, -4.4, -11.599999999999998, -21.700000000000006, -15.099999999999998, -16.099999999999998, -9.999999999999998, -10.199999999999998, -53.09999999999997, -11.299999999999999, -4.3, -4.300000000000001, -3.3, -4.300000000000001, -23.500000000000004, -28.600000000000005, -3.3, -33.3, -8.399999999999999, -7.4, -10.299999999999997, -3.900000000000001, -10.4, -10.1, -3.2, -12.1, -8.2, -6.8, -20.5, -14.599999999999998, -21.5, -6.199999999999999, -11.800000000000002, -8.4, -5.4, -15.399999999999997, -4.3, -12.799999999999999, -8.2, -5.6000000000000005, -5.4, -4.4, -3.900000000000001, -6.3, -5.2, -14.7, -16.6, -10.9, -3.2, -14.399999999999999, -3.4, -4.4, -23.200000000000006, -4.2, -3.4, -7.2, -9.2, -4.2, -15.299999999999999, -10.2, -16.1, -6.300000000000001, -27.700000000000003, -3.2, -15.599999999999996, -4.300000000000001, -17.5, -9.2, -26.800000000000008, -6.2, -13.3, -27.400000000000002, -25.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0783855715690442, "mean_inference_ms": 1.431907506582418, "mean_action_processing_ms": 0.07735417195957908, "mean_env_wait_ms": 6.5130664046673665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2596000, "timesteps_this_iter": 0, "agent_timesteps_total": 2596000, "timers": {"sample_time_ms": 25070.325, "sample_throughput": 159.551, "load_time_ms": 0.573, "load_throughput": 6981198.402, "learn_time_ms": 12378.831, "learn_throughput": 323.132, "update_time_ms": 2.288}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.108822930339844, "policy_loss": -0.021832677607815112, "vf_loss": 12.85249426861604, "vf_explained_var": 0.17994724210872445, "kl": 0.009469636896048414, "entropy": 0.24797115361177793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2596000, "num_agent_steps_sampled": 2596000, "num_steps_trained": 2596000, "num_agent_steps_trained": 2596000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26120, "training_iteration": 649, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-33-07", "timestamp": 1643707987, "time_this_iter_s": 20.389101028442383, "time_total_s": 17013.722539424896, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4754.213662385941, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 26.92413793103448, "ram_util_percent": 62.231034482758616}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.59999999999991, "episode_reward_mean": -12.185, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -23.500000000000004, -28.600000000000005, -3.3, -33.3, -8.399999999999999, -7.4, -10.299999999999997, -3.900000000000001, -10.4, -10.1, -3.2, -12.1, -8.2, -6.8, -20.5, -14.599999999999998, -21.5, -6.199999999999999, -11.800000000000002, -8.4, -5.4, -15.399999999999997, -4.3, -12.799999999999999, -8.2, -5.6000000000000005, -5.4, -4.4, -3.900000000000001, -6.3, -5.2, -14.7, -16.6, -10.9, -3.2, -14.399999999999999, -3.4, -4.4, -23.200000000000006, -4.2, -3.4, -7.2, -9.2, -4.2, -15.299999999999999, -10.2, -16.1, -6.300000000000001, -27.700000000000003, -3.2, -15.599999999999996, -4.300000000000001, -17.5, -9.2, -26.800000000000008, -6.2, -13.3, -27.400000000000002, -25.700000000000003, -13.4, -7.3, -11.899999999999999, -30.599999999999998, -9.4, -29.90000000000005, -15.099999999999996, -14.499999999999998, -5.3, -18.1, -4.9, -5.599999999999996, -7.599999999999999, -4.3, -4.4, -20.199999999999996, -20.300000000000004, -3.4, -30.3, -3.3, -14.799999999999997, -4.4, -16.799999999999997, -11.500000000000002, -32.3, -6.3, -8.299999999999997, -27.800000000000004, -4.2, -21.799999999999997, -4.300000000000001, -15.999999999999993, -15.1, -4.2, -6.4, -13.799999999999999, -7.300000000000001, -18.1, -3.2, -44.59999999999991], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.078602810779128, "mean_inference_ms": 1.432098114003919, "mean_action_processing_ms": 0.07736465391605299, "mean_env_wait_ms": 6.513735386260285, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2600000, "timesteps_this_iter": 0, "agent_timesteps_total": 2600000, "timers": {"sample_time_ms": 23924.405, "sample_throughput": 167.193, "load_time_ms": 0.549, "load_throughput": 7291588.509, "learn_time_ms": 12118.74, "learn_throughput": 330.067, "update_time_ms": 2.378}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.18758812522395485, "policy_loss": -0.02643306313998877, "vf_loss": 21.166013336950734, "vf_explained_var": 0.1355520208676656, "kl": 0.010493592233448305, "entropy": 0.2614803945185036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2600000, "num_agent_steps_sampled": 2600000, "num_steps_trained": 2600000, "num_agent_steps_trained": 2600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26160, "training_iteration": 650, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-33-27", "timestamp": 1643708007, "time_this_iter_s": 20.558112144470215, "time_total_s": 17034.280651569366, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4774.771774530411, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 31.217241379310344, "ram_util_percent": 62.27241379310345}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.59999999999991, "episode_reward_mean": -13.238999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -3.4, -7.2, -9.2, -4.2, -15.299999999999999, -10.2, -16.1, -6.300000000000001, -27.700000000000003, -3.2, -15.599999999999996, -4.300000000000001, -17.5, -9.2, -26.800000000000008, -6.2, -13.3, -27.400000000000002, -25.700000000000003, -13.4, -7.3, -11.899999999999999, -30.599999999999998, -9.4, -29.90000000000005, -15.099999999999996, -14.499999999999998, -5.3, -18.1, -4.9, -5.599999999999996, -7.599999999999999, -4.3, -4.4, -20.199999999999996, -20.300000000000004, -3.4, -30.3, -3.3, -14.799999999999997, -4.4, -16.799999999999997, -11.500000000000002, -32.3, -6.3, -8.299999999999997, -27.800000000000004, -4.2, -21.799999999999997, -4.300000000000001, -15.999999999999993, -15.1, -4.2, -6.4, -13.799999999999999, -7.300000000000001, -18.1, -3.2, -44.59999999999991, -4.300000000000001, -3.3, -21.199999999999996, -13.999999999999998, -13.899999999999984, -4.2, -15.299999999999997, -20.1, -26.3, -12.899999999999999, -15.899999999999999, -8.3, -14.699999999999998, -11.599999999999994, -13.399999999999995, -15.099999999999998, -11.3, -24.4, -16.699999999999996, -4.4, -9.299999999999997, -25.799999999999997, -11.899999999999999, -18.699999999999996, -9.899999999999999, -30.10000000000001, -17.6, -3.7, -13.899999999999999, -19.4, -4.3, -16.999999999999996, -6.2, -4.3, -3.4, -5.2, -16.6, -3.2, -9.2, -28.89999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0787111278739636, "mean_inference_ms": 1.4322749637124446, "mean_action_processing_ms": 0.07737499957375452, "mean_env_wait_ms": 6.514450067185792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2604000, "timesteps_this_iter": 0, "agent_timesteps_total": 2604000, "timers": {"sample_time_ms": 23330.126, "sample_throughput": 171.452, "load_time_ms": 0.546, "load_throughput": 7325335.546, "learn_time_ms": 11845.022, "learn_throughput": 337.695, "update_time_ms": 2.354}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.0892071933235212, "policy_loss": -0.039423354831273835, "vf_loss": 12.687512052059173, "vf_explained_var": 0.13519971838561437, "kl": 0.007801916667445409, "entropy": 0.2611013360962432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2604000, "num_agent_steps_sampled": 2604000, "num_steps_trained": 2604000, "num_agent_steps_trained": 2604000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26200, "training_iteration": 651, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-33-48", "timestamp": 1643708028, "time_this_iter_s": 20.21381187438965, "time_total_s": 17054.494463443756, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4794.9855864048, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 31.093103448275862, "ram_util_percent": 62.20000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.59999999999991, "episode_reward_mean": -12.616999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.799999999999997, -4.4, -16.799999999999997, -11.500000000000002, -32.3, -6.3, -8.299999999999997, -27.800000000000004, -4.2, -21.799999999999997, -4.300000000000001, -15.999999999999993, -15.1, -4.2, -6.4, -13.799999999999999, -7.300000000000001, -18.1, -3.2, -44.59999999999991, -4.300000000000001, -3.3, -21.199999999999996, -13.999999999999998, -13.899999999999984, -4.2, -15.299999999999997, -20.1, -26.3, -12.899999999999999, -15.899999999999999, -8.3, -14.699999999999998, -11.599999999999994, -13.399999999999995, -15.099999999999998, -11.3, -24.4, -16.699999999999996, -4.4, -9.299999999999997, -25.799999999999997, -11.899999999999999, -18.699999999999996, -9.899999999999999, -30.10000000000001, -17.6, -3.7, -13.899999999999999, -19.4, -4.3, -16.999999999999996, -6.2, -4.3, -3.4, -5.2, -16.6, -3.2, -9.2, -28.89999999999996, -21.999999999999996, -15.899999999999997, -11.3, -6.300000000000001, -3.3, -4.4, -13.1, -3.5000000000000004, -3.3, -25.600000000000012, -28.7, -34.4, -13.399999999999999, -7.6000000000000005, -10.9, -18.599999999999998, -3.2, -5.3, -5.4, -3.4, -4.300000000000001, -5.3, -18.2, -5.3, -36.3, -18.099999999999998, -17.699999999999996, -10.3, -8.399999999999999, -4.4, -4.0, -8.499999999999998, -7.3, -3.4, -7.4, -4.4, -14.9, -15.5, -11.899999999999999, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0788473297537826, "mean_inference_ms": 1.4325085111561118, "mean_action_processing_ms": 0.07738844889281103, "mean_env_wait_ms": 6.515551374918245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2608000, "timesteps_this_iter": 0, "agent_timesteps_total": 2608000, "timers": {"sample_time_ms": 22853.572, "sample_throughput": 175.027, "load_time_ms": 0.543, "load_throughput": 7364241.945, "learn_time_ms": 11637.963, "learn_throughput": 343.703, "update_time_ms": 2.375}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.12180887426660265, "policy_loss": -0.02387401856161574, "vf_loss": 14.355862425604174, "vf_explained_var": 0.023294561204089913, "kl": 0.009441197514006034, "entropy": 0.24054195806384088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2608000, "num_agent_steps_sampled": 2608000, "num_steps_trained": 2608000, "num_agent_steps_trained": 2608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26240, "training_iteration": 652, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-34-08", "timestamp": 1643708048, "time_this_iter_s": 20.4523868560791, "time_total_s": 17074.946850299835, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4815.4379732608795, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 31.965517241379313, "ram_util_percent": 62.20000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -36.3, "episode_reward_mean": -12.084000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.299999999999997, -25.799999999999997, -11.899999999999999, -18.699999999999996, -9.899999999999999, -30.10000000000001, -17.6, -3.7, -13.899999999999999, -19.4, -4.3, -16.999999999999996, -6.2, -4.3, -3.4, -5.2, -16.6, -3.2, -9.2, -28.89999999999996, -21.999999999999996, -15.899999999999997, -11.3, -6.300000000000001, -3.3, -4.4, -13.1, -3.5000000000000004, -3.3, -25.600000000000012, -28.7, -34.4, -13.399999999999999, -7.6000000000000005, -10.9, -18.599999999999998, -3.2, -5.3, -5.4, -3.4, -4.300000000000001, -5.3, -18.2, -5.3, -36.3, -18.099999999999998, -17.699999999999996, -10.3, -8.399999999999999, -4.4, -4.0, -8.499999999999998, -7.3, -3.4, -7.4, -4.4, -14.9, -15.5, -11.899999999999999, -5.4, -13.899999999999999, -8.3, -17.199999999999992, -3.3, -10.9, -21.200000000000006, -7.2, -8.4, -22.1, -20.599999999999998, -13.2, -20.2, -12.2, -15.999999999999998, -11.2, -17.300000000000004, -5.4, -21.4, -14.2, -22.7, -4.3, -9.600000000000001, -4.4, -3.3, -11.2, -6.4, -3.4, -4.2, -6.3, -10.5, -19.700000000000003, -10.2, -17.900000000000002, -18.700000000000003, -3.3, -33.900000000000006, -21.4, -5.4, -7.4, -10.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.079141199062988, "mean_inference_ms": 1.4328480447039158, "mean_action_processing_ms": 0.07740827467547057, "mean_env_wait_ms": 6.517084426492765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2612000, "timesteps_this_iter": 0, "agent_timesteps_total": 2612000, "timers": {"sample_time_ms": 22523.566, "sample_throughput": 177.592, "load_time_ms": 0.48, "load_throughput": 8337333.4, "learn_time_ms": 11415.752, "learn_throughput": 350.393, "update_time_ms": 2.369}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.08671915414092202, "policy_loss": -0.02183589071075442, "vf_loss": 10.690535021020521, "vf_explained_var": 0.25631344606799467, "kl": 0.007331991108328862, "entropy": 0.25357881604984245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2612000, "num_agent_steps_sampled": 2612000, "num_steps_trained": 2612000, "num_agent_steps_trained": 2612000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26280, "training_iteration": 653, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-34-29", "timestamp": 1643708069, "time_this_iter_s": 21.105945825576782, "time_total_s": 17096.052796125412, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4836.543919086456, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 34.47096774193548, "ram_util_percent": 62.22258064516129}}
{"episode_reward_max": -3.1, "episode_reward_min": -74.79999999999998, "episode_reward_mean": -11.777000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -5.3, -18.2, -5.3, -36.3, -18.099999999999998, -17.699999999999996, -10.3, -8.399999999999999, -4.4, -4.0, -8.499999999999998, -7.3, -3.4, -7.4, -4.4, -14.9, -15.5, -11.899999999999999, -5.4, -13.899999999999999, -8.3, -17.199999999999992, -3.3, -10.9, -21.200000000000006, -7.2, -8.4, -22.1, -20.599999999999998, -13.2, -20.2, -12.2, -15.999999999999998, -11.2, -17.300000000000004, -5.4, -21.4, -14.2, -22.7, -4.3, -9.600000000000001, -4.4, -3.3, -11.2, -6.4, -3.4, -4.2, -6.3, -10.5, -19.700000000000003, -10.2, -17.900000000000002, -18.700000000000003, -3.3, -33.900000000000006, -21.4, -5.4, -7.4, -10.8, -3.3, -3.4, -4.300000000000001, -9.799999999999999, -3.4, -13.7, -3.2, -4.4, -15.2, -9.2, -11.200000000000001, -3.3, -4.2, -13.999999999999998, -15.899999999999999, -3.4, -10.2, -5.3, -19.500000000000004, -3.3, -25.200000000000014, -3.4, -6.2, -17.6, -12.399999999999993, -3.3, -18.000000000000007, -13.699999999999998, -19.099999999999998, -29.20000000000001, -3.1, -3.3, -74.79999999999998, -3.4, -24.50000000000001, -8.999999999999996, -19.7, -9.899999999999999, -3.3, -8.200000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0796301444577665, "mean_inference_ms": 1.4332123509865007, "mean_action_processing_ms": 0.0774296208421275, "mean_env_wait_ms": 6.518774749206391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2616000, "timesteps_this_iter": 0, "agent_timesteps_total": 2616000, "timers": {"sample_time_ms": 22007.62, "sample_throughput": 181.755, "load_time_ms": 0.475, "load_throughput": 8425257.872, "learn_time_ms": 11008.766, "learn_throughput": 363.347, "update_time_ms": 2.431}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.26618979989641134, "policy_loss": -0.02127540811535812, "vf_loss": 28.55443123694389, "vf_explained_var": 0.06843030048954872, "kl": 0.0085373537761495, "entropy": 0.18583089956032334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2616000, "num_agent_steps_sampled": 2616000, "num_steps_trained": 2616000, "num_agent_steps_trained": 2616000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26320, "training_iteration": 654, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-34-50", "timestamp": 1643708090, "time_this_iter_s": 20.75360417366028, "time_total_s": 17116.806400299072, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4857.297523260117, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 30.28620689655172, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -2.3, "episode_reward_min": -74.79999999999998, "episode_reward_mean": -12.085999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -9.600000000000001, -4.4, -3.3, -11.2, -6.4, -3.4, -4.2, -6.3, -10.5, -19.700000000000003, -10.2, -17.900000000000002, -18.700000000000003, -3.3, -33.900000000000006, -21.4, -5.4, -7.4, -10.8, -3.3, -3.4, -4.300000000000001, -9.799999999999999, -3.4, -13.7, -3.2, -4.4, -15.2, -9.2, -11.200000000000001, -3.3, -4.2, -13.999999999999998, -15.899999999999999, -3.4, -10.2, -5.3, -19.500000000000004, -3.3, -25.200000000000014, -3.4, -6.2, -17.6, -12.399999999999993, -3.3, -18.000000000000007, -13.699999999999998, -19.099999999999998, -29.20000000000001, -3.1, -3.3, -74.79999999999998, -3.4, -24.50000000000001, -8.999999999999996, -19.7, -9.899999999999999, -3.3, -8.200000000000001, -5.1000000000000005, -5.4, -22.200000000000003, -15.399999999999999, -9.499999999999998, -4.4, -30.3, -24.700000000000006, -7.3999999999999995, -14.3, -30.799999999999997, -8.299999999999999, -14.4, -19.500000000000004, -7.6000000000000005, -43.3, -5.9, -7.2, -4.3, -13.0, -4.300000000000001, -3.4, -13.399999999999999, -11.3, -4.300000000000001, -31.70000000000001, -4.4, -5.1, -8.4, -37.09999999999996, -2.3, -11.2, -19.4, -15.699999999999998, -6.3999999999999995, -17.3, -12.799999999999999, -13.799999999999999, -8.299999999999999, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.080026567642887, "mean_inference_ms": 1.4335207206986513, "mean_action_processing_ms": 0.0774460138700243, "mean_env_wait_ms": 6.52012648860401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2620000, "timesteps_this_iter": 0, "agent_timesteps_total": 2620000, "timers": {"sample_time_ms": 21068.565, "sample_throughput": 189.856, "load_time_ms": 0.469, "load_throughput": 8529775.789, "learn_time_ms": 10643.943, "learn_throughput": 375.801, "update_time_ms": 2.421}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.18769119910154772, "policy_loss": -0.02674298007041216, "vf_loss": 21.2034638556101, "vf_explained_var": 0.007923842501896684, "kl": 0.010664645229291812, "entropy": 0.2740239632546261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2620000, "num_agent_steps_sampled": 2620000, "num_steps_trained": 2620000, "num_agent_steps_trained": 2620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26360, "training_iteration": 655, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-35-10", "timestamp": 1643708110, "time_this_iter_s": 20.202006101608276, "time_total_s": 17137.00840640068, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4877.499529361725, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 30.53793103448276, "ram_util_percent": 62.20344827586208}}
{"episode_reward_max": -2.3, "episode_reward_min": -74.79999999999998, "episode_reward_mean": -12.611, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.200000000000014, -3.4, -6.2, -17.6, -12.399999999999993, -3.3, -18.000000000000007, -13.699999999999998, -19.099999999999998, -29.20000000000001, -3.1, -3.3, -74.79999999999998, -3.4, -24.50000000000001, -8.999999999999996, -19.7, -9.899999999999999, -3.3, -8.200000000000001, -5.1000000000000005, -5.4, -22.200000000000003, -15.399999999999999, -9.499999999999998, -4.4, -30.3, -24.700000000000006, -7.3999999999999995, -14.3, -30.799999999999997, -8.299999999999999, -14.4, -19.500000000000004, -7.6000000000000005, -43.3, -5.9, -7.2, -4.3, -13.0, -4.300000000000001, -3.4, -13.399999999999999, -11.3, -4.300000000000001, -31.70000000000001, -4.4, -5.1, -8.4, -37.09999999999996, -2.3, -11.2, -19.4, -15.699999999999998, -6.3999999999999995, -17.3, -12.799999999999999, -13.799999999999999, -8.299999999999999, -5.2, -15.3, -11.3, -11.7, -16.29999999999999, -13.899999999999999, -6.0, -5.699999999999999, -3.7000000000000006, -5.3, -14.799999999999974, -13.3, -9.8, -9.899999999999999, -4.1, -4.4, -11.2, -6.6, -5.2, -9.600000000000001, -15.399999999999995, -6.300000000000001, -10.2, -23.6, -16.099999999999998, -3.3, -10.9, -14.199999999999983, -15.599999999999996, -4.4, -17.9, -13.899999999999999, -10.699999999999998, -5.1000000000000005, -19.8, -17.400000000000002, -18.800000000000004, -3.3, -13.399999999999999, -3.3, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0803323820751305, "mean_inference_ms": 1.4337750035931784, "mean_action_processing_ms": 0.07745963847487382, "mean_env_wait_ms": 6.521154062101714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2624000, "timesteps_this_iter": 0, "agent_timesteps_total": 2624000, "timers": {"sample_time_ms": 20562.201, "sample_throughput": 194.532, "load_time_ms": 0.472, "load_throughput": 8475481.687, "learn_time_ms": 10678.057, "learn_throughput": 374.6, "update_time_ms": 2.426}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.07048265727947876, "policy_loss": -0.021005592273388017, "vf_loss": 8.894810835007698, "vf_explained_var": 0.1870422406863141, "kl": 0.011289520482099994, "entropy": 0.273491789112168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2624000, "num_agent_steps_sampled": 2624000, "num_steps_trained": 2624000, "num_agent_steps_trained": 2624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26400, "training_iteration": 656, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-35-31", "timestamp": 1643708131, "time_this_iter_s": 20.89552617073059, "time_total_s": 17157.90393257141, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4898.395055532455, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 32.60333333333333, "ram_util_percent": 62.28333333333333}}
{"episode_reward_max": -2.3, "episode_reward_min": -37.09999999999996, "episode_reward_mean": -11.841, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -3.4, -13.399999999999999, -11.3, -4.300000000000001, -31.70000000000001, -4.4, -5.1, -8.4, -37.09999999999996, -2.3, -11.2, -19.4, -15.699999999999998, -6.3999999999999995, -17.3, -12.799999999999999, -13.799999999999999, -8.299999999999999, -5.2, -15.3, -11.3, -11.7, -16.29999999999999, -13.899999999999999, -6.0, -5.699999999999999, -3.7000000000000006, -5.3, -14.799999999999974, -13.3, -9.8, -9.899999999999999, -4.1, -4.4, -11.2, -6.6, -5.2, -9.600000000000001, -15.399999999999995, -6.300000000000001, -10.2, -23.6, -16.099999999999998, -3.3, -10.9, -14.199999999999983, -15.599999999999996, -4.4, -17.9, -13.899999999999999, -10.699999999999998, -5.1000000000000005, -19.8, -17.400000000000002, -18.800000000000004, -3.3, -13.399999999999999, -3.3, -3.3, -14.899999999999995, -6.299999999999999, -20.10000000000001, -17.1, -4.2, -18.600000000000005, -6.2, -9.2, -13.5, -30.3, -14.2, -10.3, -6.1, -20.0, -16.3, -13.0, -18.900000000000013, -8.3, -11.3, -16.3, -6.5, -13.899999999999999, -12.5, -12.899999999999997, -15.999999999999975, -5.3, -10.4, -20.199999999999996, -8.600000000000001, -18.20000000000001, -8.3, -21.1, -3.3, -7.1, -10.3, -13.2, -10.2, -22.899999999999995, -12.5, -14.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0803911560034605, "mean_inference_ms": 1.4340038118853646, "mean_action_processing_ms": 0.07747190379193675, "mean_env_wait_ms": 6.522130348493841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2628000, "timesteps_this_iter": 0, "agent_timesteps_total": 2628000, "timers": {"sample_time_ms": 20593.292, "sample_throughput": 194.238, "load_time_ms": 0.472, "load_throughput": 8466499.798, "learn_time_ms": 10688.631, "learn_throughput": 374.229, "update_time_ms": 2.327}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.09572471718313874, "policy_loss": -0.02013139089729677, "vf_loss": 11.323125117824924, "vf_explained_var": 0.13046122962428677, "kl": 0.01166604341319708, "entropy": 0.28929217384066636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2628000, "num_agent_steps_sampled": 2628000, "num_steps_trained": 2628000, "num_agent_steps_trained": 2628000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26440, "training_iteration": 657, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-35-52", "timestamp": 1643708152, "time_this_iter_s": 20.386717081069946, "time_total_s": 17178.29064965248, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4918.781772613525, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 34.63103448275862, "ram_util_percent": 62.23793103448277}}
{"episode_reward_max": -3.3, "episode_reward_min": -36.2, "episode_reward_mean": -12.380999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -10.2, -23.6, -16.099999999999998, -3.3, -10.9, -14.199999999999983, -15.599999999999996, -4.4, -17.9, -13.899999999999999, -10.699999999999998, -5.1000000000000005, -19.8, -17.400000000000002, -18.800000000000004, -3.3, -13.399999999999999, -3.3, -3.3, -14.899999999999995, -6.299999999999999, -20.10000000000001, -17.1, -4.2, -18.600000000000005, -6.2, -9.2, -13.5, -30.3, -14.2, -10.3, -6.1, -20.0, -16.3, -13.0, -18.900000000000013, -8.3, -11.3, -16.3, -6.5, -13.899999999999999, -12.5, -12.899999999999997, -15.999999999999975, -5.3, -10.4, -20.199999999999996, -8.600000000000001, -18.20000000000001, -8.3, -21.1, -3.3, -7.1, -10.3, -13.2, -10.2, -22.899999999999995, -12.5, -14.799999999999997, -12.4, -16.7, -10.2, -8.4, -3.3, -11.4, -14.3, -8.3, -10.3, -5.3, -10.2, -9.4, -10.0, -20.9, -13.2, -8.6, -12.0, -17.700000000000003, -5.2, -30.099999999999962, -9.7, -16.9, -11.2, -36.2, -11.100000000000001, -7.2, -19.900000000000006, -10.2, -8.3, -15.3, -8.799999999999999, -12.799999999999999, -4.7, -5.2, -13.999999999999996, -14.099999999999998, -14.3, -11.4, -4.3, -9.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0804544565826033, "mean_inference_ms": 1.4342822263850479, "mean_action_processing_ms": 0.07748806959201068, "mean_env_wait_ms": 6.523451611982066, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2632000, "timesteps_this_iter": 0, "agent_timesteps_total": 2632000, "timers": {"sample_time_ms": 20629.753, "sample_throughput": 193.895, "load_time_ms": 0.515, "load_throughput": 7772267.21, "learn_time_ms": 10683.094, "learn_throughput": 374.423, "update_time_ms": 2.286}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.09183431941094577, "policy_loss": -0.014792543032797433, "vf_loss": 10.372018545289194, "vf_explained_var": 0.19491063458945163, "kl": 0.01291857895790833, "entropy": 0.257940600235616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2632000, "num_agent_steps_sampled": 2632000, "num_steps_trained": 2632000, "num_agent_steps_trained": 2632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26480, "training_iteration": 658, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-36-13", "timestamp": 1643708173, "time_this_iter_s": 20.905550003051758, "time_total_s": 17199.196199655533, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4939.687322616577, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 34.46333333333334, "ram_util_percent": 62.239999999999995}}
{"episode_reward_max": -1.3, "episode_reward_min": -36.2, "episode_reward_mean": -12.032000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.5, -13.899999999999999, -12.5, -12.899999999999997, -15.999999999999975, -5.3, -10.4, -20.199999999999996, -8.600000000000001, -18.20000000000001, -8.3, -21.1, -3.3, -7.1, -10.3, -13.2, -10.2, -22.899999999999995, -12.5, -14.799999999999997, -12.4, -16.7, -10.2, -8.4, -3.3, -11.4, -14.3, -8.3, -10.3, -5.3, -10.2, -9.4, -10.0, -20.9, -13.2, -8.6, -12.0, -17.700000000000003, -5.2, -30.099999999999962, -9.7, -16.9, -11.2, -36.2, -11.100000000000001, -7.2, -19.900000000000006, -10.2, -8.3, -15.3, -8.799999999999999, -12.799999999999999, -4.7, -5.2, -13.999999999999996, -14.099999999999998, -14.3, -11.4, -4.3, -9.799999999999997, -7.0, -19.4, -21.7, -4.300000000000001, -3.4, -26.7, -10.4, -11.2, -11.699999999999998, -6.3, -1.3, -9.399999999999999, -6.3, -9.100000000000001, -4.4, -11.799999999999999, -8.2, -8.600000000000001, -12.4, -4.800000000000001, -18.6, -7.3, -10.4, -21.400000000000006, -30.600000000000062, -14.799999999999999, -28.1, -6.3, -5.4, -10.1, -19.4, -9.7, -8.3, -2.4000000000000004, -8.799999999999999, -15.099999999999998, -21.200000000000003, -12.4, -7.0, -16.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0806451164126696, "mean_inference_ms": 1.4345496479048774, "mean_action_processing_ms": 0.07750231874634872, "mean_env_wait_ms": 6.52456506524593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2636000, "timesteps_this_iter": 0, "agent_timesteps_total": 2636000, "timers": {"sample_time_ms": 20633.129, "sample_throughput": 193.863, "load_time_ms": 0.504, "load_throughput": 7932114.794, "learn_time_ms": 10665.662, "learn_throughput": 375.035, "update_time_ms": 2.222}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.11575875790734645, "policy_loss": -0.011606553174875757, "vf_loss": 12.51071702331625, "vf_explained_var": 0.2575040353241787, "kl": 0.010036185029133934, "entropy": 0.24917854187629557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2636000, "num_agent_steps_sampled": 2636000, "num_steps_trained": 2636000, "num_agent_steps_trained": 2636000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26520, "training_iteration": 659, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-36-33", "timestamp": 1643708193, "time_this_iter_s": 20.304476022720337, "time_total_s": 17219.500675678253, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4959.9917986392975, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 29.875862068965517, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -1.3, "episode_reward_min": -87.3, "episode_reward_mean": -12.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.7, -16.9, -11.2, -36.2, -11.100000000000001, -7.2, -19.900000000000006, -10.2, -8.3, -15.3, -8.799999999999999, -12.799999999999999, -4.7, -5.2, -13.999999999999996, -14.099999999999998, -14.3, -11.4, -4.3, -9.799999999999997, -7.0, -19.4, -21.7, -4.300000000000001, -3.4, -26.7, -10.4, -11.2, -11.699999999999998, -6.3, -1.3, -9.399999999999999, -6.3, -9.100000000000001, -4.4, -11.799999999999999, -8.2, -8.600000000000001, -12.4, -4.800000000000001, -18.6, -7.3, -10.4, -21.400000000000006, -30.600000000000062, -14.799999999999999, -28.1, -6.3, -5.4, -10.1, -19.4, -9.7, -8.3, -2.4000000000000004, -8.799999999999999, -15.099999999999998, -21.200000000000003, -12.4, -7.0, -16.0, -11.3, -6.3, -8.4, -5.300000000000001, -7.3, -10.299999999999999, -7.4, -4.3, -87.3, -69.89999999999992, -9.4, -25.6, -9.5, -17.4, -23.2, -4.2, -2.5, -20.099999999999998, -6.0, -32.09999999999997, -6.3, -27.100000000000005, -3.7000000000000006, -7.3, -4.3, -7.4, -6.300000000000001, -10.899999999999999, -13.3, -10.7, -4.1, -11.8, -17.500000000000004, -12.099999999999998, -10.199999999999998, -10.7, -4.3, -13.699999999999998, -7.2, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0807754868663688, "mean_inference_ms": 1.4348125164340702, "mean_action_processing_ms": 0.07751705303862362, "mean_env_wait_ms": 6.525821433093081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2640000, "timesteps_this_iter": 0, "agent_timesteps_total": 2640000, "timers": {"sample_time_ms": 20646.763, "sample_throughput": 193.735, "load_time_ms": 0.504, "load_throughput": 7936617.626, "learn_time_ms": 10597.744, "learn_throughput": 377.439, "update_time_ms": 2.106}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.476018036931618, "policy_loss": -0.02298664765893131, "vf_loss": 49.63377334584472, "vf_explained_var": -0.0322768356210442, "kl": 0.011853212134348319, "entropy": 0.2786981714348639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2640000, "num_agent_steps_sampled": 2640000, "num_steps_trained": 2640000, "num_agent_steps_trained": 2640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26560, "training_iteration": 660, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-36-53", "timestamp": 1643708213, "time_this_iter_s": 20.188767910003662, "time_total_s": 17239.689443588257, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4980.180566549301, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 27.149999999999995, "ram_util_percent": 62.29999999999999}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -87.3, "episode_reward_mean": -12.966999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.6, -7.3, -10.4, -21.400000000000006, -30.600000000000062, -14.799999999999999, -28.1, -6.3, -5.4, -10.1, -19.4, -9.7, -8.3, -2.4000000000000004, -8.799999999999999, -15.099999999999998, -21.200000000000003, -12.4, -7.0, -16.0, -11.3, -6.3, -8.4, -5.300000000000001, -7.3, -10.299999999999999, -7.4, -4.3, -87.3, -69.89999999999992, -9.4, -25.6, -9.5, -17.4, -23.2, -4.2, -2.5, -20.099999999999998, -6.0, -32.09999999999997, -6.3, -27.100000000000005, -3.7000000000000006, -7.3, -4.3, -7.4, -6.300000000000001, -10.899999999999999, -13.3, -10.7, -4.1, -11.8, -17.500000000000004, -12.099999999999998, -10.199999999999998, -10.7, -4.3, -13.699999999999998, -7.2, -6.2, -14.2, -8.799999999999999, -11.3, -7.099999999999999, -10.0, -17.7, -13.799999999999999, -3.4, -17.2, -11.499999999999998, -10.2, -8.8, -3.3, -12.7, -20.0, -5.300000000000001, -9.299999999999999, -11.4, -23.800000000000004, -8.200000000000001, -5.4, -17.999999999999996, -3.3, -31.2, -21.3, -9.700000000000001, -6.3, -15.299999999999999, -5.3, -4.4, -4.4, -21.200000000000003, -4.4, -9.200000000000001, -3.5, -14.899999999999999, -24.3, -11.999999999999996, -6.3, -12.099999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.08092829441597, "mean_inference_ms": 1.4350363078647228, "mean_action_processing_ms": 0.07753004128748145, "mean_env_wait_ms": 6.526888184081231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2644000, "timesteps_this_iter": 0, "agent_timesteps_total": 2644000, "timers": {"sample_time_ms": 20592.178, "sample_throughput": 194.249, "load_time_ms": 0.502, "load_throughput": 7974340.986, "learn_time_ms": 10588.135, "learn_throughput": 377.781, "update_time_ms": 2.068}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.10232325464547161, "policy_loss": -0.008684739735858735, "vf_loss": 10.85688738252527, "vf_explained_var": 0.11728148409115371, "kl": 0.01084054151637902, "entropy": 0.2670224324429548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2644000, "num_agent_steps_sampled": 2644000, "num_steps_trained": 2644000, "num_agent_steps_trained": 2644000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26600, "training_iteration": 661, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-37-13", "timestamp": 1643708233, "time_this_iter_s": 20.25858497619629, "time_total_s": 17259.948028564453, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5000.439151525497, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 27.78965517241379, "ram_util_percent": 62.310344827586206}}
{"episode_reward_max": -3.2, "episode_reward_min": -167.70000000000024, "episode_reward_mean": -11.809000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.3, -27.100000000000005, -3.7000000000000006, -7.3, -4.3, -7.4, -6.300000000000001, -10.899999999999999, -13.3, -10.7, -4.1, -11.8, -17.500000000000004, -12.099999999999998, -10.199999999999998, -10.7, -4.3, -13.699999999999998, -7.2, -6.2, -14.2, -8.799999999999999, -11.3, -7.099999999999999, -10.0, -17.7, -13.799999999999999, -3.4, -17.2, -11.499999999999998, -10.2, -8.8, -3.3, -12.7, -20.0, -5.300000000000001, -9.299999999999999, -11.4, -23.800000000000004, -8.200000000000001, -5.4, -17.999999999999996, -3.3, -31.2, -21.3, -9.700000000000001, -6.3, -15.299999999999999, -5.3, -4.4, -4.4, -21.200000000000003, -4.4, -9.200000000000001, -3.5, -14.899999999999999, -24.3, -11.999999999999996, -6.3, -12.099999999999996, -12.8, -10.8, -9.4, -12.799999999999999, -10.199999999999996, -4.4, -15.5, -3.3, -5.4, -13.499999999999998, -6.0, -5.3, -11.099999999999996, -3.3, -167.70000000000024, -5.3, -4.4, -11.6, -3.2, -18.1, -13.399999999999995, -11.2, -10.69999999999999, -3.7000000000000006, -3.8000000000000003, -7.4, -7.300000000000001, -19.799999999999997, -10.5, -7.5, -3.4, -6.3, -23.599999999999994, -5.199999999999999, -13.299999999999995, -15.3, -4.300000000000001, -5.999999999999999, -8.2, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0811507986691884, "mean_inference_ms": 1.435258767439798, "mean_action_processing_ms": 0.0775425674861662, "mean_env_wait_ms": 6.528055779823255, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2648000, "timesteps_this_iter": 0, "agent_timesteps_total": 2648000, "timers": {"sample_time_ms": 20586.087, "sample_throughput": 194.306, "load_time_ms": 0.502, "load_throughput": 7972825.168, "learn_time_ms": 10626.461, "learn_throughput": 376.419, "update_time_ms": 2.001}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.00010000000000000003, "total_loss": 1.1742846824052262, "policy_loss": -0.019141026347955708, "vf_loss": 119.23219232559204, "vf_explained_var": -0.007358483537550895, "kl": 0.004905775117220106, "entropy": 0.2305372735825918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2648000, "num_agent_steps_sampled": 2648000, "num_steps_trained": 2648000, "num_agent_steps_trained": 2648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26640, "training_iteration": 662, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-37-34", "timestamp": 1643708254, "time_this_iter_s": 20.875938177108765, "time_total_s": 17280.823966741562, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5021.315089702606, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 31.303333333333338, "ram_util_percent": 62.38999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -167.70000000000024, "episode_reward_mean": -12.559999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -17.999999999999996, -3.3, -31.2, -21.3, -9.700000000000001, -6.3, -15.299999999999999, -5.3, -4.4, -4.4, -21.200000000000003, -4.4, -9.200000000000001, -3.5, -14.899999999999999, -24.3, -11.999999999999996, -6.3, -12.099999999999996, -12.8, -10.8, -9.4, -12.799999999999999, -10.199999999999996, -4.4, -15.5, -3.3, -5.4, -13.499999999999998, -6.0, -5.3, -11.099999999999996, -3.3, -167.70000000000024, -5.3, -4.4, -11.6, -3.2, -18.1, -13.399999999999995, -11.2, -10.69999999999999, -3.7000000000000006, -3.8000000000000003, -7.4, -7.300000000000001, -19.799999999999997, -10.5, -7.5, -3.4, -6.3, -23.599999999999994, -5.199999999999999, -13.299999999999995, -15.3, -4.300000000000001, -5.999999999999999, -8.2, -10.3, -4.300000000000001, -29.3, -15.799999999999997, -5.2, -36.599999999999994, -41.59999999999994, -9.6, -6.2, -10.399999999999999, -6.3, -12.8, -4.2, -18.0, -5.000000000000001, -6.4, -22.5, -8.099999999999998, -4.3, -7.4, -15.999999999999996, -7.999999999999998, -4.4, -6.699999999999999, -19.5, -22.6, -7.300000000000001, -24.3, -3.4, -3.4, -3.2, -7.6000000000000005, -18.700000000000003, -23.1, -8.899999999999999, -14.399999999999999, -4.2, -4.3, -11.799999999999999, -21.3, -11.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0811716603451902, "mean_inference_ms": 1.4353273471987245, "mean_action_processing_ms": 0.07754702134900052, "mean_env_wait_ms": 6.528525493744893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2652000, "timesteps_this_iter": 0, "agent_timesteps_total": 2652000, "timers": {"sample_time_ms": 20535.387, "sample_throughput": 194.786, "load_time_ms": 0.491, "load_throughput": 8141513.078, "learn_time_ms": 10272.359, "learn_throughput": 389.394, "update_time_ms": 1.954}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.13909541247512705, "policy_loss": -0.023370631708092587, "vf_loss": 16.10923683399795, "vf_explained_var": 0.16884538845349384, "kl": 0.012210487165318896, "entropy": 0.24118416407896626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2652000, "num_agent_steps_sampled": 2652000, "num_steps_trained": 2652000, "num_agent_steps_trained": 2652000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26680, "training_iteration": 663, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-37-51", "timestamp": 1643708271, "time_this_iter_s": 16.676434993743896, "time_total_s": 17297.500401735306, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5037.99152469635, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 37.6875, "ram_util_percent": 62.833333333333336}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.59999999999994, "episode_reward_mean": -11.320999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.399999999999995, -11.2, -10.69999999999999, -3.7000000000000006, -3.8000000000000003, -7.4, -7.300000000000001, -19.799999999999997, -10.5, -7.5, -3.4, -6.3, -23.599999999999994, -5.199999999999999, -13.299999999999995, -15.3, -4.300000000000001, -5.999999999999999, -8.2, -10.3, -4.300000000000001, -29.3, -15.799999999999997, -5.2, -36.599999999999994, -41.59999999999994, -9.6, -6.2, -10.399999999999999, -6.3, -12.8, -4.2, -18.0, -5.000000000000001, -6.4, -22.5, -8.099999999999998, -4.3, -7.4, -15.999999999999996, -7.999999999999998, -4.4, -6.699999999999999, -19.5, -22.6, -7.300000000000001, -24.3, -3.4, -3.4, -3.2, -7.6000000000000005, -18.700000000000003, -23.1, -8.899999999999999, -14.399999999999999, -4.2, -4.3, -11.799999999999999, -21.3, -11.099999999999998, -9.599999999999984, -18.499999999999996, -4.300000000000001, -7.899999999999999, -4.3, -3.4, -10.8, -14.599999999999998, -25.50000000000001, -6.1, -8.4, -18.300000000000004, -11.799999999999997, -18.2, -13.7, -7.3999999999999995, -5.3, -25.0, -6.2, -13.299999999999995, -8.4, -17.199999999999996, -5.2, -7.4, -5.3, -3.4, -5.8, -14.999999999999986, -14.999999999999996, -11.5, -10.099999999999998, -13.2, -15.299999999999999, -3.3, -25.90000000000001, -5.2, -17.3, -13.999999999999998, -5.3, -6.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0809019273311589, "mean_inference_ms": 1.4349628221364403, "mean_action_processing_ms": 0.07752783699069545, "mean_env_wait_ms": 6.526806075148892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2656000, "timesteps_this_iter": 0, "agent_timesteps_total": 2656000, "timers": {"sample_time_ms": 19953.795, "sample_throughput": 200.463, "load_time_ms": 0.472, "load_throughput": 8481480.208, "learn_time_ms": 9967.18, "learn_throughput": 401.317, "update_time_ms": 1.786}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.07344464708359973, "policy_loss": -0.024886429444035536, "vf_loss": 9.69794521325378, "vf_explained_var": 0.12189009670288332, "kl": 0.012014458762990584, "entropy": 0.22096530523111102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2656000, "num_agent_steps_sampled": 2656000, "num_steps_trained": 2656000, "num_agent_steps_trained": 2656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26720, "training_iteration": 664, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-38-07", "timestamp": 1643708287, "time_this_iter_s": 15.423721075057983, "time_total_s": 17312.924122810364, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5053.415245771408, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 32.93636363636364, "ram_util_percent": 62.58181818181816}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.3, "episode_reward_mean": -12.647000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.999999999999998, -4.4, -6.699999999999999, -19.5, -22.6, -7.300000000000001, -24.3, -3.4, -3.4, -3.2, -7.6000000000000005, -18.700000000000003, -23.1, -8.899999999999999, -14.399999999999999, -4.2, -4.3, -11.799999999999999, -21.3, -11.099999999999998, -9.599999999999984, -18.499999999999996, -4.300000000000001, -7.899999999999999, -4.3, -3.4, -10.8, -14.599999999999998, -25.50000000000001, -6.1, -8.4, -18.300000000000004, -11.799999999999997, -18.2, -13.7, -7.3999999999999995, -5.3, -25.0, -6.2, -13.299999999999995, -8.4, -17.199999999999996, -5.2, -7.4, -5.3, -3.4, -5.8, -14.999999999999986, -14.999999999999996, -11.5, -10.099999999999998, -13.2, -15.299999999999999, -3.3, -25.90000000000001, -5.2, -17.3, -13.999999999999998, -5.3, -6.3, -12.399999999999997, -7.3, -8.899999999999999, -10.999999999999998, -22.700000000000003, -18.999999999999996, -23.2, -4.300000000000001, -12.699999999999998, -22.699999999999996, -5.3, -26.9, -9.8, -19.6, -14.5, -33.60000000000001, -42.3, -5.300000000000001, -19.500000000000004, -15.999999999999972, -4.3, -3.3, -19.00000000000001, -35.2, -13.7, -15.099999999999977, -5.3, -17.0, -7.800000000000001, -17.2, -14.9, -17.7, -15.899999999999999, -13.8, -9.899999999999997, -3.3, -17.2, -4.4, -11.899999999999997, -9.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0804292468233898, "mean_inference_ms": 1.4343168265202717, "mean_action_processing_ms": 0.07749332465421233, "mean_env_wait_ms": 6.523708978623395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2660000, "timesteps_this_iter": 0, "agent_timesteps_total": 2660000, "timers": {"sample_time_ms": 19488.113, "sample_throughput": 205.253, "load_time_ms": 0.458, "load_throughput": 8740409.482, "learn_time_ms": 9680.053, "learn_throughput": 413.221, "update_time_ms": 1.819}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.18945433850129767, "policy_loss": -0.01587328102930339, "vf_loss": 20.400897278580615, "vf_explained_var": 0.12477133863715716, "kl": 0.011721345079719092, "entropy": 0.2429521464692649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2660000, "num_agent_steps_sampled": 2660000, "num_steps_trained": 2660000, "num_agent_steps_trained": 2660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26760, "training_iteration": 665, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-38-22", "timestamp": 1643708302, "time_this_iter_s": 15.744469165802002, "time_total_s": 17328.668591976166, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5069.15971493721, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 32.77727272727273, "ram_util_percent": 62.56818181818183}}
{"episode_reward_max": -3.2, "episode_reward_min": -94.99999999999994, "episode_reward_mean": -12.756000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.4, -17.199999999999996, -5.2, -7.4, -5.3, -3.4, -5.8, -14.999999999999986, -14.999999999999996, -11.5, -10.099999999999998, -13.2, -15.299999999999999, -3.3, -25.90000000000001, -5.2, -17.3, -13.999999999999998, -5.3, -6.3, -12.399999999999997, -7.3, -8.899999999999999, -10.999999999999998, -22.700000000000003, -18.999999999999996, -23.2, -4.300000000000001, -12.699999999999998, -22.699999999999996, -5.3, -26.9, -9.8, -19.6, -14.5, -33.60000000000001, -42.3, -5.300000000000001, -19.500000000000004, -15.999999999999972, -4.3, -3.3, -19.00000000000001, -35.2, -13.7, -15.099999999999977, -5.3, -17.0, -7.800000000000001, -17.2, -14.9, -17.7, -15.899999999999999, -13.8, -9.899999999999997, -3.3, -17.2, -4.4, -11.899999999999997, -9.9, -11.399999999999999, -3.2, -3.4, -6.199999999999999, -13.799999999999999, -4.800000000000001, -4.4, -21.800000000000004, -7.300000000000001, -4.4, -3.4, -4.300000000000001, -8.5, -5.2, -11.5, -13.799999999999999, -4.4, -4.300000000000001, -17.5, -31.000000000000075, -10.4, -14.999999999999996, -12.2, -26.3, -3.3, -14.8, -3.4, -17.5, -3.2, -9.699999999999998, -12.5, -14.7, -12.700000000000001, -3.4, -9.8, -3.3, -4.1000000000000005, -94.99999999999994, -3.4, -12.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0799309813452052, "mean_inference_ms": 1.4335534845865971, "mean_action_processing_ms": 0.07745213370768549, "mean_env_wait_ms": 6.520017694691883, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2664000, "timesteps_this_iter": 0, "agent_timesteps_total": 2664000, "timers": {"sample_time_ms": 19008.94, "sample_throughput": 210.427, "load_time_ms": 0.445, "load_throughput": 8986189.609, "learn_time_ms": 9385.66, "learn_throughput": 426.182, "update_time_ms": 1.846}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.2950235460289023, "policy_loss": -0.027331688064801435, "vf_loss": 32.12935892958795, "vf_explained_var": 0.10486562931409446, "kl": 0.009436898461284449, "entropy": 0.23399018186234657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2664000, "num_agent_steps_sampled": 2664000, "num_steps_trained": 2664000, "num_agent_steps_trained": 2664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26800, "training_iteration": 666, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-38-38", "timestamp": 1643708318, "time_this_iter_s": 16.03458595275879, "time_total_s": 17344.703177928925, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5085.194300889969, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 34.03478260869566, "ram_util_percent": 62.439130434782605}}
{"episode_reward_max": -3.2, "episode_reward_min": -94.99999999999994, "episode_reward_mean": -11.423, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -3.3, -19.00000000000001, -35.2, -13.7, -15.099999999999977, -5.3, -17.0, -7.800000000000001, -17.2, -14.9, -17.7, -15.899999999999999, -13.8, -9.899999999999997, -3.3, -17.2, -4.4, -11.899999999999997, -9.9, -11.399999999999999, -3.2, -3.4, -6.199999999999999, -13.799999999999999, -4.800000000000001, -4.4, -21.800000000000004, -7.300000000000001, -4.4, -3.4, -4.300000000000001, -8.5, -5.2, -11.5, -13.799999999999999, -4.4, -4.300000000000001, -17.5, -31.000000000000075, -10.4, -14.999999999999996, -12.2, -26.3, -3.3, -14.8, -3.4, -17.5, -3.2, -9.699999999999998, -12.5, -14.7, -12.700000000000001, -3.4, -9.8, -3.3, -4.1000000000000005, -94.99999999999994, -3.4, -12.4, -4.4, -13.9, -5.0, -13.5, -7.4, -23.3, -24.3, -8.599999999999998, -11.799999999999997, -12.0, -22.0, -8.7, -15.299999999999997, -3.9000000000000004, -10.3, -19.199999999999996, -16.5, -8.5, -5.0, -14.7, -6.1000000000000005, -3.2, -4.4, -4.2, -15.799999999999997, -14.799999999999999, -7.300000000000001, -3.3, -4.4, -10.1, -4.4, -14.599999999999998, -3.3, -14.299999999999997, -15.299999999999999, -13.099999999999978, -10.9, -3.3, -5.4, -7.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0794472493879113, "mean_inference_ms": 1.4328815906836598, "mean_action_processing_ms": 0.07741569583567383, "mean_env_wait_ms": 6.516634306621759, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2668000, "timesteps_this_iter": 0, "agent_timesteps_total": 2668000, "timers": {"sample_time_ms": 18580.262, "sample_throughput": 215.282, "load_time_ms": 0.434, "load_throughput": 9207626.365, "learn_time_ms": 9049.26, "learn_throughput": 442.025, "update_time_ms": 1.797}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.07879575660392162, "policy_loss": -0.008212320404928378, "vf_loss": 8.477387584153043, "vf_explained_var": 0.14687614114053787, "kl": 0.01985958640661772, "entropy": 0.2630691795499735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2668000, "num_agent_steps_sampled": 2668000, "num_steps_trained": 2668000, "num_agent_steps_trained": 2668000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26840, "training_iteration": 667, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-38-54", "timestamp": 1643708334, "time_this_iter_s": 15.683382987976074, "time_total_s": 17360.3865609169, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5100.877683877945, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 34.49565217391305, "ram_util_percent": 62.5}}
{"episode_reward_max": -2.5, "episode_reward_min": -94.99999999999994, "episode_reward_mean": -11.12, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.4, -14.999999999999996, -12.2, -26.3, -3.3, -14.8, -3.4, -17.5, -3.2, -9.699999999999998, -12.5, -14.7, -12.700000000000001, -3.4, -9.8, -3.3, -4.1000000000000005, -94.99999999999994, -3.4, -12.4, -4.4, -13.9, -5.0, -13.5, -7.4, -23.3, -24.3, -8.599999999999998, -11.799999999999997, -12.0, -22.0, -8.7, -15.299999999999997, -3.9000000000000004, -10.3, -19.199999999999996, -16.5, -8.5, -5.0, -14.7, -6.1000000000000005, -3.2, -4.4, -4.2, -15.799999999999997, -14.799999999999999, -7.300000000000001, -3.3, -4.4, -10.1, -4.4, -14.599999999999998, -3.3, -14.299999999999997, -15.299999999999999, -13.099999999999978, -10.9, -3.3, -5.4, -7.3, -9.2, -3.5000000000000004, -3.4, -22.500000000000018, -4.2, -5.300000000000001, -3.3, -14.199999999999973, -4.6, -15.2, -16.9, -4.300000000000001, -20.6, -18.199999999999996, -3.2, -10.899999999999999, -4.2, -19.200000000000003, -4.300000000000001, -18.3, -16.099999999999998, -11.8, -4.2, -4.3, -11.3, -20.2, -19.500000000000007, -4.3, -12.599999999999993, -18.799999999999997, -11.699999999999994, -15.099999999999996, -2.5, -3.2, -10.199999999999998, -6.4, -10.5, -15.3, -3.4, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0788530701113297, "mean_inference_ms": 1.432132459627603, "mean_action_processing_ms": 0.07737496915080146, "mean_env_wait_ms": 6.5129618162473495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2672000, "timesteps_this_iter": 0, "agent_timesteps_total": 2672000, "timers": {"sample_time_ms": 18002.464, "sample_throughput": 222.192, "load_time_ms": 0.38, "load_throughput": 10531175.695, "learn_time_ms": 8717.612, "learn_throughput": 458.841, "update_time_ms": 1.77}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.09947200387075383, "policy_loss": -0.007365284591752996, "vf_loss": 10.576895573542965, "vf_explained_var": 0.19370808652652208, "kl": 0.009496312767041241, "entropy": 0.2389985631550512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2672000, "num_agent_steps_sampled": 2672000, "num_steps_trained": 2672000, "num_agent_steps_trained": 2672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26880, "training_iteration": 668, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-39-09", "timestamp": 1643708349, "time_this_iter_s": 15.179244041442871, "time_total_s": 17375.565804958344, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5116.056927919388, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 26.58095238095238, "ram_util_percent": 62.557142857142836}}
{"episode_reward_max": -2.5, "episode_reward_min": -101.69999999999983, "episode_reward_mean": -11.940999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.1000000000000005, -3.2, -4.4, -4.2, -15.799999999999997, -14.799999999999999, -7.300000000000001, -3.3, -4.4, -10.1, -4.4, -14.599999999999998, -3.3, -14.299999999999997, -15.299999999999999, -13.099999999999978, -10.9, -3.3, -5.4, -7.3, -9.2, -3.5000000000000004, -3.4, -22.500000000000018, -4.2, -5.300000000000001, -3.3, -14.199999999999973, -4.6, -15.2, -16.9, -4.300000000000001, -20.6, -18.199999999999996, -3.2, -10.899999999999999, -4.2, -19.200000000000003, -4.300000000000001, -18.3, -16.099999999999998, -11.8, -4.2, -4.3, -11.3, -20.2, -19.500000000000007, -4.3, -12.599999999999993, -18.799999999999997, -11.699999999999994, -15.099999999999996, -2.5, -3.2, -10.199999999999998, -6.4, -10.5, -15.3, -3.4, -4.2, -14.3, -3.3, -20.8, -14.2, -31.3, -15.999999999999996, -22.5, -14.1, -14.599999999999994, -21.9, -14.499999999999996, -4.9, -22.500000000000004, -10.8, -16.399999999999974, -4.4, -12.1, -101.69999999999983, -12.9, -16.599999999999998, -4.1, -11.799999999999999, -16.5, -7.699999999999998, -15.699999999999996, -42.3, -20.700000000000003, -10.7, -12.799999999999997, -11.5, -3.4000000000000004, -3.4, -5.000000000000001, -11.899999999999999, -3.3, -3.3, -10.3, -10.299999999999999, -3.3, -19.699999999999957], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.078342941639425, "mean_inference_ms": 1.431428767984276, "mean_action_processing_ms": 0.0773364592492275, "mean_env_wait_ms": 6.509479180789349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2676000, "timesteps_this_iter": 0, "agent_timesteps_total": 2676000, "timers": {"sample_time_ms": 17529.355, "sample_throughput": 228.189, "load_time_ms": 0.369, "load_throughput": 10837294.748, "learn_time_ms": 8389.685, "learn_throughput": 476.776, "update_time_ms": 1.741}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.4985899750859306, "policy_loss": -0.022888039395974207, "vf_loss": 52.03189745192887, "vf_explained_var": 0.09755711984890764, "kl": 0.010302627963281191, "entropy": 0.26683884244612466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2676000, "num_agent_steps_sampled": 2676000, "num_steps_trained": 2676000, "num_agent_steps_trained": 2676000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26920, "training_iteration": 669, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-39-25", "timestamp": 1643708365, "time_this_iter_s": 15.615916013717651, "time_total_s": 17391.18172097206, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5131.6728439331055, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 35.23181818181818, "ram_util_percent": 62.59999999999998}}
{"episode_reward_max": -2.5, "episode_reward_min": -132.90000000000006, "episode_reward_mean": -14.249999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.099999999999998, -11.8, -4.2, -4.3, -11.3, -20.2, -19.500000000000007, -4.3, -12.599999999999993, -18.799999999999997, -11.699999999999994, -15.099999999999996, -2.5, -3.2, -10.199999999999998, -6.4, -10.5, -15.3, -3.4, -4.2, -14.3, -3.3, -20.8, -14.2, -31.3, -15.999999999999996, -22.5, -14.1, -14.599999999999994, -21.9, -14.499999999999996, -4.9, -22.500000000000004, -10.8, -16.399999999999974, -4.4, -12.1, -101.69999999999983, -12.9, -16.599999999999998, -4.1, -11.799999999999999, -16.5, -7.699999999999998, -15.699999999999996, -42.3, -20.700000000000003, -10.7, -12.799999999999997, -11.5, -3.4000000000000004, -3.4, -5.000000000000001, -11.899999999999999, -3.3, -3.3, -10.3, -10.299999999999999, -3.3, -19.699999999999957, -132.90000000000006, -10.5, -4.4, -11.699999999999996, -3.3, -19.5, -5.300000000000001, -5.2, -19.699999999999996, -12.899999999999997, -15.2, -4.3, -19.1, -5.300000000000001, -22.5, -4.2, -4.300000000000001, -10.5, -21.4, -3.3, -4.4, -3.4, -19.200000000000003, -16.2, -31.799999999999997, -3.4, -14.899999999999999, -5.2, -7.5, -6.0, -24.60000000000002, -3.3, -16.700000000000003, -13.3, -24.7, -15.3, -14.299999999999997, -4.799999999999999, -6.9, -30.500000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0778069610792678, "mean_inference_ms": 1.4306652777390996, "mean_action_processing_ms": 0.07729369564578413, "mean_env_wait_ms": 6.505751041644967, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2680000, "timesteps_this_iter": 0, "agent_timesteps_total": 2680000, "timers": {"sample_time_ms": 16977.714, "sample_throughput": 235.603, "load_time_ms": 0.359, "load_throughput": 11133596.124, "learn_time_ms": 8100.748, "learn_throughput": 493.782, "update_time_ms": 1.716}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.9919085043552582, "policy_loss": -0.024982764806237914, "vf_loss": 101.58826454506125, "vf_explained_var": 0.007341746232842886, "kl": 0.008965764178154069, "entropy": 0.21270222791260288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2680000, "num_agent_steps_sampled": 2680000, "num_steps_trained": 2680000, "num_agent_steps_trained": 2680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 26960, "training_iteration": 670, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-39-40", "timestamp": 1643708380, "time_this_iter_s": 15.069970846176147, "time_total_s": 17406.251691818237, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5146.742814779282, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 33.18636363636364, "ram_util_percent": 62.65454545454547}}
{"episode_reward_max": -3.2, "episode_reward_min": -132.90000000000006, "episode_reward_mean": -12.969000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.1, -11.799999999999999, -16.5, -7.699999999999998, -15.699999999999996, -42.3, -20.700000000000003, -10.7, -12.799999999999997, -11.5, -3.4000000000000004, -3.4, -5.000000000000001, -11.899999999999999, -3.3, -3.3, -10.3, -10.299999999999999, -3.3, -19.699999999999957, -132.90000000000006, -10.5, -4.4, -11.699999999999996, -3.3, -19.5, -5.300000000000001, -5.2, -19.699999999999996, -12.899999999999997, -15.2, -4.3, -19.1, -5.300000000000001, -22.5, -4.2, -4.300000000000001, -10.5, -21.4, -3.3, -4.4, -3.4, -19.200000000000003, -16.2, -31.799999999999997, -3.4, -14.899999999999999, -5.2, -7.5, -6.0, -24.60000000000002, -3.3, -16.700000000000003, -13.3, -24.7, -15.3, -14.299999999999997, -4.799999999999999, -6.9, -30.500000000000004, -18.3, -4.300000000000001, -10.0, -12.7, -3.2, -12.6, -7.2, -3.4, -17.8, -11.5, -6.700000000000001, -13.899999999999999, -22.000000000000007, -14.9, -18.3, -3.4, -3.4, -3.3, -25.800000000000008, -6.2, -3.2, -17.200000000000003, -26.799999999999997, -4.700000000000001, -31.6, -3.3, -6.300000000000001, -9.7, -20.4, -12.299999999999995, -11.099999999999996, -8.199999999999998, -46.400000000000006, -4.2, -3.3, -5.300000000000001, -6.2, -4.4, -17.4, -6.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0773024777930846, "mean_inference_ms": 1.4299688861185849, "mean_action_processing_ms": 0.07725631607657188, "mean_env_wait_ms": 6.502490669915878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2684000, "timesteps_this_iter": 0, "agent_timesteps_total": 2684000, "timers": {"sample_time_ms": 16550.249, "sample_throughput": 241.688, "load_time_ms": 0.348, "load_throughput": 11482592.567, "learn_time_ms": 7797.25, "learn_throughput": 513.001, "update_time_ms": 1.783}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.12163980945829622, "policy_loss": -0.019218496093025773, "vf_loss": 13.981441429866258, "vf_explained_var": -0.006539327483023366, "kl": 0.009279065830321443, "entropy": 0.21449665643515126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2684000, "num_agent_steps_sampled": 2684000, "num_steps_trained": 2684000, "num_agent_steps_trained": 2684000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27000, "training_iteration": 671, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-39-56", "timestamp": 1643708396, "time_this_iter_s": 15.846522808074951, "time_total_s": 17422.098214626312, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5162.589337587357, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 35.73043478260869, "ram_util_percent": 62.665217391304324}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.6, "episode_reward_mean": -12.357999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -3.4, -19.200000000000003, -16.2, -31.799999999999997, -3.4, -14.899999999999999, -5.2, -7.5, -6.0, -24.60000000000002, -3.3, -16.700000000000003, -13.3, -24.7, -15.3, -14.299999999999997, -4.799999999999999, -6.9, -30.500000000000004, -18.3, -4.300000000000001, -10.0, -12.7, -3.2, -12.6, -7.2, -3.4, -17.8, -11.5, -6.700000000000001, -13.899999999999999, -22.000000000000007, -14.9, -18.3, -3.4, -3.4, -3.3, -25.800000000000008, -6.2, -3.2, -17.200000000000003, -26.799999999999997, -4.700000000000001, -31.6, -3.3, -6.300000000000001, -9.7, -20.4, -12.299999999999995, -11.099999999999996, -8.199999999999998, -46.400000000000006, -4.2, -3.3, -5.300000000000001, -6.2, -4.4, -17.4, -6.4, -4.4, -3.4, -16.699999999999996, -3.3, -15.899999999999999, -5.300000000000001, -17.400000000000002, -3.4, -3.3, -5.2, -6.300000000000001, -11.1, -75.6, -6.499999999999999, -12.9, -3.4000000000000004, -6.499999999999999, -11.7, -19.6, -18.900000000000006, -10.699999999999998, -14.5, -6.4, -12.299999999999999, -16.9, -3.3, -7.4, -5.4, -15.600000000000001, -8.2, -17.099999999999984, -4.300000000000001, -9.5, -6.3, -16.299999999999976, -10.2, -32.3, -8.600000000000001, -23.3, -22.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0770453711714745, "mean_inference_ms": 1.4295166281340141, "mean_action_processing_ms": 0.07723333978975278, "mean_env_wait_ms": 6.500371652255165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2688000, "timesteps_this_iter": 0, "agent_timesteps_total": 2688000, "timers": {"sample_time_ms": 16177.366, "sample_throughput": 247.259, "load_time_ms": 0.337, "load_throughput": 11877675.044, "learn_time_ms": 7571.284, "learn_throughput": 528.312, "update_time_ms": 1.801}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.31080556558720485, "policy_loss": -0.016979038512073857, "vf_loss": 32.61389740429899, "vf_explained_var": -0.0038919139292932325, "kl": 0.014627894118892154, "entropy": 0.2314961031559975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2688000, "num_agent_steps_sampled": 2688000, "num_steps_trained": 2688000, "num_agent_steps_trained": 2688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27040, "training_iteration": 672, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-40-14", "timestamp": 1643708414, "time_this_iter_s": 17.918454885482788, "time_total_s": 17440.016669511795, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5180.507792472839, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 34.984, "ram_util_percent": 62.58}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.6, "episode_reward_mean": -12.567999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -17.200000000000003, -26.799999999999997, -4.700000000000001, -31.6, -3.3, -6.300000000000001, -9.7, -20.4, -12.299999999999995, -11.099999999999996, -8.199999999999998, -46.400000000000006, -4.2, -3.3, -5.300000000000001, -6.2, -4.4, -17.4, -6.4, -4.4, -3.4, -16.699999999999996, -3.3, -15.899999999999999, -5.300000000000001, -17.400000000000002, -3.4, -3.3, -5.2, -6.300000000000001, -11.1, -75.6, -6.499999999999999, -12.9, -3.4000000000000004, -6.499999999999999, -11.7, -19.6, -18.900000000000006, -10.699999999999998, -14.5, -6.4, -12.299999999999999, -16.9, -3.3, -7.4, -5.4, -15.600000000000001, -8.2, -17.099999999999984, -4.300000000000001, -9.5, -6.3, -16.299999999999976, -10.2, -32.3, -8.600000000000001, -23.3, -22.7, -4.3, -22.1, -5.4, -4.4, -6.4, -4.4, -7.399999999999999, -23.3, -5.300000000000001, -18.400000000000002, -4.4, -3.9000000000000004, -27.600000000000005, -9.3, -36.10000000000001, -34.2, -3.4, -5.4, -18.5, -3.2, -23.1, -17.199999999999996, -5.4, -5.4, -13.399999999999997, -4.4, -23.8, -14.2, -4.4, -14.899999999999999, -26.400000000000002, -9.7, -5.300000000000001, -23.800000000000004, -7.799999999999999, -4.3, -20.1, -11.69999999999998, -4.3, -19.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.076867059260417, "mean_inference_ms": 1.4291997326255659, "mean_action_processing_ms": 0.0772177364407249, "mean_env_wait_ms": 6.49893657976522, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2692000, "timesteps_this_iter": 0, "agent_timesteps_total": 2692000, "timers": {"sample_time_ms": 15902.341, "sample_throughput": 251.535, "load_time_ms": 0.335, "load_throughput": 11927496.09, "learn_time_ms": 7705.589, "learn_throughput": 519.104, "update_time_ms": 1.785}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.11174205067086845, "policy_loss": -0.0155058587936344, "vf_loss": 12.566585008303324, "vf_explained_var": 0.16293955220971057, "kl": 0.01406277228389938, "entropy": 0.2319075804083578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2692000, "num_agent_steps_sampled": 2692000, "num_steps_trained": 2692000, "num_agent_steps_trained": 2692000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27080, "training_iteration": 673, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-40-31", "timestamp": 1643708431, "time_this_iter_s": 17.48880887031555, "time_total_s": 17457.50547838211, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5197.996601343155, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 36.931999999999995, "ram_util_percent": 62.6}}
{"episode_reward_max": -2.2, "episode_reward_min": -48.4, "episode_reward_mean": -12.703, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.699999999999998, -14.5, -6.4, -12.299999999999999, -16.9, -3.3, -7.4, -5.4, -15.600000000000001, -8.2, -17.099999999999984, -4.300000000000001, -9.5, -6.3, -16.299999999999976, -10.2, -32.3, -8.600000000000001, -23.3, -22.7, -4.3, -22.1, -5.4, -4.4, -6.4, -4.4, -7.399999999999999, -23.3, -5.300000000000001, -18.400000000000002, -4.4, -3.9000000000000004, -27.600000000000005, -9.3, -36.10000000000001, -34.2, -3.4, -5.4, -18.5, -3.2, -23.1, -17.199999999999996, -5.4, -5.4, -13.399999999999997, -4.4, -23.8, -14.2, -4.4, -14.899999999999999, -26.400000000000002, -9.7, -5.300000000000001, -23.800000000000004, -7.799999999999999, -4.3, -20.1, -11.69999999999998, -4.3, -19.3, -23.2, -6.0, -4.2, -14.3, -19.60000000000001, -16.799999999999997, -35.5, -21.300000000000004, -3.5, -17.5, -5.300000000000001, -4.4, -13.599999999999998, -23.500000000000004, -3.3, -26.0, -3.3, -8.9, -4.300000000000001, -7.300000000000001, -9.2, -2.2, -4.300000000000001, -20.400000000000006, -7.8999999999999995, -9.0, -3.2, -19.200000000000003, -48.4, -5.300000000000001, -12.499999999999975, -8.399999999999999, -7.4, -26.20000000000002, -24.500000000000007, -7.4, -4.3, -5.300000000000001, -20.5, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0766606031723418, "mean_inference_ms": 1.428928119731433, "mean_action_processing_ms": 0.07720530712294861, "mean_env_wait_ms": 6.497593114964392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2696000, "timesteps_this_iter": 0, "agent_timesteps_total": 2696000, "timers": {"sample_time_ms": 16146.764, "sample_throughput": 247.728, "load_time_ms": 0.342, "load_throughput": 11679231.465, "learn_time_ms": 7772.673, "learn_throughput": 514.623, "update_time_ms": 1.86}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.15489139872119934, "policy_loss": -0.033695024025616464, "vf_loss": 18.68612984790597, "vf_explained_var": 0.042449543232558874, "kl": 0.015334484043711955, "entropy": 0.272583000161635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2696000, "num_agent_steps_sampled": 2696000, "num_steps_trained": 2696000, "num_agent_steps_trained": 2696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27120, "training_iteration": 674, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-40-49", "timestamp": 1643708449, "time_this_iter_s": 17.1920428276062, "time_total_s": 17474.697521209717, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5215.188644170761, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 34.276, "ram_util_percent": 62.78}}
{"episode_reward_max": -2.2, "episode_reward_min": -109.10000000000004, "episode_reward_mean": -13.480000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.1, -17.199999999999996, -5.4, -5.4, -13.399999999999997, -4.4, -23.8, -14.2, -4.4, -14.899999999999999, -26.400000000000002, -9.7, -5.300000000000001, -23.800000000000004, -7.799999999999999, -4.3, -20.1, -11.69999999999998, -4.3, -19.3, -23.2, -6.0, -4.2, -14.3, -19.60000000000001, -16.799999999999997, -35.5, -21.300000000000004, -3.5, -17.5, -5.300000000000001, -4.4, -13.599999999999998, -23.500000000000004, -3.3, -26.0, -3.3, -8.9, -4.300000000000001, -7.300000000000001, -9.2, -2.2, -4.300000000000001, -20.400000000000006, -7.8999999999999995, -9.0, -3.2, -19.200000000000003, -48.4, -5.300000000000001, -12.499999999999975, -8.399999999999999, -7.4, -26.20000000000002, -24.500000000000007, -7.4, -4.3, -5.300000000000001, -20.5, -5.3, -15.199999999999989, -13.5, -31.90000000000001, -14.299999999999999, -9.4, -3.3, -10.299999999999997, -3.2, -18.0, -13.2, -3.4, -4.3, -17.2, -4.300000000000001, -15.699999999999998, -31.5, -9.799999999999999, -9.499999999999998, -10.7, -22.399999999999995, -4.300000000000001, -4.9, -18.0, -4.4, -17.1, -4.2, -16.799999999999997, -109.10000000000004, -18.5, -6.3, -12.9, -13.899999999999999, -18.3, -4.3, -21.0, -3.4, -15.499999999999998, -10.899999999999997, -8.3, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0763331562629466, "mean_inference_ms": 1.4285210679672977, "mean_action_processing_ms": 0.07718545510159552, "mean_env_wait_ms": 6.4956542086143205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2700000, "timesteps_this_iter": 0, "agent_timesteps_total": 2700000, "timers": {"sample_time_ms": 16223.905, "sample_throughput": 246.55, "load_time_ms": 0.335, "load_throughput": 11930888.92, "learn_time_ms": 7815.747, "learn_throughput": 511.787, "update_time_ms": 1.848}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.5715560554739548, "policy_loss": -0.02448821539454843, "vf_loss": 59.50157746589312, "vf_explained_var": -0.0008480860340979792, "kl": 0.009142275011763781, "entropy": 0.24383179298652116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2700000, "num_agent_steps_sampled": 2700000, "num_steps_trained": 2700000, "num_agent_steps_trained": 2700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27160, "training_iteration": 675, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-41-05", "timestamp": 1643708465, "time_this_iter_s": 16.2655668258667, "time_total_s": 17490.963088035583, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5231.454210996628, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 33.87826086956522, "ram_util_percent": 63.02173913043478}}
{"episode_reward_max": -2.2, "episode_reward_min": -109.10000000000004, "episode_reward_mean": -13.425999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -2.2, -4.300000000000001, -20.400000000000006, -7.8999999999999995, -9.0, -3.2, -19.200000000000003, -48.4, -5.300000000000001, -12.499999999999975, -8.399999999999999, -7.4, -26.20000000000002, -24.500000000000007, -7.4, -4.3, -5.300000000000001, -20.5, -5.3, -15.199999999999989, -13.5, -31.90000000000001, -14.299999999999999, -9.4, -3.3, -10.299999999999997, -3.2, -18.0, -13.2, -3.4, -4.3, -17.2, -4.300000000000001, -15.699999999999998, -31.5, -9.799999999999999, -9.499999999999998, -10.7, -22.399999999999995, -4.300000000000001, -4.9, -18.0, -4.4, -17.1, -4.2, -16.799999999999997, -109.10000000000004, -18.5, -6.3, -12.9, -13.899999999999999, -18.3, -4.3, -21.0, -3.4, -15.499999999999998, -10.899999999999997, -8.3, -3.2, -3.4, -3.3, -15.899999999999997, -13.1, -19.0, -5.300000000000001, -6.299999999999999, -50.4, -24.6, -2.5, -15.99999999999999, -14.299999999999995, -10.9, -5.3, -3.4, -6.4, -13.099999999999998, -26.300000000000068, -4.2, -4.300000000000001, -4.5, -4.4, -5.300000000000001, -21.500000000000007, -2.5, -3.3, -18.2, -17.799999999999994, -4.4, -4.300000000000001, -14.499999999999982, -16.79999999999999, -61.80000000000003, -19.4, -3.5000000000000004, -5.9, -5.3, -27.500000000000014, -22.100000000000005, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.076076252844667, "mean_inference_ms": 1.428062131147774, "mean_action_processing_ms": 0.0771628936039461, "mean_env_wait_ms": 6.4934890030415575, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2704000, "timesteps_this_iter": 0, "agent_timesteps_total": 2704000, "timers": {"sample_time_ms": 16321.253, "sample_throughput": 245.079, "load_time_ms": 0.336, "load_throughput": 11888616.78, "learn_time_ms": 7805.158, "learn_throughput": 512.482, "update_time_ms": 1.781}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.28295305288767303, "policy_loss": -0.02957988181301663, "vf_loss": 31.106332517695684, "vf_explained_var": -0.16379208590394706, "kl": 0.01306328069059292, "entropy": 0.25546437251952386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2704000, "num_agent_steps_sampled": 2704000, "num_steps_trained": 2704000, "num_agent_steps_trained": 2704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27200, "training_iteration": 676, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-41-22", "timestamp": 1643708482, "time_this_iter_s": 16.476919174194336, "time_total_s": 17507.440007209778, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5247.931130170822, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 39.36521739130434, "ram_util_percent": 62.91739130434785}}
{"episode_reward_max": -2.5, "episode_reward_min": -109.10000000000004, "episode_reward_mean": -14.104000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.9, -18.0, -4.4, -17.1, -4.2, -16.799999999999997, -109.10000000000004, -18.5, -6.3, -12.9, -13.899999999999999, -18.3, -4.3, -21.0, -3.4, -15.499999999999998, -10.899999999999997, -8.3, -3.2, -3.4, -3.3, -15.899999999999997, -13.1, -19.0, -5.300000000000001, -6.299999999999999, -50.4, -24.6, -2.5, -15.99999999999999, -14.299999999999995, -10.9, -5.3, -3.4, -6.4, -13.099999999999998, -26.300000000000068, -4.2, -4.300000000000001, -4.5, -4.4, -5.300000000000001, -21.500000000000007, -2.5, -3.3, -18.2, -17.799999999999994, -4.4, -4.300000000000001, -14.499999999999982, -16.79999999999999, -61.80000000000003, -19.4, -3.5000000000000004, -5.9, -5.3, -27.500000000000014, -22.100000000000005, -4.300000000000001, -3.3, -13.3, -4.4, -12.700000000000001, -22.499999999999996, -4.4, -16.2, -8.799999999999997, -22.1, -6.2, -12.6, -17.5, -3.4, -18.9, -13.799999999999999, -9.3, -4.300000000000001, -9.799999999999999, -23.10000000000001, -17.7, -6.4, -43.30000000000002, -23.200000000000003, -3.3, -20.4, -3.3, -4.300000000000001, -22.4, -5.6, -21.500000000000004, -5.4, -29.60000000000001, -4.4, -13.3, -3.4, -29.90000000000005, -23.0, -3.4, -30.600000000000005, -38.80000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0756963540438247, "mean_inference_ms": 1.427513462815912, "mean_action_processing_ms": 0.07713321277483158, "mean_env_wait_ms": 6.4908282902792624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2708000, "timesteps_this_iter": 0, "agent_timesteps_total": 2708000, "timers": {"sample_time_ms": 16296.077, "sample_throughput": 245.458, "load_time_ms": 0.338, "load_throughput": 11835778.483, "learn_time_ms": 7846.845, "learn_throughput": 509.759, "update_time_ms": 1.79}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.18187761074432762, "policy_loss": -0.021554466708493168, "vf_loss": 20.220928442349997, "vf_explained_var": 0.11833679945238175, "kl": 0.010869334681468328, "entropy": 0.2408250775789061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2708000, "num_agent_steps_sampled": 2708000, "num_steps_trained": 2708000, "num_agent_steps_trained": 2708000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27240, "training_iteration": 677, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-41-38", "timestamp": 1643708498, "time_this_iter_s": 15.954221963882446, "time_total_s": 17523.39422917366, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5263.885352134705, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 34.882608695652166, "ram_util_percent": 62.92173913043479}}
{"episode_reward_max": -2.5, "episode_reward_min": -61.80000000000003, "episode_reward_mean": -12.575000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.5, -4.4, -5.300000000000001, -21.500000000000007, -2.5, -3.3, -18.2, -17.799999999999994, -4.4, -4.300000000000001, -14.499999999999982, -16.79999999999999, -61.80000000000003, -19.4, -3.5000000000000004, -5.9, -5.3, -27.500000000000014, -22.100000000000005, -4.300000000000001, -3.3, -13.3, -4.4, -12.700000000000001, -22.499999999999996, -4.4, -16.2, -8.799999999999997, -22.1, -6.2, -12.6, -17.5, -3.4, -18.9, -13.799999999999999, -9.3, -4.300000000000001, -9.799999999999999, -23.10000000000001, -17.7, -6.4, -43.30000000000002, -23.200000000000003, -3.3, -20.4, -3.3, -4.300000000000001, -22.4, -5.6, -21.500000000000004, -5.4, -29.60000000000001, -4.4, -13.3, -3.4, -29.90000000000005, -23.0, -3.4, -30.600000000000005, -38.80000000000004, -17.799999999999997, -4.4, -12.899999999999999, -12.4, -3.3, -17.799999999999997, -3.4, -4.3, -5.4, -14.799999999999997, -4.4, -13.699999999999998, -8.5, -3.4, -6.300000000000001, -14.399999999999999, -3.4, -6.2, -10.200000000000001, -3.4, -16.599999999999994, -15.1, -8.8, -4.3, -5.2, -4.300000000000001, -10.099999999999996, -3.3, -18.099999999999998, -20.799999999999997, -7.3, -37.4, -27.599999999999966, -3.3, -11.900000000000002, -14.399999999999999, -8.999999999999996, -10.199999999999996, -8.2, -4.1000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0753085144887367, "mean_inference_ms": 1.4268985163504717, "mean_action_processing_ms": 0.0770995569270269, "mean_env_wait_ms": 6.487909148045596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2712000, "timesteps_this_iter": 0, "agent_timesteps_total": 2712000, "timers": {"sample_time_ms": 16387.931, "sample_throughput": 244.082, "load_time_ms": 0.338, "load_throughput": 11838283.94, "learn_time_ms": 7875.353, "learn_throughput": 507.914, "update_time_ms": 1.782}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.06638756883280572, "policy_loss": -0.02163234567870536, "vf_loss": 8.71339101426063, "vf_explained_var": 0.30372494593743354, "kl": 0.007875615775399997, "entropy": 0.19368177422833058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2712000, "num_agent_steps_sampled": 2712000, "num_steps_trained": 2712000, "num_agent_steps_trained": 2712000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27280, "training_iteration": 678, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-41-54", "timestamp": 1643708514, "time_this_iter_s": 15.970286130905151, "time_total_s": 17539.364515304565, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5279.85563826561, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 32.26956521739131, "ram_util_percent": 62.88260869565216}}
{"episode_reward_max": -3.2, "episode_reward_min": -51.00000000000001, "episode_reward_mean": -12.269, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -43.30000000000002, -23.200000000000003, -3.3, -20.4, -3.3, -4.300000000000001, -22.4, -5.6, -21.500000000000004, -5.4, -29.60000000000001, -4.4, -13.3, -3.4, -29.90000000000005, -23.0, -3.4, -30.600000000000005, -38.80000000000004, -17.799999999999997, -4.4, -12.899999999999999, -12.4, -3.3, -17.799999999999997, -3.4, -4.3, -5.4, -14.799999999999997, -4.4, -13.699999999999998, -8.5, -3.4, -6.300000000000001, -14.399999999999999, -3.4, -6.2, -10.200000000000001, -3.4, -16.599999999999994, -15.1, -8.8, -4.3, -5.2, -4.300000000000001, -10.099999999999996, -3.3, -18.099999999999998, -20.799999999999997, -7.3, -37.4, -27.599999999999966, -3.3, -11.900000000000002, -14.399999999999999, -8.999999999999996, -10.199999999999996, -8.2, -4.1000000000000005, -14.799999999999997, -18.199999999999996, -4.3, -3.4, -4.2, -20.199999999999996, -3.4, -19.9, -14.6, -15.299999999999997, -3.5000000000000004, -3.3, -51.00000000000001, -13.899999999999988, -7.2, -3.4, -4.300000000000001, -37.799999999999976, -3.2, -4.3, -17.099999999999998, -27.900000000000006, -8.899999999999999, -4.700000000000001, -3.4, -9.2, -5.300000000000001, -33.5, -4.300000000000001, -5.4, -14.799999999999999, -15.600000000000001, -4.4, -7.199999999999999, -10.7, -4.300000000000001, -13.2, -15.999999999999998, -3.4, -21.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0749169273892556, "mean_inference_ms": 1.4262858633095956, "mean_action_processing_ms": 0.0770652070158657, "mean_env_wait_ms": 6.484981039982389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2716000, "timesteps_this_iter": 0, "agent_timesteps_total": 2716000, "timers": {"sample_time_ms": 16418.064, "sample_throughput": 243.634, "load_time_ms": 0.339, "load_throughput": 11799153.246, "learn_time_ms": 7913.121, "learn_throughput": 505.49, "update_time_ms": 1.834}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.1854762521482283, "policy_loss": -0.018734908162025353, "vf_loss": 20.325242474258587, "vf_explained_var": 0.021922195598643314, "kl": 0.008522137811140022, "entropy": 0.21181656326097187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2716000, "num_agent_steps_sampled": 2716000, "num_steps_trained": 2716000, "num_agent_steps_trained": 2716000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27320, "training_iteration": 679, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-42-10", "timestamp": 1643708530, "time_this_iter_s": 16.00995898246765, "time_total_s": 17555.374474287033, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5295.865597248077, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 35.52173913043479, "ram_util_percent": 62.847826086956545}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.4, "episode_reward_mean": -12.941999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.599999999999994, -15.1, -8.8, -4.3, -5.2, -4.300000000000001, -10.099999999999996, -3.3, -18.099999999999998, -20.799999999999997, -7.3, -37.4, -27.599999999999966, -3.3, -11.900000000000002, -14.399999999999999, -8.999999999999996, -10.199999999999996, -8.2, -4.1000000000000005, -14.799999999999997, -18.199999999999996, -4.3, -3.4, -4.2, -20.199999999999996, -3.4, -19.9, -14.6, -15.299999999999997, -3.5000000000000004, -3.3, -51.00000000000001, -13.899999999999988, -7.2, -3.4, -4.300000000000001, -37.799999999999976, -3.2, -4.3, -17.099999999999998, -27.900000000000006, -8.899999999999999, -4.700000000000001, -3.4, -9.2, -5.300000000000001, -33.5, -4.300000000000001, -5.4, -14.799999999999999, -15.600000000000001, -4.4, -7.199999999999999, -10.7, -4.300000000000001, -13.2, -15.999999999999998, -3.4, -21.5, -4.4, -13.0, -10.699999999999998, -4.1000000000000005, -28.4, -9.7, -25.3, -13.7, -3.3, -90.4, -15.8, -10.5, -14.999999999999998, -10.899999999999999, -10.099999999999996, -18.4, -9.6, -3.4, -12.199999999999973, -13.3, -3.6000000000000005, -14.19999999999997, -13.3, -3.8000000000000007, -3.4, -15.599999999999998, -3.4, -4.300000000000001, -19.600000000000005, -67.0, -18.0, -4.4, -37.7, -4.300000000000001, -8.2, -7.6, -3.4, -6.6, -7.3, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0744250603511891, "mean_inference_ms": 1.4255997236678033, "mean_action_processing_ms": 0.07702698098129289, "mean_env_wait_ms": 6.481749346700758, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2720000, "timesteps_this_iter": 0, "agent_timesteps_total": 2720000, "timers": {"sample_time_ms": 16472.54, "sample_throughput": 242.828, "load_time_ms": 0.339, "load_throughput": 11787547.249, "learn_time_ms": 7968.355, "learn_throughput": 501.986, "update_time_ms": 1.829}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.6546889081216788, "policy_loss": -0.01746945343911648, "vf_loss": 67.11335309301653, "vf_explained_var": 0.04293811763486555, "kl": 0.009109710453099037, "entropy": 0.23600096352879077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2720000, "num_agent_steps_sampled": 2720000, "num_steps_trained": 2720000, "num_agent_steps_trained": 2720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27360, "training_iteration": 680, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-42-25", "timestamp": 1643708545, "time_this_iter_s": 15.743857860565186, "time_total_s": 17571.1183321476, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5311.609455108643, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 31.599999999999998, "ram_util_percent": 62.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.4, "episode_reward_mean": -12.128999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.099999999999998, -27.900000000000006, -8.899999999999999, -4.700000000000001, -3.4, -9.2, -5.300000000000001, -33.5, -4.300000000000001, -5.4, -14.799999999999999, -15.600000000000001, -4.4, -7.199999999999999, -10.7, -4.300000000000001, -13.2, -15.999999999999998, -3.4, -21.5, -4.4, -13.0, -10.699999999999998, -4.1000000000000005, -28.4, -9.7, -25.3, -13.7, -3.3, -90.4, -15.8, -10.5, -14.999999999999998, -10.899999999999999, -10.099999999999996, -18.4, -9.6, -3.4, -12.199999999999973, -13.3, -3.6000000000000005, -14.19999999999997, -13.3, -3.8000000000000007, -3.4, -15.599999999999998, -3.4, -4.300000000000001, -19.600000000000005, -67.0, -18.0, -4.4, -37.7, -4.300000000000001, -8.2, -7.6, -3.4, -6.6, -7.3, -5.3, -9.899999999999999, -7.4, -4.3, -4.4, -3.2, -9.799999999999999, -11.399999999999984, -17.1, -5.700000000000001, -11.6, -9.0, -3.2, -27.5, -4.4, -17.400000000000002, -13.699999999999998, -27.10000000000001, -3.4, -11.799999999999999, -3.4, -9.5, -22.6, -3.3, -8.699999999999998, -7.6, -9.5, -4.4, -6.899999999999999, -3.2, -16.7, -3.4, -12.799999999999999, -9.600000000000001, -13.399999999999999, -3.3, -19.099999999999998, -26.0, -4.4, -6.300000000000001, -12.499999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.073935947431325, "mean_inference_ms": 1.4248933758906686, "mean_action_processing_ms": 0.07698879034502065, "mean_env_wait_ms": 6.478530624384546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2724000, "timesteps_this_iter": 0, "agent_timesteps_total": 2724000, "timers": {"sample_time_ms": 16514.258, "sample_throughput": 242.215, "load_time_ms": 0.339, "load_throughput": 11790860.918, "learn_time_ms": 7969.853, "learn_throughput": 501.891, "update_time_ms": 1.797}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.08077509040513667, "policy_loss": -0.013593514020785048, "vf_loss": 9.24944395897209, "vf_explained_var": 0.2162566121547453, "kl": 0.016659270668371248, "entropy": 0.23612738106680173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2724000, "num_agent_steps_sampled": 2724000, "num_steps_trained": 2724000, "num_agent_steps_trained": 2724000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27400, "training_iteration": 681, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-42-41", "timestamp": 1643708561, "time_this_iter_s": 15.72787880897522, "time_total_s": 17586.846210956573, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5327.337333917618, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 32.186956521739134, "ram_util_percent": 62.86521739130437}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -67.0, "episode_reward_mean": -10.895, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -14.19999999999997, -13.3, -3.8000000000000007, -3.4, -15.599999999999998, -3.4, -4.300000000000001, -19.600000000000005, -67.0, -18.0, -4.4, -37.7, -4.300000000000001, -8.2, -7.6, -3.4, -6.6, -7.3, -5.3, -9.899999999999999, -7.4, -4.3, -4.4, -3.2, -9.799999999999999, -11.399999999999984, -17.1, -5.700000000000001, -11.6, -9.0, -3.2, -27.5, -4.4, -17.400000000000002, -13.699999999999998, -27.10000000000001, -3.4, -11.799999999999999, -3.4, -9.5, -22.6, -3.3, -8.699999999999998, -7.6, -9.5, -4.4, -6.899999999999999, -3.2, -16.7, -3.4, -12.799999999999999, -9.600000000000001, -13.399999999999999, -3.3, -19.099999999999998, -26.0, -4.4, -6.300000000000001, -12.499999999999995, -12.2, -4.4, -2.3000000000000003, -10.1, -5.4, -5.3, -4.300000000000001, -19.900000000000002, -3.2, -11.099999999999998, -24.0, -4.7, -4.4, -5.2, -3.4, -20.699999999999996, -6.899999999999999, -10.7, -3.4, -14.299999999999997, -6.4, -3.4, -16.5, -43.29999999999998, -3.4, -5.1000000000000005, -3.3, -24.500000000000004, -13.9, -17.700000000000003, -4.1, -10.899999999999999, -3.2, -15.299999999999981, -5.1000000000000005, -27.9, -4.4, -4.4, -27.10000000000001, -13.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0734201585388095, "mean_inference_ms": 1.424167793048214, "mean_action_processing_ms": 0.07694897576319654, "mean_env_wait_ms": 6.475135483905873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2728000, "timesteps_this_iter": 0, "agent_timesteps_total": 2728000, "timers": {"sample_time_ms": 16368.508, "sample_throughput": 244.372, "load_time_ms": 0.34, "load_throughput": 11749573.5, "learn_time_ms": 7896.737, "learn_throughput": 506.538, "update_time_ms": 1.759}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.13392019066358765, "policy_loss": -0.01723038141705817, "vf_loss": 15.012379661298567, "vf_explained_var": 0.2785662042197361, "kl": 0.009126905562286753, "entropy": 0.23349691647835957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2728000, "num_agent_steps_sampled": 2728000, "num_steps_trained": 2728000, "num_agent_steps_trained": 2728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27440, "training_iteration": 682, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-42-57", "timestamp": 1643708577, "time_this_iter_s": 15.71696424484253, "time_total_s": 17602.563175201416, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5343.05429816246, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 34.050000000000004, "ram_util_percent": 62.90000000000002}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -43.29999999999998, "episode_reward_mean": -10.765, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -22.6, -3.3, -8.699999999999998, -7.6, -9.5, -4.4, -6.899999999999999, -3.2, -16.7, -3.4, -12.799999999999999, -9.600000000000001, -13.399999999999999, -3.3, -19.099999999999998, -26.0, -4.4, -6.300000000000001, -12.499999999999995, -12.2, -4.4, -2.3000000000000003, -10.1, -5.4, -5.3, -4.300000000000001, -19.900000000000002, -3.2, -11.099999999999998, -24.0, -4.7, -4.4, -5.2, -3.4, -20.699999999999996, -6.899999999999999, -10.7, -3.4, -14.299999999999997, -6.4, -3.4, -16.5, -43.29999999999998, -3.4, -5.1000000000000005, -3.3, -24.500000000000004, -13.9, -17.700000000000003, -4.1, -10.899999999999999, -3.2, -15.299999999999981, -5.1000000000000005, -27.9, -4.4, -4.4, -27.10000000000001, -13.8, -4.800000000000001, -4.799999999999998, -3.3, -3.2, -12.199999999999998, -10.199999999999998, -3.3, -3.4, -16.799999999999997, -15.899999999999999, -18.1, -6.699999999999999, -14.499999999999996, -3.3, -11.999999999999998, -19.4, -18.3, -12.199999999999998, -17.900000000000006, -4.3, -24.3, -9.3, -5.3, -9.200000000000001, -17.0, -9.899999999999997, -18.1, -6.199999999999999, -4.3, -12.299999999999999, -3.7, -18.699999999999992, -15.299999999999999, -5.3, -4.3, -6.499999999999999, -5.2, -20.4, -19.3, -24.500000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0730274390647807, "mean_inference_ms": 1.423489194255167, "mean_action_processing_ms": 0.07691092128213006, "mean_env_wait_ms": 6.471709894965098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2732000, "timesteps_this_iter": 0, "agent_timesteps_total": 2732000, "timers": {"sample_time_ms": 16224.965, "sample_throughput": 246.534, "load_time_ms": 0.341, "load_throughput": 11739707.508, "learn_time_ms": 7771.488, "learn_throughput": 514.702, "update_time_ms": 1.758}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.09323141347661974, "policy_loss": -0.015579365277462589, "vf_loss": 10.759795233639338, "vf_explained_var": 0.2172899321202309, "kl": 0.010780706717123644, "entropy": 0.26121961270929667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2732000, "num_agent_steps_sampled": 2732000, "num_steps_trained": 2732000, "num_agent_steps_trained": 2732000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27480, "training_iteration": 683, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-43-12", "timestamp": 1643708592, "time_this_iter_s": 15.579663038253784, "time_total_s": 17618.14283823967, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5358.633961200714, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 32.25909090909091, "ram_util_percent": 62.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.29999999999998, "episode_reward_mean": -11.287, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -3.4, -16.5, -43.29999999999998, -3.4, -5.1000000000000005, -3.3, -24.500000000000004, -13.9, -17.700000000000003, -4.1, -10.899999999999999, -3.2, -15.299999999999981, -5.1000000000000005, -27.9, -4.4, -4.4, -27.10000000000001, -13.8, -4.800000000000001, -4.799999999999998, -3.3, -3.2, -12.199999999999998, -10.199999999999998, -3.3, -3.4, -16.799999999999997, -15.899999999999999, -18.1, -6.699999999999999, -14.499999999999996, -3.3, -11.999999999999998, -19.4, -18.3, -12.199999999999998, -17.900000000000006, -4.3, -24.3, -9.3, -5.3, -9.200000000000001, -17.0, -9.899999999999997, -18.1, -6.199999999999999, -4.3, -12.299999999999999, -3.7, -18.699999999999992, -15.299999999999999, -5.3, -4.3, -6.499999999999999, -5.2, -20.4, -19.3, -24.500000000000004, -6.4, -3.4, -3.3, -26.0, -5.699999999999999, -20.9, -7.1, -17.099999999999998, -3.3, -4.4, -22.5, -5.4, -4.2, -32.7, -16.799999999999997, -12.2, -14.0, -4.4, -7.4, -16.699999999999996, -6.300000000000001, -20.70000000000001, -10.4, -12.699999999999987, -4.7, -6.300000000000001, -5.4, -6.899999999999999, -5.2, -14.199999999999998, -6.2, -9.599999999999998, -4.3, -10.2, -16.999999999999993, -19.00000000000003, -3.4, -6.5, -16.09999999999998, -12.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0723558037594048, "mean_inference_ms": 1.4229267254984928, "mean_action_processing_ms": 0.07687105244728051, "mean_env_wait_ms": 6.468201301121574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2736000, "timesteps_this_iter": 0, "agent_timesteps_total": 2736000, "timers": {"sample_time_ms": 15987.623, "sample_throughput": 250.194, "load_time_ms": 0.333, "load_throughput": 12005163.506, "learn_time_ms": 7703.725, "learn_throughput": 519.229, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.07334082486929111, "policy_loss": -0.028474105570104814, "vf_loss": 10.006982923964019, "vf_explained_var": 0.22371192189954942, "kl": 0.015512031477274538, "entropy": 0.25641820375477115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2736000, "num_agent_steps_sampled": 2736000, "num_steps_trained": 2736000, "num_agent_steps_trained": 2736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27520, "training_iteration": 684, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-43-28", "timestamp": 1643708608, "time_this_iter_s": 15.39850664138794, "time_total_s": 17633.541344881058, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5374.032467842102, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 32.33181818181818, "ram_util_percent": 62.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -55.4, "episode_reward_mean": -11.974000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.3, -9.3, -5.3, -9.200000000000001, -17.0, -9.899999999999997, -18.1, -6.199999999999999, -4.3, -12.299999999999999, -3.7, -18.699999999999992, -15.299999999999999, -5.3, -4.3, -6.499999999999999, -5.2, -20.4, -19.3, -24.500000000000004, -6.4, -3.4, -3.3, -26.0, -5.699999999999999, -20.9, -7.1, -17.099999999999998, -3.3, -4.4, -22.5, -5.4, -4.2, -32.7, -16.799999999999997, -12.2, -14.0, -4.4, -7.4, -16.699999999999996, -6.300000000000001, -20.70000000000001, -10.4, -12.699999999999987, -4.7, -6.300000000000001, -5.4, -6.899999999999999, -5.2, -14.199999999999998, -6.2, -9.599999999999998, -4.3, -10.2, -16.999999999999993, -19.00000000000003, -3.4, -6.5, -16.09999999999998, -12.3, -4.2, -9.2, -15.699999999999998, -7.300000000000001, -33.7, -20.3, -9.5, -7.599999999999999, -9.0, -18.000000000000004, -3.3, -16.7, -5.2, -18.100000000000012, -3.4, -46.70000000000001, -24.500000000000004, -4.2, -5.4, -7.300000000000001, -35.6, -7.8, -3.4, -29.500000000000036, -3.3, -4.4, -5.4, -4.300000000000001, -19.099999999999998, -3.4, -14.2, -55.4, -9.600000000000001, -3.4, -8.599999999999998, -3.2, -17.700000000000003, -15.999999999999998, -6.4, -6.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0718842283335022, "mean_inference_ms": 1.4224952989076973, "mean_action_processing_ms": 0.07683846146302768, "mean_env_wait_ms": 6.465401301014778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2740000, "timesteps_this_iter": 0, "agent_timesteps_total": 2740000, "timers": {"sample_time_ms": 15960.017, "sample_throughput": 250.626, "load_time_ms": 0.338, "load_throughput": 11819935.184, "learn_time_ms": 7749.363, "learn_throughput": 516.171, "update_time_ms": 1.634}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.24102297511492526, "policy_loss": -0.019794208854837445, "vf_loss": 25.951012818595416, "vf_explained_var": 0.06353136768905066, "kl": 0.011618322497982232, "entropy": 0.26049326922624344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2740000, "num_agent_steps_sampled": 2740000, "num_steps_trained": 2740000, "num_agent_steps_trained": 2740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27560, "training_iteration": 685, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-43-45", "timestamp": 1643708625, "time_this_iter_s": 17.12993574142456, "time_total_s": 17650.671280622482, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5391.162403583527, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 33.9, "ram_util_percent": 62.97200000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -55.4, "episode_reward_mean": -11.243000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -20.70000000000001, -10.4, -12.699999999999987, -4.7, -6.300000000000001, -5.4, -6.899999999999999, -5.2, -14.199999999999998, -6.2, -9.599999999999998, -4.3, -10.2, -16.999999999999993, -19.00000000000003, -3.4, -6.5, -16.09999999999998, -12.3, -4.2, -9.2, -15.699999999999998, -7.300000000000001, -33.7, -20.3, -9.5, -7.599999999999999, -9.0, -18.000000000000004, -3.3, -16.7, -5.2, -18.100000000000012, -3.4, -46.70000000000001, -24.500000000000004, -4.2, -5.4, -7.300000000000001, -35.6, -7.8, -3.4, -29.500000000000036, -3.3, -4.4, -5.4, -4.300000000000001, -19.099999999999998, -3.4, -14.2, -55.4, -9.600000000000001, -3.4, -8.599999999999998, -3.2, -17.700000000000003, -15.999999999999998, -6.4, -6.999999999999998, -17.199999999999996, -3.4, -18.0, -3.3, -4.800000000000001, -3.3, -12.2, -9.3, -7.1, -16.0, -5.4, -5.4, -35.0, -9.399999999999999, -26.300000000000004, -21.000000000000007, -10.3, -5.8999999999999995, -12.099999999999996, -4.699999999999999, -3.4, -4.3, -3.3, -12.999999999999996, -14.2, -8.3, -19.200000000000003, -4.6000000000000005, -6.4, -3.8000000000000003, -18.799999999999997, -9.899999999999997, -8.8, -4.7, -4.4, -21.700000000000003, -3.2, -3.3, -4.300000000000001, -10.200000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0715967882890676, "mean_inference_ms": 1.4220717330960377, "mean_action_processing_ms": 0.07681269109206072, "mean_env_wait_ms": 6.463248271934979, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2744000, "timesteps_this_iter": 0, "agent_timesteps_total": 2744000, "timers": {"sample_time_ms": 15989.268, "sample_throughput": 250.168, "load_time_ms": 0.351, "load_throughput": 11411519.521, "learn_time_ms": 7847.455, "learn_throughput": 509.719, "update_time_ms": 1.707}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.08738074277938214, "policy_loss": -0.018274579951239208, "vf_loss": 10.430969327912536, "vf_explained_var": 0.08315232030807003, "kl": 0.011961154610193129, "entropy": 0.2693275878826777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2744000, "num_agent_steps_sampled": 2744000, "num_steps_trained": 2744000, "num_agent_steps_trained": 2744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27600, "training_iteration": 686, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-44-02", "timestamp": 1643708642, "time_this_iter_s": 17.293463945388794, "time_total_s": 17667.96474456787, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5408.455867528915, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 37.00833333333333, "ram_util_percent": 63.0}}
{"episode_reward_max": -3.2, "episode_reward_min": -66.3, "episode_reward_mean": -12.183, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.6, -7.8, -3.4, -29.500000000000036, -3.3, -4.4, -5.4, -4.300000000000001, -19.099999999999998, -3.4, -14.2, -55.4, -9.600000000000001, -3.4, -8.599999999999998, -3.2, -17.700000000000003, -15.999999999999998, -6.4, -6.999999999999998, -17.199999999999996, -3.4, -18.0, -3.3, -4.800000000000001, -3.3, -12.2, -9.3, -7.1, -16.0, -5.4, -5.4, -35.0, -9.399999999999999, -26.300000000000004, -21.000000000000007, -10.3, -5.8999999999999995, -12.099999999999996, -4.699999999999999, -3.4, -4.3, -3.3, -12.999999999999996, -14.2, -8.3, -19.200000000000003, -4.6000000000000005, -6.4, -3.8000000000000003, -18.799999999999997, -9.899999999999997, -8.8, -4.7, -4.4, -21.700000000000003, -3.2, -3.3, -4.300000000000001, -10.200000000000001, -11.7, -5.1, -3.3, -11.699999999999998, -17.1, -4.3, -5.2, -66.3, -13.9, -3.2, -14.7, -16.9, -11.899999999999999, -32.7, -11.299999999999997, -5.300000000000001, -12.6, -20.699999999999996, -8.6, -24.2, -9.5, -33.80000000000002, -19.000000000000004, -20.8, -10.3, -4.4, -9.799999999999999, -6.300000000000001, -21.900000000000006, -11.899999999999999, -9.0, -10.899999999999999, -16.5, -3.4, -6.6000000000000005, -21.599999999999998, -11.599999999999998, -6.5, -22.900000000000002, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0713542607074324, "mean_inference_ms": 1.4216798137180962, "mean_action_processing_ms": 0.07679115349227622, "mean_env_wait_ms": 6.461526898245338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2748000, "timesteps_this_iter": 0, "agent_timesteps_total": 2748000, "timers": {"sample_time_ms": 16121.776, "sample_throughput": 248.112, "load_time_ms": 0.348, "load_throughput": 11490456.818, "learn_time_ms": 7851.041, "learn_throughput": 509.487, "update_time_ms": 1.728}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.3049398030612558, "policy_loss": -0.01727279130649823, "vf_loss": 32.10257044838321, "vf_explained_var": 0.10076474291022106, "kl": 0.010550177375440147, "entropy": 0.283350656822484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2748000, "num_agent_steps_sampled": 2748000, "num_steps_trained": 2748000, "num_agent_steps_trained": 2748000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27640, "training_iteration": 687, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-44-19", "timestamp": 1643708659, "time_this_iter_s": 16.331743955612183, "time_total_s": 17684.296488523483, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5424.787611484528, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 31.275000000000002, "ram_util_percent": 63.0375}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.2, "episode_reward_mean": -14.360000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -4.3, -3.3, -12.999999999999996, -14.2, -8.3, -19.200000000000003, -4.6000000000000005, -6.4, -3.8000000000000003, -18.799999999999997, -9.899999999999997, -8.8, -4.7, -4.4, -21.700000000000003, -3.2, -3.3, -4.300000000000001, -10.200000000000001, -11.7, -5.1, -3.3, -11.699999999999998, -17.1, -4.3, -5.2, -66.3, -13.9, -3.2, -14.7, -16.9, -11.899999999999999, -32.7, -11.299999999999997, -5.300000000000001, -12.6, -20.699999999999996, -8.6, -24.2, -9.5, -33.80000000000002, -19.000000000000004, -20.8, -10.3, -4.4, -9.799999999999999, -6.300000000000001, -21.900000000000006, -11.899999999999999, -9.0, -10.899999999999999, -16.5, -3.4, -6.6000000000000005, -21.599999999999998, -11.599999999999998, -6.5, -22.900000000000002, -3.3, -5.4, -26.200000000000003, -21.90000000000001, -14.7, -4.300000000000001, -3.2, -12.4, -6.300000000000001, -19.900000000000002, -19.5, -6.400000000000001, -16.4, -25.500000000000004, -4.300000000000001, -19.700000000000003, -20.800000000000008, -16.9, -18.4, -5.5, -24.6, -3.4, -26.500000000000036, -24.400000000000002, -7.4, -13.099999999999998, -14.7, -29.3, -17.5, -21.0, -3.7, -30.800000000000004, -23.700000000000006, -4.300000000000001, -34.0, -10.499999999999996, -89.2, -32.0, -9.4, -3.8000000000000007, -14.499999999999986], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0708932017406216, "mean_inference_ms": 1.421198227891581, "mean_action_processing_ms": 0.07676557677833289, "mean_env_wait_ms": 6.459276809106939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2752000, "timesteps_this_iter": 0, "agent_timesteps_total": 2752000, "timers": {"sample_time_ms": 16114.158, "sample_throughput": 248.229, "load_time_ms": 0.349, "load_throughput": 11461412.761, "learn_time_ms": 7792.496, "learn_throughput": 513.314, "update_time_ms": 1.708}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.5458598715748878, "policy_loss": -0.021867988820898757, "vf_loss": 56.64269722456573, "vf_explained_var": 0.12278922424521498, "kl": 0.011563578639692946, "entropy": 0.31225537657737734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2752000, "num_agent_steps_sampled": 2752000, "num_steps_trained": 2752000, "num_agent_steps_trained": 2752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27680, "training_iteration": 688, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-44-34", "timestamp": 1643708674, "time_this_iter_s": 15.269827127456665, "time_total_s": 17699.56631565094, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5440.057438611984, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 29.728571428571428, "ram_util_percent": 63.0}}
{"episode_reward_max": -3.0, "episode_reward_min": -89.2, "episode_reward_mean": -14.559000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -33.80000000000002, -19.000000000000004, -20.8, -10.3, -4.4, -9.799999999999999, -6.300000000000001, -21.900000000000006, -11.899999999999999, -9.0, -10.899999999999999, -16.5, -3.4, -6.6000000000000005, -21.599999999999998, -11.599999999999998, -6.5, -22.900000000000002, -3.3, -5.4, -26.200000000000003, -21.90000000000001, -14.7, -4.300000000000001, -3.2, -12.4, -6.300000000000001, -19.900000000000002, -19.5, -6.400000000000001, -16.4, -25.500000000000004, -4.300000000000001, -19.700000000000003, -20.800000000000008, -16.9, -18.4, -5.5, -24.6, -3.4, -26.500000000000036, -24.400000000000002, -7.4, -13.099999999999998, -14.7, -29.3, -17.5, -21.0, -3.7, -30.800000000000004, -23.700000000000006, -4.300000000000001, -34.0, -10.499999999999996, -89.2, -32.0, -9.4, -3.8000000000000007, -14.499999999999986, -5.4, -3.2, -8.3, -20.3, -3.4, -23.699999999999996, -4.4, -16.699999999999996, -26.999999999999957, -7.8999999999999995, -12.3, -3.3, -17.800000000000004, -4.4, -11.5, -18.6, -9.4, -12.499999999999998, -3.4, -11.100000000000001, -10.399999999999999, -7.899999999999998, -13.899999999999997, -5.4, -11.699999999999998, -3.4, -23.500000000000004, -3.3, -30.999999999999993, -3.3, -9.4, -7.4, -9.5, -19.7, -10.0, -40.6, -17.9, -3.0, -17.4, -17.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0702304475131974, "mean_inference_ms": 1.420531395798622, "mean_action_processing_ms": 0.07672978821737009, "mean_env_wait_ms": 6.456121784555783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2756000, "timesteps_this_iter": 0, "agent_timesteps_total": 2756000, "timers": {"sample_time_ms": 15976.538, "sample_throughput": 250.367, "load_time_ms": 0.351, "load_throughput": 11409191.431, "learn_time_ms": 7893.213, "learn_throughput": 506.764, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.1353513250958615, "policy_loss": -0.01994326809841779, "vf_loss": 15.323665619921941, "vf_explained_var": 0.07720189171452677, "kl": 0.018292813813805098, "entropy": 0.28266100751296164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2756000, "num_agent_steps_sampled": 2756000, "num_steps_trained": 2756000, "num_agent_steps_trained": 2756000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27720, "training_iteration": 689, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-44-50", "timestamp": 1643708690, "time_this_iter_s": 16.226201057434082, "time_total_s": 17715.792516708374, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5456.283639669418, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 31.67083333333333, "ram_util_percent": 63.0}}
{"episode_reward_max": -2.5, "episode_reward_min": -89.2, "episode_reward_mean": -14.292, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -26.500000000000036, -24.400000000000002, -7.4, -13.099999999999998, -14.7, -29.3, -17.5, -21.0, -3.7, -30.800000000000004, -23.700000000000006, -4.300000000000001, -34.0, -10.499999999999996, -89.2, -32.0, -9.4, -3.8000000000000007, -14.499999999999986, -5.4, -3.2, -8.3, -20.3, -3.4, -23.699999999999996, -4.4, -16.699999999999996, -26.999999999999957, -7.8999999999999995, -12.3, -3.3, -17.800000000000004, -4.4, -11.5, -18.6, -9.4, -12.499999999999998, -3.4, -11.100000000000001, -10.399999999999999, -7.899999999999998, -13.899999999999997, -5.4, -11.699999999999998, -3.4, -23.500000000000004, -3.3, -30.999999999999993, -3.3, -9.4, -7.4, -9.5, -19.7, -10.0, -40.6, -17.9, -3.0, -17.4, -17.099999999999998, -8.4, -9.899999999999999, -10.000000000000002, -27.900000000000002, -17.5, -8.299999999999999, -22.7, -17.299999999999997, -11.3, -9.399999999999999, -16.69999999999999, -20.200000000000003, -13.0, -4.300000000000001, -17.1, -11.700000000000001, -3.3, -17.299999999999997, -16.299999999999997, -15.999999999999996, -10.2, -12.799999999999999, -17.6, -16.299999999999997, -15.999999999999991, -7.299999999999999, -12.899999999999999, -5.4, -15.799999999999985, -2.5, -14.099999999999998, -4.3, -11.7, -5.2, -13.3, -11.9, -13.699999999999978, -18.2, -26.70000000000001, -11.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0697006705737508, "mean_inference_ms": 1.4198182903263348, "mean_action_processing_ms": 0.07669111844823188, "mean_env_wait_ms": 6.45256617363447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2760000, "timesteps_this_iter": 0, "agent_timesteps_total": 2760000, "timers": {"sample_time_ms": 16108.343, "sample_throughput": 248.319, "load_time_ms": 0.35, "load_throughput": 11434852.781, "learn_time_ms": 7859.418, "learn_throughput": 508.944, "update_time_ms": 1.691}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.11576984857749795, "policy_loss": -0.012740330915817971, "vf_loss": 12.669766740004222, "vf_explained_var": 0.13447763041783406, "kl": 0.01611124744790462, "entropy": 0.3149496236475565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2760000, "num_agent_steps_sampled": 2760000, "num_steps_trained": 2760000, "num_agent_steps_trained": 2760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27760, "training_iteration": 690, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-45-06", "timestamp": 1643708706, "time_this_iter_s": 15.762897968292236, "time_total_s": 17731.555414676666, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5472.046537637711, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 28.95909090909091, "ram_util_percent": 62.95}}
{"episode_reward_max": -2.5, "episode_reward_min": -53.4, "episode_reward_mean": -13.455, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.399999999999999, -7.899999999999998, -13.899999999999997, -5.4, -11.699999999999998, -3.4, -23.500000000000004, -3.3, -30.999999999999993, -3.3, -9.4, -7.4, -9.5, -19.7, -10.0, -40.6, -17.9, -3.0, -17.4, -17.099999999999998, -8.4, -9.899999999999999, -10.000000000000002, -27.900000000000002, -17.5, -8.299999999999999, -22.7, -17.299999999999997, -11.3, -9.399999999999999, -16.69999999999999, -20.200000000000003, -13.0, -4.300000000000001, -17.1, -11.700000000000001, -3.3, -17.299999999999997, -16.299999999999997, -15.999999999999996, -10.2, -12.799999999999999, -17.6, -16.299999999999997, -15.999999999999991, -7.299999999999999, -12.899999999999999, -5.4, -15.799999999999985, -2.5, -14.099999999999998, -4.3, -11.7, -5.2, -13.3, -11.9, -13.699999999999978, -18.2, -26.70000000000001, -11.099999999999998, -9.3, -14.2, -10.4, -8.9, -24.7, -4.800000000000001, -3.8000000000000003, -9.2, -10.999999999999998, -13.899999999999999, -7.2, -12.0, -3.4, -11.5, -11.4, -10.2, -11.3, -20.5, -15.099999999999989, -18.6, -26.60000000000003, -12.3, -17.7, -23.7, -13.499999999999996, -14.199999999999998, -9.799999999999999, -10.699999999999987, -14.69999999999998, -27.799999999999997, -10.099999999999998, -53.4, -11.299999999999995, -4.2, -13.799999999999999, -13.799999999999999, -6.4, -8.2, -23.599999999999998, -6.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.069242975243058, "mean_inference_ms": 1.4191704391344302, "mean_action_processing_ms": 0.07665623159052667, "mean_env_wait_ms": 6.44945040666521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2764000, "timesteps_this_iter": 0, "agent_timesteps_total": 2764000, "timers": {"sample_time_ms": 16073.711, "sample_throughput": 248.854, "load_time_ms": 0.347, "load_throughput": 11513324.183, "learn_time_ms": 7933.094, "learn_throughput": 504.217, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.13409545684323435, "policy_loss": -0.02269904152189772, "vf_loss": 15.542101038655927, "vf_explained_var": 0.22706410801538857, "kl": 0.012208833661793164, "entropy": 0.29488852290056083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2764000, "num_agent_steps_sampled": 2764000, "num_steps_trained": 2764000, "num_agent_steps_trained": 2764000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27800, "training_iteration": 691, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-45-23", "timestamp": 1643708723, "time_this_iter_s": 16.449510097503662, "time_total_s": 17748.00492477417, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5488.496047735214, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 33.13913043478261, "ram_util_percent": 63.0}}
{"episode_reward_max": -2.5, "episode_reward_min": -53.4, "episode_reward_mean": -13.321, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -12.799999999999999, -17.6, -16.299999999999997, -15.999999999999991, -7.299999999999999, -12.899999999999999, -5.4, -15.799999999999985, -2.5, -14.099999999999998, -4.3, -11.7, -5.2, -13.3, -11.9, -13.699999999999978, -18.2, -26.70000000000001, -11.099999999999998, -9.3, -14.2, -10.4, -8.9, -24.7, -4.800000000000001, -3.8000000000000003, -9.2, -10.999999999999998, -13.899999999999999, -7.2, -12.0, -3.4, -11.5, -11.4, -10.2, -11.3, -20.5, -15.099999999999989, -18.6, -26.60000000000003, -12.3, -17.7, -23.7, -13.499999999999996, -14.199999999999998, -9.799999999999999, -10.699999999999987, -14.69999999999998, -27.799999999999997, -10.099999999999998, -53.4, -11.299999999999995, -4.2, -13.799999999999999, -13.799999999999999, -6.4, -8.2, -23.599999999999998, -6.9, -6.3, -16.1, -13.299999999999999, -8.5, -9.3, -9.399999999999999, -4.3, -4.4, -23.900000000000002, -12.6, -14.6, -9.4, -7.2, -7.300000000000001, -16.599999999999998, -44.4, -6.3, -23.700000000000006, -6.2, -8.5, -23.700000000000035, -28.6, -21.3, -5.800000000000001, -14.7, -6.3, -5.1, -9.3, -7.2, -17.2, -10.899999999999999, -4.300000000000001, -21.400000000000016, -10.400000000000002, -15.799999999999999, -7.1, -32.7, -8.999999999999998, -21.299999999999997, -6.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.068837715419736, "mean_inference_ms": 1.4187222483376787, "mean_action_processing_ms": 0.07663317013937979, "mean_env_wait_ms": 6.447422647904207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2768000, "timesteps_this_iter": 0, "agent_timesteps_total": 2768000, "timers": {"sample_time_ms": 16251.084, "sample_throughput": 246.137, "load_time_ms": 0.347, "load_throughput": 11526771.556, "learn_time_ms": 7990.722, "learn_throughput": 500.581, "update_time_ms": 1.662}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.1309586578559491, "policy_loss": -0.02138259193649696, "vf_loss": 15.070783364772797, "vf_explained_var": 0.23539637461785348, "kl": 0.014519286520730082, "entropy": 0.26806141495384195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2768000, "num_agent_steps_sampled": 2768000, "num_steps_trained": 2768000, "num_agent_steps_trained": 2768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27840, "training_iteration": 692, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-45-40", "timestamp": 1643708740, "time_this_iter_s": 17.335761070251465, "time_total_s": 17765.34068584442, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5505.831808805466, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 42.328, "ram_util_percent": 63.056}}
{"episode_reward_max": -4.2, "episode_reward_min": -53.4, "episode_reward_mean": -12.830000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.60000000000003, -12.3, -17.7, -23.7, -13.499999999999996, -14.199999999999998, -9.799999999999999, -10.699999999999987, -14.69999999999998, -27.799999999999997, -10.099999999999998, -53.4, -11.299999999999995, -4.2, -13.799999999999999, -13.799999999999999, -6.4, -8.2, -23.599999999999998, -6.9, -6.3, -16.1, -13.299999999999999, -8.5, -9.3, -9.399999999999999, -4.3, -4.4, -23.900000000000002, -12.6, -14.6, -9.4, -7.2, -7.300000000000001, -16.599999999999998, -44.4, -6.3, -23.700000000000006, -6.2, -8.5, -23.700000000000035, -28.6, -21.3, -5.800000000000001, -14.7, -6.3, -5.1, -9.3, -7.2, -17.2, -10.899999999999999, -4.300000000000001, -21.400000000000016, -10.400000000000002, -15.799999999999999, -7.1, -32.7, -8.999999999999998, -21.299999999999997, -6.6000000000000005, -43.50000000000004, -9.899999999999997, -6.4, -22.500000000000014, -6.6000000000000005, -13.7, -8.299999999999997, -8.2, -4.4, -4.700000000000001, -6.299999999999999, -10.399999999999997, -7.4, -10.9, -7.800000000000001, -9.700000000000001, -12.899999999999999, -4.3, -18.700000000000006, -13.799999999999981, -5.300000000000001, -25.700000000000003, -4.5, -7.4, -5.4, -22.2, -10.2, -11.999999999999998, -6.4, -6.300000000000001, -6.1, -7.3, -12.6, -5.3, -10.9, -6.4, -5.2, -21.500000000000004, -6.300000000000001, -11.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.068359100211226, "mean_inference_ms": 1.4183282050909853, "mean_action_processing_ms": 0.07661283921657074, "mean_env_wait_ms": 6.445646135640564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2772000, "timesteps_this_iter": 0, "agent_timesteps_total": 2772000, "timers": {"sample_time_ms": 16346.287, "sample_throughput": 244.704, "load_time_ms": 0.345, "load_throughput": 11583275.338, "learn_time_ms": 8023.003, "learn_throughput": 498.566, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.09326650357745107, "policy_loss": -0.028255213455607494, "vf_loss": 11.985971832595846, "vf_explained_var": 0.2029032197690779, "kl": 0.0147733316439142, "entropy": 0.305613189655286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2772000, "num_agent_steps_sampled": 2772000, "num_steps_trained": 2772000, "num_agent_steps_trained": 2772000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27880, "training_iteration": 693, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-45-56", "timestamp": 1643708756, "time_this_iter_s": 16.277152061462402, "time_total_s": 17781.617837905884, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5522.108960866928, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 36.78260869565217, "ram_util_percent": 63.09999999999998}}
{"episode_reward_max": -4.3, "episode_reward_min": -43.50000000000004, "episode_reward_mean": -12.494000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.700000000000035, -28.6, -21.3, -5.800000000000001, -14.7, -6.3, -5.1, -9.3, -7.2, -17.2, -10.899999999999999, -4.300000000000001, -21.400000000000016, -10.400000000000002, -15.799999999999999, -7.1, -32.7, -8.999999999999998, -21.299999999999997, -6.6000000000000005, -43.50000000000004, -9.899999999999997, -6.4, -22.500000000000014, -6.6000000000000005, -13.7, -8.299999999999997, -8.2, -4.4, -4.700000000000001, -6.299999999999999, -10.399999999999997, -7.4, -10.9, -7.800000000000001, -9.700000000000001, -12.899999999999999, -4.3, -18.700000000000006, -13.799999999999981, -5.300000000000001, -25.700000000000003, -4.5, -7.4, -5.4, -22.2, -10.2, -11.999999999999998, -6.4, -6.300000000000001, -6.1, -7.3, -12.6, -5.3, -10.9, -6.4, -5.2, -21.500000000000004, -6.300000000000001, -11.9, -5.6, -4.6000000000000005, -9.8, -6.2, -7.099999999999998, -15.899999999999999, -6.2, -10.0, -8.3, -17.9, -10.6, -21.000000000000004, -8.700000000000001, -41.70000000000006, -10.5, -6.300000000000001, -15.2, -8.600000000000001, -5.2, -21.799999999999986, -11.799999999999999, -25.100000000000012, -12.5, -8.399999999999999, -14.299999999999997, -28.200000000000006, -6.2, -12.099999999999996, -7.300000000000001, -19.799999999999997, -4.300000000000001, -13.999999999999973, -19.2, -5.5, -8.3, -24.7, -34.200000000000074, -11.7, -7.300000000000001, -25.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0679426876438698, "mean_inference_ms": 1.4179095527035184, "mean_action_processing_ms": 0.07659099807540282, "mean_env_wait_ms": 6.443687720695477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2776000, "timesteps_this_iter": 0, "agent_timesteps_total": 2776000, "timers": {"sample_time_ms": 16427.376, "sample_throughput": 243.496, "load_time_ms": 0.352, "load_throughput": 11375926.227, "learn_time_ms": 8012.722, "learn_throughput": 499.206, "update_time_ms": 1.753}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.15427631535717556, "policy_loss": -0.012422828060845213, "vf_loss": 16.563847931867006, "vf_explained_var": 0.23255625988847467, "kl": 0.009428131704299961, "entropy": 0.307258196399417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2776000, "num_agent_steps_sampled": 2776000, "num_steps_trained": 2776000, "num_agent_steps_trained": 2776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27920, "training_iteration": 694, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-46-12", "timestamp": 1643708772, "time_this_iter_s": 15.785992860794067, "time_total_s": 17797.403830766678, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5537.894953727722, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 32.52608695652174, "ram_util_percent": 63.15652173913045}}
{"episode_reward_max": -3.3, "episode_reward_min": -61.3, "episode_reward_mean": -12.200000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -25.700000000000003, -4.5, -7.4, -5.4, -22.2, -10.2, -11.999999999999998, -6.4, -6.300000000000001, -6.1, -7.3, -12.6, -5.3, -10.9, -6.4, -5.2, -21.500000000000004, -6.300000000000001, -11.9, -5.6, -4.6000000000000005, -9.8, -6.2, -7.099999999999998, -15.899999999999999, -6.2, -10.0, -8.3, -17.9, -10.6, -21.000000000000004, -8.700000000000001, -41.70000000000006, -10.5, -6.300000000000001, -15.2, -8.600000000000001, -5.2, -21.799999999999986, -11.799999999999999, -25.100000000000012, -12.5, -8.399999999999999, -14.299999999999997, -28.200000000000006, -6.2, -12.099999999999996, -7.300000000000001, -19.799999999999997, -4.300000000000001, -13.999999999999973, -19.2, -5.5, -8.3, -24.7, -34.200000000000074, -11.7, -7.300000000000001, -25.3, -9.399999999999999, -20.50000000000006, -24.2, -12.999999999999998, -8.3, -4.3, -6.300000000000001, -14.099999999999977, -11.799999999999999, -6.300000000000001, -15.699999999999998, -5.3, -7.1, -6.799999999999999, -22.300000000000008, -10.399999999999999, -10.7, -5.1, -19.799999999999997, -14.999999999999995, -3.3, -4.2, -21.5, -14.5, -5.2, -7.799999999999999, -5.3, -5.4, -4.300000000000001, -15.1, -8.2, -5.2, -8.2, -61.3, -10.3, -3.3, -18.199999999999996, -24.900000000000006, -11.7, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0676316333422917, "mean_inference_ms": 1.4174872500710185, "mean_action_processing_ms": 0.07656957981161594, "mean_env_wait_ms": 6.441686580674161, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2780000, "timesteps_this_iter": 0, "agent_timesteps_total": 2780000, "timers": {"sample_time_ms": 16414.828, "sample_throughput": 243.682, "load_time_ms": 0.352, "load_throughput": 11349760.52, "learn_time_ms": 7946.191, "learn_throughput": 503.386, "update_time_ms": 1.791}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.14078799049640375, "policy_loss": -0.028620616330574916, "vf_loss": 16.801741131403112, "vf_explained_var": 0.2127520320236042, "kl": 0.012366223497084576, "entropy": 0.2756204110880693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2780000, "num_agent_steps_sampled": 2780000, "num_steps_trained": 2780000, "num_agent_steps_trained": 2780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 27960, "training_iteration": 695, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-46-29", "timestamp": 1643708789, "time_this_iter_s": 16.44117498397827, "time_total_s": 17813.845005750656, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5554.3361287117, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 29.7304347826087, "ram_util_percent": 63.1478260869565}}
{"episode_reward_max": -3.3, "episode_reward_min": -61.3, "episode_reward_mean": -12.577, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.799999999999999, -25.100000000000012, -12.5, -8.399999999999999, -14.299999999999997, -28.200000000000006, -6.2, -12.099999999999996, -7.300000000000001, -19.799999999999997, -4.300000000000001, -13.999999999999973, -19.2, -5.5, -8.3, -24.7, -34.200000000000074, -11.7, -7.300000000000001, -25.3, -9.399999999999999, -20.50000000000006, -24.2, -12.999999999999998, -8.3, -4.3, -6.300000000000001, -14.099999999999977, -11.799999999999999, -6.300000000000001, -15.699999999999998, -5.3, -7.1, -6.799999999999999, -22.300000000000008, -10.399999999999999, -10.7, -5.1, -19.799999999999997, -14.999999999999995, -3.3, -4.2, -21.5, -14.5, -5.2, -7.799999999999999, -5.3, -5.4, -4.300000000000001, -15.1, -8.2, -5.2, -8.2, -61.3, -10.3, -3.3, -18.199999999999996, -24.900000000000006, -11.7, -5.4, -6.299999999999999, -5.3, -5.3999999999999995, -20.600000000000005, -11.6, -7.2, -13.1, -17.799999999999997, -5.9, -11.6, -5.4, -11.2, -14.5, -18.6, -10.899999999999999, -11.2, -10.7, -21.4, -6.300000000000001, -6.300000000000001, -5.9, -20.70000000000001, -9.599999999999998, -4.4, -13.0, -6.2, -13.399999999999999, -25.90000000000002, -16.6, -6.300000000000001, -7.100000000000001, -4.2, -19.4, -11.8, -22.6, -6.3999999999999995, -21.3, -4.3, -17.9, -19.500000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.067301690335265, "mean_inference_ms": 1.416965239939389, "mean_action_processing_ms": 0.07654172063601554, "mean_env_wait_ms": 6.439159602371793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2784000, "timesteps_this_iter": 0, "agent_timesteps_total": 2784000, "timers": {"sample_time_ms": 16287.128, "sample_throughput": 245.593, "load_time_ms": 0.339, "load_throughput": 11791689.626, "learn_time_ms": 7875.505, "learn_throughput": 507.904, "update_time_ms": 1.724}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.09507294146028618, "policy_loss": -0.022068877308379097, "vf_loss": 11.57174406449, "vf_explained_var": 0.1330510913684804, "kl": 0.012661166136617793, "entropy": 0.30362820910510196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2784000, "num_agent_steps_sampled": 2784000, "num_steps_trained": 2784000, "num_agent_steps_trained": 2784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28000, "training_iteration": 696, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-46-45", "timestamp": 1643708805, "time_this_iter_s": 15.973260879516602, "time_total_s": 17829.818266630173, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5570.309389591217, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 27.98695652173913, "ram_util_percent": 63.1086956521739}}
{"episode_reward_max": -3.3, "episode_reward_min": -61.3, "episode_reward_mean": -11.861, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -4.2, -21.5, -14.5, -5.2, -7.799999999999999, -5.3, -5.4, -4.300000000000001, -15.1, -8.2, -5.2, -8.2, -61.3, -10.3, -3.3, -18.199999999999996, -24.900000000000006, -11.7, -5.4, -6.299999999999999, -5.3, -5.3999999999999995, -20.600000000000005, -11.6, -7.2, -13.1, -17.799999999999997, -5.9, -11.6, -5.4, -11.2, -14.5, -18.6, -10.899999999999999, -11.2, -10.7, -21.4, -6.300000000000001, -6.300000000000001, -5.9, -20.70000000000001, -9.599999999999998, -4.4, -13.0, -6.2, -13.399999999999999, -25.90000000000002, -16.6, -6.300000000000001, -7.100000000000001, -4.2, -19.4, -11.8, -22.6, -6.3999999999999995, -21.3, -4.3, -17.9, -19.500000000000007, -6.700000000000001, -4.800000000000001, -8.399999999999997, -3.8000000000000003, -9.4, -7.3, -13.899999999999997, -9.999999999999998, -9.2, -12.1, -24.100000000000005, -16.4, -16.9, -10.7, -4.4, -6.4, -20.000000000000007, -6.9, -3.7000000000000006, -5.4, -3.4, -15.99999999999999, -4.2, -4.300000000000001, -5.300000000000001, -11.799999999999997, -21.299999999999983, -21.7, -5.3, -4.300000000000001, -6.300000000000001, -5.4, -4.300000000000001, -44.4, -5.4, -13.599999999999998, -8.7, -9.099999999999998, -26.3, -43.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0670914138126515, "mean_inference_ms": 1.4164675867304541, "mean_action_processing_ms": 0.07651465914273492, "mean_env_wait_ms": 6.436698243654414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2788000, "timesteps_this_iter": 0, "agent_timesteps_total": 2788000, "timers": {"sample_time_ms": 16225.512, "sample_throughput": 246.525, "load_time_ms": 0.353, "load_throughput": 11317603.886, "learn_time_ms": 7977.038, "learn_throughput": 501.439, "update_time_ms": 1.701}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.1279815460935796, "policy_loss": -0.041508307658456346, "vf_loss": 16.766953062882987, "vf_explained_var": 0.05943965232500466, "kl": 0.016180678109764833, "entropy": 0.27663603345713306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2788000, "num_agent_steps_sampled": 2788000, "num_steps_trained": 2788000, "num_agent_steps_trained": 2788000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28040, "training_iteration": 697, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-47-02", "timestamp": 1643708822, "time_this_iter_s": 17.442879915237427, "time_total_s": 17847.26114654541, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5587.7522695064545, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 33.876, "ram_util_percent": 63.10000000000001}}
{"episode_reward_max": -3.4, "episode_reward_min": -44.4, "episode_reward_mean": -12.153999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.9, -20.70000000000001, -9.599999999999998, -4.4, -13.0, -6.2, -13.399999999999999, -25.90000000000002, -16.6, -6.300000000000001, -7.100000000000001, -4.2, -19.4, -11.8, -22.6, -6.3999999999999995, -21.3, -4.3, -17.9, -19.500000000000007, -6.700000000000001, -4.800000000000001, -8.399999999999997, -3.8000000000000003, -9.4, -7.3, -13.899999999999997, -9.999999999999998, -9.2, -12.1, -24.100000000000005, -16.4, -16.9, -10.7, -4.4, -6.4, -20.000000000000007, -6.9, -3.7000000000000006, -5.4, -3.4, -15.99999999999999, -4.2, -4.300000000000001, -5.300000000000001, -11.799999999999997, -21.299999999999983, -21.7, -5.3, -4.300000000000001, -6.300000000000001, -5.4, -4.300000000000001, -44.4, -5.4, -13.599999999999998, -8.7, -9.099999999999998, -26.3, -43.4, -13.899999999999997, -16.899999999999974, -3.7, -10.8, -8.4, -5.0, -18.4, -3.7, -20.2, -13.1, -5.4, -7.1, -3.4, -5.2, -6.300000000000001, -4.300000000000001, -4.2, -6.2, -10.399999999999999, -5.0, -16.2, -4.3, -32.40000000000001, -15.799999999999997, -40.39999999999992, -4.2, -42.3, -11.2, -12.999999999999998, -4.3, -17.5, -11.599999999999998, -6.2, -16.099999999999998, -27.00000000000001, -9.4, -11.7, -13.799999999999999, -11.399999999999995, -13.499999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0668828264007033, "mean_inference_ms": 1.416095710915032, "mean_action_processing_ms": 0.07649436496173602, "mean_env_wait_ms": 6.434828011758413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2792000, "timesteps_this_iter": 0, "agent_timesteps_total": 2792000, "timers": {"sample_time_ms": 16399.581, "sample_throughput": 243.909, "load_time_ms": 0.354, "load_throughput": 11298549.397, "learn_time_ms": 8055.527, "learn_throughput": 496.554, "update_time_ms": 1.718}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.14101538638614358, "policy_loss": -0.024394082017643478, "vf_loss": 16.39791431106547, "vf_explained_var": 0.07452784353686917, "kl": 0.01271401604687995, "entropy": 0.28296785187176476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2792000, "num_agent_steps_sampled": 2792000, "num_steps_trained": 2792000, "num_agent_steps_trained": 2792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28080, "training_iteration": 698, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-47-19", "timestamp": 1643708839, "time_this_iter_s": 16.78259825706482, "time_total_s": 17864.043744802475, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5604.534867763519, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 29.729166666666668, "ram_util_percent": 63.24583333333334}}
{"episode_reward_max": -3.4, "episode_reward_min": -69.09999999999997, "episode_reward_mean": -12.609999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -15.99999999999999, -4.2, -4.300000000000001, -5.300000000000001, -11.799999999999997, -21.299999999999983, -21.7, -5.3, -4.300000000000001, -6.300000000000001, -5.4, -4.300000000000001, -44.4, -5.4, -13.599999999999998, -8.7, -9.099999999999998, -26.3, -43.4, -13.899999999999997, -16.899999999999974, -3.7, -10.8, -8.4, -5.0, -18.4, -3.7, -20.2, -13.1, -5.4, -7.1, -3.4, -5.2, -6.300000000000001, -4.300000000000001, -4.2, -6.2, -10.399999999999999, -5.0, -16.2, -4.3, -32.40000000000001, -15.799999999999997, -40.39999999999992, -4.2, -42.3, -11.2, -12.999999999999998, -4.3, -17.5, -11.599999999999998, -6.2, -16.099999999999998, -27.00000000000001, -9.4, -11.7, -13.799999999999999, -11.399999999999995, -13.499999999999996, -4.3, -69.09999999999997, -9.1, -3.7, -10.5, -4.4, -4.300000000000001, -4.2, -8.9, -19.900000000000013, -20.6, -7.399999999999999, -18.799999999999997, -6.4, -17.5, -13.899999999999999, -10.400000000000002, -5.4, -17.199999999999996, -19.3, -4.2, -20.1, -25.4, -13.799999999999997, -5.0, -9.099999999999998, -4.4, -9.299999999999999, -5.1, -4.4, -17.5, -6.800000000000001, -4.3, -13.899999999999999, -16.7, -11.799999999999999, -7.300000000000001, -15.6, -28.299999999999997, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0667765297388732, "mean_inference_ms": 1.4157419695667466, "mean_action_processing_ms": 0.0764759378287235, "mean_env_wait_ms": 6.433100654511966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2796000, "timesteps_this_iter": 0, "agent_timesteps_total": 2796000, "timers": {"sample_time_ms": 16566.566, "sample_throughput": 241.45, "load_time_ms": 0.353, "load_throughput": 11334425.078, "learn_time_ms": 7973.53, "learn_throughput": 501.66, "update_time_ms": 1.682}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.22481780520450043, "policy_loss": -0.01916176769982583, "vf_loss": 24.293862203116056, "vf_explained_var": -0.00524177538451328, "kl": 0.009252952503010552, "entropy": 0.27536844525846743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2796000, "num_agent_steps_sampled": 2796000, "num_steps_trained": 2796000, "num_agent_steps_trained": 2796000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28120, "training_iteration": 699, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-47-35", "timestamp": 1643708855, "time_this_iter_s": 16.291649103164673, "time_total_s": 17880.33539390564, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5620.826516866684, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 38.1304347826087, "ram_util_percent": 63.300000000000004}}
{"episode_reward_max": -2.5, "episode_reward_min": -69.09999999999997, "episode_reward_mean": -13.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.2, -4.3, -32.40000000000001, -15.799999999999997, -40.39999999999992, -4.2, -42.3, -11.2, -12.999999999999998, -4.3, -17.5, -11.599999999999998, -6.2, -16.099999999999998, -27.00000000000001, -9.4, -11.7, -13.799999999999999, -11.399999999999995, -13.499999999999996, -4.3, -69.09999999999997, -9.1, -3.7, -10.5, -4.4, -4.300000000000001, -4.2, -8.9, -19.900000000000013, -20.6, -7.399999999999999, -18.799999999999997, -6.4, -17.5, -13.899999999999999, -10.400000000000002, -5.4, -17.199999999999996, -19.3, -4.2, -20.1, -25.4, -13.799999999999997, -5.0, -9.099999999999998, -4.4, -9.299999999999999, -5.1, -4.4, -17.5, -6.800000000000001, -4.3, -13.899999999999999, -16.7, -11.799999999999999, -7.300000000000001, -15.6, -28.299999999999997, -4.300000000000001, -9.0, -3.8000000000000003, -9.100000000000001, -3.4, -4.300000000000001, -6.300000000000001, -5.300000000000001, -3.4, -16.4, -13.499999999999998, -28.20000000000001, -3.6, -36.3, -7.899999999999999, -16.699999999999992, -11.299999999999999, -24.099999999999994, -9.8, -4.4, -11.099999999999998, -10.0, -11.5, -15.799999999999999, -9.3, -20.400000000000006, -6.800000000000001, -3.4, -13.0, -3.5, -3.3, -15.8, -5.4, -8.799999999999999, -14.799999999999997, -4.2, -14.399999999999999, -2.5, -21.30000000000003, -14.700000000000001, -65.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.066515823359561, "mean_inference_ms": 1.415325910439472, "mean_action_processing_ms": 0.07645419331079793, "mean_env_wait_ms": 6.431105724902165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2800000, "timesteps_this_iter": 0, "agent_timesteps_total": 2800000, "timers": {"sample_time_ms": 16504.866, "sample_throughput": 242.353, "load_time_ms": 0.358, "load_throughput": 11163971.254, "learn_time_ms": 8121.465, "learn_throughput": 492.522, "update_time_ms": 1.696}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.17595948092764624, "policy_loss": -0.04147809692408128, "vf_loss": 21.618647959539967, "vf_explained_var": 0.13651504029509842, "kl": 0.011120883510950213, "entropy": 0.2862087631097404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2800000, "num_agent_steps_sampled": 2800000, "num_steps_trained": 2800000, "num_agent_steps_trained": 2800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28160, "training_iteration": 700, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-47-53", "timestamp": 1643708873, "time_this_iter_s": 17.449029207229614, "time_total_s": 17897.78442311287, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5638.275546073914, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 39.512, "ram_util_percent": 63.296000000000014}}
{"episode_reward_max": -2.5, "episode_reward_min": -65.3, "episode_reward_mean": -11.591999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -20.1, -25.4, -13.799999999999997, -5.0, -9.099999999999998, -4.4, -9.299999999999999, -5.1, -4.4, -17.5, -6.800000000000001, -4.3, -13.899999999999999, -16.7, -11.799999999999999, -7.300000000000001, -15.6, -28.299999999999997, -4.300000000000001, -9.0, -3.8000000000000003, -9.100000000000001, -3.4, -4.300000000000001, -6.300000000000001, -5.300000000000001, -3.4, -16.4, -13.499999999999998, -28.20000000000001, -3.6, -36.3, -7.899999999999999, -16.699999999999992, -11.299999999999999, -24.099999999999994, -9.8, -4.4, -11.099999999999998, -10.0, -11.5, -15.799999999999999, -9.3, -20.400000000000006, -6.800000000000001, -3.4, -13.0, -3.5, -3.3, -15.8, -5.4, -8.799999999999999, -14.799999999999997, -4.2, -14.399999999999999, -2.5, -21.30000000000003, -14.700000000000001, -65.3, -4.4, -7.300000000000001, -24.4, -11.299999999999999, -4.4, -11.2, -13.699999999999998, -9.999999999999998, -3.2, -8.4, -26.7, -4.300000000000001, -21.3, -15.599999999999998, -30.3, -6.4, -5.300000000000001, -3.4, -17.3, -3.2, -6.700000000000001, -19.1, -3.3, -16.799999999999997, -12.799999999999997, -8.9, -3.3, -14.799999999999999, -23.20000000000001, -7.5, -4.4, -24.6, -4.4, -5.300000000000001, -6.2, -5.2, -5.300000000000001, -19.300000000000008, -3.3, -13.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0664134546978021, "mean_inference_ms": 1.415153285485976, "mean_action_processing_ms": 0.07644501359050489, "mean_env_wait_ms": 6.430277692819207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2804000, "timesteps_this_iter": 0, "agent_timesteps_total": 2804000, "timers": {"sample_time_ms": 16811.307, "sample_throughput": 237.935, "load_time_ms": 0.361, "load_throughput": 11086510.276, "learn_time_ms": 8069.189, "learn_throughput": 495.713, "update_time_ms": 1.682}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.102200959660914, "policy_loss": -0.011763852720539416, "vf_loss": 11.26702375770897, "vf_explained_var": 0.2049872778436189, "kl": 0.011507356598174345, "entropy": 0.22249721682840778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2804000, "num_agent_steps_sampled": 2804000, "num_steps_trained": 2804000, "num_agent_steps_trained": 2804000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28200, "training_iteration": 701, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-48-10", "timestamp": 1643708890, "time_this_iter_s": 17.511746883392334, "time_total_s": 17915.29616999626, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5655.787292957306, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 40.96799999999999, "ram_util_percent": 63.16400000000001}}
{"episode_reward_max": -2.5, "episode_reward_min": -110.89999999999986, "episode_reward_mean": -13.325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -11.5, -15.799999999999999, -9.3, -20.400000000000006, -6.800000000000001, -3.4, -13.0, -3.5, -3.3, -15.8, -5.4, -8.799999999999999, -14.799999999999997, -4.2, -14.399999999999999, -2.5, -21.30000000000003, -14.700000000000001, -65.3, -4.4, -7.300000000000001, -24.4, -11.299999999999999, -4.4, -11.2, -13.699999999999998, -9.999999999999998, -3.2, -8.4, -26.7, -4.300000000000001, -21.3, -15.599999999999998, -30.3, -6.4, -5.300000000000001, -3.4, -17.3, -3.2, -6.700000000000001, -19.1, -3.3, -16.799999999999997, -12.799999999999997, -8.9, -3.3, -14.799999999999999, -23.20000000000001, -7.5, -4.4, -24.6, -4.4, -5.300000000000001, -6.2, -5.2, -5.300000000000001, -19.300000000000008, -3.3, -13.299999999999999, -15.999999999999998, -44.2, -15.099999999999996, -10.7, -4.4, -8.799999999999999, -3.2, -14.199999999999998, -20.2, -30.3, -15.299999999999999, -18.999999999999996, -15.7, -11.7, -6.2, -18.5, -11.2, -8.899999999999999, -4.300000000000001, -4.4, -12.099999999999998, -4.2, -21.90000000000001, -4.2, -8.999999999999998, -4.1, -4.3, -110.89999999999986, -8.299999999999999, -16.299999999999997, -4.300000000000001, -5.4, -44.4, -17.299999999999997, -4.300000000000001, -19.799999999999997, -12.399999999999999, -9.799999999999999, -24.3, -8.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.066249329139329, "mean_inference_ms": 1.414900827336544, "mean_action_processing_ms": 0.07643119618930969, "mean_env_wait_ms": 6.428990056509935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2808000, "timesteps_this_iter": 0, "agent_timesteps_total": 2808000, "timers": {"sample_time_ms": 16665.61, "sample_throughput": 240.015, "load_time_ms": 0.35, "load_throughput": 11413072.109, "learn_time_ms": 8019.576, "learn_throughput": 498.779, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.684664075726503, "policy_loss": -0.016743063039937486, "vf_loss": 70.01407296901108, "vf_explained_var": 0.09185563281018247, "kl": 0.011257157728768964, "entropy": 0.25254103218515717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2808000, "num_agent_steps_sampled": 2808000, "num_steps_trained": 2808000, "num_agent_steps_trained": 2808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28240, "training_iteration": 702, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-48-26", "timestamp": 1643708906, "time_this_iter_s": 15.904891967773438, "time_total_s": 17931.201061964035, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5671.692184925079, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 31.286956521739132, "ram_util_percent": 63.16956521739128}}
{"episode_reward_max": -3.2, "episode_reward_min": -110.89999999999986, "episode_reward_mean": -11.925, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.700000000000001, -19.1, -3.3, -16.799999999999997, -12.799999999999997, -8.9, -3.3, -14.799999999999999, -23.20000000000001, -7.5, -4.4, -24.6, -4.4, -5.300000000000001, -6.2, -5.2, -5.300000000000001, -19.300000000000008, -3.3, -13.299999999999999, -15.999999999999998, -44.2, -15.099999999999996, -10.7, -4.4, -8.799999999999999, -3.2, -14.199999999999998, -20.2, -30.3, -15.299999999999999, -18.999999999999996, -15.7, -11.7, -6.2, -18.5, -11.2, -8.899999999999999, -4.300000000000001, -4.4, -12.099999999999998, -4.2, -21.90000000000001, -4.2, -8.999999999999998, -4.1, -4.3, -110.89999999999986, -8.299999999999999, -16.299999999999997, -4.300000000000001, -5.4, -44.4, -17.299999999999997, -4.300000000000001, -19.799999999999997, -12.399999999999999, -9.799999999999999, -24.3, -8.899999999999999, -6.3, -25.40000000000001, -4.4, -19.4, -6.1, -6.2, -14.699999999999998, -6.4, -5.4, -8.1, -6.300000000000001, -5.2, -4.4, -22.9, -9.0, -16.7, -4.2, -21.5, -18.7, -7.3, -3.2, -4.300000000000001, -12.199999999999998, -3.2, -4.9, -4.4, -8.799999999999999, -5.300000000000001, -23.6, -4.9, -5.300000000000001, -3.4, -11.9, -11.0, -3.2, -3.3, -4.4, -5.300000000000001, -11.7, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.066084331231089, "mean_inference_ms": 1.414648730322326, "mean_action_processing_ms": 0.07641764686743877, "mean_env_wait_ms": 6.427866442040662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2812000, "timesteps_this_iter": 0, "agent_timesteps_total": 2812000, "timers": {"sample_time_ms": 16710.536, "sample_throughput": 239.37, "load_time_ms": 0.352, "load_throughput": 11352064.416, "learn_time_ms": 8125.01, "learn_throughput": 492.307, "update_time_ms": 1.723}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.034573866500048546, "policy_loss": -0.034577960995656826, "vf_loss": 6.5915403396692325, "vf_explained_var": 0.2625975103788478, "kl": 0.028768234131415896, "entropy": 0.2429857045291893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2812000, "num_agent_steps_sampled": 2812000, "num_steps_trained": 2812000, "num_agent_steps_trained": 2812000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28280, "training_iteration": 703, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-48-44", "timestamp": 1643708924, "time_this_iter_s": 18.278287172317505, "time_total_s": 17949.479349136353, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5689.970472097397, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 37.9, "ram_util_percent": 62.65384615384615}}
{"episode_reward_max": -2.2, "episode_reward_min": -110.89999999999986, "episode_reward_mean": -12.402999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.099999999999998, -4.2, -21.90000000000001, -4.2, -8.999999999999998, -4.1, -4.3, -110.89999999999986, -8.299999999999999, -16.299999999999997, -4.300000000000001, -5.4, -44.4, -17.299999999999997, -4.300000000000001, -19.799999999999997, -12.399999999999999, -9.799999999999999, -24.3, -8.899999999999999, -6.3, -25.40000000000001, -4.4, -19.4, -6.1, -6.2, -14.699999999999998, -6.4, -5.4, -8.1, -6.300000000000001, -5.2, -4.4, -22.9, -9.0, -16.7, -4.2, -21.5, -18.7, -7.3, -3.2, -4.300000000000001, -12.199999999999998, -3.2, -4.9, -4.4, -8.799999999999999, -5.300000000000001, -23.6, -4.9, -5.300000000000001, -3.4, -11.9, -11.0, -3.2, -3.3, -4.4, -5.300000000000001, -11.7, -3.4, -7.3, -8.3, -9.5, -11.2, -16.5, -6.0, -13.3, -4.6000000000000005, -16.5, -10.599999999999996, -2.2, -12.299999999999997, -7.8, -11.2, -12.2, -11.8, -8.799999999999999, -18.5, -9.3, -23.7, -14.2, -14.299999999999997, -5.3, -11.499999999999998, -34.10000000000002, -9.99999999999999, -9.2, -11.2, -9.4, -41.3, -13.4, -13.2, -6.599999999999999, -5.4, -11.4, -6.2, -9.5, -61.2, -8.1, -20.699999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0658410354052577, "mean_inference_ms": 1.4142104714691142, "mean_action_processing_ms": 0.07639351674393496, "mean_env_wait_ms": 6.42587383938102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2816000, "timesteps_this_iter": 0, "agent_timesteps_total": 2816000, "timers": {"sample_time_ms": 16778.574, "sample_throughput": 238.399, "load_time_ms": 0.355, "load_throughput": 11277284.399, "learn_time_ms": 8152.594, "learn_throughput": 490.641, "update_time_ms": 1.657}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.21213931284409257, "policy_loss": -0.020481296397635452, "vf_loss": 23.045578904818463, "vf_explained_var": 0.04503825870893335, "kl": 0.012828605891721663, "entropy": 0.304267631999908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2816000, "num_agent_steps_sampled": 2816000, "num_steps_trained": 2816000, "num_agent_steps_trained": 2816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28320, "training_iteration": 704, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-49-00", "timestamp": 1643708940, "time_this_iter_s": 15.68099308013916, "time_total_s": 17965.16034221649, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5705.651465177536, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 39.509090909090915, "ram_util_percent": 62.677272727272744}}
{"episode_reward_max": -1.3, "episode_reward_min": -88.40000000000008, "episode_reward_mean": -12.400000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -4.300000000000001, -12.199999999999998, -3.2, -4.9, -4.4, -8.799999999999999, -5.300000000000001, -23.6, -4.9, -5.300000000000001, -3.4, -11.9, -11.0, -3.2, -3.3, -4.4, -5.300000000000001, -11.7, -3.4, -7.3, -8.3, -9.5, -11.2, -16.5, -6.0, -13.3, -4.6000000000000005, -16.5, -10.599999999999996, -2.2, -12.299999999999997, -7.8, -11.2, -12.2, -11.8, -8.799999999999999, -18.5, -9.3, -23.7, -14.2, -14.299999999999997, -5.3, -11.499999999999998, -34.10000000000002, -9.99999999999999, -9.2, -11.2, -9.4, -41.3, -13.4, -13.2, -6.599999999999999, -5.4, -11.4, -6.2, -9.5, -61.2, -8.1, -20.699999999999996, -21.700000000000003, -16.799999999999997, -10.1, -19.9, -10.600000000000001, -5.2, -6.4, -9.200000000000001, -1.3, -10.999999999999984, -10.299999999999999, -12.899999999999997, -41.3, -7.300000000000001, -12.3, -12.3, -20.1, -7.4, -19.799999999999997, -12.799999999999997, -15.2, -15.299999999999999, -88.40000000000008, -3.2, -6.3999999999999995, -13.699999999999996, -12.1, -9.3, -15.899999999999997, -6.2, -9.899999999999997, -15.3, -9.4, -23.500000000000004, -8.3, -10.3, -6.499999999999999, -5.300000000000001, -11.2, -10.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.065658222636962, "mean_inference_ms": 1.413829282051833, "mean_action_processing_ms": 0.07637337820039546, "mean_env_wait_ms": 6.424035536043075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2820000, "timesteps_this_iter": 0, "agent_timesteps_total": 2820000, "timers": {"sample_time_ms": 16817.225, "sample_throughput": 237.851, "load_time_ms": 0.355, "load_throughput": 11255344.157, "learn_time_ms": 8233.822, "learn_throughput": 485.801, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4437560413288133, "policy_loss": -0.029557753390362186, "vf_loss": 47.110555061730004, "vf_explained_var": 0.04798777910970872, "kl": 0.013085949487473181, "entropy": 0.28884081409503054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2820000, "num_agent_steps_sampled": 2820000, "num_steps_trained": 2820000, "num_agent_steps_trained": 2820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28360, "training_iteration": 705, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-49-18", "timestamp": 1643708958, "time_this_iter_s": 17.360158920288086, "time_total_s": 17982.52050113678, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5723.011624097824, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 35.652, "ram_util_percent": 62.328}}
{"episode_reward_max": -1.3, "episode_reward_min": -88.40000000000008, "episode_reward_mean": -13.789000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -14.299999999999997, -5.3, -11.499999999999998, -34.10000000000002, -9.99999999999999, -9.2, -11.2, -9.4, -41.3, -13.4, -13.2, -6.599999999999999, -5.4, -11.4, -6.2, -9.5, -61.2, -8.1, -20.699999999999996, -21.700000000000003, -16.799999999999997, -10.1, -19.9, -10.600000000000001, -5.2, -6.4, -9.200000000000001, -1.3, -10.999999999999984, -10.299999999999999, -12.899999999999997, -41.3, -7.300000000000001, -12.3, -12.3, -20.1, -7.4, -19.799999999999997, -12.799999999999997, -15.2, -15.299999999999999, -88.40000000000008, -3.2, -6.3999999999999995, -13.699999999999996, -12.1, -9.3, -15.899999999999997, -6.2, -9.899999999999997, -15.3, -9.4, -23.500000000000004, -8.3, -10.3, -6.499999999999999, -5.300000000000001, -11.2, -10.4, -15.199999999999996, -13.5, -10.2, -17.0, -19.899999999999988, -9.4, -11.799999999999999, -5.7, -8.3, -18.2, -12.299999999999999, -8.7, -22.6, -13.3, -6.2, -20.6, -12.199999999999998, -5.1, -13.3, -7.0, -8.399999999999999, -21.299999999999997, -9.4, -7.300000000000001, -22.800000000000008, -11.899999999999999, -17.9, -4.300000000000001, -20.4, -7.799999999999999, -8.599999999999998, -7.3, -18.3, -14.299999999999997, -16.099999999999998, -7.4, -3.7, -14.199999999999998, -11.0, -15.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0653585177659244, "mean_inference_ms": 1.4133831030317787, "mean_action_processing_ms": 0.07634952163608187, "mean_env_wait_ms": 6.421763366877826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2824000, "timesteps_this_iter": 0, "agent_timesteps_total": 2824000, "timers": {"sample_time_ms": 16927.599, "sample_throughput": 236.3, "load_time_ms": 0.364, "load_throughput": 10988483.102, "learn_time_ms": 8284.601, "learn_throughput": 482.824, "update_time_ms": 1.683}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08523776567420892, "policy_loss": -0.02675480541162273, "vf_loss": 11.001354999952419, "vf_explained_var": 0.08122109213183003, "kl": 0.011727546389079841, "entropy": 0.27906593552199743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2824000, "num_agent_steps_sampled": 2824000, "num_steps_trained": 2824000, "num_agent_steps_trained": 2824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28400, "training_iteration": 706, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-49-34", "timestamp": 1643708974, "time_this_iter_s": 16.784119844436646, "time_total_s": 17999.304620981216, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5739.795743942261, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 30.34166666666667, "ram_util_percent": 62.29583333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -88.40000000000008, "episode_reward_mean": -14.66, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.2, -15.299999999999999, -88.40000000000008, -3.2, -6.3999999999999995, -13.699999999999996, -12.1, -9.3, -15.899999999999997, -6.2, -9.899999999999997, -15.3, -9.4, -23.500000000000004, -8.3, -10.3, -6.499999999999999, -5.300000000000001, -11.2, -10.4, -15.199999999999996, -13.5, -10.2, -17.0, -19.899999999999988, -9.4, -11.799999999999999, -5.7, -8.3, -18.2, -12.299999999999999, -8.7, -22.6, -13.3, -6.2, -20.6, -12.199999999999998, -5.1, -13.3, -7.0, -8.399999999999999, -21.299999999999997, -9.4, -7.300000000000001, -22.800000000000008, -11.899999999999999, -17.9, -4.300000000000001, -20.4, -7.799999999999999, -8.599999999999998, -7.3, -18.3, -14.299999999999997, -16.099999999999998, -7.4, -3.7, -14.199999999999998, -11.0, -15.3, -6.3, -28.900000000000016, -7.7, -10.4, -29.10000000000004, -9.3, -16.799999999999997, -11.600000000000001, -6.800000000000001, -20.2, -12.199999999999998, -28.100000000000012, -18.2, -52.2, -10.200000000000001, -16.9, -9.3, -18.2, -7.2, -13.499999999999998, -14.2, -10.3, -50.3, -15.3, -8.4, -19.5, -9.1, -12.4, -6.4, -16.099999999999994, -15.2, -17.9, -35.89999999999998, -12.399999999999999, -3.2, -21.900000000000006, -38.20000000000006, -7.699999999999999, -11.2, -13.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.06523836057349, "mean_inference_ms": 1.4132652980901872, "mean_action_processing_ms": 0.07634566220018851, "mean_env_wait_ms": 6.421152122428228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2828000, "timesteps_this_iter": 0, "agent_timesteps_total": 2828000, "timers": {"sample_time_ms": 17140.734, "sample_throughput": 233.362, "load_time_ms": 0.351, "load_throughput": 11395242.817, "learn_time_ms": 8326.362, "learn_throughput": 480.402, "update_time_ms": 1.759}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.24214712863447524, "policy_loss": -0.023499280428614027, "vf_loss": 26.391178225830036, "vf_explained_var": 0.1284464632952085, "kl": 0.010279323330393003, "entropy": 0.31390714126248515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2828000, "num_agent_steps_sampled": 2828000, "num_steps_trained": 2828000, "num_agent_steps_trained": 2828000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28440, "training_iteration": 707, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-49-54", "timestamp": 1643708994, "time_this_iter_s": 19.459253072738647, "time_total_s": 18018.763874053955, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5759.254997014999, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 48.457142857142856, "ram_util_percent": 62.67857142857143}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.2, "episode_reward_mean": -14.009, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.399999999999999, -21.299999999999997, -9.4, -7.300000000000001, -22.800000000000008, -11.899999999999999, -17.9, -4.300000000000001, -20.4, -7.799999999999999, -8.599999999999998, -7.3, -18.3, -14.299999999999997, -16.099999999999998, -7.4, -3.7, -14.199999999999998, -11.0, -15.3, -6.3, -28.900000000000016, -7.7, -10.4, -29.10000000000004, -9.3, -16.799999999999997, -11.600000000000001, -6.800000000000001, -20.2, -12.199999999999998, -28.100000000000012, -18.2, -52.2, -10.200000000000001, -16.9, -9.3, -18.2, -7.2, -13.499999999999998, -14.2, -10.3, -50.3, -15.3, -8.4, -19.5, -9.1, -12.4, -6.4, -16.099999999999994, -15.2, -17.9, -35.89999999999998, -12.399999999999999, -3.2, -21.900000000000006, -38.20000000000006, -7.699999999999999, -11.2, -13.3, -10.3, -8.2, -19.1, -8.2, -11.2, -7.999999999999998, -10.8, -20.6, -11.3, -8.2, -3.3, -31.80000000000001, -13.8, -10.299999999999999, -19.699999999999996, -6.299999999999999, -9.3, -12.2, -13.4, -13.100000000000001, -6.2, -10.0, -8.3, -16.2, -16.9, -9.3, -6.3, -11.7, -5.2, -15.499999999999996, -8.600000000000001, -9.999999999999996, -13.099999999999998, -8.4, -15.4, -25.6, -6.300000000000001, -12.2, -16.4, -10.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0652250931404028, "mean_inference_ms": 1.4132140691901713, "mean_action_processing_ms": 0.07634560468617148, "mean_env_wait_ms": 6.420955653064798, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2832000, "timesteps_this_iter": 0, "agent_timesteps_total": 2832000, "timers": {"sample_time_ms": 17187.303, "sample_throughput": 232.73, "load_time_ms": 0.351, "load_throughput": 11395242.817, "learn_time_ms": 8442.869, "learn_throughput": 473.773, "update_time_ms": 1.782}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07938930888995728, "policy_loss": -0.018607433341062997, "vf_loss": 9.513924879797043, "vf_explained_var": 0.221333783993157, "kl": 0.01693332322285834, "entropy": 0.2873323526113264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2832000, "num_agent_steps_sampled": 2832000, "num_steps_trained": 2832000, "num_agent_steps_trained": 2832000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28480, "training_iteration": 708, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-50-12", "timestamp": 1643709012, "time_this_iter_s": 17.988879919052124, "time_total_s": 18036.752753973007, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5777.2438769340515, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 33.48, "ram_util_percent": 62.764}}
{"episode_reward_max": -3.2, "episode_reward_min": -50.3, "episode_reward_mean": -12.777000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -10.3, -50.3, -15.3, -8.4, -19.5, -9.1, -12.4, -6.4, -16.099999999999994, -15.2, -17.9, -35.89999999999998, -12.399999999999999, -3.2, -21.900000000000006, -38.20000000000006, -7.699999999999999, -11.2, -13.3, -10.3, -8.2, -19.1, -8.2, -11.2, -7.999999999999998, -10.8, -20.6, -11.3, -8.2, -3.3, -31.80000000000001, -13.8, -10.299999999999999, -19.699999999999996, -6.299999999999999, -9.3, -12.2, -13.4, -13.100000000000001, -6.2, -10.0, -8.3, -16.2, -16.9, -9.3, -6.3, -11.7, -5.2, -15.499999999999996, -8.600000000000001, -9.999999999999996, -13.099999999999998, -8.4, -15.4, -25.6, -6.300000000000001, -12.2, -16.4, -10.5, -11.999999999999998, -9.2, -13.099999999999998, -4.4, -12.599999999999998, -6.2, -13.899999999999997, -3.6000000000000005, -13.299999999999983, -5.3, -11.7, -33.2, -16.7, -5.2, -19.80000000000001, -13.6, -5.2, -6.300000000000001, -11.600000000000001, -9.4, -15.1, -17.3, -16.2, -6.5, -8.4, -11.2, -8.3, -8.299999999999997, -7.800000000000001, -20.099999999999998, -3.3, -10.700000000000001, -20.5, -11.1, -12.899999999999997, -11.999999999999993, -6.2, -18.900000000000002, -5.3, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0651621027340776, "mean_inference_ms": 1.4132319572740994, "mean_action_processing_ms": 0.07634825931910554, "mean_env_wait_ms": 6.421222886659362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2836000, "timesteps_this_iter": 0, "agent_timesteps_total": 2836000, "timers": {"sample_time_ms": 17401.595, "sample_throughput": 229.864, "load_time_ms": 0.35, "load_throughput": 11433294.262, "learn_time_ms": 8585.146, "learn_throughput": 465.921, "update_time_ms": 1.808}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07386027229248837, "policy_loss": -0.010860082440288557, "vf_loss": 8.282019378805673, "vf_explained_var": 0.3146060848107902, "kl": 0.011260211206637645, "entropy": 0.30179762845077823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2836000, "num_agent_steps_sampled": 2836000, "num_steps_trained": 2836000, "num_agent_steps_trained": 2836000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28520, "training_iteration": 709, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-50-31", "timestamp": 1643709031, "time_this_iter_s": 18.686747074127197, "time_total_s": 18055.439501047134, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5795.930624008179, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 41.55185185185184, "ram_util_percent": 62.788888888888884}}
{"episode_reward_max": -3.3, "episode_reward_min": -82.3, "episode_reward_mean": -12.608999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -10.0, -8.3, -16.2, -16.9, -9.3, -6.3, -11.7, -5.2, -15.499999999999996, -8.600000000000001, -9.999999999999996, -13.099999999999998, -8.4, -15.4, -25.6, -6.300000000000001, -12.2, -16.4, -10.5, -11.999999999999998, -9.2, -13.099999999999998, -4.4, -12.599999999999998, -6.2, -13.899999999999997, -3.6000000000000005, -13.299999999999983, -5.3, -11.7, -33.2, -16.7, -5.2, -19.80000000000001, -13.6, -5.2, -6.300000000000001, -11.600000000000001, -9.4, -15.1, -17.3, -16.2, -6.5, -8.4, -11.2, -8.3, -8.299999999999997, -7.800000000000001, -20.099999999999998, -3.3, -10.700000000000001, -20.5, -11.1, -12.899999999999997, -11.999999999999993, -6.2, -18.900000000000002, -5.3, -11.2, -14.5, -4.3, -6.3, -7.300000000000001, -13.600000000000001, -4.2, -11.2, -8.3, -7.4, -23.5, -6.300000000000001, -26.500000000000004, -80.2, -8.2, -4.3, -9.2, -14.4, -5.2, -8.299999999999997, -8.5, -29.3, -4.9, -13.1, -15.2, -10.2, -5.4, -82.3, -8.3, -8.699999999999998, -20.999999999999996, -3.3, -11.099999999999998, -9.2, -10.5, -6.2, -15.5, -8.2, -8.2, -9.599999999999998, -19.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0651195794793573, "mean_inference_ms": 1.41324365368109, "mean_action_processing_ms": 0.07635011251108122, "mean_env_wait_ms": 6.421487373336638, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2840000, "timesteps_this_iter": 0, "agent_timesteps_total": 2840000, "timers": {"sample_time_ms": 17659.05, "sample_throughput": 226.513, "load_time_ms": 0.356, "load_throughput": 11228977.98, "learn_time_ms": 8634.532, "learn_throughput": 463.256, "update_time_ms": 1.878}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.6271742791518249, "policy_loss": -0.01594933530400878, "vf_loss": 64.14202591219257, "vf_explained_var": 0.09455507250242336, "kl": 0.010094109239035701, "entropy": 0.2858632155964451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2840000, "num_agent_steps_sampled": 2840000, "num_steps_trained": 2840000, "num_agent_steps_trained": 2840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28560, "training_iteration": 710, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-50-50", "timestamp": 1643709050, "time_this_iter_s": 19.091302156448364, "time_total_s": 18074.530803203583, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5815.021926164627, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 41.029629629629625, "ram_util_percent": 62.75925925925925}}
{"episode_reward_max": -2.5, "episode_reward_min": -82.3, "episode_reward_mean": -12.29, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.1, -17.3, -16.2, -6.5, -8.4, -11.2, -8.3, -8.299999999999997, -7.800000000000001, -20.099999999999998, -3.3, -10.700000000000001, -20.5, -11.1, -12.899999999999997, -11.999999999999993, -6.2, -18.900000000000002, -5.3, -11.2, -14.5, -4.3, -6.3, -7.300000000000001, -13.600000000000001, -4.2, -11.2, -8.3, -7.4, -23.5, -6.300000000000001, -26.500000000000004, -80.2, -8.2, -4.3, -9.2, -14.4, -5.2, -8.299999999999997, -8.5, -29.3, -4.9, -13.1, -15.2, -10.2, -5.4, -82.3, -8.3, -8.699999999999998, -20.999999999999996, -3.3, -11.099999999999998, -9.2, -10.5, -6.2, -15.5, -8.2, -8.2, -9.599999999999998, -19.299999999999997, -24.500000000000004, -6.2, -6.2, -5.4, -7.4, -14.3, -11.1, -9.600000000000001, -7.2, -8.5, -7.700000000000001, -11.3, -15.1, -2.5, -10.5, -6.599999999999999, -18.5, -20.699999999999996, -19.300000000000004, -7.499999999999998, -8.399999999999999, -4.9, -6.300000000000001, -13.700000000000001, -3.8000000000000003, -7.3, -8.3, -6.499999999999993, -7.300000000000001, -15.799999999999999, -18.500000000000004, -5.800000000000001, -12.099999999999998, -28.80000000000001, -21.500000000000004, -7.3, -6.2, -5.300000000000001, -5.3, -13.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0650406473163059, "mean_inference_ms": 1.4131520710640866, "mean_action_processing_ms": 0.07634877124095395, "mean_env_wait_ms": 6.421223086073213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2844000, "timesteps_this_iter": 0, "agent_timesteps_total": 2844000, "timers": {"sample_time_ms": 17604.877, "sample_throughput": 227.21, "load_time_ms": 0.36, "load_throughput": 11123999.47, "learn_time_ms": 8633.109, "learn_throughput": 463.332, "update_time_ms": 1.889}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08188860999039745, "policy_loss": -0.02197549438845086, "vf_loss": 10.190034271952927, "vf_explained_var": 0.012538173890882923, "kl": 0.011637130058530096, "entropy": 0.3136630333078805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2844000, "num_agent_steps_sampled": 2844000, "num_steps_trained": 2844000, "num_agent_steps_trained": 2844000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28600, "training_iteration": 711, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-51-06", "timestamp": 1643709066, "time_this_iter_s": 16.4516019821167, "time_total_s": 18090.9824051857, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5831.473528146744, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 33.0375, "ram_util_percent": 62.82916666666667}}
{"episode_reward_max": 0.0, "episode_reward_min": -82.3, "episode_reward_mean": -11.423000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.3, -4.9, -13.1, -15.2, -10.2, -5.4, -82.3, -8.3, -8.699999999999998, -20.999999999999996, -3.3, -11.099999999999998, -9.2, -10.5, -6.2, -15.5, -8.2, -8.2, -9.599999999999998, -19.299999999999997, -24.500000000000004, -6.2, -6.2, -5.4, -7.4, -14.3, -11.1, -9.600000000000001, -7.2, -8.5, -7.700000000000001, -11.3, -15.1, -2.5, -10.5, -6.599999999999999, -18.5, -20.699999999999996, -19.300000000000004, -7.499999999999998, -8.399999999999999, -4.9, -6.300000000000001, -13.700000000000001, -3.8000000000000003, -7.3, -8.3, -6.499999999999993, -7.300000000000001, -15.799999999999999, -18.500000000000004, -5.800000000000001, -12.099999999999998, -28.80000000000001, -21.500000000000004, -7.3, -6.2, -5.300000000000001, -5.3, -13.3, 0.0, -4.3, -10.799999999999999, -19.9, -10.999999999999996, -4.3, -8.3, -10.4, -4.2, -8.3, -27.3, -11.2, -4.2, -17.400000000000006, -7.300000000000001, -6.300000000000001, -9.3, -27.500000000000004, -11.2, -17.099999999999998, -6.300000000000001, -16.599999999999998, -7.3, -21.2, -9.3, -12.1, -5.300000000000001, -8.2, -23.700000000000006, -5.2, -7.6000000000000005, -7.2, -9.8, -8.899999999999999, -7.3, -8.899999999999999, -12.699999999999992, -4.9, -6.2, -7.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.064757337847834, "mean_inference_ms": 1.4127873182467463, "mean_action_processing_ms": 0.07633047845152326, "mean_env_wait_ms": 6.419642130466693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2848000, "timesteps_this_iter": 0, "agent_timesteps_total": 2848000, "timers": {"sample_time_ms": 17608.789, "sample_throughput": 227.159, "load_time_ms": 0.363, "load_throughput": 11015900.197, "learn_time_ms": 8801.202, "learn_throughput": 454.483, "update_time_ms": 1.922}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07471748891446779, "policy_loss": -0.01903399567780716, "vf_loss": 9.174279836621336, "vf_explained_var": 0.1448567675646915, "kl": 0.011903344648355336, "entropy": 0.295997231365532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2848000, "num_agent_steps_sampled": 2848000, "num_steps_trained": 2848000, "num_agent_steps_trained": 2848000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28640, "training_iteration": 712, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-51-24", "timestamp": 1643709084, "time_this_iter_s": 17.63759207725525, "time_total_s": 18108.619997262955, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5849.111120223999, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 36.327999999999996, "ram_util_percent": 62.868}}
{"episode_reward_max": 0.0, "episode_reward_min": -61.200000000000024, "episode_reward_mean": -10.986, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.399999999999999, -4.9, -6.300000000000001, -13.700000000000001, -3.8000000000000003, -7.3, -8.3, -6.499999999999993, -7.300000000000001, -15.799999999999999, -18.500000000000004, -5.800000000000001, -12.099999999999998, -28.80000000000001, -21.500000000000004, -7.3, -6.2, -5.300000000000001, -5.3, -13.3, 0.0, -4.3, -10.799999999999999, -19.9, -10.999999999999996, -4.3, -8.3, -10.4, -4.2, -8.3, -27.3, -11.2, -4.2, -17.400000000000006, -7.300000000000001, -6.300000000000001, -9.3, -27.500000000000004, -11.2, -17.099999999999998, -6.300000000000001, -16.599999999999998, -7.3, -21.2, -9.3, -12.1, -5.300000000000001, -8.2, -23.700000000000006, -5.2, -7.6000000000000005, -7.2, -9.8, -8.899999999999999, -7.3, -8.899999999999999, -12.699999999999992, -4.9, -6.2, -7.300000000000001, -8.299999999999997, -4.2, -9.799999999999999, -6.3, -9.2, -5.300000000000001, -13.099999999999998, -4.2, -12.5, -4.4, -3.2, -6.4, -8.2, -8.3, -8.7, -17.2, -15.199999999999998, -5.0, -9.8, -3.3, -25.600000000000005, -6.2, -12.2, -7.2, -19.200000000000003, -8.7, -13.600000000000001, -15.2, -5.2, -10.3, -13.0, -22.6, -61.200000000000024, -6.9, -27.400000000000002, -6.2, -4.700000000000001, -4.3, -20.200000000000003, -23.39999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.06469174373348, "mean_inference_ms": 1.4128280406271931, "mean_action_processing_ms": 0.07633270034858984, "mean_env_wait_ms": 6.4197802858831565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2852000, "timesteps_this_iter": 0, "agent_timesteps_total": 2852000, "timers": {"sample_time_ms": 17939.799, "sample_throughput": 222.968, "load_time_ms": 0.382, "load_throughput": 10475284.715, "learn_time_ms": 8776.094, "learn_throughput": 455.784, "update_time_ms": 1.885}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17245153118155257, "policy_loss": -0.03106749097626376, "vf_loss": 20.128951951540927, "vf_explained_var": 0.08546736560842043, "kl": 0.013211875436925367, "entropy": 0.33217626677084994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2852000, "num_agent_steps_sampled": 2852000, "num_steps_trained": 2852000, "num_agent_steps_trained": 2852000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28680, "training_iteration": 713, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-51-44", "timestamp": 1643709104, "time_this_iter_s": 19.645965099334717, "time_total_s": 18128.26596236229, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5868.757085323334, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 38.203571428571436, "ram_util_percent": 62.642857142857125}}
{"episode_reward_max": -3.2, "episode_reward_min": -77.3, "episode_reward_mean": -11.631999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -16.599999999999998, -7.3, -21.2, -9.3, -12.1, -5.300000000000001, -8.2, -23.700000000000006, -5.2, -7.6000000000000005, -7.2, -9.8, -8.899999999999999, -7.3, -8.899999999999999, -12.699999999999992, -4.9, -6.2, -7.300000000000001, -8.299999999999997, -4.2, -9.799999999999999, -6.3, -9.2, -5.300000000000001, -13.099999999999998, -4.2, -12.5, -4.4, -3.2, -6.4, -8.2, -8.3, -8.7, -17.2, -15.199999999999998, -5.0, -9.8, -3.3, -25.600000000000005, -6.2, -12.2, -7.2, -19.200000000000003, -8.7, -13.600000000000001, -15.2, -5.2, -10.3, -13.0, -22.6, -61.200000000000024, -6.9, -27.400000000000002, -6.2, -4.700000000000001, -4.3, -20.200000000000003, -23.39999999999999, -5.4, -19.200000000000006, -20.3, -14.099999999999996, -16.3, -8.2, -12.799999999999999, -14.899999999999999, -5.2, -11.299999999999997, -18.800000000000008, -3.4, -5.2, -18.800000000000026, -3.3, -14.7, -12.6, -18.2, -6.3, -4.9, -8.3, -16.6, -5.9, -5.2, -10.3, -3.3, -7.999999999999998, -4.4, -11.899999999999999, -17.5, -4.800000000000001, -19.400000000000006, -9.599999999999998, -4.4, -13.699999999999973, -6.499999999999999, -77.3, -12.799999999999997, -12.1, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.064970580447623, "mean_inference_ms": 1.4133019019411612, "mean_action_processing_ms": 0.0763558203280585, "mean_env_wait_ms": 6.421722353181722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2856000, "timesteps_this_iter": 0, "agent_timesteps_total": 2856000, "timers": {"sample_time_ms": 18172.895, "sample_throughput": 220.108, "load_time_ms": 0.381, "load_throughput": 10503484.63, "learn_time_ms": 8858.176, "learn_throughput": 451.56, "update_time_ms": 1.9}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.32938413510840103, "policy_loss": -0.022611624475127906, "vf_loss": 35.01112373375123, "vf_explained_var": 0.03729824237926032, "kl": 0.011167599408741602, "entropy": 0.341959526894554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2856000, "num_agent_steps_sampled": 2856000, "num_steps_trained": 2856000, "num_agent_steps_trained": 2856000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28720, "training_iteration": 714, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-52-03", "timestamp": 1643709123, "time_this_iter_s": 19.091231107711792, "time_total_s": 18147.35719347, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5887.8483164310455, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 38.3074074074074, "ram_util_percent": 62.54074074074074}}
{"episode_reward_max": -3.3, "episode_reward_min": -77.3, "episode_reward_mean": -12.936, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.600000000000005, -6.2, -12.2, -7.2, -19.200000000000003, -8.7, -13.600000000000001, -15.2, -5.2, -10.3, -13.0, -22.6, -61.200000000000024, -6.9, -27.400000000000002, -6.2, -4.700000000000001, -4.3, -20.200000000000003, -23.39999999999999, -5.4, -19.200000000000006, -20.3, -14.099999999999996, -16.3, -8.2, -12.799999999999999, -14.899999999999999, -5.2, -11.299999999999997, -18.800000000000008, -3.4, -5.2, -18.800000000000026, -3.3, -14.7, -12.6, -18.2, -6.3, -4.9, -8.3, -16.6, -5.9, -5.2, -10.3, -3.3, -7.999999999999998, -4.4, -11.899999999999999, -17.5, -4.800000000000001, -19.400000000000006, -9.599999999999998, -4.4, -13.699999999999973, -6.499999999999999, -77.3, -12.799999999999997, -12.1, -5.4, -5.3, -15.199999999999998, -3.3, -14.899999999999979, -12.899999999999984, -9.7, -10.4, -11.1, -11.3, -20.0, -40.3, -10.899999999999999, -6.3, -22.1, -9.599999999999998, -10.3, -26.0, -19.5, -6.6, -10.499999999999995, -5.1, -20.6, -4.4, -15.699999999999998, -16.4, -10.3, -6.000000000000001, -9.4, -13.7, -12.2, -6.4, -5.2, -5.300000000000001, -10.4, -18.29999999999999, -16.799999999999997, -5.300000000000001, -14.499999999999982, -5.3, -11.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0655458086565692, "mean_inference_ms": 1.4141007083305426, "mean_action_processing_ms": 0.07639761005221085, "mean_env_wait_ms": 6.425130615736398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2860000, "timesteps_this_iter": 0, "agent_timesteps_total": 2860000, "timers": {"sample_time_ms": 18506.667, "sample_throughput": 216.138, "load_time_ms": 0.4, "load_throughput": 10009077.676, "learn_time_ms": 8848.777, "learn_throughput": 452.04, "update_time_ms": 1.909}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10734789653040308, "policy_loss": -0.02713859453997625, "vf_loss": 13.204320150613786, "vf_explained_var": 0.2327506032041324, "kl": 0.014478757120104145, "entropy": 0.30924794796493743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2860000, "num_agent_steps_sampled": 2860000, "num_steps_trained": 2860000, "num_agent_steps_trained": 2860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28760, "training_iteration": 715, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-52-23", "timestamp": 1643709143, "time_this_iter_s": 19.77714776992798, "time_total_s": 18167.13434123993, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5907.6254642009735, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 34.68928571428571, "ram_util_percent": 62.53928571428571}}
{"episode_reward_max": -3.2, "episode_reward_min": -77.3, "episode_reward_mean": -12.107999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -16.6, -5.9, -5.2, -10.3, -3.3, -7.999999999999998, -4.4, -11.899999999999999, -17.5, -4.800000000000001, -19.400000000000006, -9.599999999999998, -4.4, -13.699999999999973, -6.499999999999999, -77.3, -12.799999999999997, -12.1, -5.4, -5.3, -15.199999999999998, -3.3, -14.899999999999979, -12.899999999999984, -9.7, -10.4, -11.1, -11.3, -20.0, -40.3, -10.899999999999999, -6.3, -22.1, -9.599999999999998, -10.3, -26.0, -19.5, -6.6, -10.499999999999995, -5.1, -20.6, -4.4, -15.699999999999998, -16.4, -10.3, -6.000000000000001, -9.4, -13.7, -12.2, -6.4, -5.2, -5.300000000000001, -10.4, -18.29999999999999, -16.799999999999997, -5.300000000000001, -14.499999999999982, -5.3, -11.5, -4.2, -7.699999999999999, -3.3, -17.400000000000002, -21.6, -8.599999999999998, -11.8, -3.3, -6.300000000000001, -3.4, -3.4, -12.7, -11.499999999999996, -7.300000000000001, -4.4, -9.3, -8.899999999999999, -5.4, -8.9, -37.900000000000006, -7.300000000000001, -20.500000000000004, -19.6, -4.2, -12.999999999999998, -8.3, -25.6, -7.300000000000001, -11.7, -15.7, -5.3, -5.300000000000001, -16.099999999999994, -3.2, -9.399999999999997, -16.2, -12.0, -36.5, -4.2, -25.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0661944921488589, "mean_inference_ms": 1.4148743111805866, "mean_action_processing_ms": 0.07643942926752559, "mean_env_wait_ms": 6.428642945082917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2864000, "timesteps_this_iter": 0, "agent_timesteps_total": 2864000, "timers": {"sample_time_ms": 18766.165, "sample_throughput": 213.15, "load_time_ms": 0.417, "load_throughput": 9599047.946, "learn_time_ms": 8973.544, "learn_throughput": 445.755, "update_time_ms": 1.92}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11625683730047556, "policy_loss": -0.025470498426546972, "vf_loss": 13.97281018258423, "vf_explained_var": 0.25658496169633765, "kl": 0.011847316895962195, "entropy": 0.2831123845872059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2864000, "num_agent_steps_sampled": 2864000, "num_steps_trained": 2864000, "num_agent_steps_trained": 2864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28800, "training_iteration": 716, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-52-43", "timestamp": 1643709163, "time_this_iter_s": 20.714731693267822, "time_total_s": 18187.849072933197, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5928.340195894241, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 36.330000000000005, "ram_util_percent": 62.57999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -37.900000000000006, "episode_reward_mean": -11.608999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.1, -20.6, -4.4, -15.699999999999998, -16.4, -10.3, -6.000000000000001, -9.4, -13.7, -12.2, -6.4, -5.2, -5.300000000000001, -10.4, -18.29999999999999, -16.799999999999997, -5.300000000000001, -14.499999999999982, -5.3, -11.5, -4.2, -7.699999999999999, -3.3, -17.400000000000002, -21.6, -8.599999999999998, -11.8, -3.3, -6.300000000000001, -3.4, -3.4, -12.7, -11.499999999999996, -7.300000000000001, -4.4, -9.3, -8.899999999999999, -5.4, -8.9, -37.900000000000006, -7.300000000000001, -20.500000000000004, -19.6, -4.2, -12.999999999999998, -8.3, -25.6, -7.300000000000001, -11.7, -15.7, -5.3, -5.300000000000001, -16.099999999999994, -3.2, -9.399999999999997, -16.2, -12.0, -36.5, -4.2, -25.700000000000003, -13.099999999999998, -8.599999999999998, -13.499999999999998, -6.4, -17.2, -4.3, -6.9, -9.3, -24.50000000000003, -14.499999999999986, -22.400000000000023, -10.899999999999999, -18.1, -11.7, -4.7, -28.40000000000005, -11.799999999999999, -8.600000000000001, -8.899999999999999, -15.599999999999996, -11.799999999999999, -14.499999999999979, -11.600000000000001, -7.6000000000000005, -11.600000000000001, -21.400000000000002, -4.9, -16.69999999999999, -4.4, -6.2, -4.4, -5.3, -9.3, -7.300000000000001, -13.9, -14.199999999999994, -21.3, -12.299999999999999, -16.799999999999997, -8.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0670290867664214, "mean_inference_ms": 1.4160039898942398, "mean_action_processing_ms": 0.07649969715942168, "mean_env_wait_ms": 6.434022737540101, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2868000, "timesteps_this_iter": 0, "agent_timesteps_total": 2868000, "timers": {"sample_time_ms": 19146.98, "sample_throughput": 208.91, "load_time_ms": 0.436, "load_throughput": 9180419.152, "learn_time_ms": 9288.76, "learn_throughput": 430.628, "update_time_ms": 1.935}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09432794084992781, "policy_loss": -0.01891460492806409, "vf_loss": 11.108546499603538, "vf_explained_var": 0.30329552183869063, "kl": 0.012782720111436108, "entropy": 0.33832798504060313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2868000, "num_agent_steps_sampled": 2868000, "num_steps_trained": 2868000, "num_agent_steps_trained": 2868000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28840, "training_iteration": 717, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-53-09", "timestamp": 1643709189, "time_this_iter_s": 25.202930212020874, "time_total_s": 18213.052003145218, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5953.543126106262, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 53.55833333333334, "ram_util_percent": 62.902777777777764}}
{"episode_reward_max": -3.2, "episode_reward_min": -61.29999999999997, "episode_reward_mean": -12.513, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -20.500000000000004, -19.6, -4.2, -12.999999999999998, -8.3, -25.6, -7.300000000000001, -11.7, -15.7, -5.3, -5.300000000000001, -16.099999999999994, -3.2, -9.399999999999997, -16.2, -12.0, -36.5, -4.2, -25.700000000000003, -13.099999999999998, -8.599999999999998, -13.499999999999998, -6.4, -17.2, -4.3, -6.9, -9.3, -24.50000000000003, -14.499999999999986, -22.400000000000023, -10.899999999999999, -18.1, -11.7, -4.7, -28.40000000000005, -11.799999999999999, -8.600000000000001, -8.899999999999999, -15.599999999999996, -11.799999999999999, -14.499999999999979, -11.600000000000001, -7.6000000000000005, -11.600000000000001, -21.400000000000002, -4.9, -16.69999999999999, -4.4, -6.2, -4.4, -5.3, -9.3, -7.300000000000001, -13.9, -14.199999999999994, -21.3, -12.299999999999999, -16.799999999999997, -8.8, -4.2, -20.300000000000008, -15.4, -11.199999999999998, -9.49999999999998, -5.9, -6.300000000000001, -12.3, -11.799999999999999, -15.2, -9.1, -14.999999999999984, -27.800000000000004, -61.29999999999997, -18.9, -6.2, -5.4, -17.700000000000003, -3.2, -6.300000000000001, -6.999999999999998, -9.799999999999999, -4.2, -23.6, -7.4, -4.300000000000001, -13.7, -10.899999999999999, -12.1, -9.599999999999998, -8.799999999999999, -11.2, -13.7, -13.2, -12.999999999999996, -14.099999999999996, -7.3, -4.700000000000001, -3.6, -25.30000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0676990555411692, "mean_inference_ms": 1.4172785378468615, "mean_action_processing_ms": 0.07656333695825798, "mean_env_wait_ms": 6.439874632609819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2872000, "timesteps_this_iter": 0, "agent_timesteps_total": 2872000, "timers": {"sample_time_ms": 19735.591, "sample_throughput": 202.68, "load_time_ms": 0.433, "load_throughput": 9233470.556, "learn_time_ms": 9391.239, "learn_throughput": 425.929, "update_time_ms": 2.003}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2308909660380494, "policy_loss": -0.019637168550323093, "vf_loss": 24.891278630815528, "vf_explained_var": 0.11324584593055069, "kl": 0.009572459973417402, "entropy": 0.3175405814602811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2872000, "num_agent_steps_sampled": 2872000, "num_steps_trained": 2872000, "num_agent_steps_trained": 2872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28880, "training_iteration": 718, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-53-30", "timestamp": 1643709210, "time_this_iter_s": 21.70848321914673, "time_total_s": 18234.760486364365, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5975.251609325409, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 42.68064516129033, "ram_util_percent": 63.18387096774194}}
{"episode_reward_max": -3.2, "episode_reward_min": -61.29999999999997, "episode_reward_mean": -11.745, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.799999999999999, -14.499999999999979, -11.600000000000001, -7.6000000000000005, -11.600000000000001, -21.400000000000002, -4.9, -16.69999999999999, -4.4, -6.2, -4.4, -5.3, -9.3, -7.300000000000001, -13.9, -14.199999999999994, -21.3, -12.299999999999999, -16.799999999999997, -8.8, -4.2, -20.300000000000008, -15.4, -11.199999999999998, -9.49999999999998, -5.9, -6.300000000000001, -12.3, -11.799999999999999, -15.2, -9.1, -14.999999999999984, -27.800000000000004, -61.29999999999997, -18.9, -6.2, -5.4, -17.700000000000003, -3.2, -6.300000000000001, -6.999999999999998, -9.799999999999999, -4.2, -23.6, -7.4, -4.300000000000001, -13.7, -10.899999999999999, -12.1, -9.599999999999998, -8.799999999999999, -11.2, -13.7, -13.2, -12.999999999999996, -14.099999999999996, -7.3, -4.700000000000001, -3.6, -25.30000000000001, -15.899999999999977, -15.4, -26.70000000000001, -14.299999999999997, -16.199999999999974, -7.400000000000001, -9.2, -21.4, -4.2, -9.799999999999999, -5.300000000000001, -16.9, -6.300000000000001, -4.700000000000001, -3.4, -9.9, -3.2, -7.199999999999999, -3.2, -16.799999999999997, -19.9, -13.199999999999996, -6.300000000000001, -4.2, -17.6, -9.3, -9.2, -13.3, -12.2, -7.3, -14.8, -13.499999999999996, -9.5, -6.4, -8.2, -10.600000000000001, -5.2, -4.4, -31.3, -15.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0687089786294677, "mean_inference_ms": 1.4186692563888443, "mean_action_processing_ms": 0.07663120186226159, "mean_env_wait_ms": 6.446101826141033, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2876000, "timesteps_this_iter": 0, "agent_timesteps_total": 2876000, "timers": {"sample_time_ms": 20132.529, "sample_throughput": 198.683, "load_time_ms": 0.453, "load_throughput": 8838021.388, "learn_time_ms": 9289.684, "learn_throughput": 430.585, "update_time_ms": 2.009}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.062451695034440646, "policy_loss": -0.032070539378991694, "vf_loss": 9.235361554673924, "vf_explained_var": 0.2686034801826682, "kl": 0.012851081611896388, "entropy": 0.2838444718510233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2876000, "num_agent_steps_sampled": 2876000, "num_steps_trained": 2876000, "num_agent_steps_trained": 2876000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28920, "training_iteration": 719, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-53-51", "timestamp": 1643709231, "time_this_iter_s": 20.620234966278076, "time_total_s": 18255.380721330643, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5995.871844291687, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 38.906896551724145, "ram_util_percent": 62.18275862068967}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -31.3, "episode_reward_mean": -11.299, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999998, -9.799999999999999, -4.2, -23.6, -7.4, -4.300000000000001, -13.7, -10.899999999999999, -12.1, -9.599999999999998, -8.799999999999999, -11.2, -13.7, -13.2, -12.999999999999996, -14.099999999999996, -7.3, -4.700000000000001, -3.6, -25.30000000000001, -15.899999999999977, -15.4, -26.70000000000001, -14.299999999999997, -16.199999999999974, -7.400000000000001, -9.2, -21.4, -4.2, -9.799999999999999, -5.300000000000001, -16.9, -6.300000000000001, -4.700000000000001, -3.4, -9.9, -3.2, -7.199999999999999, -3.2, -16.799999999999997, -19.9, -13.199999999999996, -6.300000000000001, -4.2, -17.6, -9.3, -9.2, -13.3, -12.2, -7.3, -14.8, -13.499999999999996, -9.5, -6.4, -8.2, -10.600000000000001, -5.2, -4.4, -31.3, -15.899999999999999, -4.4, -4.3, -15.3, -8.3, -20.0, -18.5, -8.399999999999999, -5.199999999999999, -4.2, -19.0, -12.5, -11.3, -7.4, -12.8, -8.8, -22.2, -18.700000000000006, -6.300000000000001, -7.2, -2.3000000000000003, -11.399999999999999, -8.7, -3.2, -9.999999999999998, -8.5, -4.4, -3.4, -10.4, -22.6, -18.3, -29.700000000000017, -4.9, -15.099999999999998, -10.899999999999999, -19.39999999999999, -15.8, -7.800000000000001, -4.6000000000000005, -24.899999999999995, -11.599999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0692727001039453, "mean_inference_ms": 1.4192380921612215, "mean_action_processing_ms": 0.07665863422276376, "mean_env_wait_ms": 6.448755758700632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2880000, "timesteps_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"sample_time_ms": 19888.557, "sample_throughput": 201.121, "load_time_ms": 0.441, "load_throughput": 9080545.573, "learn_time_ms": 9420.85, "learn_throughput": 424.59, "update_time_ms": 2.029}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09169822447452575, "policy_loss": -0.025413956701435068, "vf_loss": 11.478017646138387, "vf_explained_var": 0.09817679979467905, "kl": 0.013819292833141672, "entropy": 0.32486640360727104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2880000, "num_agent_steps_sampled": 2880000, "num_steps_trained": 2880000, "num_agent_steps_trained": 2880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 28960, "training_iteration": 720, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-54-10", "timestamp": 1643709250, "time_this_iter_s": 18.98315691947937, "time_total_s": 18274.363878250122, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6014.855001211166, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 26.06296296296296, "ram_util_percent": 62.25185185185185}}
{"episode_reward_max": -2.3, "episode_reward_min": -45.900000000000155, "episode_reward_mean": -11.286000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.9, -13.199999999999996, -6.300000000000001, -4.2, -17.6, -9.3, -9.2, -13.3, -12.2, -7.3, -14.8, -13.499999999999996, -9.5, -6.4, -8.2, -10.600000000000001, -5.2, -4.4, -31.3, -15.899999999999999, -4.4, -4.3, -15.3, -8.3, -20.0, -18.5, -8.399999999999999, -5.199999999999999, -4.2, -19.0, -12.5, -11.3, -7.4, -12.8, -8.8, -22.2, -18.700000000000006, -6.300000000000001, -7.2, -2.3000000000000003, -11.399999999999999, -8.7, -3.2, -9.999999999999998, -8.5, -4.4, -3.4, -10.4, -22.6, -18.3, -29.700000000000017, -4.9, -15.099999999999998, -10.899999999999999, -19.39999999999999, -15.8, -7.800000000000001, -4.6000000000000005, -24.899999999999995, -11.599999999999996, -5.3, -45.900000000000155, -6.3, -9.3, -4.2, -15.299999999999997, -18.199999999999996, -4.3, -15.7, -7.300000000000001, -3.3, -13.199999999999998, -14.799999999999999, -9.2, -9.799999999999999, -6.3, -22.4, -15.899999999999995, -30.800000000000004, -12.399999999999999, -3.4, -5.4, -5.4, -13.899999999999999, -2.3, -13.399999999999999, -19.099999999999998, -4.2, -14.0, -10.4, -7.0, -13.9, -5.2, -7.2, -4.3, -5.2, -5.4, -15.19999999999997, -4.500000000000001, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0695499552612426, "mean_inference_ms": 1.419499371091822, "mean_action_processing_ms": 0.07667033386205772, "mean_env_wait_ms": 6.450052095022574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2884000, "timesteps_this_iter": 0, "agent_timesteps_total": 2884000, "timers": {"sample_time_ms": 20170.025, "sample_throughput": 198.314, "load_time_ms": 0.437, "load_throughput": 9159368.892, "learn_time_ms": 9517.814, "learn_throughput": 420.265, "update_time_ms": 2.071}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10066472984229526, "policy_loss": -0.028853734682804794, "vf_loss": 12.739568061149248, "vf_explained_var": 0.23239332674652016, "kl": 0.01257947650255913, "entropy": 0.3005050284087017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2884000, "num_agent_steps_sampled": 2884000, "num_steps_trained": 2884000, "num_agent_steps_trained": 2884000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29000, "training_iteration": 721, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-54-29", "timestamp": 1643709269, "time_this_iter_s": 18.90557026863098, "time_total_s": 18293.269448518753, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6033.760571479797, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 40.57037037037036, "ram_util_percent": 62.39259259259259}}
{"episode_reward_max": -2.3, "episode_reward_min": -45.900000000000155, "episode_reward_mean": -11.258000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.399999999999999, -8.7, -3.2, -9.999999999999998, -8.5, -4.4, -3.4, -10.4, -22.6, -18.3, -29.700000000000017, -4.9, -15.099999999999998, -10.899999999999999, -19.39999999999999, -15.8, -7.800000000000001, -4.6000000000000005, -24.899999999999995, -11.599999999999996, -5.3, -45.900000000000155, -6.3, -9.3, -4.2, -15.299999999999997, -18.199999999999996, -4.3, -15.7, -7.300000000000001, -3.3, -13.199999999999998, -14.799999999999999, -9.2, -9.799999999999999, -6.3, -22.4, -15.899999999999995, -30.800000000000004, -12.399999999999999, -3.4, -5.4, -5.4, -13.899999999999999, -2.3, -13.399999999999999, -19.099999999999998, -4.2, -14.0, -10.4, -7.0, -13.9, -5.2, -7.2, -4.3, -5.2, -5.4, -15.19999999999997, -4.500000000000001, -4.300000000000001, -3.2, -9.2, -16.8, -12.999999999999975, -21.300000000000015, -25.20000000000001, -11.599999999999998, -10.299999999999999, -8.9, -8.899999999999999, -17.800000000000004, -9.4, -15.899999999999999, -14.499999999999998, -7.700000000000001, -13.600000000000001, -11.3, -6.4, -7.2, -13.5, -3.5000000000000004, -17.0, -16.900000000000006, -14.19999999999997, -19.700000000000003, -11.600000000000001, -5.2, -4.3, -5.300000000000001, -8.3, -11.399999999999984, -12.099999999999982, -5.300000000000001, -4.300000000000001, -21.799999999999997, -6.4, -9.6, -12.399999999999999, -7.2, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0698349253674428, "mean_inference_ms": 1.4200068859379638, "mean_action_processing_ms": 0.0766960406608751, "mean_env_wait_ms": 6.45254968762481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2888000, "timesteps_this_iter": 0, "agent_timesteps_total": 2888000, "timers": {"sample_time_ms": 20639.529, "sample_throughput": 193.803, "load_time_ms": 0.463, "load_throughput": 8646712.364, "learn_time_ms": 9964.501, "learn_throughput": 401.425, "update_time_ms": 2.027}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.056853824409265674, "policy_loss": -0.026452433598297898, "vf_loss": 8.051334783082368, "vf_explained_var": 0.3854876137548877, "kl": 0.01655057987274425, "entropy": 0.3140980565579989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2888000, "num_agent_steps_sampled": 2888000, "num_steps_trained": 2888000, "num_agent_steps_trained": 2888000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29040, "training_iteration": 722, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-54-55", "timestamp": 1643709295, "time_this_iter_s": 25.828925132751465, "time_total_s": 18319.098373651505, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6059.589496612549, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 41.15135135135135, "ram_util_percent": 62.32432432432435}}
{"episode_reward_max": -2.3, "episode_reward_min": -30.4, "episode_reward_mean": -10.795, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -5.4, -5.4, -13.899999999999999, -2.3, -13.399999999999999, -19.099999999999998, -4.2, -14.0, -10.4, -7.0, -13.9, -5.2, -7.2, -4.3, -5.2, -5.4, -15.19999999999997, -4.500000000000001, -4.300000000000001, -3.2, -9.2, -16.8, -12.999999999999975, -21.300000000000015, -25.20000000000001, -11.599999999999998, -10.299999999999999, -8.9, -8.899999999999999, -17.800000000000004, -9.4, -15.899999999999999, -14.499999999999998, -7.700000000000001, -13.600000000000001, -11.3, -6.4, -7.2, -13.5, -3.5000000000000004, -17.0, -16.900000000000006, -14.19999999999997, -19.700000000000003, -11.600000000000001, -5.2, -4.3, -5.300000000000001, -8.3, -11.399999999999984, -12.099999999999982, -5.300000000000001, -4.300000000000001, -21.799999999999997, -6.4, -9.6, -12.399999999999999, -7.2, -4.4, -17.0, -9.6, -12.39999999999999, -13.399999999999999, -7.2, -5.2, -10.7, -6.300000000000001, -29.3, -3.2, -12.6, -7.699999999999999, -7.4, -4.9, -18.700000000000003, -26.6, -3.8000000000000003, -18.7, -17.5, -3.2, -30.4, -5.699999999999999, -8.2, -21.4, -9.799999999999997, -8.3, -12.8, -4.2, -3.6, -17.0, -15.899999999999999, -10.399999999999999, -17.5, -5.799999999999999, -9.2, -14.3, -12.9, -3.3, -10.2, -12.899999999999988], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0698643620825679, "mean_inference_ms": 1.4202906181425485, "mean_action_processing_ms": 0.07671016431183453, "mean_env_wait_ms": 6.453994891253557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2892000, "timesteps_this_iter": 0, "agent_timesteps_total": 2892000, "timers": {"sample_time_ms": 20791.616, "sample_throughput": 192.385, "load_time_ms": 0.444, "load_throughput": 9009352.379, "learn_time_ms": 9980.739, "learn_throughput": 400.772, "update_time_ms": 2.052}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10641601266269322, "policy_loss": -0.015083730036533008, "vf_loss": 12.002603741743231, "vf_explained_var": 0.1529057986633752, "kl": 0.008733102985963538, "entropy": 0.3294191604420062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2892000, "num_agent_steps_sampled": 2892000, "num_steps_trained": 2892000, "num_agent_steps_trained": 2892000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29080, "training_iteration": 723, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-55-12", "timestamp": 1643709312, "time_this_iter_s": 16.85792589187622, "time_total_s": 18335.95629954338, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6076.447422504425, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 35.337500000000006, "ram_util_percent": 62.29999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -54.80000000000004, "episode_reward_mean": -11.988000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -17.0, -16.900000000000006, -14.19999999999997, -19.700000000000003, -11.600000000000001, -5.2, -4.3, -5.300000000000001, -8.3, -11.399999999999984, -12.099999999999982, -5.300000000000001, -4.300000000000001, -21.799999999999997, -6.4, -9.6, -12.399999999999999, -7.2, -4.4, -17.0, -9.6, -12.39999999999999, -13.399999999999999, -7.2, -5.2, -10.7, -6.300000000000001, -29.3, -3.2, -12.6, -7.699999999999999, -7.4, -4.9, -18.700000000000003, -26.6, -3.8000000000000003, -18.7, -17.5, -3.2, -30.4, -5.699999999999999, -8.2, -21.4, -9.799999999999997, -8.3, -12.8, -4.2, -3.6, -17.0, -15.899999999999999, -10.399999999999999, -17.5, -5.799999999999999, -9.2, -14.3, -12.9, -3.3, -10.2, -12.899999999999988, -26.0, -9.7, -11.9, -8.4, -3.3, -5.300000000000001, -14.6, -8.2, -12.999999999999998, -3.7, -4.300000000000001, -12.899999999999986, -9.7, -20.5, -28.90000000000001, -5.2, -11.3, -5.300000000000001, -3.3, -37.2, -20.000000000000007, -10.3, -13.499999999999996, -54.80000000000004, -21.099999999999998, -6.1, -4.4, -5.300000000000001, -6.4, -10.2, -16.5, -6.300000000000001, -13.2, -23.3, -17.8, -9.4, -17.3, -7.199999999999998, -7.2, -15.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.069751080415479, "mean_inference_ms": 1.4203257084849712, "mean_action_processing_ms": 0.0767120991686287, "mean_env_wait_ms": 6.454262599270361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2896000, "timesteps_this_iter": 0, "agent_timesteps_total": 2896000, "timers": {"sample_time_ms": 20729.205, "sample_throughput": 192.964, "load_time_ms": 0.463, "load_throughput": 8643594.024, "learn_time_ms": 10003.738, "learn_throughput": 399.851, "update_time_ms": 2.038}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1852684276871964, "policy_loss": -0.019098720105955758, "vf_loss": 20.225826837843464, "vf_explained_var": 0.3373219138832502, "kl": 0.012497080250926773, "entropy": 0.3094748765310293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2896000, "num_agent_steps_sampled": 2896000, "num_steps_trained": 2896000, "num_agent_steps_trained": 2896000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29120, "training_iteration": 724, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-55-30", "timestamp": 1643709330, "time_this_iter_s": 18.534932374954224, "time_total_s": 18354.491231918335, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6094.982354879379, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 38.78846153846154, "ram_util_percent": 62.284615384615385}}
{"episode_reward_max": -1.2, "episode_reward_min": -69.80000000000003, "episode_reward_mean": -12.274999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.4, -5.699999999999999, -8.2, -21.4, -9.799999999999997, -8.3, -12.8, -4.2, -3.6, -17.0, -15.899999999999999, -10.399999999999999, -17.5, -5.799999999999999, -9.2, -14.3, -12.9, -3.3, -10.2, -12.899999999999988, -26.0, -9.7, -11.9, -8.4, -3.3, -5.300000000000001, -14.6, -8.2, -12.999999999999998, -3.7, -4.300000000000001, -12.899999999999986, -9.7, -20.5, -28.90000000000001, -5.2, -11.3, -5.300000000000001, -3.3, -37.2, -20.000000000000007, -10.3, -13.499999999999996, -54.80000000000004, -21.099999999999998, -6.1, -4.4, -5.300000000000001, -6.4, -10.2, -16.5, -6.300000000000001, -13.2, -23.3, -17.8, -9.4, -17.3, -7.199999999999998, -7.2, -15.700000000000001, -15.600000000000001, -1.2, -5.8, -7.799999999999999, -5.2, -6.599999999999995, -7.899999999999998, -14.5, -23.800000000000008, -6.300000000000001, -8.399999999999999, -11.2, -3.2, -15.6, -3.3, -6.2, -15.600000000000001, -12.3, -10.2, -19.4, -9.9, -11.399999999999999, -4.2, -5.2, -12.2, -5.300000000000001, -6.3999999999999995, -4.4, -69.80000000000003, -4.3, -4.4, -27.4, -15.599999999999996, -9.2, -16.099999999999994, -4.2, -10.3, -28.500000000000004, -12.799999999999999, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0697990095800327, "mean_inference_ms": 1.4204487093894644, "mean_action_processing_ms": 0.0767179240201727, "mean_env_wait_ms": 6.45497344071679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2900000, "timesteps_this_iter": 0, "agent_timesteps_total": 2900000, "timers": {"sample_time_ms": 20661.139, "sample_throughput": 193.6, "load_time_ms": 0.463, "load_throughput": 8637808.783, "learn_time_ms": 10474.412, "learn_throughput": 381.883, "update_time_ms": 2.018}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.20060017476001032, "policy_loss": -0.03141849860048262, "vf_loss": 23.016244139402144, "vf_explained_var": 0.21952641708876497, "kl": 0.010999937267798071, "entropy": 0.30742890080937774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2900000, "num_agent_steps_sampled": 2900000, "num_steps_trained": 2900000, "num_agent_steps_trained": 2900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29160, "training_iteration": 725, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-55-54", "timestamp": 1643709354, "time_this_iter_s": 23.57873797416687, "time_total_s": 18378.069969892502, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6118.561092853546, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 31.044117647058822, "ram_util_percent": 62.217647058823516}}
{"episode_reward_max": -1.2, "episode_reward_min": -69.80000000000003, "episode_reward_mean": -12.637, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.000000000000007, -10.3, -13.499999999999996, -54.80000000000004, -21.099999999999998, -6.1, -4.4, -5.300000000000001, -6.4, -10.2, -16.5, -6.300000000000001, -13.2, -23.3, -17.8, -9.4, -17.3, -7.199999999999998, -7.2, -15.700000000000001, -15.600000000000001, -1.2, -5.8, -7.799999999999999, -5.2, -6.599999999999995, -7.899999999999998, -14.5, -23.800000000000008, -6.300000000000001, -8.399999999999999, -11.2, -3.2, -15.6, -3.3, -6.2, -15.600000000000001, -12.3, -10.2, -19.4, -9.9, -11.399999999999999, -4.2, -5.2, -12.2, -5.300000000000001, -6.3999999999999995, -4.4, -69.80000000000003, -4.3, -4.4, -27.4, -15.599999999999996, -9.2, -16.099999999999994, -4.2, -10.3, -28.500000000000004, -12.799999999999999, -3.3, -4.300000000000001, -11.599999999999998, -3.3, -14.5, -23.600000000000005, -18.3, -15.299999999999995, -14.099999999999998, -4.300000000000001, -20.3, -10.7, -12.899999999999999, -4.300000000000001, -4.300000000000001, -11.2, -3.4, -49.3, -4.3, -11.4, -7.300000000000001, -20.1, -8.0, -19.9, -7.4, -14.399999999999999, -5.300000000000001, -4.300000000000001, -19.699999999999996, -4.4, -17.4, -17.799999999999997, -3.2, -20.10000000000001, -18.7, -20.799999999999997, -6.300000000000001, -18.8, -7.3999999999999995, -11.7, -18.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.069882773004582, "mean_inference_ms": 1.4205445117232067, "mean_action_processing_ms": 0.07672108701240564, "mean_env_wait_ms": 6.455428829720108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2904000, "timesteps_this_iter": 0, "agent_timesteps_total": 2904000, "timers": {"sample_time_ms": 20915.731, "sample_throughput": 191.244, "load_time_ms": 0.438, "load_throughput": 9126484.252, "learn_time_ms": 10339.16, "learn_throughput": 386.879, "update_time_ms": 1.958}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.11274817862137351, "policy_loss": -0.021914979597673783, "vf_loss": 13.270869930136588, "vf_explained_var": 0.3491112738527277, "kl": 0.011581992986669988, "entropy": 0.2811827161940195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2904000, "num_agent_steps_sampled": 2904000, "num_steps_trained": 2904000, "num_agent_steps_trained": 2904000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29200, "training_iteration": 726, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-56-11", "timestamp": 1643709371, "time_this_iter_s": 17.199780702590942, "time_total_s": 18395.269750595093, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6135.760873556137, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 24.059999999999995, "ram_util_percent": 62.232}}
{"episode_reward_max": -3.2, "episode_reward_min": -69.80000000000003, "episode_reward_mean": -13.011, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.9, -11.399999999999999, -4.2, -5.2, -12.2, -5.300000000000001, -6.3999999999999995, -4.4, -69.80000000000003, -4.3, -4.4, -27.4, -15.599999999999996, -9.2, -16.099999999999994, -4.2, -10.3, -28.500000000000004, -12.799999999999999, -3.3, -4.300000000000001, -11.599999999999998, -3.3, -14.5, -23.600000000000005, -18.3, -15.299999999999995, -14.099999999999998, -4.300000000000001, -20.3, -10.7, -12.899999999999999, -4.300000000000001, -4.300000000000001, -11.2, -3.4, -49.3, -4.3, -11.4, -7.300000000000001, -20.1, -8.0, -19.9, -7.4, -14.399999999999999, -5.300000000000001, -4.300000000000001, -19.699999999999996, -4.4, -17.4, -17.799999999999997, -3.2, -20.10000000000001, -18.7, -20.799999999999997, -6.300000000000001, -18.8, -7.3999999999999995, -11.7, -18.3, -17.4, -4.1, -15.0, -12.4, -6.2, -17.4, -11.899999999999999, -8.299999999999999, -18.700000000000003, -10.499999999999998, -20.199999999999996, -4.300000000000001, -7.4, -8.3, -13.3, -4.300000000000001, -13.2, -6.4, -20.2, -22.200000000000006, -15.799999999999997, -13.2, -22.700000000000003, -13.299999999999999, -20.9, -8.3, -9.5, -6.3, -4.300000000000001, -64.80000000000004, -5.800000000000001, -11.3, -20.0, -6.199999999999999, -6.5, -7.899999999999999, -13.8, -11.5, -9.7, -9.999999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0698493671186717, "mean_inference_ms": 1.4204334496838555, "mean_action_processing_ms": 0.07671334719265664, "mean_env_wait_ms": 6.454828890894655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2908000, "timesteps_this_iter": 0, "agent_timesteps_total": 2908000, "timers": {"sample_time_ms": 20382.792, "sample_throughput": 196.244, "load_time_ms": 0.42, "load_throughput": 9520068.093, "learn_time_ms": 10008.599, "learn_throughput": 399.656, "update_time_ms": 1.965}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.21910435731362513, "policy_loss": -0.02386718264991237, "vf_loss": 24.08303129339731, "vf_explained_var": 0.22251533974883378, "kl": 0.012688798351412877, "entropy": 0.31508857558170955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2908000, "num_agent_steps_sampled": 2908000, "num_steps_trained": 2908000, "num_agent_steps_trained": 2908000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29240, "training_iteration": 727, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-56-29", "timestamp": 1643709389, "time_this_iter_s": 17.91335391998291, "time_total_s": 18413.183104515076, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6153.67422747612, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 33.256, "ram_util_percent": 62.227999999999994}}
{"episode_reward_max": -3.2, "episode_reward_min": -64.80000000000004, "episode_reward_mean": -12.959000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.1, -8.0, -19.9, -7.4, -14.399999999999999, -5.300000000000001, -4.300000000000001, -19.699999999999996, -4.4, -17.4, -17.799999999999997, -3.2, -20.10000000000001, -18.7, -20.799999999999997, -6.300000000000001, -18.8, -7.3999999999999995, -11.7, -18.3, -17.4, -4.1, -15.0, -12.4, -6.2, -17.4, -11.899999999999999, -8.299999999999999, -18.700000000000003, -10.499999999999998, -20.199999999999996, -4.300000000000001, -7.4, -8.3, -13.3, -4.300000000000001, -13.2, -6.4, -20.2, -22.200000000000006, -15.799999999999997, -13.2, -22.700000000000003, -13.299999999999999, -20.9, -8.3, -9.5, -6.3, -4.300000000000001, -64.80000000000004, -5.800000000000001, -11.3, -20.0, -6.199999999999999, -6.5, -7.899999999999999, -13.8, -11.5, -9.7, -9.999999999999996, -11.199999999999998, -7.2, -6.1, -25.4, -7.800000000000001, -5.2, -9.600000000000001, -17.6, -25.600000000000005, -5.4, -3.3, -20.3, -18.7, -43.1, -10.999999999999998, -23.900000000000006, -10.0, -15.599999999999998, -13.899999999999999, -4.2, -3.3, -5.300000000000001, -12.7, -12.6, -4.4, -12.399999999999999, -42.80000000000001, -4.300000000000001, -10.2, -4.0, -10.799999999999997, -8.5, -8.999999999999996, -31.799999999999997, -9.3, -13.7, -4.2, -10.9, -3.900000000000001, -9.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0700515882312762, "mean_inference_ms": 1.4209916065163661, "mean_action_processing_ms": 0.07674289062638556, "mean_env_wait_ms": 6.457106532923941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2912000, "timesteps_this_iter": 0, "agent_timesteps_total": 2912000, "timers": {"sample_time_ms": 20175.08, "sample_throughput": 198.264, "load_time_ms": 0.418, "load_throughput": 9568390.555, "learn_time_ms": 9769.74, "learn_throughput": 409.427, "update_time_ms": 1.897}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.19165112903561965, "policy_loss": -0.026343102068189652, "vf_loss": 21.621448668420957, "vf_explained_var": 0.03386676811402844, "kl": 0.010546657238473806, "entropy": 0.29086813889844443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2912000, "num_agent_steps_sampled": 2912000, "num_steps_trained": 2912000, "num_agent_steps_trained": 2912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29280, "training_iteration": 728, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-56-50", "timestamp": 1643709410, "time_this_iter_s": 20.563135862350464, "time_total_s": 18433.746240377426, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6174.2373633384705, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 36.455172413793115, "ram_util_percent": 62.31034482758621}}
{"episode_reward_max": -3.2, "episode_reward_min": -64.80000000000004, "episode_reward_mean": -12.491, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999997, -13.2, -22.700000000000003, -13.299999999999999, -20.9, -8.3, -9.5, -6.3, -4.300000000000001, -64.80000000000004, -5.800000000000001, -11.3, -20.0, -6.199999999999999, -6.5, -7.899999999999999, -13.8, -11.5, -9.7, -9.999999999999996, -11.199999999999998, -7.2, -6.1, -25.4, -7.800000000000001, -5.2, -9.600000000000001, -17.6, -25.600000000000005, -5.4, -3.3, -20.3, -18.7, -43.1, -10.999999999999998, -23.900000000000006, -10.0, -15.599999999999998, -13.899999999999999, -4.2, -3.3, -5.300000000000001, -12.7, -12.6, -4.4, -12.399999999999999, -42.80000000000001, -4.300000000000001, -10.2, -4.0, -10.799999999999997, -8.5, -8.999999999999996, -31.799999999999997, -9.3, -13.7, -4.2, -10.9, -3.900000000000001, -9.2, -6.800000000000001, -3.3, -14.3, -5.300000000000001, -12.699999999999998, -7.2, -11.999999999999998, -13.499999999999996, -12.2, -5.2, -9.3, -33.199999999999974, -21.4, -5.1, -12.899999999999997, -4.3, -15.699999999999994, -9.3, -3.2, -8.3, -7.099999999999998, -12.3, -23.2, -14.799999999999997, -15.899999999999997, -23.200000000000014, -4.700000000000001, -17.4, -3.2, -4.4, -9.6, -18.299999999999997, -6.499999999999999, -4.3, -11.399999999999999, -7.3, -26.3, -3.6000000000000005, -5.4, -24.800000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0703499895088762, "mean_inference_ms": 1.4215706900132556, "mean_action_processing_ms": 0.07677401565087302, "mean_env_wait_ms": 6.459527856237504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2916000, "timesteps_this_iter": 0, "agent_timesteps_total": 2916000, "timers": {"sample_time_ms": 19580.335, "sample_throughput": 204.287, "load_time_ms": 0.397, "load_throughput": 10074590.764, "learn_time_ms": 9753.411, "learn_throughput": 410.113, "update_time_ms": 1.858}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08892194291236259, "policy_loss": -0.028466911637975323, "vf_loss": 11.550529947139884, "vf_explained_var": 0.14175001196963813, "kl": 0.011161820686678783, "entropy": 0.3092282689466912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2916000, "num_agent_steps_sampled": 2916000, "num_steps_trained": 2916000, "num_agent_steps_trained": 2916000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29320, "training_iteration": 729, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-57-07", "timestamp": 1643709427, "time_this_iter_s": 16.893773078918457, "time_total_s": 18450.640013456345, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6191.131136417389, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 29.836, "ram_util_percent": 62.184000000000005}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.80000000000001, "episode_reward_mean": -11.488000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -5.300000000000001, -12.7, -12.6, -4.4, -12.399999999999999, -42.80000000000001, -4.300000000000001, -10.2, -4.0, -10.799999999999997, -8.5, -8.999999999999996, -31.799999999999997, -9.3, -13.7, -4.2, -10.9, -3.900000000000001, -9.2, -6.800000000000001, -3.3, -14.3, -5.300000000000001, -12.699999999999998, -7.2, -11.999999999999998, -13.499999999999996, -12.2, -5.2, -9.3, -33.199999999999974, -21.4, -5.1, -12.899999999999997, -4.3, -15.699999999999994, -9.3, -3.2, -8.3, -7.099999999999998, -12.3, -23.2, -14.799999999999997, -15.899999999999997, -23.200000000000014, -4.700000000000001, -17.4, -3.2, -4.4, -9.6, -18.299999999999997, -6.499999999999999, -4.3, -11.399999999999999, -7.3, -26.3, -3.6000000000000005, -5.4, -24.800000000000008, -13.199999999999998, -4.4, -13.3, -4.300000000000001, -39.90000000000008, -25.1, -3.2, -33.7, -9.0, -5.800000000000001, -10.700000000000001, -4.5, -12.2, -12.199999999999992, -13.899999999999997, -13.2, -3.7, -14.899999999999999, -19.299999999999997, -4.2, -10.3, -5.300000000000001, -4.300000000000001, -4.4, -15.399999999999999, -10.7, -13.5, -3.3, -13.3, -22.400000000000002, -3.4, -18.800000000000004, -20.6, -4.4, -21.6, -3.2, -4.4, -11.99999999999998, -10.2, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.070715137057366, "mean_inference_ms": 1.4222478118477015, "mean_action_processing_ms": 0.07680905527486852, "mean_env_wait_ms": 6.462510487770384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2920000, "timesteps_this_iter": 0, "agent_timesteps_total": 2920000, "timers": {"sample_time_ms": 19910.434, "sample_throughput": 200.9, "load_time_ms": 0.397, "load_throughput": 10067336.334, "learn_time_ms": 9515.028, "learn_throughput": 420.388, "update_time_ms": 1.792}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09974103818086767, "policy_loss": -0.027668003193152848, "vf_loss": 12.54620687115577, "vf_explained_var": 0.12128261609744, "kl": 0.011537628276398142, "entropy": 0.26227456420179335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2920000, "num_agent_steps_sampled": 2920000, "num_steps_trained": 2920000, "num_agent_steps_trained": 2920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29360, "training_iteration": 730, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-57-27", "timestamp": 1643709447, "time_this_iter_s": 20.0625638961792, "time_total_s": 18470.702577352524, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6211.193700313568, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 35.56071428571428, "ram_util_percent": 61.98928571428571}}
{"episode_reward_max": -3.2, "episode_reward_min": -39.90000000000008, "episode_reward_mean": -11.747, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.099999999999998, -12.3, -23.2, -14.799999999999997, -15.899999999999997, -23.200000000000014, -4.700000000000001, -17.4, -3.2, -4.4, -9.6, -18.299999999999997, -6.499999999999999, -4.3, -11.399999999999999, -7.3, -26.3, -3.6000000000000005, -5.4, -24.800000000000008, -13.199999999999998, -4.4, -13.3, -4.300000000000001, -39.90000000000008, -25.1, -3.2, -33.7, -9.0, -5.800000000000001, -10.700000000000001, -4.5, -12.2, -12.199999999999992, -13.899999999999997, -13.2, -3.7, -14.899999999999999, -19.299999999999997, -4.2, -10.3, -5.300000000000001, -4.300000000000001, -4.4, -15.399999999999999, -10.7, -13.5, -3.3, -13.3, -22.400000000000002, -3.4, -18.800000000000004, -20.6, -4.4, -21.6, -3.2, -4.4, -11.99999999999998, -10.2, -4.4, -16.0, -11.3, -17.700000000000003, -3.2, -20.799999999999997, -16.799999999999997, -10.2, -4.300000000000001, -18.0, -11.999999999999973, -6.4, -15.399999999999993, -14.099999999999998, -10.700000000000003, -7.399999999999999, -17.299999999999997, -5.300000000000001, -8.8, -15.7, -15.199999999999998, -5.9, -15.3, -19.900000000000006, -25.2, -13.299999999999995, -9.3, -4.300000000000001, -15.2, -4.2, -15.099999999999996, -4.2, -22.300000000000004, -5.300000000000001, -5.300000000000001, -4.300000000000001, -4.4, -5.4, -5.300000000000001, -8.599999999999998, -25.000000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0708646496041436, "mean_inference_ms": 1.4226254681688248, "mean_action_processing_ms": 0.07682834820343629, "mean_env_wait_ms": 6.464153448752921, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2924000, "timesteps_this_iter": 0, "agent_timesteps_total": 2924000, "timers": {"sample_time_ms": 19566.941, "sample_throughput": 204.426, "load_time_ms": 0.399, "load_throughput": 10036621.201, "learn_time_ms": 9446.187, "learn_throughput": 423.451, "update_time_ms": 1.786}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08390622168018293, "policy_loss": -0.017948995507071897, "vf_loss": 10.00582672408832, "vf_explained_var": 0.2663964456768446, "kl": 0.010648602549484193, "entropy": 0.2924752844597704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2924000, "num_agent_steps_sampled": 2924000, "num_steps_trained": 2924000, "num_agent_steps_trained": 2924000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29400, "training_iteration": 731, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-57-44", "timestamp": 1643709464, "time_this_iter_s": 17.197721004486084, "time_total_s": 18487.90029835701, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6228.391421318054, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 35.608, "ram_util_percent": 62.11200000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -36.900000000000006, "episode_reward_mean": -11.115999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -5.300000000000001, -4.300000000000001, -4.4, -15.399999999999999, -10.7, -13.5, -3.3, -13.3, -22.400000000000002, -3.4, -18.800000000000004, -20.6, -4.4, -21.6, -3.2, -4.4, -11.99999999999998, -10.2, -4.4, -16.0, -11.3, -17.700000000000003, -3.2, -20.799999999999997, -16.799999999999997, -10.2, -4.300000000000001, -18.0, -11.999999999999973, -6.4, -15.399999999999993, -14.099999999999998, -10.700000000000003, -7.399999999999999, -17.299999999999997, -5.300000000000001, -8.8, -15.7, -15.199999999999998, -5.9, -15.3, -19.900000000000006, -25.2, -13.299999999999995, -9.3, -4.300000000000001, -15.2, -4.2, -15.099999999999996, -4.2, -22.300000000000004, -5.300000000000001, -5.300000000000001, -4.300000000000001, -4.4, -5.4, -5.300000000000001, -8.599999999999998, -25.000000000000004, -4.2, -20.7, -11.199999999999996, -3.3, -4.300000000000001, -7.300000000000001, -5.5, -13.2, -10.5, -3.3, -4.3, -4.300000000000001, -6.5, -36.900000000000006, -6.6, -16.299999999999997, -22.799999999999997, -10.599999999999998, -5.2, -14.299999999999999, -10.1, -19.0, -4.3, -26.90000000000001, -3.2, -4.4, -5.3999999999999995, -5.4, -26.7, -4.5, -27.800000000000047, -10.2, -20.2, -4.3, -12.0, -13.299999999999997, -3.3, -10.799999999999999, -12.799999999999988, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0710970713896664, "mean_inference_ms": 1.4230986645504289, "mean_action_processing_ms": 0.0768527797540382, "mean_env_wait_ms": 6.466361989497273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2928000, "timesteps_this_iter": 0, "agent_timesteps_total": 2928000, "timers": {"sample_time_ms": 19408.561, "sample_throughput": 206.095, "load_time_ms": 0.384, "load_throughput": 10428403.779, "learn_time_ms": 9115.9, "learn_throughput": 438.794, "update_time_ms": 1.827}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10102070685756463, "policy_loss": -0.02254455476017889, "vf_loss": 12.1929034285007, "vf_explained_var": 0.3870943825731995, "kl": 0.009696181730018188, "entropy": 0.26343363795870095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2928000, "num_agent_steps_sampled": 2928000, "num_steps_trained": 2928000, "num_agent_steps_trained": 2928000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29440, "training_iteration": 732, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-58-06", "timestamp": 1643709486, "time_this_iter_s": 21.635838985443115, "time_total_s": 18509.536137342453, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6250.027260303497, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 31.396774193548385, "ram_util_percent": 62.064516129032256}}
{"episode_reward_max": -3.2, "episode_reward_min": -36.900000000000006, "episode_reward_mean": -11.126000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.9, -15.3, -19.900000000000006, -25.2, -13.299999999999995, -9.3, -4.300000000000001, -15.2, -4.2, -15.099999999999996, -4.2, -22.300000000000004, -5.300000000000001, -5.300000000000001, -4.300000000000001, -4.4, -5.4, -5.300000000000001, -8.599999999999998, -25.000000000000004, -4.2, -20.7, -11.199999999999996, -3.3, -4.300000000000001, -7.300000000000001, -5.5, -13.2, -10.5, -3.3, -4.3, -4.300000000000001, -6.5, -36.900000000000006, -6.6, -16.299999999999997, -22.799999999999997, -10.599999999999998, -5.2, -14.299999999999999, -10.1, -19.0, -4.3, -26.90000000000001, -3.2, -4.4, -5.3999999999999995, -5.4, -26.7, -4.5, -27.800000000000047, -10.2, -20.2, -4.3, -12.0, -13.299999999999997, -3.3, -10.799999999999999, -12.799999999999988, -5.4, -24.800000000000022, -10.0, -12.499999999999998, -16.2, -4.300000000000001, -9.3, -4.1, -3.5000000000000004, -20.0, -11.2, -10.999999999999998, -16.9, -15.2, -9.499999999999995, -3.7000000000000006, -16.1, -6.2, -3.3, -13.899999999999999, -11.3, -11.399999999999999, -12.499999999999995, -14.5, -14.199999999999992, -12.8, -4.1, -10.2, -7.3, -3.8000000000000003, -3.4, -4.2, -17.4, -35.80000000000001, -16.3, -19.500000000000007, -9.4, -8.2, -14.699999999999998, -6.4, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0714297416653524, "mean_inference_ms": 1.4235373913982234, "mean_action_processing_ms": 0.07687518326591902, "mean_env_wait_ms": 6.468406102301154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2932000, "timesteps_this_iter": 0, "agent_timesteps_total": 2932000, "timers": {"sample_time_ms": 19322.263, "sample_throughput": 207.015, "load_time_ms": 0.395, "load_throughput": 10126888.393, "learn_time_ms": 9366.237, "learn_throughput": 427.066, "update_time_ms": 1.837}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1022675054235464, "policy_loss": -0.027271530861335415, "vf_loss": 12.71828305093191, "vf_explained_var": 0.07825396804399387, "kl": 0.013962703051182536, "entropy": 0.29290035329358555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2932000, "num_agent_steps_sampled": 2932000, "num_steps_trained": 2932000, "num_agent_steps_trained": 2932000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29480, "training_iteration": 733, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-58-27", "timestamp": 1643709507, "time_this_iter_s": 21.804592847824097, "time_total_s": 18531.340730190277, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6271.831853151321, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 34.638709677419364, "ram_util_percent": 62.06774193548385}}
{"episode_reward_max": -3.2, "episode_reward_min": -106.3, "episode_reward_mean": -12.658999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -19.0, -4.3, -26.90000000000001, -3.2, -4.4, -5.3999999999999995, -5.4, -26.7, -4.5, -27.800000000000047, -10.2, -20.2, -4.3, -12.0, -13.299999999999997, -3.3, -10.799999999999999, -12.799999999999988, -5.4, -24.800000000000022, -10.0, -12.499999999999998, -16.2, -4.300000000000001, -9.3, -4.1, -3.5000000000000004, -20.0, -11.2, -10.999999999999998, -16.9, -15.2, -9.499999999999995, -3.7000000000000006, -16.1, -6.2, -3.3, -13.899999999999999, -11.3, -11.399999999999999, -12.499999999999995, -14.5, -14.199999999999992, -12.8, -4.1, -10.2, -7.3, -3.8000000000000003, -3.4, -4.2, -17.4, -35.80000000000001, -16.3, -19.500000000000007, -9.4, -8.2, -14.699999999999998, -6.4, -4.4, -9.3, -15.099999999999998, -9.2, -10.799999999999999, -12.999999999999982, -4.300000000000001, -9.4, -3.4, -6.300000000000001, -17.2, -4.300000000000001, -11.8, -11.3, -7.999999999999998, -13.399999999999999, -8.4, -6.4, -14.3, -16.299999999999986, -28.8, -7.4, -5.300000000000001, -6.4, -4.2, -10.600000000000001, -3.3, -12.799999999999999, -16.4, -4.3, -11.4, -5.2, -21.4, -41.2, -10.3, -4.300000000000001, -106.3, -4.3, -74.7, -3.3, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0718063223384098, "mean_inference_ms": 1.4239841629877548, "mean_action_processing_ms": 0.07689848552510742, "mean_env_wait_ms": 6.4705222581971045, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2936000, "timesteps_this_iter": 0, "agent_timesteps_total": 2936000, "timers": {"sample_time_ms": 19619.602, "sample_throughput": 203.878, "load_time_ms": 0.389, "load_throughput": 10288352.241, "learn_time_ms": 9615.918, "learn_throughput": 415.977, "update_time_ms": 1.887}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.7313172363085292, "policy_loss": -0.023225765880597854, "vf_loss": 75.26301680623844, "vf_explained_var": -0.03663657903671265, "kl": 0.011335469410576305, "entropy": 0.25088822785564646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2936000, "num_agent_steps_sampled": 2936000, "num_steps_trained": 2936000, "num_agent_steps_trained": 2936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29520, "training_iteration": 734, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-58-49", "timestamp": 1643709529, "time_this_iter_s": 21.500319004058838, "time_total_s": 18552.841049194336, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6293.33217215538, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 35.88666666666667, "ram_util_percent": 62.08666666666666}}
{"episode_reward_max": -3.3, "episode_reward_min": -106.3, "episode_reward_mean": -13.869999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.399999999999999, -12.499999999999995, -14.5, -14.199999999999992, -12.8, -4.1, -10.2, -7.3, -3.8000000000000003, -3.4, -4.2, -17.4, -35.80000000000001, -16.3, -19.500000000000007, -9.4, -8.2, -14.699999999999998, -6.4, -4.4, -9.3, -15.099999999999998, -9.2, -10.799999999999999, -12.999999999999982, -4.300000000000001, -9.4, -3.4, -6.300000000000001, -17.2, -4.300000000000001, -11.8, -11.3, -7.999999999999998, -13.399999999999999, -8.4, -6.4, -14.3, -16.299999999999986, -28.8, -7.4, -5.300000000000001, -6.4, -4.2, -10.600000000000001, -3.3, -12.799999999999999, -16.4, -4.3, -11.4, -5.2, -21.4, -41.2, -10.3, -4.300000000000001, -106.3, -4.3, -74.7, -3.3, -8.3, -7.4, -39.600000000000016, -15.4, -9.7, -10.000000000000002, -23.9, -22.300000000000022, -16.599999999999998, -8.7, -5.3, -24.999999999999996, -6.300000000000001, -5.300000000000001, -16.5, -4.3, -16.5, -7.2, -4.2, -15.799999999999997, -4.2, -4.800000000000001, -4.3, -19.7, -26.3, -15.699999999999998, -5.800000000000001, -9.599999999999998, -18.800000000000004, -13.3, -9.799999999999997, -17.7, -7.399999999999999, -4.300000000000001, -20.4, -31.2, -11.9, -20.0, -9.6, -28.2, -31.099999999999948], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.072311929126428, "mean_inference_ms": 1.4245870828711316, "mean_action_processing_ms": 0.07693057005588783, "mean_env_wait_ms": 6.473388702374856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2940000, "timesteps_this_iter": 0, "agent_timesteps_total": 2940000, "timers": {"sample_time_ms": 19973.206, "sample_throughput": 200.268, "load_time_ms": 0.386, "load_throughput": 10360783.054, "learn_time_ms": 9598.582, "learn_throughput": 416.728, "update_time_ms": 2.052}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16366611973843187, "policy_loss": -0.030456397730997332, "vf_loss": 19.139395881211886, "vf_explained_var": 0.027334434563113796, "kl": 0.016169268212157126, "entropy": 0.30622188893537367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2940000, "num_agent_steps_sampled": 2940000, "num_steps_trained": 2940000, "num_agent_steps_trained": 2940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29560, "training_iteration": 735, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-59-13", "timestamp": 1643709553, "time_this_iter_s": 24.443344831466675, "time_total_s": 18577.284394025803, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6317.775516986847, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 33.87714285714286, "ram_util_percent": 62.23428571428573}}
{"episode_reward_max": -3.2, "episode_reward_min": -106.3, "episode_reward_mean": -13.946000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -5.300000000000001, -6.4, -4.2, -10.600000000000001, -3.3, -12.799999999999999, -16.4, -4.3, -11.4, -5.2, -21.4, -41.2, -10.3, -4.300000000000001, -106.3, -4.3, -74.7, -3.3, -8.3, -7.4, -39.600000000000016, -15.4, -9.7, -10.000000000000002, -23.9, -22.300000000000022, -16.599999999999998, -8.7, -5.3, -24.999999999999996, -6.300000000000001, -5.300000000000001, -16.5, -4.3, -16.5, -7.2, -4.2, -15.799999999999997, -4.2, -4.800000000000001, -4.3, -19.7, -26.3, -15.699999999999998, -5.800000000000001, -9.599999999999998, -18.800000000000004, -13.3, -9.799999999999997, -17.7, -7.399999999999999, -4.300000000000001, -20.4, -31.2, -11.9, -20.0, -9.6, -28.2, -31.099999999999948, -7.6000000000000005, -30.900000000000006, -3.3, -8.5, -12.8, -5.3, -12.699999999999998, -14.199999999999982, -15.299999999999999, -12.299999999999997, -5.2, -17.5, -13.799999999999997, -9.4, -19.6, -5.3, -6.300000000000001, -6.6, -11.899999999999995, -18.000000000000004, -11.499999999999998, -13.899999999999986, -3.2, -5.4, -14.199999999999976, -14.699999999999987, -8.6, -10.4, -9.799999999999997, -5.4, -18.9, -9.100000000000001, -4.3, -10.8, -12.799999999999999, -6.300000000000001, -22.400000000000002, -18.200000000000003, -9.199999999999992, -13.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0729508102180625, "mean_inference_ms": 1.4255231003169595, "mean_action_processing_ms": 0.07698137925231145, "mean_env_wait_ms": 6.477683130442423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2944000, "timesteps_this_iter": 0, "agent_timesteps_total": 2944000, "timers": {"sample_time_ms": 20277.688, "sample_throughput": 197.261, "load_time_ms": 0.401, "load_throughput": 9975749.792, "learn_time_ms": 10039.432, "learn_throughput": 398.429, "update_time_ms": 2.153}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07904868642649343, "policy_loss": -0.016325259476559616, "vf_loss": 9.318121820624157, "vf_explained_var": 0.3153422760707076, "kl": 0.012993956144501759, "entropy": 0.2869879028169058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2944000, "num_agent_steps_sampled": 2944000, "num_steps_trained": 2944000, "num_agent_steps_trained": 2944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29600, "training_iteration": 736, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_09-59-38", "timestamp": 1643709578, "time_this_iter_s": 24.80735492706299, "time_total_s": 18602.091748952866, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6342.58287191391, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 37.82857142857143, "ram_util_percent": 62.29714285714287}}
{"episode_reward_max": -1.2, "episode_reward_min": -50.70000000000002, "episode_reward_mean": -12.823999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.800000000000001, -4.3, -19.7, -26.3, -15.699999999999998, -5.800000000000001, -9.599999999999998, -18.800000000000004, -13.3, -9.799999999999997, -17.7, -7.399999999999999, -4.300000000000001, -20.4, -31.2, -11.9, -20.0, -9.6, -28.2, -31.099999999999948, -7.6000000000000005, -30.900000000000006, -3.3, -8.5, -12.8, -5.3, -12.699999999999998, -14.199999999999982, -15.299999999999999, -12.299999999999997, -5.2, -17.5, -13.799999999999997, -9.4, -19.6, -5.3, -6.300000000000001, -6.6, -11.899999999999995, -18.000000000000004, -11.499999999999998, -13.899999999999986, -3.2, -5.4, -14.199999999999976, -14.699999999999987, -8.6, -10.4, -9.799999999999997, -5.4, -18.9, -9.100000000000001, -4.3, -10.8, -12.799999999999999, -6.300000000000001, -22.400000000000002, -18.200000000000003, -9.199999999999992, -13.499999999999998, -12.899999999999999, -21.5, -14.099999999999998, -18.90000000000001, -13.599999999999998, -34.79999999999999, -12.799999999999999, -22.0, -14.799999999999999, -3.3, -9.2, -16.59999999999999, -15.3, -6.2, -4.3, -19.50000000000002, -16.2, -7.3, -5.800000000000001, -9.799999999999999, -6.4, -7.4, -7.199999999999999, -17.5, -1.2, -3.3, -12.799999999999999, -15.799999999999999, -19.799999999999997, -12.0, -11.5, -9.3, -13.3, -19.5, -5.4, -4.300000000000001, -6.300000000000001, -6.300000000000001, -4.5, -50.70000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0737485966277913, "mean_inference_ms": 1.4267360613830606, "mean_action_processing_ms": 0.07704696292579805, "mean_env_wait_ms": 6.483165411319469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2948000, "timesteps_this_iter": 0, "agent_timesteps_total": 2948000, "timers": {"sample_time_ms": 21081.219, "sample_throughput": 189.742, "load_time_ms": 0.416, "load_throughput": 9608393.563, "learn_time_ms": 10371.804, "learn_throughput": 385.661, "update_time_ms": 2.108}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15199768919990927, "policy_loss": -0.019847380063466487, "vf_loss": 17.023050724819143, "vf_explained_var": 0.1460216159461647, "kl": 0.00956778247452303, "entropy": 0.2582483921079866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2948000, "num_agent_steps_sampled": 2948000, "num_steps_trained": 2948000, "num_agent_steps_trained": 2948000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29640, "training_iteration": 737, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-00-03", "timestamp": 1643709603, "time_this_iter_s": 24.847036838531494, "time_total_s": 18626.938785791397, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6367.429908752441, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 37.43055555555556, "ram_util_percent": 62.24999999999997}}
{"episode_reward_max": -1.2, "episode_reward_min": -50.70000000000002, "episode_reward_mean": -11.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.499999999999998, -13.899999999999986, -3.2, -5.4, -14.199999999999976, -14.699999999999987, -8.6, -10.4, -9.799999999999997, -5.4, -18.9, -9.100000000000001, -4.3, -10.8, -12.799999999999999, -6.300000000000001, -22.400000000000002, -18.200000000000003, -9.199999999999992, -13.499999999999998, -12.899999999999999, -21.5, -14.099999999999998, -18.90000000000001, -13.599999999999998, -34.79999999999999, -12.799999999999999, -22.0, -14.799999999999999, -3.3, -9.2, -16.59999999999999, -15.3, -6.2, -4.3, -19.50000000000002, -16.2, -7.3, -5.800000000000001, -9.799999999999999, -6.4, -7.4, -7.199999999999999, -17.5, -1.2, -3.3, -12.799999999999999, -15.799999999999999, -19.799999999999997, -12.0, -11.5, -9.3, -13.3, -19.5, -5.4, -4.300000000000001, -6.300000000000001, -6.300000000000001, -4.5, -50.70000000000002, -6.300000000000001, -14.099999999999998, -4.3, -14.099999999999984, -5.2, -6.300000000000001, -5.300000000000001, -12.499999999999998, -4.2, -19.10000000000001, -2.5, -21.600000000000005, -12.7, -11.899999999999991, -15.0, -3.3, -12.1, -9.6, -11.299999999999999, -4.3, -16.999999999999996, -4.3, -6.300000000000001, -44.2, -7.2, -9.3, -6.300000000000001, -14.4, -15.7, -9.499999999999998, -4.300000000000001, -7.300000000000001, -10.399999999999999, -4.4, -7.2, -7.300000000000001, -26.3, -12.9, -21.3, -21.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0745715320386893, "mean_inference_ms": 1.4277964537252015, "mean_action_processing_ms": 0.07710411894416436, "mean_env_wait_ms": 6.487963245449266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2952000, "timesteps_this_iter": 0, "agent_timesteps_total": 2952000, "timers": {"sample_time_ms": 21233.422, "sample_throughput": 188.382, "load_time_ms": 0.433, "load_throughput": 9229406.975, "learn_time_ms": 10874.458, "learn_throughput": 367.834, "update_time_ms": 2.166}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0973092963483425, "policy_loss": -0.02919819549186736, "vf_loss": 12.374201834746586, "vf_explained_var": 0.38111113700815424, "kl": 0.01638798516667864, "entropy": 0.2560847962655688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2952000, "num_agent_steps_sampled": 2952000, "num_steps_trained": 2952000, "num_agent_steps_trained": 2952000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29680, "training_iteration": 738, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-00-27", "timestamp": 1643709627, "time_this_iter_s": 23.812740087509155, "time_total_s": 18650.751525878906, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6391.242648839951, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 36.34411764705882, "ram_util_percent": 62.35588235294117}}
{"episode_reward_max": -1.2, "episode_reward_min": -87.5, "episode_reward_mean": -12.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -7.4, -7.199999999999999, -17.5, -1.2, -3.3, -12.799999999999999, -15.799999999999999, -19.799999999999997, -12.0, -11.5, -9.3, -13.3, -19.5, -5.4, -4.300000000000001, -6.300000000000001, -6.300000000000001, -4.5, -50.70000000000002, -6.300000000000001, -14.099999999999998, -4.3, -14.099999999999984, -5.2, -6.300000000000001, -5.300000000000001, -12.499999999999998, -4.2, -19.10000000000001, -2.5, -21.600000000000005, -12.7, -11.899999999999991, -15.0, -3.3, -12.1, -9.6, -11.299999999999999, -4.3, -16.999999999999996, -4.3, -6.300000000000001, -44.2, -7.2, -9.3, -6.300000000000001, -14.4, -15.7, -9.499999999999998, -4.300000000000001, -7.300000000000001, -10.399999999999999, -4.4, -7.2, -7.300000000000001, -26.3, -12.9, -21.3, -21.700000000000003, -19.799999999999997, -16.299999999999997, -5.4, -15.5, -21.6, -3.2, -5.300000000000001, -14.899999999999979, -5.2, -16.199999999999996, -11.7, -5.300000000000001, -14.2, -15.399999999999997, -28.800000000000004, -6.2, -28.3, -5.4, -14.299999999999999, -14.099999999999989, -13.499999999999998, -17.599999999999998, -16.9, -4.2, -8.1, -2.3, -18.200000000000014, -20.6, -4.2, -8.299999999999999, -87.5, -6.300000000000001, -22.1, -4.2, -20.900000000000002, -4.3, -15.399999999999999, -38.3, -4.2, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0754302757388874, "mean_inference_ms": 1.4287370299653577, "mean_action_processing_ms": 0.07715582644736202, "mean_env_wait_ms": 6.492256573736824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2956000, "timesteps_this_iter": 0, "agent_timesteps_total": 2956000, "timers": {"sample_time_ms": 22028.829, "sample_throughput": 181.58, "load_time_ms": 0.448, "load_throughput": 8920255.211, "learn_time_ms": 11276.434, "learn_throughput": 354.722, "update_time_ms": 2.249}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5692195956885654, "policy_loss": -0.017984494248465183, "vf_loss": 58.54540628210832, "vf_explained_var": -0.024797269862185244, "kl": 0.010370591542339677, "entropy": 0.28385511665174396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2956000, "num_agent_steps_sampled": 2956000, "num_steps_trained": 2956000, "num_agent_steps_trained": 2956000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29720, "training_iteration": 739, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-00-51", "timestamp": 1643709651, "time_this_iter_s": 23.82940125465393, "time_total_s": 18674.58092713356, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6415.0720500946045, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 38.37941176470588, "ram_util_percent": 62.41470588235294}}
{"episode_reward_max": -2.3, "episode_reward_min": -87.5, "episode_reward_mean": -13.336000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.999999999999996, -4.3, -6.300000000000001, -44.2, -7.2, -9.3, -6.300000000000001, -14.4, -15.7, -9.499999999999998, -4.300000000000001, -7.300000000000001, -10.399999999999999, -4.4, -7.2, -7.300000000000001, -26.3, -12.9, -21.3, -21.700000000000003, -19.799999999999997, -16.299999999999997, -5.4, -15.5, -21.6, -3.2, -5.300000000000001, -14.899999999999979, -5.2, -16.199999999999996, -11.7, -5.300000000000001, -14.2, -15.399999999999997, -28.800000000000004, -6.2, -28.3, -5.4, -14.299999999999999, -14.099999999999989, -13.499999999999998, -17.599999999999998, -16.9, -4.2, -8.1, -2.3, -18.200000000000014, -20.6, -4.2, -8.299999999999999, -87.5, -6.300000000000001, -22.1, -4.2, -20.900000000000002, -4.3, -15.399999999999999, -38.3, -4.2, -5.300000000000001, -22.400000000000002, -4.2, -8.4, -10.899999999999997, -6.300000000000001, -9.999999999999991, -28.599999999999998, -3.3, -20.0, -9.3, -3.4, -7.2, -15.199999999999998, -4.4, -27.400000000000006, -37.4, -10.299999999999997, -10.799999999999999, -12.499999999999996, -12.8, -12.0, -5.2, -15.399999999999999, -8.3, -4.2, -8.3, -29.3, -8.7, -4.3, -19.199999999999996, -29.400000000000002, -13.5, -3.4, -3.3, -17.299999999999997, -7.8999999999999995, -3.4, -7.8999999999999995, -12.899999999999999, -8.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0763361612885751, "mean_inference_ms": 1.4297751811270087, "mean_action_processing_ms": 0.07721357538271748, "mean_env_wait_ms": 6.496982366896953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2960000, "timesteps_this_iter": 0, "agent_timesteps_total": 2960000, "timers": {"sample_time_ms": 22501.225, "sample_throughput": 177.768, "load_time_ms": 0.464, "load_throughput": 8617842.614, "learn_time_ms": 11686.729, "learn_throughput": 342.269, "update_time_ms": 2.231}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15212479466547368, "policy_loss": -0.010869631636887788, "vf_loss": 16.152354252033977, "vf_explained_var": 0.17277310759790482, "kl": 0.008716366541544267, "entropy": 0.27701496280809884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2960000, "num_agent_steps_sampled": 2960000, "num_steps_trained": 2960000, "num_agent_steps_trained": 2960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29760, "training_iteration": 740, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-01-16", "timestamp": 1643709676, "time_this_iter_s": 24.85362410545349, "time_total_s": 18699.434551239014, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6439.925674200058, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 35.15428571428572, "ram_util_percent": 62.27142857142856}}
{"episode_reward_max": -2.3, "episode_reward_min": -87.5, "episode_reward_mean": -13.539000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.499999999999998, -17.599999999999998, -16.9, -4.2, -8.1, -2.3, -18.200000000000014, -20.6, -4.2, -8.299999999999999, -87.5, -6.300000000000001, -22.1, -4.2, -20.900000000000002, -4.3, -15.399999999999999, -38.3, -4.2, -5.300000000000001, -22.400000000000002, -4.2, -8.4, -10.899999999999997, -6.300000000000001, -9.999999999999991, -28.599999999999998, -3.3, -20.0, -9.3, -3.4, -7.2, -15.199999999999998, -4.4, -27.400000000000006, -37.4, -10.299999999999997, -10.799999999999999, -12.499999999999996, -12.8, -12.0, -5.2, -15.399999999999999, -8.3, -4.2, -8.3, -29.3, -8.7, -4.3, -19.199999999999996, -29.400000000000002, -13.5, -3.4, -3.3, -17.299999999999997, -7.8999999999999995, -3.4, -7.8999999999999995, -12.899999999999999, -8.1, -29.600000000000005, -25.800000000000022, -7.299999999999999, -5.300000000000001, -25.300000000000004, -30.6, -16.099999999999994, -9.2, -17.9, -23.1, -3.2, -5.2, -16.199999999999996, -28.10000000000001, -4.300000000000001, -5.4, -7.899999999999999, -4.9, -17.1, -8.2, -21.7, -11.8, -24.19999999999997, -23.200000000000003, -13.399999999999995, -3.6000000000000005, -12.899999999999997, -7.2, -3.3, -7.300000000000001, -3.3, -6.300000000000001, -17.3, -39.6, -3.7, -4.3, -12.199999999999996, -6.300000000000001, -19.50000000000001, -12.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0771646180292818, "mean_inference_ms": 1.4307544304695623, "mean_action_processing_ms": 0.07726888608167223, "mean_env_wait_ms": 6.501610576818211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2964000, "timesteps_this_iter": 0, "agent_timesteps_total": 2964000, "timers": {"sample_time_ms": 23106.973, "sample_throughput": 173.108, "load_time_ms": 0.48, "load_throughput": 8335676.455, "learn_time_ms": 12093.614, "learn_throughput": 330.753, "update_time_ms": 2.289}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17111366917354165, "policy_loss": -0.014385369782566384, "vf_loss": 18.35098987285809, "vf_explained_var": -0.04769525688181641, "kl": 0.011787519308522036, "entropy": 0.27710162733671484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2964000, "num_agent_steps_sampled": 2964000, "num_steps_trained": 2964000, "num_agent_steps_trained": 2964000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29800, "training_iteration": 741, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-01-39", "timestamp": 1643709699, "time_this_iter_s": 23.21272110939026, "time_total_s": 18722.647272348404, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6463.138395309448, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 37.95454545454546, "ram_util_percent": 62.13636363636363}}
{"episode_reward_max": -3.2, "episode_reward_min": -70.4, "episode_reward_mean": -13.794, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -5.2, -15.399999999999999, -8.3, -4.2, -8.3, -29.3, -8.7, -4.3, -19.199999999999996, -29.400000000000002, -13.5, -3.4, -3.3, -17.299999999999997, -7.8999999999999995, -3.4, -7.8999999999999995, -12.899999999999999, -8.1, -29.600000000000005, -25.800000000000022, -7.299999999999999, -5.300000000000001, -25.300000000000004, -30.6, -16.099999999999994, -9.2, -17.9, -23.1, -3.2, -5.2, -16.199999999999996, -28.10000000000001, -4.300000000000001, -5.4, -7.899999999999999, -4.9, -17.1, -8.2, -21.7, -11.8, -24.19999999999997, -23.200000000000003, -13.399999999999995, -3.6000000000000005, -12.899999999999997, -7.2, -3.3, -7.300000000000001, -3.3, -6.300000000000001, -17.3, -39.6, -3.7, -4.3, -12.199999999999996, -6.300000000000001, -19.50000000000001, -12.899999999999999, -18.199999999999996, -3.8000000000000003, -8.399999999999999, -5.3, -4.4, -28.900000000000002, -14.700000000000001, -12.299999999999999, -70.4, -9.5, -6.4, -9.3, -10.099999999999978, -23.2, -19.9, -19.400000000000038, -12.19999999999997, -13.2, -8.2, -17.4, -8.399999999999999, -11.3, -31.9, -6.999999999999999, -7.300000000000001, -6.4, -30.400000000000002, -21.900000000000002, -6.1, -21.0, -5.300000000000001, -8.3, -49.2, -5.799999999999999, -16.0, -5.300000000000001, -26.90000000000001, -4.300000000000001, -12.899999999999997, -11.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.077875168137372, "mean_inference_ms": 1.431668108043626, "mean_action_processing_ms": 0.07732143180636313, "mean_env_wait_ms": 6.505949134211135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2968000, "timesteps_this_iter": 0, "agent_timesteps_total": 2968000, "timers": {"sample_time_ms": 23584.502, "sample_throughput": 169.603, "load_time_ms": 0.512, "load_throughput": 7814623.876, "learn_time_ms": 12340.868, "learn_throughput": 324.126, "update_time_ms": 2.274}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.34935180603836974, "policy_loss": -0.02156947612441996, "vf_loss": 36.89402270547805, "vf_explained_var": 0.04287971283799859, "kl": 0.011739627862474584, "entropy": 0.28422179645908774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2968000, "num_agent_steps_sampled": 2968000, "num_steps_trained": 2968000, "num_agent_steps_trained": 2968000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29840, "training_iteration": 742, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-02-04", "timestamp": 1643709724, "time_this_iter_s": 24.800939798355103, "time_total_s": 18747.44821214676, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6487.939335107803, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 41.34166666666666, "ram_util_percent": 62.21666666666668}}
{"episode_reward_max": -2.2, "episode_reward_min": -70.4, "episode_reward_mean": -13.739, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.7, -11.8, -24.19999999999997, -23.200000000000003, -13.399999999999995, -3.6000000000000005, -12.899999999999997, -7.2, -3.3, -7.300000000000001, -3.3, -6.300000000000001, -17.3, -39.6, -3.7, -4.3, -12.199999999999996, -6.300000000000001, -19.50000000000001, -12.899999999999999, -18.199999999999996, -3.8000000000000003, -8.399999999999999, -5.3, -4.4, -28.900000000000002, -14.700000000000001, -12.299999999999999, -70.4, -9.5, -6.4, -9.3, -10.099999999999978, -23.2, -19.9, -19.400000000000038, -12.19999999999997, -13.2, -8.2, -17.4, -8.399999999999999, -11.3, -31.9, -6.999999999999999, -7.300000000000001, -6.4, -30.400000000000002, -21.900000000000002, -6.1, -21.0, -5.300000000000001, -8.3, -49.2, -5.799999999999999, -16.0, -5.300000000000001, -26.90000000000001, -4.300000000000001, -12.899999999999997, -11.8, -2.2, -26.5, -7.499999999999998, -4.3, -4.4, -24.6, -11.8, -3.2, -14.599999999999996, -7.799999999999993, -5.300000000000001, -26.300000000000004, -9.6, -5.4, -5.300000000000001, -11.2, -5.2, -9.2, -6.300000000000001, -9.3, -6.2, -8.499999999999998, -10.7, -19.4, -10.5, -8.9, -24.600000000000005, -15.6, -7.3, -5.300000000000001, -38.4, -3.3, -10.7, -12.099999999999998, -32.80000000000001, -21.900000000000002, -15.5, -3.3, -26.50000000000001, -25.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.078725840214542, "mean_inference_ms": 1.432720025885396, "mean_action_processing_ms": 0.07738101885269433, "mean_env_wait_ms": 6.510786961271125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2972000, "timesteps_this_iter": 0, "agent_timesteps_total": 2972000, "timers": {"sample_time_ms": 24028.946, "sample_throughput": 166.466, "load_time_ms": 0.517, "load_throughput": 7733217.792, "learn_time_ms": 12492.64, "learn_throughput": 320.189, "update_time_ms": 2.338}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16595539770724993, "policy_loss": -0.019513240821849836, "vf_loss": 18.312579514775226, "vf_explained_var": 0.08188216391430106, "kl": 0.013883536447443902, "entropy": 0.2810255767997875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2972000, "num_agent_steps_sampled": 2972000, "num_steps_trained": 2972000, "num_agent_steps_trained": 2972000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29880, "training_iteration": 743, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-02-29", "timestamp": 1643709749, "time_this_iter_s": 25.29014301300049, "time_total_s": 18772.73835515976, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6513.229478120804, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 41.66388888888889, "ram_util_percent": 62.2777777777778}}
{"episode_reward_max": -2.2, "episode_reward_min": -49.2, "episode_reward_mean": -13.811999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.399999999999999, -11.3, -31.9, -6.999999999999999, -7.300000000000001, -6.4, -30.400000000000002, -21.900000000000002, -6.1, -21.0, -5.300000000000001, -8.3, -49.2, -5.799999999999999, -16.0, -5.300000000000001, -26.90000000000001, -4.300000000000001, -12.899999999999997, -11.8, -2.2, -26.5, -7.499999999999998, -4.3, -4.4, -24.6, -11.8, -3.2, -14.599999999999996, -7.799999999999993, -5.300000000000001, -26.300000000000004, -9.6, -5.4, -5.300000000000001, -11.2, -5.2, -9.2, -6.300000000000001, -9.3, -6.2, -8.499999999999998, -10.7, -19.4, -10.5, -8.9, -24.600000000000005, -15.6, -7.3, -5.300000000000001, -38.4, -3.3, -10.7, -12.099999999999998, -32.80000000000001, -21.900000000000002, -15.5, -3.3, -26.50000000000001, -25.700000000000003, -11.399999999999983, -23.300000000000004, -6.4, -8.2, -21.700000000000003, -29.799999999999997, -24.700000000000006, -6.2, -12.79999999999998, -23.20000000000001, -5.300000000000001, -5.699999999999999, -13.999999999999998, -25.3, -18.099999999999998, -19.9, -8.700000000000001, -14.5, -23.400000000000013, -5.3, -15.299999999999997, -11.2, -11.399999999999999, -4.300000000000001, -5.300000000000001, -11.6, -11.7, -16.099999999999998, -10.599999999999982, -24.400000000000006, -10.7, -22.9, -27.2, -13.4, -19.1, -11.1, -18.700000000000003, -3.2, -12.799999999999999, -7.599999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.079503073472051, "mean_inference_ms": 1.4339357929879915, "mean_action_processing_ms": 0.07744831834418685, "mean_env_wait_ms": 6.516432079010121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2976000, "timesteps_this_iter": 0, "agent_timesteps_total": 2976000, "timers": {"sample_time_ms": 24379.41, "sample_throughput": 164.073, "load_time_ms": 0.521, "load_throughput": 7676954.333, "learn_time_ms": 12703.461, "learn_throughput": 314.875, "update_time_ms": 2.364}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.15037789589735448, "policy_loss": -0.010629893508889984, "vf_loss": 15.915923264718824, "vf_explained_var": 0.1020545235885087, "kl": 0.010954434046171706, "entropy": 0.29877232372440315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2976000, "num_agent_steps_sampled": 2976000, "num_steps_trained": 2976000, "num_agent_steps_trained": 2976000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29920, "training_iteration": 744, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-02-55", "timestamp": 1643709775, "time_this_iter_s": 25.579412937164307, "time_total_s": 18798.317768096924, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6538.808891057968, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 39.68055555555555, "ram_util_percent": 62.313888888888904}}
{"episode_reward_max": -3.2, "episode_reward_min": -71.3, "episode_reward_mean": -15.228, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -8.499999999999998, -10.7, -19.4, -10.5, -8.9, -24.600000000000005, -15.6, -7.3, -5.300000000000001, -38.4, -3.3, -10.7, -12.099999999999998, -32.80000000000001, -21.900000000000002, -15.5, -3.3, -26.50000000000001, -25.700000000000003, -11.399999999999983, -23.300000000000004, -6.4, -8.2, -21.700000000000003, -29.799999999999997, -24.700000000000006, -6.2, -12.79999999999998, -23.20000000000001, -5.300000000000001, -5.699999999999999, -13.999999999999998, -25.3, -18.099999999999998, -19.9, -8.700000000000001, -14.5, -23.400000000000013, -5.3, -15.299999999999997, -11.2, -11.399999999999999, -4.300000000000001, -5.300000000000001, -11.6, -11.7, -16.099999999999998, -10.599999999999982, -24.400000000000006, -10.7, -22.9, -27.2, -13.4, -19.1, -11.1, -18.700000000000003, -3.2, -12.799999999999999, -7.599999999999999, -5.799999999999999, -5.700000000000001, -40.6, -5.3, -15.599999999999998, -3.2, -25.400000000000013, -29.200000000000003, -41.3, -7.399999999999999, -30.2, -13.0, -14.599999999999975, -22.599999999999998, -19.9, -5.2, -12.2, -6.699999999999999, -4.300000000000001, -6.700000000000001, -15.099999999999998, -7.6000000000000005, -5.3, -20.600000000000012, -19.200000000000003, -49.3, -7.2, -71.3, -5.699999999999999, -4.3, -8.6, -7.699999999999998, -8.0, -7.3, -4.4, -13.099999999999998, -28.1, -5.9, -15.599999999999994, -19.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0804631040368144, "mean_inference_ms": 1.4352982968578154, "mean_action_processing_ms": 0.07752341841108958, "mean_env_wait_ms": 6.522741098382055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2980000, "timesteps_this_iter": 0, "agent_timesteps_total": 2980000, "timers": {"sample_time_ms": 24750.875, "sample_throughput": 161.61, "load_time_ms": 0.521, "load_throughput": 7672390.36, "learn_time_ms": 12779.372, "learn_throughput": 313.004, "update_time_ms": 2.416}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.46369057151599113, "policy_loss": -0.016544370018246192, "vf_loss": 47.834319752775215, "vf_explained_var": -0.05900997743811659, "kl": 0.011210404887382182, "entropy": 0.29205387910046887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2980000, "num_agent_steps_sampled": 2980000, "num_steps_trained": 2980000, "num_agent_steps_trained": 2980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 29960, "training_iteration": 745, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-03-22", "timestamp": 1643709802, "time_this_iter_s": 26.80298686027527, "time_total_s": 18825.1207549572, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6565.611877918243, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 40.10526315789473, "ram_util_percent": 62.37368421052632}}
{"episode_reward_max": -3.2, "episode_reward_min": -101.5, "episode_reward_mean": -15.968, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.299999999999997, -11.2, -11.399999999999999, -4.300000000000001, -5.300000000000001, -11.6, -11.7, -16.099999999999998, -10.599999999999982, -24.400000000000006, -10.7, -22.9, -27.2, -13.4, -19.1, -11.1, -18.700000000000003, -3.2, -12.799999999999999, -7.599999999999999, -5.799999999999999, -5.700000000000001, -40.6, -5.3, -15.599999999999998, -3.2, -25.400000000000013, -29.200000000000003, -41.3, -7.399999999999999, -30.2, -13.0, -14.599999999999975, -22.599999999999998, -19.9, -5.2, -12.2, -6.699999999999999, -4.300000000000001, -6.700000000000001, -15.099999999999998, -7.6000000000000005, -5.3, -20.600000000000012, -19.200000000000003, -49.3, -7.2, -71.3, -5.699999999999999, -4.3, -8.6, -7.699999999999998, -8.0, -7.3, -4.4, -13.099999999999998, -28.1, -5.9, -15.599999999999994, -19.9, -7.2, -5.300000000000001, -28.5, -35.50000000000001, -18.000000000000007, -13.4, -5.4, -6.300000000000001, -4.3, -16.9, -14.899999999999997, -15.899999999999997, -3.6000000000000005, -5.2, -15.499999999999996, -7.800000000000001, -21.0, -11.5, -6.0, -6.4, -9.6, -36.8, -25.0, -6.4, -11.5, -6.2, -23.200000000000035, -16.69999999999999, -16.199999999999985, -17.4, -31.1, -38.3, -7.2, -8.3, -101.5, -9.799999999999999, -6.3, -29.500000000000004, -24.7, -14.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0816099735432438, "mean_inference_ms": 1.4369309827803578, "mean_action_processing_ms": 0.07761197565637326, "mean_env_wait_ms": 6.530107936709069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2984000, "timesteps_this_iter": 0, "agent_timesteps_total": 2984000, "timers": {"sample_time_ms": 24996.965, "sample_throughput": 160.019, "load_time_ms": 0.525, "load_throughput": 7619772.913, "learn_time_ms": 12900.254, "learn_throughput": 310.071, "update_time_ms": 2.347}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5605800654989497, "policy_loss": -0.021187088710145765, "vf_loss": 57.9632732123457, "vf_explained_var": 0.016855461558988018, "kl": 0.012648504917698917, "entropy": 0.28486945124403124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2984000, "num_agent_steps_sampled": 2984000, "num_steps_trained": 2984000, "num_agent_steps_trained": 2984000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30000, "training_iteration": 746, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-03-49", "timestamp": 1643709829, "time_this_iter_s": 27.71632194519043, "time_total_s": 18852.83707690239, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6593.328199863434, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 36.917500000000004, "ram_util_percent": 62.379999999999995}}
{"episode_reward_max": -3.3, "episode_reward_min": -125.99999999999996, "episode_reward_mean": -17.195999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.099999999999998, -7.6000000000000005, -5.3, -20.600000000000012, -19.200000000000003, -49.3, -7.2, -71.3, -5.699999999999999, -4.3, -8.6, -7.699999999999998, -8.0, -7.3, -4.4, -13.099999999999998, -28.1, -5.9, -15.599999999999994, -19.9, -7.2, -5.300000000000001, -28.5, -35.50000000000001, -18.000000000000007, -13.4, -5.4, -6.300000000000001, -4.3, -16.9, -14.899999999999997, -15.899999999999997, -3.6000000000000005, -5.2, -15.499999999999996, -7.800000000000001, -21.0, -11.5, -6.0, -6.4, -9.6, -36.8, -25.0, -6.4, -11.5, -6.2, -23.200000000000035, -16.69999999999999, -16.199999999999985, -17.4, -31.1, -38.3, -7.2, -8.3, -101.5, -9.799999999999999, -6.3, -29.500000000000004, -24.7, -14.8, -28.7, -20.699999999999996, -13.3, -9.1, -7.2, -11.199999999999974, -19.199999999999996, -3.3, -3.3000000000000003, -19.2, -7.2, -22.199999999999996, -9.8, -21.200000000000003, -6.2, -15.5, -24.3, -17.799999999999997, -16.799999999999997, -26.9, -4.3, -17.600000000000005, -5.300000000000001, -23.0, -12.9, -7.2, -12.799999999999997, -10.9, -8.3, -5.300000000000001, -12.999999999999998, -20.999999999999996, -28.3, -17.799999999999997, -21.0, -29.2, -7.599999999999999, -125.99999999999996, -21.4, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.082816849434324, "mean_inference_ms": 1.4384972467716324, "mean_action_processing_ms": 0.07769706147948081, "mean_env_wait_ms": 6.537095792618177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2988000, "timesteps_this_iter": 0, "agent_timesteps_total": 2988000, "timers": {"sample_time_ms": 25094.754, "sample_throughput": 159.396, "load_time_ms": 0.539, "load_throughput": 7423875.393, "learn_time_ms": 13030.298, "learn_throughput": 306.977, "update_time_ms": 2.377}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.8215095062271982, "policy_loss": -0.021120352911893077, "vf_loss": 84.11260589053553, "vf_explained_var": 0.04774328085684007, "kl": 0.008911492707835823, "entropy": 0.29385369593097316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2988000, "num_agent_steps_sampled": 2988000, "num_steps_trained": 2988000, "num_agent_steps_trained": 2988000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30040, "training_iteration": 747, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-04-15", "timestamp": 1643709855, "time_this_iter_s": 25.92295813560486, "time_total_s": 18878.760035037994, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6619.251157999039, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 34.85405405405405, "ram_util_percent": 62.41621621621622}}
{"episode_reward_max": -3.3, "episode_reward_min": -125.99999999999996, "episode_reward_mean": -17.398999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.6, -36.8, -25.0, -6.4, -11.5, -6.2, -23.200000000000035, -16.69999999999999, -16.199999999999985, -17.4, -31.1, -38.3, -7.2, -8.3, -101.5, -9.799999999999999, -6.3, -29.500000000000004, -24.7, -14.8, -28.7, -20.699999999999996, -13.3, -9.1, -7.2, -11.199999999999974, -19.199999999999996, -3.3, -3.3000000000000003, -19.2, -7.2, -22.199999999999996, -9.8, -21.200000000000003, -6.2, -15.5, -24.3, -17.799999999999997, -16.799999999999997, -26.9, -4.3, -17.600000000000005, -5.300000000000001, -23.0, -12.9, -7.2, -12.799999999999997, -10.9, -8.3, -5.300000000000001, -12.999999999999998, -20.999999999999996, -28.3, -17.799999999999997, -21.0, -29.2, -7.599999999999999, -125.99999999999996, -21.4, -10.3, -11.899999999999999, -19.799999999999997, -31.400000000000002, -8.899999999999999, -10.299999999999999, -4.4, -8.1, -9.0, -24.499999999999996, -22.4, -17.500000000000004, -10.6, -14.599999999999998, -25.500000000000004, -12.999999999999998, -3.3, -21.700000000000003, -19.699999999999996, -3.6, -10.3, -5.300000000000001, -4.4, -6.2, -13.199999999999973, -4.4, -17.999999999999996, -14.49999999999999, -13.999999999999996, -6.2, -82.2, -9.399999999999999, -12.9, -18.299999999999997, -5.4, -16.799999999999997, -17.9, -4.2, -12.5, -28.6, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0839333289229283, "mean_inference_ms": 1.440017702843139, "mean_action_processing_ms": 0.07777958435565163, "mean_env_wait_ms": 6.543929173835948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2992000, "timesteps_this_iter": 0, "agent_timesteps_total": 2992000, "timers": {"sample_time_ms": 25426.819, "sample_throughput": 157.314, "load_time_ms": 0.544, "load_throughput": 7351334.677, "learn_time_ms": 13114.963, "learn_throughput": 304.995, "update_time_ms": 2.363}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.35790062061240596, "policy_loss": -0.017039314092647646, "vf_loss": 37.32229256822217, "vf_explained_var": 0.05959954774507912, "kl": 0.010174915662022591, "entropy": 0.2900076428007695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2992000, "num_agent_steps_sampled": 2992000, "num_steps_trained": 2992000, "num_agent_steps_trained": 2992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30080, "training_iteration": 748, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-04-42", "timestamp": 1643709882, "time_this_iter_s": 26.668241024017334, "time_total_s": 18905.42827606201, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6645.919399023056, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 38.93421052631578, "ram_util_percent": 62.47105263157897}}
{"episode_reward_max": -3.3, "episode_reward_min": -125.99999999999996, "episode_reward_mean": -15.417999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -17.600000000000005, -5.300000000000001, -23.0, -12.9, -7.2, -12.799999999999997, -10.9, -8.3, -5.300000000000001, -12.999999999999998, -20.999999999999996, -28.3, -17.799999999999997, -21.0, -29.2, -7.599999999999999, -125.99999999999996, -21.4, -10.3, -11.899999999999999, -19.799999999999997, -31.400000000000002, -8.899999999999999, -10.299999999999999, -4.4, -8.1, -9.0, -24.499999999999996, -22.4, -17.500000000000004, -10.6, -14.599999999999998, -25.500000000000004, -12.999999999999998, -3.3, -21.700000000000003, -19.699999999999996, -3.6, -10.3, -5.300000000000001, -4.4, -6.2, -13.199999999999973, -4.4, -17.999999999999996, -14.49999999999999, -13.999999999999996, -6.2, -82.2, -9.399999999999999, -12.9, -18.299999999999997, -5.4, -16.799999999999997, -17.9, -4.2, -12.5, -28.6, -8.2, -5.2, -7.4, -5.799999999999999, -20.0, -4.300000000000001, -6.4, -23.299999999999997, -5.300000000000001, -19.700000000000003, -6.3, -20.0, -11.899999999999995, -6.300000000000001, -8.3, -5.2, -42.3, -9.999999999999998, -10.3, -10.999999999999996, -6.9, -4.2, -32.2, -3.4, -18.8, -12.700000000000001, -19.9, -3.3, -13.999999999999998, -5.2, -7.4, -50.900000000000006, -17.5, -5.2, -7.7, -27.1, -17.599999999999998, -22.400000000000002, -16.5, -9.3, -14.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0851269558891767, "mean_inference_ms": 1.441800071405122, "mean_action_processing_ms": 0.07787639287572821, "mean_env_wait_ms": 6.552201901663954, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2996000, "timesteps_this_iter": 0, "agent_timesteps_total": 2996000, "timers": {"sample_time_ms": 25796.742, "sample_throughput": 155.058, "load_time_ms": 0.55, "load_throughput": 7267583.279, "learn_time_ms": 13144.326, "learn_throughput": 304.314, "update_time_ms": 2.318}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16214980656501427, "policy_loss": -0.0194487472014722, "vf_loss": 17.98911812971997, "vf_explained_var": 0.20368501441453093, "kl": 0.010117795217694663, "entropy": 0.252287172566178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2996000, "num_agent_steps_sampled": 2996000, "num_steps_trained": 2996000, "num_agent_steps_trained": 2996000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30120, "training_iteration": 749, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-05-09", "timestamp": 1643709909, "time_this_iter_s": 26.970212697982788, "time_total_s": 18932.398488759995, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6672.889611721039, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 44.35, "ram_util_percent": 62.27894736842107}}
{"episode_reward_max": -3.3, "episode_reward_min": -82.2, "episode_reward_mean": -14.604, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -4.4, -6.2, -13.199999999999973, -4.4, -17.999999999999996, -14.49999999999999, -13.999999999999996, -6.2, -82.2, -9.399999999999999, -12.9, -18.299999999999997, -5.4, -16.799999999999997, -17.9, -4.2, -12.5, -28.6, -8.2, -5.2, -7.4, -5.799999999999999, -20.0, -4.300000000000001, -6.4, -23.299999999999997, -5.300000000000001, -19.700000000000003, -6.3, -20.0, -11.899999999999995, -6.300000000000001, -8.3, -5.2, -42.3, -9.999999999999998, -10.3, -10.999999999999996, -6.9, -4.2, -32.2, -3.4, -18.8, -12.700000000000001, -19.9, -3.3, -13.999999999999998, -5.2, -7.4, -50.900000000000006, -17.5, -5.2, -7.7, -27.1, -17.599999999999998, -22.400000000000002, -16.5, -9.3, -14.3, -11.699999999999998, -12.2, -3.8000000000000003, -25.600000000000005, -10.999999999999998, -13.0, -9.3, -16.399999999999995, -6.2, -10.700000000000001, -22.399999999999995, -16.599999999999998, -19.4, -9.3, -7.300000000000001, -14.3, -5.4, -7.300000000000001, -6.1, -10.3, -21.2, -41.3, -17.099999999999998, -10.3, -6.3, -34.7, -20.800000000000004, -10.6, -12.899999999999999, -4.2, -21.9, -27.400000000000006, -16.099999999999994, -15.099999999999996, -21.199999999999996, -4.2, -22.4, -7.1, -22.2, -37.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0859726931983298, "mean_inference_ms": 1.4431740458486786, "mean_action_processing_ms": 0.07795165325188116, "mean_env_wait_ms": 6.558646825514386, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3000000, "timesteps_this_iter": 0, "agent_timesteps_total": 3000000, "timers": {"sample_time_ms": 25636.356, "sample_throughput": 156.028, "load_time_ms": 0.547, "load_throughput": 7314477.046, "learn_time_ms": 13038.791, "learn_throughput": 306.777, "update_time_ms": 2.345}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.18453910120672756, "policy_loss": -0.02051930808492245, "vf_loss": 20.305415148247956, "vf_explained_var": 0.06866663111153469, "kl": 0.011877100011265929, "entropy": 0.2743369508494613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3000000, "num_agent_steps_sampled": 3000000, "num_steps_trained": 3000000, "num_agent_steps_trained": 3000000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30160, "training_iteration": 750, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-05-31", "timestamp": 1643709931, "time_this_iter_s": 21.907387256622314, "time_total_s": 18954.305876016617, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6694.796998977661, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 32.80967741935484, "ram_util_percent": 62.32580645161291}}
{"episode_reward_max": -3.3, "episode_reward_min": -50.900000000000006, "episode_reward_mean": -14.502999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -32.2, -3.4, -18.8, -12.700000000000001, -19.9, -3.3, -13.999999999999998, -5.2, -7.4, -50.900000000000006, -17.5, -5.2, -7.7, -27.1, -17.599999999999998, -22.400000000000002, -16.5, -9.3, -14.3, -11.699999999999998, -12.2, -3.8000000000000003, -25.600000000000005, -10.999999999999998, -13.0, -9.3, -16.399999999999995, -6.2, -10.700000000000001, -22.399999999999995, -16.599999999999998, -19.4, -9.3, -7.300000000000001, -14.3, -5.4, -7.300000000000001, -6.1, -10.3, -21.2, -41.3, -17.099999999999998, -10.3, -6.3, -34.7, -20.800000000000004, -10.6, -12.899999999999999, -4.2, -21.9, -27.400000000000006, -16.099999999999994, -15.099999999999996, -21.199999999999996, -4.2, -22.4, -7.1, -22.2, -37.0, -11.799999999999999, -14.1, -16.7, -17.0, -6.2, -6.4, -5.2, -18.799999999999997, -23.000000000000004, -5.3, -5.300000000000001, -10.3, -11.4, -6.300000000000001, -11.6, -5.2, -28.700000000000003, -30.0, -27.800000000000004, -17.200000000000003, -8.299999999999999, -11.199999999999998, -5.4, -17.8, -18.2, -8.5, -9.3, -5.2, -15.999999999999998, -17.699999999999996, -12.0, -3.3, -8.4, -15.0, -21.000000000000007, -9.999999999999996, -13.1, -21.6, -7.099999999999998, -21.000000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.086509787393993, "mean_inference_ms": 1.443902579313047, "mean_action_processing_ms": 0.07799177671070655, "mean_env_wait_ms": 6.562039841708247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3004000, "timesteps_this_iter": 0, "agent_timesteps_total": 3004000, "timers": {"sample_time_ms": 25443.587, "sample_throughput": 157.211, "load_time_ms": 0.541, "load_throughput": 7389216.472, "learn_time_ms": 12976.04, "learn_throughput": 308.26, "update_time_ms": 2.327}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13366263530527553, "policy_loss": -0.014428859152230284, "vf_loss": 14.6146323150845, "vf_explained_var": 0.19576390174127395, "kl": 0.011526956246597098, "entropy": 0.2722368549515483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3004000, "num_agent_steps_sampled": 3004000, "num_steps_trained": 3004000, "num_agent_steps_trained": 3004000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30200, "training_iteration": 751, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-05-53", "timestamp": 1643709953, "time_this_iter_s": 21.711010217666626, "time_total_s": 18976.016886234283, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6716.508009195328, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 31.519354838709678, "ram_util_percent": 62.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.09999999999994, "episode_reward_mean": -14.47, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.2, -41.3, -17.099999999999998, -10.3, -6.3, -34.7, -20.800000000000004, -10.6, -12.899999999999999, -4.2, -21.9, -27.400000000000006, -16.099999999999994, -15.099999999999996, -21.199999999999996, -4.2, -22.4, -7.1, -22.2, -37.0, -11.799999999999999, -14.1, -16.7, -17.0, -6.2, -6.4, -5.2, -18.799999999999997, -23.000000000000004, -5.3, -5.300000000000001, -10.3, -11.4, -6.300000000000001, -11.6, -5.2, -28.700000000000003, -30.0, -27.800000000000004, -17.200000000000003, -8.299999999999999, -11.199999999999998, -5.4, -17.8, -18.2, -8.5, -9.3, -5.2, -15.999999999999998, -17.699999999999996, -12.0, -3.3, -8.4, -15.0, -21.000000000000007, -9.999999999999996, -13.1, -21.6, -7.099999999999998, -21.000000000000007, -23.900000000000002, -6.3, -19.999999999999996, -12.2, -11.899999999999999, -5.300000000000001, -23.800000000000004, -4.300000000000001, -24.0, -14.199999999999998, -40.800000000000026, -20.799999999999997, -4.3, -9.599999999999998, -9.799999999999999, -19.4, -5.2, -8.099999999999993, -14.399999999999999, -11.299999999999997, -8.0, -4.3, -10.499999999999998, -27.3, -7.499999999999998, -4.3, -10.0, -6.2, -5.2, -8.4, -5.300000000000001, -6.300000000000001, -10.0, -3.2, -29.699999999999996, -11.899999999999999, -4.800000000000001, -33.10000000000003, -46.09999999999994, -12.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0868198270467548, "mean_inference_ms": 1.4441676765360212, "mean_action_processing_ms": 0.07800673433331827, "mean_env_wait_ms": 6.563233482926915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3008000, "timesteps_this_iter": 0, "agent_timesteps_total": 3008000, "timers": {"sample_time_ms": 25213.824, "sample_throughput": 158.643, "load_time_ms": 0.514, "load_throughput": 7775869.485, "learn_time_ms": 12767.744, "learn_throughput": 313.289, "update_time_ms": 2.3}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17390945362382798, "policy_loss": -0.03351824559691933, "vf_loss": 20.49873751773629, "vf_explained_var": -0.017389084062268658, "kl": 0.014461202922420816, "entropy": 0.3005966371185677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3008000, "num_agent_steps_sampled": 3008000, "num_steps_trained": 3008000, "num_agent_steps_trained": 3008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30240, "training_iteration": 752, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-06-14", "timestamp": 1643709974, "time_this_iter_s": 21.05298399925232, "time_total_s": 18997.069870233536, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6737.56099319458, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 28.916666666666668, "ram_util_percent": 62.363333333333344}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.09999999999994, "episode_reward_mean": -12.939, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.299999999999999, -11.199999999999998, -5.4, -17.8, -18.2, -8.5, -9.3, -5.2, -15.999999999999998, -17.699999999999996, -12.0, -3.3, -8.4, -15.0, -21.000000000000007, -9.999999999999996, -13.1, -21.6, -7.099999999999998, -21.000000000000007, -23.900000000000002, -6.3, -19.999999999999996, -12.2, -11.899999999999999, -5.300000000000001, -23.800000000000004, -4.300000000000001, -24.0, -14.199999999999998, -40.800000000000026, -20.799999999999997, -4.3, -9.599999999999998, -9.799999999999999, -19.4, -5.2, -8.099999999999993, -14.399999999999999, -11.299999999999997, -8.0, -4.3, -10.499999999999998, -27.3, -7.499999999999998, -4.3, -10.0, -6.2, -5.2, -8.4, -5.300000000000001, -6.300000000000001, -10.0, -3.2, -29.699999999999996, -11.899999999999999, -4.800000000000001, -33.10000000000003, -46.09999999999994, -12.9, -20.6, -16.5, -10.2, -8.3, -17.0, -11.899999999999979, -11.6, -17.0, -18.4, -10.700000000000001, -16.4, -17.099999999999998, -11.9, -21.799999999999997, -8.7, -4.4, -38.700000000000095, -14.299999999999999, -10.4, -6.2, -9.3, -5.4, -14.2, -4.3, -13.099999999999996, -3.3, -5.2, -11.899999999999995, -6.2, -8.299999999999999, -5.2, -12.2, -4.300000000000001, -22.799999999999997, -11.3, -5.2, -14.399999999999999, -11.499999999999998, -8.7, -30.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0870508091271085, "mean_inference_ms": 1.4442853186014388, "mean_action_processing_ms": 0.07801413512568546, "mean_env_wait_ms": 6.563705733123979, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3012000, "timesteps_this_iter": 0, "agent_timesteps_total": 3012000, "timers": {"sample_time_ms": 24714.968, "sample_throughput": 161.845, "load_time_ms": 0.505, "load_throughput": 7914527.786, "learn_time_ms": 12606.694, "learn_throughput": 317.292, "update_time_ms": 2.227}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07511431447240294, "policy_loss": -0.03045775653714294, "vf_loss": 10.375173847906051, "vf_explained_var": 0.3813738965219067, "kl": 0.010787171256627353, "entropy": 0.2687680699011331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3012000, "num_agent_steps_sampled": 3012000, "num_steps_trained": 3012000, "num_agent_steps_trained": 3012000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30280, "training_iteration": 753, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-06-35", "timestamp": 1643709995, "time_this_iter_s": 20.78097677230835, "time_total_s": 19017.850847005844, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6758.341969966888, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 34.563333333333325, "ram_util_percent": 62.33666666666667}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.09999999999994, "episode_reward_mean": -11.145999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, -4.3, -10.499999999999998, -27.3, -7.499999999999998, -4.3, -10.0, -6.2, -5.2, -8.4, -5.300000000000001, -6.300000000000001, -10.0, -3.2, -29.699999999999996, -11.899999999999999, -4.800000000000001, -33.10000000000003, -46.09999999999994, -12.9, -20.6, -16.5, -10.2, -8.3, -17.0, -11.899999999999979, -11.6, -17.0, -18.4, -10.700000000000001, -16.4, -17.099999999999998, -11.9, -21.799999999999997, -8.7, -4.4, -38.700000000000095, -14.299999999999999, -10.4, -6.2, -9.3, -5.4, -14.2, -4.3, -13.099999999999996, -3.3, -5.2, -11.899999999999995, -6.2, -8.299999999999999, -5.2, -12.2, -4.300000000000001, -22.799999999999997, -11.3, -5.2, -14.399999999999999, -11.499999999999998, -8.7, -30.299999999999997, -11.099999999999998, -10.3, -18.7, -11.599999999999998, -14.9, -10.199999999999998, -5.300000000000001, -11.8, -17.4, -4.2, -5.699999999999999, -4.4, -5.2, -9.0, -5.300000000000001, -4.2, -10.899999999999999, -13.399999999999997, -7.300000000000001, -24.700000000000003, -13.2, -10.699999999999998, -11.5, -4.2, -4.300000000000001, -9.199999999999998, -8.3, -3.7, -9.3, -3.2, -6.2, -5.2, -10.6, -5.2, -5.300000000000001, -4.800000000000001, -19.2, -10.3, -5.0, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0872364044448084, "mean_inference_ms": 1.4444028447136463, "mean_action_processing_ms": 0.07802115329766109, "mean_env_wait_ms": 6.564259053590183, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3016000, "timesteps_this_iter": 0, "agent_timesteps_total": 3016000, "timers": {"sample_time_ms": 24353.514, "sample_throughput": 164.247, "load_time_ms": 0.499, "load_throughput": 8022002.486, "learn_time_ms": 12329.322, "learn_throughput": 324.43, "update_time_ms": 2.17}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0486507196647806, "policy_loss": -0.022897092788730578, "vf_loss": 6.900962881215157, "vf_explained_var": 0.27822337118528223, "kl": 0.015041097740131147, "entropy": 0.2589126535881591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3016000, "num_agent_steps_sampled": 3016000, "num_steps_trained": 3016000, "num_agent_steps_trained": 3016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30320, "training_iteration": 754, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-06-56", "timestamp": 1643710016, "time_this_iter_s": 20.81103205680847, "time_total_s": 19038.661879062653, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6779.153002023697, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 34.21, "ram_util_percent": 62.37999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.2, "episode_reward_mean": -11.071999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -5.4, -14.2, -4.3, -13.099999999999996, -3.3, -5.2, -11.899999999999995, -6.2, -8.299999999999999, -5.2, -12.2, -4.300000000000001, -22.799999999999997, -11.3, -5.2, -14.399999999999999, -11.499999999999998, -8.7, -30.299999999999997, -11.099999999999998, -10.3, -18.7, -11.599999999999998, -14.9, -10.199999999999998, -5.300000000000001, -11.8, -17.4, -4.2, -5.699999999999999, -4.4, -5.2, -9.0, -5.300000000000001, -4.2, -10.899999999999999, -13.399999999999997, -7.300000000000001, -24.700000000000003, -13.2, -10.699999999999998, -11.5, -4.2, -4.300000000000001, -9.199999999999998, -8.3, -3.7, -9.3, -3.2, -6.2, -5.2, -10.6, -5.2, -5.300000000000001, -4.800000000000001, -19.2, -10.3, -5.0, -5.4, -3.3, -4.4, -9.499999999999998, -20.10000000000001, -13.1, -11.3, -9.3, -11.699999999999998, -19.699999999999996, -19.1, -28.2, -21.300000000000004, -14.099999999999989, -4.7, -13.2, -8.3, -5.799999999999999, -21.799999999999997, -17.2, -11.199999999999987, -14.999999999999996, -41.2, -7.4, -23.400000000000002, -15.199999999999998, -20.7, -10.4, -12.499999999999998, -9.2, -15.299999999999997, -6.2, -30.60000000000001, -5.3, -6.2, -4.3, -6.300000000000001, -6.999999999999999, -16.799999999999997, -7.300000000000001, -12.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0872750916964784, "mean_inference_ms": 1.4444265215619965, "mean_action_processing_ms": 0.07802271203338344, "mean_env_wait_ms": 6.564476501575745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3020000, "timesteps_this_iter": 0, "agent_timesteps_total": 3020000, "timers": {"sample_time_ms": 23680.228, "sample_throughput": 168.917, "load_time_ms": 0.49, "load_throughput": 8168070.107, "learn_time_ms": 11970.527, "learn_throughput": 334.154, "update_time_ms": 2.064}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12822453885299143, "policy_loss": -0.02659191377260672, "vf_loss": 15.255285944733568, "vf_explained_var": 0.27838006340047367, "kl": 0.013413904576871971, "entropy": 0.3006068194905917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3020000, "num_agent_steps_sampled": 3020000, "num_steps_trained": 3020000, "num_agent_steps_trained": 3020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30360, "training_iteration": 755, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-07-15", "timestamp": 1643710035, "time_this_iter_s": 19.26024603843689, "time_total_s": 19057.92212510109, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6798.413248062134, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 31.65555555555556, "ram_util_percent": 62.38148148148149}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.2, "episode_reward_mean": -11.884000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.2, -10.699999999999998, -11.5, -4.2, -4.300000000000001, -9.199999999999998, -8.3, -3.7, -9.3, -3.2, -6.2, -5.2, -10.6, -5.2, -5.300000000000001, -4.800000000000001, -19.2, -10.3, -5.0, -5.4, -3.3, -4.4, -9.499999999999998, -20.10000000000001, -13.1, -11.3, -9.3, -11.699999999999998, -19.699999999999996, -19.1, -28.2, -21.300000000000004, -14.099999999999989, -4.7, -13.2, -8.3, -5.799999999999999, -21.799999999999997, -17.2, -11.199999999999987, -14.999999999999996, -41.2, -7.4, -23.400000000000002, -15.199999999999998, -20.7, -10.4, -12.499999999999998, -9.2, -15.299999999999997, -6.2, -30.60000000000001, -5.3, -6.2, -4.3, -6.300000000000001, -6.999999999999999, -16.799999999999997, -7.300000000000001, -12.099999999999998, -13.999999999999998, -10.799999999999999, -20.600000000000005, -12.2, -13.299999999999999, -5.3, -11.9, -5.9, -11.700000000000001, -21.700000000000003, -15.3, -24.700000000000003, -5.3, -23.700000000000017, -21.100000000000005, -4.9, -6.6000000000000005, -8.5, -4.300000000000001, -9.2, -6.2, -23.2, -18.2, -16.499999999999996, -8.2, -13.6, -11.099999999999994, -13.0, -8.3, -9.1, -10.3, -7.2, -11.5, -13.799999999999999, -27.3, -14.4, -4.2, -10.399999999999999, -5.2, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0873250143506457, "mean_inference_ms": 1.4443667991636848, "mean_action_processing_ms": 0.07801986303637864, "mean_env_wait_ms": 6.564187827441981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3024000, "timesteps_this_iter": 0, "agent_timesteps_total": 3024000, "timers": {"sample_time_ms": 22891.446, "sample_throughput": 174.738, "load_time_ms": 0.478, "load_throughput": 8364351.381, "learn_time_ms": 11625.245, "learn_throughput": 344.079, "update_time_ms": 2.038}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09363451059607249, "policy_loss": -0.02672591651389275, "vf_loss": 11.779612860051534, "vf_explained_var": 0.15498505920492192, "kl": 0.015195854812001738, "entropy": 0.2937609963840054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3024000, "num_agent_steps_sampled": 3024000, "num_steps_trained": 3024000, "num_agent_steps_trained": 3024000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30400, "training_iteration": 756, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-07-35", "timestamp": 1643710055, "time_this_iter_s": 19.982550144195557, "time_total_s": 19077.904675245285, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6818.395798206329, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 34.36896551724138, "ram_util_percent": 62.34137931034484}}
{"episode_reward_max": -4.2, "episode_reward_min": -41.2, "episode_reward_mean": -12.813000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.999999999999996, -41.2, -7.4, -23.400000000000002, -15.199999999999998, -20.7, -10.4, -12.499999999999998, -9.2, -15.299999999999997, -6.2, -30.60000000000001, -5.3, -6.2, -4.3, -6.300000000000001, -6.999999999999999, -16.799999999999997, -7.300000000000001, -12.099999999999998, -13.999999999999998, -10.799999999999999, -20.600000000000005, -12.2, -13.299999999999999, -5.3, -11.9, -5.9, -11.700000000000001, -21.700000000000003, -15.3, -24.700000000000003, -5.3, -23.700000000000017, -21.100000000000005, -4.9, -6.6000000000000005, -8.5, -4.300000000000001, -9.2, -6.2, -23.2, -18.2, -16.499999999999996, -8.2, -13.6, -11.099999999999994, -13.0, -8.3, -9.1, -10.3, -7.2, -11.5, -13.799999999999999, -27.3, -14.4, -4.2, -10.399999999999999, -5.2, -11.2, -19.5, -22.200000000000003, -5.3, -13.299999999999981, -28.2, -17.099999999999998, -9.999999999999998, -5.2, -19.1, -12.4, -27.6, -5.300000000000001, -15.699999999999989, -4.4, -9.600000000000001, -5.3, -6.300000000000001, -20.4, -5.4, -12.899999999999997, -7.6000000000000005, -5.3, -5.300000000000001, -10.899999999999999, -10.7, -30.2, -5.300000000000001, -15.199999999999996, -23.500000000000004, -6.2, -12.100000000000001, -24.1, -5.2, -13.099999999999984, -6.2, -9.999999999999998, -6.3, -9.899999999999999, -6.2, -36.500000000000064], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0873953886899923, "mean_inference_ms": 1.4444329401095204, "mean_action_processing_ms": 0.07802444916811976, "mean_env_wait_ms": 6.564506649967025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3028000, "timesteps_this_iter": 0, "agent_timesteps_total": 3028000, "timers": {"sample_time_ms": 22372.858, "sample_throughput": 178.788, "load_time_ms": 0.461, "load_throughput": 8683409.761, "learn_time_ms": 11455.072, "learn_throughput": 349.19, "update_time_ms": 2.025}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10987947503986058, "policy_loss": -0.023623722533304845, "vf_loss": 13.145430074840464, "vf_explained_var": 0.33143726004067287, "kl": 0.012141633896605919, "entropy": 0.2810984926678801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3028000, "num_agent_steps_sampled": 3028000, "num_steps_trained": 3028000, "num_agent_steps_trained": 3028000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30440, "training_iteration": 757, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-07-57", "timestamp": 1643710077, "time_this_iter_s": 22.494160175323486, "time_total_s": 19100.39883542061, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6840.889958381653, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 38.640625, "ram_util_percent": 62.540625000000006}}
{"episode_reward_max": -3.3, "episode_reward_min": -36.500000000000064, "episode_reward_mean": -12.267999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -23.2, -18.2, -16.499999999999996, -8.2, -13.6, -11.099999999999994, -13.0, -8.3, -9.1, -10.3, -7.2, -11.5, -13.799999999999999, -27.3, -14.4, -4.2, -10.399999999999999, -5.2, -11.2, -19.5, -22.200000000000003, -5.3, -13.299999999999981, -28.2, -17.099999999999998, -9.999999999999998, -5.2, -19.1, -12.4, -27.6, -5.300000000000001, -15.699999999999989, -4.4, -9.600000000000001, -5.3, -6.300000000000001, -20.4, -5.4, -12.899999999999997, -7.6000000000000005, -5.3, -5.300000000000001, -10.899999999999999, -10.7, -30.2, -5.300000000000001, -15.199999999999996, -23.500000000000004, -6.2, -12.100000000000001, -24.1, -5.2, -13.099999999999984, -6.2, -9.999999999999998, -6.3, -9.899999999999999, -6.2, -36.500000000000064, -11.1, -12.9, -4.4, -15.299999999999997, -11.399999999999999, -26.799999999999997, -5.4, -19.1, -27.10000000000001, -4.3, -9.3, -13.600000000000001, -11.999999999999998, -9.3, -15.799999999999999, -3.6000000000000005, -5.2, -11.1, -4.3, -8.200000000000003, -5.9, -10.8, -8.799999999999997, -33.900000000000006, -23.799999999999997, -5.2, -18.9, -11.699999999999998, -15.799999999999999, -21.4, -11.999999999999998, -7.299999999999999, -7.2, -5.2, -10.499999999999998, -3.3, -19.0, -5.300000000000001, -7.4, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.08755041885498, "mean_inference_ms": 1.4447128651046015, "mean_action_processing_ms": 0.07804070431956917, "mean_env_wait_ms": 6.565863467771865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3032000, "timesteps_this_iter": 0, "agent_timesteps_total": 3032000, "timers": {"sample_time_ms": 21940.668, "sample_throughput": 182.31, "load_time_ms": 0.452, "load_throughput": 8848275.935, "learn_time_ms": 11242.212, "learn_throughput": 355.802, "update_time_ms": 2.034}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12360167397706899, "policy_loss": -0.018458565762166375, "vf_loss": 14.02735863142116, "vf_explained_var": 0.2810458262120524, "kl": 0.010587602444691726, "entropy": 0.24924430002768835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3032000, "num_agent_steps_sampled": 3032000, "num_steps_trained": 3032000, "num_agent_steps_trained": 3032000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30480, "training_iteration": 758, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-08-19", "timestamp": 1643710099, "time_this_iter_s": 21.92763590812683, "time_total_s": 19122.326471328735, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6862.81759428978, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 35.80967741935484, "ram_util_percent": 62.435483870967744}}
{"episode_reward_max": -0.1, "episode_reward_min": -88.89999999999999, "episode_reward_mean": -12.911, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.6000000000000005, -5.3, -5.300000000000001, -10.899999999999999, -10.7, -30.2, -5.300000000000001, -15.199999999999996, -23.500000000000004, -6.2, -12.100000000000001, -24.1, -5.2, -13.099999999999984, -6.2, -9.999999999999998, -6.3, -9.899999999999999, -6.2, -36.500000000000064, -11.1, -12.9, -4.4, -15.299999999999997, -11.399999999999999, -26.799999999999997, -5.4, -19.1, -27.10000000000001, -4.3, -9.3, -13.600000000000001, -11.999999999999998, -9.3, -15.799999999999999, -3.6000000000000005, -5.2, -11.1, -4.3, -8.200000000000003, -5.9, -10.8, -8.799999999999997, -33.900000000000006, -23.799999999999997, -5.2, -18.9, -11.699999999999998, -15.799999999999999, -21.4, -11.999999999999998, -7.299999999999999, -7.2, -5.2, -10.499999999999998, -3.3, -19.0, -5.300000000000001, -7.4, -5.300000000000001, -21.6, -5.3, -5.4, -20.699999999999996, -28.7, -23.0, -29.400000000000002, -6.4, -19.800000000000004, -15.899999999999997, -4.3, -36.100000000000044, -5.1, -4.4, -18.0, -12.799999999999999, -13.9, -88.89999999999999, -5.699999999999999, -3.8000000000000003, -3.2, -4.3, -0.1, -26.200000000000006, -8.699999999999998, -6.300000000000001, -19.799999999999997, -32.5, -5.2, -6.300000000000001, -4.3, -10.4, -7.300000000000001, -5.700000000000001, -3.2, -10.1, -5.2, -5.300000000000001, -21.6, -17.50000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0876668751937368, "mean_inference_ms": 1.4450476128065517, "mean_action_processing_ms": 0.07805993047160298, "mean_env_wait_ms": 6.567660637935246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3036000, "timesteps_this_iter": 0, "agent_timesteps_total": 3036000, "timers": {"sample_time_ms": 21295.636, "sample_throughput": 187.832, "load_time_ms": 0.46, "load_throughput": 8703229.756, "learn_time_ms": 11111.243, "learn_throughput": 359.996, "update_time_ms": 2.124}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4537089407123545, "policy_loss": -0.02612475809035322, "vf_loss": 47.83034514688676, "vf_explained_var": -0.2143180081280329, "kl": 0.009068207197411153, "entropy": 0.24230027971088244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3036000, "num_agent_steps_sampled": 3036000, "num_steps_trained": 3036000, "num_agent_steps_trained": 3036000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30520, "training_iteration": 759, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-08-41", "timestamp": 1643710121, "time_this_iter_s": 21.348007202148438, "time_total_s": 19143.674478530884, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6884.165601491928, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 37.21333333333334, "ram_util_percent": 62.519999999999996}}
{"episode_reward_max": -0.1, "episode_reward_min": -88.89999999999999, "episode_reward_mean": -13.235, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.9, -10.8, -8.799999999999997, -33.900000000000006, -23.799999999999997, -5.2, -18.9, -11.699999999999998, -15.799999999999999, -21.4, -11.999999999999998, -7.299999999999999, -7.2, -5.2, -10.499999999999998, -3.3, -19.0, -5.300000000000001, -7.4, -5.300000000000001, -21.6, -5.3, -5.4, -20.699999999999996, -28.7, -23.0, -29.400000000000002, -6.4, -19.800000000000004, -15.899999999999997, -4.3, -36.100000000000044, -5.1, -4.4, -18.0, -12.799999999999999, -13.9, -88.89999999999999, -5.699999999999999, -3.8000000000000003, -3.2, -4.3, -0.1, -26.200000000000006, -8.699999999999998, -6.300000000000001, -19.799999999999997, -32.5, -5.2, -6.300000000000001, -4.3, -10.4, -7.300000000000001, -5.700000000000001, -3.2, -10.1, -5.2, -5.300000000000001, -21.6, -17.50000000000001, -7.2, -15.600000000000001, -3.2, -10.200000000000001, -6.3, -15.399999999999999, -7.3, -5.300000000000001, -7.300000000000001, -7.5, -15.1, -22.1, -25.700000000000003, -10.0, -16.099999999999998, -6.2, -7.999999999999998, -14.8, -17.800000000000004, -13.2, -4.4, -15.2, -68.10000000000005, -9.899999999999999, -28.6, -19.2, -7.599999999999998, -4.3, -7.0, -4.4, -4.2, -7.199999999999999, -6.2, -8.3, -14.399999999999997, -23.2, -15.499999999999995, -4.2, -5.300000000000001, -20.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0879587715528083, "mean_inference_ms": 1.445589582801275, "mean_action_processing_ms": 0.07809106407393719, "mean_env_wait_ms": 6.570480114700383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3040000, "timesteps_this_iter": 0, "agent_timesteps_total": 3040000, "timers": {"sample_time_ms": 21303.374, "sample_throughput": 187.764, "load_time_ms": 0.462, "load_throughput": 8661443.469, "learn_time_ms": 11138.838, "learn_throughput": 359.104, "update_time_ms": 2.157}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.20887045257784906, "policy_loss": -0.017797923681666696, "vf_loss": 22.464548962731516, "vf_explained_var": 0.05711742184495413, "kl": 0.011987499531381026, "entropy": 0.2615373418696465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3040000, "num_agent_steps_sampled": 3040000, "num_steps_trained": 3040000, "num_agent_steps_trained": 3040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30560, "training_iteration": 760, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-09-04", "timestamp": 1643710144, "time_this_iter_s": 23.566055297851562, "time_total_s": 19167.240533828735, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6907.73165678978, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 41.088235294117645, "ram_util_percent": 62.55882352941177}}
{"episode_reward_max": -0.1, "episode_reward_min": -68.10000000000005, "episode_reward_mean": -11.587, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -4.3, -0.1, -26.200000000000006, -8.699999999999998, -6.300000000000001, -19.799999999999997, -32.5, -5.2, -6.300000000000001, -4.3, -10.4, -7.300000000000001, -5.700000000000001, -3.2, -10.1, -5.2, -5.300000000000001, -21.6, -17.50000000000001, -7.2, -15.600000000000001, -3.2, -10.200000000000001, -6.3, -15.399999999999999, -7.3, -5.300000000000001, -7.300000000000001, -7.5, -15.1, -22.1, -25.700000000000003, -10.0, -16.099999999999998, -6.2, -7.999999999999998, -14.8, -17.800000000000004, -13.2, -4.4, -15.2, -68.10000000000005, -9.899999999999999, -28.6, -19.2, -7.599999999999998, -4.3, -7.0, -4.4, -4.2, -7.199999999999999, -6.2, -8.3, -14.399999999999997, -23.2, -15.499999999999995, -4.2, -5.300000000000001, -20.9, -24.099999999999998, -8.2, -11.899999999999997, -13.3, -12.799999999999997, -8.2, -22.900000000000006, -20.799999999999997, -5.3, -16.099999999999998, -4.3, -6.3, -5.6000000000000005, -8.700000000000001, -20.400000000000002, -4.300000000000001, -13.999999999999998, -7.4, -6.899999999999999, -5.300000000000001, -34.10000000000001, -9.8, -15.4, -5.300000000000001, -8.3, -13.2, -6.999999999999999, -9.2, -15.299999999999985, -8.3, -8.5, -6.4, -5.0, -21.9, -12.100000000000001, -15.999999999999998, -5.2, -7.300000000000001, -4.5, -3.500000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0886051478672654, "mean_inference_ms": 1.4463090317018277, "mean_action_processing_ms": 0.07813780270515693, "mean_env_wait_ms": 6.57445934469717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3044000, "timesteps_this_iter": 0, "agent_timesteps_total": 3044000, "timers": {"sample_time_ms": 21527.548, "sample_throughput": 185.808, "load_time_ms": 0.486, "load_throughput": 8228158.901, "learn_time_ms": 11313.983, "learn_throughput": 353.545, "update_time_ms": 2.148}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10713247834574631, "policy_loss": -0.015853892336849883, "vf_loss": 12.126816988119515, "vf_explained_var": 0.15761032290356133, "kl": 0.010181971894698839, "entropy": 0.27349869951766026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3044000, "num_agent_steps_sampled": 3044000, "num_steps_trained": 3044000, "num_agent_steps_trained": 3044000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30600, "training_iteration": 761, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-09-30", "timestamp": 1643710170, "time_this_iter_s": 25.305789947509766, "time_total_s": 19192.546323776245, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6933.037446737289, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 45.230555555555554, "ram_util_percent": 62.68888888888888}}
{"episode_reward_max": -3.2, "episode_reward_min": -68.10000000000005, "episode_reward_mean": -11.956000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -15.2, -68.10000000000005, -9.899999999999999, -28.6, -19.2, -7.599999999999998, -4.3, -7.0, -4.4, -4.2, -7.199999999999999, -6.2, -8.3, -14.399999999999997, -23.2, -15.499999999999995, -4.2, -5.300000000000001, -20.9, -24.099999999999998, -8.2, -11.899999999999997, -13.3, -12.799999999999997, -8.2, -22.900000000000006, -20.799999999999997, -5.3, -16.099999999999998, -4.3, -6.3, -5.6000000000000005, -8.700000000000001, -20.400000000000002, -4.300000000000001, -13.999999999999998, -7.4, -6.899999999999999, -5.300000000000001, -34.10000000000001, -9.8, -15.4, -5.300000000000001, -8.3, -13.2, -6.999999999999999, -9.2, -15.299999999999985, -8.3, -8.5, -6.4, -5.0, -21.9, -12.100000000000001, -15.999999999999998, -5.2, -7.300000000000001, -4.5, -3.500000000000001, -8.3, -17.4, -3.2, -13.8, -21.9, -9.899999999999999, -13.199999999999998, -5.300000000000001, -4.4, -6.4, -15.399999999999999, -13.299999999999994, -4.6000000000000005, -14.299999999999999, -5.4, -5.300000000000001, -17.2, -16.4, -16.9, -12.699999999999998, -12.999999999999998, -16.7, -4.4, -19.7, -18.6, -19.3, -4.4, -8.3, -20.999999999999996, -8.599999999999998, -11.999999999999998, -3.4, -5.3, -12.899999999999999, -12.2, -5.2, -8.2, -6.300000000000001, -15.399999999999999, -34.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0893235027933863, "mean_inference_ms": 1.4470825017705846, "mean_action_processing_ms": 0.07818643475268812, "mean_env_wait_ms": 6.578634309528411, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3048000, "timesteps_this_iter": 0, "agent_timesteps_total": 3048000, "timers": {"sample_time_ms": 21852.393, "sample_throughput": 183.046, "load_time_ms": 0.488, "load_throughput": 8191200.078, "learn_time_ms": 11401.59, "learn_throughput": 350.828, "update_time_ms": 2.243}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1074114159055014, "policy_loss": -0.0185020259751748, "vf_loss": 12.433767536442767, "vf_explained_var": 0.2456111914368086, "kl": 0.009337893818059466, "entropy": 0.25275091136335043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3048000, "num_agent_steps_sampled": 3048000, "num_steps_trained": 3048000, "num_agent_steps_trained": 3048000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30640, "training_iteration": 762, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-09-53", "timestamp": 1643710193, "time_this_iter_s": 23.427154779434204, "time_total_s": 19215.97347855568, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6956.464601516724, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 40.35588235294117, "ram_util_percent": 62.6}}
{"episode_reward_max": -3.2, "episode_reward_min": -214.49999999999974, "episode_reward_mean": -12.764999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.10000000000001, -9.8, -15.4, -5.300000000000001, -8.3, -13.2, -6.999999999999999, -9.2, -15.299999999999985, -8.3, -8.5, -6.4, -5.0, -21.9, -12.100000000000001, -15.999999999999998, -5.2, -7.300000000000001, -4.5, -3.500000000000001, -8.3, -17.4, -3.2, -13.8, -21.9, -9.899999999999999, -13.199999999999998, -5.300000000000001, -4.4, -6.4, -15.399999999999999, -13.299999999999994, -4.6000000000000005, -14.299999999999999, -5.4, -5.300000000000001, -17.2, -16.4, -16.9, -12.699999999999998, -12.999999999999998, -16.7, -4.4, -19.7, -18.6, -19.3, -4.4, -8.3, -20.999999999999996, -8.599999999999998, -11.999999999999998, -3.4, -5.3, -12.899999999999999, -12.2, -5.2, -8.2, -6.300000000000001, -15.399999999999999, -34.2, -14.8, -4.2, -214.49999999999974, -34.9, -10.399999999999999, -11.999999999999998, -3.3, -6.300000000000001, -7.2, -6.300000000000001, -10.999999999999998, -5.8999999999999995, -6.3, -11.4, -4.3, -16.299999999999983, -3.3, -7.0, -5.0, -15.19999999999997, -6.3, -5.4, -9.2, -3.4, -5.4, -22.0, -22.2, -7.799999999999999, -7.300000000000001, -7.7, -5.2, -8.4, -4.4, -6.300000000000001, -6.4, -5.300000000000001, -23.8, -7.3, -9.099999999999998, -13.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.090106621480136, "mean_inference_ms": 1.4480519936513452, "mean_action_processing_ms": 0.07824151028312427, "mean_env_wait_ms": 6.583390784376303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3052000, "timesteps_this_iter": 0, "agent_timesteps_total": 3052000, "timers": {"sample_time_ms": 22251.305, "sample_throughput": 179.765, "load_time_ms": 0.496, "load_throughput": 8057833.918, "learn_time_ms": 11605.689, "learn_throughput": 344.659, "update_time_ms": 2.321}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.1709206924656086, "policy_loss": -0.010263811587105676, "vf_loss": 217.99764990691216, "vf_explained_var": 0.04358702769843481, "kl": 0.007158850665157972, "entropy": 0.2533322816414218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3052000, "num_agent_steps_sampled": 3052000, "num_steps_trained": 3052000, "num_agent_steps_trained": 3052000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30680, "training_iteration": 763, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-10-19", "timestamp": 1643710219, "time_this_iter_s": 25.915497303009033, "time_total_s": 19241.88897585869, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6982.380098819733, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 45.37297297297297, "ram_util_percent": 62.83243243243246}}
{"episode_reward_max": -2.6, "episode_reward_min": -214.49999999999974, "episode_reward_mean": -13.223999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.999999999999998, -16.7, -4.4, -19.7, -18.6, -19.3, -4.4, -8.3, -20.999999999999996, -8.599999999999998, -11.999999999999998, -3.4, -5.3, -12.899999999999999, -12.2, -5.2, -8.2, -6.300000000000001, -15.399999999999999, -34.2, -14.8, -4.2, -214.49999999999974, -34.9, -10.399999999999999, -11.999999999999998, -3.3, -6.300000000000001, -7.2, -6.300000000000001, -10.999999999999998, -5.8999999999999995, -6.3, -11.4, -4.3, -16.299999999999983, -3.3, -7.0, -5.0, -15.19999999999997, -6.3, -5.4, -9.2, -3.4, -5.4, -22.0, -22.2, -7.799999999999999, -7.300000000000001, -7.7, -5.2, -8.4, -4.4, -6.300000000000001, -6.4, -5.300000000000001, -23.8, -7.3, -9.099999999999998, -13.299999999999997, -4.3, -5.2, -8.4, -11.7, -24.600000000000005, -15.3, -13.9, -5.300000000000001, -9.1, -26.500000000000007, -4.3, -20.7, -9.2, -11.8, -4.300000000000001, -7.0, -6.4, -41.0, -7.4, -10.899999999999997, -19.9, -20.5, -10.899999999999999, -14.099999999999996, -17.599999999999994, -21.800000000000008, -5.3, -13.100000000000001, -2.6, -19.0, -4.4, -4.2, -7.1, -14.7, -24.200000000000006, -4.2, -13.799999999999997, -11.499999999999998, -6.3, -5.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0908872893693478, "mean_inference_ms": 1.4490631631184498, "mean_action_processing_ms": 0.07829724132189829, "mean_env_wait_ms": 6.588195629979627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3056000, "timesteps_this_iter": 0, "agent_timesteps_total": 3056000, "timers": {"sample_time_ms": 22615.165, "sample_throughput": 176.872, "load_time_ms": 0.502, "load_throughput": 7960341.621, "learn_time_ms": 11675.291, "learn_throughput": 342.604, "update_time_ms": 2.327}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16843238361980967, "policy_loss": -0.014734048143489867, "vf_loss": 18.12066129356302, "vf_explained_var": 0.24651181588890733, "kl": 0.011613775156662376, "entropy": 0.25849582346616895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3056000, "num_agent_steps_sampled": 3056000, "num_steps_trained": 3056000, "num_agent_steps_trained": 3056000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30720, "training_iteration": 764, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-10-42", "timestamp": 1643710242, "time_this_iter_s": 23.097599267959595, "time_total_s": 19264.986575126648, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7005.477698087692, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 36.84545454545455, "ram_util_percent": 62.706060606060596}}
{"episode_reward_max": -2.5, "episode_reward_min": -75.49999999999994, "episode_reward_mean": -12.832999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.3, -5.4, -9.2, -3.4, -5.4, -22.0, -22.2, -7.799999999999999, -7.300000000000001, -7.7, -5.2, -8.4, -4.4, -6.300000000000001, -6.4, -5.300000000000001, -23.8, -7.3, -9.099999999999998, -13.299999999999997, -4.3, -5.2, -8.4, -11.7, -24.600000000000005, -15.3, -13.9, -5.300000000000001, -9.1, -26.500000000000007, -4.3, -20.7, -9.2, -11.8, -4.300000000000001, -7.0, -6.4, -41.0, -7.4, -10.899999999999997, -19.9, -20.5, -10.899999999999999, -14.099999999999996, -17.599999999999994, -21.800000000000008, -5.3, -13.100000000000001, -2.6, -19.0, -4.4, -4.2, -7.1, -14.7, -24.200000000000006, -4.2, -13.799999999999997, -11.499999999999998, -6.3, -5.0, -75.49999999999994, -5.2, -8.8, -16.899999999999995, -2.5, -16.799999999999997, -4.4, -6.9, -3.3, -13.2, -6.3, -9.8, -4.3, -16.4, -8.3, -18.6, -5.2, -25.6, -28.800000000000008, -3.4, -14.7, -58.69999999999997, -18.1, -15.499999999999998, -16.9, -13.700000000000001, -16.3, -13.699999999999998, -72.3, -7.799999999999999, -10.799999999999999, -4.2, -7.2, -7.799999999999999, -12.399999999999999, -15.200000000000001, -7.4, -3.3, -6.300000000000001, -7.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0914929313155175, "mean_inference_ms": 1.4498169798650808, "mean_action_processing_ms": 0.07834035202875357, "mean_env_wait_ms": 6.591854182627826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3060000, "timesteps_this_iter": 0, "agent_timesteps_total": 3060000, "timers": {"sample_time_ms": 22838.74, "sample_throughput": 175.141, "load_time_ms": 0.505, "load_throughput": 7922750.283, "learn_time_ms": 11779.672, "learn_throughput": 339.568, "update_time_ms": 2.328}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5591223946584749, "policy_loss": -0.026116816186776724, "vf_loss": 58.33859350239077, "vf_explained_var": -0.19541699969640342, "kl": 0.010982447931382394, "entropy": 0.24993430561916802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3060000, "num_agent_steps_sampled": 3060000, "num_steps_trained": 3060000, "num_agent_steps_trained": 3060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30760, "training_iteration": 765, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-11-04", "timestamp": 1643710264, "time_this_iter_s": 21.849043130874634, "time_total_s": 19286.835618257523, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7027.326741218567, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 36.99677419354838, "ram_util_percent": 62.632258064516115}}
{"episode_reward_max": -2.5, "episode_reward_min": -75.49999999999994, "episode_reward_mean": -12.839999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.9, -20.5, -10.899999999999999, -14.099999999999996, -17.599999999999994, -21.800000000000008, -5.3, -13.100000000000001, -2.6, -19.0, -4.4, -4.2, -7.1, -14.7, -24.200000000000006, -4.2, -13.799999999999997, -11.499999999999998, -6.3, -5.0, -75.49999999999994, -5.2, -8.8, -16.899999999999995, -2.5, -16.799999999999997, -4.4, -6.9, -3.3, -13.2, -6.3, -9.8, -4.3, -16.4, -8.3, -18.6, -5.2, -25.6, -28.800000000000008, -3.4, -14.7, -58.69999999999997, -18.1, -15.499999999999998, -16.9, -13.700000000000001, -16.3, -13.699999999999998, -72.3, -7.799999999999999, -10.799999999999999, -4.2, -7.2, -7.799999999999999, -12.399999999999999, -15.200000000000001, -7.4, -3.3, -6.300000000000001, -7.1, -12.6, -5.300000000000001, -8.799999999999999, -18.099999999999998, -6.0, -12.1, -36.500000000000064, -12.999999999999988, -3.6, -14.200000000000015, -26.1, -7.899999999999999, -9.3, -8.2, -18.300000000000004, -5.4, -4.4, -7.1, -15.999999999999998, -15.199999999999996, -7.800000000000001, -4.3, -5.2, -9.799999999999999, -4.3, -6.999999999999998, -5.2, -13.6, -6.799999999999999, -3.4, -12.099999999999998, -3.2, -8.299999999999997, -4.4, -12.700000000000001, -26.800000000000008, -16.099999999999998, -13.3, -10.599999999999998, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0916036048076478, "mean_inference_ms": 1.4499041373229737, "mean_action_processing_ms": 0.0783470153960482, "mean_env_wait_ms": 6.592362362747365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3064000, "timesteps_this_iter": 0, "agent_timesteps_total": 3064000, "timers": {"sample_time_ms": 22827.834, "sample_throughput": 175.225, "load_time_ms": 0.5, "load_throughput": 8000961.419, "learn_time_ms": 11531.427, "learn_throughput": 346.878, "update_time_ms": 2.32}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10169528616061534, "policy_loss": -0.024477470201510254, "vf_loss": 12.402451905768405, "vf_explained_var": 0.034496853428502235, "kl": 0.012730314682547646, "entropy": 0.2632908392016606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3064000, "num_agent_steps_sampled": 3064000, "num_steps_trained": 3064000, "num_agent_steps_trained": 3064000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30800, "training_iteration": 766, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-11-21", "timestamp": 1643710281, "time_this_iter_s": 16.335172176361084, "time_total_s": 19303.170790433884, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7043.661913394928, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 29.482608695652175, "ram_util_percent": 62.70000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -82.3999999999999, "episode_reward_mean": -14.455000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.7, -58.69999999999997, -18.1, -15.499999999999998, -16.9, -13.700000000000001, -16.3, -13.699999999999998, -72.3, -7.799999999999999, -10.799999999999999, -4.2, -7.2, -7.799999999999999, -12.399999999999999, -15.200000000000001, -7.4, -3.3, -6.300000000000001, -7.1, -12.6, -5.300000000000001, -8.799999999999999, -18.099999999999998, -6.0, -12.1, -36.500000000000064, -12.999999999999988, -3.6, -14.200000000000015, -26.1, -7.899999999999999, -9.3, -8.2, -18.300000000000004, -5.4, -4.4, -7.1, -15.999999999999998, -15.199999999999996, -7.800000000000001, -4.3, -5.2, -9.799999999999999, -4.3, -6.999999999999998, -5.2, -13.6, -6.799999999999999, -3.4, -12.099999999999998, -3.2, -8.299999999999997, -4.4, -12.700000000000001, -26.800000000000008, -16.099999999999998, -13.3, -10.599999999999998, -11.2, -20.899999999999984, -6.3, -7.899999999999999, -8.3, -10.399999999999999, -13.699999999999998, -8.2, -17.1, -19.70000000000001, -72.50000000000001, -6.799999999999999, -5.300000000000001, -23.999999999999996, -5.3, -82.3999999999999, -3.4, -12.599999999999998, -17.3, -5.4, -6.1, -7.199999999999999, -8.2, -37.70000000000006, -16.699999999999996, -40.200000000000074, -10.799999999999999, -38.800000000000104, -3.3, -18.9, -4.3, -13.299999999999999, -19.000000000000004, -14.0, -6.4, -15.099999999999998, -4.2, -21.5, -16.799999999999997, -13.499999999999998, -18.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0914089048553957, "mean_inference_ms": 1.4495515496546605, "mean_action_processing_ms": 0.07832984653884859, "mean_env_wait_ms": 6.590681300049091, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3068000, "timesteps_this_iter": 0, "agent_timesteps_total": 3068000, "timers": {"sample_time_ms": 22359.784, "sample_throughput": 178.893, "load_time_ms": 0.486, "load_throughput": 8230177.091, "learn_time_ms": 11137.937, "learn_throughput": 359.133, "update_time_ms": 2.272}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5975904211199151, "policy_loss": -0.030643049819815544, "vf_loss": 62.60809139923383, "vf_explained_var": 0.10193939907576448, "kl": 0.012756003068321867, "entropy": 0.2629047493059789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3068000, "num_agent_steps_sampled": 3068000, "num_steps_trained": 3068000, "num_agent_steps_trained": 3068000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30840, "training_iteration": 767, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-11-37", "timestamp": 1643710297, "time_this_iter_s": 16.36491894721985, "time_total_s": 19319.535709381104, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7060.026832342148, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 25.7, "ram_util_percent": 62.695652173913054}}
{"episode_reward_max": -3.2, "episode_reward_min": -82.3999999999999, "episode_reward_mean": -13.158999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.800000000000001, -4.3, -5.2, -9.799999999999999, -4.3, -6.999999999999998, -5.2, -13.6, -6.799999999999999, -3.4, -12.099999999999998, -3.2, -8.299999999999997, -4.4, -12.700000000000001, -26.800000000000008, -16.099999999999998, -13.3, -10.599999999999998, -11.2, -20.899999999999984, -6.3, -7.899999999999999, -8.3, -10.399999999999999, -13.699999999999998, -8.2, -17.1, -19.70000000000001, -72.50000000000001, -6.799999999999999, -5.300000000000001, -23.999999999999996, -5.3, -82.3999999999999, -3.4, -12.599999999999998, -17.3, -5.4, -6.1, -7.199999999999999, -8.2, -37.70000000000006, -16.699999999999996, -40.200000000000074, -10.799999999999999, -38.800000000000104, -3.3, -18.9, -4.3, -13.299999999999999, -19.000000000000004, -14.0, -6.4, -15.099999999999998, -4.2, -21.5, -16.799999999999997, -13.499999999999998, -18.4, -14.0, -9.0, -12.8, -3.3, -11.2, -6.2, -5.4, -31.00000000000001, -15.199999999999998, -12.9, -6.2, -5.300000000000001, -24.3, -7.2, -18.599999999999994, -6.2, -19.6, -4.3, -6.300000000000001, -3.3, -14.2, -30.599999999999994, -24.199999999999996, -10.899999999999997, -6.3, -6.3, -9.799999999999997, -6.300000000000001, -22.799999999999997, -4.3, -10.299999999999999, -5.2, -7.300000000000001, -14.599999999999998, -6.2, -17.200000000000003, -7.299999999999999, -11.099999999999996, -5.4, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0910909764839245, "mean_inference_ms": 1.4489951952773321, "mean_action_processing_ms": 0.07829947662811504, "mean_env_wait_ms": 6.587922857469859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3072000, "timesteps_this_iter": 0, "agent_timesteps_total": 3072000, "timers": {"sample_time_ms": 21713.055, "sample_throughput": 184.221, "load_time_ms": 0.476, "load_throughput": 8398266.006, "learn_time_ms": 10829.551, "learn_throughput": 369.36, "update_time_ms": 2.207}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10398276191585326, "policy_loss": -0.030849495439750133, "vf_loss": 13.217329464804742, "vf_explained_var": 0.11032591539044534, "kl": 0.015756830957060847, "entropy": 0.26849669827729145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3072000, "num_agent_steps_sampled": 3072000, "num_steps_trained": 3072000, "num_agent_steps_trained": 3072000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30880, "training_iteration": 768, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-11-53", "timestamp": 1643710313, "time_this_iter_s": 16.31518316268921, "time_total_s": 19335.850892543793, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7076.342015504837, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 30.041666666666668, "ram_util_percent": 62.6}}
{"episode_reward_max": -3.3, "episode_reward_min": -40.200000000000074, "episode_reward_mean": -12.611, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.199999999999999, -8.2, -37.70000000000006, -16.699999999999996, -40.200000000000074, -10.799999999999999, -38.800000000000104, -3.3, -18.9, -4.3, -13.299999999999999, -19.000000000000004, -14.0, -6.4, -15.099999999999998, -4.2, -21.5, -16.799999999999997, -13.499999999999998, -18.4, -14.0, -9.0, -12.8, -3.3, -11.2, -6.2, -5.4, -31.00000000000001, -15.199999999999998, -12.9, -6.2, -5.300000000000001, -24.3, -7.2, -18.599999999999994, -6.2, -19.6, -4.3, -6.300000000000001, -3.3, -14.2, -30.599999999999994, -24.199999999999996, -10.899999999999997, -6.3, -6.3, -9.799999999999997, -6.300000000000001, -22.799999999999997, -4.3, -10.299999999999999, -5.2, -7.300000000000001, -14.599999999999998, -6.2, -17.200000000000003, -7.299999999999999, -11.099999999999996, -5.4, -5.300000000000001, -5.5, -6.6000000000000005, -14.099999999999998, -9.0, -5.0, -9.5, -14.899999999999999, -6.299999999999999, -12.6, -5.2, -7.4, -8.2, -15.7, -14.999999999999998, -17.90000000000001, -12.1, -15.1, -7.3, -13.799999999999999, -16.4, -27.5, -17.299999999999997, -9.2, -16.199999999999996, -9.999999999999986, -10.2, -12.100000000000001, -8.299999999999997, -14.299999999999988, -10.3, -18.099999999999998, -14.7, -12.3, -12.899999999999999, -9.799999999999999, -10.3, -7.300000000000001, -9.2, -25.200000000000014, -12.100000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0906988559699782, "mean_inference_ms": 1.4484820837342205, "mean_action_processing_ms": 0.07827059618919607, "mean_env_wait_ms": 6.585325950424485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3076000, "timesteps_this_iter": 0, "agent_timesteps_total": 3076000, "timers": {"sample_time_ms": 21206.088, "sample_throughput": 188.625, "load_time_ms": 0.45, "load_throughput": 8890004.239, "learn_time_ms": 10673.593, "learn_throughput": 374.757, "update_time_ms": 2.154}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08876721176559166, "policy_loss": -0.01549634597569664, "vf_loss": 10.246000561278354, "vf_explained_var": 0.175385796254681, "kl": 0.010687725801553766, "entropy": 0.2775741273357022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3076000, "num_agent_steps_sampled": 3076000, "num_steps_trained": 3076000, "num_agent_steps_trained": 3076000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30920, "training_iteration": 769, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-12-11", "timestamp": 1643710331, "time_this_iter_s": 17.815993070602417, "time_total_s": 19353.666885614395, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7094.158008575439, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 36.956, "ram_util_percent": 62.792}}
{"episode_reward_max": -4.3, "episode_reward_min": -52.3, "episode_reward_mean": -13.152000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -30.599999999999994, -24.199999999999996, -10.899999999999997, -6.3, -6.3, -9.799999999999997, -6.300000000000001, -22.799999999999997, -4.3, -10.299999999999999, -5.2, -7.300000000000001, -14.599999999999998, -6.2, -17.200000000000003, -7.299999999999999, -11.099999999999996, -5.4, -5.300000000000001, -5.5, -6.6000000000000005, -14.099999999999998, -9.0, -5.0, -9.5, -14.899999999999999, -6.299999999999999, -12.6, -5.2, -7.4, -8.2, -15.7, -14.999999999999998, -17.90000000000001, -12.1, -15.1, -7.3, -13.799999999999999, -16.4, -27.5, -17.299999999999997, -9.2, -16.199999999999996, -9.999999999999986, -10.2, -12.100000000000001, -8.299999999999997, -14.299999999999988, -10.3, -18.099999999999998, -14.7, -12.3, -12.899999999999999, -9.799999999999999, -10.3, -7.300000000000001, -9.2, -25.200000000000014, -12.100000000000001, -6.799999999999999, -7.3, -14.999999999999998, -12.4, -13.1, -9.3, -9.1, -8.7, -27.7, -19.3, -11.3, -18.799999999999997, -9.599999999999998, -26.599999999999998, -17.299999999999997, -14.599999999999996, -34.40000000000001, -28.900000000000002, -17.2, -19.4, -11.3, -7.2, -19.2, -11.0, -9.9, -11.099999999999998, -52.3, -11.4, -5.300000000000001, -17.2, -11.1, -17.1, -11.0, -4.800000000000001, -20.300000000000004, -8.4, -20.6, -7.699999999999999, -13.799999999999999, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0902883518751976, "mean_inference_ms": 1.4480174281439622, "mean_action_processing_ms": 0.07824485864379652, "mean_env_wait_ms": 6.582906314965615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3080000, "timesteps_this_iter": 0, "agent_timesteps_total": 3080000, "timers": {"sample_time_ms": 20708.144, "sample_throughput": 193.161, "load_time_ms": 0.438, "load_throughput": 9135926.813, "learn_time_ms": 10313.533, "learn_throughput": 387.84, "update_time_ms": 2.062}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16979099752842097, "policy_loss": -0.025108104693873597, "vf_loss": 19.27317179684998, "vf_explained_var": 0.145329995629608, "kl": 0.01284380348220285, "entropy": 0.29828045706274686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3080000, "num_agent_steps_sampled": 3080000, "num_steps_trained": 3080000, "num_agent_steps_trained": 3080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30960, "training_iteration": 770, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-12-28", "timestamp": 1643710348, "time_this_iter_s": 16.55604386329651, "time_total_s": 19370.22292947769, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7110.714052438736, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 33.7875, "ram_util_percent": 63.04999999999999}}
{"episode_reward_max": -4.3, "episode_reward_min": -52.3, "episode_reward_mean": -13.616000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.5, -17.299999999999997, -9.2, -16.199999999999996, -9.999999999999986, -10.2, -12.100000000000001, -8.299999999999997, -14.299999999999988, -10.3, -18.099999999999998, -14.7, -12.3, -12.899999999999999, -9.799999999999999, -10.3, -7.300000000000001, -9.2, -25.200000000000014, -12.100000000000001, -6.799999999999999, -7.3, -14.999999999999998, -12.4, -13.1, -9.3, -9.1, -8.7, -27.7, -19.3, -11.3, -18.799999999999997, -9.599999999999998, -26.599999999999998, -17.299999999999997, -14.599999999999996, -34.40000000000001, -28.900000000000002, -17.2, -19.4, -11.3, -7.2, -19.2, -11.0, -9.9, -11.099999999999998, -52.3, -11.4, -5.300000000000001, -17.2, -11.1, -17.1, -11.0, -4.800000000000001, -20.300000000000004, -8.4, -20.6, -7.699999999999999, -13.799999999999999, -7.2, -16.3, -12.4, -14.4, -18.499999999999996, -10.199999999999998, -9.2, -5.2, -9.5, -15.499999999999998, -7.699999999999999, -8.3, -10.3, -9.3, -4.3, -8.3, -19.000000000000004, -9.499999999999998, -14.799999999999999, -18.799999999999997, -9.5, -14.7, -10.4, -22.3, -14.599999999999998, -19.6, -7.3, -8.599999999999998, -20.0, -17.500000000000004, -15.599999999999998, -12.4, -5.8, -15.999999999999996, -9.6, -10.799999999999999, -5.4, -13.3, -12.299999999999999, -11.2, -11.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0898907586675657, "mean_inference_ms": 1.4475359373573662, "mean_action_processing_ms": 0.07821906960361064, "mean_env_wait_ms": 6.5804767805705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3084000, "timesteps_this_iter": 0, "agent_timesteps_total": 3084000, "timers": {"sample_time_ms": 19925.69, "sample_throughput": 200.746, "load_time_ms": 0.403, "load_throughput": 9915612.293, "learn_time_ms": 9846.503, "learn_throughput": 406.236, "update_time_ms": 2.003}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0871207004332895, "policy_loss": -0.016643714550281723, "vf_loss": 10.174324612335493, "vf_explained_var": 0.08931721980853748, "kl": 0.011977306277105217, "entropy": 0.3118498769979323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3084000, "num_agent_steps_sampled": 3084000, "num_steps_trained": 3084000, "num_agent_steps_trained": 3084000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31000, "training_iteration": 771, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-12-44", "timestamp": 1643710364, "time_this_iter_s": 16.539090871810913, "time_total_s": 19386.762020349503, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7127.253143310547, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 29.547826086956523, "ram_util_percent": 63.0}}
{"episode_reward_max": -4.3, "episode_reward_min": -52.3, "episode_reward_mean": -13.33, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -7.2, -19.2, -11.0, -9.9, -11.099999999999998, -52.3, -11.4, -5.300000000000001, -17.2, -11.1, -17.1, -11.0, -4.800000000000001, -20.300000000000004, -8.4, -20.6, -7.699999999999999, -13.799999999999999, -7.2, -16.3, -12.4, -14.4, -18.499999999999996, -10.199999999999998, -9.2, -5.2, -9.5, -15.499999999999998, -7.699999999999999, -8.3, -10.3, -9.3, -4.3, -8.3, -19.000000000000004, -9.499999999999998, -14.799999999999999, -18.799999999999997, -9.5, -14.7, -10.4, -22.3, -14.599999999999998, -19.6, -7.3, -8.599999999999998, -20.0, -17.500000000000004, -15.599999999999998, -12.4, -5.8, -15.999999999999996, -9.6, -10.799999999999999, -5.4, -13.3, -12.299999999999999, -11.2, -11.199999999999998, -18.199999999999996, -13.700000000000001, -10.699999999999998, -6.6000000000000005, -8.4, -7.300000000000001, -39.1, -18.200000000000003, -11.399999999999999, -11.2, -12.3, -24.00000000000001, -10.3, -15.799999999999997, -19.3, -6.4, -7.3, -4.700000000000001, -20.2, -24.700000000000063, -17.599999999999998, -12.199999999999998, -7.2, -12.0, -23.3, -8.899999999999999, -13.5, -7.700000000000001, -21.3, -23.7, -11.999999999999998, -16.799999999999997, -18.099999999999998, -18.2, -18.9, -17.4, -6.300000000000001, -5.4, -8.899999999999999, -6.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0896242103996903, "mean_inference_ms": 1.4472420550309417, "mean_action_processing_ms": 0.07820197679377332, "mean_env_wait_ms": 6.578887397899491, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3088000, "timesteps_this_iter": 0, "agent_timesteps_total": 3088000, "timers": {"sample_time_ms": 19280.794, "sample_throughput": 207.46, "load_time_ms": 0.398, "load_throughput": 10040225.015, "learn_time_ms": 9429.344, "learn_throughput": 424.208, "update_time_ms": 1.87}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13345993155994082, "policy_loss": -0.021032410601694737, "vf_loss": 15.280102408957738, "vf_explained_var": 0.19262766491982244, "kl": 0.010022653997720855, "entropy": 0.27584977410333134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3088000, "num_agent_steps_sampled": 3088000, "num_steps_trained": 3088000, "num_agent_steps_trained": 3088000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31040, "training_iteration": 772, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-13-02", "timestamp": 1643710382, "time_this_iter_s": 17.4810528755188, "time_total_s": 19404.24307322502, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7144.734196186066, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 41.548, "ram_util_percent": 63.123999999999995}}
{"episode_reward_max": -3.3, "episode_reward_min": -39.1, "episode_reward_mean": -12.745, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.7, -10.4, -22.3, -14.599999999999998, -19.6, -7.3, -8.599999999999998, -20.0, -17.500000000000004, -15.599999999999998, -12.4, -5.8, -15.999999999999996, -9.6, -10.799999999999999, -5.4, -13.3, -12.299999999999999, -11.2, -11.199999999999998, -18.199999999999996, -13.700000000000001, -10.699999999999998, -6.6000000000000005, -8.4, -7.300000000000001, -39.1, -18.200000000000003, -11.399999999999999, -11.2, -12.3, -24.00000000000001, -10.3, -15.799999999999997, -19.3, -6.4, -7.3, -4.700000000000001, -20.2, -24.700000000000063, -17.599999999999998, -12.199999999999998, -7.2, -12.0, -23.3, -8.899999999999999, -13.5, -7.700000000000001, -21.3, -23.7, -11.999999999999998, -16.799999999999997, -18.099999999999998, -18.2, -18.9, -17.4, -6.300000000000001, -5.4, -8.899999999999999, -6.3, -5.6000000000000005, -7.2, -6.4, -7.299999999999999, -14.2, -9.3, -12.699999999999998, -24.49999999999998, -37.0, -20.3, -3.6000000000000005, -13.699999999999998, -8.4, -12.599999999999998, -4.300000000000001, -15.299999999999999, -12.1, -8.3, -9.4, -19.799999999999997, -7.2, -3.4, -11.299999999999997, -3.7000000000000006, -12.3, -9.3, -21.300000000000004, -3.3, -12.499999999999996, -7.2, -11.999999999999998, -16.299999999999997, -7.300000000000001, -9.4, -7.199999999999998, -5.300000000000001, -8.3, -15.0, -10.9, -15.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0893914547049715, "mean_inference_ms": 1.4468680313055529, "mean_action_processing_ms": 0.07818038811340935, "mean_env_wait_ms": 6.576965522192717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3092000, "timesteps_this_iter": 0, "agent_timesteps_total": 3092000, "timers": {"sample_time_ms": 18384.269, "sample_throughput": 217.577, "load_time_ms": 0.381, "load_throughput": 10508747.886, "learn_time_ms": 8832.392, "learn_throughput": 452.878, "update_time_ms": 1.825}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06530041082421698, "policy_loss": -0.029640727634391476, "vf_loss": 9.25407944994588, "vf_explained_var": 0.32261040684997394, "kl": 0.014224281230421843, "entropy": 0.3417151754261345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3092000, "num_agent_steps_sampled": 3092000, "num_steps_trained": 3092000, "num_agent_steps_trained": 3092000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31080, "training_iteration": 773, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-13-17", "timestamp": 1643710397, "time_this_iter_s": 15.178380966186523, "time_total_s": 19419.421454191208, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7159.912577152252, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 29.909090909090903, "ram_util_percent": 63.113636363636346}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -37.0, "episode_reward_mean": -12.213999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.599999999999998, -12.199999999999998, -7.2, -12.0, -23.3, -8.899999999999999, -13.5, -7.700000000000001, -21.3, -23.7, -11.999999999999998, -16.799999999999997, -18.099999999999998, -18.2, -18.9, -17.4, -6.300000000000001, -5.4, -8.899999999999999, -6.3, -5.6000000000000005, -7.2, -6.4, -7.299999999999999, -14.2, -9.3, -12.699999999999998, -24.49999999999998, -37.0, -20.3, -3.6000000000000005, -13.699999999999998, -8.4, -12.599999999999998, -4.300000000000001, -15.299999999999999, -12.1, -8.3, -9.4, -19.799999999999997, -7.2, -3.4, -11.299999999999997, -3.7000000000000006, -12.3, -9.3, -21.300000000000004, -3.3, -12.499999999999996, -7.2, -11.999999999999998, -16.299999999999997, -7.300000000000001, -9.4, -7.199999999999998, -5.300000000000001, -8.3, -15.0, -10.9, -15.2, -15.5, -7.499999999999998, -34.2, -20.299999999999997, -9.3, -12.1, -13.799999999999997, -6.3999999999999995, -20.599999999999998, -19.8, -19.9, -9.3, -6.799999999999999, -22.1, -5.3, -9.4, -5.4, -2.6000000000000005, -14.4, -10.4, -18.7, -8.9, -12.399999999999999, -7.3, -4.6000000000000005, -4.3, -10.3, -6.0, -18.3, -8.2, -13.700000000000001, -11.2, -12.600000000000001, -8.3, -9.0, -5.1, -5.3, -27.200000000000003, -9.3, -29.500000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0891747261984177, "mean_inference_ms": 1.4463142584457467, "mean_action_processing_ms": 0.07815007271683584, "mean_env_wait_ms": 6.574328595260256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3096000, "timesteps_this_iter": 0, "agent_timesteps_total": 3096000, "timers": {"sample_time_ms": 17389.612, "sample_throughput": 230.022, "load_time_ms": 0.365, "load_throughput": 10947612.398, "learn_time_ms": 8621.504, "learn_throughput": 463.956, "update_time_ms": 1.881}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10937498477838373, "policy_loss": -0.02142027231854617, "vf_loss": 12.90254347555099, "vf_explained_var": 0.07745033630760767, "kl": 0.010487849558212052, "entropy": 0.3124470169746107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3096000, "num_agent_steps_sampled": 3096000, "num_steps_trained": 3096000, "num_agent_steps_trained": 3096000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31120, "training_iteration": 774, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-13-34", "timestamp": 1643710414, "time_this_iter_s": 17.034036874771118, "time_total_s": 19436.45549106598, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7176.946614027023, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 27.075, "ram_util_percent": 63.05833333333334}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -34.2, "episode_reward_mean": -11.549, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -3.4, -11.299999999999997, -3.7000000000000006, -12.3, -9.3, -21.300000000000004, -3.3, -12.499999999999996, -7.2, -11.999999999999998, -16.299999999999997, -7.300000000000001, -9.4, -7.199999999999998, -5.300000000000001, -8.3, -15.0, -10.9, -15.2, -15.5, -7.499999999999998, -34.2, -20.299999999999997, -9.3, -12.1, -13.799999999999997, -6.3999999999999995, -20.599999999999998, -19.8, -19.9, -9.3, -6.799999999999999, -22.1, -5.3, -9.4, -5.4, -2.6000000000000005, -14.4, -10.4, -18.7, -8.9, -12.399999999999999, -7.3, -4.6000000000000005, -4.3, -10.3, -6.0, -18.3, -8.2, -13.700000000000001, -11.2, -12.600000000000001, -8.3, -9.0, -5.1, -5.3, -27.200000000000003, -9.3, -29.500000000000004, -12.3, -13.299999999999997, -7.3, -20.500000000000004, -20.599999999999994, -4.3, -12.8, -13.2, -4.3, -14.3, -15.599999999999998, -20.6, -8.2, -30.600000000000033, -5.3, -3.0, -7.3, -15.19999999999999, -6.3, -6.3, -7.799999999999999, -13.199999999999998, -11.099999999999998, -4.899999999999999, -20.6, -5.2, -9.600000000000001, -5.4, -7.7, -9.3, -11.599999999999996, -19.9, -7.4, -12.3, -12.2, -7.599999999999999, -25.6, -4.9, -9.3, -14.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0891410343984802, "mean_inference_ms": 1.4459204811642934, "mean_action_processing_ms": 0.0781283327760459, "mean_env_wait_ms": 6.5723886452611895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3100000, "timesteps_this_iter": 0, "agent_timesteps_total": 3100000, "timers": {"sample_time_ms": 17081.961, "sample_throughput": 234.165, "load_time_ms": 0.355, "load_throughput": 11252324.614, "learn_time_ms": 8303.6, "learn_throughput": 481.719, "update_time_ms": 1.78}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10232334514799457, "policy_loss": -0.01742331687541258, "vf_loss": 11.794498918133398, "vf_explained_var": 0.09822229531503493, "kl": 0.010676595165686158, "entropy": 0.31011092685243136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3100000, "num_agent_steps_sampled": 3100000, "num_steps_trained": 3100000, "num_agent_steps_trained": 3100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31160, "training_iteration": 775, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-13-52", "timestamp": 1643710432, "time_this_iter_s": 17.69715714454651, "time_total_s": 19454.152648210526, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7194.64377117157, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 32.972, "ram_util_percent": 62.908}}
{"episode_reward_max": -3.0, "episode_reward_min": -38.099999999999945, "episode_reward_mean": -11.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.7, -8.9, -12.399999999999999, -7.3, -4.6000000000000005, -4.3, -10.3, -6.0, -18.3, -8.2, -13.700000000000001, -11.2, -12.600000000000001, -8.3, -9.0, -5.1, -5.3, -27.200000000000003, -9.3, -29.500000000000004, -12.3, -13.299999999999997, -7.3, -20.500000000000004, -20.599999999999994, -4.3, -12.8, -13.2, -4.3, -14.3, -15.599999999999998, -20.6, -8.2, -30.600000000000033, -5.3, -3.0, -7.3, -15.19999999999999, -6.3, -6.3, -7.799999999999999, -13.199999999999998, -11.099999999999998, -4.899999999999999, -20.6, -5.2, -9.600000000000001, -5.4, -7.7, -9.3, -11.599999999999996, -19.9, -7.4, -12.3, -12.2, -7.599999999999999, -25.6, -4.9, -9.3, -14.299999999999999, -6.300000000000001, -14.399999999999999, -7.3, -7.0, -8.3, -19.700000000000003, -6.9, -15.5, -21.200000000000006, -15.3, -8.3, -15.199999999999998, -8.3, -7.2, -6.3999999999999995, -6.3, -38.099999999999945, -5.300000000000001, -6.2, -13.2, -34.59999999999999, -19.800000000000004, -26.9, -3.3000000000000003, -4.4, -7.2, -8.3, -8.7, -6.2, -6.2, -9.3, -9.89999999999999, -14.499999999999998, -7.3, -12.899999999999999, -5.9, -15.19999999999998, -15.999999999999998, -6.4, -12.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0890481887957726, "mean_inference_ms": 1.445513578794722, "mean_action_processing_ms": 0.07810561291406011, "mean_env_wait_ms": 6.570354687280419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3104000, "timesteps_this_iter": 0, "agent_timesteps_total": 3104000, "timers": {"sample_time_ms": 16716.483, "sample_throughput": 239.285, "load_time_ms": 0.349, "load_throughput": 11457499.146, "learn_time_ms": 8268.824, "learn_throughput": 483.745, "update_time_ms": 1.859}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09776995486219324, "policy_loss": -0.024384712230073668, "vf_loss": 11.999174921230603, "vf_explained_var": 0.276444290273933, "kl": 0.01281731794841526, "entropy": 0.30446733153795685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3104000, "num_agent_steps_sampled": 3104000, "num_steps_trained": 3104000, "num_agent_steps_trained": 3104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31200, "training_iteration": 776, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-14-07", "timestamp": 1643710447, "time_this_iter_s": 15.526983737945557, "time_total_s": 19469.67963194847, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7210.170754909515, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 32.38181818181818, "ram_util_percent": 62.96363636363637}}
{"episode_reward_max": -2.2, "episode_reward_min": -38.099999999999945, "episode_reward_mean": -10.787, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.799999999999999, -13.199999999999998, -11.099999999999998, -4.899999999999999, -20.6, -5.2, -9.600000000000001, -5.4, -7.7, -9.3, -11.599999999999996, -19.9, -7.4, -12.3, -12.2, -7.599999999999999, -25.6, -4.9, -9.3, -14.299999999999999, -6.300000000000001, -14.399999999999999, -7.3, -7.0, -8.3, -19.700000000000003, -6.9, -15.5, -21.200000000000006, -15.3, -8.3, -15.199999999999998, -8.3, -7.2, -6.3999999999999995, -6.3, -38.099999999999945, -5.300000000000001, -6.2, -13.2, -34.59999999999999, -19.800000000000004, -26.9, -3.3000000000000003, -4.4, -7.2, -8.3, -8.7, -6.2, -6.2, -9.3, -9.89999999999999, -14.499999999999998, -7.3, -12.899999999999999, -5.9, -15.19999999999998, -15.999999999999998, -6.4, -12.2, -6.3, -14.5, -9.3, -5.3, -17.3, -8.3, -10.4, -29.200000000000024, -6.4, -6.300000000000001, -19.300000000000033, -7.4, -9.200000000000001, -3.7000000000000006, -17.499999999999993, -11.499999999999984, -6.1, -10.3, -3.7000000000000006, -7.300000000000001, -6.2, -4.4, -11.199999999999994, -7.4, -5.800000000000001, -5.300000000000001, -5.3, -9.2, -12.3, -11.099999999999998, -7.300000000000001, -15.3, -2.2, -7.4, -11.3, -12.399999999999999, -18.3, -6.300000000000001, -13.799999999999997, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.088829945357609, "mean_inference_ms": 1.4451330851946165, "mean_action_processing_ms": 0.07808476132266053, "mean_env_wait_ms": 6.568509783387217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3108000, "timesteps_this_iter": 0, "agent_timesteps_total": 3108000, "timers": {"sample_time_ms": 16744.52, "sample_throughput": 238.884, "load_time_ms": 0.359, "load_throughput": 11143949.518, "learn_time_ms": 8375.735, "learn_throughput": 477.57, "update_time_ms": 1.902}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.037439410887177914, "policy_loss": -0.030823014177862675, "vf_loss": 6.5932602433107235, "vf_explained_var": 0.387210262462657, "kl": 0.013806367765721866, "entropy": 0.31559874654136677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3108000, "num_agent_steps_sampled": 3108000, "num_steps_trained": 3108000, "num_agent_steps_trained": 3108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31240, "training_iteration": 777, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-14-26", "timestamp": 1643710466, "time_this_iter_s": 18.065003871917725, "time_total_s": 19487.74463582039, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7228.235758781433, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 40.84615384615385, "ram_util_percent": 63.084615384615375}}
{"episode_reward_max": -2.2, "episode_reward_min": -34.59999999999999, "episode_reward_mean": -11.457, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.59999999999999, -19.800000000000004, -26.9, -3.3000000000000003, -4.4, -7.2, -8.3, -8.7, -6.2, -6.2, -9.3, -9.89999999999999, -14.499999999999998, -7.3, -12.899999999999999, -5.9, -15.19999999999998, -15.999999999999998, -6.4, -12.2, -6.3, -14.5, -9.3, -5.3, -17.3, -8.3, -10.4, -29.200000000000024, -6.4, -6.300000000000001, -19.300000000000033, -7.4, -9.200000000000001, -3.7000000000000006, -17.499999999999993, -11.499999999999984, -6.1, -10.3, -3.7000000000000006, -7.300000000000001, -6.2, -4.4, -11.199999999999994, -7.4, -5.800000000000001, -5.300000000000001, -5.3, -9.2, -12.3, -11.099999999999998, -7.300000000000001, -15.3, -2.2, -7.4, -11.3, -12.399999999999999, -18.3, -6.300000000000001, -13.799999999999997, -5.4, -15.5, -18.4, -26.0, -15.7, -5.0, -22.799999999999997, -10.7, -13.399999999999997, -25.200000000000017, -15.899999999999999, -8.2, -18.2, -9.4, -5.4, -4.2, -12.5, -11.2, -8.3, -5.299999999999999, -14.3, -31.7, -7.699999999999999, -23.4, -9.4, -7.999999999999998, -14.2, -5.3, -30.3, -26.40000000000006, -6.6000000000000005, -6.4, -6.2, -6.3, -5.5, -8.0, -12.1, -5.4, -27.300000000000015, -12.2, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0886992587439415, "mean_inference_ms": 1.444809887072853, "mean_action_processing_ms": 0.078067309432492, "mean_env_wait_ms": 6.566857519380327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3112000, "timesteps_this_iter": 0, "agent_timesteps_total": 3112000, "timers": {"sample_time_ms": 16955.9, "sample_throughput": 235.906, "load_time_ms": 0.362, "load_throughput": 11038368.314, "learn_time_ms": 8385.642, "learn_throughput": 477.006, "update_time_ms": 1.994}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17044968560002544, "policy_loss": -0.007944274477420315, "vf_loss": 17.645666811543126, "vf_explained_var": 0.15247690600733604, "kl": 0.011480269165623492, "entropy": 0.26935235460599266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3112000, "num_agent_steps_sampled": 3112000, "num_steps_trained": 3112000, "num_agent_steps_trained": 3112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31280, "training_iteration": 778, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-14-43", "timestamp": 1643710483, "time_this_iter_s": 17.454713821411133, "time_total_s": 19505.1993496418, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7245.690472602844, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 38.564, "ram_util_percent": 63.1}}
{"episode_reward_max": -2.2, "episode_reward_min": -94.19999999999982, "episode_reward_mean": -12.289000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -4.4, -11.199999999999994, -7.4, -5.800000000000001, -5.300000000000001, -5.3, -9.2, -12.3, -11.099999999999998, -7.300000000000001, -15.3, -2.2, -7.4, -11.3, -12.399999999999999, -18.3, -6.300000000000001, -13.799999999999997, -5.4, -15.5, -18.4, -26.0, -15.7, -5.0, -22.799999999999997, -10.7, -13.399999999999997, -25.200000000000017, -15.899999999999999, -8.2, -18.2, -9.4, -5.4, -4.2, -12.5, -11.2, -8.3, -5.299999999999999, -14.3, -31.7, -7.699999999999999, -23.4, -9.4, -7.999999999999998, -14.2, -5.3, -30.3, -26.40000000000006, -6.6000000000000005, -6.4, -6.2, -6.3, -5.5, -8.0, -12.1, -5.4, -27.300000000000015, -12.2, -5.300000000000001, -4.3, -21.800000000000008, -5.4, -94.19999999999982, -7.300000000000001, -6.2, -18.7, -6.4, -5.3, -22.999999999999996, -10.899999999999999, -13.599999999999998, -21.7, -15.900000000000018, -20.8, -12.4, -8.4, -6.699999999999999, -7.3, -9.4, -2.4000000000000004, -15.999999999999998, -7.300000000000001, -7.300000000000001, -12.2, -6.300000000000001, -6.4, -5.3, -8.2, -5.4, -15.1, -10.3, -8.4, -6.2, -28.10000000000004, -23.6, -16.2, -7.5, -12.5, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0885148277941856, "mean_inference_ms": 1.4444774850896749, "mean_action_processing_ms": 0.07804980757799558, "mean_env_wait_ms": 6.565096441793239, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3116000, "timesteps_this_iter": 0, "agent_timesteps_total": 3116000, "timers": {"sample_time_ms": 16940.537, "sample_throughput": 236.12, "load_time_ms": 0.359, "load_throughput": 11135813.089, "learn_time_ms": 8223.914, "learn_throughput": 486.386, "update_time_ms": 1.914}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3522911238341382, "policy_loss": -0.029023502406574066, "vf_loss": 37.93071134782607, "vf_explained_var": 0.17906921525155345, "kl": 0.011896414973755876, "entropy": 0.3111567784541397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3116000, "num_agent_steps_sampled": 3116000, "num_steps_trained": 3116000, "num_agent_steps_trained": 3116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31320, "training_iteration": 779, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-14-59", "timestamp": 1643710499, "time_this_iter_s": 15.921134233474731, "time_total_s": 19521.120483875275, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7261.611606836319, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 33.560869565217395, "ram_util_percent": 63.082608695652155}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -94.19999999999982, "episode_reward_mean": -13.538, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.7, -7.699999999999999, -23.4, -9.4, -7.999999999999998, -14.2, -5.3, -30.3, -26.40000000000006, -6.6000000000000005, -6.4, -6.2, -6.3, -5.5, -8.0, -12.1, -5.4, -27.300000000000015, -12.2, -5.300000000000001, -4.3, -21.800000000000008, -5.4, -94.19999999999982, -7.300000000000001, -6.2, -18.7, -6.4, -5.3, -22.999999999999996, -10.899999999999999, -13.599999999999998, -21.7, -15.900000000000018, -20.8, -12.4, -8.4, -6.699999999999999, -7.3, -9.4, -2.4000000000000004, -15.999999999999998, -7.300000000000001, -7.300000000000001, -12.2, -6.300000000000001, -6.4, -5.3, -8.2, -5.4, -15.1, -10.3, -8.4, -6.2, -28.10000000000004, -23.6, -16.2, -7.5, -12.5, -3.3, -6.3, -12.2, -5.3, -13.099999999999993, -27.799999999999997, -16.2, -20.700000000000003, -6.799999999999999, -9.799999999999999, -16.599999999999998, -10.799999999999999, -22.5, -17.799999999999997, -17.3, -15.899999999999997, -16.4, -15.099999999999993, -19.2, -14.8, -13.2, -16.799999999999997, -22.9, -18.2, -9.3, -11.799999999999997, -12.899999999999999, -3.3, -15.3, -17.7, -9.3, -6.2, -14.899999999999997, -14.199999999999998, -8.2, -13.7, -9.2, -15.8, -21.299999999999997, -8.7, -20.899999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0882017640877946, "mean_inference_ms": 1.4440740974474977, "mean_action_processing_ms": 0.0780281011319805, "mean_env_wait_ms": 6.562993623275175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3120000, "timesteps_this_iter": 0, "agent_timesteps_total": 3120000, "timers": {"sample_time_ms": 16779.352, "sample_throughput": 238.388, "load_time_ms": 0.37, "load_throughput": 10802405.512, "learn_time_ms": 8365.08, "learn_throughput": 478.178, "update_time_ms": 1.918}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08862576301620212, "policy_loss": -0.025264213543625607, "vf_loss": 11.14902796347936, "vf_explained_var": 0.33177189993601974, "kl": 0.014220438517741255, "entropy": 0.27595725940760746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3120000, "num_agent_steps_sampled": 3120000, "num_steps_trained": 3120000, "num_agent_steps_trained": 3120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31360, "training_iteration": 780, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-15-17", "timestamp": 1643710517, "time_this_iter_s": 17.974036931991577, "time_total_s": 19539.094520807266, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7279.585643768311, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 39.552, "ram_util_percent": 63.092}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -31.399999999999963, "episode_reward_mean": -13.204999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000004, -15.999999999999998, -7.300000000000001, -7.300000000000001, -12.2, -6.300000000000001, -6.4, -5.3, -8.2, -5.4, -15.1, -10.3, -8.4, -6.2, -28.10000000000004, -23.6, -16.2, -7.5, -12.5, -3.3, -6.3, -12.2, -5.3, -13.099999999999993, -27.799999999999997, -16.2, -20.700000000000003, -6.799999999999999, -9.799999999999999, -16.599999999999998, -10.799999999999999, -22.5, -17.799999999999997, -17.3, -15.899999999999997, -16.4, -15.099999999999993, -19.2, -14.8, -13.2, -16.799999999999997, -22.9, -18.2, -9.3, -11.799999999999997, -12.899999999999999, -3.3, -15.3, -17.7, -9.3, -6.2, -14.899999999999997, -14.199999999999998, -8.2, -13.7, -9.2, -15.8, -21.299999999999997, -8.7, -20.899999999999995, -24.2, -16.599999999999998, -7.2, -21.5, -7.3, -18.3, -10.7, -15.7, -14.599999999999996, -8.4, -17.300000000000004, -12.2, -17.0, -9.3, -19.4, -14.899999999999999, -7.4, -18.6, -14.399999999999974, -10.3, -8.3, -11.3, -3.6000000000000005, -9.2, -10.599999999999998, -20.000000000000004, -8.2, -10.499999999999986, -19.7, -14.3, -31.399999999999963, -7.2, -18.2, -19.10000000000001, -19.7, -8.3, -5.300000000000001, -13.6, -7.3, -12.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.087850647636036, "mean_inference_ms": 1.443743999061018, "mean_action_processing_ms": 0.0780106603709245, "mean_env_wait_ms": 6.5612702523354995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3124000, "timesteps_this_iter": 0, "agent_timesteps_total": 3124000, "timers": {"sample_time_ms": 17005.974, "sample_throughput": 235.211, "load_time_ms": 0.366, "load_throughput": 10943327.898, "learn_time_ms": 8402.836, "learn_throughput": 476.03, "update_time_ms": 1.976}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08894618543025146, "policy_loss": -0.01577580335990636, "vf_loss": 10.285145540519427, "vf_explained_var": 0.32367790129876906, "kl": 0.01108464957978563, "entropy": 0.28669193101826534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3124000, "num_agent_steps_sampled": 3124000, "num_steps_trained": 3124000, "num_agent_steps_trained": 3124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31400, "training_iteration": 781, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-15-35", "timestamp": 1643710535, "time_this_iter_s": 17.778894901275635, "time_total_s": 19556.873415708542, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7297.364538669586, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 37.176923076923075, "ram_util_percent": 63.092307692307685}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -31.399999999999963, "episode_reward_mean": -12.805, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.799999999999997, -22.9, -18.2, -9.3, -11.799999999999997, -12.899999999999999, -3.3, -15.3, -17.7, -9.3, -6.2, -14.899999999999997, -14.199999999999998, -8.2, -13.7, -9.2, -15.8, -21.299999999999997, -8.7, -20.899999999999995, -24.2, -16.599999999999998, -7.2, -21.5, -7.3, -18.3, -10.7, -15.7, -14.599999999999996, -8.4, -17.300000000000004, -12.2, -17.0, -9.3, -19.4, -14.899999999999999, -7.4, -18.6, -14.399999999999974, -10.3, -8.3, -11.3, -3.6000000000000005, -9.2, -10.599999999999998, -20.000000000000004, -8.2, -10.499999999999986, -19.7, -14.3, -31.399999999999963, -7.2, -18.2, -19.10000000000001, -19.7, -8.3, -5.300000000000001, -13.6, -7.3, -12.999999999999998, -5.4, -6.3, -7.2, -9.3, -6.2, -17.999999999999996, -9.3, -6.300000000000001, -11.399999999999999, -10.3, -6.2, -5.2, -13.5, -13.499999999999995, -29.5, -11.3, -15.299999999999999, -17.3, -9.0, -12.2, -19.999999999999996, -10.2, -14.7, -10.3, -6.3, -21.200000000000014, -9.2, -15.1, -11.7, -21.0, -13.0, -3.2, -2.6000000000000005, -13.4, -22.10000000000007, -8.2, -7.2, -6.300000000000001, -11.2, -16.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0875106310720202, "mean_inference_ms": 1.4433360287591097, "mean_action_processing_ms": 0.07798907163196434, "mean_env_wait_ms": 6.559180348919413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3128000, "timesteps_this_iter": 0, "agent_timesteps_total": 3128000, "timers": {"sample_time_ms": 16858.428, "sample_throughput": 237.27, "load_time_ms": 0.361, "load_throughput": 11066765.172, "learn_time_ms": 8441.516, "learn_throughput": 473.849, "update_time_ms": 1.994}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07047712456770441, "policy_loss": -0.021520708756451245, "vf_loss": 9.002700819699996, "vf_explained_var": 0.4317962156829014, "kl": 0.011678964959815555, "entropy": 0.2612181119380459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3128000, "num_agent_steps_sampled": 3128000, "num_steps_trained": 3128000, "num_agent_steps_trained": 3128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31440, "training_iteration": 782, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-15-51", "timestamp": 1643710551, "time_this_iter_s": 16.007269859313965, "time_total_s": 19572.880685567856, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7313.3718085289, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 32.530434782608694, "ram_util_percent": 63.09999999999998}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -49.2, "episode_reward_mean": -12.646999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -11.3, -3.6000000000000005, -9.2, -10.599999999999998, -20.000000000000004, -8.2, -10.499999999999986, -19.7, -14.3, -31.399999999999963, -7.2, -18.2, -19.10000000000001, -19.7, -8.3, -5.300000000000001, -13.6, -7.3, -12.999999999999998, -5.4, -6.3, -7.2, -9.3, -6.2, -17.999999999999996, -9.3, -6.300000000000001, -11.399999999999999, -10.3, -6.2, -5.2, -13.5, -13.499999999999995, -29.5, -11.3, -15.299999999999999, -17.3, -9.0, -12.2, -19.999999999999996, -10.2, -14.7, -10.3, -6.3, -21.200000000000014, -9.2, -15.1, -11.7, -21.0, -13.0, -3.2, -2.6000000000000005, -13.4, -22.10000000000007, -8.2, -7.2, -6.300000000000001, -11.2, -16.2, -5.5, -12.0, -14.899999999999999, -9.0, -26.4, -8.3, -8.3, -9.2, -24.300000000000008, -18.2, -2.7000000000000006, -20.0, -5.3, -8.3, -7.699999999999999, -18.0, -49.2, -5.300000000000001, -16.0, -7.299999999999999, -29.900000000000006, -3.9000000000000004, -6.2, -14.199999999999996, -24.799999999999997, -9.7, -8.2, -9.2, -12.9, -13.399999999999999, -11.2, -14.3, -21.9, -21.099999999999998, -15.2, -12.999999999999996, -10.499999999999998, -8.3, -4.3, -12.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0873091767373586, "mean_inference_ms": 1.4429972217198372, "mean_action_processing_ms": 0.07797211972200764, "mean_env_wait_ms": 6.557415320785744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3132000, "timesteps_this_iter": 0, "agent_timesteps_total": 3132000, "timers": {"sample_time_ms": 17025.099, "sample_throughput": 234.947, "load_time_ms": 0.365, "load_throughput": 10963350.977, "learn_time_ms": 8670.5, "learn_throughput": 461.334, "update_time_ms": 1.95}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16299890878620327, "policy_loss": -0.017026157812866313, "vf_loss": 17.732278703105067, "vf_explained_var": 0.1869027155060922, "kl": 0.01601353070003989, "entropy": 0.3211745763017285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3132000, "num_agent_steps_sampled": 3132000, "num_steps_trained": 3132000, "num_agent_steps_trained": 3132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31480, "training_iteration": 783, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-16-10", "timestamp": 1643710570, "time_this_iter_s": 18.7475483417511, "time_total_s": 19591.628233909607, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7332.119356870651, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 41.13076923076923, "ram_util_percent": 63.01923076923077}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -49.2, "episode_reward_mean": -12.259, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.999999999999996, -10.2, -14.7, -10.3, -6.3, -21.200000000000014, -9.2, -15.1, -11.7, -21.0, -13.0, -3.2, -2.6000000000000005, -13.4, -22.10000000000007, -8.2, -7.2, -6.300000000000001, -11.2, -16.2, -5.5, -12.0, -14.899999999999999, -9.0, -26.4, -8.3, -8.3, -9.2, -24.300000000000008, -18.2, -2.7000000000000006, -20.0, -5.3, -8.3, -7.699999999999999, -18.0, -49.2, -5.300000000000001, -16.0, -7.299999999999999, -29.900000000000006, -3.9000000000000004, -6.2, -14.199999999999996, -24.799999999999997, -9.7, -8.2, -9.2, -12.9, -13.399999999999999, -11.2, -14.3, -21.9, -21.099999999999998, -15.2, -12.999999999999996, -10.499999999999998, -8.3, -4.3, -12.0, -6.799999999999999, -13.09999999999999, -4.300000000000001, -9.3, -9.3, -13.399999999999991, -12.4, -13.5, -26.2, -12.499999999999998, -17.3, -10.3, -23.700000000000003, -10.299999999999999, -2.4000000000000004, -3.4, -9.2, -4.7, -6.4, -4.800000000000001, -10.4, -5.3, -18.1, -10.5, -4.4, -6.2, -18.199999999999996, -8.3, -8.3, -8.3, -17.5, -7.499999999999999, -21.199999999999996, -6.3, -14.599999999999996, -13.899999999999995, -4.9, -10.2, -5.3, -30.00000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0871754022136255, "mean_inference_ms": 1.4428256296405653, "mean_action_processing_ms": 0.07796418391425367, "mean_env_wait_ms": 6.556474423103084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3136000, "timesteps_this_iter": 0, "agent_timesteps_total": 3136000, "timers": {"sample_time_ms": 17412.462, "sample_throughput": 229.721, "load_time_ms": 0.359, "load_throughput": 11131380.042, "learn_time_ms": 8613.4, "learn_throughput": 464.393, "update_time_ms": 1.936}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08273317655798809, "policy_loss": -0.022856467383443026, "vf_loss": 10.333080099475, "vf_explained_var": 0.13310161207311896, "kl": 0.013385749816987246, "entropy": 0.32275472507681896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3136000, "num_agent_steps_sampled": 3136000, "num_steps_trained": 3136000, "num_agent_steps_trained": 3136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31520, "training_iteration": 784, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-16-28", "timestamp": 1643710588, "time_this_iter_s": 18.036545038223267, "time_total_s": 19609.66477894783, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7350.1559019088745, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 41.949999999999996, "ram_util_percent": 63.02307692307692}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -30.00000000000001, "episode_reward_mean": -11.798, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.900000000000006, -3.9000000000000004, -6.2, -14.199999999999996, -24.799999999999997, -9.7, -8.2, -9.2, -12.9, -13.399999999999999, -11.2, -14.3, -21.9, -21.099999999999998, -15.2, -12.999999999999996, -10.499999999999998, -8.3, -4.3, -12.0, -6.799999999999999, -13.09999999999999, -4.300000000000001, -9.3, -9.3, -13.399999999999991, -12.4, -13.5, -26.2, -12.499999999999998, -17.3, -10.3, -23.700000000000003, -10.299999999999999, -2.4000000000000004, -3.4, -9.2, -4.7, -6.4, -4.800000000000001, -10.4, -5.3, -18.1, -10.5, -4.4, -6.2, -18.199999999999996, -8.3, -8.3, -8.3, -17.5, -7.499999999999999, -21.199999999999996, -6.3, -14.599999999999996, -13.899999999999995, -4.9, -10.2, -5.3, -30.00000000000001, -6.300000000000001, -17.1, -15.2, -12.999999999999996, -6.4, -7.300000000000001, -9.4, -16.8, -8.2, -10.2, -16.599999999999994, -3.2, -12.3, -12.3, -8.3, -19.0, -4.3, -26.1, -9.5, -7.2, -14.2, -20.5, -11.2, -7.3, -7.300000000000001, -7.300000000000001, -29.400000000000006, -8.9, -23.500000000000004, -10.3, -8.199999999999998, -2.6000000000000005, -11.4, -4.3, -18.4, -22.699999999999996, -6.2, -2.5, -17.5, -10.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0870074049793426, "mean_inference_ms": 1.4426470568651217, "mean_action_processing_ms": 0.07795609629087147, "mean_env_wait_ms": 6.555526607644964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3140000, "timesteps_this_iter": 0, "agent_timesteps_total": 3140000, "timers": {"sample_time_ms": 17236.083, "sample_throughput": 232.071, "load_time_ms": 0.377, "load_throughput": 10600376.572, "learn_time_ms": 8637.925, "learn_throughput": 463.074, "update_time_ms": 1.993}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08333411341913605, "policy_loss": -0.01066532354521495, "vf_loss": 9.239036957935621, "vf_explained_var": 0.2371668335571084, "kl": 0.009535228906200028, "entropy": 0.2946954669490937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3140000, "num_agent_steps_sampled": 3140000, "num_steps_trained": 3140000, "num_agent_steps_trained": 3140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31560, "training_iteration": 785, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-16-44", "timestamp": 1643710604, "time_this_iter_s": 16.749395847320557, "time_total_s": 19626.41417479515, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7366.905297756195, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 31.270833333333332, "ram_util_percent": 63.025}}
{"episode_reward_max": -2.5, "episode_reward_min": -30.00000000000001, "episode_reward_mean": -11.776, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.4, -5.3, -18.1, -10.5, -4.4, -6.2, -18.199999999999996, -8.3, -8.3, -8.3, -17.5, -7.499999999999999, -21.199999999999996, -6.3, -14.599999999999996, -13.899999999999995, -4.9, -10.2, -5.3, -30.00000000000001, -6.300000000000001, -17.1, -15.2, -12.999999999999996, -6.4, -7.300000000000001, -9.4, -16.8, -8.2, -10.2, -16.599999999999994, -3.2, -12.3, -12.3, -8.3, -19.0, -4.3, -26.1, -9.5, -7.2, -14.2, -20.5, -11.2, -7.3, -7.300000000000001, -7.300000000000001, -29.400000000000006, -8.9, -23.500000000000004, -10.3, -8.199999999999998, -2.6000000000000005, -11.4, -4.3, -18.4, -22.699999999999996, -6.2, -2.5, -17.5, -10.499999999999998, -15.2, -12.3, -8.7, -7.3, -17.2, -22.4, -7.3, -9.5, -14.600000000000001, -17.900000000000006, -15.600000000000001, -17.099999999999998, -7.2, -12.199999999999973, -8.1, -9.499999999999998, -7.999999999999998, -14.8, -16.799999999999997, -7.4, -4.4, -14.3, -8.9, -8.6, -15.999999999999975, -5.2, -6.4, -11.2, -14.599999999999998, -26.800000000000008, -4.2, -5.4, -8.3, -5.4, -10.5, -7.599999999999999, -4.300000000000001, -25.4, -13.999999999999998, -24.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0867964007190496, "mean_inference_ms": 1.4423840846650713, "mean_action_processing_ms": 0.07794549620258336, "mean_env_wait_ms": 6.554143510781441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3144000, "timesteps_this_iter": 0, "agent_timesteps_total": 3144000, "timers": {"sample_time_ms": 17354.101, "sample_throughput": 230.493, "load_time_ms": 0.38, "load_throughput": 10524569.349, "learn_time_ms": 8663.842, "learn_throughput": 461.689, "update_time_ms": 1.966}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.0798337617673741, "policy_loss": -0.01643990970326848, "vf_loss": 9.443678401747057, "vf_explained_var": 0.2563773785867999, "kl": 0.010885279836721449, "entropy": 0.2955941234705269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3144000, "num_agent_steps_sampled": 3144000, "num_steps_trained": 3144000, "num_agent_steps_trained": 3144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31600, "training_iteration": 786, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-17-01", "timestamp": 1643710621, "time_this_iter_s": 16.71745991706848, "time_total_s": 19643.13163471222, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7383.622757673264, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 29.77916666666667, "ram_util_percent": 63.02916666666666}}
{"episode_reward_max": -2.5, "episode_reward_min": -29.400000000000006, "episode_reward_mean": -11.145999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -20.5, -11.2, -7.3, -7.300000000000001, -7.300000000000001, -29.400000000000006, -8.9, -23.500000000000004, -10.3, -8.199999999999998, -2.6000000000000005, -11.4, -4.3, -18.4, -22.699999999999996, -6.2, -2.5, -17.5, -10.499999999999998, -15.2, -12.3, -8.7, -7.3, -17.2, -22.4, -7.3, -9.5, -14.600000000000001, -17.900000000000006, -15.600000000000001, -17.099999999999998, -7.2, -12.199999999999973, -8.1, -9.499999999999998, -7.999999999999998, -14.8, -16.799999999999997, -7.4, -4.4, -14.3, -8.9, -8.6, -15.999999999999975, -5.2, -6.4, -11.2, -14.599999999999998, -26.800000000000008, -4.2, -5.4, -8.3, -5.4, -10.5, -7.599999999999999, -4.300000000000001, -25.4, -13.999999999999998, -24.700000000000003, -11.1, -7.4, -9.399999999999999, -9.5, -4.2, -4.2, -10.4, -10.3, -2.5, -8.3, -17.099999999999998, -11.099999999999998, -7.3, -5.5, -19.200000000000003, -11.1, -10.3, -12.299999999999997, -8.3, -3.8000000000000003, -11.899999999999999, -3.7, -20.799999999999997, -8.3, -5.2, -9.2, -6.4, -24.199999999999996, -9.6, -18.800000000000004, -10.2, -4.6000000000000005, -5.2, -11.3, -5.4, -7.4, -16.1, -12.3, -6.4, -14.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0866113255493925, "mean_inference_ms": 1.4421509417745904, "mean_action_processing_ms": 0.07793631470931231, "mean_env_wait_ms": 6.552819781900789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3148000, "timesteps_this_iter": 0, "agent_timesteps_total": 3148000, "timers": {"sample_time_ms": 17380.826, "sample_throughput": 230.139, "load_time_ms": 0.372, "load_throughput": 10759453.601, "learn_time_ms": 8602.241, "learn_throughput": 464.995, "update_time_ms": 1.907}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.04757219890573172, "policy_loss": -0.027946251110544287, "vf_loss": 7.367255642978094, "vf_explained_var": 0.26328229493992306, "kl": 0.01093864769489828, "entropy": 0.2843583322180215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3148000, "num_agent_steps_sampled": 3148000, "num_steps_trained": 3148000, "num_agent_steps_trained": 3148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31640, "training_iteration": 787, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-17-19", "timestamp": 1643710639, "time_this_iter_s": 17.447834014892578, "time_total_s": 19660.57946872711, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7401.070591688156, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 29.148000000000003, "ram_util_percent": 63.092}}
{"episode_reward_max": -2.5, "episode_reward_min": -26.800000000000008, "episode_reward_mean": -10.666000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -14.3, -8.9, -8.6, -15.999999999999975, -5.2, -6.4, -11.2, -14.599999999999998, -26.800000000000008, -4.2, -5.4, -8.3, -5.4, -10.5, -7.599999999999999, -4.300000000000001, -25.4, -13.999999999999998, -24.700000000000003, -11.1, -7.4, -9.399999999999999, -9.5, -4.2, -4.2, -10.4, -10.3, -2.5, -8.3, -17.099999999999998, -11.099999999999998, -7.3, -5.5, -19.200000000000003, -11.1, -10.3, -12.299999999999997, -8.3, -3.8000000000000003, -11.899999999999999, -3.7, -20.799999999999997, -8.3, -5.2, -9.2, -6.4, -24.199999999999996, -9.6, -18.800000000000004, -10.2, -4.6000000000000005, -5.2, -11.3, -5.4, -7.4, -16.1, -12.3, -6.4, -14.799999999999999, -9.3, -8.899999999999999, -5.3, -5.300000000000001, -5.4, -8.3, -13.2, -21.500000000000004, -21.200000000000063, -6.6, -4.3, -9.3, -21.2, -15.9, -9.3, -11.2, -11.3, -8.2, -6.300000000000001, -19.9, -7.800000000000001, -11.1, -11.699999999999998, -13.399999999999999, -7.599999999999999, -8.5, -6.2, -17.6, -10.3, -6.300000000000001, -14.3, -11.399999999999999, -5.3, -20.40000000000001, -6.300000000000001, -17.5, -12.199999999999998, -22.3, -9.000000000000002, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0863837215822065, "mean_inference_ms": 1.4418305295210092, "mean_action_processing_ms": 0.07791883343587495, "mean_env_wait_ms": 6.551005947646379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3152000, "timesteps_this_iter": 0, "agent_timesteps_total": 3152000, "timers": {"sample_time_ms": 17202.273, "sample_throughput": 232.527, "load_time_ms": 0.365, "load_throughput": 10969085.322, "learn_time_ms": 8573.369, "learn_throughput": 466.561, "update_time_ms": 1.826}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.05569671189152105, "policy_loss": -0.022741301786354792, "vf_loss": 7.616050600492826, "vf_explained_var": 0.40778049679212675, "kl": 0.013496353052387045, "entropy": 0.30485194439208635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3152000, "num_agent_steps_sampled": 3152000, "num_steps_trained": 3152000, "num_agent_steps_trained": 3152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31680, "training_iteration": 788, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-17-35", "timestamp": 1643710655, "time_this_iter_s": 16.00450372695923, "time_total_s": 19676.58397245407, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7417.075095415115, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 28.90454545454546, "ram_util_percent": 63.09999999999998}}
{"episode_reward_max": -3.7, "episode_reward_min": -29.400000000000013, "episode_reward_mean": -10.635, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999999, -3.7, -20.799999999999997, -8.3, -5.2, -9.2, -6.4, -24.199999999999996, -9.6, -18.800000000000004, -10.2, -4.6000000000000005, -5.2, -11.3, -5.4, -7.4, -16.1, -12.3, -6.4, -14.799999999999999, -9.3, -8.899999999999999, -5.3, -5.300000000000001, -5.4, -8.3, -13.2, -21.500000000000004, -21.200000000000063, -6.6, -4.3, -9.3, -21.2, -15.9, -9.3, -11.2, -11.3, -8.2, -6.300000000000001, -19.9, -7.800000000000001, -11.1, -11.699999999999998, -13.399999999999999, -7.599999999999999, -8.5, -6.2, -17.6, -10.3, -6.300000000000001, -14.3, -11.399999999999999, -5.3, -20.40000000000001, -6.300000000000001, -17.5, -12.199999999999998, -22.3, -9.000000000000002, -4.2, -10.6, -17.9, -3.8000000000000007, -4.3, -7.3, -8.399999999999997, -10.600000000000001, -4.2, -12.2, -7.300000000000001, -5.3, -15.5, -8.2, -15.3, -5.3, -8.2, -8.4, -12.199999999999996, -5.300000000000001, -21.3, -5.2, -4.3, -8.3, -13.2, -7.9, -22.9, -7.2, -29.400000000000013, -8.3, -9.2, -10.9, -15.299999999999983, -8.8, -9.2, -14.3, -7.3, -7.3, -7.2, -8.3, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.086120551254649, "mean_inference_ms": 1.4413852407903593, "mean_action_processing_ms": 0.07789488206096111, "mean_env_wait_ms": 6.548679014039115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3156000, "timesteps_this_iter": 0, "agent_timesteps_total": 3156000, "timers": {"sample_time_ms": 17192.107, "sample_throughput": 232.665, "load_time_ms": 0.36, "load_throughput": 11107061.238, "learn_time_ms": 8587.177, "learn_throughput": 465.811, "update_time_ms": 1.86}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.03490279506871937, "policy_loss": -0.02278136857184431, "vf_loss": 5.563828557729721, "vf_explained_var": 0.47112543038142624, "kl": 0.01212372806201606, "entropy": 0.3195763077787174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3156000, "num_agent_steps_sampled": 3156000, "num_steps_trained": 3156000, "num_agent_steps_trained": 3156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31720, "training_iteration": 789, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-17-51", "timestamp": 1643710671, "time_this_iter_s": 16.272217273712158, "time_total_s": 19692.856189727783, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7433.3473126888275, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 30.954166666666666, "ram_util_percent": 63.291666666666664}}
{"episode_reward_max": -1.7999999999999998, "episode_reward_min": -29.400000000000013, "episode_reward_mean": -10.715000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.800000000000001, -11.1, -11.699999999999998, -13.399999999999999, -7.599999999999999, -8.5, -6.2, -17.6, -10.3, -6.300000000000001, -14.3, -11.399999999999999, -5.3, -20.40000000000001, -6.300000000000001, -17.5, -12.199999999999998, -22.3, -9.000000000000002, -4.2, -10.6, -17.9, -3.8000000000000007, -4.3, -7.3, -8.399999999999997, -10.600000000000001, -4.2, -12.2, -7.300000000000001, -5.3, -15.5, -8.2, -15.3, -5.3, -8.2, -8.4, -12.199999999999996, -5.300000000000001, -21.3, -5.2, -4.3, -8.3, -13.2, -7.9, -22.9, -7.2, -29.400000000000013, -8.3, -9.2, -10.9, -15.299999999999983, -8.8, -9.2, -14.3, -7.3, -7.3, -7.2, -8.3, -10.3, -7.5, -9.3, -18.9, -16.89999999999999, -20.9, -9.3, -2.5, -8.2, -18.500000000000004, -5.300000000000001, -22.699999999999996, -6.3, -17.199999999999996, -8.299999999999999, -4.4, -6.2, -16.099999999999998, -10.0, -6.2, -7.2, -9.899999999999997, -13.7, -8.999999999999996, -7.2, -1.7999999999999998, -10.5, -17.5, -22.5, -21.500000000000004, -3.4000000000000004, -8.2, -19.699999999999996, -9.2, -8.3, -7.300000000000001, -10.399999999999999, -11.200000000000001, -10.2, -8.2, -10.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0857072558615135, "mean_inference_ms": 1.4408572164160989, "mean_action_processing_ms": 0.07786583149033995, "mean_env_wait_ms": 6.54609454681324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3160000, "timesteps_this_iter": 0, "agent_timesteps_total": 3160000, "timers": {"sample_time_ms": 17156.435, "sample_throughput": 233.149, "load_time_ms": 0.345, "load_throughput": 11589676.706, "learn_time_ms": 8434.406, "learn_throughput": 474.248, "update_time_ms": 1.863}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.073204340577446, "policy_loss": -0.008856421044116379, "vf_loss": 8.047961130962577, "vf_explained_var": 0.3534307461912914, "kl": 0.009369782633701805, "entropy": 0.29438994318567296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3160000, "num_agent_steps_sampled": 3160000, "num_steps_trained": 3160000, "num_agent_steps_trained": 3160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31760, "training_iteration": 790, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-18-07", "timestamp": 1643710687, "time_this_iter_s": 15.948964834213257, "time_total_s": 19708.805154561996, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7449.296277523041, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 26.700000000000003, "ram_util_percent": 63.08181818181817}}
{"episode_reward_max": -1.7999999999999998, "episode_reward_min": -30.300000000000004, "episode_reward_mean": -10.698000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -4.3, -8.3, -13.2, -7.9, -22.9, -7.2, -29.400000000000013, -8.3, -9.2, -10.9, -15.299999999999983, -8.8, -9.2, -14.3, -7.3, -7.3, -7.2, -8.3, -10.3, -7.5, -9.3, -18.9, -16.89999999999999, -20.9, -9.3, -2.5, -8.2, -18.500000000000004, -5.300000000000001, -22.699999999999996, -6.3, -17.199999999999996, -8.299999999999999, -4.4, -6.2, -16.099999999999998, -10.0, -6.2, -7.2, -9.899999999999997, -13.7, -8.999999999999996, -7.2, -1.7999999999999998, -10.5, -17.5, -22.5, -21.500000000000004, -3.4000000000000004, -8.2, -19.699999999999996, -9.2, -8.3, -7.300000000000001, -10.399999999999999, -11.200000000000001, -10.2, -8.2, -10.099999999999998, -7.3, -10.3, -6.4, -15.9, -7.9, -30.300000000000004, -17.099999999999998, -7.6, -10.0, -17.9, -10.5, -5.3, -5.699999999999999, -5.3, -6.3, -15.899999999999997, -19.0, -15.799999999999999, -18.7, -3.2, -8.4, -6.4, -5.9, -7.2, -25.500000000000032, -4.700000000000001, -14.699999999999998, -3.3, -5.3, -7.300000000000001, -12.1, -4.3, -8.4, -6.300000000000001, -6.300000000000001, -7.9, -15.899999999999997, -6.5, -3.3, -17.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0853091714420189, "mean_inference_ms": 1.4403290459416629, "mean_action_processing_ms": 0.07783684879378562, "mean_env_wait_ms": 6.543536064548605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3164000, "timesteps_this_iter": 0, "agent_timesteps_total": 3164000, "timers": {"sample_time_ms": 16909.946, "sample_throughput": 236.547, "load_time_ms": 0.348, "load_throughput": 11490456.818, "learn_time_ms": 8370.984, "learn_throughput": 477.841, "update_time_ms": 1.816}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06256670779373337, "policy_loss": -0.0216352163849058, "vf_loss": 8.217828026702326, "vf_explained_var": 0.34675174393961505, "kl": 0.011991974462969561, "entropy": 0.30466193413381937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3164000, "num_agent_steps_sampled": 3164000, "num_steps_trained": 3164000, "num_agent_steps_trained": 3164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31800, "training_iteration": 791, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-18-23", "timestamp": 1643710703, "time_this_iter_s": 16.20442008972168, "time_total_s": 19725.009574651718, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7465.500697612762, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 31.554166666666664, "ram_util_percent": 63.05416666666667}}
{"episode_reward_max": -1.7999999999999998, "episode_reward_min": -80.70000000000009, "episode_reward_mean": -12.408, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.899999999999997, -13.7, -8.999999999999996, -7.2, -1.7999999999999998, -10.5, -17.5, -22.5, -21.500000000000004, -3.4000000000000004, -8.2, -19.699999999999996, -9.2, -8.3, -7.300000000000001, -10.399999999999999, -11.200000000000001, -10.2, -8.2, -10.099999999999998, -7.3, -10.3, -6.4, -15.9, -7.9, -30.300000000000004, -17.099999999999998, -7.6, -10.0, -17.9, -10.5, -5.3, -5.699999999999999, -5.3, -6.3, -15.899999999999997, -19.0, -15.799999999999999, -18.7, -3.2, -8.4, -6.4, -5.9, -7.2, -25.500000000000032, -4.700000000000001, -14.699999999999998, -3.3, -5.3, -7.300000000000001, -12.1, -4.3, -8.4, -6.300000000000001, -6.300000000000001, -7.9, -15.899999999999997, -6.5, -3.3, -17.2, -7.3, -10.899999999999999, -17.800000000000004, -5.2, -7.3, -17.199999999999996, -14.2, -5.4, -9.3, -18.900000000000006, -16.69999999999999, -17.3, -80.70000000000009, -4.3, -12.4, -19.099999999999994, -16.4, -8.0, -6.300000000000001, -6.2, -9.3, -9.3, -5.2, -7.4, -48.2, -21.4, -13.999999999999998, -21.999999999999996, -7.3, -35.90000000000001, -19.1, -5.3, -3.4, -5.3, -42.5, -9.3, -5.3, -26.00000000000002, -6.300000000000001, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0850290749816063, "mean_inference_ms": 1.4399623676228988, "mean_action_processing_ms": 0.0778169052174974, "mean_env_wait_ms": 6.5417285394139375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3168000, "timesteps_this_iter": 0, "agent_timesteps_total": 3168000, "timers": {"sample_time_ms": 16980.75, "sample_throughput": 235.561, "load_time_ms": 0.346, "load_throughput": 11572888.184, "learn_time_ms": 8384.672, "learn_throughput": 477.061, "update_time_ms": 1.849}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.42312627020342053, "policy_loss": -0.030145867655344147, "vf_loss": 45.05821589792288, "vf_explained_var": 0.13297524689346232, "kl": 0.015940660427519338, "entropy": 0.33091002037768724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3168000, "num_agent_steps_sampled": 3168000, "num_steps_trained": 3168000, "num_agent_steps_trained": 3168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31840, "training_iteration": 792, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-18-41", "timestamp": 1643710721, "time_this_iter_s": 17.493807792663574, "time_total_s": 19742.50338244438, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7482.994505405426, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 42.00416666666666, "ram_util_percent": 63.125}}
{"episode_reward_max": -3.3, "episode_reward_min": -92.3, "episode_reward_mean": -14.127000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.4, -6.4, -5.9, -7.2, -25.500000000000032, -4.700000000000001, -14.699999999999998, -3.3, -5.3, -7.300000000000001, -12.1, -4.3, -8.4, -6.300000000000001, -6.300000000000001, -7.9, -15.899999999999997, -6.5, -3.3, -17.2, -7.3, -10.899999999999999, -17.800000000000004, -5.2, -7.3, -17.199999999999996, -14.2, -5.4, -9.3, -18.900000000000006, -16.69999999999999, -17.3, -80.70000000000009, -4.3, -12.4, -19.099999999999994, -16.4, -8.0, -6.300000000000001, -6.2, -9.3, -9.3, -5.2, -7.4, -48.2, -21.4, -13.999999999999998, -21.999999999999996, -7.3, -35.90000000000001, -19.1, -5.3, -3.4, -5.3, -42.5, -9.3, -5.3, -26.00000000000002, -6.300000000000001, -4.300000000000001, -11.299999999999999, -7.300000000000001, -10.099999999999998, -14.9, -12.899999999999999, -11.899999999999997, -8.5, -19.5, -7.300000000000001, -14.2, -41.39999999999992, -9.9, -13.799999999999999, -17.2, -14.7, -9.299999999999999, -7.300000000000001, -10.2, -73.2, -11.899999999999999, -6.3, -7.300000000000001, -21.999999999999996, -7.300000000000001, -17.299999999999997, -92.3, -9.7, -18.000000000000004, -15.799999999999992, -8.3, -6.4, -19.500000000000004, -7.300000000000001, -9.299999999999997, -13.299999999999997, -9.199999999999998, -8.4, -5.2, -10.3, -8.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.084771689381202, "mean_inference_ms": 1.4396435346632432, "mean_action_processing_ms": 0.07779988168559662, "mean_env_wait_ms": 6.540172318417913, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3172000, "timesteps_this_iter": 0, "agent_timesteps_total": 3172000, "timers": {"sample_time_ms": 16927.054, "sample_throughput": 236.308, "load_time_ms": 0.345, "load_throughput": 11606514.009, "learn_time_ms": 8210.828, "learn_throughput": 487.162, "update_time_ms": 1.826}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.6051428098254086, "policy_loss": -0.02602895079531096, "vf_loss": 62.79125265588043, "vf_explained_var": 0.13271963577116688, "kl": 0.019314093584028573, "entropy": 0.3232265954056094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3172000, "num_agent_steps_sampled": 3172000, "num_steps_trained": 3172000, "num_agent_steps_trained": 3172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31880, "training_iteration": 793, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-18-57", "timestamp": 1643710737, "time_this_iter_s": 16.32799506187439, "time_total_s": 19758.831377506256, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7499.3225004673, "timesteps_since_restore": 0, "iterations_since_restore": 397, "perf": {"cpu_util_percent": 40.54583333333334, "ram_util_percent": 63.10833333333334}}
{"episode_reward_max": -3.4, "episode_reward_min": -92.3, "episode_reward_mean": -14.899000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -9.3, -5.2, -7.4, -48.2, -21.4, -13.999999999999998, -21.999999999999996, -7.3, -35.90000000000001, -19.1, -5.3, -3.4, -5.3, -42.5, -9.3, -5.3, -26.00000000000002, -6.300000000000001, -4.300000000000001, -11.299999999999999, -7.300000000000001, -10.099999999999998, -14.9, -12.899999999999999, -11.899999999999997, -8.5, -19.5, -7.300000000000001, -14.2, -41.39999999999992, -9.9, -13.799999999999999, -17.2, -14.7, -9.299999999999999, -7.300000000000001, -10.2, -73.2, -11.899999999999999, -6.3, -7.300000000000001, -21.999999999999996, -7.300000000000001, -17.299999999999997, -92.3, -9.7, -18.000000000000004, -15.799999999999992, -8.3, -6.4, -19.500000000000004, -7.300000000000001, -9.299999999999997, -13.299999999999997, -9.199999999999998, -8.4, -5.2, -10.3, -8.1, -6.4, -9.899999999999999, -11.3, -9.299999999999999, -8.4, -5.3, -6.6, -5.000000000000001, -24.90000000000001, -5.4, -6.300000000000001, -8.3, -87.30000000000014, -10.7, -7.3, -9.2, -20.300000000000008, -10.3, -6.300000000000001, -19.4, -11.8, -7.5, -15.7, -15.899999999999999, -6.3, -13.799999999999999, -27.80000000000006, -7.300000000000001, -5.2, -17.900000000000006, -11.799999999999994, -5.2, -18.200000000000003, -20.499999999999975, -16.9, -12.0, -21.800000000000004, -13.9, -17.200000000000003, -10.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.084467475128347, "mean_inference_ms": 1.4392433139098157, "mean_action_processing_ms": 0.07777843306865447, "mean_env_wait_ms": 6.5381980160631725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3176000, "timesteps_this_iter": 0, "agent_timesteps_total": 3176000, "timers": {"sample_time_ms": 16616.685, "sample_throughput": 240.722, "load_time_ms": 0.35, "load_throughput": 11421618.898, "learn_time_ms": 8141.218, "learn_throughput": 491.327, "update_time_ms": 1.825}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.26039231138964813, "policy_loss": -0.026133073722162555, "vf_loss": 28.46024129416353, "vf_explained_var": 0.13948069035366017, "kl": 0.01139542546257177, "entropy": 0.3265858950153474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3176000, "num_agent_steps_sampled": 3176000, "num_steps_trained": 3176000, "num_agent_steps_trained": 3176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31920, "training_iteration": 794, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-19-13", "timestamp": 1643710753, "time_this_iter_s": 15.977871179580688, "time_total_s": 19774.809248685837, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7515.300371646881, "timesteps_since_restore": 0, "iterations_since_restore": 398, "perf": {"cpu_util_percent": 30.430434782608696, "ram_util_percent": 63.15217391304348}}
{"episode_reward_max": -3.5, "episode_reward_min": -92.3, "episode_reward_mean": -14.079000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.3, -7.300000000000001, -21.999999999999996, -7.300000000000001, -17.299999999999997, -92.3, -9.7, -18.000000000000004, -15.799999999999992, -8.3, -6.4, -19.500000000000004, -7.300000000000001, -9.299999999999997, -13.299999999999997, -9.199999999999998, -8.4, -5.2, -10.3, -8.1, -6.4, -9.899999999999999, -11.3, -9.299999999999999, -8.4, -5.3, -6.6, -5.000000000000001, -24.90000000000001, -5.4, -6.300000000000001, -8.3, -87.30000000000014, -10.7, -7.3, -9.2, -20.300000000000008, -10.3, -6.300000000000001, -19.4, -11.8, -7.5, -15.7, -15.899999999999999, -6.3, -13.799999999999999, -27.80000000000006, -7.300000000000001, -5.2, -17.900000000000006, -11.799999999999994, -5.2, -18.200000000000003, -20.499999999999975, -16.9, -12.0, -21.800000000000004, -13.9, -17.200000000000003, -10.4, -14.4, -18.6, -10.0, -8.799999999999999, -23.70000000000003, -18.300000000000004, -9.5, -6.2, -3.5, -9.3, -6.2, -22.300000000000004, -29.600000000000005, -10.3, -7.4, -7.300000000000001, -8.4, -24.4, -12.899999999999993, -22.4, -35.5, -24.3, -13.599999999999987, -10.8, -15.999999999999998, -9.499999999999998, -21.9, -8.4, -19.300000000000004, -8.2, -15.699999999999998, -6.300000000000001, -5.2, -17.4, -22.0, -9.700000000000001, -5.7, -6.2, -14.199999999999973, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0841204299995402, "mean_inference_ms": 1.4387118413696953, "mean_action_processing_ms": 0.07775003063789923, "mean_env_wait_ms": 6.535605113621946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3180000, "timesteps_this_iter": 0, "agent_timesteps_total": 3180000, "timers": {"sample_time_ms": 16498.035, "sample_throughput": 242.453, "load_time_ms": 0.365, "load_throughput": 10949755.907, "learn_time_ms": 8194.813, "learn_throughput": 488.114, "update_time_ms": 1.782}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13721195488907797, "policy_loss": -0.0151029957328192, "vf_loss": 15.044139980500745, "vf_explained_var": 0.23579514148414776, "kl": 0.011102537881041505, "entropy": 0.3273037207543209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3180000, "num_agent_steps_sampled": 3180000, "num_steps_trained": 3180000, "num_agent_steps_trained": 3180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 31960, "training_iteration": 795, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-19-30", "timestamp": 1643710770, "time_this_iter_s": 16.802342176437378, "time_total_s": 19791.611590862274, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7532.1027138233185, "timesteps_since_restore": 0, "iterations_since_restore": 399, "perf": {"cpu_util_percent": 33.33043478260869, "ram_util_percent": 63.300000000000004}}
{"episode_reward_max": -3.4, "episode_reward_min": -45.3, "episode_reward_mean": -14.52, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.8, -7.5, -15.7, -15.899999999999999, -6.3, -13.799999999999999, -27.80000000000006, -7.300000000000001, -5.2, -17.900000000000006, -11.799999999999994, -5.2, -18.200000000000003, -20.499999999999975, -16.9, -12.0, -21.800000000000004, -13.9, -17.200000000000003, -10.4, -14.4, -18.6, -10.0, -8.799999999999999, -23.70000000000003, -18.300000000000004, -9.5, -6.2, -3.5, -9.3, -6.2, -22.300000000000004, -29.600000000000005, -10.3, -7.4, -7.300000000000001, -8.4, -24.4, -12.899999999999993, -22.4, -35.5, -24.3, -13.599999999999987, -10.8, -15.999999999999998, -9.499999999999998, -21.9, -8.4, -19.300000000000004, -8.2, -15.699999999999998, -6.300000000000001, -5.2, -17.4, -22.0, -9.700000000000001, -5.7, -6.2, -14.199999999999973, -8.2, -9.2, -22.300000000000015, -25.3, -19.6, -28.2, -45.3, -9.2, -5.2, -16.2, -11.3, -6.2, -10.3, -9.499999999999998, -32.6, -12.099999999999998, -17.6, -6.3, -13.099999999999996, -3.4, -6.3, -11.2, -18.0, -22.400000000000013, -12.099999999999998, -18.8, -17.2, -23.899999999999995, -12.099999999999998, -15.199999999999978, -6.4, -6.300000000000001, -15.5, -11.7, -12.399999999999997, -17.700000000000003, -22.3, -11.7, -24.4, -10.799999999999999, -24.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0839557914571298, "mean_inference_ms": 1.4383117546055337, "mean_action_processing_ms": 0.0777286329291677, "mean_env_wait_ms": 6.533518074712621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3184000, "timesteps_this_iter": 0, "agent_timesteps_total": 3184000, "timers": {"sample_time_ms": 16596.581, "sample_throughput": 241.013, "load_time_ms": 0.366, "load_throughput": 10936194.511, "learn_time_ms": 8336.571, "learn_throughput": 479.814, "update_time_ms": 1.771}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17003050586459056, "policy_loss": -0.022509511744463317, "vf_loss": 19.02834163820872, "vf_explained_var": 0.1913299676551614, "kl": 0.01337247433548889, "entropy": 0.3255021335777416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3184000, "num_agent_steps_sampled": 3184000, "num_steps_trained": 3184000, "num_agent_steps_trained": 3184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32000, "training_iteration": 796, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-19-49", "timestamp": 1643710789, "time_this_iter_s": 18.587156057357788, "time_total_s": 19810.198746919632, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7550.689869880676, "timesteps_since_restore": 0, "iterations_since_restore": 400, "perf": {"cpu_util_percent": 38.918518518518525, "ram_util_percent": 63.3962962962963}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.3, "episode_reward_mean": -13.761, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.5, -24.3, -13.599999999999987, -10.8, -15.999999999999998, -9.499999999999998, -21.9, -8.4, -19.300000000000004, -8.2, -15.699999999999998, -6.300000000000001, -5.2, -17.4, -22.0, -9.700000000000001, -5.7, -6.2, -14.199999999999973, -8.2, -9.2, -22.300000000000015, -25.3, -19.6, -28.2, -45.3, -9.2, -5.2, -16.2, -11.3, -6.2, -10.3, -9.499999999999998, -32.6, -12.099999999999998, -17.6, -6.3, -13.099999999999996, -3.4, -6.3, -11.2, -18.0, -22.400000000000013, -12.099999999999998, -18.8, -17.2, -23.899999999999995, -12.099999999999998, -15.199999999999978, -6.4, -6.300000000000001, -15.5, -11.7, -12.399999999999997, -17.700000000000003, -22.3, -11.7, -24.4, -10.799999999999999, -24.0, -11.3, -13.2, -16.4, -18.2, -7.2, -18.4, -15.3, -11.7, -11.600000000000001, -6.300000000000001, -26.6, -8.3, -18.900000000000002, -17.9, -23.5, -16.2, -10.4, -10.1, -5.2, -6.3, -8.2, -5.2, -4.2, -18.799999999999997, -10.399999999999999, -5.300000000000001, -6.2, -5.2, -20.300000000000004, -16.099999999999994, -10.3, -5.300000000000001, -8.4, -4.300000000000001, -5.300000000000001, -13.899999999999999, -3.2, -7.300000000000001, -17.200000000000003, -26.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0838743353789964, "mean_inference_ms": 1.4381501167893975, "mean_action_processing_ms": 0.07772035128495165, "mean_env_wait_ms": 6.532571757331276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3188000, "timesteps_this_iter": 0, "agent_timesteps_total": 3188000, "timers": {"sample_time_ms": 16802.441, "sample_throughput": 238.061, "load_time_ms": 0.366, "load_throughput": 10936194.511, "learn_time_ms": 8368.615, "learn_throughput": 477.976, "update_time_ms": 1.771}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08343470315699296, "policy_loss": -0.01468848311116979, "vf_loss": 9.595243075858521, "vf_explained_var": 0.3311425164822609, "kl": 0.012863734887250566, "entropy": 0.34682126556352905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3188000, "num_agent_steps_sampled": 3188000, "num_steps_trained": 3188000, "num_agent_steps_trained": 3188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32040, "training_iteration": 797, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-20-07", "timestamp": 1643710807, "time_this_iter_s": 18.40337109565735, "time_total_s": 19828.60211801529, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7569.093240976334, "timesteps_since_restore": 0, "iterations_since_restore": 401, "perf": {"cpu_util_percent": 38.77307692307692, "ram_util_percent": 63.48846153846153}}
{"episode_reward_max": -3.2, "episode_reward_min": -32.3, "episode_reward_mean": -12.767000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -18.0, -22.400000000000013, -12.099999999999998, -18.8, -17.2, -23.899999999999995, -12.099999999999998, -15.199999999999978, -6.4, -6.300000000000001, -15.5, -11.7, -12.399999999999997, -17.700000000000003, -22.3, -11.7, -24.4, -10.799999999999999, -24.0, -11.3, -13.2, -16.4, -18.2, -7.2, -18.4, -15.3, -11.7, -11.600000000000001, -6.300000000000001, -26.6, -8.3, -18.900000000000002, -17.9, -23.5, -16.2, -10.4, -10.1, -5.2, -6.3, -8.2, -5.2, -4.2, -18.799999999999997, -10.399999999999999, -5.300000000000001, -6.2, -5.2, -20.300000000000004, -16.099999999999994, -10.3, -5.300000000000001, -8.4, -4.300000000000001, -5.300000000000001, -13.899999999999999, -3.2, -7.300000000000001, -17.200000000000003, -26.6, -20.799999999999997, -10.500000000000002, -9.2, -16.4, -14.299999999999999, -21.9, -9.3, -26.200000000000003, -22.0, -17.5, -32.3, -4.3, -12.799999999999997, -6.300000000000001, -5.300000000000001, -11.899999999999999, -9.2, -21.7, -3.7, -5.2, -12.3, -8.7, -6.300000000000001, -12.8, -15.2, -12.799999999999999, -15.0, -5.2, -14.3, -10.2, -14.899999999999999, -9.9, -19.9, -3.2, -6.3, -7.6000000000000005, -8.3, -10.7, -4.3, -9.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0837934754808358, "mean_inference_ms": 1.438057660219917, "mean_action_processing_ms": 0.07771553040640937, "mean_env_wait_ms": 6.531988427440751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3192000, "timesteps_this_iter": 0, "agent_timesteps_total": 3192000, "timers": {"sample_time_ms": 16947.169, "sample_throughput": 236.028, "load_time_ms": 0.369, "load_throughput": 10838695.006, "learn_time_ms": 8490.366, "learn_throughput": 471.122, "update_time_ms": 1.799}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09856231528364362, "policy_loss": -0.023961473926300964, "vf_loss": 12.034869994207096, "vf_explained_var": 0.20962768857197095, "kl": 0.01288943726304571, "entropy": 0.33771770775959054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3192000, "num_agent_steps_sampled": 3192000, "num_steps_trained": 3192000, "num_agent_steps_trained": 3192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32080, "training_iteration": 798, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-20-25", "timestamp": 1643710825, "time_this_iter_s": 18.351939916610718, "time_total_s": 19846.9540579319, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7587.445180892944, "timesteps_since_restore": 0, "iterations_since_restore": 402, "perf": {"cpu_util_percent": 38.973076923076924, "ram_util_percent": 63.47692307692308}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.49999999999993, "episode_reward_mean": -12.811000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -5.2, -4.2, -18.799999999999997, -10.399999999999999, -5.300000000000001, -6.2, -5.2, -20.300000000000004, -16.099999999999994, -10.3, -5.300000000000001, -8.4, -4.300000000000001, -5.300000000000001, -13.899999999999999, -3.2, -7.300000000000001, -17.200000000000003, -26.6, -20.799999999999997, -10.500000000000002, -9.2, -16.4, -14.299999999999999, -21.9, -9.3, -26.200000000000003, -22.0, -17.5, -32.3, -4.3, -12.799999999999997, -6.300000000000001, -5.300000000000001, -11.899999999999999, -9.2, -21.7, -3.7, -5.2, -12.3, -8.7, -6.300000000000001, -12.8, -15.2, -12.799999999999999, -15.0, -5.2, -14.3, -10.2, -14.899999999999999, -9.9, -19.9, -3.2, -6.3, -7.6000000000000005, -8.3, -10.7, -4.3, -9.2, -8.8, -14.9, -9.4, -13.1, -11.8, -8.3, -16.1, -15.799999999999997, -27.4, -5.800000000000001, -5.3, -13.499999999999995, -7.4, -6.2, -14.799999999999995, -6.8, -8.7, -14.799999999999999, -8.3, -7.300000000000001, -21.6, -19.1, -15.7, -13.9, -18.9, -7.4, -21.1, -90.49999999999993, -10.8, -23.900000000000006, -22.500000000000004, -7.4, -9.3, -6.3, -9.7, -10.4, -13.999999999999998, -20.200000000000003, -19.900000000000002, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0837634375671008, "mean_inference_ms": 1.438039985347431, "mean_action_processing_ms": 0.0777165177407401, "mean_env_wait_ms": 6.531759544903607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3196000, "timesteps_this_iter": 0, "agent_timesteps_total": 3196000, "timers": {"sample_time_ms": 17216.897, "sample_throughput": 232.33, "load_time_ms": 0.376, "load_throughput": 10627908.273, "learn_time_ms": 8627.839, "learn_throughput": 463.615, "update_time_ms": 1.851}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.38298234730778685, "policy_loss": -0.02662243721305683, "vf_loss": 40.78020157346162, "vf_explained_var": 0.330863876881138, "kl": 0.01068312459299927, "entropy": 0.32641474838538836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3196000, "num_agent_steps_sampled": 3196000, "num_steps_trained": 3196000, "num_agent_steps_trained": 3196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32120, "training_iteration": 799, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-20-45", "timestamp": 1643710845, "time_this_iter_s": 19.121182203292847, "time_total_s": 19866.075240135193, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7606.566363096237, "timesteps_since_restore": 0, "iterations_since_restore": 403, "perf": {"cpu_util_percent": 42.8107142857143, "ram_util_percent": 63.442857142857164}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.49999999999993, "episode_reward_mean": -13.950000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -8.7, -6.300000000000001, -12.8, -15.2, -12.799999999999999, -15.0, -5.2, -14.3, -10.2, -14.899999999999999, -9.9, -19.9, -3.2, -6.3, -7.6000000000000005, -8.3, -10.7, -4.3, -9.2, -8.8, -14.9, -9.4, -13.1, -11.8, -8.3, -16.1, -15.799999999999997, -27.4, -5.800000000000001, -5.3, -13.499999999999995, -7.4, -6.2, -14.799999999999995, -6.8, -8.7, -14.799999999999999, -8.3, -7.300000000000001, -21.6, -19.1, -15.7, -13.9, -18.9, -7.4, -21.1, -90.49999999999993, -10.8, -23.900000000000006, -22.500000000000004, -7.4, -9.3, -6.3, -9.7, -10.4, -13.999999999999998, -20.200000000000003, -19.900000000000002, -4.4, -4.4, -23.2, -5.2, -5.2, -17.0, -20.799999999999997, -40.700000000000045, -9.3, -13.3, -19.200000000000003, -7.3, -7.300000000000001, -34.30000000000001, -10.2, -5.2, -20.6, -21.000000000000004, -15.899999999999997, -4.7, -17.6, -7.999999999999999, -5.4, -11.3, -7.2, -16.5, -17.799999999999997, -6.999999999999998, -4.3, -43.3, -5.300000000000001, -8.4, -20.6, -6.1, -8.4, -6.3, -9.3, -4.3, -4.4, -19.0, -81.10000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0837271866567115, "mean_inference_ms": 1.4380252670058908, "mean_action_processing_ms": 0.0777165624119469, "mean_env_wait_ms": 6.531421150148909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3200000, "timesteps_this_iter": 0, "agent_timesteps_total": 3200000, "timers": {"sample_time_ms": 17483.343, "sample_throughput": 228.789, "load_time_ms": 0.38, "load_throughput": 10527210.893, "learn_time_ms": 8845.49, "learn_throughput": 452.208, "update_time_ms": 1.862}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.38816805188994735, "policy_loss": -0.03052378454475954, "vf_loss": 41.677843792464145, "vf_explained_var": 0.0962059872765695, "kl": 0.011338663632775, "entropy": 0.32047757676211736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3200000, "num_agent_steps_sampled": 3200000, "num_steps_trained": 3200000, "num_agent_steps_trained": 3200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32160, "training_iteration": 800, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-21-04", "timestamp": 1643710864, "time_this_iter_s": 19.41032099723816, "time_total_s": 19885.48556113243, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7625.976684093475, "timesteps_since_restore": 0, "iterations_since_restore": 404, "perf": {"cpu_util_percent": 37.08518518518518, "ram_util_percent": 63.496296296296286}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.49999999999993, "episode_reward_mean": -15.025000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.6, -19.1, -15.7, -13.9, -18.9, -7.4, -21.1, -90.49999999999993, -10.8, -23.900000000000006, -22.500000000000004, -7.4, -9.3, -6.3, -9.7, -10.4, -13.999999999999998, -20.200000000000003, -19.900000000000002, -4.4, -4.4, -23.2, -5.2, -5.2, -17.0, -20.799999999999997, -40.700000000000045, -9.3, -13.3, -19.200000000000003, -7.3, -7.300000000000001, -34.30000000000001, -10.2, -5.2, -20.6, -21.000000000000004, -15.899999999999997, -4.7, -17.6, -7.999999999999999, -5.4, -11.3, -7.2, -16.5, -17.799999999999997, -6.999999999999998, -4.3, -43.3, -5.300000000000001, -8.4, -20.6, -6.1, -8.4, -6.3, -9.3, -4.3, -4.4, -19.0, -81.10000000000005, -6.2, -12.3, -4.000000000000001, -12.9, -6.4, -4.3, -31.800000000000004, -24.9, -8.3, -5.3, -19.900000000000002, -19.2, -16.8, -6.4, -21.200000000000006, -16.800000000000004, -10.4, -15.4, -3.3, -13.2, -10.599999999999998, -6.4, -4.2, -18.7, -6.4, -10.500000000000002, -12.799999999999997, -3.2, -5.799999999999999, -24.5, -6.499999999999998, -20.400000000000002, -24.099999999999994, -10.3, -17.099999999999973, -3.3, -26.900000000000006, -15.600000000000001, -44.10000000000002, -8.699999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0835135033812582, "mean_inference_ms": 1.4378539124574201, "mean_action_processing_ms": 0.07770677847621518, "mean_env_wait_ms": 6.530340399763776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3204000, "timesteps_this_iter": 0, "agent_timesteps_total": 3204000, "timers": {"sample_time_ms": 17720.185, "sample_throughput": 225.731, "load_time_ms": 0.38, "load_throughput": 10532497.96, "learn_time_ms": 8926.702, "learn_throughput": 448.094, "update_time_ms": 1.868}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.17927239799461459, "policy_loss": -0.02488377610526939, "vf_loss": 20.1801847662977, "vf_explained_var": 0.027424994399470666, "kl": 0.01395157601344683, "entropy": 0.35486581336746936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3204000, "num_agent_steps_sampled": 3204000, "num_steps_trained": 3204000, "num_agent_steps_trained": 3204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32200, "training_iteration": 801, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-21-21", "timestamp": 1643710881, "time_this_iter_s": 17.204716205596924, "time_total_s": 19902.690277338028, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7643.181400299072, "timesteps_since_restore": 0, "iterations_since_restore": 405, "perf": {"cpu_util_percent": 32.135999999999996, "ram_util_percent": 63.644000000000005}}
{"episode_reward_max": -3.2, "episode_reward_min": -81.10000000000005, "episode_reward_mean": -13.117, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.999999999999999, -5.4, -11.3, -7.2, -16.5, -17.799999999999997, -6.999999999999998, -4.3, -43.3, -5.300000000000001, -8.4, -20.6, -6.1, -8.4, -6.3, -9.3, -4.3, -4.4, -19.0, -81.10000000000005, -6.2, -12.3, -4.000000000000001, -12.9, -6.4, -4.3, -31.800000000000004, -24.9, -8.3, -5.3, -19.900000000000002, -19.2, -16.8, -6.4, -21.200000000000006, -16.800000000000004, -10.4, -15.4, -3.3, -13.2, -10.599999999999998, -6.4, -4.2, -18.7, -6.4, -10.500000000000002, -12.799999999999997, -3.2, -5.799999999999999, -24.5, -6.499999999999998, -20.400000000000002, -24.099999999999994, -10.3, -17.099999999999973, -3.3, -26.900000000000006, -15.600000000000001, -44.10000000000002, -8.699999999999998, -12.2, -10.500000000000002, -16.9, -21.80000000000003, -6.4, -5.300000000000001, -13.499999999999993, -10.700000000000001, -6.4, -10.899999999999999, -10.4, -17.1, -7.2, -20.300000000000008, -13.3, -7.3, -20.0, -3.3, -9.6, -5.300000000000001, -15.599999999999998, -12.699999999999998, -7.300000000000001, -19.5, -18.1, -11.2, -14.599999999999998, -16.0, -5.800000000000001, -10.799999999999999, -8.2, -8.3, -6.300000000000001, -17.1, -10.2, -10.799999999999999, -10.899999999999999, -14.2, -11.3, -21.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0832482228355256, "mean_inference_ms": 1.4376536026854732, "mean_action_processing_ms": 0.07769580886822988, "mean_env_wait_ms": 6.529125132764189, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3208000, "timesteps_this_iter": 0, "agent_timesteps_total": 3208000, "timers": {"sample_time_ms": 17809.714, "sample_throughput": 224.597, "load_time_ms": 0.379, "load_throughput": 10550381.084, "learn_time_ms": 9114.15, "learn_throughput": 438.878, "update_time_ms": 1.835}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06383977301008198, "policy_loss": -0.027780144064817377, "vf_loss": 8.880114825951155, "vf_explained_var": 0.32791731088392195, "kl": 0.01670381727996614, "entropy": 0.3173195855191318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3208000, "num_agent_steps_sampled": 3208000, "num_steps_trained": 3208000, "num_agent_steps_trained": 3208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32240, "training_iteration": 802, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-21-41", "timestamp": 1643710901, "time_this_iter_s": 19.450688123703003, "time_total_s": 19922.14096546173, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7662.632088422775, "timesteps_since_restore": 0, "iterations_since_restore": 406, "perf": {"cpu_util_percent": 35.696296296296296, "ram_util_percent": 63.76666666666666}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.10000000000002, "episode_reward_mean": -12.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.599999999999998, -6.4, -4.2, -18.7, -6.4, -10.500000000000002, -12.799999999999997, -3.2, -5.799999999999999, -24.5, -6.499999999999998, -20.400000000000002, -24.099999999999994, -10.3, -17.099999999999973, -3.3, -26.900000000000006, -15.600000000000001, -44.10000000000002, -8.699999999999998, -12.2, -10.500000000000002, -16.9, -21.80000000000003, -6.4, -5.300000000000001, -13.499999999999993, -10.700000000000001, -6.4, -10.899999999999999, -10.4, -17.1, -7.2, -20.300000000000008, -13.3, -7.3, -20.0, -3.3, -9.6, -5.300000000000001, -15.599999999999998, -12.699999999999998, -7.300000000000001, -19.5, -18.1, -11.2, -14.599999999999998, -16.0, -5.800000000000001, -10.799999999999999, -8.2, -8.3, -6.300000000000001, -17.1, -10.2, -10.799999999999999, -10.899999999999999, -14.2, -11.3, -21.3, -6.1, -15.099999999999998, -11.5, -10.2, -4.4, -9.3, -8.3, -21.3, -8.4, -28.9, -11.2, -13.799999999999999, -8.3, -6.3, -21.2, -7.2, -21.999999999999996, -8.4, -6.300000000000001, -21.700000000000003, -5.3, -7.2, -10.3, -16.3, -10.799999999999997, -5.3, -7.300000000000001, -11.299999999999999, -20.80000000000002, -12.699999999999998, -11.4, -5.800000000000001, -7.300000000000001, -17.799999999999997, -8.4, -26.3, -9.3, -15.799999999999992, -18.5, -18.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0831758218634402, "mean_inference_ms": 1.4376422953221522, "mean_action_processing_ms": 0.07769490807178486, "mean_env_wait_ms": 6.528728930475191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3212000, "timesteps_this_iter": 0, "agent_timesteps_total": 3212000, "timers": {"sample_time_ms": 18147.708, "sample_throughput": 220.414, "load_time_ms": 0.377, "load_throughput": 10607078.46, "learn_time_ms": 9257.988, "learn_throughput": 432.059, "update_time_ms": 1.862}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08009750308288682, "policy_loss": -0.022696305161482223, "vf_loss": 10.10130933074541, "vf_explained_var": 0.4097819002725745, "kl": 0.01055240443030323, "entropy": 0.3610876781485414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3212000, "num_agent_steps_sampled": 3212000, "num_steps_trained": 3212000, "num_agent_steps_trained": 3212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32280, "training_iteration": 803, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-22-00", "timestamp": 1643710920, "time_this_iter_s": 19.272719144821167, "time_total_s": 19941.413684606552, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7681.904807567596, "timesteps_since_restore": 0, "iterations_since_restore": 407, "perf": {"cpu_util_percent": 31.842857142857145, "ram_util_percent": 63.749999999999986}}
{"episode_reward_max": -3.7, "episode_reward_min": -95.3, "episode_reward_mean": -12.797, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.599999999999998, -12.699999999999998, -7.300000000000001, -19.5, -18.1, -11.2, -14.599999999999998, -16.0, -5.800000000000001, -10.799999999999999, -8.2, -8.3, -6.300000000000001, -17.1, -10.2, -10.799999999999999, -10.899999999999999, -14.2, -11.3, -21.3, -6.1, -15.099999999999998, -11.5, -10.2, -4.4, -9.3, -8.3, -21.3, -8.4, -28.9, -11.2, -13.799999999999999, -8.3, -6.3, -21.2, -7.2, -21.999999999999996, -8.4, -6.300000000000001, -21.700000000000003, -5.3, -7.2, -10.3, -16.3, -10.799999999999997, -5.3, -7.300000000000001, -11.299999999999999, -20.80000000000002, -12.699999999999998, -11.4, -5.800000000000001, -7.300000000000001, -17.799999999999997, -8.4, -26.3, -9.3, -15.799999999999992, -18.5, -18.5, -4.3, -17.299999999999997, -4.2, -5.4, -5.4, -15.099999999999996, -13.6, -4.300000000000001, -5.300000000000001, -9.3, -7.2, -12.2, -5.3, -95.3, -6.2, -5.3, -4.2, -17.9, -13.399999999999997, -15.799999999999999, -11.299999999999997, -25.299999999999997, -7.199999999999998, -21.799999999999997, -11.999999999999998, -6.300000000000001, -15.999999999999998, -20.6, -5.4, -11.2, -11.099999999999998, -12.899999999999999, -7.300000000000001, -15.5, -13.399999999999999, -25.200000000000003, -11.3, -11.2, -17.5, -3.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.083525382994472, "mean_inference_ms": 1.4380314986000906, "mean_action_processing_ms": 0.07771619335498352, "mean_env_wait_ms": 6.530246831064658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3216000, "timesteps_this_iter": 0, "agent_timesteps_total": 3216000, "timers": {"sample_time_ms": 18630.316, "sample_throughput": 214.704, "load_time_ms": 0.394, "load_throughput": 10154470.403, "learn_time_ms": 9450.387, "learn_throughput": 423.263, "update_time_ms": 1.836}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2941006945876745, "policy_loss": -0.02712593549281679, "vf_loss": 31.826926955324346, "vf_explained_var": 0.24647359623703904, "kl": 0.01752514403324152, "entropy": 0.33266002665604316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3216000, "num_agent_steps_sampled": 3216000, "num_steps_trained": 3216000, "num_agent_steps_trained": 3216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32320, "training_iteration": 804, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-22-21", "timestamp": 1643710941, "time_this_iter_s": 21.288004875183105, "time_total_s": 19962.701689481735, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7703.1928124427795, "timesteps_since_restore": 0, "iterations_since_restore": 408, "perf": {"cpu_util_percent": 48.713333333333324, "ram_util_percent": 63.70666666666667}}
{"episode_reward_max": -3.7, "episode_reward_min": -95.3, "episode_reward_mean": -12.179000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -7.2, -10.3, -16.3, -10.799999999999997, -5.3, -7.300000000000001, -11.299999999999999, -20.80000000000002, -12.699999999999998, -11.4, -5.800000000000001, -7.300000000000001, -17.799999999999997, -8.4, -26.3, -9.3, -15.799999999999992, -18.5, -18.5, -4.3, -17.299999999999997, -4.2, -5.4, -5.4, -15.099999999999996, -13.6, -4.300000000000001, -5.300000000000001, -9.3, -7.2, -12.2, -5.3, -95.3, -6.2, -5.3, -4.2, -17.9, -13.399999999999997, -15.799999999999999, -11.299999999999997, -25.299999999999997, -7.199999999999998, -21.799999999999997, -11.999999999999998, -6.300000000000001, -15.999999999999998, -20.6, -5.4, -11.2, -11.099999999999998, -12.899999999999999, -7.300000000000001, -15.5, -13.399999999999999, -25.200000000000003, -11.3, -11.2, -17.5, -3.7, -18.2, -18.500000000000004, -10.5, -15.8, -20.300000000000004, -8.999999999999991, -8.2, -4.800000000000001, -6.899999999999999, -9.499999999999991, -12.899999999999979, -12.6, -5.2, -5.4, -26.200000000000017, -7.4, -16.799999999999997, -6.4, -5.300000000000001, -18.5, -4.3, -7.4, -9.7, -19.900000000000002, -18.3, -4.2, -5.300000000000001, -5.4, -9.7, -10.899999999999997, -5.2, -16.099999999999994, -12.2, -5.3, -6.300000000000001, -5.6000000000000005, -5.4, -19.9, -22.4, -6.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.083975578391615, "mean_inference_ms": 1.43851320478086, "mean_action_processing_ms": 0.07774257649763722, "mean_env_wait_ms": 6.532251738190481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3220000, "timesteps_this_iter": 0, "agent_timesteps_total": 3220000, "timers": {"sample_time_ms": 19067.576, "sample_throughput": 209.78, "load_time_ms": 0.363, "load_throughput": 11034012.496, "learn_time_ms": 9401.497, "learn_throughput": 425.464, "update_time_ms": 1.869}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.05266851330080861, "policy_loss": -0.029142867423774255, "vf_loss": 7.89294802597774, "vf_explained_var": 0.22423955496921333, "kl": 0.01707794182481161, "entropy": 0.3290235969488339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3220000, "num_agent_steps_sampled": 3220000, "num_steps_trained": 3220000, "num_agent_steps_trained": 3220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32360, "training_iteration": 805, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-22-40", "timestamp": 1643710960, "time_this_iter_s": 18.755604028701782, "time_total_s": 19981.457293510437, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7721.948416471481, "timesteps_since_restore": 0, "iterations_since_restore": 409, "perf": {"cpu_util_percent": 41.31481481481482, "ram_util_percent": 63.70000000000001}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -78.3, "episode_reward_mean": -13.595999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.299999999999997, -25.299999999999997, -7.199999999999998, -21.799999999999997, -11.999999999999998, -6.300000000000001, -15.999999999999998, -20.6, -5.4, -11.2, -11.099999999999998, -12.899999999999999, -7.300000000000001, -15.5, -13.399999999999999, -25.200000000000003, -11.3, -11.2, -17.5, -3.7, -18.2, -18.500000000000004, -10.5, -15.8, -20.300000000000004, -8.999999999999991, -8.2, -4.800000000000001, -6.899999999999999, -9.499999999999991, -12.899999999999979, -12.6, -5.2, -5.4, -26.200000000000017, -7.4, -16.799999999999997, -6.4, -5.300000000000001, -18.5, -4.3, -7.4, -9.7, -19.900000000000002, -18.3, -4.2, -5.300000000000001, -5.4, -9.7, -10.899999999999997, -5.2, -16.099999999999994, -12.2, -5.3, -6.300000000000001, -5.6000000000000005, -5.4, -19.9, -22.4, -6.4, -37.50000000000008, -18.2, -50.2, -15.5, -16.099999999999994, -20.4, -21.2, -24.700000000000003, -14.6, -5.2, -5.300000000000001, -8.2, -5.300000000000001, -17.099999999999998, -13.799999999999999, -14.7, -3.2, -5.4, -13.199999999999973, -2.4000000000000004, -5.3, -13.399999999999999, -24.000000000000007, -18.9, -78.3, -5.800000000000001, -13.7, -36.3, -8.6, -10.999999999999998, -17.0, -9.100000000000001, -10.899999999999999, -17.700000000000003, -21.0, -7.3, -12.199999999999994, -9.299999999999999, -12.499999999999998, -10.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0843739239056107, "mean_inference_ms": 1.438833996789915, "mean_action_processing_ms": 0.07776132346606696, "mean_env_wait_ms": 6.533550060703321, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3224000, "timesteps_this_iter": 0, "agent_timesteps_total": 3224000, "timers": {"sample_time_ms": 19078.076, "sample_throughput": 209.665, "load_time_ms": 0.361, "load_throughput": 11069685.933, "learn_time_ms": 9267.055, "learn_throughput": 431.637, "update_time_ms": 1.855}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.43201834482406215, "policy_loss": -0.020599028441844688, "vf_loss": 45.06087599524888, "vf_explained_var": 0.04074053802797871, "kl": 0.011902927892910928, "entropy": 0.35150342729463374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3224000, "num_agent_steps_sampled": 3224000, "num_steps_trained": 3224000, "num_agent_steps_trained": 3224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32400, "training_iteration": 806, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-22-58", "timestamp": 1643710978, "time_this_iter_s": 17.838829040527344, "time_total_s": 19999.296122550964, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7739.787245512009, "timesteps_since_restore": 0, "iterations_since_restore": 410, "perf": {"cpu_util_percent": 41.148, "ram_util_percent": 63.711999999999996}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -78.3, "episode_reward_mean": -14.045000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -7.4, -9.7, -19.900000000000002, -18.3, -4.2, -5.300000000000001, -5.4, -9.7, -10.899999999999997, -5.2, -16.099999999999994, -12.2, -5.3, -6.300000000000001, -5.6000000000000005, -5.4, -19.9, -22.4, -6.4, -37.50000000000008, -18.2, -50.2, -15.5, -16.099999999999994, -20.4, -21.2, -24.700000000000003, -14.6, -5.2, -5.300000000000001, -8.2, -5.300000000000001, -17.099999999999998, -13.799999999999999, -14.7, -3.2, -5.4, -13.199999999999973, -2.4000000000000004, -5.3, -13.399999999999999, -24.000000000000007, -18.9, -78.3, -5.800000000000001, -13.7, -36.3, -8.6, -10.999999999999998, -17.0, -9.100000000000001, -10.899999999999999, -17.700000000000003, -21.0, -7.3, -12.199999999999994, -9.299999999999999, -12.499999999999998, -10.6, -10.3, -8.3, -27.200000000000003, -15.0, -4.2, -11.9, -10.6, -4.3, -4.4, -18.3, -28.2, -19.1, -19.299999999999997, -21.700000000000006, -34.6, -5.4, -32.2, -6.699999999999999, -8.799999999999997, -15.5, -6.6000000000000005, -8.3, -6.300000000000001, -15.6, -5.300000000000001, -37.69999999999995, -5.3, -4.4, -7.8999999999999995, -18.1, -4.4, -12.8, -14.099999999999996, -10.7, -18.400000000000002, -5.8999999999999995, -21.2, -13.999999999999998, -21.200000000000003, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.084372534325338, "mean_inference_ms": 1.438725078137595, "mean_action_processing_ms": 0.07775607323057955, "mean_env_wait_ms": 6.5329025421072915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3228000, "timesteps_this_iter": 0, "agent_timesteps_total": 3228000, "timers": {"sample_time_ms": 18774.742, "sample_throughput": 213.052, "load_time_ms": 0.361, "load_throughput": 11082116.388, "learn_time_ms": 9200.525, "learn_throughput": 434.758, "update_time_ms": 1.86}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.18764124317044611, "policy_loss": -0.0266981756051762, "vf_loss": 21.18819590294233, "vf_explained_var": 0.049452737069899035, "kl": 0.014562748375792646, "entropy": 0.351391333245462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3228000, "num_agent_steps_sampled": 3228000, "num_steps_trained": 3228000, "num_agent_steps_trained": 3228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32440, "training_iteration": 807, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-23-14", "timestamp": 1643710994, "time_this_iter_s": 16.05318784713745, "time_total_s": 20015.3493103981, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7755.840433359146, "timesteps_since_restore": 0, "iterations_since_restore": 411, "perf": {"cpu_util_percent": 33.75652173913043, "ram_util_percent": 63.66956521739128}}
{"episode_reward_max": -3.5, "episode_reward_min": -78.3, "episode_reward_mean": -13.390999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -13.399999999999999, -24.000000000000007, -18.9, -78.3, -5.800000000000001, -13.7, -36.3, -8.6, -10.999999999999998, -17.0, -9.100000000000001, -10.899999999999999, -17.700000000000003, -21.0, -7.3, -12.199999999999994, -9.299999999999999, -12.499999999999998, -10.6, -10.3, -8.3, -27.200000000000003, -15.0, -4.2, -11.9, -10.6, -4.3, -4.4, -18.3, -28.2, -19.1, -19.299999999999997, -21.700000000000006, -34.6, -5.4, -32.2, -6.699999999999999, -8.799999999999997, -15.5, -6.6000000000000005, -8.3, -6.300000000000001, -15.6, -5.300000000000001, -37.69999999999995, -5.3, -4.4, -7.8999999999999995, -18.1, -4.4, -12.8, -14.099999999999996, -10.7, -18.400000000000002, -5.8999999999999995, -21.2, -13.999999999999998, -21.200000000000003, -5.300000000000001, -18.0, -5.3, -9.8, -5.3, -25.3, -6.4, -17.0, -14.899999999999999, -7.4, -4.3, -5.300000000000001, -24.50000000000001, -6.4, -29.50000000000001, -5.300000000000001, -7.199999999999998, -3.5, -8.3, -9.1, -4.3, -10.399999999999999, -4.2, -6.3, -5.3, -17.4, -16.799999999999997, -7.6, -8.3, -11.299999999999999, -5.800000000000001, -12.099999999999998, -12.399999999999999, -4.3, -4.4, -33.3, -23.1, -10.599999999999998, -11.799999999999999, -4.3, -19.900000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0841092324744275, "mean_inference_ms": 1.4384197240291643, "mean_action_processing_ms": 0.07773773187904016, "mean_env_wait_ms": 6.531276710554774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3232000, "timesteps_this_iter": 0, "agent_timesteps_total": 3232000, "timers": {"sample_time_ms": 18653.579, "sample_throughput": 214.436, "load_time_ms": 0.359, "load_throughput": 11146911.169, "learn_time_ms": 9092.328, "learn_throughput": 439.931, "update_time_ms": 1.811}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10647148140005126, "policy_loss": -0.02026778903829875, "vf_loss": 12.436432383906457, "vf_explained_var": 0.19764748305402777, "kl": 0.014073761033140775, "entropy": 0.33396638515655713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3232000, "num_agent_steps_sampled": 3232000, "num_steps_trained": 3232000, "num_agent_steps_trained": 3232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32480, "training_iteration": 808, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-23-31", "timestamp": 1643711011, "time_this_iter_s": 16.71569585800171, "time_total_s": 20032.065006256104, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7772.556129217148, "timesteps_since_restore": 0, "iterations_since_restore": 412, "perf": {"cpu_util_percent": 35.675000000000004, "ram_util_percent": 63.69166666666667}}
{"episode_reward_max": -3.5, "episode_reward_min": -105.3, "episode_reward_mean": -13.370000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.6000000000000005, -8.3, -6.300000000000001, -15.6, -5.300000000000001, -37.69999999999995, -5.3, -4.4, -7.8999999999999995, -18.1, -4.4, -12.8, -14.099999999999996, -10.7, -18.400000000000002, -5.8999999999999995, -21.2, -13.999999999999998, -21.200000000000003, -5.300000000000001, -18.0, -5.3, -9.8, -5.3, -25.3, -6.4, -17.0, -14.899999999999999, -7.4, -4.3, -5.300000000000001, -24.50000000000001, -6.4, -29.50000000000001, -5.300000000000001, -7.199999999999998, -3.5, -8.3, -9.1, -4.3, -10.399999999999999, -4.2, -6.3, -5.3, -17.4, -16.799999999999997, -7.6, -8.3, -11.299999999999999, -5.800000000000001, -12.099999999999998, -12.399999999999999, -4.3, -4.4, -33.3, -23.1, -10.599999999999998, -11.799999999999999, -4.3, -19.900000000000002, -21.3, -6.2, -9.9, -29.1, -8.2, -9.2, -7.2, -16.499999999999996, -6.3, -13.600000000000001, -18.300000000000004, -19.499999999999993, -13.600000000000001, -4.4, -19.300000000000004, -5.2, -10.4, -39.70000000000001, -9.799999999999999, -12.899999999999997, -105.3, -24.3, -4.4, -16.199999999999996, -11.5, -7.3, -45.70000000000008, -8.4, -10.3, -7.799999999999999, -13.299999999999999, -4.2, -8.4, -22.00000000000001, -6.3, -8.299999999999999, -21.20000000000001, -6.3, -19.8, -15.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0837954531268321, "mean_inference_ms": 1.4380893312576566, "mean_action_processing_ms": 0.07771767111313144, "mean_env_wait_ms": 6.529518155511531, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3236000, "timesteps_this_iter": 0, "agent_timesteps_total": 3236000, "timers": {"sample_time_ms": 18434.319, "sample_throughput": 216.987, "load_time_ms": 0.358, "load_throughput": 11165457.208, "learn_time_ms": 8926.831, "learn_throughput": 448.087, "update_time_ms": 1.744}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.533172801683747, "policy_loss": -0.019869041634643432, "vf_loss": 55.10039430401658, "vf_explained_var": 0.10177292138017634, "kl": 0.0120766100879476, "entropy": 0.3299752188626156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3236000, "num_agent_steps_sampled": 3236000, "num_steps_trained": 3236000, "num_agent_steps_trained": 3236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32520, "training_iteration": 809, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-23-47", "timestamp": 1643711027, "time_this_iter_s": 16.361422061920166, "time_total_s": 20048.426428318024, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7788.917551279068, "timesteps_since_restore": 0, "iterations_since_restore": 413, "perf": {"cpu_util_percent": 30.217391304347824, "ram_util_percent": 63.695652173913054}}
{"episode_reward_max": -3.2, "episode_reward_min": -105.3, "episode_reward_mean": -13.997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.399999999999999, -4.2, -6.3, -5.3, -17.4, -16.799999999999997, -7.6, -8.3, -11.299999999999999, -5.800000000000001, -12.099999999999998, -12.399999999999999, -4.3, -4.4, -33.3, -23.1, -10.599999999999998, -11.799999999999999, -4.3, -19.900000000000002, -21.3, -6.2, -9.9, -29.1, -8.2, -9.2, -7.2, -16.499999999999996, -6.3, -13.600000000000001, -18.300000000000004, -19.499999999999993, -13.600000000000001, -4.4, -19.300000000000004, -5.2, -10.4, -39.70000000000001, -9.799999999999999, -12.899999999999997, -105.3, -24.3, -4.4, -16.199999999999996, -11.5, -7.3, -45.70000000000008, -8.4, -10.3, -7.799999999999999, -13.299999999999999, -4.2, -8.4, -22.00000000000001, -6.3, -8.299999999999999, -21.20000000000001, -6.3, -19.8, -15.2, -19.499999999999996, -12.399999999999999, -7.1, -6.2, -18.8, -14.899999999999997, -4.6000000000000005, -12.7, -21.000000000000004, -7.3, -15.2, -6.3, -39.2, -14.3, -9.5, -17.799999999999997, -19.000000000000007, -4.4, -6.3, -7.800000000000001, -22.0, -5.4, -6.799999999999994, -15.2, -15.499999999999998, -11.7, -24.3, -33.2, -15.699999999999998, -10.2, -7.000000000000001, -4.3, -7.699999999999998, -22.200000000000003, -7.300000000000001, -18.6, -13.6, -3.2, -11.499999999999993, -3.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0834810410941684, "mean_inference_ms": 1.4377049902028887, "mean_action_processing_ms": 0.07769635129917059, "mean_env_wait_ms": 6.527653636521504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3240000, "timesteps_this_iter": 0, "agent_timesteps_total": 3240000, "timers": {"sample_time_ms": 18150.013, "sample_throughput": 220.386, "load_time_ms": 0.358, "load_throughput": 11183319.557, "learn_time_ms": 8720.324, "learn_throughput": 458.699, "update_time_ms": 1.745}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16172965287946925, "policy_loss": -0.017014764829148207, "vf_loss": 17.683259815426283, "vf_explained_var": 0.04205164268452634, "kl": 0.011329345402083918, "entropy": 0.32441362672916024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3240000, "num_agent_steps_sampled": 3240000, "num_steps_trained": 3240000, "num_agent_steps_trained": 3240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32560, "training_iteration": 810, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-24-03", "timestamp": 1643711043, "time_this_iter_s": 16.162843942642212, "time_total_s": 20064.589272260666, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7805.08039522171, "timesteps_since_restore": 0, "iterations_since_restore": 414, "perf": {"cpu_util_percent": 29.94782608695653, "ram_util_percent": 63.68695652173915}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -105.3, "episode_reward_mean": -13.240000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.3, -24.3, -4.4, -16.199999999999996, -11.5, -7.3, -45.70000000000008, -8.4, -10.3, -7.799999999999999, -13.299999999999999, -4.2, -8.4, -22.00000000000001, -6.3, -8.299999999999999, -21.20000000000001, -6.3, -19.8, -15.2, -19.499999999999996, -12.399999999999999, -7.1, -6.2, -18.8, -14.899999999999997, -4.6000000000000005, -12.7, -21.000000000000004, -7.3, -15.2, -6.3, -39.2, -14.3, -9.5, -17.799999999999997, -19.000000000000007, -4.4, -6.3, -7.800000000000001, -22.0, -5.4, -6.799999999999994, -15.2, -15.499999999999998, -11.7, -24.3, -33.2, -15.699999999999998, -10.2, -7.000000000000001, -4.3, -7.699999999999998, -22.200000000000003, -7.300000000000001, -18.6, -13.6, -3.2, -11.499999999999993, -3.6000000000000005, -5.3, -7.3, -8.3, -60.900000000000055, -3.3, -20.2, -11.3, -5.4, -4.300000000000001, -13.2, -11.2, -16.9, -8.099999999999998, -4.800000000000001, -17.700000000000003, -10.3, -6.3, -4.3, -9.4, -4.4, -20.4, -7.099999999999999, -6.499999999999999, -14.4, -17.699999999999996, -2.4000000000000004, -7.3, -11.100000000000001, -3.2, -15.1, -9.9, -8.3, -9.7, -7.2, -6.6000000000000005, -14.999999999999998, -14.8, -7.2, -5.4, -12.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.083157273184654, "mean_inference_ms": 1.4373313150967977, "mean_action_processing_ms": 0.07767567991066902, "mean_env_wait_ms": 6.525759379896681, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3244000, "timesteps_this_iter": 0, "agent_timesteps_total": 3244000, "timers": {"sample_time_ms": 17979.615, "sample_throughput": 222.474, "load_time_ms": 0.359, "load_throughput": 11130641.544, "learn_time_ms": 8736.323, "learn_throughput": 457.859, "update_time_ms": 1.806}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1394663690574347, "policy_loss": -0.027471396911849258, "vf_loss": 16.507489308106003, "vf_explained_var": 0.17711317090577977, "kl": 0.011039273465555508, "entropy": 0.33291965011627445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3244000, "num_agent_steps_sampled": 3244000, "num_steps_trained": 3244000, "num_agent_steps_trained": 3244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32600, "training_iteration": 811, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-24-21", "timestamp": 1643711061, "time_this_iter_s": 17.74004888534546, "time_total_s": 20082.32932114601, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7822.820444107056, "timesteps_since_restore": 0, "iterations_since_restore": 415, "perf": {"cpu_util_percent": 29.12307692307692, "ram_util_percent": 63.8423076923077}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -66.3, "episode_reward_mean": -11.970999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, -5.4, -6.799999999999994, -15.2, -15.499999999999998, -11.7, -24.3, -33.2, -15.699999999999998, -10.2, -7.000000000000001, -4.3, -7.699999999999998, -22.200000000000003, -7.300000000000001, -18.6, -13.6, -3.2, -11.499999999999993, -3.6000000000000005, -5.3, -7.3, -8.3, -60.900000000000055, -3.3, -20.2, -11.3, -5.4, -4.300000000000001, -13.2, -11.2, -16.9, -8.099999999999998, -4.800000000000001, -17.700000000000003, -10.3, -6.3, -4.3, -9.4, -4.4, -20.4, -7.099999999999999, -6.499999999999999, -14.4, -17.699999999999996, -2.4000000000000004, -7.3, -11.100000000000001, -3.2, -15.1, -9.9, -8.3, -9.7, -7.2, -6.6000000000000005, -14.999999999999998, -14.8, -7.2, -5.4, -12.3, -16.3, -6.2, -13.999999999999998, -10.3, -6.300000000000001, -14.799999999999999, -7.4, -14.899999999999997, -66.3, -6.4, -21.900000000000002, -18.599999999999998, -11.5, -10.4, -11.7, -9.2, -3.3, -10.199999999999998, -3.6000000000000005, -11.2, -18.500000000000014, -18.200000000000014, -20.90000000000005, -4.3, -7.4, -6.3, -7.599999999999999, -4.7, -8.8, -7.3, -12.899999999999999, -15.999999999999998, -14.199999999999985, -16.4, -12.2, -4.2, -11.799999999999999, -12.0, -8.3, -17.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0836965177816638, "mean_inference_ms": 1.4381188613474245, "mean_action_processing_ms": 0.07771811948095744, "mean_env_wait_ms": 6.529304443097861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3248000, "timesteps_this_iter": 0, "agent_timesteps_total": 3248000, "timers": {"sample_time_ms": 18710.787, "sample_throughput": 213.78, "load_time_ms": 0.39, "load_throughput": 10262549.547, "learn_time_ms": 8792.757, "learn_throughput": 454.92, "update_time_ms": 1.791}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.18102042349055408, "policy_loss": -0.0236158879273521, "vf_loss": 20.29420462282755, "vf_explained_var": 0.1822952833226932, "kl": 0.010040116865155305, "entropy": 0.31419881204924277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3248000, "num_agent_steps_sampled": 3248000, "num_steps_trained": 3248000, "num_agent_steps_trained": 3248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32640, "training_iteration": 812, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-24-48", "timestamp": 1643711088, "time_this_iter_s": 27.13531804084778, "time_total_s": 20109.46463918686, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7849.955762147903, "timesteps_since_restore": 0, "iterations_since_restore": 416, "perf": {"cpu_util_percent": 47.97894736842106, "ram_util_percent": 63.94210526315791}}
{"episode_reward_max": -1.0, "episode_reward_min": -71.3, "episode_reward_mean": -12.398, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.4, -7.099999999999999, -6.499999999999999, -14.4, -17.699999999999996, -2.4000000000000004, -7.3, -11.100000000000001, -3.2, -15.1, -9.9, -8.3, -9.7, -7.2, -6.6000000000000005, -14.999999999999998, -14.8, -7.2, -5.4, -12.3, -16.3, -6.2, -13.999999999999998, -10.3, -6.300000000000001, -14.799999999999999, -7.4, -14.899999999999997, -66.3, -6.4, -21.900000000000002, -18.599999999999998, -11.5, -10.4, -11.7, -9.2, -3.3, -10.199999999999998, -3.6000000000000005, -11.2, -18.500000000000014, -18.200000000000014, -20.90000000000005, -4.3, -7.4, -6.3, -7.599999999999999, -4.7, -8.8, -7.3, -12.899999999999999, -15.999999999999998, -14.199999999999985, -16.4, -12.2, -4.2, -11.799999999999999, -12.0, -8.3, -17.099999999999998, -15.5, -7.300000000000001, -11.799999999999999, -6.4, -5.4, -22.699999999999996, -30.69999999999999, -7.300000000000001, -6.199999999999999, -10.799999999999999, -5.3, -19.300000000000004, -11.499999999999984, -12.8, -8.2, -5.1, -1.0, -10.3, -18.3, -71.3, -4.3, -4.4, -3.7, -5.2, -5.3, -15.899999999999997, -23.3, -24.4, -34.20000000000002, -3.2, -13.1, -7.2, -10.299999999999999, -10.3, -5.4, -28.600000000000037, -16.199999999999996, -6.300000000000001, -21.5, -4.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0846808912221406, "mean_inference_ms": 1.4394398516690858, "mean_action_processing_ms": 0.07779042622183958, "mean_env_wait_ms": 6.535364136418743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3252000, "timesteps_this_iter": 0, "agent_timesteps_total": 3252000, "timers": {"sample_time_ms": 18986.599, "sample_throughput": 210.675, "load_time_ms": 0.454, "load_throughput": 8806937.533, "learn_time_ms": 9269.896, "learn_throughput": 431.504, "update_time_ms": 1.885}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3575558067319454, "policy_loss": -0.021667621005326508, "vf_loss": 37.69025185287639, "vf_explained_var": 0.047827541892246535, "kl": 0.013753557135092421, "entropy": 0.3222716957651159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3252000, "num_agent_steps_sampled": 3252000, "num_steps_trained": 3252000, "num_agent_steps_trained": 3252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32680, "training_iteration": 813, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-25-15", "timestamp": 1643711115, "time_this_iter_s": 26.245925903320312, "time_total_s": 20135.71056509018, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7876.201688051224, "timesteps_since_restore": 0, "iterations_since_restore": 417, "perf": {"cpu_util_percent": 44.56315789473684, "ram_util_percent": 63.90526315789475}}
{"episode_reward_max": -1.0, "episode_reward_min": -71.3, "episode_reward_mean": -13.723999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.500000000000014, -18.200000000000014, -20.90000000000005, -4.3, -7.4, -6.3, -7.599999999999999, -4.7, -8.8, -7.3, -12.899999999999999, -15.999999999999998, -14.199999999999985, -16.4, -12.2, -4.2, -11.799999999999999, -12.0, -8.3, -17.099999999999998, -15.5, -7.300000000000001, -11.799999999999999, -6.4, -5.4, -22.699999999999996, -30.69999999999999, -7.300000000000001, -6.199999999999999, -10.799999999999999, -5.3, -19.300000000000004, -11.499999999999984, -12.8, -8.2, -5.1, -1.0, -10.3, -18.3, -71.3, -4.3, -4.4, -3.7, -5.2, -5.3, -15.899999999999997, -23.3, -24.4, -34.20000000000002, -3.2, -13.1, -7.2, -10.299999999999999, -10.3, -5.4, -28.600000000000037, -16.199999999999996, -6.300000000000001, -21.5, -4.6000000000000005, -10.199999999999998, -4.4, -18.400000000000002, -8.299999999999999, -7.4, -19.1, -20.099999999999998, -13.700000000000001, -13.499999999999998, -17.600000000000005, -15.399999999999999, -47.2, -16.400000000000002, -5.3, -24.3, -5.300000000000001, -16.599999999999994, -3.3, -8.2, -17.400000000000002, -9.8, -12.4, -37.3, -9.9, -12.899999999999991, -5.3, -10.2, -17.199999999999974, -35.10000000000005, -19.8, -5.3, -2.3000000000000003, -23.4, -13.799999999999999, -2.9000000000000004, -9.2, -62.19999999999994, -10.3, -11.0, -6.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0858040459446356, "mean_inference_ms": 1.4410482051562223, "mean_action_processing_ms": 0.0778780671072749, "mean_env_wait_ms": 6.542984940807304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3256000, "timesteps_this_iter": 0, "agent_timesteps_total": 3256000, "timers": {"sample_time_ms": 19783.017, "sample_throughput": 202.194, "load_time_ms": 0.438, "load_throughput": 9138912.736, "learn_time_ms": 9490.672, "learn_throughput": 421.466, "update_time_ms": 1.909}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.258980430997107, "policy_loss": -0.035534709828695464, "vf_loss": 29.211998288093074, "vf_explained_var": 0.09017447528018746, "kl": 0.01419356703067521, "entropy": 0.3323858105207002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3256000, "num_agent_steps_sampled": 3256000, "num_steps_trained": 3256000, "num_agent_steps_trained": 3256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32720, "training_iteration": 814, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-25-41", "timestamp": 1643711141, "time_this_iter_s": 26.6698579788208, "time_total_s": 20162.380423069, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7902.871546030045, "timesteps_since_restore": 0, "iterations_since_restore": 418, "perf": {"cpu_util_percent": 49.94736842105262, "ram_util_percent": 63.96052631578947}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -77.3, "episode_reward_mean": -14.239, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -4.4, -3.7, -5.2, -5.3, -15.899999999999997, -23.3, -24.4, -34.20000000000002, -3.2, -13.1, -7.2, -10.299999999999999, -10.3, -5.4, -28.600000000000037, -16.199999999999996, -6.300000000000001, -21.5, -4.6000000000000005, -10.199999999999998, -4.4, -18.400000000000002, -8.299999999999999, -7.4, -19.1, -20.099999999999998, -13.700000000000001, -13.499999999999998, -17.600000000000005, -15.399999999999999, -47.2, -16.400000000000002, -5.3, -24.3, -5.300000000000001, -16.599999999999994, -3.3, -8.2, -17.400000000000002, -9.8, -12.4, -37.3, -9.9, -12.899999999999991, -5.3, -10.2, -17.199999999999974, -35.10000000000005, -19.8, -5.3, -2.3000000000000003, -23.4, -13.799999999999999, -2.9000000000000004, -9.2, -62.19999999999994, -10.3, -11.0, -6.3, -17.0, -24.099999999999998, -21.7, -6.2, -13.2, -11.799999999999999, -12.9, -9.499999999999998, -14.4, -7.4, -7.4, -30.2, -4.300000000000001, -11.0, -4.2, -28.3, -5.2, -26.700000000000003, -10.4, -14.499999999999988, -15.799999999999999, -7.699999999999998, -6.4, -22.800000000000004, -20.7, -6.3, -13.799999999999999, -8.5, -9.3, -6.2, -7.300000000000001, -7.2, -10.4, -8.599999999999998, -6.3, -16.2, -77.3, -7.699999999999999, -17.699999999999996, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0864314196158906, "mean_inference_ms": 1.4420394139353516, "mean_action_processing_ms": 0.07793183430248173, "mean_env_wait_ms": 6.54760311419652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3260000, "timesteps_this_iter": 0, "agent_timesteps_total": 3260000, "timers": {"sample_time_ms": 19950.627, "sample_throughput": 200.495, "load_time_ms": 0.437, "load_throughput": 9159368.892, "learn_time_ms": 9471.47, "learn_throughput": 422.321, "update_time_ms": 1.888}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3565974988083365, "policy_loss": -0.019851637596604965, "vf_loss": 37.463335099784274, "vf_explained_var": 0.05369583675938268, "kl": 0.010760271333613911, "entropy": 0.29071301929252125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3260000, "num_agent_steps_sampled": 3260000, "num_steps_trained": 3260000, "num_agent_steps_trained": 3260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32760, "training_iteration": 815, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-25-59", "timestamp": 1643711159, "time_this_iter_s": 17.984337329864502, "time_total_s": 20180.364760398865, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7920.855883359909, "timesteps_since_restore": 0, "iterations_since_restore": 419, "perf": {"cpu_util_percent": 35.30384615384615, "ram_util_percent": 63.861538461538466}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -77.3, "episode_reward_mean": -13.364999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.8, -12.4, -37.3, -9.9, -12.899999999999991, -5.3, -10.2, -17.199999999999974, -35.10000000000005, -19.8, -5.3, -2.3000000000000003, -23.4, -13.799999999999999, -2.9000000000000004, -9.2, -62.19999999999994, -10.3, -11.0, -6.3, -17.0, -24.099999999999998, -21.7, -6.2, -13.2, -11.799999999999999, -12.9, -9.499999999999998, -14.4, -7.4, -7.4, -30.2, -4.300000000000001, -11.0, -4.2, -28.3, -5.2, -26.700000000000003, -10.4, -14.499999999999988, -15.799999999999999, -7.699999999999998, -6.4, -22.800000000000004, -20.7, -6.3, -13.799999999999999, -8.5, -9.3, -6.2, -7.300000000000001, -7.2, -10.4, -8.599999999999998, -6.3, -16.2, -77.3, -7.699999999999999, -17.699999999999996, -11.2, -22.2, -15.6, -13.699999999999998, -6.3, -7.4, -25.3, -14.399999999999993, -13.9, -8.4, -11.3, -22.900000000000016, -5.699999999999999, -7.2, -16.4, -18.6, -16.7, -4.3, -14.899999999999999, -6.3, -6.2, -5.2, -5.4, -9.3, -12.3, -10.3, -10.699999999999998, -12.199999999999998, -8.399999999999999, -4.4, -8.6, -9.4, -11.299999999999997, -22.9, -6.3, -10.2, -4.300000000000001, -6.300000000000001, -7.3, -16.5, -13.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.087062552170393, "mean_inference_ms": 1.442955067722113, "mean_action_processing_ms": 0.07798052584363939, "mean_env_wait_ms": 6.551829488011101, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3264000, "timesteps_this_iter": 0, "agent_timesteps_total": 3264000, "timers": {"sample_time_ms": 20249.337, "sample_throughput": 197.537, "load_time_ms": 0.463, "load_throughput": 8641368.014, "learn_time_ms": 10054.387, "learn_throughput": 397.836, "update_time_ms": 1.953}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07755378004544045, "policy_loss": -0.015080535185513317, "vf_loss": 9.01293636903327, "vf_explained_var": 0.2049932631113196, "kl": 0.014844168480878253, "entropy": 0.3261632696114561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3264000, "num_agent_steps_sampled": 3264000, "num_steps_trained": 3264000, "num_agent_steps_trained": 3264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32800, "training_iteration": 816, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-26-26", "timestamp": 1643711186, "time_this_iter_s": 26.851523876190186, "time_total_s": 20207.216284275055, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7947.707407236099, "timesteps_since_restore": 0, "iterations_since_restore": 420, "perf": {"cpu_util_percent": 40.8578947368421, "ram_util_percent": 63.815789473684234}}
{"episode_reward_max": -4.3, "episode_reward_min": -77.3, "episode_reward_mean": -13.232999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999999, -7.699999999999998, -6.4, -22.800000000000004, -20.7, -6.3, -13.799999999999999, -8.5, -9.3, -6.2, -7.300000000000001, -7.2, -10.4, -8.599999999999998, -6.3, -16.2, -77.3, -7.699999999999999, -17.699999999999996, -11.2, -22.2, -15.6, -13.699999999999998, -6.3, -7.4, -25.3, -14.399999999999993, -13.9, -8.4, -11.3, -22.900000000000016, -5.699999999999999, -7.2, -16.4, -18.6, -16.7, -4.3, -14.899999999999999, -6.3, -6.2, -5.2, -5.4, -9.3, -12.3, -10.3, -10.699999999999998, -12.199999999999998, -8.399999999999999, -4.4, -8.6, -9.4, -11.299999999999997, -22.9, -6.3, -10.2, -4.300000000000001, -6.300000000000001, -7.3, -16.5, -13.099999999999998, -20.799999999999997, -5.3, -19.1, -14.099999999999982, -25.800000000000004, -18.799999999999997, -16.099999999999998, -27.800000000000058, -5.4, -5.300000000000001, -11.999999999999998, -18.700000000000003, -10.2, -8.899999999999999, -10.3, -13.099999999999994, -16.9, -10.700000000000001, -12.299999999999997, -5.4, -4.4, -23.999999999999996, -6.2, -18.099999999999998, -22.400000000000002, -8.2, -19.599999999999998, -21.4, -12.2, -10.799999999999997, -9.899999999999999, -18.3, -14.199999999999973, -24.000000000000004, -17.2, -43.00000000000001, -5.2, -5.2, -15.3, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0878636408847506, "mean_inference_ms": 1.4440719059021638, "mean_action_processing_ms": 0.07804042367921075, "mean_env_wait_ms": 6.556804766993356, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3268000, "timesteps_this_iter": 0, "agent_timesteps_total": 3268000, "timers": {"sample_time_ms": 21399.159, "sample_throughput": 186.923, "load_time_ms": 0.486, "load_throughput": 8227351.903, "learn_time_ms": 10427.317, "learn_throughput": 383.608, "update_time_ms": 1.929}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.140867495700036, "policy_loss": -0.031639020597582224, "vf_loss": 17.03666882604681, "vf_explained_var": 0.19317785591207526, "kl": 0.012680479289019282, "entropy": 0.32603937558909896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3268000, "num_agent_steps_sampled": 3268000, "num_steps_trained": 3268000, "num_agent_steps_trained": 3268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32840, "training_iteration": 817, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-26-52", "timestamp": 1643711212, "time_this_iter_s": 25.431955099105835, "time_total_s": 20232.64823937416, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7973.139362335205, "timesteps_since_restore": 0, "iterations_since_restore": 421, "perf": {"cpu_util_percent": 39.52777777777778, "ram_util_percent": 63.74999999999997}}
{"episode_reward_max": -4.3, "episode_reward_min": -44.3, "episode_reward_mean": -13.856999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -5.4, -9.3, -12.3, -10.3, -10.699999999999998, -12.199999999999998, -8.399999999999999, -4.4, -8.6, -9.4, -11.299999999999997, -22.9, -6.3, -10.2, -4.300000000000001, -6.300000000000001, -7.3, -16.5, -13.099999999999998, -20.799999999999997, -5.3, -19.1, -14.099999999999982, -25.800000000000004, -18.799999999999997, -16.099999999999998, -27.800000000000058, -5.4, -5.300000000000001, -11.999999999999998, -18.700000000000003, -10.2, -8.899999999999999, -10.3, -13.099999999999994, -16.9, -10.700000000000001, -12.299999999999997, -5.4, -4.4, -23.999999999999996, -6.2, -18.099999999999998, -22.400000000000002, -8.2, -19.599999999999998, -21.4, -12.2, -10.799999999999997, -9.899999999999999, -18.3, -14.199999999999973, -24.000000000000004, -17.2, -43.00000000000001, -5.2, -5.2, -15.3, -7.2, -44.3, -6.300000000000001, -10.2, -15.399999999999999, -15.299999999999997, -5.3999999999999995, -10.999999999999998, -4.3, -14.899999999999999, -5.2, -4.300000000000001, -19.799999999999997, -8.099999999999998, -19.2, -14.3, -17.7, -11.999999999999979, -29.2, -11.699999999999998, -15.999999999999998, -24.900000000000063, -7.2, -12.299999999999997, -11.2, -11.5, -21.999999999999996, -16.2, -19.199999999999996, -16.7, -8.3, -19.8, -22.599999999999998, -12.3, -7.300000000000001, -7.500000000000002, -14.3, -20.999999999999982, -43.699999999999946, -19.599999999999998, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0882730075706295, "mean_inference_ms": 1.4447264835990623, "mean_action_processing_ms": 0.07807511463150632, "mean_env_wait_ms": 6.559702664668614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3272000, "timesteps_this_iter": 0, "agent_timesteps_total": 3272000, "timers": {"sample_time_ms": 21744.699, "sample_throughput": 183.953, "load_time_ms": 0.487, "load_throughput": 8212450.928, "learn_time_ms": 10417.774, "learn_throughput": 383.959, "update_time_ms": 1.96}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.19983222917903976, "policy_loss": -0.029257308423859617, "vf_loss": 22.657079392607493, "vf_explained_var": 0.20057117701858604, "kl": 0.014925911777346942, "entropy": 0.35839964444598843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3272000, "num_agent_steps_sampled": 3272000, "num_steps_trained": 3272000, "num_agent_steps_trained": 3272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32880, "training_iteration": 818, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-27-08", "timestamp": 1643711228, "time_this_iter_s": 16.3522732257843, "time_total_s": 20249.000512599945, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7989.491635560989, "timesteps_since_restore": 0, "iterations_since_restore": 422, "perf": {"cpu_util_percent": 33.8695652173913, "ram_util_percent": 63.70869565217392}}
{"episode_reward_max": -4.3, "episode_reward_min": -72.5, "episode_reward_mean": -16.283, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -23.999999999999996, -6.2, -18.099999999999998, -22.400000000000002, -8.2, -19.599999999999998, -21.4, -12.2, -10.799999999999997, -9.899999999999999, -18.3, -14.199999999999973, -24.000000000000004, -17.2, -43.00000000000001, -5.2, -5.2, -15.3, -7.2, -44.3, -6.300000000000001, -10.2, -15.399999999999999, -15.299999999999997, -5.3999999999999995, -10.999999999999998, -4.3, -14.899999999999999, -5.2, -4.300000000000001, -19.799999999999997, -8.099999999999998, -19.2, -14.3, -17.7, -11.999999999999979, -29.2, -11.699999999999998, -15.999999999999998, -24.900000000000063, -7.2, -12.299999999999997, -11.2, -11.5, -21.999999999999996, -16.2, -19.199999999999996, -16.7, -8.3, -19.8, -22.599999999999998, -12.3, -7.300000000000001, -7.500000000000002, -14.3, -20.999999999999982, -43.699999999999946, -19.599999999999998, -5.300000000000001, -19.099999999999998, -23.699999999999996, -19.099999999999994, -12.7, -5.300000000000001, -9.9, -15.7, -12.2, -42.1999999999999, -9.4, -9.4, -13.299999999999997, -11.299999999999999, -24.900000000000006, -14.599999999999998, -8.3, -10.099999999999998, -6.3, -20.7, -26.400000000000006, -10.699999999999998, -9.8, -16.3, -5.3, -30.400000000000027, -11.399999999999999, -7.099999999999997, -21.099999999999998, -5.2, -60.30000000000007, -17.2, -14.5, -6.4, -15.3, -6.4, -15.2, -17.199999999999978, -6.3, -72.5, -50.80000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0881964665441126, "mean_inference_ms": 1.4447142221198266, "mean_action_processing_ms": 0.07807476323508572, "mean_env_wait_ms": 6.5593730974641, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3276000, "timesteps_this_iter": 0, "agent_timesteps_total": 3276000, "timers": {"sample_time_ms": 21728.073, "sample_throughput": 184.094, "load_time_ms": 0.486, "load_throughput": 8234216.442, "learn_time_ms": 10513.907, "learn_throughput": 380.448, "update_time_ms": 2.003}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.47112865793714, "policy_loss": -0.02757627772848292, "vf_loss": 49.66480114383082, "vf_explained_var": -0.06426445418788541, "kl": 0.012189244634489171, "entropy": 0.33161950433446513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3276000, "num_agent_steps_sampled": 3276000, "num_steps_trained": 3276000, "num_agent_steps_trained": 3276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32920, "training_iteration": 819, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-27-26", "timestamp": 1643711246, "time_this_iter_s": 17.251796007156372, "time_total_s": 20266.2523086071, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8006.743431568146, "timesteps_since_restore": 0, "iterations_since_restore": 423, "perf": {"cpu_util_percent": 34.20399999999999, "ram_util_percent": 63.848}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -72.5, "episode_reward_mean": -15.601, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.900000000000063, -7.2, -12.299999999999997, -11.2, -11.5, -21.999999999999996, -16.2, -19.199999999999996, -16.7, -8.3, -19.8, -22.599999999999998, -12.3, -7.300000000000001, -7.500000000000002, -14.3, -20.999999999999982, -43.699999999999946, -19.599999999999998, -5.300000000000001, -19.099999999999998, -23.699999999999996, -19.099999999999994, -12.7, -5.300000000000001, -9.9, -15.7, -12.2, -42.1999999999999, -9.4, -9.4, -13.299999999999997, -11.299999999999999, -24.900000000000006, -14.599999999999998, -8.3, -10.099999999999998, -6.3, -20.7, -26.400000000000006, -10.699999999999998, -9.8, -16.3, -5.3, -30.400000000000027, -11.399999999999999, -7.099999999999997, -21.099999999999998, -5.2, -60.30000000000007, -17.2, -14.5, -6.4, -15.3, -6.4, -15.2, -17.199999999999978, -6.3, -72.5, -50.80000000000007, -14.999999999999998, -37.5, -15.7, -6.4, -23.499999999999993, -28.20000000000008, -25.700000000000003, -37.40000000000009, -7.300000000000001, -7.4, -15.299999999999999, -34.7, -18.699999999999996, -7.3, -35.5, -5.3, -5.300000000000001, -4.2, -9.399999999999999, -15.999999999999998, -9.4, -5.2, -4.4, -14.7, -4.7, -12.3, -15.8, -6.300000000000001, -7.3, -15.699999999999998, -6.300000000000001, -4.3, -14.299999999999999, -9.899999999999999, -2.4000000000000004, -3.3, -4.3, -7.3, -13.3, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0880962850762432, "mean_inference_ms": 1.4446635817789488, "mean_action_processing_ms": 0.07807199230414563, "mean_env_wait_ms": 6.558902979914085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3280000, "timesteps_this_iter": 0, "agent_timesteps_total": 3280000, "timers": {"sample_time_ms": 22093.889, "sample_throughput": 181.046, "load_time_ms": 0.505, "load_throughput": 7923124.439, "learn_time_ms": 10887.214, "learn_throughput": 367.403, "update_time_ms": 1.979}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16270850204727463, "policy_loss": -0.017563518492745296, "vf_loss": 17.78894867900238, "vf_explained_var": 0.028542626480902396, "kl": 0.014118748267360693, "entropy": 0.3472029081115159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3280000, "num_agent_steps_sampled": 3280000, "num_steps_trained": 3280000, "num_agent_steps_trained": 3280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 32960, "training_iteration": 820, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-27-48", "timestamp": 1643711268, "time_this_iter_s": 22.5887770652771, "time_total_s": 20288.84108567238, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8029.332208633423, "timesteps_since_restore": 0, "iterations_since_restore": 424, "perf": {"cpu_util_percent": 36.790625, "ram_util_percent": 64.071875}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -78.4, "episode_reward_mean": -15.234000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.699999999999998, -9.8, -16.3, -5.3, -30.400000000000027, -11.399999999999999, -7.099999999999997, -21.099999999999998, -5.2, -60.30000000000007, -17.2, -14.5, -6.4, -15.3, -6.4, -15.2, -17.199999999999978, -6.3, -72.5, -50.80000000000007, -14.999999999999998, -37.5, -15.7, -6.4, -23.499999999999993, -28.20000000000008, -25.700000000000003, -37.40000000000009, -7.300000000000001, -7.4, -15.299999999999999, -34.7, -18.699999999999996, -7.3, -35.5, -5.3, -5.300000000000001, -4.2, -9.399999999999999, -15.999999999999998, -9.4, -5.2, -4.4, -14.7, -4.7, -12.3, -15.8, -6.300000000000001, -7.3, -15.699999999999998, -6.300000000000001, -4.3, -14.299999999999999, -9.899999999999999, -2.4000000000000004, -3.3, -4.3, -7.3, -13.3, -6.2, -19.4, -16.5, -20.1, -78.4, -3.3, -15.899999999999997, -13.3, -27.59999999999999, -16.499999999999996, -41.99999999999995, -7.499999999999998, -5.300000000000001, -8.3, -7.3, -8.3, -3.3, -3.3, -10.7, -13.6, -12.5, -6.3, -14.699999999999996, -5.300000000000001, -13.299999999999999, -4.300000000000001, -55.4, -29.700000000000003, -6.3, -6.2, -13.599999999999996, -11.099999999999998, -42.4, -3.3, -5.3, -7.9, -11.9, -5.4, -7.300000000000001, -10.8, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0882626987196986, "mean_inference_ms": 1.4449185313970703, "mean_action_processing_ms": 0.07808416889020652, "mean_env_wait_ms": 6.559816532401191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3284000, "timesteps_this_iter": 0, "agent_timesteps_total": 3284000, "timers": {"sample_time_ms": 22645.66, "sample_throughput": 176.634, "load_time_ms": 0.523, "load_throughput": 7652792.045, "learn_time_ms": 10921.771, "learn_throughput": 366.241, "update_time_ms": 2.006}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3870077596762047, "policy_loss": -0.02718051891092972, "vf_loss": 41.1981195015292, "vf_explained_var": -0.12414593049274977, "kl": 0.013079054835421884, "entropy": 0.33246862229800994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3284000, "num_agent_steps_sampled": 3284000, "num_steps_trained": 3284000, "num_agent_steps_trained": 3284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33000, "training_iteration": 821, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-28-08", "timestamp": 1643711288, "time_this_iter_s": 19.86957025527954, "time_total_s": 20308.710655927658, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8049.201778888702, "timesteps_since_restore": 0, "iterations_since_restore": 425, "perf": {"cpu_util_percent": 34.71785714285714, "ram_util_percent": 63.850000000000016}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -78.4, "episode_reward_mean": -13.353000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.4, -5.2, -4.4, -14.7, -4.7, -12.3, -15.8, -6.300000000000001, -7.3, -15.699999999999998, -6.300000000000001, -4.3, -14.299999999999999, -9.899999999999999, -2.4000000000000004, -3.3, -4.3, -7.3, -13.3, -6.2, -19.4, -16.5, -20.1, -78.4, -3.3, -15.899999999999997, -13.3, -27.59999999999999, -16.499999999999996, -41.99999999999995, -7.499999999999998, -5.300000000000001, -8.3, -7.3, -8.3, -3.3, -3.3, -10.7, -13.6, -12.5, -6.3, -14.699999999999996, -5.300000000000001, -13.299999999999999, -4.300000000000001, -55.4, -29.700000000000003, -6.3, -6.2, -13.599999999999996, -11.099999999999998, -42.4, -3.3, -5.3, -7.9, -11.9, -5.4, -7.300000000000001, -10.8, -7.2, -10.3, -19.7, -4.3, -6.799999999999999, -3.3, -22.2, -6.4, -19.7, -13.3, -9.9, -49.8, -11.399999999999997, -21.6, -4.2, -8.2, -23.900000000000023, -13.3, -5.4, -16.1, -7.6, -20.10000000000001, -18.9, -4.4, -41.60000000000001, -18.699999999999996, -7.4, -30.000000000000007, -23.999999999999982, -9.899999999999999, -11.4, -4.3, -17.399999999999995, -14.5, -7.3999999999999995, -13.499999999999998, -5.3, -11.3, -8.2, -15.0, -6.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.088755236428008, "mean_inference_ms": 1.4456184356969948, "mean_action_processing_ms": 0.07811913849989768, "mean_env_wait_ms": 6.562712620847046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3288000, "timesteps_this_iter": 0, "agent_timesteps_total": 3288000, "timers": {"sample_time_ms": 22305.327, "sample_throughput": 179.329, "load_time_ms": 0.496, "load_throughput": 8064030.762, "learn_time_ms": 10662.512, "learn_throughput": 375.146, "update_time_ms": 2.002}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.18943620576342987, "policy_loss": -0.024712163094250904, "vf_loss": 21.23706613150976, "vf_explained_var": 0.16519014546948094, "kl": 0.010534583870313766, "entropy": 0.30696404693267676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3288000, "num_agent_steps_sampled": 3288000, "num_steps_trained": 3288000, "num_agent_steps_trained": 3288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33040, "training_iteration": 822, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-28-29", "timestamp": 1643711309, "time_this_iter_s": 20.797460794448853, "time_total_s": 20329.508116722107, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8069.999239683151, "timesteps_since_restore": 0, "iterations_since_restore": 426, "perf": {"cpu_util_percent": 40.653333333333336, "ram_util_percent": 63.90000000000001}}
{"episode_reward_max": -3.3, "episode_reward_min": -55.4, "episode_reward_mean": -12.649999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.3, -14.699999999999996, -5.300000000000001, -13.299999999999999, -4.300000000000001, -55.4, -29.700000000000003, -6.3, -6.2, -13.599999999999996, -11.099999999999998, -42.4, -3.3, -5.3, -7.9, -11.9, -5.4, -7.300000000000001, -10.8, -7.2, -10.3, -19.7, -4.3, -6.799999999999999, -3.3, -22.2, -6.4, -19.7, -13.3, -9.9, -49.8, -11.399999999999997, -21.6, -4.2, -8.2, -23.900000000000023, -13.3, -5.4, -16.1, -7.6, -20.10000000000001, -18.9, -4.4, -41.60000000000001, -18.699999999999996, -7.4, -30.000000000000007, -23.999999999999982, -9.899999999999999, -11.4, -4.3, -17.399999999999995, -14.5, -7.3999999999999995, -13.499999999999998, -5.3, -11.3, -8.2, -15.0, -6.4, -10.799999999999999, -11.3, -5.300000000000001, -22.699999999999996, -18.39999999999999, -6.3, -9.799999999999999, -10.2, -5.3, -6.4, -7.9, -6.2, -16.6, -17.799999999999997, -7.4, -5.3, -10.2, -15.799999999999997, -12.1, -13.899999999999984, -23.900000000000006, -14.999999999999996, -7.699999999999998, -6.4, -7.6, -5.300000000000001, -5.3, -5.300000000000001, -19.5, -5.3, -4.300000000000001, -8.2, -6.4, -12.999999999999998, -10.899999999999999, -9.6, -5.1000000000000005, -30.100000000000026, -4.3, -17.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.089111404287863, "mean_inference_ms": 1.4460406643744887, "mean_action_processing_ms": 0.07813928985927084, "mean_env_wait_ms": 6.564306894569142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3292000, "timesteps_this_iter": 0, "agent_timesteps_total": 3292000, "timers": {"sample_time_ms": 21713.142, "sample_throughput": 184.22, "load_time_ms": 0.452, "load_throughput": 8859022.072, "learn_time_ms": 10130.627, "learn_throughput": 394.842, "update_time_ms": 1.919}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07681089423944854, "policy_loss": -0.016527352084140343, "vf_loss": 9.09281421989523, "vf_explained_var": 0.30575129537172213, "kl": 0.014282122459004868, "entropy": 0.31037978928896687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3292000, "num_agent_steps_sampled": 3292000, "num_steps_trained": 3292000, "num_agent_steps_trained": 3292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33080, "training_iteration": 823, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-28-47", "timestamp": 1643711327, "time_this_iter_s": 17.598433017730713, "time_total_s": 20347.106549739838, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8087.597672700882, "timesteps_since_restore": 0, "iterations_since_restore": 427, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 63.876}}
{"episode_reward_max": -3.2, "episode_reward_min": -101.4, "episode_reward_mean": -12.714000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.10000000000001, -18.9, -4.4, -41.60000000000001, -18.699999999999996, -7.4, -30.000000000000007, -23.999999999999982, -9.899999999999999, -11.4, -4.3, -17.399999999999995, -14.5, -7.3999999999999995, -13.499999999999998, -5.3, -11.3, -8.2, -15.0, -6.4, -10.799999999999999, -11.3, -5.300000000000001, -22.699999999999996, -18.39999999999999, -6.3, -9.799999999999999, -10.2, -5.3, -6.4, -7.9, -6.2, -16.6, -17.799999999999997, -7.4, -5.3, -10.2, -15.799999999999997, -12.1, -13.899999999999984, -23.900000000000006, -14.999999999999996, -7.699999999999998, -6.4, -7.6, -5.300000000000001, -5.3, -5.300000000000001, -19.5, -5.3, -4.300000000000001, -8.2, -6.4, -12.999999999999998, -10.899999999999999, -9.6, -5.1000000000000005, -30.100000000000026, -4.3, -17.3, -21.6, -6.2, -5.8, -15.8, -8.199999999999998, -10.3, -11.2, -17.4, -12.7, -7.2, -5.3, -4.2, -13.999999999999998, -5.4, -5.300000000000001, -9.8, -3.2, -14.599999999999998, -14.299999999999997, -7.2, -11.4, -9.3, -14.0, -33.60000000000001, -13.499999999999998, -12.2, -6.3, -6.2, -9.4, -13.3, -16.799999999999997, -5.2, -22.7, -17.199999999999996, -6.2, -23.40000000000003, -101.4, -7.3, -4.2, -18.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0895285485987791, "mean_inference_ms": 1.4466048435359318, "mean_action_processing_ms": 0.07816774310570372, "mean_env_wait_ms": 6.56663242602889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3296000, "timesteps_this_iter": 0, "agent_timesteps_total": 3296000, "timers": {"sample_time_ms": 20969.051, "sample_throughput": 190.757, "load_time_ms": 0.47, "load_throughput": 8512464.356, "learn_time_ms": 9869.393, "learn_throughput": 405.293, "update_time_ms": 1.883}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5115485692963815, "policy_loss": -0.021881941393248096, "vf_loss": 53.13286449640028, "vf_explained_var": 0.23231275684090072, "kl": 0.01245561000356929, "entropy": 0.3178790862201363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3296000, "num_agent_steps_sampled": 3296000, "num_steps_trained": 3296000, "num_agent_steps_trained": 3296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33120, "training_iteration": 824, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-29-09", "timestamp": 1643711349, "time_this_iter_s": 21.954331874847412, "time_total_s": 20369.060881614685, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8109.552004575729, "timesteps_since_restore": 0, "iterations_since_restore": 428, "perf": {"cpu_util_percent": 39.80645161290322, "ram_util_percent": 63.89032258064518}}
{"episode_reward_max": -3.2, "episode_reward_min": -101.4, "episode_reward_mean": -13.659000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.900000000000006, -14.999999999999996, -7.699999999999998, -6.4, -7.6, -5.300000000000001, -5.3, -5.300000000000001, -19.5, -5.3, -4.300000000000001, -8.2, -6.4, -12.999999999999998, -10.899999999999999, -9.6, -5.1000000000000005, -30.100000000000026, -4.3, -17.3, -21.6, -6.2, -5.8, -15.8, -8.199999999999998, -10.3, -11.2, -17.4, -12.7, -7.2, -5.3, -4.2, -13.999999999999998, -5.4, -5.300000000000001, -9.8, -3.2, -14.599999999999998, -14.299999999999997, -7.2, -11.4, -9.3, -14.0, -33.60000000000001, -13.499999999999998, -12.2, -6.3, -6.2, -9.4, -13.3, -16.799999999999997, -5.2, -22.7, -17.199999999999996, -6.2, -23.40000000000003, -101.4, -7.3, -4.2, -18.199999999999996, -9.3, -25.5, -21.6, -54.70000000000005, -11.3, -10.699999999999996, -16.299999999999997, -8.899999999999999, -47.3, -18.400000000000006, -5.3, -5.300000000000001, -20.4, -12.59999999999999, -12.899999999999999, -18.799999999999997, -5.3, -11.9, -7.2, -6.300000000000001, -15.7, -5.3, -18.9, -5.3, -10.3, -18.400000000000002, -36.00000000000001, -16.799999999999997, -14.500000000000002, -22.600000000000005, -6.300000000000001, -8.000000000000002, -16.599999999999998, -4.3, -21.4, -5.2, -8.899999999999999, -6.4, -16.5, -16.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.089651163236822, "mean_inference_ms": 1.4467936551948446, "mean_action_processing_ms": 0.07817660538556094, "mean_env_wait_ms": 6.5672584995601335, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3300000, "timesteps_this_iter": 0, "agent_timesteps_total": 3300000, "timers": {"sample_time_ms": 20517.646, "sample_throughput": 194.954, "load_time_ms": 0.467, "load_throughput": 8572487.865, "learn_time_ms": 9916.362, "learn_throughput": 403.374, "update_time_ms": 1.867}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.22811455437863465, "policy_loss": -0.02264812562554594, "vf_loss": 24.86183915856064, "vf_explained_var": 0.21334229951263756, "kl": 0.01270694463731151, "entropy": 0.30573311930382124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3300000, "num_agent_steps_sampled": 3300000, "num_steps_trained": 3300000, "num_agent_steps_trained": 3300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33160, "training_iteration": 825, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-29-25", "timestamp": 1643711365, "time_this_iter_s": 16.59648585319519, "time_total_s": 20385.65736746788, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8126.148490428925, "timesteps_since_restore": 0, "iterations_since_restore": 429, "perf": {"cpu_util_percent": 34.916666666666664, "ram_util_percent": 63.975}}
{"episode_reward_max": -3.3, "episode_reward_min": -101.4, "episode_reward_mean": -14.784, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.4, -9.3, -14.0, -33.60000000000001, -13.499999999999998, -12.2, -6.3, -6.2, -9.4, -13.3, -16.799999999999997, -5.2, -22.7, -17.199999999999996, -6.2, -23.40000000000003, -101.4, -7.3, -4.2, -18.199999999999996, -9.3, -25.5, -21.6, -54.70000000000005, -11.3, -10.699999999999996, -16.299999999999997, -8.899999999999999, -47.3, -18.400000000000006, -5.3, -5.300000000000001, -20.4, -12.59999999999999, -12.899999999999999, -18.799999999999997, -5.3, -11.9, -7.2, -6.300000000000001, -15.7, -5.3, -18.9, -5.3, -10.3, -18.400000000000002, -36.00000000000001, -16.799999999999997, -14.500000000000002, -22.600000000000005, -6.300000000000001, -8.000000000000002, -16.599999999999998, -4.3, -21.4, -5.2, -8.899999999999999, -6.4, -16.5, -16.5, -8.2, -15.4, -11.499999999999996, -13.499999999999998, -3.3, -3.5000000000000004, -12.899999999999999, -6.300000000000001, -14.799999999999999, -6.300000000000001, -9.2, -12.1, -15.499999999999996, -9.2, -16.5, -51.29999999999994, -6.3, -4.3, -33.90000000000001, -7.2, -5.300000000000001, -5.3, -14.099999999999996, -7.4, -19.5, -38.2, -5.3, -14.999999999999996, -5.3, -13.099999999999982, -9.3, -24.3, -18.5, -15.6, -7.3, -6.300000000000001, -12.6, -14.999999999999998, -10.7, -13.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0901370914977593, "mean_inference_ms": 1.4475164477578124, "mean_action_processing_ms": 0.07821559427212602, "mean_env_wait_ms": 6.570538191475887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3304000, "timesteps_this_iter": 0, "agent_timesteps_total": 3304000, "timers": {"sample_time_ms": 20737.928, "sample_throughput": 192.883, "load_time_ms": 0.461, "load_throughput": 8680264.901, "learn_time_ms": 9494.918, "learn_throughput": 421.278, "update_time_ms": 1.805}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.14926421602046297, "policy_loss": -0.01972082136499305, "vf_loss": 16.657288894473865, "vf_explained_var": 0.22034143042820756, "kl": 0.01429425240265779, "entropy": 0.3099967996119171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3304000, "num_agent_steps_sampled": 3304000, "num_steps_trained": 3304000, "num_agent_steps_trained": 3304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33200, "training_iteration": 826, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-29-50", "timestamp": 1643711390, "time_this_iter_s": 24.36840009689331, "time_total_s": 20410.025767564774, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8150.516890525818, "timesteps_since_restore": 0, "iterations_since_restore": 430, "perf": {"cpu_util_percent": 43.83142857142858, "ram_util_percent": 63.93428571428572}}
{"episode_reward_max": -3.3, "episode_reward_min": -51.29999999999994, "episode_reward_mean": -12.958000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.7, -5.3, -18.9, -5.3, -10.3, -18.400000000000002, -36.00000000000001, -16.799999999999997, -14.500000000000002, -22.600000000000005, -6.300000000000001, -8.000000000000002, -16.599999999999998, -4.3, -21.4, -5.2, -8.899999999999999, -6.4, -16.5, -16.5, -8.2, -15.4, -11.499999999999996, -13.499999999999998, -3.3, -3.5000000000000004, -12.899999999999999, -6.300000000000001, -14.799999999999999, -6.300000000000001, -9.2, -12.1, -15.499999999999996, -9.2, -16.5, -51.29999999999994, -6.3, -4.3, -33.90000000000001, -7.2, -5.300000000000001, -5.3, -14.099999999999996, -7.4, -19.5, -38.2, -5.3, -14.999999999999996, -5.3, -13.099999999999982, -9.3, -24.3, -18.5, -15.6, -7.3, -6.300000000000001, -12.6, -14.999999999999998, -10.7, -13.399999999999999, -4.1, -7.300000000000001, -14.899999999999999, -3.4, -8.899999999999999, -9.799999999999999, -15.5, -15.099999999999998, -12.1, -6.2, -25.400000000000002, -12.4, -14.1, -20.90000000000005, -13.3, -13.799999999999999, -11.599999999999998, -12.5, -4.2, -5.2, -11.499999999999998, -4.3, -4.4, -13.3, -12.4, -39.4, -18.5, -5.300000000000001, -18.2, -12.5, -4.2, -36.2, -13.599999999999998, -10.999999999999998, -6.000000000000001, -7.299999999999999, -10.299999999999995, -9.7, -13.399999999999999, -17.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0904837383481916, "mean_inference_ms": 1.4479779738676415, "mean_action_processing_ms": 0.07824052968003686, "mean_env_wait_ms": 6.572641665651979, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3308000, "timesteps_this_iter": 0, "agent_timesteps_total": 3308000, "timers": {"sample_time_ms": 19816.735, "sample_throughput": 201.85, "load_time_ms": 0.453, "load_throughput": 8831508.133, "learn_time_ms": 9468.269, "learn_throughput": 422.464, "update_time_ms": 2.045}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09792913237526532, "policy_loss": -0.034948155215831216, "vf_loss": 12.955391280625456, "vf_explained_var": 0.15430764825113358, "kl": 0.019694086560832214, "entropy": 0.3190261221220416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3308000, "num_agent_steps_sampled": 3308000, "num_steps_trained": 3308000, "num_agent_steps_trained": 3308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33240, "training_iteration": 827, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-30-10", "timestamp": 1643711410, "time_this_iter_s": 20.201526880264282, "time_total_s": 20430.227294445038, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8170.718417406082, "timesteps_since_restore": 0, "iterations_since_restore": 431, "perf": {"cpu_util_percent": 41.04137931034483, "ram_util_percent": 63.886206896551734}}
{"episode_reward_max": -3.3, "episode_reward_min": -51.20000000000001, "episode_reward_mean": -12.968, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -5.3, -14.099999999999996, -7.4, -19.5, -38.2, -5.3, -14.999999999999996, -5.3, -13.099999999999982, -9.3, -24.3, -18.5, -15.6, -7.3, -6.300000000000001, -12.6, -14.999999999999998, -10.7, -13.399999999999999, -4.1, -7.300000000000001, -14.899999999999999, -3.4, -8.899999999999999, -9.799999999999999, -15.5, -15.099999999999998, -12.1, -6.2, -25.400000000000002, -12.4, -14.1, -20.90000000000005, -13.3, -13.799999999999999, -11.599999999999998, -12.5, -4.2, -5.2, -11.499999999999998, -4.3, -4.4, -13.3, -12.4, -39.4, -18.5, -5.300000000000001, -18.2, -12.5, -4.2, -36.2, -13.599999999999998, -10.999999999999998, -6.000000000000001, -7.299999999999999, -10.299999999999995, -9.7, -13.399999999999999, -17.0, -10.2, -17.499999999999968, -51.20000000000001, -12.799999999999999, -17.4, -5.2, -5.300000000000001, -13.3, -12.600000000000001, -5.4, -6.300000000000001, -4.2, -5.2, -3.3, -33.90000000000001, -29.500000000000018, -18.599999999999998, -17.200000000000003, -7.699999999999998, -17.599999999999994, -9.3, -21.6, -5.1000000000000005, -11.5, -18.4, -13.699999999999998, -14.899999999999999, -8.2, -6.4, -22.0, -10.2, -4.3, -8.9, -7.2, -18.000000000000007, -13.899999999999999, -3.3, -6.3, -17.7, -20.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0912051524153157, "mean_inference_ms": 1.4490452563017733, "mean_action_processing_ms": 0.0782964580266821, "mean_env_wait_ms": 6.577398068025304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3312000, "timesteps_this_iter": 0, "agent_timesteps_total": 3312000, "timers": {"sample_time_ms": 20522.274, "sample_throughput": 194.91, "load_time_ms": 0.472, "load_throughput": 8468209.166, "learn_time_ms": 9895.933, "learn_throughput": 404.206, "update_time_ms": 2.073}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.14128657889462287, "policy_loss": -0.026294882433559066, "vf_loss": 16.41839502460213, "vf_explained_var": 0.16761912882968943, "kl": 0.02013340499633297, "entropy": 0.3247246431246881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3312000, "num_agent_steps_sampled": 3312000, "num_steps_trained": 3312000, "num_agent_steps_trained": 3312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33280, "training_iteration": 828, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-30-38", "timestamp": 1643711438, "time_this_iter_s": 27.908502101898193, "time_total_s": 20458.135796546936, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8198.62691950798, "timesteps_since_restore": 0, "iterations_since_restore": 432, "perf": {"cpu_util_percent": 46.34358974358973, "ram_util_percent": 63.91794871794873}}
{"episode_reward_max": -3.3, "episode_reward_min": -51.20000000000001, "episode_reward_mean": -13.863999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.499999999999998, -4.3, -4.4, -13.3, -12.4, -39.4, -18.5, -5.300000000000001, -18.2, -12.5, -4.2, -36.2, -13.599999999999998, -10.999999999999998, -6.000000000000001, -7.299999999999999, -10.299999999999995, -9.7, -13.399999999999999, -17.0, -10.2, -17.499999999999968, -51.20000000000001, -12.799999999999999, -17.4, -5.2, -5.300000000000001, -13.3, -12.600000000000001, -5.4, -6.300000000000001, -4.2, -5.2, -3.3, -33.90000000000001, -29.500000000000018, -18.599999999999998, -17.200000000000003, -7.699999999999998, -17.599999999999994, -9.3, -21.6, -5.1000000000000005, -11.5, -18.4, -13.699999999999998, -14.899999999999999, -8.2, -6.4, -22.0, -10.2, -4.3, -8.9, -7.2, -18.000000000000007, -13.899999999999999, -3.3, -6.3, -17.7, -20.799999999999997, -5.300000000000001, -8.200000000000001, -6.3, -4.3, -7.2, -9.799999999999999, -13.999999999999998, -6.9, -6.3, -25.099999999999998, -22.2, -5.4, -27.3, -7.799999999999999, -6.2, -19.299999999999965, -17.9, -9.2, -18.9, -13.399999999999999, -7.300000000000001, -13.999999999999996, -12.599999999999998, -10.299999999999999, -13.299999999999997, -24.7, -27.799999999999997, -10.2, -5.3, -18.699999999999996, -21.3, -47.0, -6.3, -12.899999999999999, -16.299999999999997, -16.9, -25.6, -24.800000000000004, -17.2, -8.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0916962780617285, "mean_inference_ms": 1.4498220831602475, "mean_action_processing_ms": 0.0783369762100868, "mean_env_wait_ms": 6.580829707923259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3316000, "timesteps_this_iter": 0, "agent_timesteps_total": 3316000, "timers": {"sample_time_ms": 21042.592, "sample_throughput": 190.091, "load_time_ms": 0.475, "load_throughput": 8429067.524, "learn_time_ms": 10330.567, "learn_throughput": 387.2, "update_time_ms": 2.262}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.1634126858355137, "policy_loss": -0.028812586448045185, "vf_loss": 18.90614723608058, "vf_explained_var": 0.20425637415660325, "kl": 0.012498974851368598, "entropy": 0.3284963880976041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3316000, "num_agent_steps_sampled": 3316000, "num_steps_trained": 3316000, "num_agent_steps_trained": 3316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33320, "training_iteration": 829, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-31-00", "timestamp": 1643711460, "time_this_iter_s": 22.532774925231934, "time_total_s": 20480.668571472168, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8221.159694433212, "timesteps_since_restore": 0, "iterations_since_restore": 433, "perf": {"cpu_util_percent": 39.24545454545455, "ram_util_percent": 63.9939393939394}}
{"episode_reward_max": -3.3, "episode_reward_min": -126.59999999999981, "episode_reward_mean": -14.590999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -21.6, -5.1000000000000005, -11.5, -18.4, -13.699999999999998, -14.899999999999999, -8.2, -6.4, -22.0, -10.2, -4.3, -8.9, -7.2, -18.000000000000007, -13.899999999999999, -3.3, -6.3, -17.7, -20.799999999999997, -5.300000000000001, -8.200000000000001, -6.3, -4.3, -7.2, -9.799999999999999, -13.999999999999998, -6.9, -6.3, -25.099999999999998, -22.2, -5.4, -27.3, -7.799999999999999, -6.2, -19.299999999999965, -17.9, -9.2, -18.9, -13.399999999999999, -7.300000000000001, -13.999999999999996, -12.599999999999998, -10.299999999999999, -13.299999999999997, -24.7, -27.799999999999997, -10.2, -5.3, -18.699999999999996, -21.3, -47.0, -6.3, -12.899999999999999, -16.299999999999997, -16.9, -25.6, -24.800000000000004, -17.2, -8.299999999999999, -6.300000000000001, -20.700000000000003, -6.4, -7.300000000000001, -11.299999999999999, -6.4, -5.3, -20.6, -10.799999999999997, -18.0, -17.700000000000003, -10.2, -22.199999999999996, -18.200000000000003, -16.399999999999984, -7.4, -3.4, -4.300000000000001, -7.4, -14.599999999999998, -3.4, -31.20000000000001, -35.900000000000006, -5.2, -4.3, -13.799999999999999, -7.2, -11.3, -126.59999999999981, -23.20000000000001, -25.3, -5.4, -7.300000000000001, -17.499999999999996, -4.2, -12.199999999999976, -18.3, -34.80000000000002, -5.300000000000001, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0921544299793058, "mean_inference_ms": 1.4506767328431875, "mean_action_processing_ms": 0.07838313075006503, "mean_env_wait_ms": 6.584615178738727, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3320000, "timesteps_this_iter": 0, "agent_timesteps_total": 3320000, "timers": {"sample_time_ms": 21673.014, "sample_throughput": 184.561, "load_time_ms": 0.456, "load_throughput": 8772400.523, "learn_time_ms": 10081.805, "learn_throughput": 396.754, "update_time_ms": 2.316}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.5345539860164507, "policy_loss": -0.025039917291692828, "vf_loss": 55.66065967839251, "vf_explained_var": 0.21294438787685926, "kl": 0.011801727239598266, "entropy": 0.305841142932574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3320000, "num_agent_steps_sampled": 3320000, "num_steps_trained": 3320000, "num_agent_steps_trained": 3320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33360, "training_iteration": 830, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-31-22", "timestamp": 1643711482, "time_this_iter_s": 22.00771999359131, "time_total_s": 20502.67629146576, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8243.167414426804, "timesteps_since_restore": 0, "iterations_since_restore": 434, "perf": {"cpu_util_percent": 36.74516129032257, "ram_util_percent": 63.98387096774194}}
{"episode_reward_max": -3.2, "episode_reward_min": -126.59999999999981, "episode_reward_mean": -15.520999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -13.999999999999996, -12.599999999999998, -10.299999999999999, -13.299999999999997, -24.7, -27.799999999999997, -10.2, -5.3, -18.699999999999996, -21.3, -47.0, -6.3, -12.899999999999999, -16.299999999999997, -16.9, -25.6, -24.800000000000004, -17.2, -8.299999999999999, -6.300000000000001, -20.700000000000003, -6.4, -7.300000000000001, -11.299999999999999, -6.4, -5.3, -20.6, -10.799999999999997, -18.0, -17.700000000000003, -10.2, -22.199999999999996, -18.200000000000003, -16.399999999999984, -7.4, -3.4, -4.300000000000001, -7.4, -14.599999999999998, -3.4, -31.20000000000001, -35.900000000000006, -5.2, -4.3, -13.799999999999999, -7.2, -11.3, -126.59999999999981, -23.20000000000001, -25.3, -5.4, -7.300000000000001, -17.499999999999996, -4.2, -12.199999999999976, -18.3, -34.80000000000002, -5.300000000000001, -8.3, -5.4, -23.700000000000006, -3.2, -6.4, -6.2, -10.3, -4.300000000000001, -13.599999999999994, -25.800000000000004, -13.299999999999999, -3.3, -6.4, -27.2, -33.70000000000001, -8.3, -11.7, -5.2, -5.3, -18.400000000000002, -4.2, -10.299999999999999, -4.9, -7.4, -12.199999999999994, -14.9, -20.099999999999998, -26.4, -24.8, -18.799999999999997, -6.2, -17.9, -27.7, -28.3, -28.4, -7.4, -25.2, -22.799999999999997, -6.2, -5.3, -24.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.092340660706206, "mean_inference_ms": 1.450964302270299, "mean_action_processing_ms": 0.07839869589017014, "mean_env_wait_ms": 6.585777378775127, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3324000, "timesteps_this_iter": 0, "agent_timesteps_total": 3324000, "timers": {"sample_time_ms": 21241.657, "sample_throughput": 188.309, "load_time_ms": 0.438, "load_throughput": 9128967.243, "learn_time_ms": 10632.212, "learn_throughput": 376.215, "update_time_ms": 2.381}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.16167160699053879, "policy_loss": -0.009616625010566687, "vf_loss": 16.877772436667513, "vf_explained_var": 0.2271546088239198, "kl": 0.009918065583795314, "entropy": 0.314211538017437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3324000, "num_agent_steps_sampled": 3324000, "num_steps_trained": 3324000, "num_agent_steps_trained": 3324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33400, "training_iteration": 831, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-31-46", "timestamp": 1643711506, "time_this_iter_s": 23.548121213912964, "time_total_s": 20526.224412679672, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8266.715535640717, "timesteps_since_restore": 0, "iterations_since_restore": 435, "perf": {"cpu_util_percent": 37.615151515151524, "ram_util_percent": 64.03636363636363}}
{"episode_reward_max": -3.2, "episode_reward_min": -126.59999999999981, "episode_reward_mean": -16.036999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -31.20000000000001, -35.900000000000006, -5.2, -4.3, -13.799999999999999, -7.2, -11.3, -126.59999999999981, -23.20000000000001, -25.3, -5.4, -7.300000000000001, -17.499999999999996, -4.2, -12.199999999999976, -18.3, -34.80000000000002, -5.300000000000001, -8.3, -5.4, -23.700000000000006, -3.2, -6.4, -6.2, -10.3, -4.300000000000001, -13.599999999999994, -25.800000000000004, -13.299999999999999, -3.3, -6.4, -27.2, -33.70000000000001, -8.3, -11.7, -5.2, -5.3, -18.400000000000002, -4.2, -10.299999999999999, -4.9, -7.4, -12.199999999999994, -14.9, -20.099999999999998, -26.4, -24.8, -18.799999999999997, -6.2, -17.9, -27.7, -28.3, -28.4, -7.4, -25.2, -22.799999999999997, -6.2, -5.3, -24.6, -17.799999999999997, -10.2, -4.4, -5.4, -6.3999999999999995, -18.099999999999998, -12.399999999999997, -50.900000000000006, -6.6000000000000005, -14.69999999999999, -19.500000000000007, -5.2, -13.999999999999984, -17.5, -18.099999999999998, -21.4, -21.599999999999998, -10.399999999999997, -16.8, -20.999999999999975, -30.6, -22.099999999999998, -24.600000000000005, -15.199999999999992, -14.4, -14.799999999999999, -19.999999999999996, -4.2, -23.400000000000006, -17.0, -3.4, -24.400000000000006, -23.200000000000003, -5.4, -14.399999999999999, -6.2, -10.599999999999998, -6.799999999999999, -17.3, -16.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0931958723269617, "mean_inference_ms": 1.4519906081880298, "mean_action_processing_ms": 0.0784545725688385, "mean_env_wait_ms": 6.590488246036365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3328000, "timesteps_this_iter": 0, "agent_timesteps_total": 3328000, "timers": {"sample_time_ms": 22186.534, "sample_throughput": 180.29, "load_time_ms": 0.501, "load_throughput": 7977374.352, "learn_time_ms": 11072.142, "learn_throughput": 361.267, "update_time_ms": 2.433}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.19546919822622771, "policy_loss": -0.016553177766662132, "vf_loss": 20.932567707441187, "vf_explained_var": 0.17950895242793585, "kl": 0.010653638256412207, "entropy": 0.31247569463586294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3328000, "num_agent_steps_sampled": 3328000, "num_steps_trained": 3328000, "num_agent_steps_trained": 3328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33440, "training_iteration": 832, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-32-15", "timestamp": 1643711535, "time_this_iter_s": 29.13329291343689, "time_total_s": 20555.35770559311, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8295.848828554153, "timesteps_since_restore": 0, "iterations_since_restore": 436, "perf": {"cpu_util_percent": 52.321428571428584, "ram_util_percent": 64.14523809523808}}
{"episode_reward_max": -3.4, "episode_reward_min": -121.5, "episode_reward_mean": -17.265, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.299999999999999, -4.9, -7.4, -12.199999999999994, -14.9, -20.099999999999998, -26.4, -24.8, -18.799999999999997, -6.2, -17.9, -27.7, -28.3, -28.4, -7.4, -25.2, -22.799999999999997, -6.2, -5.3, -24.6, -17.799999999999997, -10.2, -4.4, -5.4, -6.3999999999999995, -18.099999999999998, -12.399999999999997, -50.900000000000006, -6.6000000000000005, -14.69999999999999, -19.500000000000007, -5.2, -13.999999999999984, -17.5, -18.099999999999998, -21.4, -21.599999999999998, -10.399999999999997, -16.8, -20.999999999999975, -30.6, -22.099999999999998, -24.600000000000005, -15.199999999999992, -14.4, -14.799999999999999, -19.999999999999996, -4.2, -23.400000000000006, -17.0, -3.4, -24.400000000000006, -23.200000000000003, -5.4, -14.399999999999999, -6.2, -10.599999999999998, -6.799999999999999, -17.3, -16.9, -6.300000000000001, -121.5, -21.6, -21.3, -4.700000000000001, -17.699999999999996, -18.799999999999997, -17.8, -23.2, -18.9, -20.5, -22.0, -9.3, -4.4, -16.7, -11.099999999999998, -20.799999999999997, -5.4, -5.0, -5.2, -5.3, -31.8, -10.7, -74.60000000000002, -12.1, -38.4, -14.799999999999999, -5.3, -22.5, -22.4, -4.3, -23.9, -9.8, -12.799999999999999, -16.9, -4.3, -4.300000000000001, -26.59999999999999, -21.199999999999996, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0939035912629438, "mean_inference_ms": 1.4527913536918788, "mean_action_processing_ms": 0.07849915985283215, "mean_env_wait_ms": 6.594259772283396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3332000, "timesteps_this_iter": 0, "agent_timesteps_total": 3332000, "timers": {"sample_time_ms": 22643.741, "sample_throughput": 176.649, "load_time_ms": 0.483, "load_throughput": 8281364.332, "learn_time_ms": 11362.877, "learn_throughput": 352.024, "update_time_ms": 2.504}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.7946971859640232, "policy_loss": -0.013591113973969733, "vf_loss": 80.52234263215014, "vf_explained_var": 0.015147891224071544, "kl": 0.012108191611191152, "entropy": 0.3052234291068969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3332000, "num_agent_steps_sampled": 3332000, "num_steps_trained": 3332000, "num_agent_steps_trained": 3332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33480, "training_iteration": 833, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-32-36", "timestamp": 1643711556, "time_this_iter_s": 20.6818790435791, "time_total_s": 20576.03958463669, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8316.530707597733, "timesteps_since_restore": 0, "iterations_since_restore": 437, "perf": {"cpu_util_percent": 38.71724137931035, "ram_util_percent": 64.1344827586207}}
{"episode_reward_max": -3.3, "episode_reward_min": -121.5, "episode_reward_mean": -16.182000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.6, -22.099999999999998, -24.600000000000005, -15.199999999999992, -14.4, -14.799999999999999, -19.999999999999996, -4.2, -23.400000000000006, -17.0, -3.4, -24.400000000000006, -23.200000000000003, -5.4, -14.399999999999999, -6.2, -10.599999999999998, -6.799999999999999, -17.3, -16.9, -6.300000000000001, -121.5, -21.6, -21.3, -4.700000000000001, -17.699999999999996, -18.799999999999997, -17.8, -23.2, -18.9, -20.5, -22.0, -9.3, -4.4, -16.7, -11.099999999999998, -20.799999999999997, -5.4, -5.0, -5.2, -5.3, -31.8, -10.7, -74.60000000000002, -12.1, -38.4, -14.799999999999999, -5.3, -22.5, -22.4, -4.3, -23.9, -9.8, -12.799999999999999, -16.9, -4.3, -4.300000000000001, -26.59999999999999, -21.199999999999996, -5.2, -5.3, -23.4, -14.9, -3.3, -4.300000000000001, -4.300000000000001, -21.299999999999958, -4.3, -14.899999999999999, -7.4, -9.7, -5.4, -5.4, -15.899999999999999, -13.699999999999994, -6.4, -8.4, -20.200000000000014, -23.900000000000002, -23.4, -6.199999999999999, -5.0, -5.300000000000001, -11.699999999999998, -6.3, -5.4, -4.4, -7.300000000000001, -24.9, -17.5, -14.099999999999998, -73.6000000000001, -23.799999999999997, -4.6, -3.3, -13.1, -15.899999999999999, -29.900000000000013, -29.6, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.094573383757388, "mean_inference_ms": 1.4537655303527577, "mean_action_processing_ms": 0.07855205641728712, "mean_env_wait_ms": 6.598935976487314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3336000, "timesteps_this_iter": 0, "agent_timesteps_total": 3336000, "timers": {"sample_time_ms": 23047.634, "sample_throughput": 173.554, "load_time_ms": 0.455, "load_throughput": 8788944.418, "learn_time_ms": 11242.456, "learn_throughput": 355.794, "update_time_ms": 2.473}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.23047352744396576, "policy_loss": -0.02983754563936463, "vf_loss": 25.77661417479156, "vf_explained_var": 0.0694143771484334, "kl": 0.01005406970137234, "entropy": 0.27295361512130306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3336000, "num_agent_steps_sampled": 3336000, "num_steps_trained": 3336000, "num_agent_steps_trained": 3336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33520, "training_iteration": 834, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-32-58", "timestamp": 1643711578, "time_this_iter_s": 21.845075130462646, "time_total_s": 20597.88465976715, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8338.375782728195, "timesteps_since_restore": 0, "iterations_since_restore": 438, "perf": {"cpu_util_percent": 37.443749999999994, "ram_util_percent": 64.121875}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.10000000000015, "episode_reward_mean": -14.667000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -31.8, -10.7, -74.60000000000002, -12.1, -38.4, -14.799999999999999, -5.3, -22.5, -22.4, -4.3, -23.9, -9.8, -12.799999999999999, -16.9, -4.3, -4.300000000000001, -26.59999999999999, -21.199999999999996, -5.2, -5.3, -23.4, -14.9, -3.3, -4.300000000000001, -4.300000000000001, -21.299999999999958, -4.3, -14.899999999999999, -7.4, -9.7, -5.4, -5.4, -15.899999999999999, -13.699999999999994, -6.4, -8.4, -20.200000000000014, -23.900000000000002, -23.4, -6.199999999999999, -5.0, -5.300000000000001, -11.699999999999998, -6.3, -5.4, -4.4, -7.300000000000001, -24.9, -17.5, -14.099999999999998, -73.6000000000001, -23.799999999999997, -4.6, -3.3, -13.1, -15.899999999999999, -29.900000000000013, -29.6, -6.2, -20.6, -7.5, -13.3, -11.4, -8.5, -17.299999999999997, -13.599999999999998, -19.4, -21.3, -12.399999999999997, -3.2, -12.000000000000002, -29.09999999999998, -11.1, -4.4, -9.2, -16.499999999999993, -4.3, -10.499999999999998, -5.3, -6.299999999999999, -4.2, -10.299999999999997, -79.10000000000015, -4.3, -11.199999999999976, -5.300000000000001, -12.9, -19.3, -3.4, -23.200000000000003, -11.600000000000001, -16.3, -18.900000000000002, -4.3, -18.999999999999993, -23.5, -20.5, -7.8999999999999995, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.094850990277214, "mean_inference_ms": 1.454200111790308, "mean_action_processing_ms": 0.07857580620862832, "mean_env_wait_ms": 6.600880523328641, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3340000, "timesteps_this_iter": 0, "agent_timesteps_total": 3340000, "timers": {"sample_time_ms": 22992.295, "sample_throughput": 173.971, "load_time_ms": 0.458, "load_throughput": 8728132.348, "learn_time_ms": 11278.431, "learn_throughput": 354.659, "update_time_ms": 2.593}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.2376932589899278, "policy_loss": -0.02696900331285051, "vf_loss": 26.147855935558194, "vf_explained_var": 0.024496216030531034, "kl": 0.01257760664178059, "entropy": 0.2836219082436254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3340000, "num_agent_steps_sampled": 3340000, "num_steps_trained": 3340000, "num_agent_steps_trained": 3340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33560, "training_iteration": 835, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-33-15", "timestamp": 1643711595, "time_this_iter_s": 17.627262353897095, "time_total_s": 20615.511922121048, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8356.003045082092, "timesteps_since_restore": 0, "iterations_since_restore": 439, "perf": {"cpu_util_percent": 37.004, "ram_util_percent": 64.09199999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.10000000000015, "episode_reward_mean": -13.972000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.199999999999999, -5.0, -5.300000000000001, -11.699999999999998, -6.3, -5.4, -4.4, -7.300000000000001, -24.9, -17.5, -14.099999999999998, -73.6000000000001, -23.799999999999997, -4.6, -3.3, -13.1, -15.899999999999999, -29.900000000000013, -29.6, -6.2, -20.6, -7.5, -13.3, -11.4, -8.5, -17.299999999999997, -13.599999999999998, -19.4, -21.3, -12.399999999999997, -3.2, -12.000000000000002, -29.09999999999998, -11.1, -4.4, -9.2, -16.499999999999993, -4.3, -10.499999999999998, -5.3, -6.299999999999999, -4.2, -10.299999999999997, -79.10000000000015, -4.3, -11.199999999999976, -5.300000000000001, -12.9, -19.3, -3.4, -23.200000000000003, -11.600000000000001, -16.3, -18.900000000000002, -4.3, -18.999999999999993, -23.5, -20.5, -7.8999999999999995, -3.2, -11.2, -7.2, -4.2, -6.700000000000001, -38.09999999999996, -3.4, -25.800000000000043, -5.799999999999999, -5.4, -6.6000000000000005, -27.400000000000002, -20.3, -9.5, -5.300000000000001, -10.999999999999998, -4.2, -10.3, -19.0, -20.5, -16.599999999999987, -13.199999999999992, -18.699999999999996, -21.200000000000006, -10.7, -13.3, -10.299999999999999, -5.4, -11.799999999999974, -6.4, -15.599999999999998, -16.999999999999996, -4.3, -27.6, -19.5, -9.399999999999999, -24.000000000000007, -3.3, -6.4, -10.200000000000001, -26.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0953943391508438, "mean_inference_ms": 1.455003884387236, "mean_action_processing_ms": 0.07861910925064299, "mean_env_wait_ms": 6.604409012108376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3344000, "timesteps_this_iter": 0, "agent_timesteps_total": 3344000, "timers": {"sample_time_ms": 22952.772, "sample_throughput": 174.271, "load_time_ms": 0.486, "load_throughput": 8224931.856, "learn_time_ms": 11177.629, "learn_throughput": 357.858, "update_time_ms": 2.539}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.1317693970997327, "policy_loss": -0.024122837575913596, "vf_loss": 15.220446710560912, "vf_explained_var": 0.20938919968502495, "kl": 0.014568968179212627, "entropy": 0.26292342677391983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3344000, "num_agent_steps_sampled": 3344000, "num_steps_trained": 3344000, "num_agent_steps_trained": 3344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33600, "training_iteration": 836, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-33-38", "timestamp": 1643711618, "time_this_iter_s": 22.566027641296387, "time_total_s": 20638.077949762344, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8378.569072723389, "timesteps_since_restore": 0, "iterations_since_restore": 440, "perf": {"cpu_util_percent": 41.193749999999994, "ram_util_percent": 64.1}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.10000000000015, "episode_reward_mean": -13.112000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.299999999999999, -4.2, -10.299999999999997, -79.10000000000015, -4.3, -11.199999999999976, -5.300000000000001, -12.9, -19.3, -3.4, -23.200000000000003, -11.600000000000001, -16.3, -18.900000000000002, -4.3, -18.999999999999993, -23.5, -20.5, -7.8999999999999995, -3.2, -11.2, -7.2, -4.2, -6.700000000000001, -38.09999999999996, -3.4, -25.800000000000043, -5.799999999999999, -5.4, -6.6000000000000005, -27.400000000000002, -20.3, -9.5, -5.300000000000001, -10.999999999999998, -4.2, -10.3, -19.0, -20.5, -16.599999999999987, -13.199999999999992, -18.699999999999996, -21.200000000000006, -10.7, -13.3, -10.299999999999999, -5.4, -11.799999999999974, -6.4, -15.599999999999998, -16.999999999999996, -4.3, -27.6, -19.5, -9.399999999999999, -24.000000000000007, -3.3, -6.4, -10.200000000000001, -26.700000000000003, -17.7, -8.4, -6.2, -13.799999999999997, -14.7, -5.3, -7.300000000000001, -14.9, -22.600000000000005, -39.29999999999999, -5.4, -6.300000000000001, -7.4, -10.3, -6.4, -9.7, -25.600000000000005, -5.3, -4.2, -16.499999999999982, -33.7, -13.5, -7.4, -7.300000000000001, -7.9, -5.4, -4.300000000000001, -5.300000000000001, -6.2, -8.3, -10.3, -9.9, -19.700000000000003, -4.2, -4.2, -24.4, -4.4, -10.5, -16.899999999999995, -21.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0957418472429554, "mean_inference_ms": 1.4555853307665296, "mean_action_processing_ms": 0.07865090498769492, "mean_env_wait_ms": 6.606910876824298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 3348000, "timesteps_this_iter": 0, "agent_timesteps_total": 3348000, "timers": {"sample_time_ms": 22944.249, "sample_throughput": 174.336, "load_time_ms": 0.481, "load_throughput": 8317081.103, "learn_time_ms": 11225.074, "learn_throughput": 356.345, "update_time_ms": 2.414}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 0.00010000000000000003, "total_loss": 0.1330313698225905, "policy_loss": -0.012684818890987224, "vf_loss": 14.363409366658939, "vf_explained_var": 0.1578368919510995, "kl": 0.008225581108945368, "entropy": 0.27087267161377016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3348000, "num_agent_steps_sampled": 3348000, "num_steps_trained": 3348000, "num_agent_steps_trained": 3348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 33640, "training_iteration": 837, "trial_id": "d1d03_00000", "experiment_id": "1b210f8e4b8d4d549564ba77d79e33b5", "date": "2022-02-01_10-34-00", "timestamp": 1643711640, "time_this_iter_s": 21.59934115409851, "time_total_s": 20659.677290916443, "pid": 83235, "hostname": "MAC-ATI0602", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8400.168413877487, "timesteps_since_restore": 0, "iterations_since_restore": 441, "perf": {"cpu_util_percent": 36.75161290322581, "ram_util_percent": 64.16129032258065}}
