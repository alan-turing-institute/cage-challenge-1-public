{"episode_reward_max": -6.399999999999999, "episode_reward_min": -85.5, "episode_reward_mean": -36.472500000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-76.10000000000002, -27.200000000000003, -18.2, -54.2, -41.3, -44.2, -45.900000000000006, -60.5, -42.6, -12.699999999999973, -29.10000000000001, -27.000000000000007, -40.400000000000006, -40.3, -37.2, -6.399999999999999, -30.800000000000004, -45.4, -52.7, -37.3, -37.7, -46.4, -14.699999999999994, -70.90000000000006, -13.699999999999996, -37.3, -19.700000000000003, -10.9, -39.2, -85.5, -27.9, -26.799999999999997, -14.4, -49.3, -58.7, -38.3, -29.200000000000003, -28.10000000000001, -31.3, -9.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8604748027546183, "mean_inference_ms": 1.1054376264909407, "mean_action_processing_ms": 0.06253896774231019, "mean_env_wait_ms": 5.247205466061802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 4000, "timesteps_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"sample_time_ms": 7435.052, "sample_throughput": 537.992, "load_time_ms": 0.386, "load_throughput": 10356306.173, "learn_time_ms": 5906.772, "learn_throughput": 677.189, "update_time_ms": 1.537}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.067148417996753, "policy_loss": 0.0019171159474119064, "vf_loss": 206.33972148433807, "vf_explained_var": -0.0031590050907545192, "kl": 0.009170637814667744, "entropy": 0.6841232495923196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4000, "num_agent_steps_sampled": 4000, "num_steps_trained": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-42-15", "timestamp": 1643665335, "time_this_iter_s": 13.343575954437256, "time_total_s": 13.343575954437256, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13.343575954437256, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.784210526315793, "ram_util_percent": 73.43684210526317}}
{"episode_reward_max": -6.399999999999999, "episode_reward_min": -154.2, "episode_reward_mean": -37.8875, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-76.10000000000002, -27.200000000000003, -18.2, -54.2, -41.3, -44.2, -45.900000000000006, -60.5, -42.6, -12.699999999999973, -29.10000000000001, -27.000000000000007, -40.400000000000006, -40.3, -37.2, -6.399999999999999, -30.800000000000004, -45.4, -52.7, -37.3, -37.7, -46.4, -14.699999999999994, -70.90000000000006, -13.699999999999996, -37.3, -19.700000000000003, -10.9, -39.2, -85.5, -27.9, -26.799999999999997, -14.4, -49.3, -58.7, -38.3, -29.200000000000003, -28.10000000000001, -31.3, -9.4, -20.300000000000054, -29.200000000000006, -76.49999999999997, -9.699999999999983, -31.10000000000001, -13.199999999999996, -20.2, -28.50000000000003, -27.3, -31.800000000000015, -35.20000000000001, -20.400000000000027, -37.8, -37.00000000000001, -36.1, -16.899999999999988, -46.30000000000001, -33.4, -21.899999999999984, -36.2, -26.800000000000004, -12.899999999999984, -49.60000000000001, -58.3, -27.3, -13.1, -40.4, -28.6, -130.7, -97.6, -31.20000000000001, -37.80000000000001, -34.800000000000054, -154.2, -15.1, -93.3, -25.799999999999997, -14.899999999999997, -41.50000000000001, -29.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8623480503165268, "mean_inference_ms": 1.1169033166434903, "mean_action_processing_ms": 0.06272481493193542, "mean_env_wait_ms": 5.2699526136202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 8000, "timesteps_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"sample_time_ms": 10580.092, "sample_throughput": 378.069, "load_time_ms": 0.367, "load_throughput": 10912010.407, "learn_time_ms": 5941.842, "learn_throughput": 673.192, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.8701868385244262, "policy_loss": -0.008774970610055232, "vf_loss": 287.655015184546, "vf_explained_var": 0.06406138000949736, "kl": 0.012058569499583623, "entropy": 0.6720500142343583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8000, "num_agent_steps_sampled": 8000, "num_steps_trained": 8000, "num_agent_steps_trained": 8000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-42-29", "timestamp": 1643665349, "time_this_iter_s": 13.785193920135498, "time_total_s": 27.128769874572754, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 27.128769874572754, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.184999999999995, "ram_util_percent": 73.42500000000003}}
{"episode_reward_max": -8.3, "episode_reward_min": -154.2, "episode_reward_mean": -34.955000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.7, -46.4, -14.699999999999994, -70.90000000000006, -13.699999999999996, -37.3, -19.700000000000003, -10.9, -39.2, -85.5, -27.9, -26.799999999999997, -14.4, -49.3, -58.7, -38.3, -29.200000000000003, -28.10000000000001, -31.3, -9.4, -20.300000000000054, -29.200000000000006, -76.49999999999997, -9.699999999999983, -31.10000000000001, -13.199999999999996, -20.2, -28.50000000000003, -27.3, -31.800000000000015, -35.20000000000001, -20.400000000000027, -37.8, -37.00000000000001, -36.1, -16.899999999999988, -46.30000000000001, -33.4, -21.899999999999984, -36.2, -26.800000000000004, -12.899999999999984, -49.60000000000001, -58.3, -27.3, -13.1, -40.4, -28.6, -130.7, -97.6, -31.20000000000001, -37.80000000000001, -34.800000000000054, -154.2, -15.1, -93.3, -25.799999999999997, -14.899999999999997, -41.50000000000001, -29.2, -33.10000000000001, -37.300000000000004, -19.800000000000004, -24.000000000000007, -25.4, -18.2, -24.2, -36.9, -24.600000000000005, -11.799999999999995, -24.800000000000004, -31.1, -52.7, -31.20000000000001, -25.2, -30.100000000000062, -17.200000000000003, -31.200000000000006, -31.00000000000001, -22.3, -30.4, -22.000000000000007, -40.20000000000002, -37.7, -12.4, -38.8, -35.30000000000001, -21.3, -28.900000000000006, -151.2, -23.3, -34.2, -27.900000000000002, -22.8, -36.30000000000001, -30.900000000000002, -8.3, -29.3, -21.3, -29.400000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8672777321337745, "mean_inference_ms": 1.1218590352736757, "mean_action_processing_ms": 0.06267127973467918, "mean_env_wait_ms": 5.253746662122843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 12000, "timesteps_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"sample_time_ms": 11538.017, "sample_throughput": 346.68, "load_time_ms": 0.365, "load_throughput": 10955952.982, "learn_time_ms": 6183.195, "learn_throughput": 646.915, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.1601687104558893, "policy_loss": -0.0049265845728817806, "vf_loss": 116.30658238421205, "vf_explained_var": 0.047264166608933476, "kl": 0.01014749141009183, "entropy": 0.6473526133644966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 12000, "num_steps_trained": 12000, "num_agent_steps_trained": 12000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-42-43", "timestamp": 1643665363, "time_this_iter_s": 14.12340521812439, "time_total_s": 41.252175092697144, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 41.252175092697144, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.154999999999998, "ram_util_percent": 73.44000000000003}}
{"episode_reward_max": -8.3, "episode_reward_min": -160.2, "episode_reward_mean": -38.92, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.800000000000004, -12.899999999999984, -49.60000000000001, -58.3, -27.3, -13.1, -40.4, -28.6, -130.7, -97.6, -31.20000000000001, -37.80000000000001, -34.800000000000054, -154.2, -15.1, -93.3, -25.799999999999997, -14.899999999999997, -41.50000000000001, -29.2, -33.10000000000001, -37.300000000000004, -19.800000000000004, -24.000000000000007, -25.4, -18.2, -24.2, -36.9, -24.600000000000005, -11.799999999999995, -24.800000000000004, -31.1, -52.7, -31.20000000000001, -25.2, -30.100000000000062, -17.200000000000003, -31.200000000000006, -31.00000000000001, -22.3, -30.4, -22.000000000000007, -40.20000000000002, -37.7, -12.4, -38.8, -35.30000000000001, -21.3, -28.900000000000006, -151.2, -23.3, -34.2, -27.900000000000002, -22.8, -36.30000000000001, -30.900000000000002, -8.3, -29.3, -21.3, -29.400000000000002, -31.9, -34.00000000000001, -50.49999999999995, -54.09999999999988, -116.3, -20.5, -20.6, -45.3, -51.20000000000001, -18.799999999999994, -160.2, -59.699999999999925, -34.300000000000004, -50.2, -35.8, -29.20000000000001, -15.29999999999998, -26.2, -50.60000000000003, -23.3, -29.2, -23.3, -36.2, -32.3, -29.0, -19.4, -34.900000000000006, -14.2, -67.30000000000001, -33.30000000000001, -132.39999999999998, -26.800000000000004, -29.500000000000007, -39.3, -21.1, -17.3, -19.6, -43.60000000000001, -29.3, -88.90000000000009], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8766389141211277, "mean_inference_ms": 1.1227683813002547, "mean_action_processing_ms": 0.06235572999204227, "mean_env_wait_ms": 5.226550914958416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"sample_time_ms": 12138.414, "sample_throughput": 329.532, "load_time_ms": 0.364, "load_throughput": 10979853.403, "learn_time_ms": 6141.894, "learn_throughput": 651.265, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.9265665255008786, "policy_loss": -0.019596357098830643, "vf_loss": 294.3817102504033, "vf_explained_var": 0.1023413787605942, "kl": 0.01172928339537086, "entropy": 0.6246717263293523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 16000, "num_steps_trained": 16000, "num_agent_steps_trained": 16000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-42-56", "timestamp": 1643665376, "time_this_iter_s": 13.273033142089844, "time_total_s": 54.52520823478699, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 54.52520823478699, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.084210526315786, "ram_util_percent": 73.41052631578948}}
{"episode_reward_max": -8.3, "episode_reward_min": -160.2, "episode_reward_mean": -36.671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.4, -22.000000000000007, -40.20000000000002, -37.7, -12.4, -38.8, -35.30000000000001, -21.3, -28.900000000000006, -151.2, -23.3, -34.2, -27.900000000000002, -22.8, -36.30000000000001, -30.900000000000002, -8.3, -29.3, -21.3, -29.400000000000002, -31.9, -34.00000000000001, -50.49999999999995, -54.09999999999988, -116.3, -20.5, -20.6, -45.3, -51.20000000000001, -18.799999999999994, -160.2, -59.699999999999925, -34.300000000000004, -50.2, -35.8, -29.20000000000001, -15.29999999999998, -26.2, -50.60000000000003, -23.3, -29.2, -23.3, -36.2, -32.3, -29.0, -19.4, -34.900000000000006, -14.2, -67.30000000000001, -33.30000000000001, -132.39999999999998, -26.800000000000004, -29.500000000000007, -39.3, -21.1, -17.3, -19.6, -43.60000000000001, -29.3, -88.90000000000009, -18.299999999999997, -14.3, -29.100000000000005, -33.300000000000004, -16.699999999999996, -20.9, -54.0, -19.2, -112.7, -12.299999999999999, -9.3, -17.2, -40.80000000000001, -38.90000000000001, -33.300000000000004, -46.8, -35.59999999999999, -126.2, -13.3, -20.2, -40.900000000000006, -29.2, -18.2, -42.6, -14.2, -20.2, -25.30000000000001, -54.900000000000006, -33.10000000000001, -19.2, -45.90000000000002, -21.6, -22.800000000000004, -31.50000000000001, -23.0, -22.699999999999996, -21.0, -39.3, -18.2, -34.10000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8749074688066932, "mean_inference_ms": 1.1199678468016827, "mean_action_processing_ms": 0.062090678849016055, "mean_env_wait_ms": 5.188574698160791, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 12397.457, "sample_throughput": 322.647, "load_time_ms": 0.358, "load_throughput": 11172892.914, "learn_time_ms": 6210.63, "learn_throughput": 644.057, "update_time_ms": 1.583}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.4534083594785883, "policy_loss": -0.006782279830546149, "vf_loss": 145.7995144146745, "vf_explained_var": -0.03563645520517903, "kl": 0.010977670968642201, "entropy": 0.6105873357865118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-43-10", "timestamp": 1643665390, "time_this_iter_s": 13.88649582862854, "time_total_s": 68.41170406341553, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 68.41170406341553, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.354999999999997, "ram_util_percent": 73.43500000000002}}
{"episode_reward_max": -7.2, "episode_reward_min": -132.39999999999998, "episode_reward_mean": -32.192, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.2, -23.3, -36.2, -32.3, -29.0, -19.4, -34.900000000000006, -14.2, -67.30000000000001, -33.30000000000001, -132.39999999999998, -26.800000000000004, -29.500000000000007, -39.3, -21.1, -17.3, -19.6, -43.60000000000001, -29.3, -88.90000000000009, -18.299999999999997, -14.3, -29.100000000000005, -33.300000000000004, -16.699999999999996, -20.9, -54.0, -19.2, -112.7, -12.299999999999999, -9.3, -17.2, -40.80000000000001, -38.90000000000001, -33.300000000000004, -46.8, -35.59999999999999, -126.2, -13.3, -20.2, -40.900000000000006, -29.2, -18.2, -42.6, -14.2, -20.2, -25.30000000000001, -54.900000000000006, -33.10000000000001, -19.2, -45.90000000000002, -21.6, -22.800000000000004, -31.50000000000001, -23.0, -22.699999999999996, -21.0, -39.3, -18.2, -34.10000000000001, -14.3, -15.3, -80.69999999999997, -11.3, -7.2, -22.4, -27.300000000000004, -34.50000000000001, -43.7, -40.800000000000004, -35.600000000000016, -28.1, -27.800000000000004, -15.499999999999998, -50.400000000000006, -51.599999999999994, -28.3, -21.1, -11.3, -36.00000000000001, -10.5, -38.10000000000001, -19.3, -95.70000000000009, -24.2, -24.3, -43.5, -15.3, -24.799999999999997, -24.500000000000004, -54.60000000000003, -16.599999999999987, -20.3, -33.500000000000014, -10.2, -7.4, -32.30000000000001, -9.399999999999999, -47.09999999999996, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8706047479438483, "mean_inference_ms": 1.1224841734046118, "mean_action_processing_ms": 0.062355556081445364, "mean_env_wait_ms": 5.187753381928719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"sample_time_ms": 12720.216, "sample_throughput": 314.46, "load_time_ms": 0.354, "load_throughput": 11287653.734, "learn_time_ms": 6208.961, "learn_throughput": 644.23, "update_time_ms": 1.591}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.9237102908196219, "policy_loss": -0.00473757756633624, "vf_loss": 92.62209483679905, "vf_explained_var": 0.12469426412736216, "kl": 0.011134692186057527, "entropy": 0.5851989466977375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 24000, "num_agent_steps_trained": 24000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-43-24", "timestamp": 1643665404, "time_this_iter_s": 14.034422874450684, "time_total_s": 82.44612693786621, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 82.44612693786621, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.714999999999996, "ram_util_percent": 73.42500000000003}}
{"episode_reward_max": -7.2, "episode_reward_min": -176.2, "episode_reward_mean": -29.638, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.900000000000006, -29.2, -18.2, -42.6, -14.2, -20.2, -25.30000000000001, -54.900000000000006, -33.10000000000001, -19.2, -45.90000000000002, -21.6, -22.800000000000004, -31.50000000000001, -23.0, -22.699999999999996, -21.0, -39.3, -18.2, -34.10000000000001, -14.3, -15.3, -80.69999999999997, -11.3, -7.2, -22.4, -27.300000000000004, -34.50000000000001, -43.7, -40.800000000000004, -35.600000000000016, -28.1, -27.800000000000004, -15.499999999999998, -50.400000000000006, -51.599999999999994, -28.3, -21.1, -11.3, -36.00000000000001, -10.5, -38.10000000000001, -19.3, -95.70000000000009, -24.2, -24.3, -43.5, -15.3, -24.799999999999997, -24.500000000000004, -54.60000000000003, -16.599999999999987, -20.3, -33.500000000000014, -10.2, -7.4, -32.30000000000001, -9.399999999999999, -47.09999999999996, -7.2, -8.3, -61.2, -34.60000000000002, -31.000000000000004, -9.4, -22.3, -11.3, -12.6, -25.8, -27.900000000000002, -13.2, -176.2, -28.000000000000007, -40.40000000000001, -37.0, -35.90000000000002, -13.4, -19.800000000000004, -35.70000000000001, -27.10000000000001, -30.200000000000003, -14.2, -15.2, -31.400000000000006, -20.4, -12.3, -38.0, -16.2, -39.0, -33.0, -34.60000000000001, -33.9, -25.800000000000004, -16.099999999999977, -37.300000000000004, -30.1, -23.3, -20.3, -33.20000000000001, -48.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799319409268164, "mean_inference_ms": 1.1262106036226778, "mean_action_processing_ms": 0.06265107133950619, "mean_env_wait_ms": 5.195442404186321, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 28000, "timesteps_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"sample_time_ms": 12906.102, "sample_throughput": 309.931, "load_time_ms": 0.359, "load_throughput": 11128637.544, "learn_time_ms": 6259.193, "learn_throughput": 639.06, "update_time_ms": 1.567}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.4085764653137034, "policy_loss": -0.007510415632878581, "vf_loss": 141.3999684456856, "vf_explained_var": 0.06997366489902619, "kl": 0.01043620390068937, "entropy": 0.5676975986649914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28000, "num_agent_steps_sampled": 28000, "num_steps_trained": 28000, "num_agent_steps_trained": 28000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-43-39", "timestamp": 1643665419, "time_this_iter_s": 14.360971927642822, "time_total_s": 96.80709886550903, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 96.80709886550903, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.4, "ram_util_percent": 73.54999999999998}}
{"episode_reward_max": -7.2, "episode_reward_min": -176.2, "episode_reward_mean": -30.943000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -38.10000000000001, -19.3, -95.70000000000009, -24.2, -24.3, -43.5, -15.3, -24.799999999999997, -24.500000000000004, -54.60000000000003, -16.599999999999987, -20.3, -33.500000000000014, -10.2, -7.4, -32.30000000000001, -9.399999999999999, -47.09999999999996, -7.2, -8.3, -61.2, -34.60000000000002, -31.000000000000004, -9.4, -22.3, -11.3, -12.6, -25.8, -27.900000000000002, -13.2, -176.2, -28.000000000000007, -40.40000000000001, -37.0, -35.90000000000002, -13.4, -19.800000000000004, -35.70000000000001, -27.10000000000001, -30.200000000000003, -14.2, -15.2, -31.400000000000006, -20.4, -12.3, -38.0, -16.2, -39.0, -33.0, -34.60000000000001, -33.9, -25.800000000000004, -16.099999999999977, -37.300000000000004, -30.1, -23.3, -20.3, -33.20000000000001, -48.3, -44.10000000000007, -36.90000000000001, -19.299999999999997, -17.299999999999997, -154.4, -15.7, -64.4, -25.8, -22.900000000000002, -13.3, -30.10000000000001, -131.2, -31.400000000000002, -9.3, -138.6, -18.0, -17.89999999999999, -17.2, -13.3, -32.300000000000004, -29.800000000000004, -13.3, -40.9, -10.2, -13.4, -37.50000000000001, -25.900000000000002, -11.3, -11.3, -42.100000000000016, -50.7, -25.7, -27.500000000000007, -25.000000000000007, -8.3, -13.2, -38.50000000000001, -15.099999999999989, -8.2, -10.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8891405956764555, "mean_inference_ms": 1.1261115377481123, "mean_action_processing_ms": 0.06275263446335183, "mean_env_wait_ms": 5.1871552975701025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"sample_time_ms": 13028.14, "sample_throughput": 307.028, "load_time_ms": 0.36, "load_throughput": 11114419.344, "learn_time_ms": 6251.828, "learn_throughput": 639.813, "update_time_ms": 1.559}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.9990948313063572, "policy_loss": -0.007953529017076136, "vf_loss": 200.5384415318889, "vf_explained_var": 0.026073342625812818, "kl": 0.008319912672360265, "entropy": 0.570289624730746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 32000, "num_steps_trained": 32000, "num_agent_steps_trained": 32000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-43-52", "timestamp": 1643665432, "time_this_iter_s": 13.505811929702759, "time_total_s": 110.31291079521179, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 110.31291079521179, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.585, "ram_util_percent": 73.575}}
{"episode_reward_max": -7.2, "episode_reward_min": -154.4, "episode_reward_mean": -28.284000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.200000000000003, -14.2, -15.2, -31.400000000000006, -20.4, -12.3, -38.0, -16.2, -39.0, -33.0, -34.60000000000001, -33.9, -25.800000000000004, -16.099999999999977, -37.300000000000004, -30.1, -23.3, -20.3, -33.20000000000001, -48.3, -44.10000000000007, -36.90000000000001, -19.299999999999997, -17.299999999999997, -154.4, -15.7, -64.4, -25.8, -22.900000000000002, -13.3, -30.10000000000001, -131.2, -31.400000000000002, -9.3, -138.6, -18.0, -17.89999999999999, -17.2, -13.3, -32.300000000000004, -29.800000000000004, -13.3, -40.9, -10.2, -13.4, -37.50000000000001, -25.900000000000002, -11.3, -11.3, -42.100000000000016, -50.7, -25.7, -27.500000000000007, -25.000000000000007, -8.3, -13.2, -38.50000000000001, -15.099999999999989, -8.2, -10.299999999999999, -10.3, -11.5, -25.200000000000003, -27.2, -11.299999999999999, -44.90000000000005, -20.1, -44.10000000000001, -17.9, -11.3, -32.10000000000001, -15.69999999999997, -29.300000000000004, -27.60000000000001, -39.900000000000006, -7.300000000000001, -14.3, -17.3, -29.600000000000005, -77.3, -21.7, -41.099999999999994, -16.2, -9.2, -30.200000000000006, -25.800000000000004, -28.1, -13.600000000000001, -38.20000000000001, -22.4, -26.900000000000006, -13.6, -19.3, -13.799999999999985, -7.2, -31.300000000000004, -34.900000000000034, -9.2, -22.500000000000007, -24.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8934480043121387, "mean_inference_ms": 1.1236440737929585, "mean_action_processing_ms": 0.062513525683892, "mean_env_wait_ms": 5.169021484483762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 36000, "timesteps_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"sample_time_ms": 13106.084, "sample_throughput": 305.202, "load_time_ms": 0.356, "load_throughput": 11249809.566, "learn_time_ms": 6245.814, "learn_throughput": 640.429, "update_time_ms": 1.538}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4507484223756198, "policy_loss": -0.004351126374576682, "vf_loss": 45.309093351774315, "vf_explained_var": 0.09072643967084987, "kl": 0.0100431239980834, "entropy": 0.5437594692873698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 36000, "num_steps_trained": 36000, "num_agent_steps_trained": 36000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-44-06", "timestamp": 1643665446, "time_this_iter_s": 13.712599754333496, "time_total_s": 124.02551054954529, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 124.02551054954529, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.794736842105266, "ram_util_percent": 73.48421052631578}}
{"episode_reward_max": -6.3, "episode_reward_min": -141.2, "episode_reward_mean": -24.995000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.800000000000004, -13.3, -40.9, -10.2, -13.4, -37.50000000000001, -25.900000000000002, -11.3, -11.3, -42.100000000000016, -50.7, -25.7, -27.500000000000007, -25.000000000000007, -8.3, -13.2, -38.50000000000001, -15.099999999999989, -8.2, -10.299999999999999, -10.3, -11.5, -25.200000000000003, -27.2, -11.299999999999999, -44.90000000000005, -20.1, -44.10000000000001, -17.9, -11.3, -32.10000000000001, -15.69999999999997, -29.300000000000004, -27.60000000000001, -39.900000000000006, -7.300000000000001, -14.3, -17.3, -29.600000000000005, -77.3, -21.7, -41.099999999999994, -16.2, -9.2, -30.200000000000006, -25.800000000000004, -28.1, -13.600000000000001, -38.20000000000001, -22.4, -26.900000000000006, -13.6, -19.3, -13.799999999999985, -7.2, -31.300000000000004, -34.900000000000034, -9.2, -22.500000000000007, -24.6, -9.2, -10.3, -30.099999999999945, -10.2, -50.3, -23.700000000000003, -22.0, -34.1, -11.3, -20.39999999999999, -51.8, -17.700000000000003, -9.299999999999999, -28.90000000000001, -12.099999999999998, -45.4, -13.3, -24.200000000000003, -11.2, -23.3, -20.4, -141.2, -18.3, -66.3, -12.2, -38.20000000000001, -31.9, -10.8, -71.2, -14.699999999999998, -7.1, -20.799999999999997, -10.2, -34.70000000000001, -15.799999999999997, -28.60000000000001, -6.3, -7.300000000000001, -33.000000000000014, -29.500000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8952821609479394, "mean_inference_ms": 1.122758559024703, "mean_action_processing_ms": 0.062375519162397544, "mean_env_wait_ms": 5.159075974010118, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 13177.725, "sample_throughput": 303.543, "load_time_ms": 0.356, "load_throughput": 11232737.011, "learn_time_ms": 6229.315, "learn_throughput": 642.125, "update_time_ms": 1.534}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.1090860629258978, "policy_loss": -0.005992357577047041, "vf_loss": 111.31181316375732, "vf_explained_var": 0.04790742525490382, "kl": 0.00980160259057569, "entropy": 0.5373385896285375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-44-19", "timestamp": 1643665459, "time_this_iter_s": 13.688694953918457, "time_total_s": 137.71420550346375, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 137.71420550346375, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.345, "ram_util_percent": 73.55499999999998}}
{"episode_reward_max": -6.2, "episode_reward_min": -141.2, "episode_reward_mean": -24.900000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.7, -41.099999999999994, -16.2, -9.2, -30.200000000000006, -25.800000000000004, -28.1, -13.600000000000001, -38.20000000000001, -22.4, -26.900000000000006, -13.6, -19.3, -13.799999999999985, -7.2, -31.300000000000004, -34.900000000000034, -9.2, -22.500000000000007, -24.6, -9.2, -10.3, -30.099999999999945, -10.2, -50.3, -23.700000000000003, -22.0, -34.1, -11.3, -20.39999999999999, -51.8, -17.700000000000003, -9.299999999999999, -28.90000000000001, -12.099999999999998, -45.4, -13.3, -24.200000000000003, -11.2, -23.3, -20.4, -141.2, -18.3, -66.3, -12.2, -38.20000000000001, -31.9, -10.8, -71.2, -14.699999999999998, -7.1, -20.799999999999997, -10.2, -34.70000000000001, -15.799999999999997, -28.60000000000001, -6.3, -7.300000000000001, -33.000000000000014, -29.500000000000004, -18.300000000000004, -12.9, -25.1, -11.799999999999999, -7.0, -20.300000000000036, -40.0, -49.300000000000004, -9.2, -56.6, -57.2, -23.500000000000004, -9.3, -28.200000000000003, -27.1, -12.399999999999995, -12.3, -12.3, -27.0, -19.099999999999998, -31.6, -6.2, -11.699999999999998, -11.399999999999986, -29.400000000000006, -21.9, -16.4, -26.1, -45.20000000000001, -23.1, -9.3, -13.3, -32.8, -26.900000000000006, -43.3, -67.6, -11.3, -23.500000000000007, -22.699999999999996, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8968138933886022, "mean_inference_ms": 1.1217457119911416, "mean_action_processing_ms": 0.06224397604431003, "mean_env_wait_ms": 5.150311243023179, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 44000, "timesteps_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"sample_time_ms": 13775.797, "sample_throughput": 290.364, "load_time_ms": 0.349, "load_throughput": 11468464.01, "learn_time_ms": 6276.871, "learn_throughput": 637.26, "update_time_ms": 1.521}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5807938417805338, "policy_loss": -0.010955297395146342, "vf_loss": 58.99313284094616, "vf_explained_var": 0.11086985879046943, "kl": 0.009089110390566403, "entropy": 0.5294152360449556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 44000, "num_agent_steps_sampled": 44000, "num_steps_trained": 44000, "num_agent_steps_trained": 44000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 11, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-44-33", "timestamp": 1643665473, "time_this_iter_s": 13.700722932815552, "time_total_s": 151.4149284362793, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 151.4149284362793, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.25263157894737, "ram_util_percent": 73.51052631578948}}
{"episode_reward_max": -5.4, "episode_reward_min": -141.2, "episode_reward_mean": -23.795000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.4, -141.2, -18.3, -66.3, -12.2, -38.20000000000001, -31.9, -10.8, -71.2, -14.699999999999998, -7.1, -20.799999999999997, -10.2, -34.70000000000001, -15.799999999999997, -28.60000000000001, -6.3, -7.300000000000001, -33.000000000000014, -29.500000000000004, -18.300000000000004, -12.9, -25.1, -11.799999999999999, -7.0, -20.300000000000036, -40.0, -49.300000000000004, -9.2, -56.6, -57.2, -23.500000000000004, -9.3, -28.200000000000003, -27.1, -12.399999999999995, -12.3, -12.3, -27.0, -19.099999999999998, -31.6, -6.2, -11.699999999999998, -11.399999999999986, -29.400000000000006, -21.9, -16.4, -26.1, -45.20000000000001, -23.1, -9.3, -13.3, -32.8, -26.900000000000006, -43.3, -67.6, -11.3, -23.500000000000007, -22.699999999999996, -10.3, -11.4, -9.4, -8.2, -23.400000000000002, -16.2, -18.3, -64.2, -23.900000000000002, -34.10000000000001, -7.300000000000001, -27.599999999999994, -29.900000000000002, -8.3, -8.3, -12.6, -28.500000000000007, -9.3, -5.4, -7.3, -7.300000000000001, -7.4, -26.1, -9.2, -6.300000000000001, -22.700000000000006, -16.799999999999997, -19.199999999999996, -36.2, -6.300000000000001, -28.50000000000001, -7.2, -49.20000000000003, -31.20000000000001, -49.10000000000004, -37.20000000000001, -6.2, -27.300000000000008, -20.099999999999998, -18.8, -12.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8946600774310279, "mean_inference_ms": 1.1191690049992113, "mean_action_processing_ms": 0.06205396922818611, "mean_env_wait_ms": 5.138873524352138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 13770.961, "sample_throughput": 290.466, "load_time_ms": 0.349, "load_throughput": 11448898.594, "learn_time_ms": 6285.405, "learn_throughput": 636.395, "update_time_ms": 1.471}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4357736392327214, "policy_loss": -0.004513438148123603, "vf_loss": 43.84520677981838, "vf_explained_var": 0.06802366920696792, "kl": 0.00917507795711399, "entropy": 0.49200260392440265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 48000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 12, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-44-47", "timestamp": 1643665487, "time_this_iter_s": 13.342450380325317, "time_total_s": 164.75737881660461, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 164.75737881660461, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.726315789473684, "ram_util_percent": 73.42631578947368}}
{"episode_reward_max": -4.2, "episode_reward_min": -117.69999999999999, "episode_reward_mean": -22.824, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.6, -6.2, -11.699999999999998, -11.399999999999986, -29.400000000000006, -21.9, -16.4, -26.1, -45.20000000000001, -23.1, -9.3, -13.3, -32.8, -26.900000000000006, -43.3, -67.6, -11.3, -23.500000000000007, -22.699999999999996, -10.3, -11.4, -9.4, -8.2, -23.400000000000002, -16.2, -18.3, -64.2, -23.900000000000002, -34.10000000000001, -7.300000000000001, -27.599999999999994, -29.900000000000002, -8.3, -8.3, -12.6, -28.500000000000007, -9.3, -5.4, -7.3, -7.300000000000001, -7.4, -26.1, -9.2, -6.300000000000001, -22.700000000000006, -16.799999999999997, -19.199999999999996, -36.2, -6.300000000000001, -28.50000000000001, -7.2, -49.20000000000003, -31.20000000000001, -49.10000000000004, -37.20000000000001, -6.2, -27.300000000000008, -20.099999999999998, -18.8, -12.2, -10.3, -8.2, -5.3, -26.000000000000004, -9.2, -68.4, -7.300000000000001, -18.099999999999998, -50.0, -41.80000000000008, -9.3, -23.5, -14.099999999999998, -17.599999999999994, -25.700000000000003, -24.900000000000002, -18.2, -36.40000000000001, -19.00000000000003, -18.3, -7.4, -23.3, -6.300000000000001, -27.500000000000007, -4.2, -11.3, -19.0, -117.69999999999999, -26.900000000000006, -20.6, -29.1, -24.900000000000002, -24.9, -19.799999999999997, -34.900000000000006, -6.4, -23.00000000000001, -22.100000000000005, -77.4, -22.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8945148972357453, "mean_inference_ms": 1.1167636128076739, "mean_action_processing_ms": 0.06188318050964579, "mean_env_wait_ms": 5.128137806772518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 52000, "timesteps_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"sample_time_ms": 13775.135, "sample_throughput": 290.378, "load_time_ms": 0.349, "load_throughput": 11459064.272, "learn_time_ms": 6291.038, "learn_throughput": 635.825, "update_time_ms": 1.486}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.1375199251683048, "policy_loss": -0.006237210502838015, "vf_loss": 114.10313942714404, "vf_explained_var": 0.11609516989800238, "kl": 0.013628873844399168, "entropy": 0.5020567997649151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52000, "num_agent_steps_sampled": 52000, "num_steps_trained": 52000, "num_agent_steps_trained": 52000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 520, "training_iteration": 13, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-45-01", "timestamp": 1643665501, "time_this_iter_s": 14.143590927124023, "time_total_s": 178.90096974372864, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 178.90096974372864, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.485000000000003, "ram_util_percent": 73.36500000000001}}
{"episode_reward_max": -4.2, "episode_reward_min": -117.69999999999999, "episode_reward_mean": -22.873000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -26.1, -9.2, -6.300000000000001, -22.700000000000006, -16.799999999999997, -19.199999999999996, -36.2, -6.300000000000001, -28.50000000000001, -7.2, -49.20000000000003, -31.20000000000001, -49.10000000000004, -37.20000000000001, -6.2, -27.300000000000008, -20.099999999999998, -18.8, -12.2, -10.3, -8.2, -5.3, -26.000000000000004, -9.2, -68.4, -7.300000000000001, -18.099999999999998, -50.0, -41.80000000000008, -9.3, -23.5, -14.099999999999998, -17.599999999999994, -25.700000000000003, -24.900000000000002, -18.2, -36.40000000000001, -19.00000000000003, -18.3, -7.4, -23.3, -6.300000000000001, -27.500000000000007, -4.2, -11.3, -19.0, -117.69999999999999, -26.900000000000006, -20.6, -29.1, -24.900000000000002, -24.9, -19.799999999999997, -34.900000000000006, -6.4, -23.00000000000001, -22.100000000000005, -77.4, -22.0, -19.3, -21.4, -9.2, -6.300000000000001, -24.4, -17.599999999999998, -31.500000000000014, -17.4, -57.2, -9.4, -22.1, -28.700000000000003, -16.299999999999997, -25.1, -11.099999999999996, -17.3, -8.3, -27.000000000000004, -12.2, -22.3, -14.2, -10.2, -11.3, -48.3, -23.099999999999973, -11.6, -10.699999999999998, -21.1, -11.600000000000001, -25.900000000000006, -24.000000000000004, -44.6, -23.000000000000004, -26.000000000000004, -29.0, -18.60000000000002, -14.5, -17.4, -31.4, -29.200000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.894742245029639, "mean_inference_ms": 1.1163437642117744, "mean_action_processing_ms": 0.06183670647298036, "mean_env_wait_ms": 5.126457525775461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 56000, "timesteps_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"sample_time_ms": 13820.783, "sample_throughput": 289.419, "load_time_ms": 0.35, "load_throughput": 11422396.514, "learn_time_ms": 6345.248, "learn_throughput": 630.393, "update_time_ms": 1.519}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.3086317608193044, "policy_loss": -0.0017012287311816729, "vf_loss": 30.889141262218516, "vf_explained_var": 0.09032020773938908, "kl": 0.00720792405607949, "entropy": 0.5172736186494109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 56000, "num_agent_steps_sampled": 56000, "num_steps_trained": 56000, "num_agent_steps_trained": 56000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-45-15", "timestamp": 1643665515, "time_this_iter_s": 14.216531991958618, "time_total_s": 193.11750173568726, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 193.11750173568726, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.855, "ram_util_percent": 73.525}}
{"episode_reward_max": -4.2, "episode_reward_min": -117.69999999999999, "episode_reward_mean": -22.261999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -23.3, -6.300000000000001, -27.500000000000007, -4.2, -11.3, -19.0, -117.69999999999999, -26.900000000000006, -20.6, -29.1, -24.900000000000002, -24.9, -19.799999999999997, -34.900000000000006, -6.4, -23.00000000000001, -22.100000000000005, -77.4, -22.0, -19.3, -21.4, -9.2, -6.300000000000001, -24.4, -17.599999999999998, -31.500000000000014, -17.4, -57.2, -9.4, -22.1, -28.700000000000003, -16.299999999999997, -25.1, -11.099999999999996, -17.3, -8.3, -27.000000000000004, -12.2, -22.3, -14.2, -10.2, -11.3, -48.3, -23.099999999999973, -11.6, -10.699999999999998, -21.1, -11.600000000000001, -25.900000000000006, -24.000000000000004, -44.6, -23.000000000000004, -26.000000000000004, -29.0, -18.60000000000002, -14.5, -17.4, -31.4, -29.200000000000003, -92.4, -31.500000000000007, -29.5, -21.1, -20.0, -25.2, -19.300000000000036, -16.099999999999998, -26.800000000000004, -14.999999999999998, -13.899999999999999, -14.3, -11.099999999999998, -14.000000000000002, -11.2, -11.3, -14.300000000000002, -24.9, -28.10000000000001, -11.1, -24.800000000000004, -17.799999999999997, -44.49999999999993, -32.900000000000006, -29.300000000000008, -10.2, -7.3, -26.100000000000005, -13.2, -26.8, -16.799999999999997, -11.2, -24.300000000000004, -11.6, -21.300000000000004, -8.3, -5.3, -15.199999999999996, -15.599999999999998, -14.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8949597094187329, "mean_inference_ms": 1.1169839309829674, "mean_action_processing_ms": 0.06187644171192195, "mean_env_wait_ms": 5.129274424500765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 13885.67, "sample_throughput": 288.067, "load_time_ms": 0.353, "load_throughput": 11325243.688, "learn_time_ms": 6361.878, "learn_throughput": 628.745, "update_time_ms": 1.541}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5625862037582744, "policy_loss": -0.006959267393235238, "vf_loss": 56.810817555458314, "vf_explained_var": 0.16361770924701485, "kl": 0.007186488187615282, "entropy": 0.5208090280973783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 15, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-45-29", "timestamp": 1643665529, "time_this_iter_s": 14.160871744155884, "time_total_s": 207.27837347984314, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 207.27837347984314, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.225, "ram_util_percent": 73.515}}
{"episode_reward_max": -5.3, "episode_reward_min": -98.1, "episode_reward_mean": -21.256000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -10.2, -11.3, -48.3, -23.099999999999973, -11.6, -10.699999999999998, -21.1, -11.600000000000001, -25.900000000000006, -24.000000000000004, -44.6, -23.000000000000004, -26.000000000000004, -29.0, -18.60000000000002, -14.5, -17.4, -31.4, -29.200000000000003, -92.4, -31.500000000000007, -29.5, -21.1, -20.0, -25.2, -19.300000000000036, -16.099999999999998, -26.800000000000004, -14.999999999999998, -13.899999999999999, -14.3, -11.099999999999998, -14.000000000000002, -11.2, -11.3, -14.300000000000002, -24.9, -28.10000000000001, -11.1, -24.800000000000004, -17.799999999999997, -44.49999999999993, -32.900000000000006, -29.300000000000008, -10.2, -7.3, -26.100000000000005, -13.2, -26.8, -16.799999999999997, -11.2, -24.300000000000004, -11.6, -21.300000000000004, -8.3, -5.3, -15.199999999999996, -15.599999999999998, -14.1, -18.9, -14.199999999999974, -35.100000000000016, -94.1, -38.2, -34.000000000000014, -14.999999999999998, -15.799999999999999, -12.2, -18.900000000000002, -26.5, -10.2, -5.4, -27.000000000000004, -7.300000000000001, -23.0, -7.799999999999999, -9.2, -13.3, -10.3, -30.900000000000006, -17.3, -14.7, -17.3, -9.2, -5.3, -18.799999999999997, -11.2, -12.2, -25.8, -6.300000000000001, -38.8, -98.1, -17.0, -14.7, -10.299999999999999, -13.799999999999999, -9.3, -25.9, -18.900000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.895452751856578, "mean_inference_ms": 1.1172617520010208, "mean_action_processing_ms": 0.06188995077978007, "mean_env_wait_ms": 5.130120904417677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 64000, "timesteps_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"sample_time_ms": 13866.59, "sample_throughput": 288.463, "load_time_ms": 0.36, "load_throughput": 11108532.08, "learn_time_ms": 6385.845, "learn_throughput": 626.385, "update_time_ms": 1.533}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.975258583664113, "policy_loss": -0.004696305048081183, "vf_loss": 97.84834126810874, "vf_explained_var": 0.06772657023963108, "kl": 0.007357472027461907, "entropy": 0.4944827599230633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 64000, "num_steps_trained": 64000, "num_agent_steps_trained": 64000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 16, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-45-43", "timestamp": 1643665543, "time_this_iter_s": 13.909211874008179, "time_total_s": 221.18758535385132, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 221.18758535385132, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.214999999999996, "ram_util_percent": 73.41999999999999}}
{"episode_reward_max": -5.3, "episode_reward_min": -98.1, "episode_reward_mean": -21.136999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.800000000000004, -17.799999999999997, -44.49999999999993, -32.900000000000006, -29.300000000000008, -10.2, -7.3, -26.100000000000005, -13.2, -26.8, -16.799999999999997, -11.2, -24.300000000000004, -11.6, -21.300000000000004, -8.3, -5.3, -15.199999999999996, -15.599999999999998, -14.1, -18.9, -14.199999999999974, -35.100000000000016, -94.1, -38.2, -34.000000000000014, -14.999999999999998, -15.799999999999999, -12.2, -18.900000000000002, -26.5, -10.2, -5.4, -27.000000000000004, -7.300000000000001, -23.0, -7.799999999999999, -9.2, -13.3, -10.3, -30.900000000000006, -17.3, -14.7, -17.3, -9.2, -5.3, -18.799999999999997, -11.2, -12.2, -25.8, -6.300000000000001, -38.8, -98.1, -17.0, -14.7, -10.299999999999999, -13.799999999999999, -9.3, -25.9, -18.900000000000006, -23.3, -15.699999999999998, -8.3, -37.900000000000006, -14.2, -18.999999999999996, -5.4, -54.5000000000001, -22.200000000000003, -34.4, -27.9, -11.3, -54.5, -13.3, -9.3, -45.2, -23.5, -28.300000000000008, -14.2, -23.1, -22.699999999999985, -38.1, -25.900000000000002, -12.2, -24.0, -12.099999999999998, -6.4, -24.700000000000003, -26.299999999999997, -25.300000000000004, -22.3, -11.2, -27.60000000000001, -8.4, -10.099999999999994, -21.40000000000007, -20.8, -21.1, -15.699999999999998, -23.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8944488647377692, "mean_inference_ms": 1.1166310115218945, "mean_action_processing_ms": 0.0618419028831137, "mean_env_wait_ms": 5.1267304688107584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 68000, "timesteps_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"sample_time_ms": 13844.941, "sample_throughput": 288.914, "load_time_ms": 0.356, "load_throughput": 11232737.011, "learn_time_ms": 6377.619, "learn_throughput": 627.193, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.38769525789170056, "policy_loss": -0.0034091892832469554, "vf_loss": 38.922109922286005, "vf_explained_var": 0.13528571058345099, "kl": 0.009416793064666867, "entropy": 0.46722085126625595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 68000, "num_agent_steps_sampled": 68000, "num_steps_trained": 68000, "num_agent_steps_trained": 68000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 680, "training_iteration": 17, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-45-57", "timestamp": 1643665557, "time_this_iter_s": 13.813416957855225, "time_total_s": 235.00100231170654, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 235.00100231170654, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.345000000000002, "ram_util_percent": 73.35000000000001}}
{"episode_reward_max": -5.3, "episode_reward_min": -98.1, "episode_reward_mean": -19.948, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.900000000000006, -17.3, -14.7, -17.3, -9.2, -5.3, -18.799999999999997, -11.2, -12.2, -25.8, -6.300000000000001, -38.8, -98.1, -17.0, -14.7, -10.299999999999999, -13.799999999999999, -9.3, -25.9, -18.900000000000006, -23.3, -15.699999999999998, -8.3, -37.900000000000006, -14.2, -18.999999999999996, -5.4, -54.5000000000001, -22.200000000000003, -34.4, -27.9, -11.3, -54.5, -13.3, -9.3, -45.2, -23.5, -28.300000000000008, -14.2, -23.1, -22.699999999999985, -38.1, -25.900000000000002, -12.2, -24.0, -12.099999999999998, -6.4, -24.700000000000003, -26.299999999999997, -25.300000000000004, -22.3, -11.2, -27.60000000000001, -8.4, -10.099999999999994, -21.40000000000007, -20.8, -21.1, -15.699999999999998, -23.1, -11.2, -20.699999999999996, -23.3, -8.2, -19.199999999999996, -18.499999999999982, -14.2, -29.600000000000005, -15.799999999999997, -13.0, -6.2, -28.500000000000004, -28.8, -11.8, -26.400000000000002, -6.2, -10.600000000000001, -22.80000000000002, -36.900000000000006, -23.299999999999997, -12.2, -25.3, -10.3, -21.099999999999994, -18.300000000000004, -12.2, -7.3, -10.3, -13.3, -8.4, -22.4, -8.3, -33.50000000000004, -8.7, -22.8, -23.099999999999998, -11.2, -13.3, -16.599999999999998, -20.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8928036107775743, "mean_inference_ms": 1.1159772318251402, "mean_action_processing_ms": 0.06178676778585384, "mean_env_wait_ms": 5.123673284555171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 13850.396, "sample_throughput": 288.8, "load_time_ms": 0.356, "load_throughput": 11230481.291, "learn_time_ms": 6397.913, "learn_throughput": 625.204, "update_time_ms": 1.543}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.22227083396927644, "policy_loss": -0.003381970476719641, "vf_loss": 22.385280144086448, "vf_explained_var": 0.2536971986293793, "kl": 0.009000051381734884, "entropy": 0.45850269671088906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 72000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 18, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-46-11", "timestamp": 1643665571, "time_this_iter_s": 13.845116138458252, "time_total_s": 248.8461184501648, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 248.8461184501648, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 27.110000000000003, "ram_util_percent": 73.345}}
{"episode_reward_max": -3.3000000000000003, "episode_reward_min": -65.3, "episode_reward_mean": -18.139000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.699999999999985, -38.1, -25.900000000000002, -12.2, -24.0, -12.099999999999998, -6.4, -24.700000000000003, -26.299999999999997, -25.300000000000004, -22.3, -11.2, -27.60000000000001, -8.4, -10.099999999999994, -21.40000000000007, -20.8, -21.1, -15.699999999999998, -23.1, -11.2, -20.699999999999996, -23.3, -8.2, -19.199999999999996, -18.499999999999982, -14.2, -29.600000000000005, -15.799999999999997, -13.0, -6.2, -28.500000000000004, -28.8, -11.8, -26.400000000000002, -6.2, -10.600000000000001, -22.80000000000002, -36.900000000000006, -23.299999999999997, -12.2, -25.3, -10.3, -21.099999999999994, -18.300000000000004, -12.2, -7.3, -10.3, -13.3, -8.4, -22.4, -8.3, -33.50000000000004, -8.7, -22.8, -23.099999999999998, -11.2, -13.3, -16.599999999999998, -20.300000000000004, -11.2, -12.3, -13.099999999999998, -9.1, -65.3, -11.2, -4.300000000000001, -13.3, -23.000000000000004, -20.800000000000004, -21.7, -3.3000000000000003, -25.400000000000002, -16.9, -27.3, -8.299999999999999, -11.2, -25.7, -18.099999999999998, -8.3, -50.3, -12.2, -17.900000000000002, -22.0, -22.7, -23.999999999999996, -7.300000000000001, -10.3, -18.3, -10.4, -9.3, -19.299999999999997, -10.1, -7.300000000000001, -31.20000000000001, -16.2, -21.199999999999996, -17.4, -30.2, -12.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.890216728197924, "mean_inference_ms": 1.1159417163490328, "mean_action_processing_ms": 0.06176176695281138, "mean_env_wait_ms": 5.124590744995977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 76000, "timesteps_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"sample_time_ms": 13876.842, "sample_throughput": 288.25, "load_time_ms": 0.369, "load_throughput": 10849208.484, "learn_time_ms": 6451.517, "learn_throughput": 620.009, "update_time_ms": 1.561}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.342374264785359, "policy_loss": -0.008448696312224191, "vf_loss": 34.842432263076944, "vf_explained_var": 0.2260784378615759, "kl": 0.011993228084634804, "entropy": 0.45419311235027926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76000, "num_agent_steps_sampled": 76000, "num_steps_trained": 76000, "num_agent_steps_trained": 76000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 760, "training_iteration": 19, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-46-25", "timestamp": 1643665585, "time_this_iter_s": 14.309307098388672, "time_total_s": 263.15542554855347, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 263.15542554855347, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.355, "ram_util_percent": 73.40500000000002}}
{"episode_reward_max": -3.3000000000000003, "episode_reward_min": -65.3, "episode_reward_mean": -17.077, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.2, -25.3, -10.3, -21.099999999999994, -18.300000000000004, -12.2, -7.3, -10.3, -13.3, -8.4, -22.4, -8.3, -33.50000000000004, -8.7, -22.8, -23.099999999999998, -11.2, -13.3, -16.599999999999998, -20.300000000000004, -11.2, -12.3, -13.099999999999998, -9.1, -65.3, -11.2, -4.300000000000001, -13.3, -23.000000000000004, -20.800000000000004, -21.7, -3.3000000000000003, -25.400000000000002, -16.9, -27.3, -8.299999999999999, -11.2, -25.7, -18.099999999999998, -8.3, -50.3, -12.2, -17.900000000000002, -22.0, -22.7, -23.999999999999996, -7.300000000000001, -10.3, -18.3, -10.4, -9.3, -19.299999999999997, -10.1, -7.300000000000001, -31.20000000000001, -16.2, -21.199999999999996, -17.4, -30.2, -12.999999999999998, -5.2, -25.900000000000006, -15.2, -10.3, -18.800000000000004, -13.999999999999998, -25.799999999999997, -28.800000000000008, -17.099999999999998, -9.2, -20.099999999999994, -12.499999999999991, -20.1, -35.5, -9.2, -25.900000000000006, -15.299999999999999, -15.0, -4.6000000000000005, -41.099999999999994, -11.899999999999991, -11.099999999999998, -8.2, -6.2, -26.8, -7.2, -7.300000000000001, -16.4, -5.1, -22.7, -10.2, -22.3, -6.300000000000001, -17.3, -27.200000000000006, -12.3, -11.2, -9.3, -41.1, -18.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.891436488841652, "mean_inference_ms": 1.1161114714793796, "mean_action_processing_ms": 0.061755623139974666, "mean_env_wait_ms": 5.12685202044546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 13929.412, "sample_throughput": 287.162, "load_time_ms": 0.364, "load_throughput": 10974107.797, "learn_time_ms": 6475.227, "learn_throughput": 617.739, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2204322562072306, "policy_loss": -0.005698694032366558, "vf_loss": 22.476874835901363, "vf_explained_var": 0.13634890183325737, "kl": 0.006811034724238664, "entropy": 0.43978198037673066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 800, "training_iteration": 20, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-46-39", "timestamp": 1643665599, "time_this_iter_s": 13.91408395767212, "time_total_s": 277.0695095062256, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 277.0695095062256, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.744999999999997, "ram_util_percent": 73.34}}
{"episode_reward_max": -3.9000000000000004, "episode_reward_min": -84.6, "episode_reward_mean": -17.686, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.3, -12.2, -17.900000000000002, -22.0, -22.7, -23.999999999999996, -7.300000000000001, -10.3, -18.3, -10.4, -9.3, -19.299999999999997, -10.1, -7.300000000000001, -31.20000000000001, -16.2, -21.199999999999996, -17.4, -30.2, -12.999999999999998, -5.2, -25.900000000000006, -15.2, -10.3, -18.800000000000004, -13.999999999999998, -25.799999999999997, -28.800000000000008, -17.099999999999998, -9.2, -20.099999999999994, -12.499999999999991, -20.1, -35.5, -9.2, -25.900000000000006, -15.299999999999999, -15.0, -4.6000000000000005, -41.099999999999994, -11.899999999999991, -11.099999999999998, -8.2, -6.2, -26.8, -7.2, -7.300000000000001, -16.4, -5.1, -22.7, -10.2, -22.3, -6.300000000000001, -17.3, -27.200000000000006, -12.3, -11.2, -9.3, -41.1, -18.7, -7.3, -24.0, -10.5, -3.9000000000000004, -24.500000000000007, -31.500000000000007, -19.9, -4.4, -10.3, -13.7, -8.399999999999999, -22.400000000000006, -25.800000000000004, -17.699999999999996, -22.5, -54.19999999999999, -6.3, -21.3, -5.2, -28.9, -28.700000000000003, -18.1, -26.200000000000003, -84.6, -7.2, -17.099999999999994, -11.2, -10.5, -19.900000000000002, -4.2, -35.5, -7.499999999999998, -19.799999999999997, -6.2, -14.99999999999998, -11.499999999999998, -9.999999999999996, -14.2, -9.200000000000001, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.893651926450983, "mean_inference_ms": 1.116003891486712, "mean_action_processing_ms": 0.06174529798896577, "mean_env_wait_ms": 5.12676464981649, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 84000, "timesteps_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"sample_time_ms": 13961.137, "sample_throughput": 286.51, "load_time_ms": 0.37, "load_throughput": 10822613.856, "learn_time_ms": 6468.85, "learn_throughput": 618.348, "update_time_ms": 1.57}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5877382108430949, "policy_loss": -0.006286603697545586, "vf_loss": 59.28749645653591, "vf_explained_var": 0.1350419819355011, "kl": 0.0057493366958461046, "entropy": 0.4366729978592165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84000, "num_agent_steps_sampled": 84000, "num_steps_trained": 84000, "num_agent_steps_trained": 84000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 840, "training_iteration": 21, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-46-53", "timestamp": 1643665613, "time_this_iter_s": 13.717742681503296, "time_total_s": 290.7872521877289, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 290.7872521877289, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 26.394736842105264, "ram_util_percent": 73.32631578947367}}
{"episode_reward_max": -3.2, "episode_reward_min": -84.6, "episode_reward_mean": -15.831, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999991, -11.099999999999998, -8.2, -6.2, -26.8, -7.2, -7.300000000000001, -16.4, -5.1, -22.7, -10.2, -22.3, -6.300000000000001, -17.3, -27.200000000000006, -12.3, -11.2, -9.3, -41.1, -18.7, -7.3, -24.0, -10.5, -3.9000000000000004, -24.500000000000007, -31.500000000000007, -19.9, -4.4, -10.3, -13.7, -8.399999999999999, -22.400000000000006, -25.800000000000004, -17.699999999999996, -22.5, -54.19999999999999, -6.3, -21.3, -5.2, -28.9, -28.700000000000003, -18.1, -26.200000000000003, -84.6, -7.2, -17.099999999999994, -11.2, -10.5, -19.900000000000002, -4.2, -35.5, -7.499999999999998, -19.799999999999997, -6.2, -14.99999999999998, -11.499999999999998, -9.999999999999996, -14.2, -9.200000000000001, -10.3, -9.499999999999998, -17.799999999999997, -16.9, -15.899999999999997, -6.3, -25.2, -8.3, -17.2, -16.2, -13.399999999999999, -4.1000000000000005, -7.9, -4.4, -18.19999999999999, -5.300000000000001, -21.000000000000004, -4.2, -11.2, -13.799999999999999, -14.899999999999999, -12.100000000000001, -7.2, -13.6, -8.3, -22.200000000000014, -10.200000000000001, -3.2, -16.7, -22.0, -21.4, -38.3, -5.8, -12.4, -16.099999999999984, -11.3, -7.899999999999999, -14.2, -18.2, -18.3, -23.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8934470273797922, "mean_inference_ms": 1.1159410035376367, "mean_action_processing_ms": 0.06173485053553506, "mean_env_wait_ms": 5.126065309011694, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 88000, "timesteps_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"sample_time_ms": 13972.999, "sample_throughput": 286.266, "load_time_ms": 0.37, "load_throughput": 10819124.266, "learn_time_ms": 6514.759, "learn_throughput": 613.99, "update_time_ms": 1.576}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.16599950506602243, "policy_loss": -0.003608242272128982, "vf_loss": 16.76141629706147, "vf_explained_var": 0.13654233935058757, "kl": 0.009967942072307083, "entropy": 0.4475730214868822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 88000, "num_agent_steps_sampled": 88000, "num_steps_trained": 88000, "num_agent_steps_trained": 88000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 880, "training_iteration": 22, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-47-07", "timestamp": 1643665627, "time_this_iter_s": 13.981687068939209, "time_total_s": 304.7689392566681, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 304.7689392566681, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.18, "ram_util_percent": 73.43500000000002}}
{"episode_reward_max": -2.5, "episode_reward_min": -84.6, "episode_reward_mean": -15.508000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.700000000000003, -18.1, -26.200000000000003, -84.6, -7.2, -17.099999999999994, -11.2, -10.5, -19.900000000000002, -4.2, -35.5, -7.499999999999998, -19.799999999999997, -6.2, -14.99999999999998, -11.499999999999998, -9.999999999999996, -14.2, -9.200000000000001, -10.3, -9.499999999999998, -17.799999999999997, -16.9, -15.899999999999997, -6.3, -25.2, -8.3, -17.2, -16.2, -13.399999999999999, -4.1000000000000005, -7.9, -4.4, -18.19999999999999, -5.300000000000001, -21.000000000000004, -4.2, -11.2, -13.799999999999999, -14.899999999999999, -12.100000000000001, -7.2, -13.6, -8.3, -22.200000000000014, -10.200000000000001, -3.2, -16.7, -22.0, -21.4, -38.3, -5.8, -12.4, -16.099999999999984, -11.3, -7.899999999999999, -14.2, -18.2, -18.3, -23.6, -11.3, -5.0, -7.2, -5.300000000000001, -26.100000000000005, -4.300000000000001, -13.3, -15.999999999999998, -20.900000000000013, -28.100000000000005, -6.2, -11.999999999999998, -15.399999999999997, -6.999999999999998, -13.499999999999998, -5.5, -10.0, -8.599999999999998, -28.400000000000006, -19.699999999999996, -21.700000000000006, -18.7, -11.2, -15.8, -10.2, -30.700000000000003, -15.2, -5.300000000000001, -7.300000000000001, -9.399999999999999, -7.3, -12.5, -27.400000000000002, -43.70000000000005, -11.299999999999999, -11.2, -8.3, -79.7999999999999, -15.899999999999999, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8927854745125566, "mean_inference_ms": 1.1155557102424978, "mean_action_processing_ms": 0.06171057401837307, "mean_env_wait_ms": 5.123345168214144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 92000, "timesteps_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"sample_time_ms": 14016.511, "sample_throughput": 285.378, "load_time_ms": 0.367, "load_throughput": 10913430.04, "learn_time_ms": 6524.893, "learn_throughput": 613.037, "update_time_ms": 1.55}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4796344757186479, "policy_loss": -0.0053854315171158445, "vf_loss": 48.35151814491518, "vf_explained_var": 0.14394730393604566, "kl": 0.007523751718390384, "entropy": 0.39869639756538533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 92000, "num_agent_steps_sampled": 92000, "num_steps_trained": 92000, "num_agent_steps_trained": 92000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 920, "training_iteration": 23, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-47-21", "timestamp": 1643665641, "time_this_iter_s": 14.218467950820923, "time_total_s": 318.987407207489, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 318.987407207489, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 28.794999999999995, "ram_util_percent": 73.47}}
{"episode_reward_max": -2.5, "episode_reward_min": -79.7999999999999, "episode_reward_mean": -15.238999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.100000000000001, -7.2, -13.6, -8.3, -22.200000000000014, -10.200000000000001, -3.2, -16.7, -22.0, -21.4, -38.3, -5.8, -12.4, -16.099999999999984, -11.3, -7.899999999999999, -14.2, -18.2, -18.3, -23.6, -11.3, -5.0, -7.2, -5.300000000000001, -26.100000000000005, -4.300000000000001, -13.3, -15.999999999999998, -20.900000000000013, -28.100000000000005, -6.2, -11.999999999999998, -15.399999999999997, -6.999999999999998, -13.499999999999998, -5.5, -10.0, -8.599999999999998, -28.400000000000006, -19.699999999999996, -21.700000000000006, -18.7, -11.2, -15.8, -10.2, -30.700000000000003, -15.2, -5.300000000000001, -7.300000000000001, -9.399999999999999, -7.3, -12.5, -27.400000000000002, -43.70000000000005, -11.299999999999999, -11.2, -8.3, -79.7999999999999, -15.899999999999999, -2.5, -14.399999999999999, -18.3, -4.6000000000000005, -44.3, -12.9, -4.3, -9.3, -23.800000000000022, -14.5, -8.2, -22.5, -8.2, -12.2, -40.7, -11.0, -14.2, -5.2, -18.4, -8.3, -7.1, -18.7, -8.200000000000001, -6.3, -16.9, -12.3, -28.0, -5.2, -19.1, -35.69999999999994, -15.099999999999998, -12.3, -9.3, -11.2, -28.800000000000022, -12.499999999999998, -9.999999999999998, -12.5, -12.2, -8.099999999999998, -6.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8927929311449084, "mean_inference_ms": 1.1168283079419365, "mean_action_processing_ms": 0.06176880668522479, "mean_env_wait_ms": 5.126640125297057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 14056.971, "sample_throughput": 284.556, "load_time_ms": 0.362, "load_throughput": 11043454.45, "learn_time_ms": 6492.791, "learn_throughput": 616.068, "update_time_ms": 1.512}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2220109253651112, "policy_loss": -0.0008442835341538153, "vf_loss": 22.166304663688905, "vf_explained_var": 0.040042817464438815, "kl": 0.005960834841928782, "entropy": 0.34856468344567926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 96000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 960, "training_iteration": 24, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-47-35", "timestamp": 1643665655, "time_this_iter_s": 14.198450088500977, "time_total_s": 333.18585729599, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 333.18585729599, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 28.857142857142858, "ram_util_percent": 73.46190476190479}}
{"episode_reward_max": -2.5, "episode_reward_min": -79.7999999999999, "episode_reward_mean": -15.414999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.700000000000006, -18.7, -11.2, -15.8, -10.2, -30.700000000000003, -15.2, -5.300000000000001, -7.300000000000001, -9.399999999999999, -7.3, -12.5, -27.400000000000002, -43.70000000000005, -11.299999999999999, -11.2, -8.3, -79.7999999999999, -15.899999999999999, -2.5, -14.399999999999999, -18.3, -4.6000000000000005, -44.3, -12.9, -4.3, -9.3, -23.800000000000022, -14.5, -8.2, -22.5, -8.2, -12.2, -40.7, -11.0, -14.2, -5.2, -18.4, -8.3, -7.1, -18.7, -8.200000000000001, -6.3, -16.9, -12.3, -28.0, -5.2, -19.1, -35.69999999999994, -15.099999999999998, -12.3, -9.3, -11.2, -28.800000000000022, -12.499999999999998, -9.999999999999998, -12.5, -12.2, -8.099999999999998, -6.899999999999999, -10.699999999999998, -18.799999999999997, -19.099999999999994, -23.999999999999996, -14.6, -11.7, -9.799999999999997, -17.6, -17.799999999999997, -10.3, -26.800000000000004, -5.2, -13.699999999999998, -18.1, -17.099999999999994, -17.6, -11.3, -15.699999999999998, -7.300000000000001, -16.1, -10.799999999999999, -7.2, -29.1, -9.4, -13.1, -10.3, -11.899999999999995, -8.5, -13.2, -33.3, -14.2, -13.2, -11.2, -12.8, -7.2, -8.5, -9.3, -26.300000000000008, -16.3, -15.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8932308962118397, "mean_inference_ms": 1.1179841672229882, "mean_action_processing_ms": 0.061815284585138956, "mean_env_wait_ms": 5.129345815047897, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 14011.827, "sample_throughput": 285.473, "load_time_ms": 0.358, "load_throughput": 11172148.898, "learn_time_ms": 6507.262, "learn_throughput": 614.698, "update_time_ms": 1.47}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1456510517077761, "policy_loss": -0.008009395001315943, "vf_loss": 15.18542174305967, "vf_explained_var": 0.19236876124976784, "kl": 0.009031159508978363, "entropy": 0.39990079931674466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1000, "training_iteration": 25, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-47-49", "timestamp": 1643665669, "time_this_iter_s": 14.172989130020142, "time_total_s": 347.35884642601013, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 347.35884642601013, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.77, "ram_util_percent": 73.47}}
{"episode_reward_max": -3.3, "episode_reward_min": -139.59999999999977, "episode_reward_mean": -15.069999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.7, -8.200000000000001, -6.3, -16.9, -12.3, -28.0, -5.2, -19.1, -35.69999999999994, -15.099999999999998, -12.3, -9.3, -11.2, -28.800000000000022, -12.499999999999998, -9.999999999999998, -12.5, -12.2, -8.099999999999998, -6.899999999999999, -10.699999999999998, -18.799999999999997, -19.099999999999994, -23.999999999999996, -14.6, -11.7, -9.799999999999997, -17.6, -17.799999999999997, -10.3, -26.800000000000004, -5.2, -13.699999999999998, -18.1, -17.099999999999994, -17.6, -11.3, -15.699999999999998, -7.300000000000001, -16.1, -10.799999999999999, -7.2, -29.1, -9.4, -13.1, -10.3, -11.899999999999995, -8.5, -13.2, -33.3, -14.2, -13.2, -11.2, -12.8, -7.2, -8.5, -9.3, -26.300000000000008, -16.3, -15.299999999999999, -139.59999999999977, -17.5, -7.6999999999999975, -8.2, -25.300000000000036, -24.90000000000004, -4.2, -14.899999999999972, -11.999999999999995, -10.3, -18.099999999999998, -16.599999999999984, -14.2, -9.3, -28.20000000000001, -8.2, -13.2, -18.900000000000006, -10.3, -16.199999999999996, -14.599999999999998, -11.0, -6.3, -9.3, -5.2, -7.3, -10.3, -11.3, -5.2, -20.899999999999963, -7.2, -12.3, -4.9, -10.999999999999998, -9.2, -16.7, -3.3, -11.599999999999998, -17.6, -20.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8940175805916448, "mean_inference_ms": 1.1194725140434167, "mean_action_processing_ms": 0.06189927068689232, "mean_env_wait_ms": 5.134579152039938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 104000, "timesteps_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"sample_time_ms": 14067.524, "sample_throughput": 284.343, "load_time_ms": 0.36, "load_throughput": 11120312.852, "learn_time_ms": 6495.557, "learn_throughput": 615.806, "update_time_ms": 1.452}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.757325180672029, "policy_loss": -0.004340402191124295, "vf_loss": 76.04342484448546, "vf_explained_var": 0.28369642034653697, "kl": 0.006156795117708353, "entropy": 0.3505708068208669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104000, "num_agent_steps_sampled": 104000, "num_steps_trained": 104000, "num_agent_steps_trained": 104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1040, "training_iteration": 26, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-48-04", "timestamp": 1643665684, "time_this_iter_s": 14.208213090896606, "time_total_s": 361.56705951690674, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 361.56705951690674, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.334999999999997, "ram_util_percent": 73.47999999999999}}
{"episode_reward_max": -2.2, "episode_reward_min": -139.59999999999977, "episode_reward_mean": -14.801999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.799999999999999, -7.2, -29.1, -9.4, -13.1, -10.3, -11.899999999999995, -8.5, -13.2, -33.3, -14.2, -13.2, -11.2, -12.8, -7.2, -8.5, -9.3, -26.300000000000008, -16.3, -15.299999999999999, -139.59999999999977, -17.5, -7.6999999999999975, -8.2, -25.300000000000036, -24.90000000000004, -4.2, -14.899999999999972, -11.999999999999995, -10.3, -18.099999999999998, -16.599999999999984, -14.2, -9.3, -28.20000000000001, -8.2, -13.2, -18.900000000000006, -10.3, -16.199999999999996, -14.599999999999998, -11.0, -6.3, -9.3, -5.2, -7.3, -10.3, -11.3, -5.2, -20.899999999999963, -7.2, -12.3, -4.9, -10.999999999999998, -9.2, -16.7, -3.3, -11.599999999999998, -17.6, -20.3, -6.2, -21.099999999999998, -20.700000000000003, -9.899999999999999, -19.900000000000002, -13.699999999999994, -9.2, -11.2, -5.2, -12.2, -8.5, -21.1, -2.5, -4.2, -23.4, -22.300000000000004, -11.7, -20.300000000000004, -20.6, -2.2, -10.799999999999999, -3.3, -17.800000000000004, -17.799999999999997, -17.700000000000003, -9.100000000000001, -9.2, -5.2, -6.1, -4.800000000000001, -7.199999999999998, -16.299999999999997, -15.4, -20.0, -75.3, -18.400000000000006, -11.2, -11.0, -18.100000000000012, -5.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8963514098751739, "mean_inference_ms": 1.1224301865099855, "mean_action_processing_ms": 0.06204034738725582, "mean_env_wait_ms": 5.14921440042094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"sample_time_ms": 14187.965, "sample_throughput": 281.929, "load_time_ms": 0.353, "load_throughput": 11325243.688, "learn_time_ms": 6569.335, "learn_throughput": 608.89, "update_time_ms": 1.446}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.40898550768402875, "policy_loss": -0.0020273046555518304, "vf_loss": 40.98463760088849, "vf_explained_var": -0.017943205179706698, "kl": 0.005832217285555281, "entropy": 0.37396231317712414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 108000, "num_steps_trained": 108000, "num_agent_steps_trained": 108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 27, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-48-20", "timestamp": 1643665700, "time_this_iter_s": 15.889021873474121, "time_total_s": 377.45608139038086, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 377.45608139038086, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 31.08695652173913, "ram_util_percent": 73.5}}
{"episode_reward_max": -2.2, "episode_reward_min": -132.2000000000001, "episode_reward_mean": -14.746000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.599999999999998, -11.0, -6.3, -9.3, -5.2, -7.3, -10.3, -11.3, -5.2, -20.899999999999963, -7.2, -12.3, -4.9, -10.999999999999998, -9.2, -16.7, -3.3, -11.599999999999998, -17.6, -20.3, -6.2, -21.099999999999998, -20.700000000000003, -9.899999999999999, -19.900000000000002, -13.699999999999994, -9.2, -11.2, -5.2, -12.2, -8.5, -21.1, -2.5, -4.2, -23.4, -22.300000000000004, -11.7, -20.300000000000004, -20.6, -2.2, -10.799999999999999, -3.3, -17.800000000000004, -17.799999999999997, -17.700000000000003, -9.100000000000001, -9.2, -5.2, -6.1, -4.800000000000001, -7.199999999999998, -16.299999999999997, -15.4, -20.0, -75.3, -18.400000000000006, -11.2, -11.0, -18.100000000000012, -5.0, -12.3, -20.799999999999997, -10.3, -19.9, -24.2, -21.9, -11.79999999999999, -6.699999999999999, -9.3, -11.099999999999998, -11.899999999999999, -11.899999999999999, -23.5, -8.2, -20.2, -3.2, -20.200000000000003, -10.500000000000002, -16.2, -18.299999999999997, -6.9, -15.4, -5.300000000000001, -4.300000000000001, -15.0, -7.2, -45.3, -42.3, -132.2000000000001, -10.500000000000002, -10.2, -19.700000000000003, -20.2, -7.999999999999998, -9.3, -7.2, -6.2, -18.3, -5.1, -12.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.900040234260365, "mean_inference_ms": 1.1259549358424485, "mean_action_processing_ms": 0.06221575648172271, "mean_env_wait_ms": 5.167541160411138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 112000, "timesteps_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"sample_time_ms": 14324.582, "sample_throughput": 279.24, "load_time_ms": 0.353, "load_throughput": 11324479.244, "learn_time_ms": 6590.3, "learn_throughput": 606.953, "update_time_ms": 1.447}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.1458828586524212, "policy_loss": -0.005197277298617748, "vf_loss": 114.97070726451054, "vf_explained_var": 0.08608463393744602, "kl": 0.0068654184711662795, "entropy": 0.31340545046153245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112000, "num_agent_steps_sampled": 112000, "num_steps_trained": 112000, "num_agent_steps_trained": 112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1120, "training_iteration": 28, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-48-34", "timestamp": 1643665714, "time_this_iter_s": 14.65792202949524, "time_total_s": 392.1140034198761, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 392.1140034198761, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.676190476190477, "ram_util_percent": 73.4952380952381}}
{"episode_reward_max": -2.2, "episode_reward_min": -132.2000000000001, "episode_reward_mean": -14.49, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.799999999999999, -3.3, -17.800000000000004, -17.799999999999997, -17.700000000000003, -9.100000000000001, -9.2, -5.2, -6.1, -4.800000000000001, -7.199999999999998, -16.299999999999997, -15.4, -20.0, -75.3, -18.400000000000006, -11.2, -11.0, -18.100000000000012, -5.0, -12.3, -20.799999999999997, -10.3, -19.9, -24.2, -21.9, -11.79999999999999, -6.699999999999999, -9.3, -11.099999999999998, -11.899999999999999, -11.899999999999999, -23.5, -8.2, -20.2, -3.2, -20.200000000000003, -10.500000000000002, -16.2, -18.299999999999997, -6.9, -15.4, -5.300000000000001, -4.300000000000001, -15.0, -7.2, -45.3, -42.3, -132.2000000000001, -10.500000000000002, -10.2, -19.700000000000003, -20.2, -7.999999999999998, -9.3, -7.2, -6.2, -18.3, -5.1, -12.3, -18.0, -11.599999999999996, -7.300000000000001, -6.3999999999999995, -7.199999999999999, -13.899999999999999, -6.5, -10.2, -16.999999999999993, -12.3, -13.3, -11.300000000000002, -7.0, -6.999999999999999, -17.9, -15.799999999999999, -4.4, -14.3, -10.5, -8.899999999999999, -11.2, -11.2, -29.500000000000007, -13.7, -9.499999999999991, -19.8, -10.599999999999998, -6.300000000000001, -5.300000000000001, -10.3, -14.299999999999999, -13.7, -3.3, -11.0, -8.600000000000001, -11.399999999999997, -2.2, -12.799999999999999, -17.3, -13.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9021854468649549, "mean_inference_ms": 1.1277348115781411, "mean_action_processing_ms": 0.06230346410270585, "mean_env_wait_ms": 5.17629305552739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 116000, "timesteps_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"sample_time_ms": 14334.868, "sample_throughput": 279.04, "load_time_ms": 0.347, "load_throughput": 11537076.056, "learn_time_ms": 6550.221, "learn_throughput": 610.666, "update_time_ms": 1.454}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.10130446347237755, "policy_loss": 0.002834089853430307, "vf_loss": 9.706675587930986, "vf_explained_var": 0.21493964246524278, "kl": 0.007018102313499003, "entropy": 0.3460814004143079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 116000, "num_agent_steps_sampled": 116000, "num_steps_trained": 116000, "num_agent_steps_trained": 116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1160, "training_iteration": 29, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-48-48", "timestamp": 1643665728, "time_this_iter_s": 13.80003809928894, "time_total_s": 405.91404151916504, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 405.91404151916504, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.65263157894737, "ram_util_percent": 73.47368421052634}}
{"episode_reward_max": -2.2, "episode_reward_min": -132.2000000000001, "episode_reward_mean": -14.738, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.9, -15.4, -5.300000000000001, -4.300000000000001, -15.0, -7.2, -45.3, -42.3, -132.2000000000001, -10.500000000000002, -10.2, -19.700000000000003, -20.2, -7.999999999999998, -9.3, -7.2, -6.2, -18.3, -5.1, -12.3, -18.0, -11.599999999999996, -7.300000000000001, -6.3999999999999995, -7.199999999999999, -13.899999999999999, -6.5, -10.2, -16.999999999999993, -12.3, -13.3, -11.300000000000002, -7.0, -6.999999999999999, -17.9, -15.799999999999999, -4.4, -14.3, -10.5, -8.899999999999999, -11.2, -11.2, -29.500000000000007, -13.7, -9.499999999999991, -19.8, -10.599999999999998, -6.300000000000001, -5.300000000000001, -10.3, -14.299999999999999, -13.7, -3.3, -11.0, -8.600000000000001, -11.399999999999997, -2.2, -12.799999999999999, -17.3, -13.2, -14.899999999999999, -12.3, -25.900000000000006, -7.300000000000001, -8.7, -18.099999999999998, -11.299999999999997, -7.4, -14.3, -5.3, -20.6, -43.1, -11.4, -9.2, -17.3, -7.3999999999999995, -17.4, -11.3, -9.399999999999999, -12.999999999999996, -9.2, -8.2, -9.199999999999998, -14.3, -4.4, -9.100000000000001, -9.8, -7.3, -90.4, -17.399999999999984, -13.3, -5.300000000000001, -4.300000000000001, -16.599999999999998, -9.1, -21.3, -10.299999999999999, -7.199999999999999, -10.3, -54.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9040555859444908, "mean_inference_ms": 1.129584480756459, "mean_action_processing_ms": 0.06238976700476851, "mean_env_wait_ms": 5.184122683435121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 14365.324, "sample_throughput": 278.448, "load_time_ms": 0.35, "load_throughput": 11417732.408, "learn_time_ms": 6640.115, "learn_throughput": 602.399, "update_time_ms": 1.461}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5604648654617028, "policy_loss": -0.025817021256893554, "vf_loss": 58.48016530416345, "vf_explained_var": 0.2368037571189224, "kl": 0.007401243417120442, "entropy": 0.2993458660699988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1200, "training_iteration": 30, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-49-04", "timestamp": 1643665744, "time_this_iter_s": 15.52336311340332, "time_total_s": 421.43740463256836, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 421.43740463256836, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 31.89545454545454, "ram_util_percent": 73.85909090909094}}
{"episode_reward_max": -2.2, "episode_reward_min": -90.4, "episode_reward_mean": -13.858000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -11.2, -29.500000000000007, -13.7, -9.499999999999991, -19.8, -10.599999999999998, -6.300000000000001, -5.300000000000001, -10.3, -14.299999999999999, -13.7, -3.3, -11.0, -8.600000000000001, -11.399999999999997, -2.2, -12.799999999999999, -17.3, -13.2, -14.899999999999999, -12.3, -25.900000000000006, -7.300000000000001, -8.7, -18.099999999999998, -11.299999999999997, -7.4, -14.3, -5.3, -20.6, -43.1, -11.4, -9.2, -17.3, -7.3999999999999995, -17.4, -11.3, -9.399999999999999, -12.999999999999996, -9.2, -8.2, -9.199999999999998, -14.3, -4.4, -9.100000000000001, -9.8, -7.3, -90.4, -17.399999999999984, -13.3, -5.300000000000001, -4.300000000000001, -16.599999999999998, -9.1, -21.3, -10.299999999999999, -7.199999999999999, -10.3, -54.3, -8.099999999999998, -19.4, -5.2, -9.599999999999998, -18.3, -14.6, -17.599999999999994, -15.0, -12.7, -10.2, -13.599999999999993, -20.799999999999997, -12.2, -11.100000000000001, -7.2, -18.70000000000001, -12.899999999999999, -4.7, -14.5, -11.2, -6.999999999999998, -9.2, -14.599999999999998, -10.3, -18.500000000000004, -22.7, -10.3, -9.3, -19.6, -12.5, -16.2, -13.2, -9.299999999999999, -12.5, -13.199999999999987, -7.3, -6.1, -36.4, -8.399999999999999, -19.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9045878990738597, "mean_inference_ms": 1.1317045115848081, "mean_action_processing_ms": 0.0624752741431948, "mean_env_wait_ms": 5.191414207663395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 124000, "timesteps_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"sample_time_ms": 14489.785, "sample_throughput": 276.057, "load_time_ms": 0.342, "load_throughput": 11687367.468, "learn_time_ms": 6664.41, "learn_throughput": 600.203, "update_time_ms": 1.467}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.13916276464819588, "policy_loss": -0.0035714498871276456, "vf_loss": 14.15136540269339, "vf_explained_var": 0.22851650977647434, "kl": 0.006102819149907659, "entropy": 0.335778552454005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124000, "num_agent_steps_sampled": 124000, "num_steps_trained": 124000, "num_agent_steps_trained": 124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1240, "training_iteration": 31, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-49-18", "timestamp": 1643665758, "time_this_iter_s": 14.302702903747559, "time_total_s": 435.7401075363159, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 435.7401075363159, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.123809523809523, "ram_util_percent": 74.34761904761903}}
{"episode_reward_max": -2.8000000000000007, "episode_reward_min": -90.4, "episode_reward_mean": -14.807999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -8.2, -9.199999999999998, -14.3, -4.4, -9.100000000000001, -9.8, -7.3, -90.4, -17.399999999999984, -13.3, -5.300000000000001, -4.300000000000001, -16.599999999999998, -9.1, -21.3, -10.299999999999999, -7.199999999999999, -10.3, -54.3, -8.099999999999998, -19.4, -5.2, -9.599999999999998, -18.3, -14.6, -17.599999999999994, -15.0, -12.7, -10.2, -13.599999999999993, -20.799999999999997, -12.2, -11.100000000000001, -7.2, -18.70000000000001, -12.899999999999999, -4.7, -14.5, -11.2, -6.999999999999998, -9.2, -14.599999999999998, -10.3, -18.500000000000004, -22.7, -10.3, -9.3, -19.6, -12.5, -16.2, -13.2, -9.299999999999999, -12.5, -13.199999999999987, -7.3, -6.1, -36.4, -8.399999999999999, -19.5, -14.099999999999996, -7.2, -22.900000000000034, -10.6, -11.999999999999998, -2.8000000000000007, -14.499999999999998, -24.800000000000004, -23.6, -36.400000000000006, -11.2, -4.3, -43.5, -27.29999999999998, -6.300000000000001, -9.9, -17.699999999999996, -10.2, -22.9, -19.5, -8.2, -11.2, -15.499999999999998, -20.7, -12.0, -11.199999999999976, -14.299999999999997, -16.9, -7.499999999999999, -17.199999999999992, -19.5, -11.3, -22.900000000000006, -16.4, -18.89999999999999, -8.3, -9.5, -12.0, -5.300000000000001, -15.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904101596331709, "mean_inference_ms": 1.1330447710536597, "mean_action_processing_ms": 0.06252410558455351, "mean_env_wait_ms": 5.1950559296515015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 128000, "timesteps_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"sample_time_ms": 14515.999, "sample_throughput": 275.558, "load_time_ms": 0.342, "load_throughput": 11684925.477, "learn_time_ms": 6646.342, "learn_throughput": 601.835, "update_time_ms": 1.462}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1967899622640983, "policy_loss": -0.005772298726663795, "vf_loss": 20.091864326051486, "vf_explained_var": 0.19282256313549576, "kl": 0.008218109895240352, "entropy": 0.2856696650706312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 128000, "num_steps_trained": 128000, "num_agent_steps_trained": 128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1280, "training_iteration": 32, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-49-32", "timestamp": 1643665772, "time_this_iter_s": 13.820194721221924, "time_total_s": 449.56030225753784, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 449.56030225753784, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.578947368421055, "ram_util_percent": 74.1842105263158}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -45.8, "episode_reward_mean": -14.729999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999998, -9.2, -14.599999999999998, -10.3, -18.500000000000004, -22.7, -10.3, -9.3, -19.6, -12.5, -16.2, -13.2, -9.299999999999999, -12.5, -13.199999999999987, -7.3, -6.1, -36.4, -8.399999999999999, -19.5, -14.099999999999996, -7.2, -22.900000000000034, -10.6, -11.999999999999998, -2.8000000000000007, -14.499999999999998, -24.800000000000004, -23.6, -36.400000000000006, -11.2, -4.3, -43.5, -27.29999999999998, -6.300000000000001, -9.9, -17.699999999999996, -10.2, -22.9, -19.5, -8.2, -11.2, -15.499999999999998, -20.7, -12.0, -11.199999999999976, -14.299999999999997, -16.9, -7.499999999999999, -17.199999999999992, -19.5, -11.3, -22.900000000000006, -16.4, -18.89999999999999, -8.3, -9.5, -12.0, -5.300000000000001, -15.3, -9.3, -14.899999999999999, -22.3, -20.599999999999966, -9.3, -15.4, -14.699999999999998, -16.399999999999984, -10.1, -45.8, -12.2, -5.2, -2.3000000000000003, -15.899999999999997, -9.3, -15.599999999999998, -10.3, -31.4, -12.6, -10.699999999999996, -27.3, -10.2, -8.0, -9.6, -9.8, -11.2, -10.399999999999999, -17.700000000000003, -13.899999999999997, -12.3, -7.2, -3.6000000000000005, -10.3, -5.300000000000001, -14.799999999999999, -17.799999999999997, -42.399999999999906, -22.699999999999996, -6.3, -15.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9022271139697932, "mean_inference_ms": 1.1326552331093998, "mean_action_processing_ms": 0.06248765262336299, "mean_env_wait_ms": 5.192629979511705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 132000, "timesteps_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"sample_time_ms": 14480.23, "sample_throughput": 276.239, "load_time_ms": 0.346, "load_throughput": 11560129.539, "learn_time_ms": 6587.001, "learn_throughput": 607.257, "update_time_ms": 1.445}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2724071151526865, "policy_loss": -0.003184083049055389, "vf_loss": 27.432015617432132, "vf_explained_var": 0.010114374404312463, "kl": 0.0063552376494329646, "entropy": 0.3032888817050124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 132000, "num_agent_steps_sampled": 132000, "num_steps_trained": 132000, "num_agent_steps_trained": 132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1320, "training_iteration": 33, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-49-45", "timestamp": 1643665785, "time_this_iter_s": 13.449019193649292, "time_total_s": 463.00932145118713, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 463.00932145118713, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.863157894736844, "ram_util_percent": 74.1157894736842}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -45.8, "episode_reward_mean": -13.043, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -11.2, -15.499999999999998, -20.7, -12.0, -11.199999999999976, -14.299999999999997, -16.9, -7.499999999999999, -17.199999999999992, -19.5, -11.3, -22.900000000000006, -16.4, -18.89999999999999, -8.3, -9.5, -12.0, -5.300000000000001, -15.3, -9.3, -14.899999999999999, -22.3, -20.599999999999966, -9.3, -15.4, -14.699999999999998, -16.399999999999984, -10.1, -45.8, -12.2, -5.2, -2.3000000000000003, -15.899999999999997, -9.3, -15.599999999999998, -10.3, -31.4, -12.6, -10.699999999999996, -27.3, -10.2, -8.0, -9.6, -9.8, -11.2, -10.399999999999999, -17.700000000000003, -13.899999999999997, -12.3, -7.2, -3.6000000000000005, -10.3, -5.300000000000001, -14.799999999999999, -17.799999999999997, -42.399999999999906, -22.699999999999996, -6.3, -15.999999999999998, -4.2, -21.5, -10.2, -7.3, -13.999999999999998, -5.300000000000001, -17.4, -7.6, -11.3, -12.8, -10.2, -19.199999999999978, -19.300000000000004, -16.3, -13.800000000000002, -8.3, -13.2, -3.8000000000000003, -15.9, -10.899999999999999, -4.2, -12.3, -3.900000000000001, -12.999999999999996, -4.2, -13.2, -11.2, -18.0, -10.2, -10.3, -17.3, -8.3, -9.3, -8.2, -14.799999999999995, -12.3, -8.2, -3.2, -9.2, -15.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9000551968352964, "mean_inference_ms": 1.1316177464048325, "mean_action_processing_ms": 0.06242601552031523, "mean_env_wait_ms": 5.187698301121631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 136000, "timesteps_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"sample_time_ms": 14363.385, "sample_throughput": 278.486, "load_time_ms": 0.348, "load_throughput": 11486523.347, "learn_time_ms": 6582.333, "learn_throughput": 607.687, "update_time_ms": 1.454}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06783343920364014, "policy_loss": -0.016210580768404148, "vf_loss": 8.239387565915303, "vf_explained_var": 0.26922210621577436, "kl": 0.008250733926224366, "entropy": 0.3072606188315217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 136000, "num_agent_steps_sampled": 136000, "num_steps_trained": 136000, "num_agent_steps_trained": 136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1360, "training_iteration": 34, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-49-59", "timestamp": 1643665799, "time_this_iter_s": 13.578268766403198, "time_total_s": 476.58759021759033, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 476.58759021759033, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 23.535000000000004, "ram_util_percent": 74.10999999999999}}
{"episode_reward_max": -2.3, "episode_reward_min": -62.8, "episode_reward_mean": -12.993999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.3, -10.2, -8.0, -9.6, -9.8, -11.2, -10.399999999999999, -17.700000000000003, -13.899999999999997, -12.3, -7.2, -3.6000000000000005, -10.3, -5.300000000000001, -14.799999999999999, -17.799999999999997, -42.399999999999906, -22.699999999999996, -6.3, -15.999999999999998, -4.2, -21.5, -10.2, -7.3, -13.999999999999998, -5.300000000000001, -17.4, -7.6, -11.3, -12.8, -10.2, -19.199999999999978, -19.300000000000004, -16.3, -13.800000000000002, -8.3, -13.2, -3.8000000000000003, -15.9, -10.899999999999999, -4.2, -12.3, -3.900000000000001, -12.999999999999996, -4.2, -13.2, -11.2, -18.0, -10.2, -10.3, -17.3, -8.3, -9.3, -8.2, -14.799999999999995, -12.3, -8.2, -3.2, -9.2, -15.3, -26.4, -40.3, -30.600000000000005, -17.6, -9.6, -10.3, -62.8, -13.5, -20.799999999999997, -10.4, -10.6, -5.300000000000001, -15.3, -13.3, -9.999999999999993, -15.399999999999997, -40.3, -7.5, -4.4, -2.3000000000000003, -9.799999999999997, -7.1, -7.099999999999999, -5.1, -25.40000000000003, -4.800000000000001, -9.599999999999996, -3.3000000000000003, -10.2, -6.299999999999999, -15.099999999999998, -17.200000000000003, -2.3, -3.7000000000000006, -12.3, -17.5, -12.1, -9.3, -14.799999999999997, -13.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8987294075163615, "mean_inference_ms": 1.1307826801664393, "mean_action_processing_ms": 0.062374102847695866, "mean_env_wait_ms": 5.184089666911648, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 14373.675, "sample_throughput": 278.287, "load_time_ms": 0.353, "load_throughput": 11323714.903, "learn_time_ms": 6533.298, "learn_throughput": 612.248, "update_time_ms": 1.455}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4422792386143438, "policy_loss": -0.0015555638677230285, "vf_loss": 44.265221491936714, "vf_explained_var": -0.09000216248214886, "kl": 0.005912989740631969, "entropy": 0.252717004964749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1400, "training_iteration": 35, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-50-13", "timestamp": 1643665813, "time_this_iter_s": 13.834145784378052, "time_total_s": 490.4217360019684, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 490.4217360019684, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 24.009999999999998, "ram_util_percent": 74.21000000000001}}
{"episode_reward_max": -2.3, "episode_reward_min": -62.8, "episode_reward_mean": -12.841000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -12.3, -3.900000000000001, -12.999999999999996, -4.2, -13.2, -11.2, -18.0, -10.2, -10.3, -17.3, -8.3, -9.3, -8.2, -14.799999999999995, -12.3, -8.2, -3.2, -9.2, -15.3, -26.4, -40.3, -30.600000000000005, -17.6, -9.6, -10.3, -62.8, -13.5, -20.799999999999997, -10.4, -10.6, -5.300000000000001, -15.3, -13.3, -9.999999999999993, -15.399999999999997, -40.3, -7.5, -4.4, -2.3000000000000003, -9.799999999999997, -7.1, -7.099999999999999, -5.1, -25.40000000000003, -4.800000000000001, -9.599999999999996, -3.3000000000000003, -10.2, -6.299999999999999, -15.099999999999998, -17.200000000000003, -2.3, -3.7000000000000006, -12.3, -17.5, -12.1, -9.3, -14.799999999999997, -13.799999999999999, -19.199999999999996, -8.7, -10.3, -13.5, -13.4, -9.3, -13.399999999999997, -10.899999999999997, -12.499999999999993, -7.699999999999998, -15.499999999999995, -14.3, -10.3, -10.2, -8.3, -16.4, -18.5, -8.1, -11.1, -17.4, -14.499999999999998, -10.2, -7.3, -18.7, -15.399999999999999, -3.2, -8.2, -11.499999999999996, -15.2, -16.7, -10.1, -18.3, -3.7000000000000006, -13.2, -2.3000000000000003, -9.3, -7.800000000000001, -18.900000000000006, -9.2, -41.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8982787739996658, "mean_inference_ms": 1.1307863084218674, "mean_action_processing_ms": 0.06236402022058669, "mean_env_wait_ms": 5.183223929554941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 14303.665, "sample_throughput": 279.649, "load_time_ms": 0.349, "load_throughput": 11462978.956, "learn_time_ms": 6559.215, "learn_throughput": 609.829, "update_time_ms": 1.473}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12641166939189838, "policy_loss": -0.007090181765216653, "vf_loss": 13.217916501273391, "vf_explained_var": 0.23261001148531513, "kl": 0.006613423212796553, "entropy": 0.28660893139819943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 144000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1440, "training_iteration": 36, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-50-27", "timestamp": 1643665827, "time_this_iter_s": 14.258846998214722, "time_total_s": 504.6805830001831, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 504.6805830001831, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.29, "ram_util_percent": 74.18}}
{"episode_reward_max": -2.2, "episode_reward_min": -85.4, "episode_reward_mean": -13.455000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999997, -7.1, -7.099999999999999, -5.1, -25.40000000000003, -4.800000000000001, -9.599999999999996, -3.3000000000000003, -10.2, -6.299999999999999, -15.099999999999998, -17.200000000000003, -2.3, -3.7000000000000006, -12.3, -17.5, -12.1, -9.3, -14.799999999999997, -13.799999999999999, -19.199999999999996, -8.7, -10.3, -13.5, -13.4, -9.3, -13.399999999999997, -10.899999999999997, -12.499999999999993, -7.699999999999998, -15.499999999999995, -14.3, -10.3, -10.2, -8.3, -16.4, -18.5, -8.1, -11.1, -17.4, -14.499999999999998, -10.2, -7.3, -18.7, -15.399999999999999, -3.2, -8.2, -11.499999999999996, -15.2, -16.7, -10.1, -18.3, -3.7000000000000006, -13.2, -2.3000000000000003, -9.3, -7.800000000000001, -18.900000000000006, -9.2, -41.3, -4.300000000000001, -13.499999999999998, -11.3, -10.899999999999999, -24.3, -19.599999999999998, -7.2, -12.3, -16.3, -12.899999999999999, -8.2, -16.3, -12.799999999999995, -17.7, -21.5, -21.6, -7.199999999999999, -2.2, -49.00000000000001, -22.0, -9.3, -18.600000000000005, -10.7, -18.3, -10.899999999999999, -15.199999999999996, -4.9, -28.2, -10.799999999999999, -21.10000000000001, -3.3, -10.3, -20.30000000000003, -6.1, -22.599999999999998, -85.4, -3.5, -5.699999999999999, -10.2, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8977082006794994, "mean_inference_ms": 1.131110702482969, "mean_action_processing_ms": 0.062377289551558295, "mean_env_wait_ms": 5.183567335349195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 148000, "timesteps_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"sample_time_ms": 14221.137, "sample_throughput": 281.271, "load_time_ms": 0.357, "load_throughput": 11218466.065, "learn_time_ms": 6448.129, "learn_throughput": 620.335, "update_time_ms": 1.453}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.5178150030282346, "policy_loss": -0.011032568029458484, "vf_loss": 52.70684799430191, "vf_explained_var": 0.09864758592779918, "kl": 0.008895480694563732, "entropy": 0.24583084509577802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148000, "num_agent_steps_sampled": 148000, "num_steps_trained": 148000, "num_agent_steps_trained": 148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1480, "training_iteration": 37, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-50-41", "timestamp": 1643665841, "time_this_iter_s": 13.690736055374146, "time_total_s": 518.3713190555573, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 518.3713190555573, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 28.836842105263155, "ram_util_percent": 74.22105263157894}}
{"episode_reward_max": -2.2, "episode_reward_min": -85.4, "episode_reward_mean": -13.280999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.499999999999998, -10.2, -7.3, -18.7, -15.399999999999999, -3.2, -8.2, -11.499999999999996, -15.2, -16.7, -10.1, -18.3, -3.7000000000000006, -13.2, -2.3000000000000003, -9.3, -7.800000000000001, -18.900000000000006, -9.2, -41.3, -4.300000000000001, -13.499999999999998, -11.3, -10.899999999999999, -24.3, -19.599999999999998, -7.2, -12.3, -16.3, -12.899999999999999, -8.2, -16.3, -12.799999999999995, -17.7, -21.5, -21.6, -7.199999999999999, -2.2, -49.00000000000001, -22.0, -9.3, -18.600000000000005, -10.7, -18.3, -10.899999999999999, -15.199999999999996, -4.9, -28.2, -10.799999999999999, -21.10000000000001, -3.3, -10.3, -20.30000000000003, -6.1, -22.599999999999998, -85.4, -3.5, -5.699999999999999, -10.2, -8.2, -4.4, -10.3, -4.2, -17.700000000000003, -5.1000000000000005, -22.099999999999987, -7.3, -4.300000000000001, -9.2, -20.499999999999996, -16.4, -9.2, -5.300000000000001, -16.4, -13.600000000000001, -9.2, -7.3, -10.3, -9.7, -15.2, -10.2, -4.3, -10.2, -7.6, -12.9, -11.3, -12.2, -3.2, -10.0, -10.099999999999998, -16.199999999999974, -19.699999999999996, -19.9, -4.300000000000001, -17.7, -13.899999999999997, -12.299999999999999, -8.2, -6.499999999999999, -9.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8983563221881813, "mean_inference_ms": 1.1332253971776063, "mean_action_processing_ms": 0.06248890330892797, "mean_env_wait_ms": 5.192544024614139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 152000, "timesteps_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"sample_time_ms": 14176.829, "sample_throughput": 282.151, "load_time_ms": 0.357, "load_throughput": 11190779.082, "learn_time_ms": 6510.709, "learn_throughput": 614.372, "update_time_ms": 1.445}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.07481451750512645, "policy_loss": -0.00688708423967323, "vf_loss": 8.001677381864159, "vf_explained_var": 0.32118015263670235, "kl": 0.008424151862142812, "entropy": 0.28667917572041995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 152000, "num_agent_steps_sampled": 152000, "num_steps_trained": 152000, "num_agent_steps_trained": 152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1520, "training_iteration": 38, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-50-57", "timestamp": 1643665857, "time_this_iter_s": 15.981254816055298, "time_total_s": 534.3525738716125, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 534.3525738716125, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 37.91304347826087, "ram_util_percent": 73.83478260869566}}
{"episode_reward_max": -3.2, "episode_reward_min": -85.4, "episode_reward_mean": -12.788999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -18.600000000000005, -10.7, -18.3, -10.899999999999999, -15.199999999999996, -4.9, -28.2, -10.799999999999999, -21.10000000000001, -3.3, -10.3, -20.30000000000003, -6.1, -22.599999999999998, -85.4, -3.5, -5.699999999999999, -10.2, -8.2, -4.4, -10.3, -4.2, -17.700000000000003, -5.1000000000000005, -22.099999999999987, -7.3, -4.300000000000001, -9.2, -20.499999999999996, -16.4, -9.2, -5.300000000000001, -16.4, -13.600000000000001, -9.2, -7.3, -10.3, -9.7, -15.2, -10.2, -4.3, -10.2, -7.6, -12.9, -11.3, -12.2, -3.2, -10.0, -10.099999999999998, -16.199999999999974, -19.699999999999996, -19.9, -4.300000000000001, -17.7, -13.899999999999997, -12.299999999999999, -8.2, -6.499999999999999, -9.999999999999998, -17.599999999999994, -8.3, -31.3, -11.5, -20.700000000000003, -13.1, -3.3, -7.3, -10.599999999999998, -7.2, -19.700000000000003, -26.9, -8.999999999999996, -9.3, -12.799999999999999, -8.3, -10.499999999999998, -13.099999999999996, -9.2, -13.999999999999995, -12.2, -17.5, -13.5, -10.099999999999998, -22.500000000000004, -14.999999999999998, -3.2, -12.099999999999996, -10.3, -18.600000000000005, -6.3999999999999995, -8.799999999999999, -22.9, -8.2, -16.6, -11.6, -18.999999999999986, -10.3, -3.9, -10.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8984394370366394, "mean_inference_ms": 1.135058459882612, "mean_action_processing_ms": 0.06258346121921714, "mean_env_wait_ms": 5.200988098311585, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 156000, "timesteps_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"sample_time_ms": 14249.934, "sample_throughput": 280.703, "load_time_ms": 0.347, "load_throughput": 11513324.183, "learn_time_ms": 6500.755, "learn_throughput": 615.313, "update_time_ms": 1.414}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1234624009444228, "policy_loss": 0.005005880114772627, "vf_loss": 11.696116666383642, "vf_explained_var": 0.3374537350669984, "kl": 0.00747678320509964, "entropy": 0.26801067010689805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156000, "num_agent_steps_sampled": 156000, "num_steps_trained": 156000, "num_agent_steps_trained": 156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1560, "training_iteration": 39, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-51-10", "timestamp": 1643665870, "time_this_iter_s": 13.805443048477173, "time_total_s": 548.1580169200897, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 548.1580169200897, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.695000000000004, "ram_util_percent": 73.695}}
{"episode_reward_max": -2.2, "episode_reward_min": -172.99999999999997, "episode_reward_mean": -13.860999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -4.3, -10.2, -7.6, -12.9, -11.3, -12.2, -3.2, -10.0, -10.099999999999998, -16.199999999999974, -19.699999999999996, -19.9, -4.300000000000001, -17.7, -13.899999999999997, -12.299999999999999, -8.2, -6.499999999999999, -9.999999999999998, -17.599999999999994, -8.3, -31.3, -11.5, -20.700000000000003, -13.1, -3.3, -7.3, -10.599999999999998, -7.2, -19.700000000000003, -26.9, -8.999999999999996, -9.3, -12.799999999999999, -8.3, -10.499999999999998, -13.099999999999996, -9.2, -13.999999999999995, -12.2, -17.5, -13.5, -10.099999999999998, -22.500000000000004, -14.999999999999998, -3.2, -12.099999999999996, -10.3, -18.600000000000005, -6.3999999999999995, -8.799999999999999, -22.9, -8.2, -16.6, -11.6, -18.999999999999986, -10.3, -3.9, -10.5, -16.599999999999998, -13.099999999999998, -12.3, -8.399999999999999, -14.4, -8.2, -6.8, -11.899999999999999, -4.2, -9.2, -172.99999999999997, -6.300000000000001, -8.2, -20.099999999999998, -9.2, -24.80000000000002, -8.8, -2.2, -13.999999999999998, -8.8, -9.2, -12.3, -12.6, -7.799999999999998, -6.3, -12.2, -9.499999999999998, -11.400000000000002, -9.3, -28.0, -22.500000000000007, -11.3, -14.2, -4.300000000000001, -8.3, -10.3, -29.3, -14.5, -17.4, -17.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8995469498176589, "mean_inference_ms": 1.1361383496009938, "mean_action_processing_ms": 0.06263873468265196, "mean_env_wait_ms": 5.205370368643051, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 14201.557, "sample_throughput": 281.659, "load_time_ms": 0.345, "load_throughput": 11604105.685, "learn_time_ms": 6420.18, "learn_throughput": 623.036, "update_time_ms": 1.405}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 1.4114840110005331, "policy_loss": -0.005928437724228828, "vf_loss": 141.64445326610277, "vf_explained_var": 0.16120760934327238, "kl": 0.004839751205261418, "entropy": 0.2814821594024217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1600, "training_iteration": 40, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-51-25", "timestamp": 1643665885, "time_this_iter_s": 14.330290794372559, "time_total_s": 562.4883077144623, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 562.4883077144623, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.525000000000006, "ram_util_percent": 73.93999999999998}}
{"episode_reward_max": -1.3, "episode_reward_min": -172.99999999999997, "episode_reward_mean": -14.167, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.2, -17.5, -13.5, -10.099999999999998, -22.500000000000004, -14.999999999999998, -3.2, -12.099999999999996, -10.3, -18.600000000000005, -6.3999999999999995, -8.799999999999999, -22.9, -8.2, -16.6, -11.6, -18.999999999999986, -10.3, -3.9, -10.5, -16.599999999999998, -13.099999999999998, -12.3, -8.399999999999999, -14.4, -8.2, -6.8, -11.899999999999999, -4.2, -9.2, -172.99999999999997, -6.300000000000001, -8.2, -20.099999999999998, -9.2, -24.80000000000002, -8.8, -2.2, -13.999999999999998, -8.8, -9.2, -12.3, -12.6, -7.799999999999998, -6.3, -12.2, -9.499999999999998, -11.400000000000002, -9.3, -28.0, -22.500000000000007, -11.3, -14.2, -4.300000000000001, -8.3, -10.3, -29.3, -14.5, -17.4, -17.3, -9.1, -11.799999999999999, -10.3, -5.2, -20.0, -3.3000000000000003, -69.40000000000009, -8.5, -5.1, -23.600000000000005, -3.4000000000000004, -8.3, -12.3, -17.499999999999993, -9.399999999999999, -3.2, -11.600000000000001, -8.3, -8.2, -1.3, -14.999999999999993, -17.2, -13.499999999999996, -17.3, -24.0, -14.399999999999999, -12.099999999999998, -10.1, -7.3, -2.2, -20.800000000000022, -1.3, -21.400000000000002, -20.2, -14.2, -9.399999999999999, -14.899999999999999, -4.3, -10.3, -15.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8990060958141819, "mean_inference_ms": 1.1362341043008184, "mean_action_processing_ms": 0.06263419047023387, "mean_env_wait_ms": 5.205513391760361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 164000, "timesteps_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"sample_time_ms": 14091.898, "sample_throughput": 283.851, "load_time_ms": 0.345, "load_throughput": 11590477.375, "learn_time_ms": 6378.567, "learn_throughput": 627.1, "update_time_ms": 1.366}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.32599818222036947, "policy_loss": -0.008308378869407279, "vf_loss": 33.36773249282632, "vf_explained_var": -0.03506527728931878, "kl": 0.006292412867291673, "entropy": 0.295412932200137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 164000, "num_agent_steps_sampled": 164000, "num_steps_trained": 164000, "num_agent_steps_trained": 164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1640, "training_iteration": 41, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-51-38", "timestamp": 1643665898, "time_this_iter_s": 13.597517728805542, "time_total_s": 576.0858254432678, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 576.0858254432678, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.06842105263158, "ram_util_percent": 73.70526315789473}}
{"episode_reward_max": -1.3, "episode_reward_min": -69.40000000000009, "episode_reward_mean": -13.199000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -12.3, -12.6, -7.799999999999998, -6.3, -12.2, -9.499999999999998, -11.400000000000002, -9.3, -28.0, -22.500000000000007, -11.3, -14.2, -4.300000000000001, -8.3, -10.3, -29.3, -14.5, -17.4, -17.3, -9.1, -11.799999999999999, -10.3, -5.2, -20.0, -3.3000000000000003, -69.40000000000009, -8.5, -5.1, -23.600000000000005, -3.4000000000000004, -8.3, -12.3, -17.499999999999993, -9.399999999999999, -3.2, -11.600000000000001, -8.3, -8.2, -1.3, -14.999999999999993, -17.2, -13.499999999999996, -17.3, -24.0, -14.399999999999999, -12.099999999999998, -10.1, -7.3, -2.2, -20.800000000000022, -1.3, -21.400000000000002, -20.2, -14.2, -9.399999999999999, -14.899999999999999, -4.3, -10.3, -15.3, -4.9, -20.600000000000005, -3.3, -4.700000000000001, -9.2, -19.699999999999992, -12.3, -10.3, -11.399999999999999, -4.300000000000001, -15.6, -11.299999999999992, -11.799999999999999, -24.4, -4.2, -29.2, -10.2, -25.700000000000003, -25.99999999999997, -14.899999999999999, -21.900000000000006, -9.2, -15.7, -7.1999999999999975, -7.3, -13.299999999999999, -13.999999999999988, -9.2, -19.900000000000006, -8.3, -7.3, -10.499999999999998, -10.899999999999991, -30.2, -14.7, -17.7, -13.5, -11.2, -13.699999999999998, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8987675801819415, "mean_inference_ms": 1.1377736241758618, "mean_action_processing_ms": 0.06264668365805777, "mean_env_wait_ms": 5.207546656237652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"sample_time_ms": 14102.021, "sample_throughput": 283.647, "load_time_ms": 0.346, "load_throughput": 11546604.267, "learn_time_ms": 6431.622, "learn_throughput": 621.927, "update_time_ms": 1.38}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.15948192154367766, "policy_loss": -0.004919369863246077, "vf_loss": 16.37506967513792, "vf_explained_var": 0.11481500460255531, "kl": 0.006505983163372996, "entropy": 0.24928079908413273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 168000, "num_agent_steps_trained": 168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1680, "training_iteration": 42, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-51-53", "timestamp": 1643665913, "time_this_iter_s": 14.872030019760132, "time_total_s": 590.957855463028, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 590.957855463028, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.154545454545453, "ram_util_percent": 73.85}}
{"episode_reward_max": -1.3, "episode_reward_min": -32.90000000000001, "episode_reward_mean": -12.753000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.999999999999993, -17.2, -13.499999999999996, -17.3, -24.0, -14.399999999999999, -12.099999999999998, -10.1, -7.3, -2.2, -20.800000000000022, -1.3, -21.400000000000002, -20.2, -14.2, -9.399999999999999, -14.899999999999999, -4.3, -10.3, -15.3, -4.9, -20.600000000000005, -3.3, -4.700000000000001, -9.2, -19.699999999999992, -12.3, -10.3, -11.399999999999999, -4.300000000000001, -15.6, -11.299999999999992, -11.799999999999999, -24.4, -4.2, -29.2, -10.2, -25.700000000000003, -25.99999999999997, -14.899999999999999, -21.900000000000006, -9.2, -15.7, -7.1999999999999975, -7.3, -13.299999999999999, -13.999999999999988, -9.2, -19.900000000000006, -8.3, -7.3, -10.499999999999998, -10.899999999999991, -30.2, -14.7, -17.7, -13.5, -11.2, -13.699999999999998, -7.2, -9.3, -12.7, -3.3, -13.299999999999999, -9.800000000000002, -10.499999999999996, -13.7, -8.3, -5.2, -6.300000000000001, -32.90000000000001, -14.499999999999998, -9.2, -16.099999999999998, -6.2, -15.5, -11.799999999999999, -8.3, -15.799999999999997, -15.7, -10.4, -19.1, -5.3, -13.499999999999996, -16.2, -16.3, -6.2, -11.3, -15.399999999999977, -11.2, -10.2, -2.9000000000000004, -9.299999999999997, -9.2, -18.9, -14.399999999999999, -9.2, -20.2, -3.2, -12.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8997719665538279, "mean_inference_ms": 1.1396310318308653, "mean_action_processing_ms": 0.06267277895306132, "mean_env_wait_ms": 5.21045883369071, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 172000, "timesteps_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"sample_time_ms": 14216.21, "sample_throughput": 281.369, "load_time_ms": 0.346, "load_throughput": 11569695.883, "learn_time_ms": 6470.993, "learn_throughput": 618.143, "update_time_ms": 1.393}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.09842798185725045, "policy_loss": -0.006398918874241331, "vf_loss": 10.322938620275067, "vf_explained_var": 0.22061663763497466, "kl": 0.015975152625337472, "entropy": 0.3119445066298208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172000, "num_agent_steps_sampled": 172000, "num_steps_trained": 172000, "num_agent_steps_trained": 172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1720, "training_iteration": 43, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-52-08", "timestamp": 1643665928, "time_this_iter_s": 14.452481031417847, "time_total_s": 605.4103364944458, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 605.4103364944458, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 28.555, "ram_util_percent": 73.885}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -72.6, "episode_reward_mean": -13.575999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.900000000000006, -9.2, -15.7, -7.1999999999999975, -7.3, -13.299999999999999, -13.999999999999988, -9.2, -19.900000000000006, -8.3, -7.3, -10.499999999999998, -10.899999999999991, -30.2, -14.7, -17.7, -13.5, -11.2, -13.699999999999998, -7.2, -9.3, -12.7, -3.3, -13.299999999999999, -9.800000000000002, -10.499999999999996, -13.7, -8.3, -5.2, -6.300000000000001, -32.90000000000001, -14.499999999999998, -9.2, -16.099999999999998, -6.2, -15.5, -11.799999999999999, -8.3, -15.799999999999997, -15.7, -10.4, -19.1, -5.3, -13.499999999999996, -16.2, -16.3, -6.2, -11.3, -15.399999999999977, -11.2, -10.2, -2.9000000000000004, -9.299999999999997, -9.2, -18.9, -14.399999999999999, -9.2, -20.2, -3.2, -12.4, -15.599999999999998, -16.199999999999996, -23.199999999999996, -4.3, -6.2, -26.5, -11.6, -13.600000000000001, -4.2, -12.499999999999996, -20.399999999999995, -14.2, -6.2, -19.00000000000001, -15.999999999999998, -4.2, -21.100000000000005, -6.2, -26.2, -72.6, -14.5, -12.799999999999999, -6.2, -3.2, -4.2, -6.2, -12.6, -33.5, -17.3, -19.299999999999997, -7.699999999999999, -6.3, -15.699999999999998, -6.2, -3.3, -10.299999999999999, -10.6, -70.3, -9.699999999999998, -11.599999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.900542339250981, "mean_inference_ms": 1.1409025217044593, "mean_action_processing_ms": 0.06270643999441533, "mean_env_wait_ms": 5.213300556953924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 176000, "timesteps_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"sample_time_ms": 14261.714, "sample_throughput": 280.471, "load_time_ms": 0.344, "load_throughput": 11634685.16, "learn_time_ms": 6620.681, "learn_throughput": 604.167, "update_time_ms": 1.452}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.5131899347809213, "policy_loss": -0.01400615054393007, "vf_loss": 52.581065419412425, "vf_explained_var": -0.12366276780764261, "kl": 0.013854488994404007, "entropy": 0.26016059541093406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176000, "num_agent_steps_sampled": 176000, "num_steps_trained": 176000, "num_agent_steps_trained": 176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1760, "training_iteration": 44, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-52-23", "timestamp": 1643665943, "time_this_iter_s": 15.135425090789795, "time_total_s": 620.5457615852356, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 620.5457615852356, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 26.477272727272727, "ram_util_percent": 73.64999999999999}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -74.00000000000006, "episode_reward_mean": -13.974, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.4, -19.1, -5.3, -13.499999999999996, -16.2, -16.3, -6.2, -11.3, -15.399999999999977, -11.2, -10.2, -2.9000000000000004, -9.299999999999997, -9.2, -18.9, -14.399999999999999, -9.2, -20.2, -3.2, -12.4, -15.599999999999998, -16.199999999999996, -23.199999999999996, -4.3, -6.2, -26.5, -11.6, -13.600000000000001, -4.2, -12.499999999999996, -20.399999999999995, -14.2, -6.2, -19.00000000000001, -15.999999999999998, -4.2, -21.100000000000005, -6.2, -26.2, -72.6, -14.5, -12.799999999999999, -6.2, -3.2, -4.2, -6.2, -12.6, -33.5, -17.3, -19.299999999999997, -7.699999999999999, -6.3, -15.699999999999998, -6.2, -3.3, -10.299999999999999, -10.6, -70.3, -9.699999999999998, -11.599999999999996, -11.2, -8.9, -3.3, -11.4, -10.7, -7.300000000000001, -8.4, -74.00000000000006, -22.6, -6.2, -22.1, -10.799999999999999, -5.2, -9.3, -6.399999999999999, -22.9, -15.3, -12.3, -6.300000000000001, -13.2, -13.999999999999998, -7.499999999999999, -17.4, -14.3, -8.3, -6.300000000000001, -16.799999999999997, -5.300000000000001, -9.399999999999999, -3.2, -9.4, -21.3, -4.3, -33.3, -20.2, -14.7, -5.300000000000001, -15.399999999999999, -13.6, -13.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9021062844174171, "mean_inference_ms": 1.1423720149889447, "mean_action_processing_ms": 0.06279108265795263, "mean_env_wait_ms": 5.219658155907923, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 14509.447, "sample_throughput": 275.682, "load_time_ms": 0.338, "load_throughput": 11838283.94, "learn_time_ms": 6686.193, "learn_throughput": 598.248, "update_time_ms": 1.462}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.3341713669524598, "policy_loss": -0.0013527270476584152, "vf_loss": 33.47832203129286, "vf_explained_var": 0.1057064465938076, "kl": 0.007408825410880031, "entropy": 0.2974146555668564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1800, "training_iteration": 45, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-52-38", "timestamp": 1643665958, "time_this_iter_s": 15.460609674453735, "time_total_s": 636.0063712596893, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 636.0063712596893, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 35.50454545454546, "ram_util_percent": 73.14545454545454}}
{"episode_reward_max": -3.2, "episode_reward_min": -133.6, "episode_reward_mean": -13.644, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.5, -12.799999999999999, -6.2, -3.2, -4.2, -6.2, -12.6, -33.5, -17.3, -19.299999999999997, -7.699999999999999, -6.3, -15.699999999999998, -6.2, -3.3, -10.299999999999999, -10.6, -70.3, -9.699999999999998, -11.599999999999996, -11.2, -8.9, -3.3, -11.4, -10.7, -7.300000000000001, -8.4, -74.00000000000006, -22.6, -6.2, -22.1, -10.799999999999999, -5.2, -9.3, -6.399999999999999, -22.9, -15.3, -12.3, -6.300000000000001, -13.2, -13.999999999999998, -7.499999999999999, -17.4, -14.3, -8.3, -6.300000000000001, -16.799999999999997, -5.300000000000001, -9.399999999999999, -3.2, -9.4, -21.3, -4.3, -33.3, -20.2, -14.7, -5.300000000000001, -15.399999999999999, -13.6, -13.3, -11.799999999999999, -4.3, -15.299999999999994, -7.2, -10.9, -12.599999999999998, -6.799999999999999, -3.2, -16.099999999999998, -5.3, -7.2, -6.2, -17.1, -5.799999999999999, -5.3, -9.799999999999999, -19.499999999999996, -5.2, -11.799999999999999, -9.399999999999997, -14.7, -15.099999999999996, -9.2, -5.300000000000001, -8.3, -11.7, -8.7, -20.0, -5.300000000000001, -18.799999999999997, -6.499999999999999, -6.3999999999999995, -10.3, -18.600000000000005, -13.7, -20.4, -6.2, -11.899999999999999, -133.6, -6.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055325679309523, "mean_inference_ms": 1.1439157644069065, "mean_action_processing_ms": 0.06288533480285015, "mean_env_wait_ms": 5.226518008569392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 184000, "timesteps_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"sample_time_ms": 14627.064, "sample_throughput": 273.466, "load_time_ms": 0.335, "load_throughput": 11925800.398, "learn_time_ms": 6734.166, "learn_throughput": 593.986, "update_time_ms": 1.462}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.7851546701299207, "policy_loss": -0.004481795335048309, "vf_loss": 78.91871283272262, "vf_explained_var": 0.25494397045463646, "kl": 0.004493502591020364, "entropy": 0.2583809790111357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 184000, "num_agent_steps_sampled": 184000, "num_steps_trained": 184000, "num_agent_steps_trained": 184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1840, "training_iteration": 46, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-52-54", "timestamp": 1643665974, "time_this_iter_s": 15.260802030563354, "time_total_s": 651.2671732902527, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 651.2671732902527, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 29.822727272727267, "ram_util_percent": 73.65454545454546}}
{"episode_reward_max": -3.2, "episode_reward_min": -133.6, "episode_reward_mean": -12.943999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.999999999999998, -7.499999999999999, -17.4, -14.3, -8.3, -6.300000000000001, -16.799999999999997, -5.300000000000001, -9.399999999999999, -3.2, -9.4, -21.3, -4.3, -33.3, -20.2, -14.7, -5.300000000000001, -15.399999999999999, -13.6, -13.3, -11.799999999999999, -4.3, -15.299999999999994, -7.2, -10.9, -12.599999999999998, -6.799999999999999, -3.2, -16.099999999999998, -5.3, -7.2, -6.2, -17.1, -5.799999999999999, -5.3, -9.799999999999999, -19.499999999999996, -5.2, -11.799999999999999, -9.399999999999997, -14.7, -15.099999999999996, -9.2, -5.300000000000001, -8.3, -11.7, -8.7, -20.0, -5.300000000000001, -18.799999999999997, -6.499999999999999, -6.3999999999999995, -10.3, -18.600000000000005, -13.7, -20.4, -6.2, -11.899999999999999, -133.6, -6.3, -16.2, -7.3, -4.2, -9.6, -17.2, -33.4, -5.2, -16.4, -15.299999999999995, -11.2, -12.099999999999998, -10.2, -15.2, -7.3, -20.5, -11.799999999999999, -11.299999999999999, -12.4, -20.199999999999996, -9.3, -4.3, -6.300000000000001, -4.300000000000001, -7.800000000000001, -24.3, -18.2, -11.999999999999998, -5.2, -5.3, -22.4, -10.2, -16.799999999999997, -9.3, -5.3, -24.099999999999998, -8.6, -13.8, -21.199999999999996, -3.3, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9092426936842049, "mean_inference_ms": 1.1452248062966972, "mean_action_processing_ms": 0.06296367331897709, "mean_env_wait_ms": 5.2332024131040376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 188000, "timesteps_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"sample_time_ms": 14730.809, "sample_throughput": 271.54, "load_time_ms": 0.327, "load_throughput": 12223836.794, "learn_time_ms": 6789.146, "learn_throughput": 589.176, "update_time_ms": 1.482}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.12632698602323492, "policy_loss": -0.007029341980915076, "vf_loss": 13.291764867049391, "vf_explained_var": 0.2439837792227345, "kl": 0.00877364000984987, "entropy": 0.2611539300010409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 188000, "num_agent_steps_sampled": 188000, "num_steps_trained": 188000, "num_agent_steps_trained": 188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1880, "training_iteration": 47, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-53-08", "timestamp": 1643665988, "time_this_iter_s": 14.79747724533081, "time_total_s": 666.0646505355835, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 666.0646505355835, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 33.54285714285714, "ram_util_percent": 73.66666666666669}}
{"episode_reward_max": -3.2, "episode_reward_min": -133.6, "episode_reward_mean": -12.848999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.7, -15.099999999999996, -9.2, -5.300000000000001, -8.3, -11.7, -8.7, -20.0, -5.300000000000001, -18.799999999999997, -6.499999999999999, -6.3999999999999995, -10.3, -18.600000000000005, -13.7, -20.4, -6.2, -11.899999999999999, -133.6, -6.3, -16.2, -7.3, -4.2, -9.6, -17.2, -33.4, -5.2, -16.4, -15.299999999999995, -11.2, -12.099999999999998, -10.2, -15.2, -7.3, -20.5, -11.799999999999999, -11.299999999999999, -12.4, -20.199999999999996, -9.3, -4.3, -6.300000000000001, -4.300000000000001, -7.800000000000001, -24.3, -18.2, -11.999999999999998, -5.2, -5.3, -22.4, -10.2, -16.799999999999997, -9.3, -5.3, -24.099999999999998, -8.6, -13.8, -21.199999999999996, -3.3, -10.3, -14.5, -12.2, -6.699999999999999, -13.599999999999998, -4.300000000000001, -11.1, -8.4, -7.2, -8.5, -5.2, -4.4, -16.099999999999998, -11.799999999999999, -19.0, -11.3, -8.8, -3.3, -23.2, -3.3, -10.099999999999998, -13.5, -11.7, -10.899999999999999, -3.3, -8.9, -7.2, -26.2, -13.099999999999998, -20.7, -14.5, -14.299999999999997, -3.2, -14.600000000000001, -13.199999999999998, -4.2, -14.699999999999983, -8.2, -3.3, -22.6, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9113917176122799, "mean_inference_ms": 1.1459240405623794, "mean_action_processing_ms": 0.06301740263951552, "mean_env_wait_ms": 5.237507672003394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 14689.436, "sample_throughput": 272.305, "load_time_ms": 0.325, "load_throughput": 12298208.474, "learn_time_ms": 6728.33, "learn_throughput": 594.501, "update_time_ms": 1.484}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.07641982310301354, "policy_loss": -0.011846112214549575, "vf_loss": 8.791132746204253, "vf_explained_var": 0.20322675884410898, "kl": 0.007092246803694439, "entropy": 0.20020446762122135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 192000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1920, "training_iteration": 48, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-53-23", "timestamp": 1643666003, "time_this_iter_s": 14.402545690536499, "time_total_s": 680.46719622612, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 680.46719622612, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 27.53, "ram_util_percent": 73.87}}
{"episode_reward_max": -3.2, "episode_reward_min": -26.4, "episode_reward_mean": -11.036, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -6.300000000000001, -4.300000000000001, -7.800000000000001, -24.3, -18.2, -11.999999999999998, -5.2, -5.3, -22.4, -10.2, -16.799999999999997, -9.3, -5.3, -24.099999999999998, -8.6, -13.8, -21.199999999999996, -3.3, -10.3, -14.5, -12.2, -6.699999999999999, -13.599999999999998, -4.300000000000001, -11.1, -8.4, -7.2, -8.5, -5.2, -4.4, -16.099999999999998, -11.799999999999999, -19.0, -11.3, -8.8, -3.3, -23.2, -3.3, -10.099999999999998, -13.5, -11.7, -10.899999999999999, -3.3, -8.9, -7.2, -26.2, -13.099999999999998, -20.7, -14.5, -14.299999999999997, -3.2, -14.600000000000001, -13.199999999999998, -4.2, -14.699999999999983, -8.2, -3.3, -22.6, -3.3, -17.7, -15.499999999999996, -12.799999999999999, -5.2, -12.799999999999999, -5.300000000000001, -22.400000000000013, -3.4, -9.9, -4.3, -5.300000000000001, -4.2, -4.2, -6.300000000000001, -3.3, -19.799999999999997, -16.4, -17.0, -10.3, -15.999999999999998, -8.2, -4.3, -12.099999999999985, -3.3, -11.399999999999999, -8.2, -26.4, -18.899999999999995, -4.300000000000001, -22.5, -4.2, -7.2, -3.2, -9.199999999999998, -18.500000000000004, -6.300000000000001, -20.9, -16.099999999999994, -6.3, -12.399999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9116167924233202, "mean_inference_ms": 1.1467719444687423, "mean_action_processing_ms": 0.0630740161655705, "mean_env_wait_ms": 5.24241062781877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 196000, "timesteps_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"sample_time_ms": 14677.564, "sample_throughput": 272.525, "load_time_ms": 0.335, "load_throughput": 11931737.43, "learn_time_ms": 6771.234, "learn_throughput": 590.734, "update_time_ms": 1.512}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.09761634515097706, "policy_loss": 1.9899323101966613e-05, "vf_loss": 9.732259249623104, "vf_explained_var": 0.2322759812237114, "kl": 0.005477135786539463, "entropy": 0.19461799283982606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 196000, "num_agent_steps_sampled": 196000, "num_steps_trained": 196000, "num_agent_steps_trained": 196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1960, "training_iteration": 49, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-53-38", "timestamp": 1643666018, "time_this_iter_s": 14.725993871688843, "time_total_s": 695.1931900978088, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 695.1931900978088, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 29.2095238095238, "ram_util_percent": 73.79047619047617}}
{"episode_reward_max": -3.2, "episode_reward_min": -62.4, "episode_reward_mean": -11.75, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.5, -11.7, -10.899999999999999, -3.3, -8.9, -7.2, -26.2, -13.099999999999998, -20.7, -14.5, -14.299999999999997, -3.2, -14.600000000000001, -13.199999999999998, -4.2, -14.699999999999983, -8.2, -3.3, -22.6, -3.3, -17.7, -15.499999999999996, -12.799999999999999, -5.2, -12.799999999999999, -5.300000000000001, -22.400000000000013, -3.4, -9.9, -4.3, -5.300000000000001, -4.2, -4.2, -6.300000000000001, -3.3, -19.799999999999997, -16.4, -17.0, -10.3, -15.999999999999998, -8.2, -4.3, -12.099999999999985, -3.3, -11.399999999999999, -8.2, -26.4, -18.899999999999995, -4.300000000000001, -22.5, -4.2, -7.2, -3.2, -9.199999999999998, -18.500000000000004, -6.300000000000001, -20.9, -16.099999999999994, -6.3, -12.399999999999997, -5.2, -12.399999999999999, -17.600000000000005, -6.2, -6.300000000000001, -12.5, -35.6, -12.5, -10.999999999999998, -21.3, -26.699999999999992, -15.3, -10.099999999999998, -10.600000000000001, -21.9, -9.4, -14.6, -9.299999999999997, -5.800000000000001, -4.2, -4.300000000000001, -62.4, -6.4, -15.599999999999996, -4.300000000000001, -6.000000000000001, -9.0, -21.9, -4.799999999999999, -7.599999999999999, -3.2, -14.099999999999998, -3.2, -9.0, -13.8, -14.2, -10.1, -8.899999999999999, -11.899999999999999, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9108621575370133, "mean_inference_ms": 1.14711379792127, "mean_action_processing_ms": 0.06309367773590296, "mean_env_wait_ms": 5.244622919667839, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 14689.08, "sample_throughput": 272.311, "load_time_ms": 0.331, "load_throughput": 12093430.404, "learn_time_ms": 6749.972, "learn_throughput": 592.595, "update_time_ms": 1.517}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.3190756446701945, "policy_loss": -0.006784156340009142, "vf_loss": 32.5449422527385, "vf_explained_var": 0.07334908740494842, "kl": 0.00820775929737865, "entropy": 0.19956166950525134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2000, "training_iteration": 50, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-53-51", "timestamp": 1643666031, "time_this_iter_s": 13.802149772644043, "time_total_s": 708.9953398704529, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 708.9953398704529, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 23.48, "ram_util_percent": 73.85499999999999}}
{"episode_reward_max": -1.3, "episode_reward_min": -67.5, "episode_reward_mean": -12.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -4.3, -12.099999999999985, -3.3, -11.399999999999999, -8.2, -26.4, -18.899999999999995, -4.300000000000001, -22.5, -4.2, -7.2, -3.2, -9.199999999999998, -18.500000000000004, -6.300000000000001, -20.9, -16.099999999999994, -6.3, -12.399999999999997, -5.2, -12.399999999999999, -17.600000000000005, -6.2, -6.300000000000001, -12.5, -35.6, -12.5, -10.999999999999998, -21.3, -26.699999999999992, -15.3, -10.099999999999998, -10.600000000000001, -21.9, -9.4, -14.6, -9.299999999999997, -5.800000000000001, -4.2, -4.300000000000001, -62.4, -6.4, -15.599999999999996, -4.300000000000001, -6.000000000000001, -9.0, -21.9, -4.799999999999999, -7.599999999999999, -3.2, -14.099999999999998, -3.2, -9.0, -13.8, -14.2, -10.1, -8.899999999999999, -11.899999999999999, -8.2, -1.3, -5.2, -5.300000000000001, -14.399999999999999, -13.799999999999999, -14.999999999999986, -4.3, -6.100000000000001, -9.999999999999998, -7.1999999999999975, -5.2, -6.699999999999999, -67.5, -8.3, -17.5, -17.699999999999996, -4.4, -14.599999999999996, -19.6, -21.4, -33.60000000000001, -6.5, -3.3, -16.099999999999984, -5.7, -26.3, -4.3, -20.500000000000007, -8.5, -3.3, -13.6, -17.4, -3.8000000000000007, -19.600000000000005, -12.599999999999996, -3.3, -18.5, -12.2, -15.899999999999999, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9103176073341723, "mean_inference_ms": 1.1468078330943254, "mean_action_processing_ms": 0.06308228041017193, "mean_env_wait_ms": 5.243520004919165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 204000, "timesteps_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"sample_time_ms": 14667.681, "sample_throughput": 272.708, "load_time_ms": 0.338, "load_throughput": 11836613.518, "learn_time_ms": 6805.508, "learn_throughput": 587.759, "update_time_ms": 1.55}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.25000466593711446, "policy_loss": -0.007337893942190755, "vf_loss": 25.682920524766367, "vf_explained_var": -0.006502659923286848, "kl": 0.010267202258477607, "entropy": 0.21564544629586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 204000, "num_agent_steps_sampled": 204000, "num_steps_trained": 204000, "num_agent_steps_trained": 204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2040, "training_iteration": 51, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-54-06", "timestamp": 1643666046, "time_this_iter_s": 14.155933141708374, "time_total_s": 723.1512730121613, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 723.1512730121613, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.939999999999998, "ram_util_percent": 73.87000000000002}}
{"episode_reward_max": -1.3, "episode_reward_min": -128.2, "episode_reward_mean": -13.187000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -62.4, -6.4, -15.599999999999996, -4.300000000000001, -6.000000000000001, -9.0, -21.9, -4.799999999999999, -7.599999999999999, -3.2, -14.099999999999998, -3.2, -9.0, -13.8, -14.2, -10.1, -8.899999999999999, -11.899999999999999, -8.2, -1.3, -5.2, -5.300000000000001, -14.399999999999999, -13.799999999999999, -14.999999999999986, -4.3, -6.100000000000001, -9.999999999999998, -7.1999999999999975, -5.2, -6.699999999999999, -67.5, -8.3, -17.5, -17.699999999999996, -4.4, -14.599999999999996, -19.6, -21.4, -33.60000000000001, -6.5, -3.3, -16.099999999999984, -5.7, -26.3, -4.3, -20.500000000000007, -8.5, -3.3, -13.6, -17.4, -3.8000000000000007, -19.600000000000005, -12.599999999999996, -3.3, -18.5, -12.2, -15.899999999999999, -8.2, -9.2, -14.799999999999999, -15.7, -4.3, -11.399999999999999, -10.299999999999999, -5.8999999999999995, -8.3, -15.399999999999991, -25.200000000000006, -5.2, -5.300000000000001, -16.799999999999997, -13.1, -6.2, -7.2, -128.2, -4.3, -22.0, -4.4, -15.999999999999998, -20.000000000000004, -11.5, -11.3, -8.3, -4.2, -9.099999999999998, -11.6, -19.5, -8.7, -22.8, -17.199999999999992, -4.3, -15.2, -8.799999999999999, -10.9, -3.3, -6.2, -4.3, -14.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9099321836299271, "mean_inference_ms": 1.146535567516907, "mean_action_processing_ms": 0.06307049670231069, "mean_env_wait_ms": 5.242618382356662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 208000, "timesteps_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"sample_time_ms": 14700.447, "sample_throughput": 272.101, "load_time_ms": 0.35, "load_throughput": 11443432.235, "learn_time_ms": 6805.692, "learn_throughput": 587.743, "update_time_ms": 1.547}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.6081976264657613, "policy_loss": -0.007429707897526602, "vf_loss": 61.52397225864472, "vf_explained_var": 0.1597412500971107, "kl": 0.00775267456711048, "entropy": 0.18609434033754052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 208000, "num_agent_steps_sampled": 208000, "num_steps_trained": 208000, "num_agent_steps_trained": 208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2080, "training_iteration": 52, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-54-20", "timestamp": 1643666060, "time_this_iter_s": 14.64004397392273, "time_total_s": 737.791316986084, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 737.791316986084, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 28.41428571428571, "ram_util_percent": 74.68095238095238}}
{"episode_reward_max": -3.2, "episode_reward_min": -128.2, "episode_reward_mean": -14.628, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.60000000000001, -6.5, -3.3, -16.099999999999984, -5.7, -26.3, -4.3, -20.500000000000007, -8.5, -3.3, -13.6, -17.4, -3.8000000000000007, -19.600000000000005, -12.599999999999996, -3.3, -18.5, -12.2, -15.899999999999999, -8.2, -9.2, -14.799999999999999, -15.7, -4.3, -11.399999999999999, -10.299999999999999, -5.8999999999999995, -8.3, -15.399999999999991, -25.200000000000006, -5.2, -5.300000000000001, -16.799999999999997, -13.1, -6.2, -7.2, -128.2, -4.3, -22.0, -4.4, -15.999999999999998, -20.000000000000004, -11.5, -11.3, -8.3, -4.2, -9.099999999999998, -11.6, -19.5, -8.7, -22.8, -17.199999999999992, -4.3, -15.2, -8.799999999999999, -10.9, -3.3, -6.2, -4.3, -14.700000000000001, -17.199999999999996, -5.2, -14.9, -16.6, -4.300000000000001, -10.700000000000001, -16.799999999999997, -3.3, -21.700000000000003, -10.4, -14.7, -18.3, -3.3, -10.799999999999997, -5.300000000000001, -10.799999999999999, -16.2, -28.2, -19.7, -16.099999999999987, -16.5, -5.300000000000001, -6.2, -13.5, -3.2, -4.300000000000001, -87.4, -6.2, -20.9, -12.6, -23.2, -10.399999999999999, -12.9, -3.3, -11.399999999999997, -4.2, -49.3, -16.6, -60.3, -16.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9120992978195561, "mean_inference_ms": 1.147382233112569, "mean_action_processing_ms": 0.06310561289338944, "mean_env_wait_ms": 5.245522738668918, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 212000, "timesteps_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"sample_time_ms": 14763.285, "sample_throughput": 270.942, "load_time_ms": 0.348, "load_throughput": 11510164.654, "learn_time_ms": 6841.956, "learn_throughput": 584.628, "update_time_ms": 1.533}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.6293175307769698, "policy_loss": -0.003910934061853475, "vf_loss": 63.28040754692529, "vf_explained_var": 0.24524063685888886, "kl": 0.00848813007195549, "entropy": 0.16588819699902688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 212000, "num_agent_steps_sampled": 212000, "num_steps_trained": 212000, "num_agent_steps_trained": 212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2120, "training_iteration": 53, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-54-36", "timestamp": 1643666076, "time_this_iter_s": 15.441452026367188, "time_total_s": 753.2327690124512, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 753.2327690124512, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 29.64090909090909, "ram_util_percent": 73.6818181818182}}
{"episode_reward_max": -3.2, "episode_reward_min": -87.4, "episode_reward_mean": -13.350000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.999999999999998, -20.000000000000004, -11.5, -11.3, -8.3, -4.2, -9.099999999999998, -11.6, -19.5, -8.7, -22.8, -17.199999999999992, -4.3, -15.2, -8.799999999999999, -10.9, -3.3, -6.2, -4.3, -14.700000000000001, -17.199999999999996, -5.2, -14.9, -16.6, -4.300000000000001, -10.700000000000001, -16.799999999999997, -3.3, -21.700000000000003, -10.4, -14.7, -18.3, -3.3, -10.799999999999997, -5.300000000000001, -10.799999999999999, -16.2, -28.2, -19.7, -16.099999999999987, -16.5, -5.300000000000001, -6.2, -13.5, -3.2, -4.300000000000001, -87.4, -6.2, -20.9, -12.6, -23.2, -10.399999999999999, -12.9, -3.3, -11.399999999999997, -4.2, -49.3, -16.6, -60.3, -16.299999999999997, -13.099999999999998, -5.300000000000001, -6.2, -13.899999999999999, -3.3, -22.500000000000014, -14.099999999999998, -22.200000000000017, -4.2, -14.6, -6.300000000000001, -9.899999999999999, -22.80000000000003, -10.7, -7.300000000000001, -5.2, -22.5, -5.300000000000001, -7.3, -10.100000000000001, -9.599999999999998, -9.9, -6.999999999999998, -4.3, -7.3, -9.999999999999998, -6.300000000000001, -8.9, -5.2, -6.300000000000001, -20.000000000000004, -14.099999999999998, -4.3, -3.3, -6.300000000000001, -46.3, -3.3, -4.2, -5.2, -50.000000000000036], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.913740277929992, "mean_inference_ms": 1.1483455261003046, "mean_action_processing_ms": 0.06314694692407667, "mean_env_wait_ms": 5.2492523661403565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 14844.936, "sample_throughput": 269.452, "load_time_ms": 0.342, "load_throughput": 11690625.044, "learn_time_ms": 6772.289, "learn_throughput": 590.642, "update_time_ms": 1.498}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.17330674595970622, "policy_loss": -0.033489747865185625, "vf_loss": 20.613870932209878, "vf_explained_var": 0.08515996413846169, "kl": 0.01315585051132706, "entropy": 0.20708517014820088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 216000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2160, "training_iteration": 54, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-54-51", "timestamp": 1643666091, "time_this_iter_s": 14.893219232559204, "time_total_s": 768.1259882450104, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 768.1259882450104, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 27.90952380952381, "ram_util_percent": 73.4857142857143}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.70000000000007, "episode_reward_mean": -13.624, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.5, -5.300000000000001, -6.2, -13.5, -3.2, -4.300000000000001, -87.4, -6.2, -20.9, -12.6, -23.2, -10.399999999999999, -12.9, -3.3, -11.399999999999997, -4.2, -49.3, -16.6, -60.3, -16.299999999999997, -13.099999999999998, -5.300000000000001, -6.2, -13.899999999999999, -3.3, -22.500000000000014, -14.099999999999998, -22.200000000000017, -4.2, -14.6, -6.300000000000001, -9.899999999999999, -22.80000000000003, -10.7, -7.300000000000001, -5.2, -22.5, -5.300000000000001, -7.3, -10.100000000000001, -9.599999999999998, -9.9, -6.999999999999998, -4.3, -7.3, -9.999999999999998, -6.300000000000001, -8.9, -5.2, -6.300000000000001, -20.000000000000004, -14.099999999999998, -4.3, -3.3, -6.300000000000001, -46.3, -3.3, -4.2, -5.2, -50.000000000000036, -6.2, -20.900000000000006, -18.3, -3.2, -12.399999999999997, -9.4, -3.3, -14.3, -10.899999999999999, -15.199999999999976, -6.400000000000001, -5.300000000000001, -4.300000000000001, -14.6, -11.899999999999999, -7.599999999999998, -20.5, -3.3, -13.2, -8.2, -7.2, -21.6, -4.699999999999999, -12.3, -23.1, -19.60000000000002, -90.70000000000007, -9.899999999999995, -4.300000000000001, -5.300000000000001, -8.799999999999997, -24.500000000000004, -19.0, -5.300000000000001, -5.300000000000001, -9.3, -3.3, -25.700000000000006, -3.2, -7.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9136324482391933, "mean_inference_ms": 1.148611938287239, "mean_action_processing_ms": 0.06315194117953363, "mean_env_wait_ms": 5.250823278875837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 14678.143, "sample_throughput": 272.514, "load_time_ms": 0.348, "load_throughput": 11507006.859, "learn_time_ms": 6730.545, "learn_throughput": 594.305, "update_time_ms": 1.494}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.4642943390564973, "policy_loss": -0.006702235217897161, "vf_loss": 47.07222150218102, "vf_explained_var": 0.15544562730737913, "kl": 0.00548723829193773, "entropy": 0.18873919007438486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2200, "training_iteration": 55, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-55-05", "timestamp": 1643666105, "time_this_iter_s": 14.04722809791565, "time_total_s": 782.173216342926, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 782.173216342926, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 22.315, "ram_util_percent": 73.51}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.70000000000007, "episode_reward_mean": -12.299000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.599999999999998, -9.9, -6.999999999999998, -4.3, -7.3, -9.999999999999998, -6.300000000000001, -8.9, -5.2, -6.300000000000001, -20.000000000000004, -14.099999999999998, -4.3, -3.3, -6.300000000000001, -46.3, -3.3, -4.2, -5.2, -50.000000000000036, -6.2, -20.900000000000006, -18.3, -3.2, -12.399999999999997, -9.4, -3.3, -14.3, -10.899999999999999, -15.199999999999976, -6.400000000000001, -5.300000000000001, -4.300000000000001, -14.6, -11.899999999999999, -7.599999999999998, -20.5, -3.3, -13.2, -8.2, -7.2, -21.6, -4.699999999999999, -12.3, -23.1, -19.60000000000002, -90.70000000000007, -9.899999999999995, -4.300000000000001, -5.300000000000001, -8.799999999999997, -24.500000000000004, -19.0, -5.300000000000001, -5.300000000000001, -9.3, -3.3, -25.700000000000006, -3.2, -7.299999999999999, -52.599999999999994, -22.000000000000004, -5.300000000000001, -9.3, -5.2, -13.799999999999997, -7.2, -11.899999999999995, -3.2, -23.9, -9.6, -3.4, -18.800000000000004, -11.799999999999999, -10.999999999999998, -16.799999999999997, -7.3, -4.300000000000001, -4.300000000000001, -4.300000000000001, -7.899999999999999, -7.6000000000000005, -12.799999999999999, -3.3, -17.2, -5.4, -12.799999999999999, -4.2, -5.300000000000001, -83.4, -3.3, -16.2, -4.300000000000001, -5.6000000000000005, -11.999999999999972, -3.3, -5.4, -5.4, -7.2, -9.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9129397010969555, "mean_inference_ms": 1.1485127078712118, "mean_action_processing_ms": 0.06314606085831591, "mean_env_wait_ms": 5.251586539689284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 224000, "timesteps_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"sample_time_ms": 14603.281, "sample_throughput": 273.911, "load_time_ms": 0.348, "load_throughput": 11496755.979, "learn_time_ms": 6725.386, "learn_throughput": 594.761, "update_time_ms": 1.478}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.5147524226687208, "policy_loss": -0.006631042708152084, "vf_loss": 52.105723053281025, "vf_explained_var": 0.1667508275278153, "kl": 0.006524970960830929, "entropy": 0.1617809148725643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 224000, "num_agent_steps_sampled": 224000, "num_steps_trained": 224000, "num_agent_steps_trained": 224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2240, "training_iteration": 56, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-55-20", "timestamp": 1643666120, "time_this_iter_s": 14.879637956619263, "time_total_s": 797.0528542995453, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 797.0528542995453, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.423809523809524, "ram_util_percent": 73.53809523809522}}
{"episode_reward_max": -3.2, "episode_reward_min": -102.69999999999985, "episode_reward_mean": -14.023, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -21.6, -4.699999999999999, -12.3, -23.1, -19.60000000000002, -90.70000000000007, -9.899999999999995, -4.300000000000001, -5.300000000000001, -8.799999999999997, -24.500000000000004, -19.0, -5.300000000000001, -5.300000000000001, -9.3, -3.3, -25.700000000000006, -3.2, -7.299999999999999, -52.599999999999994, -22.000000000000004, -5.300000000000001, -9.3, -5.2, -13.799999999999997, -7.2, -11.899999999999995, -3.2, -23.9, -9.6, -3.4, -18.800000000000004, -11.799999999999999, -10.999999999999998, -16.799999999999997, -7.3, -4.300000000000001, -4.300000000000001, -4.300000000000001, -7.899999999999999, -7.6000000000000005, -12.799999999999999, -3.3, -17.2, -5.4, -12.799999999999999, -4.2, -5.300000000000001, -83.4, -3.3, -16.2, -4.300000000000001, -5.6000000000000005, -11.999999999999972, -3.3, -5.4, -5.4, -7.2, -9.700000000000001, -12.19999999999997, -6.4, -15.2, -7.3, -27.9, -11.599999999999996, -5.4, -33.3, -7.199999999999999, -7.300000000000001, -23.699999999999992, -12.399999999999974, -15.2, -23.6, -16.7, -6.3, -20.700000000000003, -3.3, -16.2, -4.300000000000001, -15.299999999999995, -4.2, -16.3, -6.2, -4.2, -13.4, -7.5, -4.2, -14.7, -102.69999999999985, -4.300000000000001, -7.300000000000001, -51.2, -5.300000000000001, -14.199999999999982, -3.2, -34.20000000000002, -19.2, -5.4, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9131893998227147, "mean_inference_ms": 1.1492081643195073, "mean_action_processing_ms": 0.06319045771092696, "mean_env_wait_ms": 5.255999928328813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 228000, "timesteps_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"sample_time_ms": 14631.159, "sample_throughput": 273.389, "load_time_ms": 0.356, "load_throughput": 11248552.464, "learn_time_ms": 6775.089, "learn_throughput": 590.398, "update_time_ms": 1.477}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.588521725891198, "policy_loss": -0.012874740207697995, "vf_loss": 60.060112502241644, "vf_explained_var": 0.033906280673960204, "kl": 0.015907133233828044, "entropy": 0.20395388938887146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 228000, "num_agent_steps_sampled": 228000, "num_steps_trained": 228000, "num_agent_steps_trained": 228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2280, "training_iteration": 57, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-55-35", "timestamp": 1643666135, "time_this_iter_s": 15.626338720321655, "time_total_s": 812.679193019867, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 812.679193019867, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 32.377272727272725, "ram_util_percent": 74.02272727272727}}
{"episode_reward_max": -3.2, "episode_reward_min": -102.69999999999985, "episode_reward_mean": -13.243999999999994, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.899999999999999, -7.6000000000000005, -12.799999999999999, -3.3, -17.2, -5.4, -12.799999999999999, -4.2, -5.300000000000001, -83.4, -3.3, -16.2, -4.300000000000001, -5.6000000000000005, -11.999999999999972, -3.3, -5.4, -5.4, -7.2, -9.700000000000001, -12.19999999999997, -6.4, -15.2, -7.3, -27.9, -11.599999999999996, -5.4, -33.3, -7.199999999999999, -7.300000000000001, -23.699999999999992, -12.399999999999974, -15.2, -23.6, -16.7, -6.3, -20.700000000000003, -3.3, -16.2, -4.300000000000001, -15.299999999999995, -4.2, -16.3, -6.2, -4.2, -13.4, -7.5, -4.2, -14.7, -102.69999999999985, -4.300000000000001, -7.300000000000001, -51.2, -5.300000000000001, -14.199999999999982, -3.2, -34.20000000000002, -19.2, -5.4, -4.4, -13.3, -12.2, -4.2, -14.199999999999998, -4.2, -21.199999999999996, -7.899999999999999, -18.7, -19.9, -14.899999999999999, -3.3, -10.7, -9.399999999999997, -7.3, -17.4, -8.899999999999999, -13.599999999999982, -5.3, -21.799999999999997, -10.099999999999996, -18.900000000000006, -5.3, -26.500000000000004, -16.4, -21.90000000000001, -5.300000000000001, -13.999999999999998, -3.4, -5.2, -17.5, -4.3, -5.2, -8.2, -12.199999999999996, -23.5, -15.29999999999999, -12.799999999999999, -14.59999999999998, -3.2, -6.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.913193253865509, "mean_inference_ms": 1.1502013394776562, "mean_action_processing_ms": 0.06325525430830294, "mean_env_wait_ms": 5.262129867972509, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 232000, "timesteps_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"sample_time_ms": 14693.614, "sample_throughput": 272.227, "load_time_ms": 0.376, "load_throughput": 10638016.613, "learn_time_ms": 6742.071, "learn_throughput": 593.29, "update_time_ms": 1.47}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.09691272501543324, "policy_loss": -0.0013261358223615155, "vf_loss": 9.787767373490077, "vf_explained_var": 0.24994348069672945, "kl": 0.007223802784242391, "entropy": 0.18131733926073199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232000, "num_agent_steps_sampled": 232000, "num_steps_trained": 232000, "num_agent_steps_trained": 232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2320, "training_iteration": 58, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-55-50", "timestamp": 1643666150, "time_this_iter_s": 14.205343961715698, "time_total_s": 826.8845369815826, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 826.8845369815826, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 22.830000000000002, "ram_util_percent": 74.03500000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -102.69999999999985, "episode_reward_mean": -12.966, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.299999999999995, -4.2, -16.3, -6.2, -4.2, -13.4, -7.5, -4.2, -14.7, -102.69999999999985, -4.300000000000001, -7.300000000000001, -51.2, -5.300000000000001, -14.199999999999982, -3.2, -34.20000000000002, -19.2, -5.4, -4.4, -13.3, -12.2, -4.2, -14.199999999999998, -4.2, -21.199999999999996, -7.899999999999999, -18.7, -19.9, -14.899999999999999, -3.3, -10.7, -9.399999999999997, -7.3, -17.4, -8.899999999999999, -13.599999999999982, -5.3, -21.799999999999997, -10.099999999999996, -18.900000000000006, -5.3, -26.500000000000004, -16.4, -21.90000000000001, -5.300000000000001, -13.999999999999998, -3.4, -5.2, -17.5, -4.3, -5.2, -8.2, -12.199999999999996, -23.5, -15.29999999999999, -12.799999999999999, -14.59999999999998, -3.2, -6.3, -19.599999999999998, -31.600000000000005, -4.2, -18.3, -16.099999999999998, -5.199999999999999, -4.2, -5.300000000000001, -11.899999999999999, -19.0, -13.5, -12.399999999999974, -22.9, -10.3, -6.3, -17.099999999999994, -4.2, -3.4, -13.5, -5.3, -20.6, -12.499999999999995, -17.5, -4.2, -5.700000000000003, -4.2, -4.300000000000001, -11.899999999999997, -4.300000000000001, -20.9, -19.3, -15.499999999999998, -5.3, -4.2, -19.599999999999998, -5.899999999999999, -16.699999999999996, -15.799999999999997, -5.3, -22.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9126856315613245, "mean_inference_ms": 1.1504362748077648, "mean_action_processing_ms": 0.06327496979675516, "mean_env_wait_ms": 5.264164712986291, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 236000, "timesteps_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"sample_time_ms": 14591.976, "sample_throughput": 274.123, "load_time_ms": 0.371, "load_throughput": 10788512.636, "learn_time_ms": 6757.581, "learn_throughput": 591.928, "update_time_ms": 1.511}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.08303748868025279, "policy_loss": 0.000839431964421785, "vf_loss": 8.185744216653609, "vf_explained_var": 0.28631057271393395, "kl": 0.006812322701403517, "entropy": 0.13849643743647042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 236000, "num_agent_steps_sampled": 236000, "num_steps_trained": 236000, "num_agent_steps_trained": 236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2360, "training_iteration": 59, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-56-04", "timestamp": 1643666164, "time_this_iter_s": 14.193047046661377, "time_total_s": 841.077584028244, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 841.077584028244, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 25.58571428571429, "ram_util_percent": 73.93809523809526}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.599999999999994, "episode_reward_mean": -11.972000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.900000000000006, -5.3, -26.500000000000004, -16.4, -21.90000000000001, -5.300000000000001, -13.999999999999998, -3.4, -5.2, -17.5, -4.3, -5.2, -8.2, -12.199999999999996, -23.5, -15.29999999999999, -12.799999999999999, -14.59999999999998, -3.2, -6.3, -19.599999999999998, -31.600000000000005, -4.2, -18.3, -16.099999999999998, -5.199999999999999, -4.2, -5.300000000000001, -11.899999999999999, -19.0, -13.5, -12.399999999999974, -22.9, -10.3, -6.3, -17.099999999999994, -4.2, -3.4, -13.5, -5.3, -20.6, -12.499999999999995, -17.5, -4.2, -5.700000000000003, -4.2, -4.300000000000001, -11.899999999999997, -4.300000000000001, -20.9, -19.3, -15.499999999999998, -5.3, -4.2, -19.599999999999998, -5.899999999999999, -16.699999999999996, -15.799999999999997, -5.3, -22.7, -3.3, -5.300000000000001, -8.3, -9.899999999999999, -10.2, -8.6, -5.3, -7.3999999999999995, -4.5, -18.5, -4.300000000000001, -12.599999999999998, -3.3, -5.300000000000001, -4.300000000000001, -6.4, -10.7, -14.8, -11.899999999999999, -7.699999999999998, -19.600000000000005, -16.2, -5.2, -12.099999999999998, -12.6, -3.2, -10.399999999999999, -3.3, -14.4, -19.9, -19.6, -26.5, -5.300000000000001, -16.6, -38.60000000000001, -19.09999999999999, -5.300000000000001, -16.199999999999996, -45.599999999999994, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9129630166649975, "mean_inference_ms": 1.151482099044934, "mean_action_processing_ms": 0.06333028511365005, "mean_env_wait_ms": 5.269332512848946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 14739.864, "sample_throughput": 271.373, "load_time_ms": 0.381, "load_throughput": 10512040.1, "learn_time_ms": 6846.051, "learn_throughput": 584.278, "update_time_ms": 1.5}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.19493891291059953, "policy_loss": -0.0072990879401444424, "vf_loss": 20.18555563149914, "vf_explained_var": 0.27345052297397326, "kl": 0.007648980433996669, "entropy": 0.1325421614932918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2400, "training_iteration": 60, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-56-20", "timestamp": 1643666180, "time_this_iter_s": 16.003226041793823, "time_total_s": 857.0808100700378, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 857.0808100700378, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 33.663636363636364, "ram_util_percent": 74.13636363636363}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.599999999999994, "episode_reward_mean": -11.671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.6, -12.499999999999995, -17.5, -4.2, -5.700000000000003, -4.2, -4.300000000000001, -11.899999999999997, -4.300000000000001, -20.9, -19.3, -15.499999999999998, -5.3, -4.2, -19.599999999999998, -5.899999999999999, -16.699999999999996, -15.799999999999997, -5.3, -22.7, -3.3, -5.300000000000001, -8.3, -9.899999999999999, -10.2, -8.6, -5.3, -7.3999999999999995, -4.5, -18.5, -4.300000000000001, -12.599999999999998, -3.3, -5.300000000000001, -4.300000000000001, -6.4, -10.7, -14.8, -11.899999999999999, -7.699999999999998, -19.600000000000005, -16.2, -5.2, -12.099999999999998, -12.6, -3.2, -10.399999999999999, -3.3, -14.4, -19.9, -19.6, -26.5, -5.300000000000001, -16.6, -38.60000000000001, -19.09999999999999, -5.300000000000001, -16.199999999999996, -45.599999999999994, -4.2, -5.3, -3.4, -12.7, -21.8, -11.399999999999997, -13.399999999999999, -18.90000000000001, -3.2, -15.999999999999998, -12.2, -23.799999999999997, -5.2, -13.1, -19.200000000000003, -31.4, -10.200000000000001, -11.3, -4.300000000000001, -24.900000000000002, -15.799999999999995, -5.4, -21.2, -4.2, -17.1, -7.999999999999998, -3.3, -14.6, -15.7, -3.3, -7.2, -4.2, -3.2, -5.2, -23.100000000000005, -5.300000000000001, -4.300000000000001, -5.2, -3.3, -16.6, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.912500154307273, "mean_inference_ms": 1.152220001478493, "mean_action_processing_ms": 0.06337095431780576, "mean_env_wait_ms": 5.273568813005146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 244000, "timesteps_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"sample_time_ms": 14805.123, "sample_throughput": 270.177, "load_time_ms": 0.381, "load_throughput": 10506773.547, "learn_time_ms": 6849.743, "learn_throughput": 583.964, "update_time_ms": 1.479}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.09524596293246554, "policy_loss": -0.004856615560129285, "vf_loss": 9.985423891967343, "vf_explained_var": 0.28411223599987645, "kl": 0.004966883707832701, "entropy": 0.14096059542830272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 244000, "num_agent_steps_sampled": 244000, "num_steps_trained": 244000, "num_agent_steps_trained": 244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2440, "training_iteration": 61, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-56-34", "timestamp": 1643666194, "time_this_iter_s": 13.957058906555176, "time_total_s": 871.037868976593, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 871.037868976593, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.395000000000003, "ram_util_percent": 74.26500000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.599999999999994, "episode_reward_mean": -12.697999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.600000000000005, -16.2, -5.2, -12.099999999999998, -12.6, -3.2, -10.399999999999999, -3.3, -14.4, -19.9, -19.6, -26.5, -5.300000000000001, -16.6, -38.60000000000001, -19.09999999999999, -5.300000000000001, -16.199999999999996, -45.599999999999994, -4.2, -5.3, -3.4, -12.7, -21.8, -11.399999999999997, -13.399999999999999, -18.90000000000001, -3.2, -15.999999999999998, -12.2, -23.799999999999997, -5.2, -13.1, -19.200000000000003, -31.4, -10.200000000000001, -11.3, -4.300000000000001, -24.900000000000002, -15.799999999999995, -5.4, -21.2, -4.2, -17.1, -7.999999999999998, -3.3, -14.6, -15.7, -3.3, -7.2, -4.2, -3.2, -5.2, -23.100000000000005, -5.300000000000001, -4.300000000000001, -5.2, -3.3, -16.6, -6.300000000000001, -3.3, -19.400000000000002, -25.700000000000003, -20.000000000000007, -17.8, -10.499999999999998, -14.899999999999999, -3.2, -4.300000000000001, -12.3, -18.699999999999996, -3.2, -16.800000000000004, -16.799999999999997, -9.999999999999998, -19.799999999999976, -8.699999999999998, -4.300000000000001, -3.2, -12.299999999999997, -5.3, -10.299999999999994, -22.3, -19.0, -23.3, -3.2, -21.5, -4.4, -16.099999999999998, -4.4, -5.3, -9.0, -3.3, -14.5, -13.7, -28.3, -5.199999999999999, -19.3, -5.5, -22.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9121542158882993, "mean_inference_ms": 1.1527469095150424, "mean_action_processing_ms": 0.06340570609773812, "mean_env_wait_ms": 5.276646772785325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 248000, "timesteps_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"sample_time_ms": 14822.064, "sample_throughput": 269.868, "load_time_ms": 0.367, "load_throughput": 10887226.476, "learn_time_ms": 6830.139, "learn_throughput": 585.64, "update_time_ms": 1.474}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.11744711056992573, "policy_loss": 0.006210419891141756, "vf_loss": 11.110686184129408, "vf_explained_var": 0.291273977487318, "kl": 0.0051933564620111165, "entropy": 0.12599003935653355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 248000, "num_agent_steps_sampled": 248000, "num_steps_trained": 248000, "num_agent_steps_trained": 248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2480, "training_iteration": 62, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-56-48", "timestamp": 1643666208, "time_this_iter_s": 14.577285051345825, "time_total_s": 885.6151540279388, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 885.6151540279388, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 28.490476190476187, "ram_util_percent": 74.32857142857145}}
{"episode_reward_max": -3.2, "episode_reward_min": -69.80000000000003, "episode_reward_mean": -11.522, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -21.2, -4.2, -17.1, -7.999999999999998, -3.3, -14.6, -15.7, -3.3, -7.2, -4.2, -3.2, -5.2, -23.100000000000005, -5.300000000000001, -4.300000000000001, -5.2, -3.3, -16.6, -6.300000000000001, -3.3, -19.400000000000002, -25.700000000000003, -20.000000000000007, -17.8, -10.499999999999998, -14.899999999999999, -3.2, -4.300000000000001, -12.3, -18.699999999999996, -3.2, -16.800000000000004, -16.799999999999997, -9.999999999999998, -19.799999999999976, -8.699999999999998, -4.300000000000001, -3.2, -12.299999999999997, -5.3, -10.299999999999994, -22.3, -19.0, -23.3, -3.2, -21.5, -4.4, -16.099999999999998, -4.4, -5.3, -9.0, -3.3, -14.5, -13.7, -28.3, -5.199999999999999, -19.3, -5.5, -22.599999999999998, -4.3, -7.699999999999998, -8.3, -3.3, -10.900000000000002, -69.80000000000003, -3.3, -8.2, -5.3, -3.3, -4.2, -22.4, -5.300000000000001, -5.3, -6.400000000000002, -3.3, -3.3, -6.799999999999999, -17.999999999999996, -20.2, -13.59999999999999, -3.3, -24.400000000000016, -13.3, -5.2, -21.5, -5.2, -12.6, -16.5, -10.799999999999997, -4.6, -26.099999999999998, -6.499999999999999, -4.4, -22.200000000000006, -3.3, -11.299999999999997, -23.199999999999996, -12.299999999999999, -13.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9119156765452436, "mean_inference_ms": 1.1523234619253209, "mean_action_processing_ms": 0.0633845472935689, "mean_env_wait_ms": 5.274931083289536, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 252000, "timesteps_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"sample_time_ms": 14695.539, "sample_throughput": 272.191, "load_time_ms": 0.37, "load_throughput": 10816334.214, "learn_time_ms": 6791.347, "learn_throughput": 588.985, "update_time_ms": 1.46}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.28342358206438845, "policy_loss": -0.007216003648836606, "vf_loss": 29.03396965893366, "vf_explained_var": 0.11777843820151462, "kl": 0.0119958461751632, "entropy": 0.16508412795361652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 252000, "num_agent_steps_sampled": 252000, "num_steps_trained": 252000, "num_agent_steps_trained": 252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2520, "training_iteration": 63, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-57-02", "timestamp": 1643666222, "time_this_iter_s": 13.98528003692627, "time_total_s": 899.6004340648651, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 899.6004340648651, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 22.380000000000003, "ram_util_percent": 74.295}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.4, "episode_reward_mean": -12.476999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -10.299999999999994, -22.3, -19.0, -23.3, -3.2, -21.5, -4.4, -16.099999999999998, -4.4, -5.3, -9.0, -3.3, -14.5, -13.7, -28.3, -5.199999999999999, -19.3, -5.5, -22.599999999999998, -4.3, -7.699999999999998, -8.3, -3.3, -10.900000000000002, -69.80000000000003, -3.3, -8.2, -5.3, -3.3, -4.2, -22.4, -5.300000000000001, -5.3, -6.400000000000002, -3.3, -3.3, -6.799999999999999, -17.999999999999996, -20.2, -13.59999999999999, -3.3, -24.400000000000016, -13.3, -5.2, -21.5, -5.2, -12.6, -16.5, -10.799999999999997, -4.6, -26.099999999999998, -6.499999999999999, -4.4, -22.200000000000006, -3.3, -11.299999999999997, -23.199999999999996, -12.299999999999999, -13.899999999999999, -20.1, -20.000000000000004, -4.300000000000001, -13.19999999999997, -4.300000000000001, -10.7, -4.3, -15.4, -5.300000000000001, -10.999999999999998, -4.2, -5.300000000000001, -9.3, -19.599999999999998, -14.299999999999995, -8.1, -15.399999999999999, -8.9, -4.300000000000001, -8.3, -6.2, -15.999999999999998, -8.2, -44.3, -10.3, -21.2, -89.4, -4.2, -14.2, -11.4, -9.200000000000001, -3.3, -4.2, -24.900000000000006, -4.2, -4.300000000000001, -5.300000000000001, -10.3, -11.5, -8.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9119183654140663, "mean_inference_ms": 1.151940755151907, "mean_action_processing_ms": 0.06336047640110143, "mean_env_wait_ms": 5.2732148775236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 256000, "timesteps_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"sample_time_ms": 14635.839, "sample_throughput": 273.302, "load_time_ms": 0.378, "load_throughput": 10588334.49, "learn_time_ms": 6773.549, "learn_throughput": 590.532, "update_time_ms": 1.478}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.4991918892510766, "policy_loss": -0.00300786738954885, "vf_loss": 50.18056657198937, "vf_explained_var": 0.2322552167600201, "kl": 0.015764248480455757, "entropy": 0.16849157230588058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 256000, "num_agent_steps_sampled": 256000, "num_steps_trained": 256000, "num_agent_steps_trained": 256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2560, "training_iteration": 64, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-57-17", "timestamp": 1643666237, "time_this_iter_s": 14.508777141571045, "time_total_s": 914.1092112064362, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 914.1092112064362, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 25.81904761904762, "ram_util_percent": 74.45238095238095}}
{"episode_reward_max": -3.3, "episode_reward_min": -89.4, "episode_reward_mean": -12.939000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.59999999999999, -3.3, -24.400000000000016, -13.3, -5.2, -21.5, -5.2, -12.6, -16.5, -10.799999999999997, -4.6, -26.099999999999998, -6.499999999999999, -4.4, -22.200000000000006, -3.3, -11.299999999999997, -23.199999999999996, -12.299999999999999, -13.899999999999999, -20.1, -20.000000000000004, -4.300000000000001, -13.19999999999997, -4.300000000000001, -10.7, -4.3, -15.4, -5.300000000000001, -10.999999999999998, -4.2, -5.300000000000001, -9.3, -19.599999999999998, -14.299999999999995, -8.1, -15.399999999999999, -8.9, -4.300000000000001, -8.3, -6.2, -15.999999999999998, -8.2, -44.3, -10.3, -21.2, -89.4, -4.2, -14.2, -11.4, -9.200000000000001, -3.3, -4.2, -24.900000000000006, -4.2, -4.300000000000001, -5.300000000000001, -10.3, -11.5, -8.5, -7.300000000000001, -7.300000000000001, -13.39999999999999, -24.800000000000008, -9.7, -15.799999999999999, -10.700000000000001, -7.300000000000001, -10.3, -8.299999999999999, -13.2, -7.300000000000001, -17.3, -11.3, -14.799999999999999, -10.4, -22.999999999999996, -14.099999999999998, -8.3, -7.0, -19.4, -8.2, -24.3, -7.300000000000001, -12.3, -11.3, -11.3, -14.3, -10.3, -11.700000000000001, -23.800000000000008, -25.599999999999998, -13.599999999999998, -11.099999999999998, -15.399999999999979, -6.300000000000001, -10.4, -9.2, -29.200000000000028, -5.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9118394259942295, "mean_inference_ms": 1.151634981486197, "mean_action_processing_ms": 0.06333985112175236, "mean_env_wait_ms": 5.271819142092389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 14629.312, "sample_throughput": 273.424, "load_time_ms": 0.378, "load_throughput": 10578320.303, "learn_time_ms": 6790.815, "learn_throughput": 589.031, "update_time_ms": 1.481}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.10243578229089498, "policy_loss": 0.007951285314786258, "vf_loss": 9.427959071948964, "vf_explained_var": 0.28715065557469605, "kl": 0.008196313031487313, "entropy": 0.1577924948305853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2600, "training_iteration": 65, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-57-31", "timestamp": 1643666251, "time_this_iter_s": 14.361406087875366, "time_total_s": 928.4706172943115, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 928.4706172943115, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 25.879999999999995, "ram_util_percent": 74.37}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.4, "episode_reward_mean": -13.251, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -15.999999999999998, -8.2, -44.3, -10.3, -21.2, -89.4, -4.2, -14.2, -11.4, -9.200000000000001, -3.3, -4.2, -24.900000000000006, -4.2, -4.300000000000001, -5.300000000000001, -10.3, -11.5, -8.5, -7.300000000000001, -7.300000000000001, -13.39999999999999, -24.800000000000008, -9.7, -15.799999999999999, -10.700000000000001, -7.300000000000001, -10.3, -8.299999999999999, -13.2, -7.300000000000001, -17.3, -11.3, -14.799999999999999, -10.4, -22.999999999999996, -14.099999999999998, -8.3, -7.0, -19.4, -8.2, -24.3, -7.300000000000001, -12.3, -11.3, -11.3, -14.3, -10.3, -11.700000000000001, -23.800000000000008, -25.599999999999998, -13.599999999999998, -11.099999999999998, -15.399999999999979, -6.300000000000001, -10.4, -9.2, -29.200000000000028, -5.699999999999999, -13.4, -6.300000000000001, -15.0, -6.300000000000001, -25.2, -16.5, -5.2, -19.6, -9.3, -11.200000000000001, -23.599999999999994, -11.6, -12.7, -13.2, -19.3, -3.2, -10.3, -7.300000000000001, -25.00000000000006, -3.2, -7.0, -14.099999999999998, -7.3, -15.3, -8.099999999999998, -13.699999999999998, -15.799999999999999, -17.099999999999998, -14.2, -11.899999999999999, -13.499999999999995, -6.599999999999999, -12.399999999999999, -7.2, -8.2, -5.899999999999999, -17.0, -13.399999999999999, -15.999999999999982, -9.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9124328367882077, "mean_inference_ms": 1.1524755697343319, "mean_action_processing_ms": 0.06338125190610183, "mean_env_wait_ms": 5.275126161991345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"sample_time_ms": 14720.995, "sample_throughput": 271.721, "load_time_ms": 0.392, "load_throughput": 10205740.009, "learn_time_ms": 6766.154, "learn_throughput": 591.178, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.08491093052891634, "policy_loss": -0.008017915307033446, "vf_loss": 9.275719232328477, "vf_explained_var": 0.283441670543404, "kl": 0.006866230247725687, "entropy": 0.16256791466186124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 264000, "num_agent_steps_trained": 264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2640, "training_iteration": 66, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-57-47", "timestamp": 1643666267, "time_this_iter_s": 15.374658107757568, "time_total_s": 943.8452754020691, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 943.8452754020691, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.56363636363636, "ram_util_percent": 74.74999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -29.200000000000028, "episode_reward_mean": -12.190999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.4, -8.2, -24.3, -7.300000000000001, -12.3, -11.3, -11.3, -14.3, -10.3, -11.700000000000001, -23.800000000000008, -25.599999999999998, -13.599999999999998, -11.099999999999998, -15.399999999999979, -6.300000000000001, -10.4, -9.2, -29.200000000000028, -5.699999999999999, -13.4, -6.300000000000001, -15.0, -6.300000000000001, -25.2, -16.5, -5.2, -19.6, -9.3, -11.200000000000001, -23.599999999999994, -11.6, -12.7, -13.2, -19.3, -3.2, -10.3, -7.300000000000001, -25.00000000000006, -3.2, -7.0, -14.099999999999998, -7.3, -15.3, -8.099999999999998, -13.699999999999998, -15.799999999999999, -17.099999999999998, -14.2, -11.899999999999999, -13.499999999999995, -6.599999999999999, -12.399999999999999, -7.2, -8.2, -5.899999999999999, -17.0, -13.399999999999999, -15.999999999999982, -9.599999999999998, -9.4, -24.4, -7.300000000000001, -12.2, -14.899999999999979, -17.700000000000003, -4.300000000000001, -12.2, -9.4, -5.300000000000001, -8.299999999999999, -4.2, -7.2, -19.6, -9.3, -14.399999999999999, -7.300000000000001, -7.2, -9.7, -10.2, -22.5, -14.1, -9.7, -9.600000000000001, -9.4, -4.300000000000001, -18.1, -4.4, -14.199999999999998, -11.2, -4.2, -17.2, -10.5, -9.2, -24.700000000000006, -15.0, -10.2, -9.0, -6.300000000000001, -8.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9126371931035797, "mean_inference_ms": 1.153426987883262, "mean_action_processing_ms": 0.06343355875978028, "mean_env_wait_ms": 5.2793300518233925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 268000, "timesteps_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"sample_time_ms": 14640.172, "sample_throughput": 273.221, "load_time_ms": 0.388, "load_throughput": 10305415.233, "learn_time_ms": 6747.884, "learn_throughput": 592.778, "update_time_ms": 1.486}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.08876615235912463, "policy_loss": -0.0027307752690087722, "vf_loss": 9.125713266352172, "vf_explained_var": 0.3107541129153262, "kl": 0.009591931333507294, "entropy": 0.16671510647221277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 268000, "num_agent_steps_sampled": 268000, "num_steps_trained": 268000, "num_agent_steps_trained": 268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2680, "training_iteration": 67, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-58-02", "timestamp": 1643666282, "time_this_iter_s": 14.881747245788574, "time_total_s": 958.7270226478577, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 958.7270226478577, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 26.076190476190476, "ram_util_percent": 74.75238095238096}}
{"episode_reward_max": -3.3, "episode_reward_min": -51.3, "episode_reward_mean": -11.806, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, -14.099999999999998, -7.3, -15.3, -8.099999999999998, -13.699999999999998, -15.799999999999999, -17.099999999999998, -14.2, -11.899999999999999, -13.499999999999995, -6.599999999999999, -12.399999999999999, -7.2, -8.2, -5.899999999999999, -17.0, -13.399999999999999, -15.999999999999982, -9.599999999999998, -9.4, -24.4, -7.300000000000001, -12.2, -14.899999999999979, -17.700000000000003, -4.300000000000001, -12.2, -9.4, -5.300000000000001, -8.299999999999999, -4.2, -7.2, -19.6, -9.3, -14.399999999999999, -7.300000000000001, -7.2, -9.7, -10.2, -22.5, -14.1, -9.7, -9.600000000000001, -9.4, -4.300000000000001, -18.1, -4.4, -14.199999999999998, -11.2, -4.2, -17.2, -10.5, -9.2, -24.700000000000006, -15.0, -10.2, -9.0, -6.300000000000001, -8.4, -10.600000000000001, -3.900000000000001, -5.799999999999999, -3.4, -19.6, -13.299999999999995, -18.2, -5.3, -18.599999999999994, -18.2, -10.1, -7.3, -7.9, -20.099999999999994, -11.299999999999999, -16.699999999999996, -17.5, -7.300000000000001, -18.699999999999996, -6.999999999999999, -17.3, -4.4, -8.3, -14.2, -13.6, -3.3, -5.300000000000001, -20.6, -6.4, -51.3, -11.499999999999998, -12.999999999999977, -5.2, -5.3, -25.699999999999996, -5.3, -6.300000000000001, -21.400000000000016, -12.2, -8.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9123237473547402, "mean_inference_ms": 1.1536041997421687, "mean_action_processing_ms": 0.0634457373413782, "mean_env_wait_ms": 5.2802267953531565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 272000, "timesteps_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"sample_time_ms": 14565.576, "sample_throughput": 274.62, "load_time_ms": 0.366, "load_throughput": 10921955.602, "learn_time_ms": 6842.389, "learn_throughput": 584.591, "update_time_ms": 1.497}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.13939894589204943, "policy_loss": -0.001714579811099396, "vf_loss": 14.089073006632507, "vf_explained_var": 0.2650946169771174, "kl": 0.008912060350863114, "entropy": 0.16731432403127353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 272000, "num_agent_steps_sampled": 272000, "num_steps_trained": 272000, "num_agent_steps_trained": 272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2720, "training_iteration": 68, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-58-16", "timestamp": 1643666296, "time_this_iter_s": 14.584433794021606, "time_total_s": 973.3114564418793, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 973.3114564418793, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.19047619047619, "ram_util_percent": 75.04761904761905}}
{"episode_reward_max": -3.3, "episode_reward_min": -51.3, "episode_reward_mean": -12.209999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.5, -14.1, -9.7, -9.600000000000001, -9.4, -4.300000000000001, -18.1, -4.4, -14.199999999999998, -11.2, -4.2, -17.2, -10.5, -9.2, -24.700000000000006, -15.0, -10.2, -9.0, -6.300000000000001, -8.4, -10.600000000000001, -3.900000000000001, -5.799999999999999, -3.4, -19.6, -13.299999999999995, -18.2, -5.3, -18.599999999999994, -18.2, -10.1, -7.3, -7.9, -20.099999999999994, -11.299999999999999, -16.699999999999996, -17.5, -7.300000000000001, -18.699999999999996, -6.999999999999999, -17.3, -4.4, -8.3, -14.2, -13.6, -3.3, -5.300000000000001, -20.6, -6.4, -51.3, -11.499999999999998, -12.999999999999977, -5.2, -5.3, -25.699999999999996, -5.3, -6.300000000000001, -21.400000000000016, -12.2, -8.199999999999998, -10.4, -10.099999999999998, -14.199999999999998, -9.100000000000001, -14.299999999999999, -16.9, -12.899999999999999, -20.80000000000003, -8.4, -12.2, -6.4, -4.300000000000001, -5.2, -9.700000000000001, -5.2, -14.899999999999999, -12.699999999999998, -22.2, -12.2, -23.2, -7.2, -11.8, -10.3, -13.499999999999998, -5.4, -9.499999999999996, -11.799999999999995, -13.79999999999998, -16.5, -9.699999999999998, -12.999999999999998, -13.2, -13.3, -21.799999999999997, -13.299999999999997, -14.0, -7.3, -13.5, -13.3, -11.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.911849196409663, "mean_inference_ms": 1.1535119826994387, "mean_action_processing_ms": 0.06343235861940398, "mean_env_wait_ms": 5.278751781625975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 276000, "timesteps_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"sample_time_ms": 14684.437, "sample_throughput": 272.397, "load_time_ms": 0.37, "load_throughput": 10802405.512, "learn_time_ms": 6829.147, "learn_throughput": 585.725, "update_time_ms": 1.432}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.09388930554081115, "policy_loss": 0.007823318446315425, "vf_loss": 8.593972607069118, "vf_explained_var": 0.2927145822714734, "kl": 0.0050505899160040195, "entropy": 0.14010122422409313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 276000, "num_agent_steps_sampled": 276000, "num_steps_trained": 276000, "num_agent_steps_trained": 276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2760, "training_iteration": 69, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-58-30", "timestamp": 1643666310, "time_this_iter_s": 14.304972171783447, "time_total_s": 987.6164286136627, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 987.6164286136627, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 30.545000000000005, "ram_util_percent": 74.98000000000002}}
{"episode_reward_max": -1.3, "episode_reward_min": -51.3, "episode_reward_mean": -11.920000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.3, -4.4, -8.3, -14.2, -13.6, -3.3, -5.300000000000001, -20.6, -6.4, -51.3, -11.499999999999998, -12.999999999999977, -5.2, -5.3, -25.699999999999996, -5.3, -6.300000000000001, -21.400000000000016, -12.2, -8.199999999999998, -10.4, -10.099999999999998, -14.199999999999998, -9.100000000000001, -14.299999999999999, -16.9, -12.899999999999999, -20.80000000000003, -8.4, -12.2, -6.4, -4.300000000000001, -5.2, -9.700000000000001, -5.2, -14.899999999999999, -12.699999999999998, -22.2, -12.2, -23.2, -7.2, -11.8, -10.3, -13.499999999999998, -5.4, -9.499999999999996, -11.799999999999995, -13.79999999999998, -16.5, -9.699999999999998, -12.999999999999998, -13.2, -13.3, -21.799999999999997, -13.299999999999997, -14.0, -7.3, -13.5, -13.3, -11.7, -15.099999999999996, -1.3, -25.5, -11.700000000000001, -21.699999999999985, -14.599999999999996, -21.5, -11.9, -11.899999999999999, -5.899999999999999, -14.799999999999999, -7.4, -17.500000000000004, -11.399999999999999, -10.3, -14.3, -6.2, -15.699999999999978, -4.2, -16.9, -3.2, -4.300000000000001, -4.300000000000001, -12.799999999999999, -6.4, -14.999999999999998, -8.899999999999999, -4.2, -5.2, -5.2, -21.500000000000007, -13.799999999999999, -9.1, -7.4, -5.4, -26.90000000000001, -9.699999999999998, -6.300000000000001, -3.4, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9116952544749162, "mean_inference_ms": 1.154248870811823, "mean_action_processing_ms": 0.06347018930008579, "mean_env_wait_ms": 5.281217799749113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 14621.414, "sample_throughput": 273.571, "load_time_ms": 0.368, "load_throughput": 10875229.144, "learn_time_ms": 6744.457, "learn_throughput": 593.08, "update_time_ms": 1.42}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.10255301950589543, "policy_loss": -0.0011685556281478173, "vf_loss": 10.357321613322021, "vf_explained_var": 0.14226148340009873, "kl": 0.005934460850590225, "entropy": 0.15386937653185218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2800, "training_iteration": 70, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-58-45", "timestamp": 1643666325, "time_this_iter_s": 14.668792724609375, "time_total_s": 1002.2852213382721, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1002.2852213382721, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 35.87619047619047, "ram_util_percent": 74.77619047619046}}
{"episode_reward_max": -1.3, "episode_reward_min": -44.3, "episode_reward_mean": -11.816999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -11.8, -10.3, -13.499999999999998, -5.4, -9.499999999999996, -11.799999999999995, -13.79999999999998, -16.5, -9.699999999999998, -12.999999999999998, -13.2, -13.3, -21.799999999999997, -13.299999999999997, -14.0, -7.3, -13.5, -13.3, -11.7, -15.099999999999996, -1.3, -25.5, -11.700000000000001, -21.699999999999985, -14.599999999999996, -21.5, -11.9, -11.899999999999999, -5.899999999999999, -14.799999999999999, -7.4, -17.500000000000004, -11.399999999999999, -10.3, -14.3, -6.2, -15.699999999999978, -4.2, -16.9, -3.2, -4.300000000000001, -4.300000000000001, -12.799999999999999, -6.4, -14.999999999999998, -8.899999999999999, -4.2, -5.2, -5.2, -21.500000000000007, -13.799999999999999, -9.1, -7.4, -5.4, -26.90000000000001, -9.699999999999998, -6.300000000000001, -3.4, -11.2, -26.3, -4.2, -16.7, -44.3, -4.2, -23.999999999999986, -18.4, -18.700000000000003, -10.1, -19.7, -9.600000000000001, -4.300000000000001, -3.3, -22.700000000000003, -5.300000000000001, -12.19999999999999, -6.899999999999998, -4.1, -12.6, -4.300000000000001, -22.8, -4.300000000000001, -7.899999999999999, -17.4, -8.5, -7.300000000000001, -4.3, -14.9, -15.999999999999996, -13.699999999999996, -10.6, -4.300000000000001, -7.5, -2.6000000000000005, -13.600000000000001, -15.599999999999998, -15.799999999999999, -14.7, -4.300000000000001, -15.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.911369928137558, "mean_inference_ms": 1.1551201138042726, "mean_action_processing_ms": 0.06351026835517644, "mean_env_wait_ms": 5.284001684808508, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 284000, "timesteps_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"sample_time_ms": 14574.523, "sample_throughput": 274.452, "load_time_ms": 0.377, "load_throughput": 10610432.583, "learn_time_ms": 6757.688, "learn_throughput": 591.918, "update_time_ms": 1.44}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.1305068167967982, "policy_loss": -0.013647358596164692, "vf_loss": 14.381034173375816, "vf_explained_var": 0.11616450586626606, "kl": 0.013753428816805864, "entropy": 0.13353332120284278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 284000, "num_agent_steps_sampled": 284000, "num_steps_trained": 284000, "num_agent_steps_trained": 284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2840, "training_iteration": 71, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-59-00", "timestamp": 1643666340, "time_this_iter_s": 14.473604202270508, "time_total_s": 1016.7588255405426, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1016.7588255405426, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 28.61904761904762, "ram_util_percent": 74.84285714285716}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -58.4, "episode_reward_mean": -11.599, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -4.300000000000001, -4.300000000000001, -12.799999999999999, -6.4, -14.999999999999998, -8.899999999999999, -4.2, -5.2, -5.2, -21.500000000000007, -13.799999999999999, -9.1, -7.4, -5.4, -26.90000000000001, -9.699999999999998, -6.300000000000001, -3.4, -11.2, -26.3, -4.2, -16.7, -44.3, -4.2, -23.999999999999986, -18.4, -18.700000000000003, -10.1, -19.7, -9.600000000000001, -4.300000000000001, -3.3, -22.700000000000003, -5.300000000000001, -12.19999999999999, -6.899999999999998, -4.1, -12.6, -4.300000000000001, -22.8, -4.300000000000001, -7.899999999999999, -17.4, -8.5, -7.300000000000001, -4.3, -14.9, -15.999999999999996, -13.699999999999996, -10.6, -4.300000000000001, -7.5, -2.6000000000000005, -13.600000000000001, -15.599999999999998, -15.799999999999999, -14.7, -4.300000000000001, -15.799999999999999, -9.2, -3.3, -9.0, -14.3, -10.999999999999998, -16.5, -14.9, -3.3, -9.8, -5.2, -7.2, -11.0, -5.8, -17.5, -5.2, -6.1, -15.2, -11.6, -4.300000000000001, -12.900000000000002, -19.00000000000003, -8.299999999999997, -14.799999999999999, -5.2, -13.200000000000001, -7.4, -4.2, -19.599999999999998, -19.60000000000001, -3.2, -10.799999999999999, -12.399999999999999, -12.2, -58.4, -11.5, -33.5, -7.400000000000002, -15.2, -3.2, -9.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9109840197832311, "mean_inference_ms": 1.1553491021555697, "mean_action_processing_ms": 0.06352401471221741, "mean_env_wait_ms": 5.284871975437563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 14557.509, "sample_throughput": 274.772, "load_time_ms": 0.373, "load_throughput": 10735357.051, "learn_time_ms": 6728.845, "learn_throughput": 594.456, "update_time_ms": 1.456}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.20382219297230564, "policy_loss": -0.00010793840773003075, "vf_loss": 20.37710564328778, "vf_explained_var": 0.0007604859208547941, "kl": 0.0063632275082251685, "entropy": 0.15949843626829885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 288000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2880, "training_iteration": 72, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-59-14", "timestamp": 1643666354, "time_this_iter_s": 13.986528158187866, "time_total_s": 1030.7453536987305, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1030.7453536987305, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 26.084999999999997, "ram_util_percent": 74.78999999999999}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -58.4, "episode_reward_mean": -11.298000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.8, -4.300000000000001, -7.899999999999999, -17.4, -8.5, -7.300000000000001, -4.3, -14.9, -15.999999999999996, -13.699999999999996, -10.6, -4.300000000000001, -7.5, -2.6000000000000005, -13.600000000000001, -15.599999999999998, -15.799999999999999, -14.7, -4.300000000000001, -15.799999999999999, -9.2, -3.3, -9.0, -14.3, -10.999999999999998, -16.5, -14.9, -3.3, -9.8, -5.2, -7.2, -11.0, -5.8, -17.5, -5.2, -6.1, -15.2, -11.6, -4.300000000000001, -12.900000000000002, -19.00000000000003, -8.299999999999997, -14.799999999999999, -5.2, -13.200000000000001, -7.4, -4.2, -19.599999999999998, -19.60000000000001, -3.2, -10.799999999999999, -12.399999999999999, -12.2, -58.4, -11.5, -33.5, -7.400000000000002, -15.2, -3.2, -9.5, -10.3, -5.2, -18.3, -11.2, -5.2, -22.500000000000014, -3.4, -4.2, -10.100000000000001, -3.2, -8.5, -20.20000000000001, -4.2, -24.4, -3.3, -11.8, -3.2, -9.3, -21.3, -10.3, -6.2, -5.2, -13.8, -33.3, -6.2, -11.3, -21.199999999999996, -8.5, -9.0, -13.7, -17.799999999999997, -16.2, -8.899999999999999, -8.3, -10.5, -9.299999999999999, -5.0, -4.3, -3.900000000000001, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.911209630859858, "mean_inference_ms": 1.155568772887128, "mean_action_processing_ms": 0.0635306344772273, "mean_env_wait_ms": 5.28594713131507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 292000, "timesteps_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"sample_time_ms": 14611.417, "sample_throughput": 273.759, "load_time_ms": 0.373, "load_throughput": 10729864.415, "learn_time_ms": 6991.252, "learn_throughput": 572.144, "update_time_ms": 1.498}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.13400708973527917, "policy_loss": -0.00690229234576065, "vf_loss": 14.067778724367901, "vf_explained_var": 0.1023730682429447, "kl": 0.009263900368122649, "entropy": 0.18126125641327392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 292000, "num_agent_steps_sampled": 292000, "num_steps_trained": 292000, "num_agent_steps_trained": 292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2920, "training_iteration": 73, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-59-31", "timestamp": 1643666371, "time_this_iter_s": 17.43733787536621, "time_total_s": 1048.1826915740967, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1048.1826915740967, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 31.436, "ram_util_percent": 74.88}}
{"episode_reward_max": -3.2, "episode_reward_min": -119.20000000000013, "episode_reward_mean": -12.797000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.00000000000003, -8.299999999999997, -14.799999999999999, -5.2, -13.200000000000001, -7.4, -4.2, -19.599999999999998, -19.60000000000001, -3.2, -10.799999999999999, -12.399999999999999, -12.2, -58.4, -11.5, -33.5, -7.400000000000002, -15.2, -3.2, -9.5, -10.3, -5.2, -18.3, -11.2, -5.2, -22.500000000000014, -3.4, -4.2, -10.100000000000001, -3.2, -8.5, -20.20000000000001, -4.2, -24.4, -3.3, -11.8, -3.2, -9.3, -21.3, -10.3, -6.2, -5.2, -13.8, -33.3, -6.2, -11.3, -21.199999999999996, -8.5, -9.0, -13.7, -17.799999999999997, -16.2, -8.899999999999999, -8.3, -10.5, -9.299999999999999, -5.0, -4.3, -3.900000000000001, -3.3, -11.4, -10.5, -119.20000000000013, -18.700000000000003, -12.599999999999994, -15.799999999999997, -4.4, -14.3, -10.799999999999999, -4.3, -3.3, -3.3, -4.2, -12.599999999999998, -7.3, -16.999999999999993, -18.000000000000004, -47.70000000000004, -15.799999999999999, -4.2, -7.3, -8.0, -3.4, -20.799999999999997, -4.300000000000001, -18.5, -14.600000000000001, -10.600000000000001, -13.999999999999982, -4.3, -15.199999999999998, -3.3, -5.300000000000001, -5.300000000000001, -15.199999999999969, -13.999999999999995, -15.899999999999997, -13.299999999999997, -11.2, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9119644483131364, "mean_inference_ms": 1.1568224942515262, "mean_action_processing_ms": 0.06360341008579805, "mean_env_wait_ms": 5.292647039751134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 296000, "timesteps_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"sample_time_ms": 15007.883, "sample_throughput": 266.527, "load_time_ms": 0.374, "load_throughput": 10695662.374, "learn_time_ms": 7057.062, "learn_throughput": 566.808, "update_time_ms": 1.457}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.9121523650756146, "policy_loss": -0.007086290886765847, "vf_loss": 91.90528186867314, "vf_explained_var": 0.2055288835879295, "kl": 0.007434481308650537, "entropy": 0.15819303500716403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 296000, "num_agent_steps_sampled": 296000, "num_steps_trained": 296000, "num_agent_steps_trained": 296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2960, "training_iteration": 74, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_21-59-48", "timestamp": 1643666388, "time_this_iter_s": 16.50361394882202, "time_total_s": 1064.6863055229187, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1064.6863055229187, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 26.68260869565218, "ram_util_percent": 74.37826086956524}}
{"episode_reward_max": -3.2, "episode_reward_min": -119.20000000000013, "episode_reward_mean": -12.191000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -5.2, -13.8, -33.3, -6.2, -11.3, -21.199999999999996, -8.5, -9.0, -13.7, -17.799999999999997, -16.2, -8.899999999999999, -8.3, -10.5, -9.299999999999999, -5.0, -4.3, -3.900000000000001, -3.3, -11.4, -10.5, -119.20000000000013, -18.700000000000003, -12.599999999999994, -15.799999999999997, -4.4, -14.3, -10.799999999999999, -4.3, -3.3, -3.3, -4.2, -12.599999999999998, -7.3, -16.999999999999993, -18.000000000000004, -47.70000000000004, -15.799999999999999, -4.2, -7.3, -8.0, -3.4, -20.799999999999997, -4.300000000000001, -18.5, -14.600000000000001, -10.600000000000001, -13.999999999999982, -4.3, -15.199999999999998, -3.3, -5.300000000000001, -5.300000000000001, -15.199999999999969, -13.999999999999995, -15.899999999999997, -13.299999999999997, -11.2, -5.2, -14.399999999999997, -25.3, -16.3, -7.2, -4.300000000000001, -14.799999999999999, -16.999999999999996, -3.3, -13.799999999999997, -18.800000000000022, -22.600000000000005, -9.2, -3.2, -5.5, -18.4, -5.300000000000001, -4.2, -6.300000000000001, -9.9, -10.9, -23.3, -5.300000000000001, -22.599999999999998, -9.2, -8.2, -3.3, -3.3, -10.199999999999998, -11.0, -5.3, -14.9, -5.6000000000000005, -9.700000000000001, -14.099999999999996, -3.2, -4.300000000000001, -9.699999999999998, -14.2, -24.799999999999997, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.912588472258679, "mean_inference_ms": 1.1584659034125022, "mean_action_processing_ms": 0.06369430644539814, "mean_env_wait_ms": 5.300514325407176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 15131.054, "sample_throughput": 264.357, "load_time_ms": 0.371, "load_throughput": 10788512.636, "learn_time_ms": 7091.438, "learn_throughput": 564.061, "update_time_ms": 1.455}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.09406841861144188, "policy_loss": -0.00831583983875731, "vf_loss": 10.22372832496961, "vf_explained_var": 0.09270742208726944, "kl": 0.0058792532003962335, "entropy": 0.13034451679396694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3000, "training_iteration": 75, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-00-03", "timestamp": 1643666403, "time_this_iter_s": 15.280988931655884, "time_total_s": 1079.9672944545746, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1079.9672944545746, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 26.677272727272722, "ram_util_percent": 74.4818181818182}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -31.2, "episode_reward_mean": -10.443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3, -8.0, -3.4, -20.799999999999997, -4.300000000000001, -18.5, -14.600000000000001, -10.600000000000001, -13.999999999999982, -4.3, -15.199999999999998, -3.3, -5.300000000000001, -5.300000000000001, -15.199999999999969, -13.999999999999995, -15.899999999999997, -13.299999999999997, -11.2, -5.2, -14.399999999999997, -25.3, -16.3, -7.2, -4.300000000000001, -14.799999999999999, -16.999999999999996, -3.3, -13.799999999999997, -18.800000000000022, -22.600000000000005, -9.2, -3.2, -5.5, -18.4, -5.300000000000001, -4.2, -6.300000000000001, -9.9, -10.9, -23.3, -5.300000000000001, -22.599999999999998, -9.2, -8.2, -3.3, -3.3, -10.199999999999998, -11.0, -5.3, -14.9, -5.6000000000000005, -9.700000000000001, -14.099999999999996, -3.2, -4.300000000000001, -9.699999999999998, -14.2, -24.799999999999997, -5.2, -13.799999999999994, -9.799999999999999, -22.900000000000002, -2.9000000000000004, -14.6, -7.700000000000001, -5.300000000000001, -15.499999999999998, -4.4, -12.2, -6.3, -11.7, -13.5, -5.300000000000001, -4.2, -6.300000000000001, -31.2, -4.2, -18.999999999999975, -15.999999999999988, -4.2, -15.7, -9.2, -6.2, -9.99999999999999, -3.3, -4.300000000000001, -15.899999999999999, -4.300000000000001, -23.6, -5.300000000000001, -9.199999999999998, -8.1, -6.999999999999998, -14.499999999999998, -3.3, -4.300000000000001, -4.300000000000001, -6.0, -10.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9132306312060515, "mean_inference_ms": 1.159533514836661, "mean_action_processing_ms": 0.06375646991324942, "mean_env_wait_ms": 5.305261217071947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 304000, "timesteps_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"sample_time_ms": 15091.061, "sample_throughput": 265.058, "load_time_ms": 0.357, "load_throughput": 11208722.608, "learn_time_ms": 7196.117, "learn_throughput": 555.855, "update_time_ms": 1.466}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.0740659680788315, "policy_loss": -0.006302231045499924, "vf_loss": 8.01599010277179, "vf_explained_var": 0.356530330129849, "kl": 0.0083320624226311, "entropy": 0.1310633506645919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 304000, "num_agent_steps_sampled": 304000, "num_steps_trained": 304000, "num_agent_steps_trained": 304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3040, "training_iteration": 76, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-00-19", "timestamp": 1643666419, "time_this_iter_s": 15.680737733840942, "time_total_s": 1095.6480321884155, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1095.6480321884155, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 28.70909090909091, "ram_util_percent": 74.39545454545456}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -31.2, "episode_reward_mean": -9.208999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.3, -5.300000000000001, -22.599999999999998, -9.2, -8.2, -3.3, -3.3, -10.199999999999998, -11.0, -5.3, -14.9, -5.6000000000000005, -9.700000000000001, -14.099999999999996, -3.2, -4.300000000000001, -9.699999999999998, -14.2, -24.799999999999997, -5.2, -13.799999999999994, -9.799999999999999, -22.900000000000002, -2.9000000000000004, -14.6, -7.700000000000001, -5.300000000000001, -15.499999999999998, -4.4, -12.2, -6.3, -11.7, -13.5, -5.300000000000001, -4.2, -6.300000000000001, -31.2, -4.2, -18.999999999999975, -15.999999999999988, -4.2, -15.7, -9.2, -6.2, -9.99999999999999, -3.3, -4.300000000000001, -15.899999999999999, -4.300000000000001, -23.6, -5.300000000000001, -9.199999999999998, -8.1, -6.999999999999998, -14.499999999999998, -3.3, -4.300000000000001, -4.300000000000001, -6.0, -10.999999999999998, -3.2, -4.2, -12.3, -12.2, -4.300000000000001, -14.399999999999999, -3.3, -11.6, -4.300000000000001, -3.2, -11.3, -4.2, -6.300000000000001, -7.300000000000001, -16.199999999999996, -3.3, -6.3, -22.0, -15.599999999999996, -3.900000000000001, -3.3, -3.2, -5.3, -8.299999999999997, -13.399999999999999, -10.099999999999998, -3.3, -16.599999999999994, -4.3, -4.2, -6.699999999999998, -3.2, -13.6, -12.499999999999979, -7.999999999999998, -3.3, -14.299999999999995, -3.3, -7.5, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9146935510943759, "mean_inference_ms": 1.161866340849111, "mean_action_processing_ms": 0.06388737056233261, "mean_env_wait_ms": 5.314958422150175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 308000, "timesteps_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"sample_time_ms": 15413.788, "sample_throughput": 259.508, "load_time_ms": 0.361, "load_throughput": 11087242.929, "learn_time_ms": 7348.014, "learn_throughput": 544.365, "update_time_ms": 1.492}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.03775493590641887, "policy_loss": -0.009078593543976025, "vf_loss": 4.65901190532792, "vf_explained_var": 0.395023294930817, "kl": 0.00973650917688326, "entropy": 0.1616920138338721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 308000, "num_agent_steps_sampled": 308000, "num_steps_trained": 308000, "num_agent_steps_trained": 308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3080, "training_iteration": 77, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-00-37", "timestamp": 1643666437, "time_this_iter_s": 18.579530954360962, "time_total_s": 1114.2275631427765, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1114.2275631427765, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 41.03076923076924, "ram_util_percent": 73.99999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.700000000000045, "episode_reward_mean": -9.28, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -15.7, -9.2, -6.2, -9.99999999999999, -3.3, -4.300000000000001, -15.899999999999999, -4.300000000000001, -23.6, -5.300000000000001, -9.199999999999998, -8.1, -6.999999999999998, -14.499999999999998, -3.3, -4.300000000000001, -4.300000000000001, -6.0, -10.999999999999998, -3.2, -4.2, -12.3, -12.2, -4.300000000000001, -14.399999999999999, -3.3, -11.6, -4.300000000000001, -3.2, -11.3, -4.2, -6.300000000000001, -7.300000000000001, -16.199999999999996, -3.3, -6.3, -22.0, -15.599999999999996, -3.900000000000001, -3.3, -3.2, -5.3, -8.299999999999997, -13.399999999999999, -10.099999999999998, -3.3, -16.599999999999994, -4.3, -4.2, -6.699999999999998, -3.2, -13.6, -12.499999999999979, -7.999999999999998, -3.3, -14.299999999999995, -3.3, -7.5, -3.2, -4.300000000000001, -9.899999999999999, -6.3, -4.2, -8.699999999999998, -45.700000000000045, -12.399999999999995, -7.2, -3.4, -9.3, -15.099999999999998, -5.2, -32.800000000000054, -7.699999999999999, -11.4, -5.3, -11.399999999999993, -4.3, -11.5, -12.199999999999998, -21.599999999999998, -13.2, -7.2, -8.2, -15.1, -12.199999999999996, -5.3, -4.300000000000001, -12.399999999999999, -3.2, -18.400000000000002, -10.899999999999999, -7.3, -4.2, -18.1, -3.2, -33.5, -4.300000000000001, -6.2, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.916751489424072, "mean_inference_ms": 1.1645232884942158, "mean_action_processing_ms": 0.06404008009698034, "mean_env_wait_ms": 5.326637981189143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"sample_time_ms": 15693.23, "sample_throughput": 254.887, "load_time_ms": 0.361, "load_throughput": 11075532.083, "learn_time_ms": 7353.424, "learn_throughput": 543.964, "update_time_ms": 1.483}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.16831545359705405, "policy_loss": -0.007266385893347443, "vf_loss": 17.512834056346648, "vf_explained_var": 0.2562432852483565, "kl": 0.018140054722200333, "entropy": 0.1713678991141659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 312000, "num_agent_steps_trained": 312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3120, "training_iteration": 78, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-00-53", "timestamp": 1643666453, "time_this_iter_s": 15.927826166152954, "time_total_s": 1130.1553893089294, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1130.1553893089294, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 31.86086956521739, "ram_util_percent": 73.91304347826086}}
{"episode_reward_max": -2.5, "episode_reward_min": -45.700000000000045, "episode_reward_mean": -10.43, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -3.2, -5.3, -8.299999999999997, -13.399999999999999, -10.099999999999998, -3.3, -16.599999999999994, -4.3, -4.2, -6.699999999999998, -3.2, -13.6, -12.499999999999979, -7.999999999999998, -3.3, -14.299999999999995, -3.3, -7.5, -3.2, -4.300000000000001, -9.899999999999999, -6.3, -4.2, -8.699999999999998, -45.700000000000045, -12.399999999999995, -7.2, -3.4, -9.3, -15.099999999999998, -5.2, -32.800000000000054, -7.699999999999999, -11.4, -5.3, -11.399999999999993, -4.3, -11.5, -12.199999999999998, -21.599999999999998, -13.2, -7.2, -8.2, -15.1, -12.199999999999996, -5.3, -4.300000000000001, -12.399999999999999, -3.2, -18.400000000000002, -10.899999999999999, -7.3, -4.2, -18.1, -3.2, -33.5, -4.300000000000001, -6.2, -4.2, -14.899999999999999, -6.799999999999999, -14.399999999999999, -5.799999999999998, -5.3, -12.799999999999999, -10.5, -18.2, -5.3, -13.3, -10.5, -5.300000000000001, -8.2, -2.5, -3.3, -28.200000000000045, -13.3, -23.599999999999998, -4.3, -5.799999999999999, -13.7, -5.2, -11.7, -21.500000000000004, -3.2, -16.799999999999997, -3.3, -4.300000000000001, -24.500000000000004, -10.700000000000001, -3.3, -14.499999999999996, -15.2, -11.899999999999999, -3.3, -22.9, -7.499999999999998, -11.199999999999987, -19.6, -17.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9185162120212829, "mean_inference_ms": 1.1664633986802202, "mean_action_processing_ms": 0.0641539534775996, "mean_env_wait_ms": 5.334633691630841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 316000, "timesteps_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"sample_time_ms": 15747.814, "sample_throughput": 254.004, "load_time_ms": 0.36, "load_throughput": 11115155.691, "learn_time_ms": 7401.478, "learn_throughput": 540.433, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.10406341433765427, "policy_loss": -0.0015785267516489952, "vf_loss": 10.550975424564013, "vf_explained_var": 0.2832876835459022, "kl": 0.005287540970617736, "entropy": 0.20310004778526802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 316000, "num_agent_steps_sampled": 316000, "num_steps_trained": 316000, "num_agent_steps_trained": 316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3160, "training_iteration": 79, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-01-08", "timestamp": 1643666468, "time_this_iter_s": 15.280926942825317, "time_total_s": 1145.4363162517548, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1145.4363162517548, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 29.81363636363636, "ram_util_percent": 73.84090909090907}}
{"episode_reward_max": -2.5, "episode_reward_min": -33.5, "episode_reward_mean": -10.436999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.599999999999998, -13.2, -7.2, -8.2, -15.1, -12.199999999999996, -5.3, -4.300000000000001, -12.399999999999999, -3.2, -18.400000000000002, -10.899999999999999, -7.3, -4.2, -18.1, -3.2, -33.5, -4.300000000000001, -6.2, -4.2, -14.899999999999999, -6.799999999999999, -14.399999999999999, -5.799999999999998, -5.3, -12.799999999999999, -10.5, -18.2, -5.3, -13.3, -10.5, -5.300000000000001, -8.2, -2.5, -3.3, -28.200000000000045, -13.3, -23.599999999999998, -4.3, -5.799999999999999, -13.7, -5.2, -11.7, -21.500000000000004, -3.2, -16.799999999999997, -3.3, -4.300000000000001, -24.500000000000004, -10.700000000000001, -3.3, -14.499999999999996, -15.2, -11.899999999999999, -3.3, -22.9, -7.499999999999998, -11.199999999999987, -19.6, -17.5, -14.299999999999999, -4.4, -4.2, -6.999999999999998, -3.2, -14.799999999999997, -3.2, -19.500000000000004, -3.2, -14.899999999999999, -15.299999999999995, -17.6, -21.6, -17.3, -8.799999999999999, -8.3, -3.3, -4.300000000000001, -5.300000000000001, -6.2, -6.2, -13.599999999999998, -4.2, -5.300000000000001, -13.399999999999997, -13.499999999999998, -3.3, -7.300000000000001, -11.499999999999996, -3.2, -3.3, -3.3, -7.5, -6.3, -26.200000000000006, -3.3, -13.299999999999997, -12.799999999999999, -5.3, -17.099999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9196520598008839, "mean_inference_ms": 1.1672773685217135, "mean_action_processing_ms": 0.06420325413639633, "mean_env_wait_ms": 5.337983963214415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 15764.358, "sample_throughput": 253.737, "load_time_ms": 0.363, "load_throughput": 11020241.724, "learn_time_ms": 7512.875, "learn_throughput": 532.419, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.0700378372136163, "policy_loss": 0.002165664721941275, "vf_loss": 6.770313822822545, "vf_explained_var": 0.4449301188351006, "kl": 0.006761408721034222, "entropy": 0.15784304865425633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3200, "training_iteration": 80, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-01-24", "timestamp": 1643666484, "time_this_iter_s": 15.470389127731323, "time_total_s": 1160.906705379486, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1160.906705379486, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 27.36363636363637, "ram_util_percent": 73.91363636363639}}
{"episode_reward_max": -3.2, "episode_reward_min": -50.3, "episode_reward_mean": -10.188999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.7, -5.2, -11.7, -21.500000000000004, -3.2, -16.799999999999997, -3.3, -4.300000000000001, -24.500000000000004, -10.700000000000001, -3.3, -14.499999999999996, -15.2, -11.899999999999999, -3.3, -22.9, -7.499999999999998, -11.199999999999987, -19.6, -17.5, -14.299999999999999, -4.4, -4.2, -6.999999999999998, -3.2, -14.799999999999997, -3.2, -19.500000000000004, -3.2, -14.899999999999999, -15.299999999999995, -17.6, -21.6, -17.3, -8.799999999999999, -8.3, -3.3, -4.300000000000001, -5.300000000000001, -6.2, -6.2, -13.599999999999998, -4.2, -5.300000000000001, -13.399999999999997, -13.499999999999998, -3.3, -7.300000000000001, -11.499999999999996, -3.2, -3.3, -3.3, -7.5, -6.3, -26.200000000000006, -3.3, -13.299999999999997, -12.799999999999999, -5.3, -17.099999999999987, -23.200000000000014, -10.3, -3.3, -5.300000000000001, -4.4, -11.099999999999998, -9.2, -16.1, -15.999999999999996, -4.300000000000001, -10.999999999999998, -3.3, -5.3, -5.2, -50.3, -6.3, -13.600000000000001, -3.2, -11.899999999999999, -3.2, -13.199999999999998, -4.300000000000001, -13.499999999999996, -3.3, -15.899999999999999, -19.800000000000004, -7.3, -4.300000000000001, -10.0, -5.3, -6.3999999999999995, -18.6, -3.2, -16.1, -12.199999999999998, -9.5, -3.2, -7.3, -3.3, -7.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.920743377628865, "mean_inference_ms": 1.1678956104273925, "mean_action_processing_ms": 0.06423532216576328, "mean_env_wait_ms": 5.341000791668625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 324000, "timesteps_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"sample_time_ms": 15951.779, "sample_throughput": 250.756, "load_time_ms": 0.352, "load_throughput": 11353600.866, "learn_time_ms": 7515.191, "learn_throughput": 532.255, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.08460723024051917, "policy_loss": -0.004307393552435021, "vf_loss": 8.876856825829194, "vf_explained_var": 0.43382442990938824, "kl": 0.005842288921999998, "entropy": 0.18110738461136178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 324000, "num_agent_steps_sampled": 324000, "num_steps_trained": 324000, "num_agent_steps_trained": 324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3240, "training_iteration": 81, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-01-39", "timestamp": 1643666499, "time_this_iter_s": 15.25385069847107, "time_total_s": 1176.1605560779572, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1176.1605560779572, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 27.45, "ram_util_percent": 73.69090909090909}}
{"episode_reward_max": -3.2, "episode_reward_min": -189.20000000000033, "episode_reward_mean": -12.204000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -13.599999999999998, -4.2, -5.300000000000001, -13.399999999999997, -13.499999999999998, -3.3, -7.300000000000001, -11.499999999999996, -3.2, -3.3, -3.3, -7.5, -6.3, -26.200000000000006, -3.3, -13.299999999999997, -12.799999999999999, -5.3, -17.099999999999987, -23.200000000000014, -10.3, -3.3, -5.300000000000001, -4.4, -11.099999999999998, -9.2, -16.1, -15.999999999999996, -4.300000000000001, -10.999999999999998, -3.3, -5.3, -5.2, -50.3, -6.3, -13.600000000000001, -3.2, -11.899999999999999, -3.2, -13.199999999999998, -4.300000000000001, -13.499999999999996, -3.3, -15.899999999999999, -19.800000000000004, -7.3, -4.300000000000001, -10.0, -5.3, -6.3999999999999995, -18.6, -3.2, -16.1, -12.199999999999998, -9.5, -3.2, -7.3, -3.3, -7.3, -4.2, -4.300000000000001, -6.300000000000001, -10.3, -13.8, -18.400000000000002, -189.20000000000033, -23.6, -12.099999999999998, -4.2, -12.2, -6.3, -11.199999999999998, -13.7, -3.3, -3.3, -22.2, -15.599999999999998, -5.2, -4.3, -22.200000000000003, -20.0, -24.1, -8.600000000000001, -3.3, -10.199999999999998, -9.4, -5.4, -16.9, -3.3, -15.199999999999996, -15.999999999999998, -13.899999999999999, -13.099999999999996, -3.2, -10.700000000000001, -19.3, -6.400000000000002, -14.599999999999998, -20.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9211505147951397, "mean_inference_ms": 1.1691538747058017, "mean_action_processing_ms": 0.06426973199648105, "mean_env_wait_ms": 5.345266674600341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 328000, "timesteps_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"sample_time_ms": 16027.362, "sample_throughput": 249.573, "load_time_ms": 0.372, "load_throughput": 10764285.898, "learn_time_ms": 7582.609, "learn_throughput": 527.523, "update_time_ms": 1.557}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 1.7302888019600011, "policy_loss": -0.008652010730778177, "vf_loss": 173.8666499204533, "vf_explained_var": 0.09974991993237567, "kl": 0.010974578721493482, "entropy": 0.23087712870410051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 328000, "num_agent_steps_sampled": 328000, "num_steps_trained": 328000, "num_agent_steps_trained": 328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3280, "training_iteration": 82, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-01-55", "timestamp": 1643666515, "time_this_iter_s": 15.39228081703186, "time_total_s": 1191.552836894989, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1191.552836894989, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 26.0, "ram_util_percent": 73.33809523809522}}
{"episode_reward_max": -3.2, "episode_reward_min": -189.20000000000033, "episode_reward_mean": -14.017000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.199999999999998, -4.300000000000001, -13.499999999999996, -3.3, -15.899999999999999, -19.800000000000004, -7.3, -4.300000000000001, -10.0, -5.3, -6.3999999999999995, -18.6, -3.2, -16.1, -12.199999999999998, -9.5, -3.2, -7.3, -3.3, -7.3, -4.2, -4.300000000000001, -6.300000000000001, -10.3, -13.8, -18.400000000000002, -189.20000000000033, -23.6, -12.099999999999998, -4.2, -12.2, -6.3, -11.199999999999998, -13.7, -3.3, -3.3, -22.2, -15.599999999999998, -5.2, -4.3, -22.200000000000003, -20.0, -24.1, -8.600000000000001, -3.3, -10.199999999999998, -9.4, -5.4, -16.9, -3.3, -15.199999999999996, -15.999999999999998, -13.899999999999999, -13.099999999999996, -3.2, -10.700000000000001, -19.3, -6.400000000000002, -14.599999999999998, -20.5, -22.700000000000014, -8.799999999999997, -3.2, -30.2, -21.5, -4.2, -7.9, -20.1, -15.499999999999995, -10.5, -17.900000000000006, -8.7, -4.2, -25.700000000000006, -20.6, -13.299999999999999, -18.1, -11.899999999999999, -5.2, -18.6, -18.600000000000016, -8.7, -9.0, -17.099999999999994, -3.2, -19.2, -4.300000000000001, -14.899999999999999, -10.2, -20.500000000000004, -18.3, -4.3, -12.099999999999996, -34.80000000000001, -34.2, -11.499999999999998, -14.3, -10.7, -5.3, -17.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9213020966629404, "mean_inference_ms": 1.1702010766469704, "mean_action_processing_ms": 0.06429287804911336, "mean_env_wait_ms": 5.348290433315373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 332000, "timesteps_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"sample_time_ms": 16054.696, "sample_throughput": 249.148, "load_time_ms": 0.368, "load_throughput": 10859742.378, "learn_time_ms": 7365.39, "learn_throughput": 543.081, "update_time_ms": 1.549}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.16872465006646611, "policy_loss": -0.0031600825118041167, "vf_loss": 17.16448437859935, "vf_explained_var": 0.15050595216853643, "kl": 0.009595715016690693, "entropy": 0.2348285416441579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 332000, "num_agent_steps_sampled": 332000, "num_steps_trained": 332000, "num_agent_steps_trained": 332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3320, "training_iteration": 83, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-02-09", "timestamp": 1643666529, "time_this_iter_s": 14.861629009246826, "time_total_s": 1206.4144659042358, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1206.4144659042358, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.213636363636365, "ram_util_percent": 71.73636363636365}}
{"episode_reward_max": -1.5000000000000002, "episode_reward_min": -34.80000000000001, "episode_reward_mean": -12.931, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.200000000000003, -20.0, -24.1, -8.600000000000001, -3.3, -10.199999999999998, -9.4, -5.4, -16.9, -3.3, -15.199999999999996, -15.999999999999998, -13.899999999999999, -13.099999999999996, -3.2, -10.700000000000001, -19.3, -6.400000000000002, -14.599999999999998, -20.5, -22.700000000000014, -8.799999999999997, -3.2, -30.2, -21.5, -4.2, -7.9, -20.1, -15.499999999999995, -10.5, -17.900000000000006, -8.7, -4.2, -25.700000000000006, -20.6, -13.299999999999999, -18.1, -11.899999999999999, -5.2, -18.6, -18.600000000000016, -8.7, -9.0, -17.099999999999994, -3.2, -19.2, -4.300000000000001, -14.899999999999999, -10.2, -20.500000000000004, -18.3, -4.3, -12.099999999999996, -34.80000000000001, -34.2, -11.499999999999998, -14.3, -10.7, -5.3, -17.700000000000003, -27.000000000000014, -10.999999999999998, -4.800000000000001, -6.3, -16.599999999999998, -20.4, -6.3, -7.399999999999999, -2.4000000000000004, -19.9, -9.3, -21.199999999999996, -5.2, -18.700000000000003, -16.799999999999997, -33.6, -13.7, -28.6, -15.3, -1.5000000000000002, -3.3, -14.299999999999997, -6.4, -8.3, -9.499999999999998, -12.399999999999999, -7.2, -11.399999999999999, -3.3, -18.5, -5.2, -4.3, -11.799999999999997, -20.7, -3.4, -4.2, -4.300000000000001, -5.2, -3.3, -16.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9221002714233002, "mean_inference_ms": 1.171211325363216, "mean_action_processing_ms": 0.06433673874966458, "mean_env_wait_ms": 5.349754551086704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"sample_time_ms": 15755.77, "sample_throughput": 253.875, "load_time_ms": 0.366, "load_throughput": 10918401.666, "learn_time_ms": 7340.719, "learn_throughput": 544.906, "update_time_ms": 1.572}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.13283058075454607, "policy_loss": -0.00913259210465576, "vf_loss": 14.153770451455989, "vf_explained_var": 0.09568014439716134, "kl": 0.017018871421161128, "entropy": 0.24697697509520797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 336000, "num_agent_steps_trained": 336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3360, "training_iteration": 84, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-02-25", "timestamp": 1643666545, "time_this_iter_s": 15.428967952728271, "time_total_s": 1221.843433856964, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1221.843433856964, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 26.922727272727272, "ram_util_percent": 70.05454545454542}}
{"episode_reward_max": -1.5000000000000002, "episode_reward_min": -35.900000000000006, "episode_reward_mean": -12.737999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.600000000000016, -8.7, -9.0, -17.099999999999994, -3.2, -19.2, -4.300000000000001, -14.899999999999999, -10.2, -20.500000000000004, -18.3, -4.3, -12.099999999999996, -34.80000000000001, -34.2, -11.499999999999998, -14.3, -10.7, -5.3, -17.700000000000003, -27.000000000000014, -10.999999999999998, -4.800000000000001, -6.3, -16.599999999999998, -20.4, -6.3, -7.399999999999999, -2.4000000000000004, -19.9, -9.3, -21.199999999999996, -5.2, -18.700000000000003, -16.799999999999997, -33.6, -13.7, -28.6, -15.3, -1.5000000000000002, -3.3, -14.299999999999997, -6.4, -8.3, -9.499999999999998, -12.399999999999999, -7.2, -11.399999999999999, -3.3, -18.5, -5.2, -4.3, -11.799999999999997, -20.7, -3.4, -4.2, -4.300000000000001, -5.2, -3.3, -16.099999999999998, -4.3, -9.1, -17.4, -14.6, -5.300000000000001, -5.199999999999999, -4.2, -23.5, -13.3, -11.999999999999998, -10.100000000000001, -17.4, -5.300000000000001, -35.900000000000006, -19.0, -16.099999999999987, -21.5, -9.2, -12.799999999999997, -20.800000000000004, -17.9, -13.3, -15.699999999999973, -5.300000000000001, -6.2, -26.700000000000003, -4.4, -10.6, -5.2, -21.999999999999996, -22.200000000000003, -4.900000000000001, -15.399999999999999, -15.199999999999998, -16.799999999999997, -3.2, -8.799999999999997, -28.099999999999998, -1.6000000000000003, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9226554813219465, "mean_inference_ms": 1.171629933630838, "mean_action_processing_ms": 0.06438128515632469, "mean_env_wait_ms": 5.351535089470319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 15696.628, "sample_throughput": 254.832, "load_time_ms": 0.367, "load_throughput": 10897834.362, "learn_time_ms": 7336.179, "learn_throughput": 545.243, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.16041034583442954, "policy_loss": -0.003793775548617686, "vf_loss": 16.402346468869077, "vf_explained_var": 0.24810337443505565, "kl": 0.007226313243873175, "entropy": 0.2472015076346936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3400, "training_iteration": 85, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-02-40", "timestamp": 1643666560, "time_this_iter_s": 14.891478776931763, "time_total_s": 1236.7349126338959, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1236.7349126338959, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 21.19047619047619, "ram_util_percent": 70.09523809523807}}
{"episode_reward_max": -1.6000000000000003, "episode_reward_min": -44.4, "episode_reward_mean": -12.037, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -14.299999999999997, -6.4, -8.3, -9.499999999999998, -12.399999999999999, -7.2, -11.399999999999999, -3.3, -18.5, -5.2, -4.3, -11.799999999999997, -20.7, -3.4, -4.2, -4.300000000000001, -5.2, -3.3, -16.099999999999998, -4.3, -9.1, -17.4, -14.6, -5.300000000000001, -5.199999999999999, -4.2, -23.5, -13.3, -11.999999999999998, -10.100000000000001, -17.4, -5.300000000000001, -35.900000000000006, -19.0, -16.099999999999987, -21.5, -9.2, -12.799999999999997, -20.800000000000004, -17.9, -13.3, -15.699999999999973, -5.300000000000001, -6.2, -26.700000000000003, -4.4, -10.6, -5.2, -21.999999999999996, -22.200000000000003, -4.900000000000001, -15.399999999999999, -15.199999999999998, -16.799999999999997, -3.2, -8.799999999999997, -28.099999999999998, -1.6000000000000003, -5.3, -6.2, -3.4, -16.2, -13.399999999999999, -3.2, -8.3, -4.4, -4.300000000000001, -4.3, -12.599999999999998, -10.1, -9.999999999999998, -36.40000000000001, -29.00000000000002, -13.6, -8.2, -9.700000000000001, -8.3, -5.300000000000001, -13.1, -24.3, -11.2, -18.5, -13.7, -4.800000000000001, -11.299999999999997, -7.1999999999999975, -10.399999999999999, -14.599999999999998, -9.899999999999999, -44.4, -4.4, -28.200000000000045, -16.2, -14.399999999999997, -3.3, -14.999999999999998, -6.300000000000001, -6.2, -20.50000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9225118957795589, "mean_inference_ms": 1.1720551243856614, "mean_action_processing_ms": 0.06440136847491289, "mean_env_wait_ms": 5.35397938136158, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 344000, "timesteps_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"sample_time_ms": 15710.055, "sample_throughput": 254.614, "load_time_ms": 0.364, "load_throughput": 11000731.755, "learn_time_ms": 7246.702, "learn_throughput": 551.975, "update_time_ms": 1.568}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.1835997435464574, "policy_loss": -0.004980757415935557, "vf_loss": 18.844483814508685, "vf_explained_var": 0.14155938862472453, "kl": 0.005426639401554136, "entropy": 0.20540389754278685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 344000, "num_agent_steps_sampled": 344000, "num_steps_trained": 344000, "num_agent_steps_trained": 344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3440, "training_iteration": 86, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-02-55", "timestamp": 1643666575, "time_this_iter_s": 14.959851026535034, "time_total_s": 1251.694763660431, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1251.694763660431, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 19.995238095238097, "ram_util_percent": 70.1857142857143}}
{"episode_reward_max": -1.6000000000000003, "episode_reward_min": -87.39999999999999, "episode_reward_mean": -12.677999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.9, -13.3, -15.699999999999973, -5.300000000000001, -6.2, -26.700000000000003, -4.4, -10.6, -5.2, -21.999999999999996, -22.200000000000003, -4.900000000000001, -15.399999999999999, -15.199999999999998, -16.799999999999997, -3.2, -8.799999999999997, -28.099999999999998, -1.6000000000000003, -5.3, -6.2, -3.4, -16.2, -13.399999999999999, -3.2, -8.3, -4.4, -4.300000000000001, -4.3, -12.599999999999998, -10.1, -9.999999999999998, -36.40000000000001, -29.00000000000002, -13.6, -8.2, -9.700000000000001, -8.3, -5.300000000000001, -13.1, -24.3, -11.2, -18.5, -13.7, -4.800000000000001, -11.299999999999997, -7.1999999999999975, -10.399999999999999, -14.599999999999998, -9.899999999999999, -44.4, -4.4, -28.200000000000045, -16.2, -14.399999999999997, -3.3, -14.999999999999998, -6.300000000000001, -6.2, -20.50000000000003, -6.3, -13.999999999999998, -5.2, -3.3, -21.8, -4.2, -6.2, -17.799999999999997, -4.800000000000001, -3.3, -5.2, -3.4, -16.5, -9.199999999999987, -6.300000000000001, -87.39999999999999, -4.2, -19.199999999999996, -10.3, -4.800000000000001, -11.3, -7.299999999999999, -12.799999999999999, -11.999999999999996, -18.800000000000004, -8.5, -11.2, -4.700000000000001, -3.3, -3.3, -6.0, -10.3, -22.3, -68.0, -9.3, -4.9, -3.2, -7.199999999999998, -22.1, -14.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9220701581777427, "mean_inference_ms": 1.1722986204189954, "mean_action_processing_ms": 0.06446567131489093, "mean_env_wait_ms": 5.355878709248373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 348000, "timesteps_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"sample_time_ms": 15406.551, "sample_throughput": 259.63, "load_time_ms": 0.362, "load_throughput": 11046362.918, "learn_time_ms": 7072.827, "learn_throughput": 565.545, "update_time_ms": 1.553}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.6534091965888718, "policy_loss": -0.002799799182622503, "vf_loss": 65.60018520252679, "vf_explained_var": -0.19369971059983776, "kl": 0.008286252507575928, "entropy": 0.20390499598316608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 348000, "num_agent_steps_sampled": 348000, "num_steps_trained": 348000, "num_agent_steps_trained": 348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3480, "training_iteration": 87, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-03-10", "timestamp": 1643666590, "time_this_iter_s": 14.68654990196228, "time_total_s": 1266.3813135623932, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1266.3813135623932, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.642857142857142, "ram_util_percent": 70.25714285714285}}
{"episode_reward_max": -2.5, "episode_reward_min": -87.39999999999999, "episode_reward_mean": -13.654000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.3, -11.2, -18.5, -13.7, -4.800000000000001, -11.299999999999997, -7.1999999999999975, -10.399999999999999, -14.599999999999998, -9.899999999999999, -44.4, -4.4, -28.200000000000045, -16.2, -14.399999999999997, -3.3, -14.999999999999998, -6.300000000000001, -6.2, -20.50000000000003, -6.3, -13.999999999999998, -5.2, -3.3, -21.8, -4.2, -6.2, -17.799999999999997, -4.800000000000001, -3.3, -5.2, -3.4, -16.5, -9.199999999999987, -6.300000000000001, -87.39999999999999, -4.2, -19.199999999999996, -10.3, -4.800000000000001, -11.3, -7.299999999999999, -12.799999999999999, -11.999999999999996, -18.800000000000004, -8.5, -11.2, -4.700000000000001, -3.3, -3.3, -6.0, -10.3, -22.3, -68.0, -9.3, -4.9, -3.2, -7.199999999999998, -22.1, -14.3, -25.3, -3.4, -3.3, -8.5, -9.3, -18.0, -10.3, -2.6000000000000005, -9.3, -11.2, -2.5, -10.499999999999998, -13.399999999999997, -26.799999999999997, -8.5, -16.3, -23.5, -24.6, -74.3, -9.0, -9.5, -7.2, -14.399999999999993, -4.300000000000001, -16.799999999999997, -6.700000000000001, -8.2, -18.5, -22.9, -4.4, -7.9, -4.3, -30.5, -12.099999999999996, -7.199999999999999, -14.099999999999998, -6.299999999999999, -41.2, -15.099999999999998, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9220451863146596, "mean_inference_ms": 1.1724954952219644, "mean_action_processing_ms": 0.06452447357094755, "mean_env_wait_ms": 5.3568549921734965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 352000, "timesteps_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"sample_time_ms": 15161.166, "sample_throughput": 263.832, "load_time_ms": 0.371, "load_throughput": 10778116.408, "learn_time_ms": 7027.112, "learn_throughput": 569.224, "update_time_ms": 1.593}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.37441432883973, "policy_loss": -0.008245735515349654, "vf_loss": 38.24762284960798, "vf_explained_var": -0.16496905460152575, "kl": 0.007353657178020026, "entropy": 0.2161375979101786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 352000, "num_agent_steps_sampled": 352000, "num_steps_trained": 352000, "num_agent_steps_trained": 352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3520, "training_iteration": 88, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-03-24", "timestamp": 1643666604, "time_this_iter_s": 14.746836185455322, "time_total_s": 1281.1281497478485, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1281.1281497478485, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 22.652380952380952, "ram_util_percent": 70.29999999999998}}
{"episode_reward_max": -2.5, "episode_reward_min": -129.3, "episode_reward_mean": -15.463999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -7.299999999999999, -12.799999999999999, -11.999999999999996, -18.800000000000004, -8.5, -11.2, -4.700000000000001, -3.3, -3.3, -6.0, -10.3, -22.3, -68.0, -9.3, -4.9, -3.2, -7.199999999999998, -22.1, -14.3, -25.3, -3.4, -3.3, -8.5, -9.3, -18.0, -10.3, -2.6000000000000005, -9.3, -11.2, -2.5, -10.499999999999998, -13.399999999999997, -26.799999999999997, -8.5, -16.3, -23.5, -24.6, -74.3, -9.0, -9.5, -7.2, -14.399999999999993, -4.300000000000001, -16.799999999999997, -6.700000000000001, -8.2, -18.5, -22.9, -4.4, -7.9, -4.3, -30.5, -12.099999999999996, -7.199999999999999, -14.099999999999998, -6.299999999999999, -41.2, -15.099999999999998, -4.2, -3.2, -35.3, -8.6, -10.5, -7.3, -11.3, -10.600000000000001, -19.9, -21.099999999999998, -10.799999999999999, -4.300000000000001, -5.4, -8.2, -11.2, -8.2, -24.3, -11.3, -10.3, -3.2, -8.599999999999998, -4.3, -19.1, -5.2, -5.300000000000001, -22.199999999999992, -11.399999999999999, -14.899999999999997, -89.4, -13.699999999999998, -4.2, -10.5, -9.600000000000001, -129.3, -18.799999999999997, -15.0, -7.2, -11.3, -42.1, -37.3, -14.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.922008279964676, "mean_inference_ms": 1.1729881270460532, "mean_action_processing_ms": 0.06453687622189168, "mean_env_wait_ms": 5.357986819428323, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 356000, "timesteps_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"sample_time_ms": 15104.404, "sample_throughput": 264.823, "load_time_ms": 0.371, "load_throughput": 10775347.463, "learn_time_ms": 6990.887, "learn_throughput": 572.173, "update_time_ms": 1.603}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 1.2296579928626807, "policy_loss": -0.003986970390573705, "vf_loss": 123.34177151187774, "vf_explained_var": -0.09005123767801511, "kl": 0.009090827697295741, "entropy": 0.2258225943612796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 356000, "num_agent_steps_sampled": 356000, "num_steps_trained": 356000, "num_agent_steps_trained": 356000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3560, "training_iteration": 89, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-03-39", "timestamp": 1643666619, "time_this_iter_s": 14.799865245819092, "time_total_s": 1295.9280149936676, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1295.9280149936676, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 25.6047619047619, "ram_util_percent": 70.47142857142856}}
{"episode_reward_max": -3.2, "episode_reward_min": -129.3, "episode_reward_mean": -15.011, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -7.2, -14.399999999999993, -4.300000000000001, -16.799999999999997, -6.700000000000001, -8.2, -18.5, -22.9, -4.4, -7.9, -4.3, -30.5, -12.099999999999996, -7.199999999999999, -14.099999999999998, -6.299999999999999, -41.2, -15.099999999999998, -4.2, -3.2, -35.3, -8.6, -10.5, -7.3, -11.3, -10.600000000000001, -19.9, -21.099999999999998, -10.799999999999999, -4.300000000000001, -5.4, -8.2, -11.2, -8.2, -24.3, -11.3, -10.3, -3.2, -8.599999999999998, -4.3, -19.1, -5.2, -5.300000000000001, -22.199999999999992, -11.399999999999999, -14.899999999999997, -89.4, -13.699999999999998, -4.2, -10.5, -9.600000000000001, -129.3, -18.799999999999997, -15.0, -7.2, -11.3, -42.1, -37.3, -14.799999999999997, -11.2, -14.3, -8.9, -9.499999999999998, -11.899999999999999, -6.3, -7.3, -6.300000000000001, -13.3, -7.2, -12.099999999999994, -3.7, -3.2, -19.300000000000004, -4.2, -13.599999999999998, -9.999999999999998, -13.7, -6.300000000000001, -27.599999999999998, -16.999999999999996, -7.3, -6.4, -3.3, -17.9, -15.4, -12.599999999999996, -7.8, -28.600000000000005, -5.3, -14.399999999999999, -15.699999999999992, -12.3, -6.2, -5.1, -5.3, -98.2, -23.799999999999997, -5.3, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9220292592989351, "mean_inference_ms": 1.1733843933129362, "mean_action_processing_ms": 0.06454330480901561, "mean_env_wait_ms": 5.358772039528801, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 15049.02, "sample_throughput": 265.798, "load_time_ms": 0.365, "load_throughput": 10970519.846, "learn_time_ms": 6997.519, "learn_throughput": 571.631, "update_time_ms": 1.56}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.5123820524004298, "policy_loss": -0.004255560694402584, "vf_loss": 51.65118265498069, "vf_explained_var": 0.018981258074442547, "kl": 0.005032034891944172, "entropy": 0.2272549427244612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3600, "training_iteration": 90, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-03-54", "timestamp": 1643666634, "time_this_iter_s": 15.32318902015686, "time_total_s": 1311.2512040138245, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1311.2512040138245, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 26.12727272727273, "ram_util_percent": 70.60454545454546}}
{"episode_reward_max": -3.2, "episode_reward_min": -129.3, "episode_reward_mean": -15.424000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -19.1, -5.2, -5.300000000000001, -22.199999999999992, -11.399999999999999, -14.899999999999997, -89.4, -13.699999999999998, -4.2, -10.5, -9.600000000000001, -129.3, -18.799999999999997, -15.0, -7.2, -11.3, -42.1, -37.3, -14.799999999999997, -11.2, -14.3, -8.9, -9.499999999999998, -11.899999999999999, -6.3, -7.3, -6.300000000000001, -13.3, -7.2, -12.099999999999994, -3.7, -3.2, -19.300000000000004, -4.2, -13.599999999999998, -9.999999999999998, -13.7, -6.300000000000001, -27.599999999999998, -16.999999999999996, -7.3, -6.4, -3.3, -17.9, -15.4, -12.599999999999996, -7.8, -28.600000000000005, -5.3, -14.399999999999999, -15.699999999999992, -12.3, -6.2, -5.1, -5.3, -98.2, -23.799999999999997, -5.3, -8.3, -8.8, -3.3, -4.300000000000001, -14.2, -8.9, -3.3, -3.3, -14.499999999999998, -15.899999999999997, -5.3, -17.9, -7.399999999999999, -10.0, -8.899999999999999, -14.19999999999997, -14.600000000000001, -7.2, -22.700000000000006, -6.3, -6.799999999999999, -56.9, -10.3, -16.799999999999997, -14.9, -11.5, -11.4, -12.8, -19.7, -23.799999999999997, -5.3, -12.4, -6.300000000000001, -4.300000000000001, -21.200000000000003, -8.3, -5.3, -27.000000000000007, -17.199999999999996, -8.3, -39.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9224370456540288, "mean_inference_ms": 1.173604573092771, "mean_action_processing_ms": 0.06454647786719046, "mean_env_wait_ms": 5.3591235549391625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 364000, "timesteps_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"sample_time_ms": 15011.182, "sample_throughput": 266.468, "load_time_ms": 0.365, "load_throughput": 10949755.907, "learn_time_ms": 7042.121, "learn_throughput": 568.011, "update_time_ms": 1.578}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.266074728538152, "policy_loss": -0.0052380547538319585, "vf_loss": 27.115762841701507, "vf_explained_var": 0.19444708176838454, "kl": 0.006206292839376031, "entropy": 0.17951318555141008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 364000, "num_agent_steps_sampled": 364000, "num_steps_trained": 364000, "num_agent_steps_trained": 364000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3640, "training_iteration": 91, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-04-10", "timestamp": 1643666650, "time_this_iter_s": 15.241304874420166, "time_total_s": 1326.4925088882446, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1326.4925088882446, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 29.090909090909097, "ram_util_percent": 70.70454545454548}}
{"episode_reward_max": -3.3, "episode_reward_min": -98.2, "episode_reward_mean": -14.455, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.999999999999996, -7.3, -6.4, -3.3, -17.9, -15.4, -12.599999999999996, -7.8, -28.600000000000005, -5.3, -14.399999999999999, -15.699999999999992, -12.3, -6.2, -5.1, -5.3, -98.2, -23.799999999999997, -5.3, -8.3, -8.8, -3.3, -4.300000000000001, -14.2, -8.9, -3.3, -3.3, -14.499999999999998, -15.899999999999997, -5.3, -17.9, -7.399999999999999, -10.0, -8.899999999999999, -14.19999999999997, -14.600000000000001, -7.2, -22.700000000000006, -6.3, -6.799999999999999, -56.9, -10.3, -16.799999999999997, -14.9, -11.5, -11.4, -12.8, -19.7, -23.799999999999997, -5.3, -12.4, -6.300000000000001, -4.300000000000001, -21.200000000000003, -8.3, -5.3, -27.000000000000007, -17.199999999999996, -8.3, -39.2, -11.7, -4.3, -20.00000000000001, -9.4, -6.2, -24.2, -11.3, -18.600000000000005, -5.300000000000001, -17.3, -3.4, -21.200000000000003, -59.3, -7.2, -4.3, -14.5, -9.2, -10.5, -26.90000000000004, -62.9, -26.2, -7.2, -6.2, -13.6, -4.6000000000000005, -12.7, -20.799999999999997, -4.2, -7.299999999999999, -5.4, -14.3, -18.3, -23.2, -16.799999999999997, -10.7, -13.5, -8.2, -15.3, -12.2, -10.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9225623007268037, "mean_inference_ms": 1.1738519284285351, "mean_action_processing_ms": 0.0645621892181405, "mean_env_wait_ms": 5.3601990851481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 368000, "timesteps_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"sample_time_ms": 15018.605, "sample_throughput": 266.336, "load_time_ms": 0.349, "load_throughput": 11473954.315, "learn_time_ms": 7017.337, "learn_throughput": 570.017, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.4847772045281305, "policy_loss": -0.006835480236638618, "vf_loss": 49.13977656383668, "vf_explained_var": 0.29524972284993817, "kl": 0.00859729041648824, "entropy": 0.1943363330537273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 368000, "num_agent_steps_sampled": 368000, "num_steps_trained": 368000, "num_agent_steps_trained": 368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3680, "training_iteration": 92, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-04-25", "timestamp": 1643666665, "time_this_iter_s": 14.774807929992676, "time_total_s": 1341.2673168182373, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1341.2673168182373, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 29.066666666666666, "ram_util_percent": 70.76666666666667}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -62.9, "episode_reward_mean": -13.725999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.9, -10.3, -16.799999999999997, -14.9, -11.5, -11.4, -12.8, -19.7, -23.799999999999997, -5.3, -12.4, -6.300000000000001, -4.300000000000001, -21.200000000000003, -8.3, -5.3, -27.000000000000007, -17.199999999999996, -8.3, -39.2, -11.7, -4.3, -20.00000000000001, -9.4, -6.2, -24.2, -11.3, -18.600000000000005, -5.300000000000001, -17.3, -3.4, -21.200000000000003, -59.3, -7.2, -4.3, -14.5, -9.2, -10.5, -26.90000000000004, -62.9, -26.2, -7.2, -6.2, -13.6, -4.6000000000000005, -12.7, -20.799999999999997, -4.2, -7.299999999999999, -5.4, -14.3, -18.3, -23.2, -16.799999999999997, -10.7, -13.5, -8.2, -15.3, -12.2, -10.2, -54.50000000000001, -4.3, -6.300000000000001, -6.699999999999999, -9.9, -15.3, -2.4000000000000004, -15.699999999999998, -8.2, -7.199999999999999, -16.2, -6.599999999999999, -13.299999999999974, -2.4000000000000004, -12.399999999999999, -9.299999999999999, -5.1000000000000005, -5.300000000000001, -5.8999999999999995, -10.2, -12.899999999999997, -3.3, -3.3, -6.299999999999999, -18.600000000000005, -11.4, -13.6, -6.4, -9.9, -20.3, -4.2, -15.299999999999997, -6.5, -20.199999999999996, -5.2, -12.099999999999998, -20.699999999999996, -9.2, -16.599999999999994, -7.899999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9231932068554323, "mean_inference_ms": 1.1744179274023931, "mean_action_processing_ms": 0.0645915060176055, "mean_env_wait_ms": 5.362238002301979, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 372000, "timesteps_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"sample_time_ms": 15029.247, "sample_throughput": 266.148, "load_time_ms": 0.352, "load_throughput": 11356675.015, "learn_time_ms": 7030.971, "learn_throughput": 568.912, "update_time_ms": 1.566}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 0.18553803846220016, "policy_loss": -0.009797243310779493, "vf_loss": 19.481549638189296, "vf_explained_var": 0.13563159800344898, "kl": 0.020791601517177016, "entropy": 0.21134756677733954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 372000, "num_agent_steps_sampled": 372000, "num_steps_trained": 372000, "num_agent_steps_trained": 372000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3720, "training_iteration": 93, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-04-40", "timestamp": 1643666680, "time_this_iter_s": 15.353433847427368, "time_total_s": 1356.6207506656647, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1356.6207506656647, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 31.347619047619055, "ram_util_percent": 70.99047619047617}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -54.50000000000001, "episode_reward_mean": -12.292, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.2, -7.2, -6.2, -13.6, -4.6000000000000005, -12.7, -20.799999999999997, -4.2, -7.299999999999999, -5.4, -14.3, -18.3, -23.2, -16.799999999999997, -10.7, -13.5, -8.2, -15.3, -12.2, -10.2, -54.50000000000001, -4.3, -6.300000000000001, -6.699999999999999, -9.9, -15.3, -2.4000000000000004, -15.699999999999998, -8.2, -7.199999999999999, -16.2, -6.599999999999999, -13.299999999999974, -2.4000000000000004, -12.399999999999999, -9.299999999999999, -5.1000000000000005, -5.300000000000001, -5.8999999999999995, -10.2, -12.899999999999997, -3.3, -3.3, -6.299999999999999, -18.600000000000005, -11.4, -13.6, -6.4, -9.9, -20.3, -4.2, -15.299999999999997, -6.5, -20.199999999999996, -5.2, -12.099999999999998, -20.699999999999996, -9.2, -16.599999999999994, -7.899999999999997, -36.5, -15.799999999999999, -21.1, -4.2, -12.9, -15.999999999999996, -14.999999999999998, -14.099999999999998, -3.3, -22.0, -10.2, -8.8, -13.399999999999999, -11.9, -11.299999999999999, -14.2, -18.799999999999997, -5.2, -11.099999999999998, -12.7, -6.2, -12.899999999999999, -3.3, -3.3, -9.299999999999997, -21.700000000000003, -22.5, -11.3, -3.2, -4.2, -3.3, -35.3, -13.799999999999999, -18.0, -6.2, -19.2, -23.199999999999996, -11.29999999999999, -20.199999999999996, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.923567114982354, "mean_inference_ms": 1.1748638353494458, "mean_action_processing_ms": 0.06461342928403616, "mean_env_wait_ms": 5.363915441122772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 376000, "timesteps_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"sample_time_ms": 15018.363, "sample_throughput": 266.341, "load_time_ms": 0.363, "load_throughput": 11009394.317, "learn_time_ms": 7027.464, "learn_throughput": 569.195, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 0.1670151307838418, "policy_loss": -0.005152735311377754, "vf_loss": 17.194216479985943, "vf_explained_var": 0.08677755901890416, "kl": 0.006018856002974001, "entropy": 0.21194281152659847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 376000, "num_agent_steps_sampled": 376000, "num_steps_trained": 376000, "num_agent_steps_trained": 376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3760, "training_iteration": 94, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-04-55", "timestamp": 1643666695, "time_this_iter_s": 15.130698919296265, "time_total_s": 1371.751449584961, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1371.751449584961, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 28.295454545454547, "ram_util_percent": 71.09545454545452}}
{"episode_reward_max": -2.2, "episode_reward_min": -73.3, "episode_reward_mean": -11.963999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999997, -3.3, -3.3, -6.299999999999999, -18.600000000000005, -11.4, -13.6, -6.4, -9.9, -20.3, -4.2, -15.299999999999997, -6.5, -20.199999999999996, -5.2, -12.099999999999998, -20.699999999999996, -9.2, -16.599999999999994, -7.899999999999997, -36.5, -15.799999999999999, -21.1, -4.2, -12.9, -15.999999999999996, -14.999999999999998, -14.099999999999998, -3.3, -22.0, -10.2, -8.8, -13.399999999999999, -11.9, -11.299999999999999, -14.2, -18.799999999999997, -5.2, -11.099999999999998, -12.7, -6.2, -12.899999999999999, -3.3, -3.3, -9.299999999999997, -21.700000000000003, -22.5, -11.3, -3.2, -4.2, -3.3, -35.3, -13.799999999999999, -18.0, -6.2, -19.2, -23.199999999999996, -11.29999999999999, -20.199999999999996, -10.3, -15.2, -7.2, -18.9, -16.699999999999996, -3.3, -14.799999999999997, -7.2, -11.6, -6.4, -7.799999999999999, -5.2, -6.2, -7.300000000000001, -11.299999999999999, -3.2, -4.4, -6.799999999999999, -4.3, -10.299999999999999, -14.499999999999998, -4.4, -6.3, -10.499999999999998, -11.6, -5.4, -3.2, -7.9, -3.3, -4.300000000000001, -11.4, -18.100000000000012, -15.6, -15.599999999999998, -8.3, -11.899999999999999, -9.600000000000001, -73.3, -26.59999999999997, -2.2, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9238063554595414, "mean_inference_ms": 1.1750018144722565, "mean_action_processing_ms": 0.06462273518154271, "mean_env_wait_ms": 5.364886179943398, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"sample_time_ms": 15021.882, "sample_throughput": 266.278, "load_time_ms": 0.361, "load_throughput": 11089441.47, "learn_time_ms": 7048.638, "learn_throughput": 567.486, "update_time_ms": 1.507}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 0.34231720595740744, "policy_loss": -0.012311365883997692, "vf_loss": 35.29113260597311, "vf_explained_var": 0.22538924153133105, "kl": 0.045793487968671116, "entropy": 0.2672755603428169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 380000, "num_steps_trained": 380000, "num_agent_steps_trained": 380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3800, "training_iteration": 95, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-05-10", "timestamp": 1643666710, "time_this_iter_s": 15.169341087341309, "time_total_s": 1386.9207906723022, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1386.9207906723022, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 29.750000000000004, "ram_util_percent": 71.09999999999997}}
{"episode_reward_max": -2.2, "episode_reward_min": -73.3, "episode_reward_mean": -14.033999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -12.899999999999999, -3.3, -3.3, -9.299999999999997, -21.700000000000003, -22.5, -11.3, -3.2, -4.2, -3.3, -35.3, -13.799999999999999, -18.0, -6.2, -19.2, -23.199999999999996, -11.29999999999999, -20.199999999999996, -10.3, -15.2, -7.2, -18.9, -16.699999999999996, -3.3, -14.799999999999997, -7.2, -11.6, -6.4, -7.799999999999999, -5.2, -6.2, -7.300000000000001, -11.299999999999999, -3.2, -4.4, -6.799999999999999, -4.3, -10.299999999999999, -14.499999999999998, -4.4, -6.3, -10.499999999999998, -11.6, -5.4, -3.2, -7.9, -3.3, -4.300000000000001, -11.4, -18.100000000000012, -15.6, -15.599999999999998, -8.3, -11.899999999999999, -9.600000000000001, -73.3, -26.59999999999997, -2.2, -3.2, -19.3, -27.2, -41.69999999999993, -14.399999999999999, -9.2, -10.799999999999999, -9.2, -21.4, -26.3, -26.6, -16.4, -16.199999999999996, -11.4, -12.3, -9.799999999999997, -6.300000000000001, -18.2, -10.4, -31.4, -17.2, -17.3, -21.2, -16.899999999999988, -18.0, -13.2, -15.799999999999999, -21.89999999999999, -24.200000000000003, -25.3, -5.0, -18.199999999999996, -26.3, -35.2, -5.2, -7.7, -9.199999999999998, -30.2, -25.4, -4.2, -13.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9238801588294188, "mean_inference_ms": 1.1751562642300444, "mean_action_processing_ms": 0.06463086160817878, "mean_env_wait_ms": 5.365792696670447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 15029.798, "sample_throughput": 266.138, "load_time_ms": 0.364, "load_throughput": 10988483.102, "learn_time_ms": 7098.4, "learn_throughput": 563.507, "update_time_ms": 1.507}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.2473476241102382, "policy_loss": -0.00532265755958775, "vf_loss": 25.201377934281545, "vf_explained_var": 0.12466461780250714, "kl": 0.011671270093914322, "entropy": 0.3002148129766987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 384000, "num_agent_steps_trained": 384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3840, "training_iteration": 96, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-05-26", "timestamp": 1643666726, "time_this_iter_s": 15.313286781311035, "time_total_s": 1402.2340774536133, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1402.2340774536133, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 28.02380952380952, "ram_util_percent": 71.16666666666667}}
{"episode_reward_max": -2.2, "episode_reward_min": -101.4, "episode_reward_mean": -16.376, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -6.3, -10.499999999999998, -11.6, -5.4, -3.2, -7.9, -3.3, -4.300000000000001, -11.4, -18.100000000000012, -15.6, -15.599999999999998, -8.3, -11.899999999999999, -9.600000000000001, -73.3, -26.59999999999997, -2.2, -3.2, -19.3, -27.2, -41.69999999999993, -14.399999999999999, -9.2, -10.799999999999999, -9.2, -21.4, -26.3, -26.6, -16.4, -16.199999999999996, -11.4, -12.3, -9.799999999999997, -6.300000000000001, -18.2, -10.4, -31.4, -17.2, -17.3, -21.2, -16.899999999999988, -18.0, -13.2, -15.799999999999999, -21.89999999999999, -24.200000000000003, -25.3, -5.0, -18.199999999999996, -26.3, -35.2, -5.2, -7.7, -9.199999999999998, -30.2, -25.4, -4.2, -13.3, -16.5, -8.3, -14.499999999999996, -13.699999999999998, -7.2, -31.89999999999998, -17.200000000000003, -17.900000000000006, -9.3, -17.3, -15.499999999999998, -6.4, -10.3, -22.700000000000003, -10.2, -10.900000000000002, -8.299999999999999, -17.0, -8.4, -11.899999999999999, -9.2, -14.3, -30.4, -10.3, -17.3, -34.3, -7.299999999999999, -101.4, -29.4, -6.300000000000001, -14.699999999999998, -16.4, -8.2, -21.800000000000008, -30.4, -7.499999999999999, -9.8, -9.700000000000001, -16.499999999999982, -4.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9237817991029665, "mean_inference_ms": 1.1752950895923275, "mean_action_processing_ms": 0.06463524968974153, "mean_env_wait_ms": 5.36644658328712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 388000, "timesteps_this_iter": 0, "agent_timesteps_total": 388000, "timers": {"sample_time_ms": 15061.327, "sample_throughput": 265.581, "load_time_ms": 0.363, "load_throughput": 11025311.165, "learn_time_ms": 7152.495, "learn_throughput": 559.245, "update_time_ms": 1.522}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.5543508131192216, "policy_loss": -0.004755386343145723, "vf_loss": 55.87022239674804, "vf_explained_var": -0.1291659325681707, "kl": 0.007181940146520419, "entropy": 0.29591107028786856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 388000, "num_agent_steps_sampled": 388000, "num_steps_trained": 388000, "num_agent_steps_trained": 388000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3880, "training_iteration": 97, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-05-41", "timestamp": 1643666741, "time_this_iter_s": 15.04093885421753, "time_total_s": 1417.2750163078308, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1417.2750163078308, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.904545454545453, "ram_util_percent": 71.25454545454544}}
{"episode_reward_max": -3.7, "episode_reward_min": -101.4, "episode_reward_mean": -16.324, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.3, -21.2, -16.899999999999988, -18.0, -13.2, -15.799999999999999, -21.89999999999999, -24.200000000000003, -25.3, -5.0, -18.199999999999996, -26.3, -35.2, -5.2, -7.7, -9.199999999999998, -30.2, -25.4, -4.2, -13.3, -16.5, -8.3, -14.499999999999996, -13.699999999999998, -7.2, -31.89999999999998, -17.200000000000003, -17.900000000000006, -9.3, -17.3, -15.499999999999998, -6.4, -10.3, -22.700000000000003, -10.2, -10.900000000000002, -8.299999999999999, -17.0, -8.4, -11.899999999999999, -9.2, -14.3, -30.4, -10.3, -17.3, -34.3, -7.299999999999999, -101.4, -29.4, -6.300000000000001, -14.699999999999998, -16.4, -8.2, -21.800000000000008, -30.4, -7.499999999999999, -9.8, -9.700000000000001, -16.499999999999982, -4.9, -9.7, -19.800000000000015, -5.2, -33.30000000000004, -14.099999999999998, -20.5, -11.5, -17.7, -7.300000000000001, -11.3, -20.3, -9.3, -24.4, -13.399999999999995, -3.7, -11.899999999999999, -7.699999999999999, -17.099999999999998, -12.200000000000001, -14.4, -14.2, -31.4, -24.600000000000005, -17.3, -23.90000000000001, -5.2, -8.2, -15.2, -17.900000000000006, -11.4, -12.399999999999995, -10.799999999999999, -14.599999999999998, -15.299999999999999, -16.2, -16.2, -23.800000000000004, -4.9, -13.3, -21.60000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9237754705733271, "mean_inference_ms": 1.1754464019259636, "mean_action_processing_ms": 0.06464355438724131, "mean_env_wait_ms": 5.367267216394348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 392000, "timesteps_this_iter": 0, "agent_timesteps_total": 392000, "timers": {"sample_time_ms": 15138.301, "sample_throughput": 264.23, "load_time_ms": 0.355, "load_throughput": 11277284.399, "learn_time_ms": 7186.033, "learn_throughput": 556.635, "update_time_ms": 1.485}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.16354451060535447, "policy_loss": -0.01657474411110724, "vf_loss": 17.927945890477908, "vf_explained_var": 0.053501431788167644, "kl": 0.014929830585808351, "entropy": 0.27097834552167566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 392000, "num_agent_steps_sampled": 392000, "num_steps_trained": 392000, "num_agent_steps_trained": 392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3920, "training_iteration": 98, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-05-56", "timestamp": 1643666756, "time_this_iter_s": 15.306614875793457, "time_total_s": 1432.5816311836243, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1432.5816311836243, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 30.342857142857138, "ram_util_percent": 71.33809523809525}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -101.4, "episode_reward_mean": -14.918, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -14.3, -30.4, -10.3, -17.3, -34.3, -7.299999999999999, -101.4, -29.4, -6.300000000000001, -14.699999999999998, -16.4, -8.2, -21.800000000000008, -30.4, -7.499999999999999, -9.8, -9.700000000000001, -16.499999999999982, -4.9, -9.7, -19.800000000000015, -5.2, -33.30000000000004, -14.099999999999998, -20.5, -11.5, -17.7, -7.300000000000001, -11.3, -20.3, -9.3, -24.4, -13.399999999999995, -3.7, -11.899999999999999, -7.699999999999999, -17.099999999999998, -12.200000000000001, -14.4, -14.2, -31.4, -24.600000000000005, -17.3, -23.90000000000001, -5.2, -8.2, -15.2, -17.900000000000006, -11.4, -12.399999999999995, -10.799999999999999, -14.599999999999998, -15.299999999999999, -16.2, -16.2, -23.800000000000004, -4.9, -13.3, -21.60000000000001, -11.999999999999998, -7.099999999999998, -4.2, -3.5000000000000004, -19.6, -15.299999999999999, -12.2, -13.0, -11.2, -14.899999999999999, -9.5, -5.799999999999999, -8.2, -3.2, -10.4, -15.19999999999998, -14.600000000000001, -8.699999999999998, -10.2, -15.899999999999999, -6.7, -6.3, -17.2, -14.2, -7.599999999999999, -8.2, -12.7, -8.399999999999999, -8.2, -11.499999999999996, -30.3, -11.3, -28.5, -28.500000000000075, -6.300000000000001, -11.2, -17.2, -21.9, -15.0, -2.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9237613021911425, "mean_inference_ms": 1.1754229531565559, "mean_action_processing_ms": 0.06465272097429763, "mean_env_wait_ms": 5.36821504325234, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 396000, "timesteps_this_iter": 0, "agent_timesteps_total": 396000, "timers": {"sample_time_ms": 15163.212, "sample_throughput": 263.796, "load_time_ms": 0.368, "load_throughput": 10878755.025, "learn_time_ms": 7219.72, "learn_throughput": 554.038, "update_time_ms": 1.469}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.14219809803180397, "policy_loss": 0.0025825872176116513, "vf_loss": 13.915439714026707, "vf_explained_var": 0.23248822714692802, "kl": 0.008197683097118042, "entropy": 0.23126643700625307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 396000, "num_agent_steps_sampled": 396000, "num_steps_trained": 396000, "num_agent_steps_trained": 396000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3960, "training_iteration": 99, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-06-11", "timestamp": 1643666771, "time_this_iter_s": 15.03583288192749, "time_total_s": 1447.6174640655518, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1447.6174640655518, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 25.1909090909091, "ram_util_percent": 71.40000000000003}}
{"episode_reward_max": -2.5, "episode_reward_min": -31.4, "episode_reward_mean": -12.663000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -31.4, -24.600000000000005, -17.3, -23.90000000000001, -5.2, -8.2, -15.2, -17.900000000000006, -11.4, -12.399999999999995, -10.799999999999999, -14.599999999999998, -15.299999999999999, -16.2, -16.2, -23.800000000000004, -4.9, -13.3, -21.60000000000001, -11.999999999999998, -7.099999999999998, -4.2, -3.5000000000000004, -19.6, -15.299999999999999, -12.2, -13.0, -11.2, -14.899999999999999, -9.5, -5.799999999999999, -8.2, -3.2, -10.4, -15.19999999999998, -14.600000000000001, -8.699999999999998, -10.2, -15.899999999999999, -6.7, -6.3, -17.2, -14.2, -7.599999999999999, -8.2, -12.7, -8.399999999999999, -8.2, -11.499999999999996, -30.3, -11.3, -28.5, -28.500000000000075, -6.300000000000001, -11.2, -17.2, -21.9, -15.0, -2.6000000000000005, -5.300000000000001, -9.4, -6.2, -22.500000000000018, -8.999999999999998, -12.3, -9.5, -13.7, -8.699999999999998, -8.299999999999999, -5.300000000000001, -7.1, -11.2, -7.1, -7.3, -22.799999999999997, -18.4, -8.8, -18.500000000000025, -2.5, -18.4, -29.699999999999996, -15.199999999999996, -6.3, -11.799999999999999, -14.299999999999995, -10.099999999999998, -14.999999999999998, -3.3, -8.3, -19.599999999999998, -7.699999999999999, -11.2, -7.300000000000001, -14.399999999999997, -5.2, -13.3, -12.0, -16.199999999999996, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9238830037113246, "mean_inference_ms": 1.175510923345648, "mean_action_processing_ms": 0.0646648274801708, "mean_env_wait_ms": 5.369270766342561, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 15197.476, "sample_throughput": 263.202, "load_time_ms": 0.368, "load_throughput": 10858336.677, "learn_time_ms": 7179.711, "learn_throughput": 557.126, "update_time_ms": 1.46}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.10335935007941018, "policy_loss": 0.0005215983006662579, "vf_loss": 10.243567066423354, "vf_explained_var": 0.2557720879713694, "kl": 0.007148212470142513, "entropy": 0.23605283590894874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 400000, "num_steps_trained": 400000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4000, "training_iteration": 100, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-06-26", "timestamp": 1643666786, "time_this_iter_s": 14.945441961288452, "time_total_s": 1462.5629060268402, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1462.5629060268402, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.747619047619043, "ram_util_percent": 71.47142857142858}}
{"episode_reward_max": -2.5, "episode_reward_min": -119.4, "episode_reward_mean": -12.985, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.7, -6.3, -17.2, -14.2, -7.599999999999999, -8.2, -12.7, -8.399999999999999, -8.2, -11.499999999999996, -30.3, -11.3, -28.5, -28.500000000000075, -6.300000000000001, -11.2, -17.2, -21.9, -15.0, -2.6000000000000005, -5.300000000000001, -9.4, -6.2, -22.500000000000018, -8.999999999999998, -12.3, -9.5, -13.7, -8.699999999999998, -8.299999999999999, -5.300000000000001, -7.1, -11.2, -7.1, -7.3, -22.799999999999997, -18.4, -8.8, -18.500000000000025, -2.5, -18.4, -29.699999999999996, -15.199999999999996, -6.3, -11.799999999999999, -14.299999999999995, -10.099999999999998, -14.999999999999998, -3.3, -8.3, -19.599999999999998, -7.699999999999999, -11.2, -7.300000000000001, -14.399999999999997, -5.2, -13.3, -12.0, -16.199999999999996, -6.2, -26.3, -34.800000000000004, -10.2, -12.899999999999999, -6.300000000000001, -8.3, -8.3, -12.299999999999999, -14.3, -7.0, -8.299999999999997, -7.800000000000001, -5.3, -10.2, -6.300000000000001, -2.6000000000000005, -5.2, -11.3, -3.2, -14.699999999999998, -15.999999999999998, -24.3, -4.3, -7.300000000000001, -7.300000000000001, -7.2, -11.999999999999977, -7.3, -24.80000000000003, -119.4, -8.4, -13.799999999999999, -6.3, -9.299999999999997, -5.0, -11.2, -20.5, -18.3, -16.700000000000003, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9243213379308028, "mean_inference_ms": 1.175465769991984, "mean_action_processing_ms": 0.06466781011835053, "mean_env_wait_ms": 5.369533637052828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 404000, "timesteps_this_iter": 0, "agent_timesteps_total": 404000, "timers": {"sample_time_ms": 15129.093, "sample_throughput": 264.391, "load_time_ms": 0.368, "load_throughput": 10882283.194, "learn_time_ms": 7146.73, "learn_throughput": 559.696, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.7549427035414884, "policy_loss": -0.004754522096325633, "vf_loss": 75.91098216086306, "vf_explained_var": -0.04944075916403083, "kl": 0.010443149675698038, "entropy": 0.22109776321918734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 404000, "num_agent_steps_sampled": 404000, "num_steps_trained": 404000, "num_agent_steps_trained": 404000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4040, "training_iteration": 101, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-06-41", "timestamp": 1643666801, "time_this_iter_s": 14.644684076309204, "time_total_s": 1477.2075901031494, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1477.2075901031494, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 28.557142857142864, "ram_util_percent": 71.54285714285713}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -119.4, "episode_reward_mean": -13.658, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.4, -29.699999999999996, -15.199999999999996, -6.3, -11.799999999999999, -14.299999999999995, -10.099999999999998, -14.999999999999998, -3.3, -8.3, -19.599999999999998, -7.699999999999999, -11.2, -7.300000000000001, -14.399999999999997, -5.2, -13.3, -12.0, -16.199999999999996, -6.2, -26.3, -34.800000000000004, -10.2, -12.899999999999999, -6.300000000000001, -8.3, -8.3, -12.299999999999999, -14.3, -7.0, -8.299999999999997, -7.800000000000001, -5.3, -10.2, -6.300000000000001, -2.6000000000000005, -5.2, -11.3, -3.2, -14.699999999999998, -15.999999999999998, -24.3, -4.3, -7.300000000000001, -7.300000000000001, -7.2, -11.999999999999977, -7.3, -24.80000000000003, -119.4, -8.4, -13.799999999999999, -6.3, -9.299999999999997, -5.0, -11.2, -20.5, -18.3, -16.700000000000003, -10.3, -23.30000000000002, -21.1, -17.199999999999996, -6.599999999999999, -15.199999999999998, -3.2, -6.3, -22.4, -13.2, -9.9, -18.2, -17.2, -15.3, -5.300000000000001, -9.3, -14.999999999999998, -18.2, -12.499999999999995, -13.5, -10.2, -6.2, -31.3, -10.600000000000001, -23.5, -16.2, -9.399999999999999, -6.3, -24.499999999999996, -11.599999999999998, -4.7, -5.2, -5.2, -20.299999999999997, -34.5, -6.300000000000001, -22.900000000000006, -11.3, -10.399999999999999, -5.3, -16.199999999999974], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9245583401765901, "mean_inference_ms": 1.175401821199796, "mean_action_processing_ms": 0.06466744116369436, "mean_env_wait_ms": 5.369466912929301, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"sample_time_ms": 15080.128, "sample_throughput": 265.25, "load_time_ms": 0.37, "load_throughput": 10814939.728, "learn_time_ms": 7190.014, "learn_throughput": 556.327, "update_time_ms": 1.521}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.15926733223060446, "policy_loss": -0.010334620201679807, "vf_loss": 16.872243223395397, "vf_explained_var": 0.2520288645580251, "kl": 0.01563600181227337, "entropy": 0.25130947526263936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 408000, "num_steps_trained": 408000, "num_agent_steps_trained": 408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4080, "training_iteration": 102, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-06-56", "timestamp": 1643666816, "time_this_iter_s": 15.01709508895874, "time_total_s": 1492.2246851921082, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1492.2246851921082, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 28.661904761904765, "ram_util_percent": 71.6190476190476}}
{"episode_reward_max": -2.5, "episode_reward_min": -119.4, "episode_reward_mean": -14.030000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.999999999999998, -24.3, -4.3, -7.300000000000001, -7.300000000000001, -7.2, -11.999999999999977, -7.3, -24.80000000000003, -119.4, -8.4, -13.799999999999999, -6.3, -9.299999999999997, -5.0, -11.2, -20.5, -18.3, -16.700000000000003, -10.3, -23.30000000000002, -21.1, -17.199999999999996, -6.599999999999999, -15.199999999999998, -3.2, -6.3, -22.4, -13.2, -9.9, -18.2, -17.2, -15.3, -5.300000000000001, -9.3, -14.999999999999998, -18.2, -12.499999999999995, -13.5, -10.2, -6.2, -31.3, -10.600000000000001, -23.5, -16.2, -9.399999999999999, -6.3, -24.499999999999996, -11.599999999999998, -4.7, -5.2, -5.2, -20.299999999999997, -34.5, -6.300000000000001, -22.900000000000006, -11.3, -10.399999999999999, -5.3, -16.199999999999974, -13.799999999999997, -4.300000000000001, -19.000000000000004, -7.499999999999998, -21.6, -10.499999999999998, -7.3, -26.40000000000001, -16.799999999999997, -15.19999999999999, -23.2, -18.4, -27.50000000000006, -12.3, -9.2, -20.400000000000002, -8.8, -8.2, -26.000000000000004, -3.3, -8.2, -21.800000000000004, -2.5, -7.799999999999999, -8.2, -4.9, -17.800000000000004, -22.200000000000014, -8.3, -6.3, -4.300000000000001, -12.6, -12.8, -5.3, -6.199999999999999, -17.399999999999995, -8.2, -7.3, -11.3, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9247840327027242, "mean_inference_ms": 1.1754812855740346, "mean_action_processing_ms": 0.06467592090530594, "mean_env_wait_ms": 5.3699790259643985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 412000, "timesteps_this_iter": 0, "agent_timesteps_total": 412000, "timers": {"sample_time_ms": 15114.864, "sample_throughput": 264.64, "load_time_ms": 0.367, "load_throughput": 10892174.252, "learn_time_ms": 7187.353, "learn_throughput": 556.533, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.11736473121670304, "policy_loss": -0.006919312439308131, "vf_loss": 12.327953288183418, "vf_explained_var": 0.2283194068939455, "kl": 0.0178580391211074, "entropy": 0.24326140427941917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 412000, "num_agent_steps_sampled": 412000, "num_steps_trained": 412000, "num_agent_steps_trained": 412000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4120, "training_iteration": 103, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-07-11", "timestamp": 1643666831, "time_this_iter_s": 15.226622819900513, "time_total_s": 1507.4513080120087, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1507.4513080120087, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 26.78571428571428, "ram_util_percent": 71.70000000000002}}
{"episode_reward_max": -2.5, "episode_reward_min": -34.5, "episode_reward_mean": -13.073000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -31.3, -10.600000000000001, -23.5, -16.2, -9.399999999999999, -6.3, -24.499999999999996, -11.599999999999998, -4.7, -5.2, -5.2, -20.299999999999997, -34.5, -6.300000000000001, -22.900000000000006, -11.3, -10.399999999999999, -5.3, -16.199999999999974, -13.799999999999997, -4.300000000000001, -19.000000000000004, -7.499999999999998, -21.6, -10.499999999999998, -7.3, -26.40000000000001, -16.799999999999997, -15.19999999999999, -23.2, -18.4, -27.50000000000006, -12.3, -9.2, -20.400000000000002, -8.8, -8.2, -26.000000000000004, -3.3, -8.2, -21.800000000000004, -2.5, -7.799999999999999, -8.2, -4.9, -17.800000000000004, -22.200000000000014, -8.3, -6.3, -4.300000000000001, -12.6, -12.8, -5.3, -6.199999999999999, -17.399999999999995, -8.2, -7.3, -11.3, -5.2, -7.499999999999999, -6.300000000000001, -8.899999999999999, -11.4, -6.300000000000001, -7.300000000000001, -4.300000000000001, -7.299999999999999, -10.9, -18.3, -10.799999999999999, -14.2, -12.899999999999999, -13.2, -5.3, -9.6, -12.3, -14.199999999999998, -10.4, -5.2, -12.3, -8.2, -5.1000000000000005, -25.00000000000002, -22.500000000000036, -18.300000000000004, -9.799999999999999, -28.800000000000008, -15.799999999999997, -15.699999999999998, -20.799999999999997, -18.200000000000003, -13.3, -21.000000000000007, -32.60000000000002, -10.899999999999999, -20.0, -16.799999999999972, -10.099999999999998, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9251022228386984, "mean_inference_ms": 1.1757947773729809, "mean_action_processing_ms": 0.06469918270503128, "mean_env_wait_ms": 5.371409750719445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 416000, "timesteps_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"sample_time_ms": 15134.939, "sample_throughput": 264.289, "load_time_ms": 0.362, "load_throughput": 11060928.27, "learn_time_ms": 7187.423, "learn_throughput": 556.528, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.14811840288826736, "policy_loss": -0.009676580962234288, "vf_loss": 15.719073688983917, "vf_explained_var": 0.15652611761964777, "kl": 0.01074222743426719, "entropy": 0.28141780543711875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 416000, "num_agent_steps_sampled": 416000, "num_steps_trained": 416000, "num_agent_steps_trained": 416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4160, "training_iteration": 104, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-07-26", "timestamp": 1643666846, "time_this_iter_s": 15.382156133651733, "time_total_s": 1522.8334641456604, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1522.8334641456604, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 24.231818181818184, "ram_util_percent": 71.85909090909092}}
{"episode_reward_max": -2.5, "episode_reward_min": -42.3, "episode_reward_mean": -13.269, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -21.800000000000004, -2.5, -7.799999999999999, -8.2, -4.9, -17.800000000000004, -22.200000000000014, -8.3, -6.3, -4.300000000000001, -12.6, -12.8, -5.3, -6.199999999999999, -17.399999999999995, -8.2, -7.3, -11.3, -5.2, -7.499999999999999, -6.300000000000001, -8.899999999999999, -11.4, -6.300000000000001, -7.300000000000001, -4.300000000000001, -7.299999999999999, -10.9, -18.3, -10.799999999999999, -14.2, -12.899999999999999, -13.2, -5.3, -9.6, -12.3, -14.199999999999998, -10.4, -5.2, -12.3, -8.2, -5.1000000000000005, -25.00000000000002, -22.500000000000036, -18.300000000000004, -9.799999999999999, -28.800000000000008, -15.799999999999997, -15.699999999999998, -20.799999999999997, -18.200000000000003, -13.3, -21.000000000000007, -32.60000000000002, -10.899999999999999, -20.0, -16.799999999999972, -10.099999999999998, -5.3, -21.299999999999997, -24.3, -7.300000000000001, -6.2, -10.5, -13.399999999999999, -16.3, -7.2, -9.6, -16.39999999999999, -7.799999999999998, -8.399999999999999, -13.0, -22.500000000000004, -20.999999999999996, -9.4, -7.199999999999998, -9.3, -15.3, -3.7, -14.600000000000001, -10.3, -36.3, -16.29999999999998, -22.6, -7.499999999999999, -4.7, -12.7, -16.5, -17.800000000000004, -12.899999999999999, -14.899999999999997, -25.200000000000003, -4.2, -18.9, -24.600000000000005, -18.900000000000006, -25.6, -42.3, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9253738573362843, "mean_inference_ms": 1.1761440688678113, "mean_action_processing_ms": 0.06472288761885628, "mean_env_wait_ms": 5.372542526751313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 15136.284, "sample_throughput": 264.266, "load_time_ms": 0.376, "load_throughput": 10639365.844, "learn_time_ms": 7184.253, "learn_throughput": 556.773, "update_time_ms": 1.559}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.2422813397111191, "policy_loss": 0.004099232887709013, "vf_loss": 23.774978466123663, "vf_explained_var": 0.03455619882511836, "kl": 0.0076858563374718825, "entropy": 0.27035226554319425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4200, "training_iteration": 105, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-07-42", "timestamp": 1643666862, "time_this_iter_s": 15.15024209022522, "time_total_s": 1537.9837062358856, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1537.9837062358856, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 26.55909090909091, "ram_util_percent": 72.11363636363636}}
{"episode_reward_max": -1.2, "episode_reward_min": -53.30000000000009, "episode_reward_mean": -13.971000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -8.2, -5.1000000000000005, -25.00000000000002, -22.500000000000036, -18.300000000000004, -9.799999999999999, -28.800000000000008, -15.799999999999997, -15.699999999999998, -20.799999999999997, -18.200000000000003, -13.3, -21.000000000000007, -32.60000000000002, -10.899999999999999, -20.0, -16.799999999999972, -10.099999999999998, -5.3, -21.299999999999997, -24.3, -7.300000000000001, -6.2, -10.5, -13.399999999999999, -16.3, -7.2, -9.6, -16.39999999999999, -7.799999999999998, -8.399999999999999, -13.0, -22.500000000000004, -20.999999999999996, -9.4, -7.199999999999998, -9.3, -15.3, -3.7, -14.600000000000001, -10.3, -36.3, -16.29999999999998, -22.6, -7.499999999999999, -4.7, -12.7, -16.5, -17.800000000000004, -12.899999999999999, -14.899999999999997, -25.200000000000003, -4.2, -18.9, -24.600000000000005, -18.900000000000006, -25.6, -42.3, -4.300000000000001, -18.800000000000004, -9.3, -7.300000000000001, -5.3, -15.3, -12.7, -3.1000000000000014, -5.3, -6.300000000000001, -8.700000000000001, -9.5, -26.800000000000004, -6.799999999999999, -2.6000000000000005, -7.499999999999999, -7.199999999999999, -5.3, -15.999999999999996, -13.299999999999997, -5.3, -4.3, -14.399999999999999, -16.799999999999997, -12.8, -7.3999999999999995, -24.199999999999996, -13.2, -14.3, -1.2, -12.0, -8.2, -15.499999999999998, -6.2, -14.5, -9.2, -15.2, -6.300000000000001, -53.30000000000009, -12.2, -11.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9257798697557454, "mean_inference_ms": 1.176456954999192, "mean_action_processing_ms": 0.06474237834886115, "mean_env_wait_ms": 5.373308413745917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 424000, "timesteps_this_iter": 0, "agent_timesteps_total": 424000, "timers": {"sample_time_ms": 15164.03, "sample_throughput": 263.782, "load_time_ms": 0.371, "load_throughput": 10773963.524, "learn_time_ms": 7164.167, "learn_throughput": 558.334, "update_time_ms": 1.584}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.19029491786614702, "policy_loss": 0.00034098247396609476, "vf_loss": 18.965583010258214, "vf_explained_var": 0.004147018668472126, "kl": 0.005299706659353168, "entropy": 0.2726833404552552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 424000, "num_agent_steps_sampled": 424000, "num_steps_trained": 424000, "num_agent_steps_trained": 424000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4240, "training_iteration": 106, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-07-57", "timestamp": 1643666877, "time_this_iter_s": 15.40289306640625, "time_total_s": 1553.3865993022919, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1553.3865993022919, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 23.218181818181822, "ram_util_percent": 72.24999999999999}}
{"episode_reward_max": -1.2, "episode_reward_min": -53.30000000000009, "episode_reward_mean": -13.255999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.600000000000001, -10.3, -36.3, -16.29999999999998, -22.6, -7.499999999999999, -4.7, -12.7, -16.5, -17.800000000000004, -12.899999999999999, -14.899999999999997, -25.200000000000003, -4.2, -18.9, -24.600000000000005, -18.900000000000006, -25.6, -42.3, -4.300000000000001, -18.800000000000004, -9.3, -7.300000000000001, -5.3, -15.3, -12.7, -3.1000000000000014, -5.3, -6.300000000000001, -8.700000000000001, -9.5, -26.800000000000004, -6.799999999999999, -2.6000000000000005, -7.499999999999999, -7.199999999999999, -5.3, -15.999999999999996, -13.299999999999997, -5.3, -4.3, -14.399999999999999, -16.799999999999997, -12.8, -7.3999999999999995, -24.199999999999996, -13.2, -14.3, -1.2, -12.0, -8.2, -15.499999999999998, -6.2, -14.5, -9.2, -15.2, -6.300000000000001, -53.30000000000009, -12.2, -11.8, -8.3, -20.700000000000003, -7.6000000000000005, -12.2, -9.3, -13.499999999999996, -4.2, -5.2, -17.0, -10.3, -12.2, -19.2, -10.3, -12.1, -6.2, -11.3, -8.3, -11.2, -43.400000000000034, -9.3, -18.1, -13.699999999999994, -6.8999999999999995, -21.799999999999997, -13.2, -10.2, -10.4, -9.499999999999998, -12.3, -6.2, -19.89999999999999, -4.9, -3.3, -11.7, -26.700000000000003, -18.6, -9.2, -9.3, -21.200000000000003, -10.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9259082396990178, "mean_inference_ms": 1.1764884572322445, "mean_action_processing_ms": 0.06474460973637369, "mean_env_wait_ms": 5.373142956487829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 428000, "timesteps_this_iter": 0, "agent_timesteps_total": 428000, "timers": {"sample_time_ms": 15128.129, "sample_throughput": 264.408, "load_time_ms": 0.374, "load_throughput": 10695662.374, "learn_time_ms": 7130.354, "learn_throughput": 560.982, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1350390767117822, "policy_loss": -0.007718327465236828, "vf_loss": 14.188016770988382, "vf_explained_var": 0.3652849149960344, "kl": 0.01559537132922377, "entropy": 0.2771242399289403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 428000, "num_agent_steps_sampled": 428000, "num_steps_trained": 428000, "num_agent_steps_trained": 428000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4280, "training_iteration": 107, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-08-12", "timestamp": 1643666892, "time_this_iter_s": 14.533527135848999, "time_total_s": 1567.9201264381409, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1567.9201264381409, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 19.705000000000002, "ram_util_percent": 72.29999999999998}}
{"episode_reward_max": -1.2, "episode_reward_min": -53.30000000000009, "episode_reward_mean": -13.366000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -14.399999999999999, -16.799999999999997, -12.8, -7.3999999999999995, -24.199999999999996, -13.2, -14.3, -1.2, -12.0, -8.2, -15.499999999999998, -6.2, -14.5, -9.2, -15.2, -6.300000000000001, -53.30000000000009, -12.2, -11.8, -8.3, -20.700000000000003, -7.6000000000000005, -12.2, -9.3, -13.499999999999996, -4.2, -5.2, -17.0, -10.3, -12.2, -19.2, -10.3, -12.1, -6.2, -11.3, -8.3, -11.2, -43.400000000000034, -9.3, -18.1, -13.699999999999994, -6.8999999999999995, -21.799999999999997, -13.2, -10.2, -10.4, -9.499999999999998, -12.3, -6.2, -19.89999999999999, -4.9, -3.3, -11.7, -26.700000000000003, -18.6, -9.2, -9.3, -21.200000000000003, -10.2, -14.6, -14.1, -10.3, -11.599999999999998, -9.2, -6.3, -11.4, -24.10000000000001, -5.2, -4.9, -11.9, -15.0, -7.3, -42.3, -5.3, -6.4, -19.000000000000007, -10.499999999999993, -9.2, -18.200000000000003, -6.2, -11.7, -35.3, -6.2, -13.100000000000001, -9.5, -38.70000000000003, -8.3, -8.2, -41.2, -11.3, -11.3, -11.8, -17.9, -7.8999999999999995, -10.3, -5.300000000000001, -12.6, -11.7, -19.200000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9257656915581172, "mean_inference_ms": 1.1765749756862034, "mean_action_processing_ms": 0.06474881615739438, "mean_env_wait_ms": 5.373598327161728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 15093.748, "sample_throughput": 265.01, "load_time_ms": 0.375, "load_throughput": 10680682.455, "learn_time_ms": 7110.382, "learn_throughput": 562.558, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.25548998760960756, "policy_loss": 0.0008893046407930312, "vf_loss": 25.41427215260844, "vf_explained_var": 0.10099639732350585, "kl": 0.00814171423239656, "entropy": 0.24242660009091901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 432000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4320, "training_iteration": 108, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-08-27", "timestamp": 1643666907, "time_this_iter_s": 15.103031158447266, "time_total_s": 1583.0231575965881, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1583.0231575965881, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 28.85909090909091, "ram_util_percent": 72.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.3, "episode_reward_mean": -13.105000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.1, -13.699999999999994, -6.8999999999999995, -21.799999999999997, -13.2, -10.2, -10.4, -9.499999999999998, -12.3, -6.2, -19.89999999999999, -4.9, -3.3, -11.7, -26.700000000000003, -18.6, -9.2, -9.3, -21.200000000000003, -10.2, -14.6, -14.1, -10.3, -11.599999999999998, -9.2, -6.3, -11.4, -24.10000000000001, -5.2, -4.9, -11.9, -15.0, -7.3, -42.3, -5.3, -6.4, -19.000000000000007, -10.499999999999993, -9.2, -18.200000000000003, -6.2, -11.7, -35.3, -6.2, -13.100000000000001, -9.5, -38.70000000000003, -8.3, -8.2, -41.2, -11.3, -11.3, -11.8, -17.9, -7.8999999999999995, -10.3, -5.300000000000001, -12.6, -11.7, -19.200000000000006, -12.9, -6.3, -3.2, -6.199999999999999, -22.900000000000002, -8.3, -16.799999999999997, -16.399999999999995, -19.300000000000004, -18.799999999999997, -14.299999999999997, -6.300000000000001, -18.300000000000004, -4.9, -20.600000000000055, -7.499999999999999, -27.6, -15.299999999999995, -10.100000000000001, -11.200000000000001, -16.199999999999996, -11.3, -6.3, -29.30000000000004, -17.5, -3.4000000000000004, -10.1, -12.999999999999998, -6.699999999999998, -9.4, -7.9, -11.7, -7.899999999999998, -31.1, -13.9, -3.900000000000001, -5.2, -6.4, -6.2, -14.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9254535717471691, "mean_inference_ms": 1.1768542482607405, "mean_action_processing_ms": 0.06475994705483014, "mean_env_wait_ms": 5.375088701451673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 436000, "timesteps_this_iter": 0, "agent_timesteps_total": 436000, "timers": {"sample_time_ms": 15099.007, "sample_throughput": 264.918, "load_time_ms": 0.36, "load_throughput": 11113683.095, "learn_time_ms": 7096.988, "learn_throughput": 563.619, "update_time_ms": 1.614}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1404963310607659, "policy_loss": -0.0024979831570739386, "vf_loss": 14.241835210015697, "vf_explained_var": 0.12083327885596983, "kl": 0.010239425664023001, "entropy": 0.263059501478108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 436000, "num_agent_steps_sampled": 436000, "num_steps_trained": 436000, "num_agent_steps_trained": 436000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4360, "training_iteration": 109, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-08-42", "timestamp": 1643666922, "time_this_iter_s": 15.140816926956177, "time_total_s": 1598.1639745235443, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1598.1639745235443, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 29.3090909090909, "ram_util_percent": 72.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.2, "episode_reward_mean": -13.082999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -11.7, -35.3, -6.2, -13.100000000000001, -9.5, -38.70000000000003, -8.3, -8.2, -41.2, -11.3, -11.3, -11.8, -17.9, -7.8999999999999995, -10.3, -5.300000000000001, -12.6, -11.7, -19.200000000000006, -12.9, -6.3, -3.2, -6.199999999999999, -22.900000000000002, -8.3, -16.799999999999997, -16.399999999999995, -19.300000000000004, -18.799999999999997, -14.299999999999997, -6.300000000000001, -18.300000000000004, -4.9, -20.600000000000055, -7.499999999999999, -27.6, -15.299999999999995, -10.100000000000001, -11.200000000000001, -16.199999999999996, -11.3, -6.3, -29.30000000000004, -17.5, -3.4000000000000004, -10.1, -12.999999999999998, -6.699999999999998, -9.4, -7.9, -11.7, -7.899999999999998, -31.1, -13.9, -3.900000000000001, -5.2, -6.4, -6.2, -14.099999999999998, -21.800000000000004, -10.7, -5.7, -4.800000000000001, -13.099999999999996, -24.300000000000008, -8.2, -6.2, -11.1, -7.3, -9.6, -24.400000000000002, -10.2, -8.2, -12.3, -12.399999999999999, -9.399999999999999, -14.699999999999998, -4.2, -7.4, -7.300000000000001, -15.0, -7.199999999999999, -7.3, -8.2, -16.5, -18.0, -15.399999999999999, -24.200000000000014, -7.2, -18.999999999999996, -17.799999999999997, -24.699999999999996, -12.9, -21.700000000000003, -22.300000000000004, -7.300000000000001, -10.5, -11.3, -12.100000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9249590594704733, "mean_inference_ms": 1.1770415824862328, "mean_action_processing_ms": 0.06476890887756687, "mean_env_wait_ms": 5.3761486948824055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"sample_time_ms": 15072.437, "sample_throughput": 265.385, "load_time_ms": 0.373, "load_throughput": 10716841.904, "learn_time_ms": 7112.359, "learn_throughput": 562.401, "update_time_ms": 1.635}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.15118257474674973, "policy_loss": 0.0020574664036112447, "vf_loss": 14.88343398417196, "vf_explained_var": 0.10300974102430446, "kl": 0.005169273152828109, "entropy": 0.24771301858527686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 440000, "num_steps_trained": 440000, "num_agent_steps_trained": 440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4400, "training_iteration": 110, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-08-57", "timestamp": 1643666937, "time_this_iter_s": 14.968784809112549, "time_total_s": 1613.1327593326569, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1613.1327593326569, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 29.82857142857143, "ram_util_percent": 72.29999999999998}}
{"episode_reward_max": -3.4000000000000004, "episode_reward_min": -41.4, "episode_reward_mean": -12.878, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.199999999999996, -11.3, -6.3, -29.30000000000004, -17.5, -3.4000000000000004, -10.1, -12.999999999999998, -6.699999999999998, -9.4, -7.9, -11.7, -7.899999999999998, -31.1, -13.9, -3.900000000000001, -5.2, -6.4, -6.2, -14.099999999999998, -21.800000000000004, -10.7, -5.7, -4.800000000000001, -13.099999999999996, -24.300000000000008, -8.2, -6.2, -11.1, -7.3, -9.6, -24.400000000000002, -10.2, -8.2, -12.3, -12.399999999999999, -9.399999999999999, -14.699999999999998, -4.2, -7.4, -7.300000000000001, -15.0, -7.199999999999999, -7.3, -8.2, -16.5, -18.0, -15.399999999999999, -24.200000000000014, -7.2, -18.999999999999996, -17.799999999999997, -24.699999999999996, -12.9, -21.700000000000003, -22.300000000000004, -7.300000000000001, -10.5, -11.3, -12.100000000000001, -24.6, -15.399999999999999, -27.20000000000001, -6.3, -16.9, -10.499999999999998, -16.499999999999982, -6.1, -4.3, -5.5, -17.699999999999996, -21.700000000000003, -7.3, -9.4, -9.2, -13.499999999999995, -14.2, -12.399999999999999, -11.099999999999996, -9.1, -9.2, -8.099999999999998, -16.2, -4.800000000000001, -4.4, -28.300000000000043, -28.200000000000003, -19.399999999999984, -7.300000000000001, -8.4, -11.1, -41.4, -11.5, -4.3, -7.2, -16.799999999999997, -9.499999999999998, -14.3, -6.300000000000001, -28.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9247958744731521, "mean_inference_ms": 1.177174578327841, "mean_action_processing_ms": 0.06477153600795452, "mean_env_wait_ms": 5.376362419813525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 444000, "timesteps_this_iter": 0, "agent_timesteps_total": 444000, "timers": {"sample_time_ms": 15121.857, "sample_throughput": 264.518, "load_time_ms": 0.373, "load_throughput": 10727806.126, "learn_time_ms": 7111.967, "learn_throughput": 562.432, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.17174644005504908, "policy_loss": -0.01352490697817136, "vf_loss": 18.485785118931084, "vf_explained_var": 0.25661146397231727, "kl": 0.007351095191217865, "entropy": 0.23750553280916264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 444000, "num_agent_steps_sampled": 444000, "num_steps_trained": 444000, "num_agent_steps_trained": 444000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4440, "training_iteration": 111, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-09-12", "timestamp": 1643666952, "time_this_iter_s": 14.9670991897583, "time_total_s": 1628.0998585224152, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1628.0998585224152, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 30.657142857142862, "ram_util_percent": 72.34761904761906}}
{"episode_reward_max": -2.2, "episode_reward_min": -41.4, "episode_reward_mean": -13.434000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -15.0, -7.199999999999999, -7.3, -8.2, -16.5, -18.0, -15.399999999999999, -24.200000000000014, -7.2, -18.999999999999996, -17.799999999999997, -24.699999999999996, -12.9, -21.700000000000003, -22.300000000000004, -7.300000000000001, -10.5, -11.3, -12.100000000000001, -24.6, -15.399999999999999, -27.20000000000001, -6.3, -16.9, -10.499999999999998, -16.499999999999982, -6.1, -4.3, -5.5, -17.699999999999996, -21.700000000000003, -7.3, -9.4, -9.2, -13.499999999999995, -14.2, -12.399999999999999, -11.099999999999996, -9.1, -9.2, -8.099999999999998, -16.2, -4.800000000000001, -4.4, -28.300000000000043, -28.200000000000003, -19.399999999999984, -7.300000000000001, -8.4, -11.1, -41.4, -11.5, -4.3, -7.2, -16.799999999999997, -9.499999999999998, -14.3, -6.300000000000001, -28.799999999999997, -17.2, -37.099999999999994, -14.399999999999972, -9.999999999999998, -10.3, -2.5, -6.2, -8.3, -7.3999999999999995, -12.099999999999996, -5.4, -38.4, -4.4, -11.099999999999998, -13.8, -11.099999999999998, -6.099999999999999, -5.4, -16.5, -8.4, -6.300000000000001, -12.1, -3.4, -6.199999999999999, -15.19999999999997, -27.799999999999997, -5.9, -9.7, -7.7, -6.0, -2.2, -8.3, -10.799999999999999, -3.3000000000000003, -4.2, -35.8, -28.6, -38.3, -25.0, -10.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9249242745435069, "mean_inference_ms": 1.1773837762465964, "mean_action_processing_ms": 0.0647757180447556, "mean_env_wait_ms": 5.376753495729524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 448000, "timesteps_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"sample_time_ms": 15155.771, "sample_throughput": 263.926, "load_time_ms": 0.373, "load_throughput": 10713420.179, "learn_time_ms": 7100.755, "learn_throughput": 563.32, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.2794189273830383, "policy_loss": -0.007848085534147998, "vf_loss": 28.663451266352848, "vf_explained_var": 0.024568739052741758, "kl": 0.011244612180752688, "entropy": 0.22979031299711555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 448000, "num_agent_steps_sampled": 448000, "num_steps_trained": 448000, "num_agent_steps_trained": 448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4480, "training_iteration": 112, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-09-27", "timestamp": 1643666967, "time_this_iter_s": 15.260885000228882, "time_total_s": 1643.360743522644, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1643.360743522644, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 29.30454545454545, "ram_util_percent": 72.53636363636362}}
{"episode_reward_max": -2.2, "episode_reward_min": -43.3, "episode_reward_mean": -12.913, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -8.099999999999998, -16.2, -4.800000000000001, -4.4, -28.300000000000043, -28.200000000000003, -19.399999999999984, -7.300000000000001, -8.4, -11.1, -41.4, -11.5, -4.3, -7.2, -16.799999999999997, -9.499999999999998, -14.3, -6.300000000000001, -28.799999999999997, -17.2, -37.099999999999994, -14.399999999999972, -9.999999999999998, -10.3, -2.5, -6.2, -8.3, -7.3999999999999995, -12.099999999999996, -5.4, -38.4, -4.4, -11.099999999999998, -13.8, -11.099999999999998, -6.099999999999999, -5.4, -16.5, -8.4, -6.300000000000001, -12.1, -3.4, -6.199999999999999, -15.19999999999997, -27.799999999999997, -5.9, -9.7, -7.7, -6.0, -2.2, -8.3, -10.799999999999999, -3.3000000000000003, -4.2, -35.8, -28.6, -38.3, -25.0, -10.2, -6.1, -5.2, -7.300000000000001, -10.299999999999999, -14.499999999999996, -5.4, -9.3, -30.2, -11.7, -11.999999999999998, -12.7, -8.2, -9.7, -10.2, -2.8000000000000007, -4.4, -8.3, -16.699999999999996, -3.7, -28.000000000000046, -10.9, -17.4, -12.100000000000001, -28.500000000000004, -9.4, -7.300000000000001, -9.3, -7.3, -7.199999999999999, -9.600000000000001, -6.300000000000001, -43.3, -32.099999999999994, -8.2, -6.2, -6.3, -21.500000000000007, -14.999999999999998, -11.799999999999997, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9251635928992692, "mean_inference_ms": 1.177569708993498, "mean_action_processing_ms": 0.06478358437770283, "mean_env_wait_ms": 5.3775585347518104, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 452000, "timesteps_this_iter": 0, "agent_timesteps_total": 452000, "timers": {"sample_time_ms": 15145.477, "sample_throughput": 264.105, "load_time_ms": 0.385, "load_throughput": 10390299.127, "learn_time_ms": 7119.646, "learn_throughput": 561.826, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.168779980075816, "policy_loss": -0.00581023642713184, "vf_loss": 17.416416530134857, "vf_explained_var": 0.24651795305231566, "kl": 0.007574280508480226, "entropy": 0.22933080516034557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 452000, "num_agent_steps_sampled": 452000, "num_steps_trained": 452000, "num_agent_steps_trained": 452000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4520, "training_iteration": 113, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-09-43", "timestamp": 1643666983, "time_this_iter_s": 15.417436838150024, "time_total_s": 1658.778180360794, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1658.778180360794, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 29.53181818181819, "ram_util_percent": 72.67272727272729}}
{"episode_reward_max": -1.2, "episode_reward_min": -43.3, "episode_reward_mean": -12.255, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.300000000000001, -12.1, -3.4, -6.199999999999999, -15.19999999999997, -27.799999999999997, -5.9, -9.7, -7.7, -6.0, -2.2, -8.3, -10.799999999999999, -3.3000000000000003, -4.2, -35.8, -28.6, -38.3, -25.0, -10.2, -6.1, -5.2, -7.300000000000001, -10.299999999999999, -14.499999999999996, -5.4, -9.3, -30.2, -11.7, -11.999999999999998, -12.7, -8.2, -9.7, -10.2, -2.8000000000000007, -4.4, -8.3, -16.699999999999996, -3.7, -28.000000000000046, -10.9, -17.4, -12.100000000000001, -28.500000000000004, -9.4, -7.300000000000001, -9.3, -7.3, -7.199999999999999, -9.600000000000001, -6.300000000000001, -43.3, -32.099999999999994, -8.2, -6.2, -6.3, -21.500000000000007, -14.999999999999998, -11.799999999999997, -6.300000000000001, -17.4, -23.099999999999948, -3.7, -16.099999999999998, -6.2, -4.4, -15.999999999999998, -7.2, -5.000000000000001, -12.599999999999998, -4.3, -4.700000000000001, -3.6000000000000005, -24.300000000000004, -31.5, -10.500000000000002, -40.3, -5.2, -2.2, -10.1, -5.3, -8.3, -7.2, -15.8, -1.2, -25.699999999999996, -16.799999999999997, -12.899999999999991, -13.299999999999978, -3.4, -9.1, -15.399999999999999, -6.2, -14.699999999999998, -12.099999999999998, -8.399999999999999, -19.299999999999997, -11.3, -3.2, -7.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9255882873333404, "mean_inference_ms": 1.1777216231288639, "mean_action_processing_ms": 0.06479333661120126, "mean_env_wait_ms": 5.3785556535814685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"sample_time_ms": 15160.106, "sample_throughput": 263.85, "load_time_ms": 0.379, "load_throughput": 10563667.044, "learn_time_ms": 7115.923, "learn_throughput": 562.12, "update_time_ms": 1.566}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.18309602889442636, "policy_loss": -0.003915895451541229, "vf_loss": 18.645207647738918, "vf_explained_var": 0.036725804434027724, "kl": 0.009952960285926914, "entropy": 0.24642496000054062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 456000, "num_steps_trained": 456000, "num_agent_steps_trained": 456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4560, "training_iteration": 114, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-09-58", "timestamp": 1643666998, "time_this_iter_s": 15.293220043182373, "time_total_s": 1674.0714004039764, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1674.0714004039764, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 28.322727272727267, "ram_util_percent": 72.70000000000002}}
{"episode_reward_max": -1.2, "episode_reward_min": -67.5, "episode_reward_mean": -13.351999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.9, -17.4, -12.100000000000001, -28.500000000000004, -9.4, -7.300000000000001, -9.3, -7.3, -7.199999999999999, -9.600000000000001, -6.300000000000001, -43.3, -32.099999999999994, -8.2, -6.2, -6.3, -21.500000000000007, -14.999999999999998, -11.799999999999997, -6.300000000000001, -17.4, -23.099999999999948, -3.7, -16.099999999999998, -6.2, -4.4, -15.999999999999998, -7.2, -5.000000000000001, -12.599999999999998, -4.3, -4.700000000000001, -3.6000000000000005, -24.300000000000004, -31.5, -10.500000000000002, -40.3, -5.2, -2.2, -10.1, -5.3, -8.3, -7.2, -15.8, -1.2, -25.699999999999996, -16.799999999999997, -12.899999999999991, -13.299999999999978, -3.4, -9.1, -15.399999999999999, -6.2, -14.699999999999998, -12.099999999999998, -8.399999999999999, -19.299999999999997, -11.3, -3.2, -7.799999999999999, -7.799999999999998, -12.399999999999999, -3.4, -7.2, -67.5, -14.599999999999996, -20.3, -9.2, -16.099999999999998, -25.800000000000043, -25.3, -8.3, -19.9, -11.299999999999999, -25.700000000000006, -13.2, -7.700000000000001, -10.399999999999999, -19.6, -3.4, -14.999999999999998, -19.299999999999997, -11.299999999999999, -8.799999999999997, -3.3, -6.199999999999999, -8.3, -4.4, -17.6, -34.2, -5.2, -4.4, -16.9, -9.2, -27.700000000000014, -10.5, -23.6, -9.3, -9.799999999999997, -19.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9256820809866098, "mean_inference_ms": 1.1777653676753705, "mean_action_processing_ms": 0.06479886601981763, "mean_env_wait_ms": 5.378786099583014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"sample_time_ms": 15141.338, "sample_throughput": 264.177, "load_time_ms": 0.368, "load_throughput": 10865368.823, "learn_time_ms": 7106.651, "learn_throughput": 562.853, "update_time_ms": 1.596}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.3399820569141578, "policy_loss": -0.00042833992209966466, "vf_loss": 33.98418015023714, "vf_explained_var": 0.08824002409494051, "kl": 0.010108490645590912, "entropy": 0.21220600295771835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 460000, "num_steps_trained": 460000, "num_agent_steps_trained": 460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4600, "training_iteration": 115, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-10-13", "timestamp": 1643667013, "time_this_iter_s": 14.91025710105896, "time_total_s": 1688.9816575050354, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1688.9816575050354, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 16.752380952380957, "ram_util_percent": 72.70000000000002}}
{"episode_reward_max": -1.2, "episode_reward_min": -67.5, "episode_reward_mean": -12.238, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -8.3, -7.2, -15.8, -1.2, -25.699999999999996, -16.799999999999997, -12.899999999999991, -13.299999999999978, -3.4, -9.1, -15.399999999999999, -6.2, -14.699999999999998, -12.099999999999998, -8.399999999999999, -19.299999999999997, -11.3, -3.2, -7.799999999999999, -7.799999999999998, -12.399999999999999, -3.4, -7.2, -67.5, -14.599999999999996, -20.3, -9.2, -16.099999999999998, -25.800000000000043, -25.3, -8.3, -19.9, -11.299999999999999, -25.700000000000006, -13.2, -7.700000000000001, -10.399999999999999, -19.6, -3.4, -14.999999999999998, -19.299999999999997, -11.299999999999999, -8.799999999999997, -3.3, -6.199999999999999, -8.3, -4.4, -17.6, -34.2, -5.2, -4.4, -16.9, -9.2, -27.700000000000014, -10.5, -23.6, -9.3, -9.799999999999997, -19.300000000000004, -3.6000000000000005, -2.4000000000000004, -28.6, -7.799999999999998, -19.6, -11.5, -10.599999999999998, -4.2, -7.799999999999999, -21.300000000000004, -8.3, -9.3, -11.7, -11.5, -14.099999999999998, -8.2, -10.4, -12.2, -16.89999999999999, -6.300000000000001, -8.2, -12.0, -10.600000000000001, -4.4, -9.7, -9.799999999999999, -12.499999999999993, -11.0, -6.199999999999999, -5.4, -3.3, -4.4, -20.60000000000001, -5.300000000000001, -9.2, -7.300000000000001, -9.999999999999996, -2.7000000000000006, -12.3, -21.800000000000015], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9258425362853248, "mean_inference_ms": 1.1780109150341584, "mean_action_processing_ms": 0.06481354528774014, "mean_env_wait_ms": 5.379838950659303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 464000, "timesteps_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"sample_time_ms": 15148.316, "sample_throughput": 264.056, "load_time_ms": 0.372, "load_throughput": 10756694.236, "learn_time_ms": 7115.51, "learn_throughput": 562.152, "update_time_ms": 1.568}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.1000821613421243, "policy_loss": -0.006861165105815857, "vf_loss": 10.647411185278687, "vf_explained_var": 0.10502148514152855, "kl": 0.008341702191396011, "entropy": 0.1667978908826587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 464000, "num_agent_steps_sampled": 464000, "num_steps_trained": 464000, "num_agent_steps_trained": 464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4640, "training_iteration": 116, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-10-29", "timestamp": 1643667029, "time_this_iter_s": 15.675941705703735, "time_total_s": 1704.6575992107391, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1704.6575992107391, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 18.08636363636364, "ram_util_percent": 72.80454545454545}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -34.2, "episode_reward_mean": -11.041000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.999999999999998, -19.299999999999997, -11.299999999999999, -8.799999999999997, -3.3, -6.199999999999999, -8.3, -4.4, -17.6, -34.2, -5.2, -4.4, -16.9, -9.2, -27.700000000000014, -10.5, -23.6, -9.3, -9.799999999999997, -19.300000000000004, -3.6000000000000005, -2.4000000000000004, -28.6, -7.799999999999998, -19.6, -11.5, -10.599999999999998, -4.2, -7.799999999999999, -21.300000000000004, -8.3, -9.3, -11.7, -11.5, -14.099999999999998, -8.2, -10.4, -12.2, -16.89999999999999, -6.300000000000001, -8.2, -12.0, -10.600000000000001, -4.4, -9.7, -9.799999999999999, -12.499999999999993, -11.0, -6.199999999999999, -5.4, -3.3, -4.4, -20.60000000000001, -5.300000000000001, -9.2, -7.300000000000001, -9.999999999999996, -2.7000000000000006, -12.3, -21.800000000000015, -15.099999999999996, -13.8, -10.8, -12.5, -3.4, -18.2, -13.6, -3.7, -23.4, -16.5, -22.200000000000003, -13.2, -5.700000000000001, -8.3, -6.300000000000001, -3.3, -16.9, -8.2, -14.399999999999999, -6.199999999999999, -12.599999999999996, -5.3, -8.4, -18.199999999999996, -17.099999999999994, -4.300000000000001, -9.799999999999999, -4.2, -5.2, -3.6000000000000005, -17.0, -5.4, -5.1, -17.4, -4.4, -19.000000000000007, -12.499999999999996, -7.2, -6.2, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9257299063345288, "mean_inference_ms": 1.1785698344690188, "mean_action_processing_ms": 0.06483526910046214, "mean_env_wait_ms": 5.38218535832724, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 468000, "timesteps_this_iter": 0, "agent_timesteps_total": 468000, "timers": {"sample_time_ms": 15229.146, "sample_throughput": 262.654, "load_time_ms": 0.372, "load_throughput": 10742918.614, "learn_time_ms": 7123.251, "learn_throughput": 561.541, "update_time_ms": 1.547}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 0.08084972327955628, "policy_loss": -0.0028698922205035405, "vf_loss": 8.347659441604408, "vf_explained_var": 0.30540295153535824, "kl": 0.004320403177644151, "entropy": 0.14948613959294493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 468000, "num_agent_steps_sampled": 468000, "num_steps_trained": 468000, "num_agent_steps_trained": 468000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4680, "training_iteration": 117, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-10-44", "timestamp": 1643667044, "time_this_iter_s": 15.351675987243652, "time_total_s": 1720.0092751979828, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1720.0092751979828, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 17.26818181818182, "ram_util_percent": 72.83636363636364}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -24.6, "episode_reward_mean": -10.056999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -12.0, -10.600000000000001, -4.4, -9.7, -9.799999999999999, -12.499999999999993, -11.0, -6.199999999999999, -5.4, -3.3, -4.4, -20.60000000000001, -5.300000000000001, -9.2, -7.300000000000001, -9.999999999999996, -2.7000000000000006, -12.3, -21.800000000000015, -15.099999999999996, -13.8, -10.8, -12.5, -3.4, -18.2, -13.6, -3.7, -23.4, -16.5, -22.200000000000003, -13.2, -5.700000000000001, -8.3, -6.300000000000001, -3.3, -16.9, -8.2, -14.399999999999999, -6.199999999999999, -12.599999999999996, -5.3, -8.4, -18.199999999999996, -17.099999999999994, -4.300000000000001, -9.799999999999999, -4.2, -5.2, -3.6000000000000005, -17.0, -5.4, -5.1, -17.4, -4.4, -19.000000000000007, -12.499999999999996, -7.2, -6.2, -8.2, -11.799999999999997, -15.399999999999991, -4.3, -12.999999999999995, -4.300000000000001, -17.599999999999998, -6.3, -4.3, -10.2, -23.599999999999998, -7.2, -24.6, -4.700000000000001, -7.800000000000001, -10.099999999999998, -17.9, -3.7, -3.3, -3.6000000000000005, -17.2, -12.100000000000001, -4.3, -15.699999999999992, -6.3, -12.7, -13.3, -9.1, -3.3, -14.600000000000001, -5.3, -11.3, -9.799999999999997, -12.1, -13.099999999999996, -4.3, -9.2, -10.4, -3.4, -4.300000000000001, -6.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9254816106910347, "mean_inference_ms": 1.1791060409955267, "mean_action_processing_ms": 0.06485456021308623, "mean_env_wait_ms": 5.384435031356804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 472000, "timesteps_this_iter": 0, "agent_timesteps_total": 472000, "timers": {"sample_time_ms": 15228.729, "sample_throughput": 262.661, "load_time_ms": 0.381, "load_throughput": 10487070.884, "learn_time_ms": 7152.115, "learn_throughput": 559.275, "update_time_ms": 1.553}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.08008178909539536, "policy_loss": 0.004143696593781633, "vf_loss": 7.572442709758717, "vf_explained_var": 0.20298424875864418, "kl": 0.007597110932047696, "entropy": 0.17541010326115034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 472000, "num_agent_steps_sampled": 472000, "num_steps_trained": 472000, "num_agent_steps_trained": 472000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4720, "training_iteration": 118, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-10-59", "timestamp": 1643667059, "time_this_iter_s": 15.276704788208008, "time_total_s": 1735.2859799861908, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1735.2859799861908, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 19.349999999999998, "ram_util_percent": 72.90000000000003}}
{"episode_reward_max": -3.2, "episode_reward_min": -32.3, "episode_reward_mean": -10.171999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.599999999999996, -5.3, -8.4, -18.199999999999996, -17.099999999999994, -4.300000000000001, -9.799999999999999, -4.2, -5.2, -3.6000000000000005, -17.0, -5.4, -5.1, -17.4, -4.4, -19.000000000000007, -12.499999999999996, -7.2, -6.2, -8.2, -11.799999999999997, -15.399999999999991, -4.3, -12.999999999999995, -4.300000000000001, -17.599999999999998, -6.3, -4.3, -10.2, -23.599999999999998, -7.2, -24.6, -4.700000000000001, -7.800000000000001, -10.099999999999998, -17.9, -3.7, -3.3, -3.6000000000000005, -17.2, -12.100000000000001, -4.3, -15.699999999999992, -6.3, -12.7, -13.3, -9.1, -3.3, -14.600000000000001, -5.3, -11.3, -9.799999999999997, -12.1, -13.099999999999996, -4.3, -9.2, -10.4, -3.4, -4.300000000000001, -6.699999999999999, -20.599999999999987, -7.3, -14.3, -3.3, -11.4, -9.2, -4.3, -9.2, -12.19999999999999, -9.3, -10.9, -3.2, -32.3, -3.3, -5.300000000000001, -3.3, -4.4, -11.299999999999995, -11.799999999999999, -15.7, -4.9, -14.099999999999996, -15.2, -3.3, -13.699999999999998, -29.400000000000002, -3.4, -8.2, -17.0, -11.699999999999998, -15.999999999999996, -7.699999999999998, -18.700000000000003, -14.099999999999998, -11.999999999999996, -8.2, -9.3, -9.2, -11.8, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9250516648963085, "mean_inference_ms": 1.1792909422595008, "mean_action_processing_ms": 0.06486397920359387, "mean_env_wait_ms": 5.385549658764038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 476000, "timesteps_this_iter": 0, "agent_timesteps_total": 476000, "timers": {"sample_time_ms": 15234.327, "sample_throughput": 262.565, "load_time_ms": 0.382, "load_throughput": 10467441.977, "learn_time_ms": 7170.301, "learn_throughput": 557.857, "update_time_ms": 1.547}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.07554695446504861, "policy_loss": -0.010496731081436719, "vf_loss": 8.555071455112067, "vf_explained_var": 0.34177337327311114, "kl": 0.01752795503515282, "entropy": 0.18082992529837033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 476000, "num_agent_steps_sampled": 476000, "num_steps_trained": 476000, "num_agent_steps_trained": 476000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4760, "training_iteration": 119, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-11-14", "timestamp": 1643667074, "time_this_iter_s": 15.115293264389038, "time_total_s": 1750.4012732505798, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1750.4012732505798, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.785714285714285, "ram_util_percent": 72.84761904761903}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -46.900000000000006, "episode_reward_mean": -10.951999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.100000000000001, -4.3, -15.699999999999992, -6.3, -12.7, -13.3, -9.1, -3.3, -14.600000000000001, -5.3, -11.3, -9.799999999999997, -12.1, -13.099999999999996, -4.3, -9.2, -10.4, -3.4, -4.300000000000001, -6.699999999999999, -20.599999999999987, -7.3, -14.3, -3.3, -11.4, -9.2, -4.3, -9.2, -12.19999999999999, -9.3, -10.9, -3.2, -32.3, -3.3, -5.300000000000001, -3.3, -4.4, -11.299999999999995, -11.799999999999999, -15.7, -4.9, -14.099999999999996, -15.2, -3.3, -13.699999999999998, -29.400000000000002, -3.4, -8.2, -17.0, -11.699999999999998, -15.999999999999996, -7.699999999999998, -18.700000000000003, -14.099999999999998, -11.999999999999996, -8.2, -9.3, -9.2, -11.8, -3.4, -8.8, -20.0, -14.39999999999999, -2.4000000000000004, -6.199999999999999, -9.2, -10.999999999999996, -11.699999999999998, -19.3, -11.9, -11.1, -37.3, -13.600000000000001, -5.199999999999999, -14.999999999999998, -5.0, -5.2, -11.4, -15.1, -11.899999999999999, -12.699999999999989, -5.3, -4.3, -4.300000000000001, -21.5, -3.2, -4.4, -7.4, -9.7, -10.3, -46.900000000000006, -10.099999999999996, -4.3, -5.300000000000001, -11.299999999999999, -15.799999999999999, -15.299999999999997, -7.3, -24.30000000000002, -10.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9250309964912345, "mean_inference_ms": 1.1794187538733032, "mean_action_processing_ms": 0.06487094474453492, "mean_env_wait_ms": 5.386029145217901, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 15275.029, "sample_throughput": 261.865, "load_time_ms": 0.369, "load_throughput": 10853419.589, "learn_time_ms": 7176.506, "learn_throughput": 557.374, "update_time_ms": 1.541}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.1740487138191188, "policy_loss": -0.005289011569793826, "vf_loss": 17.902797160513938, "vf_explained_var": 0.1976848828536208, "kl": 0.01101368292290767, "entropy": 0.1951985098301403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4800, "training_iteration": 120, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-11-30", "timestamp": 1643667090, "time_this_iter_s": 15.241161108016968, "time_total_s": 1765.6424343585968, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1765.6424343585968, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 29.122727272727275, "ram_util_percent": 72.79999999999998}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -46.900000000000006, "episode_reward_mean": -11.277000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.9, -14.099999999999996, -15.2, -3.3, -13.699999999999998, -29.400000000000002, -3.4, -8.2, -17.0, -11.699999999999998, -15.999999999999996, -7.699999999999998, -18.700000000000003, -14.099999999999998, -11.999999999999996, -8.2, -9.3, -9.2, -11.8, -3.4, -8.8, -20.0, -14.39999999999999, -2.4000000000000004, -6.199999999999999, -9.2, -10.999999999999996, -11.699999999999998, -19.3, -11.9, -11.1, -37.3, -13.600000000000001, -5.199999999999999, -14.999999999999998, -5.0, -5.2, -11.4, -15.1, -11.899999999999999, -12.699999999999989, -5.3, -4.3, -4.300000000000001, -21.5, -3.2, -4.4, -7.4, -9.7, -10.3, -46.900000000000006, -10.099999999999996, -4.3, -5.300000000000001, -11.299999999999999, -15.799999999999999, -15.299999999999997, -7.3, -24.30000000000002, -10.6, -21.6, -13.999999999999998, -4.3, -6.099999999999999, -8.2, -24.1, -4.2, -8.3, -11.5, -12.2, -26.3, -10.4, -33.10000000000001, -4.4, -12.600000000000001, -16.9, -3.2, -3.4, -14.399999999999999, -6.5, -12.099999999999998, -9.200000000000001, -9.999999999999996, -9.3, -4.4, -4.300000000000001, -10.699999999999996, -7.6000000000000005, -3.4, -8.2, -20.0, -14.1, -4.300000000000001, -6.1, -15.5, -4.3, -4.4, -8.2, -5.300000000000001, -9.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9251327001052172, "mean_inference_ms": 1.1795094488518862, "mean_action_processing_ms": 0.06487534064294058, "mean_env_wait_ms": 5.38640016191498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 484000, "timesteps_this_iter": 0, "agent_timesteps_total": 484000, "timers": {"sample_time_ms": 15271.603, "sample_throughput": 261.924, "load_time_ms": 0.371, "load_throughput": 10774655.449, "learn_time_ms": 7219.29, "learn_throughput": 554.071, "update_time_ms": 1.546}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.11055389025839427, "policy_loss": -0.006325365907402449, "vf_loss": 11.668756378081538, "vf_explained_var": 0.22223960962346806, "kl": 0.006815787710814222, "entropy": 0.18397305573346795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 484000, "num_agent_steps_sampled": 484000, "num_steps_trained": 484000, "num_agent_steps_trained": 484000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4840, "training_iteration": 121, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-11-45", "timestamp": 1643667105, "time_this_iter_s": 15.306702136993408, "time_total_s": 1780.9491364955902, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1780.9491364955902, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 20.266666666666666, "ram_util_percent": 72.80000000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -96.60000000000001, "episode_reward_mean": -12.481000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.699999999999989, -5.3, -4.3, -4.300000000000001, -21.5, -3.2, -4.4, -7.4, -9.7, -10.3, -46.900000000000006, -10.099999999999996, -4.3, -5.300000000000001, -11.299999999999999, -15.799999999999999, -15.299999999999997, -7.3, -24.30000000000002, -10.6, -21.6, -13.999999999999998, -4.3, -6.099999999999999, -8.2, -24.1, -4.2, -8.3, -11.5, -12.2, -26.3, -10.4, -33.10000000000001, -4.4, -12.600000000000001, -16.9, -3.2, -3.4, -14.399999999999999, -6.5, -12.099999999999998, -9.200000000000001, -9.999999999999996, -9.3, -4.4, -4.300000000000001, -10.699999999999996, -7.6000000000000005, -3.4, -8.2, -20.0, -14.1, -4.300000000000001, -6.1, -15.5, -4.3, -4.4, -8.2, -5.300000000000001, -9.3, -24.300000000000004, -9.899999999999997, -9.2, -12.2, -6.600000000000001, -23.400000000000006, -13.3, -6.3, -13.9, -4.7, -7.2, -5.4, -15.099999999999998, -7.3, -17.6, -11.4, -4.4, -14.399999999999999, -4.6000000000000005, -96.60000000000001, -5.4, -5.300000000000001, -11.199999999999998, -7.2, -14.1, -10.799999999999999, -14.599999999999998, -29.5, -16.5, -10.5, -12.5, -6.199999999999999, -29.5, -7.3, -12.6, -42.60000000000001, -7.2, -7.9, -22.199999999999964, -16.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9256487480275908, "mean_inference_ms": 1.1794958407624727, "mean_action_processing_ms": 0.06487304539568692, "mean_env_wait_ms": 5.386348512128231, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 488000, "timesteps_this_iter": 0, "agent_timesteps_total": 488000, "timers": {"sample_time_ms": 15274.204, "sample_throughput": 261.879, "load_time_ms": 0.363, "load_throughput": 11030385.273, "learn_time_ms": 7256.069, "learn_throughput": 551.263, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.5416136986107856, "policy_loss": -0.00021847561001777648, "vf_loss": 54.160097249092594, "vf_explained_var": 7.261448009039766e-06, "kl": 0.00822091336555427, "entropy": 0.21534829773409392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 488000, "num_agent_steps_sampled": 488000, "num_steps_trained": 488000, "num_agent_steps_trained": 488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4880, "training_iteration": 122, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-12-00", "timestamp": 1643667120, "time_this_iter_s": 15.222155809402466, "time_total_s": 1796.1712923049927, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1796.1712923049927, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 32.09545454545455, "ram_util_percent": 72.78636363636362}}
{"episode_reward_max": -3.3, "episode_reward_min": -96.60000000000001, "episode_reward_mean": -12.871000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.099999999999998, -9.200000000000001, -9.999999999999996, -9.3, -4.4, -4.300000000000001, -10.699999999999996, -7.6000000000000005, -3.4, -8.2, -20.0, -14.1, -4.300000000000001, -6.1, -15.5, -4.3, -4.4, -8.2, -5.300000000000001, -9.3, -24.300000000000004, -9.899999999999997, -9.2, -12.2, -6.600000000000001, -23.400000000000006, -13.3, -6.3, -13.9, -4.7, -7.2, -5.4, -15.099999999999998, -7.3, -17.6, -11.4, -4.4, -14.399999999999999, -4.6000000000000005, -96.60000000000001, -5.4, -5.300000000000001, -11.199999999999998, -7.2, -14.1, -10.799999999999999, -14.599999999999998, -29.5, -16.5, -10.5, -12.5, -6.199999999999999, -29.5, -7.3, -12.6, -42.60000000000001, -7.2, -7.9, -22.199999999999964, -16.5, -3.4000000000000004, -10.1, -4.300000000000001, -3.3, -18.800000000000004, -9.2, -23.9, -5.9, -4.3, -92.4, -11.699999999999998, -21.4, -8.9, -8.3, -3.8000000000000003, -36.30000000000001, -14.399999999999997, -3.3, -13.8, -8.3, -13.5, -6.2, -4.4, -19.6, -13.399999999999999, -7.300000000000001, -13.3, -7.3, -13.2, -16.7, -13.3, -8.899999999999999, -21.899999999999995, -7.7, -5.4, -5.9, -5.4, -5.4, -17.199999999999996, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9262734325133835, "mean_inference_ms": 1.1795114743048307, "mean_action_processing_ms": 0.06487296090261911, "mean_env_wait_ms": 5.386523590865631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 492000, "timesteps_this_iter": 0, "agent_timesteps_total": 492000, "timers": {"sample_time_ms": 15297.59, "sample_throughput": 261.479, "load_time_ms": 0.352, "load_throughput": 11362828.31, "learn_time_ms": 7259.736, "learn_throughput": 550.984, "update_time_ms": 1.548}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.48855321634428134, "policy_loss": -0.006766402304312715, "vf_loss": 49.50319479921813, "vf_explained_var": 0.15452142889781664, "kl": 0.010228682187518585, "entropy": 0.20659442849216922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 492000, "num_agent_steps_sampled": 492000, "num_steps_trained": 492000, "num_agent_steps_trained": 492000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4920, "training_iteration": 123, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-12-16", "timestamp": 1643667136, "time_this_iter_s": 15.331471920013428, "time_total_s": 1811.502764225006, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1811.502764225006, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 26.254545454545454, "ram_util_percent": 72.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -92.4, "episode_reward_mean": -12.845000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -5.300000000000001, -11.199999999999998, -7.2, -14.1, -10.799999999999999, -14.599999999999998, -29.5, -16.5, -10.5, -12.5, -6.199999999999999, -29.5, -7.3, -12.6, -42.60000000000001, -7.2, -7.9, -22.199999999999964, -16.5, -3.4000000000000004, -10.1, -4.300000000000001, -3.3, -18.800000000000004, -9.2, -23.9, -5.9, -4.3, -92.4, -11.699999999999998, -21.4, -8.9, -8.3, -3.8000000000000003, -36.30000000000001, -14.399999999999997, -3.3, -13.8, -8.3, -13.5, -6.2, -4.4, -19.6, -13.399999999999999, -7.300000000000001, -13.3, -7.3, -13.2, -16.7, -13.3, -8.899999999999999, -21.899999999999995, -7.7, -5.4, -5.9, -5.4, -5.4, -17.199999999999996, -7.2, -15.8, -6.300000000000001, -6.5, -4.2, -28.40000000000001, -9.3, -14.5, -6.3, -7.3, -4.800000000000001, -13.7, -6.5, -4.4, -18.10000000000001, -15.3, -39.699999999999996, -26.099999999999994, -14.999999999999995, -11.2, -9.6, -7.399999999999999, -8.2, -14.5, -9.7, -6.2, -20.699999999999996, -4.3, -15.5, -8.3, -15.899999999999999, -17.900000000000002, -4.9, -10.600000000000001, -21.10000000000001, -3.3, -14.199999999999987, -3.900000000000001, -10.89999999999999, -3.2, -12.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9267551466942381, "mean_inference_ms": 1.1795557453525414, "mean_action_processing_ms": 0.06489459482492975, "mean_env_wait_ms": 5.386845755935956, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 496000, "timesteps_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"sample_time_ms": 15274.024, "sample_throughput": 261.883, "load_time_ms": 0.358, "load_throughput": 11158773.528, "learn_time_ms": 7281.344, "learn_throughput": 549.349, "update_time_ms": 1.537}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.11800335405134066, "policy_loss": -0.009539711328663974, "vf_loss": 12.717010538424216, "vf_explained_var": 0.35232483372893386, "kl": 0.013260897992454048, "entropy": 0.22807972171614246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 496000, "num_agent_steps_sampled": 496000, "num_steps_trained": 496000, "num_agent_steps_trained": 496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4960, "training_iteration": 124, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-12-31", "timestamp": 1643667151, "time_this_iter_s": 15.250379085540771, "time_total_s": 1826.7531433105469, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1826.7531433105469, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 22.74761904761905, "ram_util_percent": 72.8714285714286}}
{"episode_reward_max": -3.2, "episode_reward_min": -41.400000000000055, "episode_reward_mean": -12.830000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.5, -6.2, -4.4, -19.6, -13.399999999999999, -7.300000000000001, -13.3, -7.3, -13.2, -16.7, -13.3, -8.899999999999999, -21.899999999999995, -7.7, -5.4, -5.9, -5.4, -5.4, -17.199999999999996, -7.2, -15.8, -6.300000000000001, -6.5, -4.2, -28.40000000000001, -9.3, -14.5, -6.3, -7.3, -4.800000000000001, -13.7, -6.5, -4.4, -18.10000000000001, -15.3, -39.699999999999996, -26.099999999999994, -14.999999999999995, -11.2, -9.6, -7.399999999999999, -8.2, -14.5, -9.7, -6.2, -20.699999999999996, -4.3, -15.5, -8.3, -15.899999999999999, -17.900000000000002, -4.9, -10.600000000000001, -21.10000000000001, -3.3, -14.199999999999987, -3.900000000000001, -10.89999999999999, -3.2, -12.2, -38.3, -6.300000000000001, -33.9, -15.300000000000013, -27.4, -10.999999999999996, -19.5, -6.3, -3.5, -9.3, -5.300000000000001, -5.4, -6.4, -19.799999999999997, -6.4, -6.3, -14.899999999999999, -3.4, -17.9, -16.7, -21.6, -14.099999999999996, -5.300000000000001, -6.2, -4.3, -7.300000000000001, -11.399999999999999, -29.20000000000001, -5.2, -5.2, -20.3, -7.3, -5.3, -29.000000000000007, -21.100000000000005, -22.300000000000004, -16.7, -9.699999999999996, -41.400000000000055, -37.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9268246657834317, "mean_inference_ms": 1.1797402863352076, "mean_action_processing_ms": 0.06492569554709232, "mean_env_wait_ms": 5.388020377093181, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"sample_time_ms": 15335.091, "sample_throughput": 260.84, "load_time_ms": 0.358, "load_throughput": 11173637.03, "learn_time_ms": 7285.977, "learn_throughput": 549.0, "update_time_ms": 1.58}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.22585408856431322, "policy_loss": -0.01124307423409435, "vf_loss": 23.683113110514096, "vf_explained_var": 0.09687128675881253, "kl": 0.009459078457308924, "entropy": 0.26188452295878883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 500000, "num_steps_trained": 500000, "num_agent_steps_trained": 500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5000, "training_iteration": 125, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-12-46", "timestamp": 1643667166, "time_this_iter_s": 15.354941368103027, "time_total_s": 1842.10808467865, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1842.10808467865, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 28.609090909090913, "ram_util_percent": 72.85909090909091}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.4, "episode_reward_mean": -14.612, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.399999999999999, -8.2, -14.5, -9.7, -6.2, -20.699999999999996, -4.3, -15.5, -8.3, -15.899999999999999, -17.900000000000002, -4.9, -10.600000000000001, -21.10000000000001, -3.3, -14.199999999999987, -3.900000000000001, -10.89999999999999, -3.2, -12.2, -38.3, -6.300000000000001, -33.9, -15.300000000000013, -27.4, -10.999999999999996, -19.5, -6.3, -3.5, -9.3, -5.300000000000001, -5.4, -6.4, -19.799999999999997, -6.4, -6.3, -14.899999999999999, -3.4, -17.9, -16.7, -21.6, -14.099999999999996, -5.300000000000001, -6.2, -4.3, -7.300000000000001, -11.399999999999999, -29.20000000000001, -5.2, -5.2, -20.3, -7.3, -5.3, -29.000000000000007, -21.100000000000005, -22.300000000000004, -16.7, -9.699999999999996, -41.400000000000055, -37.7, -13.799999999999995, -18.600000000000005, -19.799999999999997, -18.799999999999997, -8.3, -5.6000000000000005, -4.300000000000001, -4.4, -79.4, -48.69999999999996, -18.699999999999996, -3.4, -5.300000000000001, -20.3, -74.4, -9.0, -8.3, -18.5, -27.800000000000004, -24.699999999999996, -11.399999999999997, -16.799999999999997, -4.3, -13.499999999999991, -16.4, -19.300000000000004, -16.5, -11.3, -10.499999999999991, -4.2, -5.300000000000001, -14.399999999999997, -6.300000000000001, -5.300000000000001, -19.9, -4.2, -13.4, -16.799999999999997, -5.2, -7.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.926863424090152, "mean_inference_ms": 1.1799041896942122, "mean_action_processing_ms": 0.06495705644505877, "mean_env_wait_ms": 5.38910336091696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 504000, "timesteps_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"sample_time_ms": 15300.802, "sample_throughput": 261.424, "load_time_ms": 0.367, "load_throughput": 10885813.652, "learn_time_ms": 7283.677, "learn_throughput": 549.173, "update_time_ms": 1.601}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.679339668481806, "policy_loss": -0.012611741580629861, "vf_loss": 69.14240880320149, "vf_explained_var": 0.02979671173198249, "kl": 0.01874965565345211, "entropy": 0.2193444950405949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 504000, "num_agent_steps_sampled": 504000, "num_steps_trained": 504000, "num_agent_steps_trained": 504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5040, "training_iteration": 126, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-13-02", "timestamp": 1643667182, "time_this_iter_s": 15.25923466682434, "time_total_s": 1857.3673193454742, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1857.3673193454742, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 27.972727272727273, "ram_util_percent": 72.82272727272725}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.4, "episode_reward_mean": -15.030999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.6, -14.099999999999996, -5.300000000000001, -6.2, -4.3, -7.300000000000001, -11.399999999999999, -29.20000000000001, -5.2, -5.2, -20.3, -7.3, -5.3, -29.000000000000007, -21.100000000000005, -22.300000000000004, -16.7, -9.699999999999996, -41.400000000000055, -37.7, -13.799999999999995, -18.600000000000005, -19.799999999999997, -18.799999999999997, -8.3, -5.6000000000000005, -4.300000000000001, -4.4, -79.4, -48.69999999999996, -18.699999999999996, -3.4, -5.300000000000001, -20.3, -74.4, -9.0, -8.3, -18.5, -27.800000000000004, -24.699999999999996, -11.399999999999997, -16.799999999999997, -4.3, -13.499999999999991, -16.4, -19.300000000000004, -16.5, -11.3, -10.499999999999991, -4.2, -5.300000000000001, -14.399999999999997, -6.300000000000001, -5.300000000000001, -19.9, -4.2, -13.4, -16.799999999999997, -5.2, -7.300000000000001, -32.39999999999995, -21.099999999999998, -8.2, -15.2, -17.7, -20.0, -5.4, -9.2, -10.299999999999995, -16.7, -21.2, -17.9, -13.3, -4.300000000000001, -7.499999999999999, -7.799999999999998, -6.2, -11.899999999999999, -8.2, -20.6, -30.699999999999996, -15.600000000000001, -21.4, -14.499999999999998, -11.199999999999998, -26.6, -18.5, -7.7, -17.0, -4.4, -4.3, -9.3, -15.5, -4.2, -5.999999999999999, -4.3, -17.799999999999997, -5.3, -3.2, -15.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9270730464109966, "mean_inference_ms": 1.179960374266794, "mean_action_processing_ms": 0.06496850909917085, "mean_env_wait_ms": 5.389651500466433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 508000, "timesteps_this_iter": 0, "agent_timesteps_total": 508000, "timers": {"sample_time_ms": 15257.782, "sample_throughput": 262.161, "load_time_ms": 0.367, "load_throughput": 10906335.565, "learn_time_ms": 7279.863, "learn_throughput": 549.461, "update_time_ms": 1.597}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.1544792923455437, "policy_loss": 0.0026389985986214172, "vf_loss": 15.162194446722667, "vf_explained_var": 0.20871013441393452, "kl": 0.007763579814783618, "entropy": 0.23297173111669478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 508000, "num_agent_steps_sampled": 508000, "num_steps_trained": 508000, "num_agent_steps_trained": 508000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5080, "training_iteration": 127, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-13-17", "timestamp": 1643667197, "time_this_iter_s": 14.892290115356445, "time_total_s": 1872.2596094608307, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1872.2596094608307, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 72.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.4, "episode_reward_mean": -12.717, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.399999999999997, -16.799999999999997, -4.3, -13.499999999999991, -16.4, -19.300000000000004, -16.5, -11.3, -10.499999999999991, -4.2, -5.300000000000001, -14.399999999999997, -6.300000000000001, -5.300000000000001, -19.9, -4.2, -13.4, -16.799999999999997, -5.2, -7.300000000000001, -32.39999999999995, -21.099999999999998, -8.2, -15.2, -17.7, -20.0, -5.4, -9.2, -10.299999999999995, -16.7, -21.2, -17.9, -13.3, -4.300000000000001, -7.499999999999999, -7.799999999999998, -6.2, -11.899999999999999, -8.2, -20.6, -30.699999999999996, -15.600000000000001, -21.4, -14.499999999999998, -11.199999999999998, -26.6, -18.5, -7.7, -17.0, -4.4, -4.3, -9.3, -15.5, -4.2, -5.999999999999999, -4.3, -17.799999999999997, -5.3, -3.2, -15.499999999999998, -21.400000000000002, -13.600000000000001, -22.2, -7.499999999999999, -13.5, -11.7, -4.4, -13.699999999999998, -9.799999999999999, -16.5, -5.2, -18.5, -90.4, -5.300000000000001, -5.4, -12.6, -3.4, -13.5, -3.3, -10.399999999999999, -15.6, -5.300000000000001, -4.4, -17.400000000000002, -9.899999999999999, -12.399999999999999, -10.6, -23.400000000000027, -5.4, -8.5, -22.6, -13.299999999999997, -5.2, -12.7, -5.4, -13.099999999999998, -5.300000000000001, -7.3, -3.4, -17.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9272906331984143, "mean_inference_ms": 1.1800505332726337, "mean_action_processing_ms": 0.0650001114409697, "mean_env_wait_ms": 5.39044596586746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 512000, "timesteps_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"sample_time_ms": 15264.401, "sample_throughput": 262.048, "load_time_ms": 0.358, "load_throughput": 11186302.174, "learn_time_ms": 7234.348, "learn_throughput": 552.918, "update_time_ms": 1.589}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.45839900866636546, "policy_loss": -0.0006527572736314308, "vf_loss": 45.887709656838446, "vf_explained_var": 0.27478824988488226, "kl": 0.006210748659555579, "entropy": 0.22038797674480304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 512000, "num_agent_steps_sampled": 512000, "num_steps_trained": 512000, "num_agent_steps_trained": 512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5120, "training_iteration": 128, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-13-32", "timestamp": 1643667212, "time_this_iter_s": 14.957309007644653, "time_total_s": 1887.2169184684753, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1887.2169184684753, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 24.3952380952381, "ram_util_percent": 72.74285714285715}}
{"episode_reward_max": -2.5, "episode_reward_min": -90.4, "episode_reward_mean": -13.734000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.699999999999996, -15.600000000000001, -21.4, -14.499999999999998, -11.199999999999998, -26.6, -18.5, -7.7, -17.0, -4.4, -4.3, -9.3, -15.5, -4.2, -5.999999999999999, -4.3, -17.799999999999997, -5.3, -3.2, -15.499999999999998, -21.400000000000002, -13.600000000000001, -22.2, -7.499999999999999, -13.5, -11.7, -4.4, -13.699999999999998, -9.799999999999999, -16.5, -5.2, -18.5, -90.4, -5.300000000000001, -5.4, -12.6, -3.4, -13.5, -3.3, -10.399999999999999, -15.6, -5.300000000000001, -4.4, -17.400000000000002, -9.899999999999999, -12.399999999999999, -10.6, -23.400000000000027, -5.4, -8.5, -22.6, -13.299999999999997, -5.2, -12.7, -5.4, -13.099999999999998, -5.300000000000001, -7.3, -3.4, -17.799999999999997, -6.300000000000001, -90.4, -5.4, -19.299999999999997, -26.500000000000004, -6.300000000000001, -24.10000000000006, -2.5, -9.3, -21.5, -16.299999999999997, -6.300000000000001, -16.19999999999997, -10.7, -9.3, -23.599999999999998, -21.5, -15.8, -5.3, -21.800000000000004, -7.5, -6.2, -9.5, -19.599999999999998, -51.3, -5.3, -21.6, -24.10000000000001, -7.300000000000001, -8.3, -5.300000000000001, -5.300000000000001, -18.400000000000002, -7.300000000000001, -6.4, -12.299999999999999, -9.2, -7.300000000000001, -4.2, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9273558651228029, "mean_inference_ms": 1.1801584755530394, "mean_action_processing_ms": 0.06502887520656113, "mean_env_wait_ms": 5.391637633117131, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 516000, "timesteps_this_iter": 0, "agent_timesteps_total": 516000, "timers": {"sample_time_ms": 15215.95, "sample_throughput": 262.882, "load_time_ms": 0.357, "load_throughput": 11198996.062, "learn_time_ms": 7219.293, "learn_throughput": 554.071, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.5290106882073325, "policy_loss": -0.0014243372155213227, "vf_loss": 53.02666697399591, "vf_explained_var": 0.10548292699680534, "kl": 0.005986678572073793, "entropy": 0.24066996225506387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 516000, "num_agent_steps_sampled": 516000, "num_steps_trained": 516000, "num_agent_steps_trained": 516000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5160, "training_iteration": 129, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-13-46", "timestamp": 1643667226, "time_this_iter_s": 14.926022052764893, "time_total_s": 1902.1429405212402, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1902.1429405212402, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 28.014285714285716, "ram_util_percent": 72.74761904761905}}
{"episode_reward_max": -2.5, "episode_reward_min": -90.4, "episode_reward_mean": -13.015000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.6, -5.300000000000001, -4.4, -17.400000000000002, -9.899999999999999, -12.399999999999999, -10.6, -23.400000000000027, -5.4, -8.5, -22.6, -13.299999999999997, -5.2, -12.7, -5.4, -13.099999999999998, -5.300000000000001, -7.3, -3.4, -17.799999999999997, -6.300000000000001, -90.4, -5.4, -19.299999999999997, -26.500000000000004, -6.300000000000001, -24.10000000000006, -2.5, -9.3, -21.5, -16.299999999999997, -6.300000000000001, -16.19999999999997, -10.7, -9.3, -23.599999999999998, -21.5, -15.8, -5.3, -21.800000000000004, -7.5, -6.2, -9.5, -19.599999999999998, -51.3, -5.3, -21.6, -24.10000000000001, -7.300000000000001, -8.3, -5.300000000000001, -5.300000000000001, -18.400000000000002, -7.300000000000001, -6.4, -12.299999999999999, -9.2, -7.300000000000001, -4.2, -4.300000000000001, -9.3, -10.3, -3.8000000000000003, -17.9, -12.5, -6.4, -9.1, -11.099999999999996, -4.7, -7.699999999999999, -15.6, -17.4, -23.100000000000026, -13.199999999999996, -11.3, -17.800000000000004, -7.499999999999999, -5.300000000000001, -13.5, -13.69999999999999, -7.1999999999999975, -18.5, -11.700000000000001, -12.799999999999997, -19.1, -13.699999999999994, -9.499999999999998, -9.3, -22.500000000000007, -18.800000000000008, -8.999999999999996, -5.2, -12.2, -12.699999999999998, -16.9, -7.499999999999999, -8.4, -12.999999999999998, -14.399999999999997, -9.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9274944423817978, "mean_inference_ms": 1.180185493230659, "mean_action_processing_ms": 0.0650311518784471, "mean_env_wait_ms": 5.3923677418582905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"sample_time_ms": 15195.682, "sample_throughput": 263.233, "load_time_ms": 0.362, "load_throughput": 11038368.314, "learn_time_ms": 7195.824, "learn_throughput": 555.878, "update_time_ms": 1.579}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.0911028982370451, "policy_loss": -0.0001464587085509813, "vf_loss": 9.102151392031741, "vf_explained_var": 0.2764903546020549, "kl": 0.00810118387603954, "entropy": 0.2505696810221159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 520000, "num_steps_trained": 520000, "num_agent_steps_trained": 520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5200, "training_iteration": 130, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-14-01", "timestamp": 1643667241, "time_this_iter_s": 14.959153890609741, "time_total_s": 1917.10209441185, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1917.10209441185, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 27.785714285714285, "ram_util_percent": 72.75238095238095}}
{"episode_reward_max": -1.2, "episode_reward_min": -82.90000000000006, "episode_reward_mean": -13.519, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.5, -6.2, -9.5, -19.599999999999998, -51.3, -5.3, -21.6, -24.10000000000001, -7.300000000000001, -8.3, -5.300000000000001, -5.300000000000001, -18.400000000000002, -7.300000000000001, -6.4, -12.299999999999999, -9.2, -7.300000000000001, -4.2, -4.300000000000001, -9.3, -10.3, -3.8000000000000003, -17.9, -12.5, -6.4, -9.1, -11.099999999999996, -4.7, -7.699999999999999, -15.6, -17.4, -23.100000000000026, -13.199999999999996, -11.3, -17.800000000000004, -7.499999999999999, -5.300000000000001, -13.5, -13.69999999999999, -7.1999999999999975, -18.5, -11.700000000000001, -12.799999999999997, -19.1, -13.699999999999994, -9.499999999999998, -9.3, -22.500000000000007, -18.800000000000008, -8.999999999999996, -5.2, -12.2, -12.699999999999998, -16.9, -7.499999999999999, -8.4, -12.999999999999998, -14.399999999999997, -9.8, -26.90000000000004, -7.300000000000001, -18.1, -15.099999999999998, -4.300000000000001, -7.199999999999999, -14.599999999999998, -4.300000000000001, -82.00000000000004, -6.300000000000001, -8.2, -10.3, -17.4, -1.2, -8.3, -19.800000000000008, -5.4, -14.799999999999999, -12.3, -6.4, -20.2, -19.399999999999995, -25.2, -6.899999999999999, -25.500000000000004, -6.4, -5.300000000000001, -10.2, -12.799999999999997, -13.099999999999996, -26.400000000000002, -14.3, -11.3, -82.90000000000006, -12.3, -11.699999999999998, -4.0, -7.300000000000001, -14.099999999999998, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9279091495562849, "mean_inference_ms": 1.180226919675095, "mean_action_processing_ms": 0.06503213094298804, "mean_env_wait_ms": 5.392542514667766, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 524000, "timesteps_this_iter": 0, "agent_timesteps_total": 524000, "timers": {"sample_time_ms": 15193.169, "sample_throughput": 263.276, "load_time_ms": 0.364, "load_throughput": 10990642.647, "learn_time_ms": 7155.531, "learn_throughput": 559.008, "update_time_ms": 1.614}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.5643338853102778, "policy_loss": -0.006841331777433234, "vf_loss": 57.087517776925075, "vf_explained_var": 0.07245865432165002, "kl": 0.010668271530407699, "entropy": 0.2603998003747835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 524000, "num_agent_steps_sampled": 524000, "num_steps_trained": 524000, "num_agent_steps_trained": 524000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5240, "training_iteration": 131, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-14-17", "timestamp": 1643667257, "time_this_iter_s": 15.092453002929688, "time_total_s": 1932.1945474147797, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1932.1945474147797, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 28.11818181818182, "ram_util_percent": 72.8409090909091}}
{"episode_reward_max": -1.2, "episode_reward_min": -91.3, "episode_reward_mean": -14.171, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.1999999999999975, -18.5, -11.700000000000001, -12.799999999999997, -19.1, -13.699999999999994, -9.499999999999998, -9.3, -22.500000000000007, -18.800000000000008, -8.999999999999996, -5.2, -12.2, -12.699999999999998, -16.9, -7.499999999999999, -8.4, -12.999999999999998, -14.399999999999997, -9.8, -26.90000000000004, -7.300000000000001, -18.1, -15.099999999999998, -4.300000000000001, -7.199999999999999, -14.599999999999998, -4.300000000000001, -82.00000000000004, -6.300000000000001, -8.2, -10.3, -17.4, -1.2, -8.3, -19.800000000000008, -5.4, -14.799999999999999, -12.3, -6.4, -20.2, -19.399999999999995, -25.2, -6.899999999999999, -25.500000000000004, -6.4, -5.300000000000001, -10.2, -12.799999999999997, -13.099999999999996, -26.400000000000002, -14.3, -11.3, -82.90000000000006, -12.3, -11.699999999999998, -4.0, -7.300000000000001, -14.099999999999998, -8.3, -14.2, -5.4, -15.999999999999993, -16.2, -13.000000000000002, -11.499999999999998, -12.1, -8.3, -19.899999999999995, -4.2, -14.3, -11.700000000000001, -22.0, -12.299999999999999, -14.299999999999995, -7.300000000000001, -6.2, -18.2, -14.699999999999998, -9.899999999999997, -4.300000000000001, -6.4, -22.800000000000004, -10.3, -91.3, -12.8, -6.300000000000001, -9.3, -6.300000000000001, -6.300000000000001, -7.2, -10.2, -10.200000000000001, -4.800000000000001, -5.2, -12.2, -4.300000000000001, -14.799999999999997, -11.6, -28.799999999999972], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.928052032157519, "mean_inference_ms": 1.1801966377655326, "mean_action_processing_ms": 0.06502935728224268, "mean_env_wait_ms": 5.392433789403271, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 528000, "timesteps_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"sample_time_ms": 15154.391, "sample_throughput": 263.95, "load_time_ms": 0.368, "load_throughput": 10877344.398, "learn_time_ms": 7099.877, "learn_throughput": 563.39, "update_time_ms": 1.612}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.43457302843591056, "policy_loss": -0.005390043464559381, "vf_loss": 43.975297587276785, "vf_explained_var": 0.16798501386437364, "kl": 0.007470477529158142, "entropy": 0.24821353044400932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 528000, "num_agent_steps_sampled": 528000, "num_steps_trained": 528000, "num_agent_steps_trained": 528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5280, "training_iteration": 132, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-14-31", "timestamp": 1643667271, "time_this_iter_s": 14.701841831207275, "time_total_s": 1946.896389245987, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1946.896389245987, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 26.519047619047623, "ram_util_percent": 72.90000000000002}}
{"episode_reward_max": -4.0, "episode_reward_min": -93.1, "episode_reward_mean": -14.556000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.2, -19.399999999999995, -25.2, -6.899999999999999, -25.500000000000004, -6.4, -5.300000000000001, -10.2, -12.799999999999997, -13.099999999999996, -26.400000000000002, -14.3, -11.3, -82.90000000000006, -12.3, -11.699999999999998, -4.0, -7.300000000000001, -14.099999999999998, -8.3, -14.2, -5.4, -15.999999999999993, -16.2, -13.000000000000002, -11.499999999999998, -12.1, -8.3, -19.899999999999995, -4.2, -14.3, -11.700000000000001, -22.0, -12.299999999999999, -14.299999999999995, -7.300000000000001, -6.2, -18.2, -14.699999999999998, -9.899999999999997, -4.300000000000001, -6.4, -22.800000000000004, -10.3, -91.3, -12.8, -6.300000000000001, -9.3, -6.300000000000001, -6.300000000000001, -7.2, -10.2, -10.200000000000001, -4.800000000000001, -5.2, -12.2, -4.300000000000001, -14.799999999999997, -11.6, -28.799999999999972, -21.3, -13.199999999999998, -16.0, -8.3, -20.9, -11.9, -5.2, -15.600000000000001, -14.799999999999999, -6.5, -15.3, -9.999999999999995, -17.6, -7.300000000000001, -26.100000000000012, -4.6000000000000005, -9.8, -17.500000000000004, -10.1, -93.1, -9.3, -29.2, -8.2, -11.9, -11.2, -4.2, -8.3, -18.899999999999995, -7.300000000000001, -6.4, -4.300000000000001, -6.300000000000001, -16.2, -4.800000000000001, -18.0, -13.8, -35.3, -6.2, -7.3000000000000025, -8.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9283475573982468, "mean_inference_ms": 1.1806456149934947, "mean_action_processing_ms": 0.06505025804294856, "mean_env_wait_ms": 5.394710492230063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 532000, "timesteps_this_iter": 0, "agent_timesteps_total": 532000, "timers": {"sample_time_ms": 15206.838, "sample_throughput": 263.04, "load_time_ms": 0.37, "load_throughput": 10815636.926, "learn_time_ms": 7102.952, "learn_throughput": 563.146, "update_time_ms": 1.601}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.45148757852924365, "policy_loss": -0.002603141767703878, "vf_loss": 45.39111852722783, "vf_explained_var": 0.23034410989412699, "kl": 0.006383677299442628, "entropy": 0.2663427097422461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 532000, "num_agent_steps_sampled": 532000, "num_steps_trained": 532000, "num_agent_steps_trained": 532000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5320, "training_iteration": 133, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-14-48", "timestamp": 1643667288, "time_this_iter_s": 16.42943501472473, "time_total_s": 1963.3258242607117, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1963.3258242607117, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 31.208695652173912, "ram_util_percent": 73.00434782608694}}
{"episode_reward_max": -4.2, "episode_reward_min": -93.1, "episode_reward_mean": -14.306, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -6.4, -22.800000000000004, -10.3, -91.3, -12.8, -6.300000000000001, -9.3, -6.300000000000001, -6.300000000000001, -7.2, -10.2, -10.200000000000001, -4.800000000000001, -5.2, -12.2, -4.300000000000001, -14.799999999999997, -11.6, -28.799999999999972, -21.3, -13.199999999999998, -16.0, -8.3, -20.9, -11.9, -5.2, -15.600000000000001, -14.799999999999999, -6.5, -15.3, -9.999999999999995, -17.6, -7.300000000000001, -26.100000000000012, -4.6000000000000005, -9.8, -17.500000000000004, -10.1, -93.1, -9.3, -29.2, -8.2, -11.9, -11.2, -4.2, -8.3, -18.899999999999995, -7.300000000000001, -6.4, -4.300000000000001, -6.300000000000001, -16.2, -4.800000000000001, -18.0, -13.8, -35.3, -6.2, -7.3000000000000025, -8.700000000000001, -8.999999999999998, -10.2, -8.2, -14.600000000000001, -12.600000000000001, -20.099999999999987, -17.800000000000004, -5.000000000000001, -15.399999999999997, -8.3, -21.799999999999997, -15.499999999999998, -29.700000000000006, -12.399999999999999, -21.5, -20.599999999999998, -33.600000000000016, -8.2, -15.099999999999998, -11.6, -5.699999999999999, -19.3, -14.799999999999997, -4.4, -19.1, -22.199999999999996, -8.3, -20.5, -6.4, -7.2, -8.3, -7.300000000000001, -17.69999999999999, -15.799999999999997, -15.899999999999999, -7.299999999999999, -11.3, -19.599999999999994, -13.399999999999999, -8.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9285357094054788, "mean_inference_ms": 1.181089596199189, "mean_action_processing_ms": 0.06507361696180715, "mean_env_wait_ms": 5.397129780585857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 536000, "timesteps_this_iter": 0, "agent_timesteps_total": 536000, "timers": {"sample_time_ms": 15224.42, "sample_throughput": 262.736, "load_time_ms": 0.369, "load_throughput": 10828201.885, "learn_time_ms": 7135.946, "learn_throughput": 560.542, "update_time_ms": 1.591}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.1391766637263279, "policy_loss": 0.0049842892274741205, "vf_loss": 13.39385110152665, "vf_explained_var": 0.2434150546468714, "kl": 0.009026382106210222, "entropy": 0.2267780323182383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 536000, "num_agent_steps_sampled": 536000, "num_steps_trained": 536000, "num_agent_steps_trained": 536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5360, "training_iteration": 134, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-15-04", "timestamp": 1643667304, "time_this_iter_s": 15.727932929992676, "time_total_s": 1979.0537571907043, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1979.0537571907043, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 30.636363636363637, "ram_util_percent": 73.04545454545453}}
{"episode_reward_max": -4.2, "episode_reward_min": -81.10000000000011, "episode_reward_mean": -13.418, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -29.2, -8.2, -11.9, -11.2, -4.2, -8.3, -18.899999999999995, -7.300000000000001, -6.4, -4.300000000000001, -6.300000000000001, -16.2, -4.800000000000001, -18.0, -13.8, -35.3, -6.2, -7.3000000000000025, -8.700000000000001, -8.999999999999998, -10.2, -8.2, -14.600000000000001, -12.600000000000001, -20.099999999999987, -17.800000000000004, -5.000000000000001, -15.399999999999997, -8.3, -21.799999999999997, -15.499999999999998, -29.700000000000006, -12.399999999999999, -21.5, -20.599999999999998, -33.600000000000016, -8.2, -15.099999999999998, -11.6, -5.699999999999999, -19.3, -14.799999999999997, -4.4, -19.1, -22.199999999999996, -8.3, -20.5, -6.4, -7.2, -8.3, -7.300000000000001, -17.69999999999999, -15.799999999999997, -15.899999999999999, -7.299999999999999, -11.3, -19.599999999999994, -13.399999999999999, -8.599999999999998, -7.999999999999999, -5.699999999999999, -20.6, -8.4, -8.3, -23.50000000000001, -15.600000000000001, -10.6, -9.999999999999996, -12.999999999999998, -16.199999999999996, -10.2, -5.000000000000001, -11.2, -10.2, -4.4, -27.2, -9.2, -7.199999999999999, -5.300000000000001, -15.6, -6.2, -12.200000000000001, -5.5, -7.2, -6.300000000000001, -10.3, -6.4, -19.299999999999997, -81.10000000000011, -21.800000000000004, -17.699999999999996, -9.3, -6.300000000000001, -5.300000000000001, -23.000000000000025, -17.099999999999998, -13.299999999999999, -5.300000000000001, -22.70000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9289679434127041, "mean_inference_ms": 1.1818774418122557, "mean_action_processing_ms": 0.06511768042091653, "mean_env_wait_ms": 5.4008313114295765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 15346.989, "sample_throughput": 260.637, "load_time_ms": 0.373, "load_throughput": 10723691.914, "learn_time_ms": 7215.874, "learn_throughput": 554.333, "update_time_ms": 1.6}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.30857289902745716, "policy_loss": -0.0053283417046630895, "vf_loss": 31.36998109189413, "vf_explained_var": 0.1296972975295077, "kl": 0.007161986596922219, "entropy": 0.22299731283258367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5400, "training_iteration": 135, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-15-21", "timestamp": 1643667321, "time_this_iter_s": 17.05220317840576, "time_total_s": 1996.10596036911, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1996.10596036911, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 34.76, "ram_util_percent": 73.23599999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -81.10000000000011, "episode_reward_mean": -12.523, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.699999999999999, -19.3, -14.799999999999997, -4.4, -19.1, -22.199999999999996, -8.3, -20.5, -6.4, -7.2, -8.3, -7.300000000000001, -17.69999999999999, -15.799999999999997, -15.899999999999999, -7.299999999999999, -11.3, -19.599999999999994, -13.399999999999999, -8.599999999999998, -7.999999999999999, -5.699999999999999, -20.6, -8.4, -8.3, -23.50000000000001, -15.600000000000001, -10.6, -9.999999999999996, -12.999999999999998, -16.199999999999996, -10.2, -5.000000000000001, -11.2, -10.2, -4.4, -27.2, -9.2, -7.199999999999999, -5.300000000000001, -15.6, -6.2, -12.200000000000001, -5.5, -7.2, -6.300000000000001, -10.3, -6.4, -19.299999999999997, -81.10000000000011, -21.800000000000004, -17.699999999999996, -9.3, -6.300000000000001, -5.300000000000001, -23.000000000000025, -17.099999999999998, -13.299999999999999, -5.300000000000001, -22.70000000000001, -3.7000000000000006, -4.4, -4.300000000000001, -9.099999999999998, -15.999999999999998, -16.5, -20.200000000000042, -13.0, -16.8, -13.3, -11.199999999999996, -14.600000000000001, -9.799999999999997, -3.2, -7.800000000000001, -6.2, -14.299999999999999, -10.599999999999998, -15.599999999999973, -7.800000000000001, -5.699999999999999, -12.399999999999997, -13.399999999999999, -5.2, -12.3, -10.399999999999997, -6.2, -16.1, -8.2, -10.600000000000001, -43.3, -14.2, -9.100000000000001, -7.2, -12.499999999999998, -13.19999999999998, -7.2, -8.3, -18.299999999999997, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9299137878463776, "mean_inference_ms": 1.183520905541753, "mean_action_processing_ms": 0.06520397733265709, "mean_env_wait_ms": 5.408562436456687, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 544000, "timesteps_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"sample_time_ms": 15672.8, "sample_throughput": 255.219, "load_time_ms": 0.367, "load_throughput": 10912720.177, "learn_time_ms": 7191.38, "learn_throughput": 556.221, "update_time_ms": 1.593}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.10734135265842641, "policy_loss": -0.014892594492243182, "vf_loss": 12.194198161491784, "vf_explained_var": 0.2958221088173569, "kl": 0.01038114720438893, "entropy": 0.23387234493769626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 544000, "num_agent_steps_sampled": 544000, "num_steps_trained": 544000, "num_agent_steps_trained": 544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5440, "training_iteration": 136, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-15-38", "timestamp": 1643667338, "time_this_iter_s": 17.4826238155365, "time_total_s": 2013.5885841846466, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2013.5885841846466, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 33.848, "ram_util_percent": 73.784}}
{"episode_reward_max": -3.2, "episode_reward_min": -81.10000000000011, "episode_reward_mean": -13.320000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.6, -6.2, -12.200000000000001, -5.5, -7.2, -6.300000000000001, -10.3, -6.4, -19.299999999999997, -81.10000000000011, -21.800000000000004, -17.699999999999996, -9.3, -6.300000000000001, -5.300000000000001, -23.000000000000025, -17.099999999999998, -13.299999999999999, -5.300000000000001, -22.70000000000001, -3.7000000000000006, -4.4, -4.300000000000001, -9.099999999999998, -15.999999999999998, -16.5, -20.200000000000042, -13.0, -16.8, -13.3, -11.199999999999996, -14.600000000000001, -9.799999999999997, -3.2, -7.800000000000001, -6.2, -14.299999999999999, -10.599999999999998, -15.599999999999973, -7.800000000000001, -5.699999999999999, -12.399999999999997, -13.399999999999999, -5.2, -12.3, -10.399999999999997, -6.2, -16.1, -8.2, -10.600000000000001, -43.3, -14.2, -9.100000000000001, -7.2, -12.499999999999998, -13.19999999999998, -7.2, -8.3, -18.299999999999997, -5.300000000000001, -12.899999999999999, -8.2, -22.9, -17.0, -11.399999999999999, -3.3, -16.899999999999988, -11.2, -17.999999999999993, -9.7, -12.2, -17.2, -14.3, -12.0, -22.8, -10.899999999999997, -8.2, -6.599999999999999, -4.300000000000001, -14.999999999999998, -8.2, -19.599999999999994, -10.499999999999998, -9.8, -7.5, -5.3, -12.7, -25.600000000000005, -12.899999999999999, -15.999999999999996, -16.9, -27.2, -10.899999999999995, -9.8, -10.9, -5.4, -57.2, -9.3, -21.200000000000017, -10.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9309207281531738, "mean_inference_ms": 1.184983638002002, "mean_action_processing_ms": 0.06528023869575207, "mean_env_wait_ms": 5.415394752043547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 548000, "timesteps_this_iter": 0, "agent_timesteps_total": 548000, "timers": {"sample_time_ms": 15663.65, "sample_throughput": 255.368, "load_time_ms": 0.383, "load_throughput": 10450489.598, "learn_time_ms": 7210.706, "learn_throughput": 554.731, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.19253921275858277, "policy_loss": -0.0036891319598722203, "vf_loss": 19.600618619047186, "vf_explained_var": 0.27328234449509653, "kl": 0.007899105159554417, "entropy": 0.21424061184929263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 548000, "num_agent_steps_sampled": 548000, "num_steps_trained": 548000, "num_agent_steps_trained": 548000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5480, "training_iteration": 137, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-15-53", "timestamp": 1643667353, "time_this_iter_s": 15.261717081069946, "time_total_s": 2028.8503012657166, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2028.8503012657166, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 24.223809523809525, "ram_util_percent": 73.90476190476193}}
{"episode_reward_max": -3.2, "episode_reward_min": -57.2, "episode_reward_mean": -11.944, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.699999999999999, -12.399999999999997, -13.399999999999999, -5.2, -12.3, -10.399999999999997, -6.2, -16.1, -8.2, -10.600000000000001, -43.3, -14.2, -9.100000000000001, -7.2, -12.499999999999998, -13.19999999999998, -7.2, -8.3, -18.299999999999997, -5.300000000000001, -12.899999999999999, -8.2, -22.9, -17.0, -11.399999999999999, -3.3, -16.899999999999988, -11.2, -17.999999999999993, -9.7, -12.2, -17.2, -14.3, -12.0, -22.8, -10.899999999999997, -8.2, -6.599999999999999, -4.300000000000001, -14.999999999999998, -8.2, -19.599999999999994, -10.499999999999998, -9.8, -7.5, -5.3, -12.7, -25.600000000000005, -12.899999999999999, -15.999999999999996, -16.9, -27.2, -10.899999999999995, -9.8, -10.9, -5.4, -57.2, -9.3, -21.200000000000017, -10.7, -9.2, -15.599999999999998, -15.7, -19.1, -5.0, -14.799999999999995, -10.999999999999988, -4.300000000000001, -9.2, -7.299999999999999, -10.399999999999999, -5.9, -5.300000000000001, -3.2, -10.099999999999998, -3.2, -9.3, -12.799999999999997, -9.2, -5.300000000000001, -21.700000000000003, -22.3, -6.999999999999999, -4.2, -5.4, -4.3, -6.2, -12.3, -4.4, -28.500000000000007, -13.099999999999996, -12.0, -12.2, -5.2, -12.4, -7.2, -6.2, -5.3, -6.2, -10.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9312850132644276, "mean_inference_ms": 1.185646948209763, "mean_action_processing_ms": 0.0653082855659783, "mean_env_wait_ms": 5.41816939727541, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 552000, "timesteps_this_iter": 0, "agent_timesteps_total": 552000, "timers": {"sample_time_ms": 15662.921, "sample_throughput": 255.38, "load_time_ms": 0.383, "load_throughput": 10445284.522, "learn_time_ms": 7229.696, "learn_throughput": 553.274, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.09109379389393393, "policy_loss": 0.0016279395970125352, "vf_loss": 8.927034709626628, "vf_explained_var": 0.20758720142866977, "kl": 0.0069515201803484646, "entropy": 0.18697735564683074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 552000, "num_agent_steps_sampled": 552000, "num_steps_trained": 552000, "num_agent_steps_trained": 552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5520, "training_iteration": 138, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-16-08", "timestamp": 1643667368, "time_this_iter_s": 14.934045314788818, "time_total_s": 2043.7843465805054, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2043.7843465805054, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 26.80454545454545, "ram_util_percent": 73.90000000000003}}
{"episode_reward_max": -1.2, "episode_reward_min": -57.2, "episode_reward_mean": -11.100999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -19.599999999999994, -10.499999999999998, -9.8, -7.5, -5.3, -12.7, -25.600000000000005, -12.899999999999999, -15.999999999999996, -16.9, -27.2, -10.899999999999995, -9.8, -10.9, -5.4, -57.2, -9.3, -21.200000000000017, -10.7, -9.2, -15.599999999999998, -15.7, -19.1, -5.0, -14.799999999999995, -10.999999999999988, -4.300000000000001, -9.2, -7.299999999999999, -10.399999999999999, -5.9, -5.300000000000001, -3.2, -10.099999999999998, -3.2, -9.3, -12.799999999999997, -9.2, -5.300000000000001, -21.700000000000003, -22.3, -6.999999999999999, -4.2, -5.4, -4.3, -6.2, -12.3, -4.4, -28.500000000000007, -13.099999999999996, -12.0, -12.2, -5.2, -12.4, -7.2, -6.2, -5.3, -6.2, -10.7, -10.4, -8.2, -11.899999999999999, -18.400000000000002, -18.2, -8.2, -12.7, -9.799999999999999, -18.000000000000004, -15.699999999999998, -13.799999999999999, -14.3, -9.2, -14.1, -12.399999999999999, -11.3, -11.399999999999999, -13.19999999999999, -4.4, -21.300000000000008, -1.2, -4.2, -4.700000000000001, -7.3, -8.2, -10.2, -13.7, -5.0, -10.799999999999999, -7.2, -10.5, -6.3, -5.300000000000001, -6.1, -11.6, -7.2, -7.699999999999999, -4.7, -9.499999999999998, -11.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9314536553751893, "mean_inference_ms": 1.1856432694574623, "mean_action_processing_ms": 0.06530670040543825, "mean_env_wait_ms": 5.418024144112095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 556000, "timesteps_this_iter": 0, "agent_timesteps_total": 556000, "timers": {"sample_time_ms": 15681.305, "sample_throughput": 255.081, "load_time_ms": 0.387, "load_throughput": 10345449.837, "learn_time_ms": 7230.362, "learn_throughput": 553.223, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.08207634662588438, "policy_loss": 0.005032323565213911, "vf_loss": 7.688873615444347, "vf_explained_var": 0.30821112419969293, "kl": 0.005521450287533426, "entropy": 0.1982807633937687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 556000, "num_agent_steps_sampled": 556000, "num_steps_trained": 556000, "num_agent_steps_trained": 556000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5560, "training_iteration": 139, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-16-23", "timestamp": 1643667383, "time_this_iter_s": 14.942543029785156, "time_total_s": 2058.7268896102905, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2058.7268896102905, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 29.766666666666662, "ram_util_percent": 73.90000000000002}}
{"episode_reward_max": -1.2, "episode_reward_min": -28.500000000000007, "episode_reward_mean": -10.62, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.700000000000003, -22.3, -6.999999999999999, -4.2, -5.4, -4.3, -6.2, -12.3, -4.4, -28.500000000000007, -13.099999999999996, -12.0, -12.2, -5.2, -12.4, -7.2, -6.2, -5.3, -6.2, -10.7, -10.4, -8.2, -11.899999999999999, -18.400000000000002, -18.2, -8.2, -12.7, -9.799999999999999, -18.000000000000004, -15.699999999999998, -13.799999999999999, -14.3, -9.2, -14.1, -12.399999999999999, -11.3, -11.399999999999999, -13.19999999999999, -4.4, -21.300000000000008, -1.2, -4.2, -4.700000000000001, -7.3, -8.2, -10.2, -13.7, -5.0, -10.799999999999999, -7.2, -10.5, -6.3, -5.300000000000001, -6.1, -11.6, -7.2, -7.699999999999999, -4.7, -9.499999999999998, -11.499999999999998, -1.2, -3.2, -14.7, -7.6000000000000005, -12.299999999999997, -12.499999999999998, -12.700000000000001, -6.199999999999998, -18.800000000000004, -9.3, -4.9, -2.6000000000000005, -5.3999999999999995, -11.3, -20.9, -16.6, -4.2, -19.7, -7.2, -13.5, -10.899999999999999, -9.4, -8.9, -10.699999999999998, -10.200000000000001, -8.599999999999998, -15.299999999999999, -3.2, -10.2, -4.7, -9.6, -26.69999999999996, -8.899999999999999, -19.200000000000028, -10.2, -20.9, -4.700000000000001, -19.0, -17.1, -12.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9315262529125488, "mean_inference_ms": 1.1857530719969613, "mean_action_processing_ms": 0.06530722565748596, "mean_env_wait_ms": 5.4179398178219635, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 15691.665, "sample_throughput": 254.912, "load_time_ms": 0.383, "load_throughput": 10448537.087, "learn_time_ms": 7237.501, "learn_throughput": 552.677, "update_time_ms": 1.599}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.10580283341709004, "policy_loss": -0.0034231604026850834, "vf_loss": 10.89707274135723, "vf_explained_var": 0.14681721278416213, "kl": 0.009076204522242016, "entropy": 0.17127516567707063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 560000, "num_steps_trained": 560000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5600, "training_iteration": 140, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-16-38", "timestamp": 1643667398, "time_this_iter_s": 15.135825872421265, "time_total_s": 2073.862715482712, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2073.862715482712, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 30.20476190476191, "ram_util_percent": 73.90000000000002}}
{"episode_reward_max": -1.2, "episode_reward_min": -44.4, "episode_reward_mean": -11.091999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.2, -4.2, -4.700000000000001, -7.3, -8.2, -10.2, -13.7, -5.0, -10.799999999999999, -7.2, -10.5, -6.3, -5.300000000000001, -6.1, -11.6, -7.2, -7.699999999999999, -4.7, -9.499999999999998, -11.499999999999998, -1.2, -3.2, -14.7, -7.6000000000000005, -12.299999999999997, -12.499999999999998, -12.700000000000001, -6.199999999999998, -18.800000000000004, -9.3, -4.9, -2.6000000000000005, -5.3999999999999995, -11.3, -20.9, -16.6, -4.2, -19.7, -7.2, -13.5, -10.899999999999999, -9.4, -8.9, -10.699999999999998, -10.200000000000001, -8.599999999999998, -15.299999999999999, -3.2, -10.2, -4.7, -9.6, -26.69999999999996, -8.899999999999999, -19.200000000000028, -10.2, -20.9, -4.700000000000001, -19.0, -17.1, -12.199999999999998, -19.500000000000004, -44.4, -7.300000000000001, -20.000000000000014, -8.7, -10.999999999999998, -5.2, -8.3, -9.999999999999996, -8.3, -15.899999999999999, -12.3, -12.899999999999999, -20.3, -17.9, -7.2, -13.2, -5.300000000000001, -8.3, -5.300000000000001, -7.4, -11.3, -8.3, -43.4, -8.2, -22.19999999999995, -12.5, -13.3, -12.2, -13.099999999999998, -4.3, -14.299999999999999, -15.899999999999984, -12.0, -13.499999999999993, -8.600000000000001, -4.3, -6.2, -4.300000000000001, -14.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9315595735095141, "mean_inference_ms": 1.1859534316435725, "mean_action_processing_ms": 0.0653077756758539, "mean_env_wait_ms": 5.4178165772302815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 564000, "timesteps_this_iter": 0, "agent_timesteps_total": 564000, "timers": {"sample_time_ms": 15675.133, "sample_throughput": 255.181, "load_time_ms": 0.379, "load_throughput": 10553035.602, "learn_time_ms": 7215.063, "learn_throughput": 554.396, "update_time_ms": 1.572}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.16440022197947587, "policy_loss": -0.007186913398665286, "vf_loss": 17.132662180803155, "vf_explained_var": 0.3633600889354624, "kl": 0.009262920487030379, "entropy": 0.1786747732710454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 564000, "num_agent_steps_sampled": 564000, "num_steps_trained": 564000, "num_agent_steps_trained": 564000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5640, "training_iteration": 141, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-16-53", "timestamp": 1643667413, "time_this_iter_s": 14.654165983200073, "time_total_s": 2088.516881465912, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2088.516881465912, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 29.323809523809516, "ram_util_percent": 73.27142857142859}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.4, "episode_reward_mean": -12.496000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.899999999999999, -9.4, -8.9, -10.699999999999998, -10.200000000000001, -8.599999999999998, -15.299999999999999, -3.2, -10.2, -4.7, -9.6, -26.69999999999996, -8.899999999999999, -19.200000000000028, -10.2, -20.9, -4.700000000000001, -19.0, -17.1, -12.199999999999998, -19.500000000000004, -44.4, -7.300000000000001, -20.000000000000014, -8.7, -10.999999999999998, -5.2, -8.3, -9.999999999999996, -8.3, -15.899999999999999, -12.3, -12.899999999999999, -20.3, -17.9, -7.2, -13.2, -5.300000000000001, -8.3, -5.300000000000001, -7.4, -11.3, -8.3, -43.4, -8.2, -22.19999999999995, -12.5, -13.3, -12.2, -13.099999999999998, -4.3, -14.299999999999999, -15.899999999999984, -12.0, -13.499999999999993, -8.600000000000001, -4.3, -6.2, -4.300000000000001, -14.3, -5.300000000000001, -27.2, -6.3, -12.4, -23.3, -15.8, -7.4, -9.3, -9.2, -12.3, -7.699999999999998, -6.5, -4.300000000000001, -6.9, -18.20000000000001, -6.299999999999999, -11.999999999999998, -14.599999999999985, -15.3, -15.7, -10.2, -9.799999999999999, -11.499999999999995, -3.2, -16.999999999999993, -7.799999999999999, -17.299999999999997, -12.899999999999988, -9.3, -18.3, -25.3, -11.9, -11.700000000000001, -18.799999999999997, -17.6, -4.2, -20.4, -13.199999999999998, -5.300000000000001, -16.39999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9318813775994497, "mean_inference_ms": 1.1860446641382827, "mean_action_processing_ms": 0.06530511903471548, "mean_env_wait_ms": 5.417612030667892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 568000, "timesteps_this_iter": 0, "agent_timesteps_total": 568000, "timers": {"sample_time_ms": 15681.736, "sample_throughput": 255.074, "load_time_ms": 0.376, "load_throughput": 10647468.427, "learn_time_ms": 7213.384, "learn_throughput": 554.525, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.09972179640605244, "policy_loss": -0.01092396261551047, "vf_loss": 11.030055169392657, "vf_explained_var": 0.2321762905325941, "kl": 0.012274101851506953, "entropy": 0.17917998097035834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 568000, "num_agent_steps_sampled": 568000, "num_steps_trained": 568000, "num_agent_steps_trained": 568000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5680, "training_iteration": 142, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-17-08", "timestamp": 1643667428, "time_this_iter_s": 14.962560892105103, "time_total_s": 2103.479442358017, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2103.479442358017, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 30.719047619047608, "ram_util_percent": 73.24761904761905}}
{"episode_reward_max": -1.0, "episode_reward_min": -50.2, "episode_reward_mean": -12.524999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.4, -11.3, -8.3, -43.4, -8.2, -22.19999999999995, -12.5, -13.3, -12.2, -13.099999999999998, -4.3, -14.299999999999999, -15.899999999999984, -12.0, -13.499999999999993, -8.600000000000001, -4.3, -6.2, -4.300000000000001, -14.3, -5.300000000000001, -27.2, -6.3, -12.4, -23.3, -15.8, -7.4, -9.3, -9.2, -12.3, -7.699999999999998, -6.5, -4.300000000000001, -6.9, -18.20000000000001, -6.299999999999999, -11.999999999999998, -14.599999999999985, -15.3, -15.7, -10.2, -9.799999999999999, -11.499999999999995, -3.2, -16.999999999999993, -7.799999999999999, -17.299999999999997, -12.899999999999988, -9.3, -18.3, -25.3, -11.9, -11.700000000000001, -18.799999999999997, -17.6, -4.2, -20.4, -13.199999999999998, -5.300000000000001, -16.39999999999998, -8.2, -11.200000000000003, -4.9, -1.0, -13.2, -15.9, -17.9, -3.6000000000000005, -8.8, -17.0, -3.2, -15.7, -20.6, -4.300000000000001, -4.2, -13.799999999999999, -10.899999999999995, -16.8, -5.2, -12.3, -9.3, -2.4000000000000004, -8.2, -23.2, -4.2, -4.300000000000001, -50.2, -25.900000000000006, -18.599999999999998, -15.999999999999996, -15.499999999999998, -9.199999999999996, -15.999999999999986, -13.3, -4.9, -25.699999999999996, -4.300000000000001, -15.399999999999999, -15.599999999999996, -13.899999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9319426708719234, "mean_inference_ms": 1.1862075812214832, "mean_action_processing_ms": 0.0653062322474267, "mean_env_wait_ms": 5.4176822540823135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 572000, "timesteps_this_iter": 0, "agent_timesteps_total": 572000, "timers": {"sample_time_ms": 15583.869, "sample_throughput": 256.676, "load_time_ms": 0.37, "load_throughput": 10796844.07, "learn_time_ms": 7188.328, "learn_throughput": 556.458, "update_time_ms": 1.599}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 0.00010000000000000003, "total_loss": 0.2114539638714945, "policy_loss": 0.0033150964606833712, "vf_loss": 20.8004378330323, "vf_explained_var": 0.12075658754635883, "kl": 0.004782252042709379, "entropy": 0.15956690743645674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 572000, "num_agent_steps_sampled": 572000, "num_steps_trained": 572000, "num_agent_steps_trained": 572000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5720, "training_iteration": 143, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-17-23", "timestamp": 1643667443, "time_this_iter_s": 15.21747088432312, "time_total_s": 2118.69691324234, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2118.69691324234, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 31.022727272727263, "ram_util_percent": 73.23181818181818}}
{"episode_reward_max": -1.0, "episode_reward_min": -50.2, "episode_reward_mean": -11.946, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -9.799999999999999, -11.499999999999995, -3.2, -16.999999999999993, -7.799999999999999, -17.299999999999997, -12.899999999999988, -9.3, -18.3, -25.3, -11.9, -11.700000000000001, -18.799999999999997, -17.6, -4.2, -20.4, -13.199999999999998, -5.300000000000001, -16.39999999999998, -8.2, -11.200000000000003, -4.9, -1.0, -13.2, -15.9, -17.9, -3.6000000000000005, -8.8, -17.0, -3.2, -15.7, -20.6, -4.300000000000001, -4.2, -13.799999999999999, -10.899999999999995, -16.8, -5.2, -12.3, -9.3, -2.4000000000000004, -8.2, -23.2, -4.2, -4.300000000000001, -50.2, -25.900000000000006, -18.599999999999998, -15.999999999999996, -15.499999999999998, -9.199999999999996, -15.999999999999986, -13.3, -4.9, -25.699999999999996, -4.300000000000001, -15.399999999999999, -15.599999999999996, -13.899999999999997, -23.3, -18.9, -5.8999999999999995, -9.8, -6.300000000000001, -14.299999999999995, -20.400000000000006, -4.2, -9.2, -3.3, -7.700000000000001, -13.699999999999987, -24.1, -4.2, -14.299999999999999, -4.2, -4.800000000000001, -10.3, -5.3, -3.4, -3.4, -21.5, -4.300000000000001, -12.899999999999997, -11.2, -37.2, -3.5000000000000004, -12.100000000000001, -11.999999999999996, -8.2, -3.3, -5.300000000000001, -15.1, -25.3, -13.39999999999999, -8.3, -7.099999999999998, -7.3, -5.3999999999999995, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9318215453703851, "mean_inference_ms": 1.1864415363751264, "mean_action_processing_ms": 0.06531329068069475, "mean_env_wait_ms": 5.418336543625262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 576000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 15571.27, "sample_throughput": 256.883, "load_time_ms": 0.366, "load_throughput": 10929782.41, "learn_time_ms": 7113.694, "learn_throughput": 562.296, "update_time_ms": 1.617}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.131314567010349, "policy_loss": -0.0074918530801291105, "vf_loss": 13.871479266048759, "vf_explained_var": 0.08948631350712109, "kl": 0.006515913881332781, "entropy": 0.16057191094363568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 576000, "num_agent_steps_sampled": 576000, "num_steps_trained": 576000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5760, "training_iteration": 144, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-17-39", "timestamp": 1643667459, "time_this_iter_s": 15.090717077255249, "time_total_s": 2133.7876303195953, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2133.7876303195953, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 23.12272727272727, "ram_util_percent": 73.29999999999998}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -60.49999999999997, "episode_reward_mean": -11.081, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -2.4000000000000004, -8.2, -23.2, -4.2, -4.300000000000001, -50.2, -25.900000000000006, -18.599999999999998, -15.999999999999996, -15.499999999999998, -9.199999999999996, -15.999999999999986, -13.3, -4.9, -25.699999999999996, -4.300000000000001, -15.399999999999999, -15.599999999999996, -13.899999999999997, -23.3, -18.9, -5.8999999999999995, -9.8, -6.300000000000001, -14.299999999999995, -20.400000000000006, -4.2, -9.2, -3.3, -7.700000000000001, -13.699999999999987, -24.1, -4.2, -14.299999999999999, -4.2, -4.800000000000001, -10.3, -5.3, -3.4, -3.4, -21.5, -4.300000000000001, -12.899999999999997, -11.2, -37.2, -3.5000000000000004, -12.100000000000001, -11.999999999999996, -8.2, -3.3, -5.300000000000001, -15.1, -25.3, -13.39999999999999, -8.3, -7.099999999999998, -7.3, -5.3999999999999995, -3.3, -12.1, -15.8, -10.799999999999999, -4.3, -14.799999999999997, -4.300000000000001, -4.300000000000001, -6.9, -7.5, -7.300000000000001, -5.300000000000001, -5.2, -4.300000000000001, -11.399999999999999, -3.8000000000000003, -21.5, -5.300000000000001, -4.300000000000001, -5.300000000000001, -3.3, -16.099999999999998, -60.49999999999997, -4.2, -11.5, -3.2, -14.4, -4.2, -3.3, -5.2, -9.499999999999996, -15.6, -15.999999999999996, -3.4, -11.799999999999999, -8.2, -5.300000000000001, -8.3, -14.9, -7.6, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9316435421541591, "mean_inference_ms": 1.1866525998999433, "mean_action_processing_ms": 0.06532016610807108, "mean_env_wait_ms": 5.419210502432745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"sample_time_ms": 15394.339, "sample_throughput": 259.836, "load_time_ms": 0.365, "load_throughput": 10966217.4, "learn_time_ms": 7024.662, "learn_throughput": 569.422, "update_time_ms": 1.563}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.14991287680803447, "policy_loss": -0.011578939248236917, "vf_loss": 16.136752432456582, "vf_explained_var": 0.17864623159490606, "kl": 0.008838993718853745, "entropy": 0.1649648833058534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 580000, "num_steps_trained": 580000, "num_agent_steps_trained": 580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5800, "training_iteration": 145, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-17-54", "timestamp": 1643667474, "time_this_iter_s": 15.135396718978882, "time_total_s": 2148.923027038574, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2148.923027038574, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 26.271428571428572, "ram_util_percent": 73.34761904761906}}
{"episode_reward_max": 0.0, "episode_reward_min": -83.3, "episode_reward_mean": -10.689999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -21.5, -4.300000000000001, -12.899999999999997, -11.2, -37.2, -3.5000000000000004, -12.100000000000001, -11.999999999999996, -8.2, -3.3, -5.300000000000001, -15.1, -25.3, -13.39999999999999, -8.3, -7.099999999999998, -7.3, -5.3999999999999995, -3.3, -12.1, -15.8, -10.799999999999999, -4.3, -14.799999999999997, -4.300000000000001, -4.300000000000001, -6.9, -7.5, -7.300000000000001, -5.300000000000001, -5.2, -4.300000000000001, -11.399999999999999, -3.8000000000000003, -21.5, -5.300000000000001, -4.300000000000001, -5.300000000000001, -3.3, -16.099999999999998, -60.49999999999997, -4.2, -11.5, -3.2, -14.4, -4.2, -3.3, -5.2, -9.499999999999996, -15.6, -15.999999999999996, -3.4, -11.799999999999999, -8.2, -5.300000000000001, -8.3, -14.9, -7.6, -3.3, -11.6, -4.2, -16.8, -9.3, 0.0, -5.2, -6.2, -3.2, -4.2, -83.3, -6.300000000000001, -14.5, -15.5, -4.300000000000001, -19.6, -11.0, -4.2, -9.2, -5.4, -13.799999999999999, -18.199999999999996, -19.000000000000004, -7.3, -9.0, -4.2, -4.300000000000001, -3.3, -16.099999999999998, -12.9, -8.3, -5.9, -14.799999999999999, -5.3, -12.3, -15.399999999999993, -3.2, -14.5, -13.2, -13.5, -16.099999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9315487888218712, "mean_inference_ms": 1.186722819165082, "mean_action_processing_ms": 0.06532246261811338, "mean_env_wait_ms": 5.419574555518604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 584000, "timesteps_this_iter": 0, "agent_timesteps_total": 584000, "timers": {"sample_time_ms": 15058.664, "sample_throughput": 265.628, "load_time_ms": 0.373, "load_throughput": 10723006.519, "learn_time_ms": 7026.915, "learn_throughput": 569.24, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.29149008351753675, "policy_loss": -0.004128578116351198, "vf_loss": 29.551347696781157, "vf_explained_var": 0.19588971862228968, "kl": 0.0074800522501781465, "entropy": 0.19889007152248456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 584000, "num_agent_steps_sampled": 584000, "num_steps_trained": 584000, "num_agent_steps_trained": 584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5840, "training_iteration": 146, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-18-09", "timestamp": 1643667489, "time_this_iter_s": 15.045456886291504, "time_total_s": 2163.9684839248657, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2163.9684839248657, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 24.172727272727272, "ram_util_percent": 73.40000000000003}}
{"episode_reward_max": 0.0, "episode_reward_min": -83.3, "episode_reward_mean": -11.176000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.099999999999998, -60.49999999999997, -4.2, -11.5, -3.2, -14.4, -4.2, -3.3, -5.2, -9.499999999999996, -15.6, -15.999999999999996, -3.4, -11.799999999999999, -8.2, -5.300000000000001, -8.3, -14.9, -7.6, -3.3, -11.6, -4.2, -16.8, -9.3, 0.0, -5.2, -6.2, -3.2, -4.2, -83.3, -6.300000000000001, -14.5, -15.5, -4.300000000000001, -19.6, -11.0, -4.2, -9.2, -5.4, -13.799999999999999, -18.199999999999996, -19.000000000000004, -7.3, -9.0, -4.2, -4.300000000000001, -3.3, -16.099999999999998, -12.9, -8.3, -5.9, -14.799999999999999, -5.3, -12.3, -15.399999999999993, -3.2, -14.5, -13.2, -13.5, -16.099999999999994, -3.3, -9.699999999999998, -27.800000000000022, -16.399999999999995, -6.299999999999999, -4.9, -3.2, -14.19999999999998, -4.2, -17.5, -27.3, -9.5, -10.3, -54.3, -13.2, -3.2, -13.299999999999999, -7.4, -7.2, -3.4, -11.3, -13.5, -12.799999999999999, -12.600000000000001, -3.3, -6.3999999999999995, -4.4, -9.899999999999999, -3.4, -6.700000000000001, -13.799999999999981, -2.6000000000000005, -11.5, -9.199999999999998, -14.199999999999998, -4.2, -17.900000000000002, -3.3, -4.2, -4.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9315424895734481, "mean_inference_ms": 1.1867698295893272, "mean_action_processing_ms": 0.06532257352302627, "mean_env_wait_ms": 5.419659241117022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 588000, "timesteps_this_iter": 0, "agent_timesteps_total": 588000, "timers": {"sample_time_ms": 15064.576, "sample_throughput": 265.524, "load_time_ms": 0.358, "load_throughput": 11166200.333, "learn_time_ms": 7002.746, "learn_throughput": 571.205, "update_time_ms": 1.592}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.1917725791308468, "policy_loss": -0.005097538508194429, "vf_loss": 19.67329934130433, "vf_explained_var": -0.01371986872406416, "kl": 0.009751406270048297, "entropy": 0.1810390724129574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 588000, "num_agent_steps_sampled": 588000, "num_steps_trained": 588000, "num_agent_steps_trained": 588000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5880, "training_iteration": 147, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-18-24", "timestamp": 1643667504, "time_this_iter_s": 15.02685284614563, "time_total_s": 2178.9953367710114, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2178.9953367710114, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 25.79047619047619, "ram_util_percent": 73.40000000000002}}
{"episode_reward_max": -2.2, "episode_reward_min": -59.3, "episode_reward_mean": -12.229, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.199999999999996, -19.000000000000004, -7.3, -9.0, -4.2, -4.300000000000001, -3.3, -16.099999999999998, -12.9, -8.3, -5.9, -14.799999999999999, -5.3, -12.3, -15.399999999999993, -3.2, -14.5, -13.2, -13.5, -16.099999999999994, -3.3, -9.699999999999998, -27.800000000000022, -16.399999999999995, -6.299999999999999, -4.9, -3.2, -14.19999999999998, -4.2, -17.5, -27.3, -9.5, -10.3, -54.3, -13.2, -3.2, -13.299999999999999, -7.4, -7.2, -3.4, -11.3, -13.5, -12.799999999999999, -12.600000000000001, -3.3, -6.3999999999999995, -4.4, -9.899999999999999, -3.4, -6.700000000000001, -13.799999999999981, -2.6000000000000005, -11.5, -9.199999999999998, -14.199999999999998, -4.2, -17.900000000000002, -3.3, -4.2, -4.700000000000001, -8.3, -30.3, -19.2, -8.600000000000001, -12.09999999999998, -11.7, -22.9, -12.700000000000001, -2.2, -14.2, -28.50000000000003, -3.3, -16.799999999999997, -21.199999999999996, -15.0, -24.4, -7.799999999999998, -9.8, -12.399999999999999, -20.4, -7.8, -19.8, -6.4, -3.2, -3.3, -15.8, -8.4, -10.6, -17.3, -17.8, -31.800000000000075, -9.6, -11.3, -9.2, -4.5, -12.2, -15.3, -4.2, -59.3, -10.000000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9315457042078122, "mean_inference_ms": 1.1868716828991344, "mean_action_processing_ms": 0.06532469028044442, "mean_env_wait_ms": 5.420208022271263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 592000, "timesteps_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"sample_time_ms": 15060.52, "sample_throughput": 265.595, "load_time_ms": 0.354, "load_throughput": 11296267.169, "learn_time_ms": 7012.961, "learn_throughput": 570.372, "update_time_ms": 1.592}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.2806933405749019, "policy_loss": -0.0013642077684722922, "vf_loss": 28.197228546040034, "vf_explained_var": 0.02238548840245893, "kl": 0.006063498926208235, "entropy": 0.17605102430748684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 592000, "num_agent_steps_sampled": 592000, "num_steps_trained": 592000, "num_agent_steps_trained": 592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5920, "training_iteration": 148, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-18-39", "timestamp": 1643667519, "time_this_iter_s": 15.243186950683594, "time_total_s": 2194.238523721695, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2194.238523721695, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 24.586363636363636, "ram_util_percent": 73.40000000000003}}
{"episode_reward_max": -2.2, "episode_reward_min": -59.3, "episode_reward_mean": -11.816999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -13.5, -12.799999999999999, -12.600000000000001, -3.3, -6.3999999999999995, -4.4, -9.899999999999999, -3.4, -6.700000000000001, -13.799999999999981, -2.6000000000000005, -11.5, -9.199999999999998, -14.199999999999998, -4.2, -17.900000000000002, -3.3, -4.2, -4.700000000000001, -8.3, -30.3, -19.2, -8.600000000000001, -12.09999999999998, -11.7, -22.9, -12.700000000000001, -2.2, -14.2, -28.50000000000003, -3.3, -16.799999999999997, -21.199999999999996, -15.0, -24.4, -7.799999999999998, -9.8, -12.399999999999999, -20.4, -7.8, -19.8, -6.4, -3.2, -3.3, -15.8, -8.4, -10.6, -17.3, -17.8, -31.800000000000075, -9.6, -11.3, -9.2, -4.5, -12.2, -15.3, -4.2, -59.3, -10.000000000000002, -11.4, -21.0, -4.2, -3.6000000000000005, -12.19999999999997, -8.2, -8.2, -18.4, -3.2, -5.1000000000000005, -3.4000000000000004, -5.0, -9.2, -21.099999999999998, -19.60000000000001, -3.2, -4.300000000000001, -25.200000000000003, -3.3, -12.5, -3.2, -16.9, -6.4, -8.8, -11.3, -7.2, -13.0, -17.600000000000005, -11.899999999999997, -5.700000000000001, -21.700000000000006, -21.0, -11.399999999999991, -15.299999999999995, -3.3, -5.2, -3.2, -16.5, -11.2, -19.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9316476508449929, "mean_inference_ms": 1.1870454035147742, "mean_action_processing_ms": 0.0653279862082515, "mean_env_wait_ms": 5.420942656853416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 596000, "timesteps_this_iter": 0, "agent_timesteps_total": 596000, "timers": {"sample_time_ms": 15083.47, "sample_throughput": 265.191, "load_time_ms": 0.352, "load_throughput": 11372841.649, "learn_time_ms": 7014.069, "learn_throughput": 570.282, "update_time_ms": 1.584}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.09802093717159444, "policy_loss": -0.011815903989738355, "vf_loss": 10.972864188686493, "vf_explained_var": 0.15640367256697787, "kl": 0.007694615435752341, "entropy": 0.1657608656553171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 596000, "num_agent_steps_sampled": 596000, "num_steps_trained": 596000, "num_agent_steps_trained": 596000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5960, "training_iteration": 149, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-18-54", "timestamp": 1643667534, "time_this_iter_s": 15.082705974578857, "time_total_s": 2209.321229696274, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2209.321229696274, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 26.571428571428573, "ram_util_percent": 73.43809523809526}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.69999999999999, "episode_reward_mean": -12.499, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.8, -19.8, -6.4, -3.2, -3.3, -15.8, -8.4, -10.6, -17.3, -17.8, -31.800000000000075, -9.6, -11.3, -9.2, -4.5, -12.2, -15.3, -4.2, -59.3, -10.000000000000002, -11.4, -21.0, -4.2, -3.6000000000000005, -12.19999999999997, -8.2, -8.2, -18.4, -3.2, -5.1000000000000005, -3.4000000000000004, -5.0, -9.2, -21.099999999999998, -19.60000000000001, -3.2, -4.300000000000001, -25.200000000000003, -3.3, -12.5, -3.2, -16.9, -6.4, -8.8, -11.3, -7.2, -13.0, -17.600000000000005, -11.899999999999997, -5.700000000000001, -21.700000000000006, -21.0, -11.399999999999991, -15.299999999999995, -3.3, -5.2, -3.2, -16.5, -11.2, -19.099999999999998, -3.2, -22.600000000000005, -6.6000000000000005, -16.4, -10.700000000000001, -3.3, -4.300000000000001, -4.300000000000001, -5.4, -4.9, -15.3, -3.3, -3.3, -3.3, -14.899999999999999, -13.599999999999998, -3.3, -3.3, -14.199999999999998, -3.4, -20.90000000000001, -35.2, -13.199999999999998, -15.399999999999999, -7.099999999999999, -10.299999999999999, -3.2, -17.0, -13.599999999999998, -16.79999999999998, -3.4, -24.299999999999997, -25.5, -3.2, -14.799999999999999, -95.69999999999999, -3.4, -5.300000000000001, -22.800000000000008, -29.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9316040593512388, "mean_inference_ms": 1.1872839542596083, "mean_action_processing_ms": 0.06533251727711127, "mean_env_wait_ms": 5.421804336600087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 15078.868, "sample_throughput": 265.272, "load_time_ms": 0.355, "load_throughput": 11266681.888, "learn_time_ms": 7044.107, "learn_throughput": 567.851, "update_time_ms": 1.583}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.4721109192566796, "policy_loss": -0.006524041407210852, "vf_loss": 47.85043836485955, "vf_explained_var": 0.12676253985333186, "kl": 0.009286313612072989, "entropy": 0.15264245766385268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6000, "training_iteration": 150, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-19-10", "timestamp": 1643667550, "time_this_iter_s": 15.380265235900879, "time_total_s": 2224.7014949321747, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2224.7014949321747, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 29.83636363636364, "ram_util_percent": 73.40909090909093}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.69999999999999, "episode_reward_mean": -11.660000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -16.9, -6.4, -8.8, -11.3, -7.2, -13.0, -17.600000000000005, -11.899999999999997, -5.700000000000001, -21.700000000000006, -21.0, -11.399999999999991, -15.299999999999995, -3.3, -5.2, -3.2, -16.5, -11.2, -19.099999999999998, -3.2, -22.600000000000005, -6.6000000000000005, -16.4, -10.700000000000001, -3.3, -4.300000000000001, -4.300000000000001, -5.4, -4.9, -15.3, -3.3, -3.3, -3.3, -14.899999999999999, -13.599999999999998, -3.3, -3.3, -14.199999999999998, -3.4, -20.90000000000001, -35.2, -13.199999999999998, -15.399999999999999, -7.099999999999999, -10.299999999999999, -3.2, -17.0, -13.599999999999998, -16.79999999999998, -3.4, -24.299999999999997, -25.5, -3.2, -14.799999999999999, -95.69999999999999, -3.4, -5.300000000000001, -22.800000000000008, -29.2, -13.3, -6.2, -5.800000000000001, -6.499999999999999, -5.7, -8.899999999999999, -3.4, -7.499999999999999, -5.1, -6.699999999999999, -4.300000000000001, -21.2, -12.499999999999998, -3.2, -3.3, -38.800000000000054, -4.6, -4.700000000000001, -23.5, -10.399999999999999, -7.899999999999998, -6.2, -3.2, -19.2, -25.300000000000015, -16.5, -4.300000000000001, -6.2, -11.299999999999999, -6.1000000000000005, -5.2, -3.4, -18.300000000000008, -12.0, -8.099999999999998, -8.2, -4.4, -11.7, -3.4, -19.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9314025979965763, "mean_inference_ms": 1.1873982777808112, "mean_action_processing_ms": 0.06533273804957923, "mean_env_wait_ms": 5.42213635734259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 604000, "timesteps_this_iter": 0, "agent_timesteps_total": 604000, "timers": {"sample_time_ms": 15104.62, "sample_throughput": 264.82, "load_time_ms": 0.357, "load_throughput": 11202735.043, "learn_time_ms": 7055.261, "learn_throughput": 566.953, "update_time_ms": 1.547}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.12375244744001858, "policy_loss": -0.010758515423344028, "vf_loss": 13.435123777261344, "vf_explained_var": -0.11046981343659021, "kl": 0.011358378046872003, "entropy": 0.13609491361565487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 604000, "num_agent_steps_sampled": 604000, "num_steps_trained": 604000, "num_agent_steps_trained": 604000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6040, "training_iteration": 151, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-19-24", "timestamp": 1643667564, "time_this_iter_s": 14.722048044204712, "time_total_s": 2239.4235429763794, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2239.4235429763794, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 26.238095238095237, "ram_util_percent": 73.45714285714287}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.69999999999999, "episode_reward_mean": -11.823, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.90000000000001, -35.2, -13.199999999999998, -15.399999999999999, -7.099999999999999, -10.299999999999999, -3.2, -17.0, -13.599999999999998, -16.79999999999998, -3.4, -24.299999999999997, -25.5, -3.2, -14.799999999999999, -95.69999999999999, -3.4, -5.300000000000001, -22.800000000000008, -29.2, -13.3, -6.2, -5.800000000000001, -6.499999999999999, -5.7, -8.899999999999999, -3.4, -7.499999999999999, -5.1, -6.699999999999999, -4.300000000000001, -21.2, -12.499999999999998, -3.2, -3.3, -38.800000000000054, -4.6, -4.700000000000001, -23.5, -10.399999999999999, -7.899999999999998, -6.2, -3.2, -19.2, -25.300000000000015, -16.5, -4.300000000000001, -6.2, -11.299999999999999, -6.1000000000000005, -5.2, -3.4, -18.300000000000008, -12.0, -8.099999999999998, -8.2, -4.4, -11.7, -3.4, -19.7, -16.299999999999997, -7.3, -6.300000000000001, -4.4, -7.3, -13.3, -10.699999999999996, -21.2, -15.2, -5.9, -10.8, -4.3, -33.80000000000003, -7.3, -9.599999999999998, -3.2, -4.3, -6.4, -3.2, -16.799999999999997, -3.6000000000000005, -18.2, -5.3, -9.499999999999998, -7.2, -8.4, -9.399999999999999, -19.5, -8.399999999999999, -17.4, -3.2, -3.3, -9.2, -4.2, -16.6, -5.5, -9.899999999999999, -17.799999999999997, -18.299999999999997, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9311138128480205, "mean_inference_ms": 1.1874323464467376, "mean_action_processing_ms": 0.06533315526329445, "mean_env_wait_ms": 5.422342684111079, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 608000, "timesteps_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"sample_time_ms": 15106.155, "sample_throughput": 264.793, "load_time_ms": 0.365, "load_throughput": 10954760.692, "learn_time_ms": 7092.561, "learn_throughput": 563.971, "update_time_ms": 1.51}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.08843985238933676, "policy_loss": -0.006724813560484558, "vf_loss": 9.50780116322861, "vf_explained_var": 0.1681331787058102, "kl": 0.006162240780728635, "entropy": 0.18955097416395783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 608000, "num_agent_steps_sampled": 608000, "num_steps_trained": 608000, "num_agent_steps_trained": 608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6080, "training_iteration": 152, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-19-40", "timestamp": 1643667580, "time_this_iter_s": 15.2461678981781, "time_total_s": 2254.6697108745575, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2254.6697108745575, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 28.036363636363635, "ram_util_percent": 73.45}}
{"episode_reward_max": -3.2, "episode_reward_min": -63.3, "episode_reward_mean": -11.067000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.899999999999998, -6.2, -3.2, -19.2, -25.300000000000015, -16.5, -4.300000000000001, -6.2, -11.299999999999999, -6.1000000000000005, -5.2, -3.4, -18.300000000000008, -12.0, -8.099999999999998, -8.2, -4.4, -11.7, -3.4, -19.7, -16.299999999999997, -7.3, -6.300000000000001, -4.4, -7.3, -13.3, -10.699999999999996, -21.2, -15.2, -5.9, -10.8, -4.3, -33.80000000000003, -7.3, -9.599999999999998, -3.2, -4.3, -6.4, -3.2, -16.799999999999997, -3.6000000000000005, -18.2, -5.3, -9.499999999999998, -7.2, -8.4, -9.399999999999999, -19.5, -8.399999999999999, -17.4, -3.2, -3.3, -9.2, -4.2, -16.6, -5.5, -9.899999999999999, -17.799999999999997, -18.299999999999997, -3.3, -8.999999999999996, -9.999999999999998, -3.4, -8.1, -19.5, -9.0, -24.200000000000035, -4.4, -3.5000000000000004, -12.199999999999974, -12.3, -6.2, -9.2, -8.1, -8.0, -32.3, -63.3, -5.799999999999999, -3.4, -49.999999999999986, -16.4, -6.2, -15.600000000000001, -20.3, -19.000000000000014, -3.3, -6.300000000000001, -3.2, -3.3, -14.3, -3.2, -10.299999999999997, -5.0, -3.3, -11.299999999999999, -3.4, -15.999999999999998, -4.9, -21.20000000000001, -11.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9309285846566132, "mean_inference_ms": 1.1875291920003503, "mean_action_processing_ms": 0.06533492341517536, "mean_env_wait_ms": 5.422550208505386, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 612000, "timesteps_this_iter": 0, "agent_timesteps_total": 612000, "timers": {"sample_time_ms": 15136.703, "sample_throughput": 264.258, "load_time_ms": 0.369, "load_throughput": 10850611.823, "learn_time_ms": 7076.232, "learn_throughput": 565.273, "update_time_ms": 1.501}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 0.00010000000000000003, "total_loss": 0.34347233016404416, "policy_loss": 0.00018982613379115698, "vf_loss": 34.32294633946111, "vf_explained_var": 0.014569519604406049, "kl": 0.0037725930377540207, "entropy": 0.1706194852388674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 612000, "num_agent_steps_sampled": 612000, "num_steps_trained": 612000, "num_agent_steps_trained": 612000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6120, "training_iteration": 153, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-19-55", "timestamp": 1643667595, "time_this_iter_s": 15.011317014694214, "time_total_s": 2269.6810278892517, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2269.6810278892517, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 27.54285714285714, "ram_util_percent": 73.44761904761906}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.2, "episode_reward_mean": -12.542, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -18.2, -5.3, -9.499999999999998, -7.2, -8.4, -9.399999999999999, -19.5, -8.399999999999999, -17.4, -3.2, -3.3, -9.2, -4.2, -16.6, -5.5, -9.899999999999999, -17.799999999999997, -18.299999999999997, -3.3, -8.999999999999996, -9.999999999999998, -3.4, -8.1, -19.5, -9.0, -24.200000000000035, -4.4, -3.5000000000000004, -12.199999999999974, -12.3, -6.2, -9.2, -8.1, -8.0, -32.3, -63.3, -5.799999999999999, -3.4, -49.999999999999986, -16.4, -6.2, -15.600000000000001, -20.3, -19.000000000000014, -3.3, -6.300000000000001, -3.2, -3.3, -14.3, -3.2, -10.299999999999997, -5.0, -3.3, -11.299999999999999, -3.4, -15.999999999999998, -4.9, -21.20000000000001, -11.899999999999999, -11.599999999999998, -14.899999999999999, -3.8000000000000003, -5.2, -19.5, -3.3, -15.499999999999996, -8.099999999999998, -6.3, -27.70000000000002, -22.9, -12.699999999999998, -25.0, -21.099999999999998, -3.2, -11.2, -5.2, -3.3, -4.4, -14.399999999999977, -8.3, -11.899999999999997, -19.600000000000005, -3.9000000000000004, -15.2, -3.3, -18.800000000000004, -16.199999999999996, -8.100000000000001, -21.5, -4.6000000000000005, -49.3, -67.2, -7.3, -11.099999999999998, -17.500000000000004, -13.5, -5.9, -8.9, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.930897842179315, "mean_inference_ms": 1.1876164525054125, "mean_action_processing_ms": 0.0653366637295, "mean_env_wait_ms": 5.422928694973449, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 616000, "timesteps_this_iter": 0, "agent_timesteps_total": 616000, "timers": {"sample_time_ms": 15110.476, "sample_throughput": 264.717, "load_time_ms": 0.376, "load_throughput": 10642065.335, "learn_time_ms": 7079.671, "learn_throughput": 564.998, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.3726325484303137, "policy_loss": 0.0024863129501701683, "vf_loss": 37.00025559163863, "vf_explained_var": 0.04363241022632968, "kl": 0.020435542065533645, "entropy": 0.20355038067666434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 616000, "num_agent_steps_sampled": 616000, "num_steps_trained": 616000, "num_agent_steps_trained": 616000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6160, "training_iteration": 154, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-20-10", "timestamp": 1643667610, "time_this_iter_s": 15.030515909194946, "time_total_s": 2284.7115437984467, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2284.7115437984467, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 28.40952380952381, "ram_util_percent": 73.47142857142858}}
{"episode_reward_max": -3.2, "episode_reward_min": -67.2, "episode_reward_mean": -12.206000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.4, -6.2, -15.600000000000001, -20.3, -19.000000000000014, -3.3, -6.300000000000001, -3.2, -3.3, -14.3, -3.2, -10.299999999999997, -5.0, -3.3, -11.299999999999999, -3.4, -15.999999999999998, -4.9, -21.20000000000001, -11.899999999999999, -11.599999999999998, -14.899999999999999, -3.8000000000000003, -5.2, -19.5, -3.3, -15.499999999999996, -8.099999999999998, -6.3, -27.70000000000002, -22.9, -12.699999999999998, -25.0, -21.099999999999998, -3.2, -11.2, -5.2, -3.3, -4.4, -14.399999999999977, -8.3, -11.899999999999997, -19.600000000000005, -3.9000000000000004, -15.2, -3.3, -18.800000000000004, -16.199999999999996, -8.100000000000001, -21.5, -4.6000000000000005, -49.3, -67.2, -7.3, -11.099999999999998, -17.500000000000004, -13.5, -5.9, -8.9, -4.3, -4.4, -42.2, -19.2, -25.10000000000001, -13.6, -6.3, -3.2, -16.799999999999997, -3.4, -4.300000000000001, -3.4, -8.2, -10.9, -15.1, -34.6, -3.2, -5.300000000000001, -15.3, -27.199999999999996, -3.3, -27.800000000000004, -4.2, -9.299999999999997, -15.6, -7.3, -21.200000000000003, -3.2, -10.399999999999999, -7.4, -4.2, -3.3, -10.2, -6.2, -15.899999999999999, -3.3, -3.3, -9.2, -17.2, -11.700000000000001, -10.600000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9309593413316967, "mean_inference_ms": 1.18767001070053, "mean_action_processing_ms": 0.06533907596401098, "mean_env_wait_ms": 5.423395260451326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"sample_time_ms": 15125.113, "sample_throughput": 264.461, "load_time_ms": 0.379, "load_throughput": 10555027.367, "learn_time_ms": 7081.532, "learn_throughput": 564.85, "update_time_ms": 1.493}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.010546875000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.1913315461610534, "policy_loss": -0.006010559283857865, "vf_loss": 19.720919840053845, "vf_explained_var": 0.015533723369721444, "kl": 0.01260181157503305, "entropy": 0.21972591380678838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 620000, "num_steps_trained": 620000, "num_agent_steps_trained": 620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6200, "training_iteration": 155, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-20-25", "timestamp": 1643667625, "time_this_iter_s": 15.261009931564331, "time_total_s": 2299.972553730011, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2299.972553730011, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 28.818181818181817, "ram_util_percent": 73.55909090909087}}
{"episode_reward_max": -3.0, "episode_reward_min": -67.2, "episode_reward_mean": -12.624, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -11.899999999999997, -19.600000000000005, -3.9000000000000004, -15.2, -3.3, -18.800000000000004, -16.199999999999996, -8.100000000000001, -21.5, -4.6000000000000005, -49.3, -67.2, -7.3, -11.099999999999998, -17.500000000000004, -13.5, -5.9, -8.9, -4.3, -4.4, -42.2, -19.2, -25.10000000000001, -13.6, -6.3, -3.2, -16.799999999999997, -3.4, -4.300000000000001, -3.4, -8.2, -10.9, -15.1, -34.6, -3.2, -5.300000000000001, -15.3, -27.199999999999996, -3.3, -27.800000000000004, -4.2, -9.299999999999997, -15.6, -7.3, -21.200000000000003, -3.2, -10.399999999999999, -7.4, -4.2, -3.3, -10.2, -6.2, -15.899999999999999, -3.3, -3.3, -9.2, -17.2, -11.700000000000001, -10.600000000000001, -18.600000000000005, -4.2, -5.2, -4.2, -12.200000000000001, -10.2, -19.7, -3.3, -3.4, -3.3, -3.0, -4.300000000000001, -9.600000000000001, -51.299999999999976, -11.0, -12.699999999999998, -7.4, -11.199999999999998, -14.799999999999999, -26.799999999999997, -3.4, -14.199999999999998, -8.8, -4.2, -21.6, -3.3, -17.4, -16.299999999999983, -3.2, -17.4, -29.699999999999992, -3.2, -5.3, -17.6, -3.2, -31.9, -17.7, -15.999999999999998, -5.3, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9308216856817029, "mean_inference_ms": 1.1876357974943295, "mean_action_processing_ms": 0.0653370818709077, "mean_env_wait_ms": 5.423277463034065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 624000, "timesteps_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"sample_time_ms": 15103.862, "sample_throughput": 264.833, "load_time_ms": 0.368, "load_throughput": 10870296.747, "learn_time_ms": 7066.448, "learn_throughput": 566.055, "update_time_ms": 1.499}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.010546875000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.23870141849006896, "policy_loss": -0.009384529848372744, "vf_loss": 24.80037278725255, "vf_explained_var": 0.1539631131515708, "kl": 0.007796070016192123, "entropy": 0.18288464115792386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 624000, "num_agent_steps_sampled": 624000, "num_steps_trained": 624000, "num_agent_steps_trained": 624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6240, "training_iteration": 156, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-20-40", "timestamp": 1643667640, "time_this_iter_s": 14.640521049499512, "time_total_s": 2314.6130747795105, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2314.6130747795105, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 28.509523809523806, "ram_util_percent": 73.59999999999998}}
{"episode_reward_max": -3.0, "episode_reward_min": -51.299999999999976, "episode_reward_mean": -10.524, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.800000000000004, -4.2, -9.299999999999997, -15.6, -7.3, -21.200000000000003, -3.2, -10.399999999999999, -7.4, -4.2, -3.3, -10.2, -6.2, -15.899999999999999, -3.3, -3.3, -9.2, -17.2, -11.700000000000001, -10.600000000000001, -18.600000000000005, -4.2, -5.2, -4.2, -12.200000000000001, -10.2, -19.7, -3.3, -3.4, -3.3, -3.0, -4.300000000000001, -9.600000000000001, -51.299999999999976, -11.0, -12.699999999999998, -7.4, -11.199999999999998, -14.799999999999999, -26.799999999999997, -3.4, -14.199999999999998, -8.8, -4.2, -21.6, -3.3, -17.4, -16.299999999999983, -3.2, -17.4, -29.699999999999992, -3.2, -5.3, -17.6, -3.2, -31.9, -17.7, -15.999999999999998, -5.3, -3.4, -6.3, -8.7, -11.799999999999999, -3.3, -5.4, -3.4, -16.699999999999996, -16.9, -17.2, -16.799999999999997, -4.4, -15.499999999999998, -12.099999999999996, -3.3, -5.999999999999996, -13.4, -19.100000000000005, -4.4, -3.3, -3.3, -14.499999999999998, -8.4, -6.2, -13.799999999999999, -4.300000000000001, -4.700000000000001, -11.499999999999998, -11.099999999999998, -11.2, -4.300000000000001, -10.799999999999997, -9.0, -3.4, -6.3, -12.3, -9.799999999999997, -3.2, -16.799999999999997, -15.099999999999996, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9306857091378923, "mean_inference_ms": 1.1876599793032978, "mean_action_processing_ms": 0.06533708318910542, "mean_env_wait_ms": 5.4233154285647265, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 628000, "timesteps_this_iter": 0, "agent_timesteps_total": 628000, "timers": {"sample_time_ms": 15086.69, "sample_throughput": 265.134, "load_time_ms": 0.37, "load_throughput": 10815636.926, "learn_time_ms": 7080.353, "learn_throughput": 564.944, "update_time_ms": 1.487}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.010546875000000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.05516454174398615, "policy_loss": -0.00843207755035931, "vf_loss": 6.355223911776338, "vf_explained_var": 0.3125738986076847, "kl": 0.004208286204878709, "entropy": 0.1569583810184912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 628000, "num_agent_steps_sampled": 628000, "num_steps_trained": 628000, "num_agent_steps_trained": 628000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6280, "training_iteration": 157, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-20-55", "timestamp": 1643667655, "time_this_iter_s": 15.177595853805542, "time_total_s": 2329.790670633316, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2329.790670633316, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 28.961904761904766, "ram_util_percent": 73.59999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.40000000000001, "episode_reward_mean": -10.148000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -14.199999999999998, -8.8, -4.2, -21.6, -3.3, -17.4, -16.299999999999983, -3.2, -17.4, -29.699999999999992, -3.2, -5.3, -17.6, -3.2, -31.9, -17.7, -15.999999999999998, -5.3, -3.4, -6.3, -8.7, -11.799999999999999, -3.3, -5.4, -3.4, -16.699999999999996, -16.9, -17.2, -16.799999999999997, -4.4, -15.499999999999998, -12.099999999999996, -3.3, -5.999999999999996, -13.4, -19.100000000000005, -4.4, -3.3, -3.3, -14.499999999999998, -8.4, -6.2, -13.799999999999999, -4.300000000000001, -4.700000000000001, -11.499999999999998, -11.099999999999998, -11.2, -4.300000000000001, -10.799999999999997, -9.0, -3.4, -6.3, -12.3, -9.799999999999997, -3.2, -16.799999999999997, -15.099999999999996, -3.4, -12.999999999999998, -7.6000000000000005, -24.0, -5.1000000000000005, -6.8, -3.2, -6.9, -3.3, -9.2, -6.599999999999999, -4.4, -7.3, -15.599999999999998, -16.2, -3.3, -10.4, -9.0, -10.499999999999998, -46.40000000000001, -14.999999999999998, -19.3, -3.4, -3.3, -8.3, -4.2, -10.499999999999995, -17.3, -11.799999999999999, -3.3, -15.899999999999999, -3.2, -16.099999999999998, -3.4, -3.4, -3.3, -12.799999999999999, -3.5, -3.900000000000001, -9.099999999999998, -20.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9306597083053572, "mean_inference_ms": 1.187774734222798, "mean_action_processing_ms": 0.0653411929863374, "mean_env_wait_ms": 5.423843174726933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 632000, "timesteps_this_iter": 0, "agent_timesteps_total": 632000, "timers": {"sample_time_ms": 15101.635, "sample_throughput": 264.872, "load_time_ms": 0.374, "load_throughput": 10690891.48, "learn_time_ms": 7111.65, "learn_throughput": 562.457, "update_time_ms": 1.486}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.1734927294465403, "policy_loss": -0.00618409938429312, "vf_loss": 17.964670278788894, "vf_explained_var": 0.1235413021297865, "kl": 0.00571403025107788, "entropy": 0.11713631714303648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 632000, "num_agent_steps_sampled": 632000, "num_steps_trained": 632000, "num_agent_steps_trained": 632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6320, "training_iteration": 158, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-21-10", "timestamp": 1643667670, "time_this_iter_s": 15.571181058883667, "time_total_s": 2345.3618516921997, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2345.3618516921997, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 29.309090909090912, "ram_util_percent": 73.59999999999997}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.3, "episode_reward_mean": -10.771999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.499999999999998, -8.4, -6.2, -13.799999999999999, -4.300000000000001, -4.700000000000001, -11.499999999999998, -11.099999999999998, -11.2, -4.300000000000001, -10.799999999999997, -9.0, -3.4, -6.3, -12.3, -9.799999999999997, -3.2, -16.799999999999997, -15.099999999999996, -3.4, -12.999999999999998, -7.6000000000000005, -24.0, -5.1000000000000005, -6.8, -3.2, -6.9, -3.3, -9.2, -6.599999999999999, -4.4, -7.3, -15.599999999999998, -16.2, -3.3, -10.4, -9.0, -10.499999999999998, -46.40000000000001, -14.999999999999998, -19.3, -3.4, -3.3, -8.3, -4.2, -10.499999999999995, -17.3, -11.799999999999999, -3.3, -15.899999999999999, -3.2, -16.099999999999998, -3.4, -3.4, -3.3, -12.799999999999999, -3.5, -3.900000000000001, -9.099999999999998, -20.5, -16.3, -3.2, -3.2, -3.2, -15.999999999999998, -8.8, -14.899999999999997, -11.8, -20.9, -8.999999999999998, -35.2, -4.2, -13.600000000000001, -6.599999999999999, -3.3, -6.3, -89.3, -9.2, -9.4, -15.600000000000001, -16.599999999999994, -8.3, -10.799999999999997, -7.1, -3.3, -5.3, -16.999999999999996, -12.399999999999997, -3.3, -17.599999999999998, -7.2, -16.099999999999998, -6.3, -18.0, -8.0, -3.2, -3.4, -15.799999999999997, -13.8, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9305785982154561, "mean_inference_ms": 1.187922076903157, "mean_action_processing_ms": 0.06534798808582815, "mean_env_wait_ms": 5.424528499145494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 636000, "timesteps_this_iter": 0, "agent_timesteps_total": 636000, "timers": {"sample_time_ms": 15139.478, "sample_throughput": 264.21, "load_time_ms": 0.37, "load_throughput": 10804492.53, "learn_time_ms": 7129.731, "learn_throughput": 561.031, "update_time_ms": 1.487}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.4387499377472571, "policy_loss": -0.006224274449050426, "vf_loss": 44.49084192552874, "vf_explained_var": 0.12323823084113418, "kl": 0.012477484524395137, "entropy": 0.13563759524815827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 636000, "num_agent_steps_sampled": 636000, "num_steps_trained": 636000, "num_agent_steps_trained": 636000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6360, "training_iteration": 159, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-21-26", "timestamp": 1643667686, "time_this_iter_s": 15.315623760223389, "time_total_s": 2360.677475452423, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2360.677475452423, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 30.099999999999998, "ram_util_percent": 73.58636363636361}}
{"episode_reward_max": -3.2, "episode_reward_min": -89.3, "episode_reward_mean": -11.536000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.3, -3.4, -3.3, -8.3, -4.2, -10.499999999999995, -17.3, -11.799999999999999, -3.3, -15.899999999999999, -3.2, -16.099999999999998, -3.4, -3.4, -3.3, -12.799999999999999, -3.5, -3.900000000000001, -9.099999999999998, -20.5, -16.3, -3.2, -3.2, -3.2, -15.999999999999998, -8.8, -14.899999999999997, -11.8, -20.9, -8.999999999999998, -35.2, -4.2, -13.600000000000001, -6.599999999999999, -3.3, -6.3, -89.3, -9.2, -9.4, -15.600000000000001, -16.599999999999994, -8.3, -10.799999999999997, -7.1, -3.3, -5.3, -16.999999999999996, -12.399999999999997, -3.3, -17.599999999999998, -7.2, -16.099999999999998, -6.3, -18.0, -8.0, -3.2, -3.4, -15.799999999999997, -13.8, -3.3, -5.3, -3.3, -19.4, -18.1, -3.2, -11.3, -9.999999999999998, -9.1, -3.6000000000000005, -4.3, -12.8, -25.4, -14.899999999999997, -14.5, -23.200000000000014, -11.2, -20.099999999999998, -13.499999999999996, -17.5, -9.7, -18.400000000000002, -5.0, -14.999999999999996, -3.3, -10.399999999999997, -7.700000000000001, -8.3, -15.399999999999997, -17.900000000000002, -6.3999999999999995, -9.399999999999999, -3.4, -20.99999999999999, -13.599999999999998, -16.599999999999998, -12.399999999999999, -13.999999999999998, -5.300000000000001, -5.8999999999999995, -20.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9305294102144148, "mean_inference_ms": 1.1880288333420819, "mean_action_processing_ms": 0.06535603438299102, "mean_env_wait_ms": 5.425338017653755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 15164.834, "sample_throughput": 263.768, "load_time_ms": 0.369, "load_throughput": 10851313.628, "learn_time_ms": 7110.952, "learn_throughput": 562.513, "update_time_ms": 1.477}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.10335194033881029, "policy_loss": -0.0014392436351827395, "vf_loss": 10.475302506774984, "vf_explained_var": 0.1637998571318965, "kl": 0.007236606314475585, "entropy": 0.16252118547757466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 640000, "num_steps_trained": 640000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6400, "training_iteration": 160, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-21-41", "timestamp": 1643667701, "time_this_iter_s": 15.247658967971802, "time_total_s": 2375.925134420395, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2375.925134420395, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 27.845454545454547, "ram_util_percent": 73.59999999999997}}
{"episode_reward_max": -3.2, "episode_reward_min": -31.400000000000016, "episode_reward_mean": -11.04, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.599999999999994, -8.3, -10.799999999999997, -7.1, -3.3, -5.3, -16.999999999999996, -12.399999999999997, -3.3, -17.599999999999998, -7.2, -16.099999999999998, -6.3, -18.0, -8.0, -3.2, -3.4, -15.799999999999997, -13.8, -3.3, -5.3, -3.3, -19.4, -18.1, -3.2, -11.3, -9.999999999999998, -9.1, -3.6000000000000005, -4.3, -12.8, -25.4, -14.899999999999997, -14.5, -23.200000000000014, -11.2, -20.099999999999998, -13.499999999999996, -17.5, -9.7, -18.400000000000002, -5.0, -14.999999999999996, -3.3, -10.399999999999997, -7.700000000000001, -8.3, -15.399999999999997, -17.900000000000002, -6.3999999999999995, -9.399999999999999, -3.4, -20.99999999999999, -13.599999999999998, -16.599999999999998, -12.399999999999999, -13.999999999999998, -5.300000000000001, -5.8999999999999995, -20.5, -4.2, -31.400000000000016, -11.299999999999992, -4.300000000000001, -8.899999999999999, -4.4, -5.0, -12.2, -3.4, -17.2, -18.500000000000004, -13.3, -4.3, -5.3, -4.4, -11.3, -3.2, -18.200000000000003, -9.2, -17.0, -13.4, -16.3, -3.2, -17.6, -6.2, -17.3, -5.3, -4.2, -20.8, -24.2, -3.4, -15.0, -13.2, -12.19999999999997, -10.999999999999998, -14.099999999999996, -4.300000000000001, -8.3, -3.7000000000000006, -6.199999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9304044958239044, "mean_inference_ms": 1.1880441070439178, "mean_action_processing_ms": 0.06536005994419865, "mean_env_wait_ms": 5.426508701957846, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 644000, "timesteps_this_iter": 0, "agent_timesteps_total": 644000, "timers": {"sample_time_ms": 15167.863, "sample_throughput": 263.715, "load_time_ms": 0.366, "load_throughput": 10919822.963, "learn_time_ms": 7135.977, "learn_throughput": 560.54, "update_time_ms": 1.463}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.10654189630000982, "policy_loss": -0.0007020857084983139, "vf_loss": 10.719976891433038, "vf_explained_var": 0.2398992194283393, "kl": 0.008384408699138195, "entropy": 0.12824088858981286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 644000, "num_agent_steps_sampled": 644000, "num_steps_trained": 644000, "num_agent_steps_trained": 644000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6440, "training_iteration": 161, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-21-56", "timestamp": 1643667716, "time_this_iter_s": 15.189381122589111, "time_total_s": 2391.114515542984, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2391.114515542984, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 30.485714285714288, "ram_util_percent": 73.57619047619045}}
{"episode_reward_max": -3.2, "episode_reward_min": -58.2, "episode_reward_mean": -10.854999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.400000000000002, -5.0, -14.999999999999996, -3.3, -10.399999999999997, -7.700000000000001, -8.3, -15.399999999999997, -17.900000000000002, -6.3999999999999995, -9.399999999999999, -3.4, -20.99999999999999, -13.599999999999998, -16.599999999999998, -12.399999999999999, -13.999999999999998, -5.300000000000001, -5.8999999999999995, -20.5, -4.2, -31.400000000000016, -11.299999999999992, -4.300000000000001, -8.899999999999999, -4.4, -5.0, -12.2, -3.4, -17.2, -18.500000000000004, -13.3, -4.3, -5.3, -4.4, -11.3, -3.2, -18.200000000000003, -9.2, -17.0, -13.4, -16.3, -3.2, -17.6, -6.2, -17.3, -5.3, -4.2, -20.8, -24.2, -3.4, -15.0, -13.2, -12.19999999999997, -10.999999999999998, -14.099999999999996, -4.300000000000001, -8.3, -3.7000000000000006, -6.199999999999999, -5.2, -6.6000000000000005, -15.199999999999998, -3.9000000000000004, -4.300000000000001, -7.3, -3.3, -13.5, -6.300000000000001, -7.5, -8.4, -8.3, -4.300000000000001, -12.699999999999996, -8.799999999999999, -13.3, -12.599999999999998, -6.300000000000001, -13.999999999999998, -10.9, -17.399999999999995, -5.300000000000001, -10.2, -3.3, -14.8, -4.2, -14.3, -17.4, -14.999999999999996, -9.2, -15.299999999999983, -3.6000000000000005, -8.899999999999999, -11.899999999999999, -3.2, -7.899999999999999, -19.299999999999983, -7.899999999999999, -8.7, -58.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9307589497573097, "mean_inference_ms": 1.1880353946157736, "mean_action_processing_ms": 0.06536272369914281, "mean_env_wait_ms": 5.427603034472311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 648000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 15217.716, "sample_throughput": 262.852, "load_time_ms": 0.374, "load_throughput": 10692254.158, "learn_time_ms": 7135.008, "learn_throughput": 560.616, "update_time_ms": 1.505}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.17162510989864746, "policy_loss": -0.028538378960483016, "vf_loss": 20.01199323925921, "vf_explained_var": 0.2792500771502013, "kl": 0.008260295747432487, "entropy": 0.1526871259254153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 648000, "num_agent_steps_sampled": 648000, "num_steps_trained": 648000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6480, "training_iteration": 162, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-22-12", "timestamp": 1643667732, "time_this_iter_s": 15.464333772659302, "time_total_s": 2406.5788493156433, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2406.5788493156433, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 29.031818181818178, "ram_util_percent": 73.59999999999997}}
{"episode_reward_max": -3.2, "episode_reward_min": -58.2, "episode_reward_mean": -10.517000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.4, -16.3, -3.2, -17.6, -6.2, -17.3, -5.3, -4.2, -20.8, -24.2, -3.4, -15.0, -13.2, -12.19999999999997, -10.999999999999998, -14.099999999999996, -4.300000000000001, -8.3, -3.7000000000000006, -6.199999999999999, -5.2, -6.6000000000000005, -15.199999999999998, -3.9000000000000004, -4.300000000000001, -7.3, -3.3, -13.5, -6.300000000000001, -7.5, -8.4, -8.3, -4.300000000000001, -12.699999999999996, -8.799999999999999, -13.3, -12.599999999999998, -6.300000000000001, -13.999999999999998, -10.9, -17.399999999999995, -5.300000000000001, -10.2, -3.3, -14.8, -4.2, -14.3, -17.4, -14.999999999999996, -9.2, -15.299999999999983, -3.6000000000000005, -8.899999999999999, -11.899999999999999, -3.2, -7.899999999999999, -19.299999999999983, -7.899999999999999, -8.7, -58.2, -3.4, -4.2, -6.000000000000001, -8.799999999999997, -18.5, -4.699999999999999, -3.5000000000000004, -19.9, -3.4, -4.300000000000001, -10.7, -12.2, -3.4, -18.1, -3.2, -23.3, -21.699999999999996, -14.799999999999999, -18.599999999999984, -3.2, -3.2, -7.8, -5.8999999999999995, -16.5, -6.2, -12.2, -10.499999999999998, -12.699999999999998, -5.8999999999999995, -8.899999999999999, -15.3, -4.4, -7.3, -8.7, -3.3, -12.8, -14.799999999999997, -14.7, -11.7, -14.399999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9307281563582347, "mean_inference_ms": 1.1880761207302724, "mean_action_processing_ms": 0.06536560540940915, "mean_env_wait_ms": 5.428587568113269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 652000, "timesteps_this_iter": 0, "agent_timesteps_total": 652000, "timers": {"sample_time_ms": 15204.454, "sample_throughput": 263.081, "load_time_ms": 0.374, "load_throughput": 10690210.271, "learn_time_ms": 7165.764, "learn_throughput": 558.21, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.09043381194113403, "policy_loss": -0.0007197814252507943, "vf_loss": 9.111833348774141, "vf_explained_var": 0.21658354882271058, "kl": 0.00668729484995623, "entropy": 0.1285828396237345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 652000, "num_agent_steps_sampled": 652000, "num_steps_trained": 652000, "num_agent_steps_trained": 652000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6520, "training_iteration": 163, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-22-27", "timestamp": 1643667747, "time_this_iter_s": 15.17310094833374, "time_total_s": 2421.751950263977, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2421.751950263977, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 29.14090909090909, "ram_util_percent": 73.59999999999997}}
{"episode_reward_max": -2.5, "episode_reward_min": -58.2, "episode_reward_mean": -10.363, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.399999999999995, -5.300000000000001, -10.2, -3.3, -14.8, -4.2, -14.3, -17.4, -14.999999999999996, -9.2, -15.299999999999983, -3.6000000000000005, -8.899999999999999, -11.899999999999999, -3.2, -7.899999999999999, -19.299999999999983, -7.899999999999999, -8.7, -58.2, -3.4, -4.2, -6.000000000000001, -8.799999999999997, -18.5, -4.699999999999999, -3.5000000000000004, -19.9, -3.4, -4.300000000000001, -10.7, -12.2, -3.4, -18.1, -3.2, -23.3, -21.699999999999996, -14.799999999999999, -18.599999999999984, -3.2, -3.2, -7.8, -5.8999999999999995, -16.5, -6.2, -12.2, -10.499999999999998, -12.699999999999998, -5.8999999999999995, -8.899999999999999, -15.3, -4.4, -7.3, -8.7, -3.3, -12.8, -14.799999999999997, -14.7, -11.7, -14.399999999999997, -3.3, -4.2, -12.699999999999994, -5.1, -16.4, -14.8, -5.699999999999999, -11.5, -2.5, -12.5, -3.4, -3.3, -4.300000000000001, -7.4, -8.3, -11.9, -3.4, -11.799999999999999, -11.0, -7.2, -10.799999999999999, -18.799999999999997, -14.5, -3.3, -5.300000000000001, -38.2, -11.699999999999996, -5.700000000000001, -13.7, -8.5, -5.1000000000000005, -4.2, -23.500000000000018, -6.199999999999999, -12.9, -6.1, -2.9000000000000004, -12.599999999999998, -3.3, -9.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9308463700454385, "mean_inference_ms": 1.1880700628039096, "mean_action_processing_ms": 0.06536704566997105, "mean_env_wait_ms": 5.428992159266072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 656000, "timesteps_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"sample_time_ms": 15225.401, "sample_throughput": 262.719, "load_time_ms": 0.384, "load_throughput": 10407056.634, "learn_time_ms": 7263.002, "learn_throughput": 550.736, "update_time_ms": 1.517}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.10852174516917477, "policy_loss": 0.0012103617972423954, "vf_loss": 10.727711318257034, "vf_explained_var": 0.2688972632090251, "kl": 0.0064990565197864895, "entropy": 0.1324564776593639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 656000, "num_agent_steps_sampled": 656000, "num_steps_trained": 656000, "num_agent_steps_trained": 656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6560, "training_iteration": 164, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-22-43", "timestamp": 1643667763, "time_this_iter_s": 15.908117771148682, "time_total_s": 2437.6600680351257, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2437.6600680351257, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 30.518181818181816, "ram_util_percent": 73.59090909090907}}
{"episode_reward_max": -2.5, "episode_reward_min": -38.2, "episode_reward_mean": -9.729, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -7.8, -5.8999999999999995, -16.5, -6.2, -12.2, -10.499999999999998, -12.699999999999998, -5.8999999999999995, -8.899999999999999, -15.3, -4.4, -7.3, -8.7, -3.3, -12.8, -14.799999999999997, -14.7, -11.7, -14.399999999999997, -3.3, -4.2, -12.699999999999994, -5.1, -16.4, -14.8, -5.699999999999999, -11.5, -2.5, -12.5, -3.4, -3.3, -4.300000000000001, -7.4, -8.3, -11.9, -3.4, -11.799999999999999, -11.0, -7.2, -10.799999999999999, -18.799999999999997, -14.5, -3.3, -5.300000000000001, -38.2, -11.699999999999996, -5.700000000000001, -13.7, -8.5, -5.1000000000000005, -4.2, -23.500000000000018, -6.199999999999999, -12.9, -6.1, -2.9000000000000004, -12.599999999999998, -3.3, -9.2, -4.3, -7.800000000000001, -11.999999999999998, -10.2, -13.599999999999998, -9.5, -14.399999999999999, -6.2, -13.499999999999998, -3.3, -17.9, -20.5, -3.2, -3.3, -12.19999999999997, -31.299999999999997, -3.3, -6.0, -5.3, -5.300000000000001, -15.5, -13.9, -10.5, -11.6, -4.300000000000001, -9.899999999999999, -7.6, -18.1, -3.2, -3.3, -3.5000000000000004, -9.799999999999999, -5.700000000000001, -11.199999999999998, -3.2, -13.999999999999972, -3.4, -4.2, -24.000000000000007, -18.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9309868552227034, "mean_inference_ms": 1.1884799213570438, "mean_action_processing_ms": 0.06538900718933502, "mean_env_wait_ms": 5.4313076856954385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 15420.271, "sample_throughput": 259.399, "load_time_ms": 0.381, "load_throughput": 10494286.608, "learn_time_ms": 7275.006, "learn_throughput": 549.828, "update_time_ms": 1.518}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.0916918744903899, "policy_loss": -0.0018011617764670362, "vf_loss": 9.344518258494716, "vf_explained_var": 0.46162082822092115, "kl": 0.009074923709019207, "entropy": 0.10342132124889603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6600, "training_iteration": 165, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-22-59", "timestamp": 1643667779, "time_this_iter_s": 16.33283495903015, "time_total_s": 2453.992902994156, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2453.992902994156, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 34.69130434782609, "ram_util_percent": 73.73478260869565}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -38.99999999999995, "episode_reward_mean": -10.96, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.799999999999999, -18.799999999999997, -14.5, -3.3, -5.300000000000001, -38.2, -11.699999999999996, -5.700000000000001, -13.7, -8.5, -5.1000000000000005, -4.2, -23.500000000000018, -6.199999999999999, -12.9, -6.1, -2.9000000000000004, -12.599999999999998, -3.3, -9.2, -4.3, -7.800000000000001, -11.999999999999998, -10.2, -13.599999999999998, -9.5, -14.399999999999999, -6.2, -13.499999999999998, -3.3, -17.9, -20.5, -3.2, -3.3, -12.19999999999997, -31.299999999999997, -3.3, -6.0, -5.3, -5.300000000000001, -15.5, -13.9, -10.5, -11.6, -4.300000000000001, -9.899999999999999, -7.6, -18.1, -3.2, -3.3, -3.5000000000000004, -9.799999999999999, -5.700000000000001, -11.199999999999998, -3.2, -13.999999999999972, -3.4, -4.2, -24.000000000000007, -18.5, -4.300000000000001, -19.099999999999987, -8.3, -19.999999999999993, -9.0, -3.3, -15.2, -6.000000000000001, -3.3, -4.300000000000001, -18.3, -19.4, -19.599999999999998, -14.7, -3.2, -16.799999999999997, -4.4, -19.700000000000003, -12.1, -16.39999999999998, -12.599999999999989, -17.7, -16.3, -38.99999999999995, -3.2, -18.7, -8.100000000000001, -13.8, -14.199999999999998, -14.3, -13.5, -9.799999999999997, -3.4, -17.9, -3.2, -11.399999999999999, -5.3, -3.2, -4.4, -13.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9310847717506305, "mean_inference_ms": 1.188875650359983, "mean_action_processing_ms": 0.0654058869929067, "mean_env_wait_ms": 5.43317317334838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 664000, "timesteps_this_iter": 0, "agent_timesteps_total": 664000, "timers": {"sample_time_ms": 15431.812, "sample_throughput": 259.205, "load_time_ms": 0.378, "load_throughput": 10578320.303, "learn_time_ms": 7263.936, "learn_throughput": 550.666, "update_time_ms": 1.521}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.12042296254576774, "policy_loss": -0.003511373135411451, "vf_loss": 12.384587779416833, "vf_explained_var": 0.18573125511087396, "kl": 0.016775079697942723, "entropy": 0.15508665338318836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 664000, "num_agent_steps_sampled": 664000, "num_steps_trained": 664000, "num_agent_steps_trained": 664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6640, "training_iteration": 166, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-23-14", "timestamp": 1643667794, "time_this_iter_s": 14.546172857284546, "time_total_s": 2468.5390758514404, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2468.5390758514404, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 24.366666666666664, "ram_util_percent": 73.75238095238096}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.99999999999995, "episode_reward_mean": -11.755999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.5, -13.9, -10.5, -11.6, -4.300000000000001, -9.899999999999999, -7.6, -18.1, -3.2, -3.3, -3.5000000000000004, -9.799999999999999, -5.700000000000001, -11.199999999999998, -3.2, -13.999999999999972, -3.4, -4.2, -24.000000000000007, -18.5, -4.300000000000001, -19.099999999999987, -8.3, -19.999999999999993, -9.0, -3.3, -15.2, -6.000000000000001, -3.3, -4.300000000000001, -18.3, -19.4, -19.599999999999998, -14.7, -3.2, -16.799999999999997, -4.4, -19.700000000000003, -12.1, -16.39999999999998, -12.599999999999989, -17.7, -16.3, -38.99999999999995, -3.2, -18.7, -8.100000000000001, -13.8, -14.199999999999998, -14.3, -13.5, -9.799999999999997, -3.4, -17.9, -3.2, -11.399999999999999, -5.3, -3.2, -4.4, -13.599999999999998, -17.599999999999994, -14.899999999999999, -11.7, -10.899999999999999, -15.499999999999998, -24.600000000000005, -5.3, -35.3, -6.4, -20.799999999999997, -3.2, -3.4, -31.0, -7.2, -5.2, -14.7, -5.2, -10.1, -11.499999999999998, -13.799999999999992, -5.300000000000001, -23.10000000000001, -16.1, -14.899999999999999, -20.799999999999997, -13.799999999999995, -4.2, -21.599999999999998, -12.799999999999997, -4.300000000000001, -9.799999999999999, -3.4, -7.499999999999999, -12.5, -3.2, -14.2, -24.70000000000001, -3.3, -5.1000000000000005, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9311483227436915, "mean_inference_ms": 1.1890835932561763, "mean_action_processing_ms": 0.06540957909372577, "mean_env_wait_ms": 5.433891508181448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 668000, "timesteps_this_iter": 0, "agent_timesteps_total": 668000, "timers": {"sample_time_ms": 15406.964, "sample_throughput": 259.623, "load_time_ms": 0.373, "load_throughput": 10727806.126, "learn_time_ms": 7232.535, "learn_throughput": 553.056, "update_time_ms": 1.502}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005273437500000001, "cur_lr": 0.00010000000000000003, "total_loss": 0.12835378176532686, "policy_loss": 0.001990506263269532, "vf_loss": 12.634282681249804, "vf_explained_var": 0.27199773442360664, "kl": 0.0038786143031930343, "entropy": 0.14008383141650307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 668000, "num_agent_steps_sampled": 668000, "num_steps_trained": 668000, "num_agent_steps_trained": 668000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6680, "training_iteration": 167, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-23-29", "timestamp": 1643667809, "time_this_iter_s": 14.725844144821167, "time_total_s": 2483.2649199962616, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2483.2649199962616, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 25.452380952380956, "ram_util_percent": 73.77142857142856}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.3, "episode_reward_mean": -12.645, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.599999999999989, -17.7, -16.3, -38.99999999999995, -3.2, -18.7, -8.100000000000001, -13.8, -14.199999999999998, -14.3, -13.5, -9.799999999999997, -3.4, -17.9, -3.2, -11.399999999999999, -5.3, -3.2, -4.4, -13.599999999999998, -17.599999999999994, -14.899999999999999, -11.7, -10.899999999999999, -15.499999999999998, -24.600000000000005, -5.3, -35.3, -6.4, -20.799999999999997, -3.2, -3.4, -31.0, -7.2, -5.2, -14.7, -5.2, -10.1, -11.499999999999998, -13.799999999999992, -5.300000000000001, -23.10000000000001, -16.1, -14.899999999999999, -20.799999999999997, -13.799999999999995, -4.2, -21.599999999999998, -12.799999999999997, -4.300000000000001, -9.799999999999999, -3.4, -7.499999999999999, -12.5, -3.2, -14.2, -24.70000000000001, -3.3, -5.1000000000000005, -10.3, -11.2, -3.3, -3.4, -4.2, -4.2, -75.3, -10.899999999999997, -7.3, -9.799999999999997, -8.899999999999999, -4.3, -28.799999999999997, -3.4, -4.300000000000001, -4.4, -18.199999999999996, -3.3, -3.4, -3.4, -13.5, -17.800000000000004, -15.399999999999999, -9.1, -8.7, -4.4, -16.7, -6.5, -13.399999999999999, -3.2, -6.4, -17.799999999999997, -7.1, -36.79999999999996, -8.3, -17.199999999999996, -11.599999999999998, -64.2, -16.9, -11.4, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9310223489979073, "mean_inference_ms": 1.1889310692066632, "mean_action_processing_ms": 0.06539506875662107, "mean_env_wait_ms": 5.432981520759479, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 672000, "timesteps_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"sample_time_ms": 15323.532, "sample_throughput": 261.036, "load_time_ms": 0.373, "load_throughput": 10733296.654, "learn_time_ms": 7208.265, "learn_throughput": 554.919, "update_time_ms": 1.495}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0026367187500000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.4689126604652253, "policy_loss": -0.006660627031458481, "vf_loss": 47.55560409606144, "vf_explained_var": 0.07401666410507694, "kl": 0.006545739554903572, "entropy": 0.14910448250030317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 672000, "num_agent_steps_sampled": 672000, "num_steps_trained": 672000, "num_agent_steps_trained": 672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6720, "training_iteration": 168, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-23-43", "timestamp": 1643667823, "time_this_iter_s": 14.81229019165039, "time_total_s": 2498.077210187912, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2498.077210187912, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 22.866666666666667, "ram_util_percent": 73.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -80.4000000000001, "episode_reward_mean": -12.974999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -23.10000000000001, -16.1, -14.899999999999999, -20.799999999999997, -13.799999999999995, -4.2, -21.599999999999998, -12.799999999999997, -4.300000000000001, -9.799999999999999, -3.4, -7.499999999999999, -12.5, -3.2, -14.2, -24.70000000000001, -3.3, -5.1000000000000005, -10.3, -11.2, -3.3, -3.4, -4.2, -4.2, -75.3, -10.899999999999997, -7.3, -9.799999999999997, -8.899999999999999, -4.3, -28.799999999999997, -3.4, -4.300000000000001, -4.4, -18.199999999999996, -3.3, -3.4, -3.4, -13.5, -17.800000000000004, -15.399999999999999, -9.1, -8.7, -4.4, -16.7, -6.5, -13.399999999999999, -3.2, -6.4, -17.799999999999997, -7.1, -36.79999999999996, -8.3, -17.199999999999996, -11.599999999999998, -64.2, -16.9, -11.4, -3.3, -4.4, -7.300000000000001, -15.3, -17.099999999999998, -4.300000000000001, -13.8, -4.6000000000000005, -3.2, -3.3, -4.300000000000001, -3.3, -11.399999999999999, -3.2, -15.499999999999977, -4.300000000000001, -21.700000000000003, -5.4, -4.5, -12.399999999999995, -3.4, -19.699999999999996, -8.000000000000002, -33.099999999999994, -3.8000000000000003, -26.3, -11.3, -8.3, -5.2, -4.300000000000001, -80.4000000000001, -9.3, -10.599999999999994, -31.00000000000001, -18.099999999999998, -3.4, -14.799999999999999, -11.0, -27.600000000000005, -16.799999999999997, -39.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.930854974243976, "mean_inference_ms": 1.1885748315264681, "mean_action_processing_ms": 0.06537460990108174, "mean_env_wait_ms": 5.431445439891894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 676000, "timesteps_this_iter": 0, "agent_timesteps_total": 676000, "timers": {"sample_time_ms": 15243.456, "sample_throughput": 262.408, "load_time_ms": 0.376, "load_throughput": 10632623.107, "learn_time_ms": 7155.701, "learn_throughput": 558.995, "update_time_ms": 1.5}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0026367187500000006, "cur_lr": 0.00010000000000000003, "total_loss": 0.41313796563509614, "policy_loss": -0.00932899868260989, "vf_loss": 42.24545708266638, "vf_explained_var": -0.004832483363407914, "kl": 0.004704053656854589, "entropy": 0.128658389736728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 676000, "num_agent_steps_sampled": 676000, "num_steps_trained": 676000, "num_agent_steps_trained": 676000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6760, "training_iteration": 169, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-23-58", "timestamp": 1643667838, "time_this_iter_s": 14.227045774459839, "time_total_s": 2512.304255962372, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2512.304255962372, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 21.125, "ram_util_percent": 73.79999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -80.4000000000001, "episode_reward_mean": -12.936999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.800000000000004, -15.399999999999999, -9.1, -8.7, -4.4, -16.7, -6.5, -13.399999999999999, -3.2, -6.4, -17.799999999999997, -7.1, -36.79999999999996, -8.3, -17.199999999999996, -11.599999999999998, -64.2, -16.9, -11.4, -3.3, -4.4, -7.300000000000001, -15.3, -17.099999999999998, -4.300000000000001, -13.8, -4.6000000000000005, -3.2, -3.3, -4.300000000000001, -3.3, -11.399999999999999, -3.2, -15.499999999999977, -4.300000000000001, -21.700000000000003, -5.4, -4.5, -12.399999999999995, -3.4, -19.699999999999996, -8.000000000000002, -33.099999999999994, -3.8000000000000003, -26.3, -11.3, -8.3, -5.2, -4.300000000000001, -80.4000000000001, -9.3, -10.599999999999994, -31.00000000000001, -18.099999999999998, -3.4, -14.799999999999999, -11.0, -27.600000000000005, -16.799999999999997, -39.2, -17.4, -22.5, -4.300000000000001, -15.899999999999997, -23.5, -6.6, -15.2, -15.799999999999999, -4.300000000000001, -13.5, -8.2, -12.000000000000002, -18.900000000000006, -7.3, -4.4, -19.999999999999993, -3.3, -4.2, -15.9, -6.3999999999999995, -15.899999999999984, -3.3, -10.999999999999998, -10.999999999999996, -6.699999999999998, -14.799999999999999, -3.7, -12.799999999999999, -19.099999999999998, -9.1, -17.299999999999997, -16.799999999999997, -3.4, -11.099999999999998, -3.3, -4.6000000000000005, -6.3, -14.1, -25.400000000000002, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9307358494829913, "mean_inference_ms": 1.1882394900966629, "mean_action_processing_ms": 0.06535592692532656, "mean_env_wait_ms": 5.42990558636252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"sample_time_ms": 15168.433, "sample_throughput": 263.706, "load_time_ms": 0.375, "load_throughput": 10663710.672, "learn_time_ms": 7103.2, "learn_throughput": 563.126, "update_time_ms": 1.511}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0013183593750000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.12882115127398602, "policy_loss": -0.008527517697263148, "vf_loss": 13.733938530279744, "vf_explained_var": 0.028498729326391734, "kl": 0.00704511793900448, "entropy": 0.11353222696931772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 680000, "num_steps_trained": 680000, "num_agent_steps_trained": 680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6800, "training_iteration": 170, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-24-12", "timestamp": 1643667852, "time_this_iter_s": 14.50327181816101, "time_total_s": 2526.807527780533, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2526.807527780533, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 27.861904761904757, "ram_util_percent": 73.66190476190475}}
{"episode_reward_max": -3.2, "episode_reward_min": -80.4000000000001, "episode_reward_mean": -12.052, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.699999999999996, -8.000000000000002, -33.099999999999994, -3.8000000000000003, -26.3, -11.3, -8.3, -5.2, -4.300000000000001, -80.4000000000001, -9.3, -10.599999999999994, -31.00000000000001, -18.099999999999998, -3.4, -14.799999999999999, -11.0, -27.600000000000005, -16.799999999999997, -39.2, -17.4, -22.5, -4.300000000000001, -15.899999999999997, -23.5, -6.6, -15.2, -15.799999999999999, -4.300000000000001, -13.5, -8.2, -12.000000000000002, -18.900000000000006, -7.3, -4.4, -19.999999999999993, -3.3, -4.2, -15.9, -6.3999999999999995, -15.899999999999984, -3.3, -10.999999999999998, -10.999999999999996, -6.699999999999998, -14.799999999999999, -3.7, -12.799999999999999, -19.099999999999998, -9.1, -17.299999999999997, -16.799999999999997, -3.4, -11.099999999999998, -3.3, -4.6000000000000005, -6.3, -14.1, -25.400000000000002, -3.3, -9.5, -5.0, -3.3, -4.9, -11.8, -11.199999999999994, -12.199999999999992, -3.3, -4.800000000000001, -6.4, -8.2, -3.3, -4.300000000000001, -4.4, -15.799999999999999, -44.2, -16.499999999999993, -3.3, -3.4, -4.2, -12.5, -10.499999999999998, -13.2, -33.900000000000006, -10.499999999999998, -3.4, -4.4, -4.300000000000001, -3.4000000000000004, -14.799999999999999, -3.3, -11.799999999999999, -5.1000000000000005, -8.499999999999998, -7.899999999999998, -3.2, -4.300000000000001, -10.299999999999997, -7.7, -17.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9306050572096332, "mean_inference_ms": 1.188105345411036, "mean_action_processing_ms": 0.06534487345152079, "mean_env_wait_ms": 5.429289039258351, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 684000, "timesteps_this_iter": 0, "agent_timesteps_total": 684000, "timers": {"sample_time_ms": 15115.866, "sample_throughput": 264.623, "load_time_ms": 0.373, "load_throughput": 10710000.638, "learn_time_ms": 7057.791, "learn_throughput": 566.75, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0013183593750000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.11716343208306258, "policy_loss": -0.0014574252504615053, "vf_loss": 11.861044950703139, "vf_explained_var": 0.1988048626530555, "kl": 0.007897918735413957, "entropy": 0.10450112147316817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 684000, "num_agent_steps_sampled": 684000, "num_steps_trained": 684000, "num_agent_steps_trained": 684000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6840, "training_iteration": 171, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-24-27", "timestamp": 1643667867, "time_this_iter_s": 14.70868182182312, "time_total_s": 2541.516209602356, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2541.516209602356, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 28.028571428571436, "ram_util_percent": 73.59999999999998}}
{"episode_reward_max": -2.5, "episode_reward_min": -44.2, "episode_reward_mean": -9.098999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.899999999999984, -3.3, -10.999999999999998, -10.999999999999996, -6.699999999999998, -14.799999999999999, -3.7, -12.799999999999999, -19.099999999999998, -9.1, -17.299999999999997, -16.799999999999997, -3.4, -11.099999999999998, -3.3, -4.6000000000000005, -6.3, -14.1, -25.400000000000002, -3.3, -9.5, -5.0, -3.3, -4.9, -11.8, -11.199999999999994, -12.199999999999992, -3.3, -4.800000000000001, -6.4, -8.2, -3.3, -4.300000000000001, -4.4, -15.799999999999999, -44.2, -16.499999999999993, -3.3, -3.4, -4.2, -12.5, -10.499999999999998, -13.2, -33.900000000000006, -10.499999999999998, -3.4, -4.4, -4.300000000000001, -3.4000000000000004, -14.799999999999999, -3.3, -11.799999999999999, -5.1000000000000005, -8.499999999999998, -7.899999999999998, -3.2, -4.300000000000001, -10.299999999999997, -7.7, -17.4, -3.3, -3.4, -8.2, -9.2, -4.300000000000001, -4.2, -13.299999999999997, -10.1, -27.300000000000043, -3.3, -10.3, -10.5, -14.8, -11.7, -5.2, -11.299999999999995, -10.4, -9.899999999999999, -3.2, -13.399999999999999, -2.5, -3.8000000000000007, -4.4, -8.2, -4.3, -4.2, -4.800000000000001, -3.2, -4.300000000000001, -12.899999999999999, -3.3, -12.2, -3.4, -4.5, -10.4, -10.999999999999998, -4.0, -14.4, -20.1, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9304787160688974, "mean_inference_ms": 1.1880319628473635, "mean_action_processing_ms": 0.06534818120236263, "mean_env_wait_ms": 5.429030619580442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 688000, "timesteps_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"sample_time_ms": 15033.449, "sample_throughput": 266.073, "load_time_ms": 0.366, "load_throughput": 10926223.38, "learn_time_ms": 7003.302, "learn_throughput": 571.159, "update_time_ms": 1.497}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0013183593750000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.05764822286643809, "policy_loss": -0.0068211323020839565, "vf_loss": 6.445591804721663, "vf_explained_var": 0.13730720275191852, "kl": 0.010194103410524019, "entropy": 0.09726999578496781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 688000, "num_agent_steps_sampled": 688000, "num_steps_trained": 688000, "num_agent_steps_trained": 688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6880, "training_iteration": 172, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-24-42", "timestamp": 1643667882, "time_this_iter_s": 14.552726984024048, "time_total_s": 2556.06893658638, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2556.06893658638, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 28.395238095238092, "ram_util_percent": 73.60952380952378}}
{"episode_reward_max": -2.5, "episode_reward_min": -33.900000000000006, "episode_reward_mean": -9.152999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.5, -10.499999999999998, -13.2, -33.900000000000006, -10.499999999999998, -3.4, -4.4, -4.300000000000001, -3.4000000000000004, -14.799999999999999, -3.3, -11.799999999999999, -5.1000000000000005, -8.499999999999998, -7.899999999999998, -3.2, -4.300000000000001, -10.299999999999997, -7.7, -17.4, -3.3, -3.4, -8.2, -9.2, -4.300000000000001, -4.2, -13.299999999999997, -10.1, -27.300000000000043, -3.3, -10.3, -10.5, -14.8, -11.7, -5.2, -11.299999999999995, -10.4, -9.899999999999999, -3.2, -13.399999999999999, -2.5, -3.8000000000000007, -4.4, -8.2, -4.3, -4.2, -4.800000000000001, -3.2, -4.300000000000001, -12.899999999999999, -3.3, -12.2, -3.4, -4.5, -10.4, -10.999999999999998, -4.0, -14.4, -20.1, -3.3, -10.3, -2.9000000000000004, -2.5000000000000004, -3.3, -9.3, -11.3, -4.300000000000001, -9.79999999999999, -12.999999999999993, -22.200000000000003, -12.799999999999999, -15.699999999999998, -4.4, -10.2, -10.2, -21.4, -14.999999999999998, -7.2, -8.2, -4.300000000000001, -11.6, -7.8, -19.5, -5.9, -6.299999999999999, -8.3, -4.2, -5.300000000000001, -6.899999999999999, -3.3, -9.3, -11.2, -16.8, -10.099999999999998, -14.799999999999997, -12.799999999999997, -12.3, -17.5, -6.299999999999999, -9.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.930318997178352, "mean_inference_ms": 1.1879551053636712, "mean_action_processing_ms": 0.06535042130142259, "mean_env_wait_ms": 5.428832002792989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 692000, "timesteps_this_iter": 0, "agent_timesteps_total": 692000, "timers": {"sample_time_ms": 14995.557, "sample_throughput": 266.746, "load_time_ms": 0.366, "load_throughput": 10924800.417, "learn_time_ms": 6935.464, "learn_throughput": 576.746, "update_time_ms": 1.474}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0013183593750000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.0857680277913929, "policy_loss": 0.010884311415695696, "vf_loss": 7.487804079440332, "vf_explained_var": 0.3527963392837073, "kl": 0.0043061462351185725, "entropy": 0.10553480732024356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 692000, "num_agent_steps_sampled": 692000, "num_steps_trained": 692000, "num_agent_steps_trained": 692000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6920, "training_iteration": 173, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-24-56", "timestamp": 1643667896, "time_this_iter_s": 14.651637077331543, "time_total_s": 2570.7205736637115, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2570.7205736637115, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 27.699999999999992, "ram_util_percent": 73.66190476190476}}
{"episode_reward_max": -2.5, "episode_reward_min": -54.2, "episode_reward_mean": -10.667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -3.8000000000000007, -4.4, -8.2, -4.3, -4.2, -4.800000000000001, -3.2, -4.300000000000001, -12.899999999999999, -3.3, -12.2, -3.4, -4.5, -10.4, -10.999999999999998, -4.0, -14.4, -20.1, -3.3, -10.3, -2.9000000000000004, -2.5000000000000004, -3.3, -9.3, -11.3, -4.300000000000001, -9.79999999999999, -12.999999999999993, -22.200000000000003, -12.799999999999999, -15.699999999999998, -4.4, -10.2, -10.2, -21.4, -14.999999999999998, -7.2, -8.2, -4.300000000000001, -11.6, -7.8, -19.5, -5.9, -6.299999999999999, -8.3, -4.2, -5.300000000000001, -6.899999999999999, -3.3, -9.3, -11.2, -16.8, -10.099999999999998, -14.799999999999997, -12.799999999999997, -12.3, -17.5, -6.299999999999999, -9.899999999999999, -4.4, -29.300000000000015, -21.2, -20.90000000000001, -13.3, -9.3, -15.899999999999993, -14.799999999999981, -12.2, -3.3, -20.6, -7.800000000000001, -4.2, -4.2, -4.4, -20.400000000000006, -18.5, -3.3, -10.099999999999998, -8.299999999999999, -6.2, -54.2, -17.4, -33.80000000000002, -3.3, -21.1, -3.4, -22.200000000000085, -4.4, -10.9, -5.2, -13.799999999999981, -14.0, -8.599999999999998, -9.8, -17.700000000000003, -3.3, -8.2, -16.2, -9.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9301227724589765, "mean_inference_ms": 1.1878539727550201, "mean_action_processing_ms": 0.06535300245848473, "mean_env_wait_ms": 5.42857099714808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 696000, "timesteps_this_iter": 0, "agent_timesteps_total": 696000, "timers": {"sample_time_ms": 14915.763, "sample_throughput": 268.173, "load_time_ms": 0.348, "load_throughput": 11498331.848, "learn_time_ms": 6814.22, "learn_throughput": 587.008, "update_time_ms": 1.435}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0006591796875000002, "cur_lr": 0.00010000000000000003, "total_loss": 0.26047338231126227, "policy_loss": 0.002750352248849888, "vf_loss": 25.77205253852311, "vf_explained_var": 0.17848916701091233, "kl": 0.003808833880048963, "entropy": 0.09804463676948061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 696000, "num_agent_steps_sampled": 696000, "num_steps_trained": 696000, "num_agent_steps_trained": 696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6960, "training_iteration": 174, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-25-11", "timestamp": 1643667911, "time_this_iter_s": 14.552923917770386, "time_total_s": 2585.273497581482, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2585.273497581482, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 26.895, "ram_util_percent": 73.64499999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -54.2, "episode_reward_mean": -10.694, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.6, -7.8, -19.5, -5.9, -6.299999999999999, -8.3, -4.2, -5.300000000000001, -6.899999999999999, -3.3, -9.3, -11.2, -16.8, -10.099999999999998, -14.799999999999997, -12.799999999999997, -12.3, -17.5, -6.299999999999999, -9.899999999999999, -4.4, -29.300000000000015, -21.2, -20.90000000000001, -13.3, -9.3, -15.899999999999993, -14.799999999999981, -12.2, -3.3, -20.6, -7.800000000000001, -4.2, -4.2, -4.4, -20.400000000000006, -18.5, -3.3, -10.099999999999998, -8.299999999999999, -6.2, -54.2, -17.4, -33.80000000000002, -3.3, -21.1, -3.4, -22.200000000000085, -4.4, -10.9, -5.2, -13.799999999999981, -14.0, -8.599999999999998, -9.8, -17.700000000000003, -3.3, -8.2, -16.2, -9.0, -12.3, -4.300000000000001, -12.100000000000001, -12.2, -7.2, -11.399999999999999, -5.3, -3.4000000000000004, -19.699999999999985, -3.4, -4.2, -3.3, -4.2, -10.2, -10.7, -3.3, -3.4, -4.4, -6.2, -4.2, -4.800000000000001, -18.4, -11.399999999999999, -8.099999999999998, -8.699999999999998, -6.3, -5.3, -3.2, -3.3, -14.899999999999999, -10.5, -3.9000000000000004, -13.7, -3.7, -7.3, -8.5, -11.5, -17.3, -15.7, -18.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9299316844951445, "mean_inference_ms": 1.187875711221545, "mean_action_processing_ms": 0.06535116576507544, "mean_env_wait_ms": 5.428967400076012, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"sample_time_ms": 14702.149, "sample_throughput": 272.069, "load_time_ms": 0.346, "load_throughput": 11558536.686, "learn_time_ms": 6922.701, "learn_throughput": 577.809, "update_time_ms": 1.433}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.06239578137374533, "policy_loss": -0.005036079301749186, "vf_loss": 6.7426448196012485, "vf_explained_var": 0.2686329817900094, "kl": 0.016434823814831172, "entropy": 0.14322747820087017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 700000, "num_steps_trained": 700000, "num_agent_steps_trained": 700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7000, "training_iteration": 175, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-25-27", "timestamp": 1643667927, "time_this_iter_s": 16.4930477142334, "time_total_s": 2601.7665452957153, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2601.7665452957153, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 30.770833333333332, "ram_util_percent": 73.65833333333333}}
{"episode_reward_max": -2.2, "episode_reward_min": -81.60000000000008, "episode_reward_mean": -11.775000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -54.2, -17.4, -33.80000000000002, -3.3, -21.1, -3.4, -22.200000000000085, -4.4, -10.9, -5.2, -13.799999999999981, -14.0, -8.599999999999998, -9.8, -17.700000000000003, -3.3, -8.2, -16.2, -9.0, -12.3, -4.300000000000001, -12.100000000000001, -12.2, -7.2, -11.399999999999999, -5.3, -3.4000000000000004, -19.699999999999985, -3.4, -4.2, -3.3, -4.2, -10.2, -10.7, -3.3, -3.4, -4.4, -6.2, -4.2, -4.800000000000001, -18.4, -11.399999999999999, -8.099999999999998, -8.699999999999998, -6.3, -5.3, -3.2, -3.3, -14.899999999999999, -10.5, -3.9000000000000004, -13.7, -3.7, -7.3, -8.5, -11.5, -17.3, -15.7, -18.300000000000004, -15.5, -17.6, -22.5, -19.400000000000002, -6.4, -13.699999999999998, -10.599999999999998, -26.799999999999994, -13.5, -8.199999999999998, -7.300000000000001, -13.599999999999998, -6.3, -7.3, -16.9, -5.3, -81.60000000000008, -10.5, -14.099999999999998, -12.7, -15.899999999999999, -6.3, -10.9, -18.9, -13.399999999999974, -15.899999999999988, -12.899999999999999, -2.2, -4.9, -22.6, -4.2, -9.5, -20.299999999999997, -7.599999999999999, -14.699999999999989, -3.2, -12.199999999999996, -6.1000000000000005, -3.2, -19.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9300764194519247, "mean_inference_ms": 1.1882651955162624, "mean_action_processing_ms": 0.06537125215238834, "mean_env_wait_ms": 5.431209675403409, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 704000, "timesteps_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"sample_time_ms": 14934.069, "sample_throughput": 267.844, "load_time_ms": 0.35, "load_throughput": 11416178.552, "learn_time_ms": 6983.342, "learn_throughput": 572.792, "update_time_ms": 1.444}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.36437383951539154, "policy_loss": -0.014084444645672075, "vf_loss": 37.84540125189289, "vf_explained_var": 0.24622891455568294, "kl": 0.01299418354583483, "entropy": 0.14490858745831314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 704000, "num_agent_steps_sampled": 704000, "num_steps_trained": 704000, "num_agent_steps_trained": 704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7040, "training_iteration": 176, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-25-44", "timestamp": 1643667944, "time_this_iter_s": 16.387017965316772, "time_total_s": 2618.153563261032, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2618.153563261032, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 31.491304347826084, "ram_util_percent": 72.16086956521741}}
{"episode_reward_max": -2.2, "episode_reward_min": -81.60000000000008, "episode_reward_mean": -12.659, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.800000000000001, -18.4, -11.399999999999999, -8.099999999999998, -8.699999999999998, -6.3, -5.3, -3.2, -3.3, -14.899999999999999, -10.5, -3.9000000000000004, -13.7, -3.7, -7.3, -8.5, -11.5, -17.3, -15.7, -18.300000000000004, -15.5, -17.6, -22.5, -19.400000000000002, -6.4, -13.699999999999998, -10.599999999999998, -26.799999999999994, -13.5, -8.199999999999998, -7.300000000000001, -13.599999999999998, -6.3, -7.3, -16.9, -5.3, -81.60000000000008, -10.5, -14.099999999999998, -12.7, -15.899999999999999, -6.3, -10.9, -18.9, -13.399999999999974, -15.899999999999988, -12.899999999999999, -2.2, -4.9, -22.6, -4.2, -9.5, -20.299999999999997, -7.599999999999999, -14.699999999999989, -3.2, -12.199999999999996, -6.1000000000000005, -3.2, -19.9, -23.8, -5.3, -28.70000000000003, -6.3, -7.199999999999999, -10.7, -6.3, -16.5, -6.3, -6.300000000000001, -15.399999999999997, -19.1, -4.2, -3.3, -14.399999999999999, -7.3, -7.899999999999999, -10.999999999999998, -12.399999999999999, -10.9, -20.10000000000005, -6.1, -3.3, -9.899999999999999, -18.199999999999996, -32.2, -11.099999999999998, -24.9, -10.1, -7.3, -18.0, -10.899999999999997, -4.6000000000000005, -26.2, -17.6, -19.2, -8.599999999999998, -16.9, -15.7, -12.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9301568889211207, "mean_inference_ms": 1.1886019072627463, "mean_action_processing_ms": 0.06538873326670645, "mean_env_wait_ms": 5.4329815484389465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 708000, "timesteps_this_iter": 0, "agent_timesteps_total": 708000, "timers": {"sample_time_ms": 14968.099, "sample_throughput": 267.235, "load_time_ms": 0.352, "load_throughput": 11355906.322, "learn_time_ms": 7002.258, "learn_throughput": 571.244, "update_time_ms": 1.455}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.1462089062528184, "policy_loss": -0.010978644007756826, "vf_loss": 15.71847687639216, "vf_explained_var": 0.13899060865884186, "kl": 0.008450852480928223, "entropy": 0.14214460649076968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 708000, "num_agent_steps_sampled": 708000, "num_steps_trained": 708000, "num_agent_steps_trained": 708000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7080, "training_iteration": 177, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-25-58", "timestamp": 1643667958, "time_this_iter_s": 14.646200895309448, "time_total_s": 2632.7997641563416, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2632.7997641563416, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 27.15238095238095, "ram_util_percent": 70.9952380952381}}
{"episode_reward_max": -2.2, "episode_reward_min": -47.8, "episode_reward_mean": -11.706000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.899999999999999, -6.3, -10.9, -18.9, -13.399999999999974, -15.899999999999988, -12.899999999999999, -2.2, -4.9, -22.6, -4.2, -9.5, -20.299999999999997, -7.599999999999999, -14.699999999999989, -3.2, -12.199999999999996, -6.1000000000000005, -3.2, -19.9, -23.8, -5.3, -28.70000000000003, -6.3, -7.199999999999999, -10.7, -6.3, -16.5, -6.3, -6.300000000000001, -15.399999999999997, -19.1, -4.2, -3.3, -14.399999999999999, -7.3, -7.899999999999999, -10.999999999999998, -12.399999999999999, -10.9, -20.10000000000005, -6.1, -3.3, -9.899999999999999, -18.199999999999996, -32.2, -11.099999999999998, -24.9, -10.1, -7.3, -18.0, -10.899999999999997, -4.6000000000000005, -26.2, -17.6, -19.2, -8.599999999999998, -16.9, -15.7, -12.3, -17.69999999999999, -7.4, -19.4, -9.499999999999998, -14.7, -18.699999999999996, -5.3, -34.200000000000024, -4.3, -6.300000000000001, -4.3, -4.300000000000001, -4.2, -13.3, -5.300000000000001, -4.4, -3.3, -13.499999999999996, -4.2, -8.3, -9.599999999999998, -2.6000000000000005, -3.4, -5.2, -9.3, -13.399999999999999, -15.699999999999998, -10.299999999999995, -7.3, -6.2, -47.8, -10.3, -14.199999999999982, -15.9, -7.399999999999999, -9.600000000000001, -8.4, -10.4, -4.3, -15.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.929999966382602, "mean_inference_ms": 1.188681046066397, "mean_action_processing_ms": 0.06539180649465487, "mean_env_wait_ms": 5.43350212483257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 712000, "timesteps_this_iter": 0, "agent_timesteps_total": 712000, "timers": {"sample_time_ms": 14999.77, "sample_throughput": 266.671, "load_time_ms": 0.348, "load_throughput": 11479449.88, "learn_time_ms": 6946.465, "learn_throughput": 575.832, "update_time_ms": 1.459}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.13778864383617395, "policy_loss": -0.009979201237400693, "vf_loss": 14.776260596385566, "vf_explained_var": 0.23116931082099998, "kl": 0.015915128835508493, "entropy": 0.1412229827735373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 712000, "num_agent_steps_sampled": 712000, "num_steps_trained": 712000, "num_agent_steps_trained": 712000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7120, "training_iteration": 178, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-26-13", "timestamp": 1643667973, "time_this_iter_s": 14.353569984436035, "time_total_s": 2647.1533341407776, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2647.1533341407776, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 24.349999999999998, "ram_util_percent": 71.0}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -47.8, "episode_reward_mean": -11.493, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.10000000000005, -6.1, -3.3, -9.899999999999999, -18.199999999999996, -32.2, -11.099999999999998, -24.9, -10.1, -7.3, -18.0, -10.899999999999997, -4.6000000000000005, -26.2, -17.6, -19.2, -8.599999999999998, -16.9, -15.7, -12.3, -17.69999999999999, -7.4, -19.4, -9.499999999999998, -14.7, -18.699999999999996, -5.3, -34.200000000000024, -4.3, -6.300000000000001, -4.3, -4.300000000000001, -4.2, -13.3, -5.300000000000001, -4.4, -3.3, -13.499999999999996, -4.2, -8.3, -9.599999999999998, -2.6000000000000005, -3.4, -5.2, -9.3, -13.399999999999999, -15.699999999999998, -10.299999999999995, -7.3, -6.2, -47.8, -10.3, -14.199999999999982, -15.9, -7.399999999999999, -9.600000000000001, -8.4, -10.4, -4.3, -15.399999999999999, -16.099999999999998, -15.399999999999997, -14.099999999999996, -13.899999999999997, -5.800000000000001, -17.200000000000003, -5.3, -14.6, -8.699999999999994, -6.8999999999999995, -12.599999999999998, -18.799999999999997, -3.2, -7.300000000000001, -4.3, -6.6000000000000005, -5.3, -7.2, -5.2, -11.399999999999997, -12.0, -11.100000000000001, -3.3, -16.0, -6.2, -7.2, -17.5, -11.7, -20.8, -6.699999999999999, -5.500000000000001, -7.8, -20.4, -13.6, -13.7, -14.5, -7.2, -4.2, -19.5, -7.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9298303509811866, "mean_inference_ms": 1.1885332356108962, "mean_action_processing_ms": 0.06538212614673926, "mean_env_wait_ms": 5.432928293895668, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 716000, "timesteps_this_iter": 0, "agent_timesteps_total": 716000, "timers": {"sample_time_ms": 14965.413, "sample_throughput": 267.283, "load_time_ms": 0.349, "load_throughput": 11476308.913, "learn_time_ms": 6987.87, "learn_throughput": 572.42, "update_time_ms": 1.45}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.0692326245829463, "policy_loss": 0.004396022509743449, "vf_loss": 6.483386966425885, "vf_explained_var": 0.20026746757568853, "kl": 0.008297101210902637, "entropy": 0.16337640731725642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 716000, "num_agent_steps_sampled": 716000, "num_steps_trained": 716000, "num_agent_steps_trained": 716000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7160, "training_iteration": 179, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-26-28", "timestamp": 1643667988, "time_this_iter_s": 14.842243194580078, "time_total_s": 2661.9955773353577, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2661.9955773353577, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 28.05454545454545, "ram_util_percent": 71.0}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -47.8, "episode_reward_mean": -10.340999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.599999999999998, -2.6000000000000005, -3.4, -5.2, -9.3, -13.399999999999999, -15.699999999999998, -10.299999999999995, -7.3, -6.2, -47.8, -10.3, -14.199999999999982, -15.9, -7.399999999999999, -9.600000000000001, -8.4, -10.4, -4.3, -15.399999999999999, -16.099999999999998, -15.399999999999997, -14.099999999999996, -13.899999999999997, -5.800000000000001, -17.200000000000003, -5.3, -14.6, -8.699999999999994, -6.8999999999999995, -12.599999999999998, -18.799999999999997, -3.2, -7.300000000000001, -4.3, -6.6000000000000005, -5.3, -7.2, -5.2, -11.399999999999997, -12.0, -11.100000000000001, -3.3, -16.0, -6.2, -7.2, -17.5, -11.7, -20.8, -6.699999999999999, -5.500000000000001, -7.8, -20.4, -13.6, -13.7, -14.5, -7.2, -4.2, -19.5, -7.999999999999998, -16.299999999999997, -10.600000000000001, -3.3, -9.999999999999998, -3.3, -13.299999999999995, -19.2, -4.3, -16.399999999999984, -11.499999999999998, -17.0, -6.3, -12.3, -4.300000000000001, -9.4, -11.999999999999998, -11.6, -4.3, -11.1, -15.7, -6.2, -6.500000000000001, -5.300000000000001, -10.3, -5.3, -8.3, -4.300000000000001, -15.8, -11.2, -7.800000000000001, -5.3, -4.300000000000001, -5.300000000000001, -6.300000000000001, -14.499999999999995, -20.999999999999996, -4.4, -12.799999999999999, -8.2, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9298869428250586, "mean_inference_ms": 1.1884166270111118, "mean_action_processing_ms": 0.06537330904961086, "mean_env_wait_ms": 5.432608520640955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 15027.319, "sample_throughput": 266.182, "load_time_ms": 0.351, "load_throughput": 11396016.846, "learn_time_ms": 7035.436, "learn_throughput": 568.55, "update_time_ms": 1.438}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.052678291209202296, "policy_loss": -0.008658259290380664, "vf_loss": 6.133407901371679, "vf_explained_var": 0.4120009486393262, "kl": 0.007508668662573229, "entropy": 0.16690054970082416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7200, "training_iteration": 180, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-26-43", "timestamp": 1643668003, "time_this_iter_s": 15.197896003723145, "time_total_s": 2677.193473339081, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2677.193473339081, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 28.985714285714295, "ram_util_percent": 71.0}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.3, "episode_reward_mean": -10.54, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -11.100000000000001, -3.3, -16.0, -6.2, -7.2, -17.5, -11.7, -20.8, -6.699999999999999, -5.500000000000001, -7.8, -20.4, -13.6, -13.7, -14.5, -7.2, -4.2, -19.5, -7.999999999999998, -16.299999999999997, -10.600000000000001, -3.3, -9.999999999999998, -3.3, -13.299999999999995, -19.2, -4.3, -16.399999999999984, -11.499999999999998, -17.0, -6.3, -12.3, -4.300000000000001, -9.4, -11.999999999999998, -11.6, -4.3, -11.1, -15.7, -6.2, -6.500000000000001, -5.300000000000001, -10.3, -5.3, -8.3, -4.300000000000001, -15.8, -11.2, -7.800000000000001, -5.3, -4.300000000000001, -5.300000000000001, -6.300000000000001, -14.499999999999995, -20.999999999999996, -4.4, -12.799999999999999, -8.2, -5.3, -14.099999999999998, -3.3, -8.8, -19.3, -4.2, -6.2, -5.699999999999999, -6.5, -8.999999999999991, -18.3, -11.8, -13.7, -8.699999999999998, -15.799999999999999, -19.0, -3.2, -4.300000000000001, -6.8, -3.3, -11.3, -10.399999999999999, -7.3999999999999995, -9.2, -13.0, -13.399999999999999, -10.799999999999999, -15.399999999999997, -7.799999999999998, -12.19999999999997, -4.300000000000001, -20.8, -14.2, -16.2, -15.599999999999998, -38.3, -13.2, -8.0, -5.300000000000001, -13.499999999999998, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9298387928162447, "mean_inference_ms": 1.1883972263217746, "mean_action_processing_ms": 0.06536758434927804, "mean_env_wait_ms": 5.432637191771182, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 724000, "timesteps_this_iter": 0, "agent_timesteps_total": 724000, "timers": {"sample_time_ms": 15080.546, "sample_throughput": 265.242, "load_time_ms": 0.351, "load_throughput": 11399114.01, "learn_time_ms": 7086.775, "learn_throughput": 564.432, "update_time_ms": 1.452}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.11469281864332496, "policy_loss": -0.00854323840429706, "vf_loss": 12.323251489734137, "vf_explained_var": 0.32383565652755, "kl": 0.010754048975247368, "entropy": 0.13465116588819412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 724000, "num_agent_steps_sampled": 724000, "num_steps_trained": 724000, "num_agent_steps_trained": 724000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7240, "training_iteration": 181, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-26-58", "timestamp": 1643668018, "time_this_iter_s": 15.277673959732056, "time_total_s": 2692.471147298813, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2692.471147298813, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 28.663636363636364, "ram_util_percent": 71.09090909090907}}
{"episode_reward_max": 0.0, "episode_reward_min": -38.3, "episode_reward_mean": -10.591999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -6.500000000000001, -5.300000000000001, -10.3, -5.3, -8.3, -4.300000000000001, -15.8, -11.2, -7.800000000000001, -5.3, -4.300000000000001, -5.300000000000001, -6.300000000000001, -14.499999999999995, -20.999999999999996, -4.4, -12.799999999999999, -8.2, -5.3, -14.099999999999998, -3.3, -8.8, -19.3, -4.2, -6.2, -5.699999999999999, -6.5, -8.999999999999991, -18.3, -11.8, -13.7, -8.699999999999998, -15.799999999999999, -19.0, -3.2, -4.300000000000001, -6.8, -3.3, -11.3, -10.399999999999999, -7.3999999999999995, -9.2, -13.0, -13.399999999999999, -10.799999999999999, -15.399999999999997, -7.799999999999998, -12.19999999999997, -4.300000000000001, -20.8, -14.2, -16.2, -15.599999999999998, -38.3, -13.2, -8.0, -5.300000000000001, -13.499999999999998, -4.2, -13.3, -3.3, -14.499999999999986, 0.0, -7.2, -14.899999999999999, -8.999999999999996, -15.2, -4.2, -6.999999999999999, -9.6, -18.6, -3.2, -5.2, -15.1, -19.700000000000003, -20.4, -15.2, -11.499999999999998, -10.399999999999999, -4.2, -15.7, -4.800000000000001, -3.2, -3.3, -6.300000000000001, -4.2, -22.199999999999996, -25.5, -8.3, -6.4, -15.299999999999997, -11.799999999999999, -5.1000000000000005, -14.599999999999996, -6.399999999999999, -21.2, -8.9, -25.3, -14.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.929825943512261, "mean_inference_ms": 1.1883825820346852, "mean_action_processing_ms": 0.06536345729533331, "mean_env_wait_ms": 5.432704266596647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 728000, "timesteps_this_iter": 0, "agent_timesteps_total": 728000, "timers": {"sample_time_ms": 15138.009, "sample_throughput": 264.236, "load_time_ms": 0.351, "load_throughput": 11386735.442, "learn_time_ms": 7164.102, "learn_throughput": 558.339, "update_time_ms": 1.491}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.11128007157916023, "policy_loss": -0.01111414448648531, "vf_loss": 12.238911521691149, "vf_explained_var": 0.23646243618380638, "kl": 0.015496328467336984, "entropy": 0.14651233265476843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 728000, "num_agent_steps_sampled": 728000, "num_steps_trained": 728000, "num_agent_steps_trained": 728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7280, "training_iteration": 182, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-27-14", "timestamp": 1643668034, "time_this_iter_s": 15.409177780151367, "time_total_s": 2707.8803250789642, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2707.8803250789642, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 25.231818181818177, "ram_util_percent": 71.14545454545456}}
{"episode_reward_max": 0.0, "episode_reward_min": -77.7, "episode_reward_mean": -11.864999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.399999999999999, -7.3999999999999995, -9.2, -13.0, -13.399999999999999, -10.799999999999999, -15.399999999999997, -7.799999999999998, -12.19999999999997, -4.300000000000001, -20.8, -14.2, -16.2, -15.599999999999998, -38.3, -13.2, -8.0, -5.300000000000001, -13.499999999999998, -4.2, -13.3, -3.3, -14.499999999999986, 0.0, -7.2, -14.899999999999999, -8.999999999999996, -15.2, -4.2, -6.999999999999999, -9.6, -18.6, -3.2, -5.2, -15.1, -19.700000000000003, -20.4, -15.2, -11.499999999999998, -10.399999999999999, -4.2, -15.7, -4.800000000000001, -3.2, -3.3, -6.300000000000001, -4.2, -22.199999999999996, -25.5, -8.3, -6.4, -15.299999999999997, -11.799999999999999, -5.1000000000000005, -14.599999999999996, -6.399999999999999, -21.2, -8.9, -25.3, -14.1, -4.3, -6.099999999999999, -14.799999999999988, -17.9, -10.0, -17.6, -23.800000000000008, -5.2, -4.2, -6.4, -6.3999999999999995, -15.1, -3.2, -14.399999999999999, -15.699999999999998, -3.2, -8.3, -15.699999999999998, -8.3, -7.2, -21.399999999999988, -3.3, -5.6, -8.3, -12.899999999999999, -3.3, -8.899999999999999, -4.3, -77.7, -15.4, -3.3, -4.300000000000001, -11.799999999999999, -10.5, -7.799999999999998, -16.9, -11.0, -14.099999999999994, -9.099999999999998, -31.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9299052335539872, "mean_inference_ms": 1.188400861489068, "mean_action_processing_ms": 0.06536275186370531, "mean_env_wait_ms": 5.432652237045995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 732000, "timesteps_this_iter": 0, "agent_timesteps_total": 732000, "timers": {"sample_time_ms": 15211.52, "sample_throughput": 262.959, "load_time_ms": 0.356, "load_throughput": 11238003.885, "learn_time_ms": 7229.348, "learn_throughput": 553.3, "update_time_ms": 1.522}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.3350292552868405, "policy_loss": -0.007672129111785081, "vf_loss": 34.26960060981012, "vf_explained_var": 0.15985563615316986, "kl": 0.016341543528439455, "entropy": 0.16569331114891395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 732000, "num_agent_steps_sampled": 732000, "num_steps_trained": 732000, "num_agent_steps_trained": 732000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7320, "training_iteration": 183, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-27-29", "timestamp": 1643668049, "time_this_iter_s": 15.269772052764893, "time_total_s": 2723.150097131729, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2723.150097131729, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 27.109090909090913, "ram_util_percent": 71.21363636363638}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -89.69999999999992, "episode_reward_mean": -11.597000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -15.7, -4.800000000000001, -3.2, -3.3, -6.300000000000001, -4.2, -22.199999999999996, -25.5, -8.3, -6.4, -15.299999999999997, -11.799999999999999, -5.1000000000000005, -14.599999999999996, -6.399999999999999, -21.2, -8.9, -25.3, -14.1, -4.3, -6.099999999999999, -14.799999999999988, -17.9, -10.0, -17.6, -23.800000000000008, -5.2, -4.2, -6.4, -6.3999999999999995, -15.1, -3.2, -14.399999999999999, -15.699999999999998, -3.2, -8.3, -15.699999999999998, -8.3, -7.2, -21.399999999999988, -3.3, -5.6, -8.3, -12.899999999999999, -3.3, -8.899999999999999, -4.3, -77.7, -15.4, -3.3, -4.300000000000001, -11.799999999999999, -10.5, -7.799999999999998, -16.9, -11.0, -14.099999999999994, -9.099999999999998, -31.3, -6.5, -5.2, -6.2, -2.7000000000000006, -89.69999999999992, -13.7, -10.9, -4.3, -4.300000000000001, -10.2, -14.3, -4.3, -7.2, -13.499999999999995, -9.899999999999999, -5.8, -19.900000000000006, -4.3, -12.3, -3.3, -4.2, -17.999999999999993, -4.2, -12.700000000000001, -14.9, -14.2, -8.2, -8.6, -20.5, -9.799999999999999, -7.2, -3.3, -3.2, -3.2, -9.3, -8.3, -3.3, -12.699999999999987, -14.899999999999999, -14.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9300766027756717, "mean_inference_ms": 1.1884663303271181, "mean_action_processing_ms": 0.06536707683845686, "mean_env_wait_ms": 5.432836657376527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 736000, "timesteps_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"sample_time_ms": 15310.619, "sample_throughput": 261.257, "load_time_ms": 0.349, "load_throughput": 11452024.573, "learn_time_ms": 7313.45, "learn_throughput": 546.938, "update_time_ms": 1.552}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.37920552580792616, "policy_loss": -0.0006056513857617173, "vf_loss": 37.9808183948199, "vf_explained_var": 0.037307919545840194, "kl": 0.009109667071019423, "entropy": 0.1450614388791784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 736000, "num_agent_steps_sampled": 736000, "num_steps_trained": 736000, "num_agent_steps_trained": 736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7360, "training_iteration": 184, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-27-45", "timestamp": 1643668065, "time_this_iter_s": 15.750464677810669, "time_total_s": 2738.90056180954, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2738.90056180954, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 24.05, "ram_util_percent": 71.28181818181818}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -89.69999999999992, "episode_reward_mean": -11.693, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.399999999999988, -3.3, -5.6, -8.3, -12.899999999999999, -3.3, -8.899999999999999, -4.3, -77.7, -15.4, -3.3, -4.300000000000001, -11.799999999999999, -10.5, -7.799999999999998, -16.9, -11.0, -14.099999999999994, -9.099999999999998, -31.3, -6.5, -5.2, -6.2, -2.7000000000000006, -89.69999999999992, -13.7, -10.9, -4.3, -4.300000000000001, -10.2, -14.3, -4.3, -7.2, -13.499999999999995, -9.899999999999999, -5.8, -19.900000000000006, -4.3, -12.3, -3.3, -4.2, -17.999999999999993, -4.2, -12.700000000000001, -14.9, -14.2, -8.2, -8.6, -20.5, -9.799999999999999, -7.2, -3.3, -3.2, -3.2, -9.3, -8.3, -3.3, -12.699999999999987, -14.899999999999999, -14.7, -3.3, -12.700000000000001, -8.599999999999998, -4.2, -13.39999999999999, -8.2, -14.999999999999998, -13.499999999999998, -12.499999999999996, -12.099999999999996, -9.299999999999999, -14.7, -9.2, -17.799999999999997, -3.2, -5.300000000000001, -21.1, -12.699999999999998, -3.2, -21.599999999999998, -7.2, -15.1, -3.3, -20.5, -3.2, -5.799999999999999, -17.700000000000006, -3.2, -10.399999999999999, -3.2, -9.799999999999999, -22.500000000000004, -4.300000000000001, -8.399999999999999, -23.1, -19.699999999999996, -17.0, -17.2, -4.4, -6.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9305708992906352, "mean_inference_ms": 1.1885594786878237, "mean_action_processing_ms": 0.06537289318239015, "mean_env_wait_ms": 5.433060394041941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"sample_time_ms": 15398.853, "sample_throughput": 259.76, "load_time_ms": 0.35, "load_throughput": 11444212.824, "learn_time_ms": 7221.599, "learn_throughput": 553.894, "update_time_ms": 1.55}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.08775934417561818, "policy_loss": -0.0006704263744615419, "vf_loss": 8.842706271845808, "vf_explained_var": 0.33547519817147203, "kl": 0.00823175647535402, "entropy": 0.14300251197750852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 740000, "num_steps_trained": 740000, "num_agent_steps_trained": 740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7400, "training_iteration": 185, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-28-00", "timestamp": 1643668080, "time_this_iter_s": 15.644800901412964, "time_total_s": 2754.5453627109528, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2754.5453627109528, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 25.55, "ram_util_percent": 71.90000000000003}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -29.900000000000006, "episode_reward_mean": -10.474, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -17.999999999999993, -4.2, -12.700000000000001, -14.9, -14.2, -8.2, -8.6, -20.5, -9.799999999999999, -7.2, -3.3, -3.2, -3.2, -9.3, -8.3, -3.3, -12.699999999999987, -14.899999999999999, -14.7, -3.3, -12.700000000000001, -8.599999999999998, -4.2, -13.39999999999999, -8.2, -14.999999999999998, -13.499999999999998, -12.499999999999996, -12.099999999999996, -9.299999999999999, -14.7, -9.2, -17.799999999999997, -3.2, -5.300000000000001, -21.1, -12.699999999999998, -3.2, -21.599999999999998, -7.2, -15.1, -3.3, -20.5, -3.2, -5.799999999999999, -17.700000000000006, -3.2, -10.399999999999999, -3.2, -9.799999999999999, -22.500000000000004, -4.300000000000001, -8.399999999999999, -23.1, -19.699999999999996, -17.0, -17.2, -4.4, -6.6000000000000005, -12.999999999999998, -14.199999999999996, -3.2, -4.2, -10.499999999999998, -8.5, -5.2, -16.2, -3.2, -4.300000000000001, -16.599999999999994, -29.900000000000006, -4.300000000000001, -4.2, -2.3000000000000003, -9.499999999999998, -9.3, -17.300000000000004, -3.2, -14.700000000000001, -20.599999999999998, -12.09999999999999, -20.200000000000003, -3.3, -14.7, -2.5, -12.7, -5.699999999999999, -4.2, -7.5, -11.7, -7.799999999999998, -9.199999999999998, -5.300000000000001, -19.599999999999998, -21.900000000000002, -20.70000000000001, -3.2, -7.8999999999999995, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9308906845046059, "mean_inference_ms": 1.188598713007756, "mean_action_processing_ms": 0.0653748442883315, "mean_env_wait_ms": 5.432965334191098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 744000, "timesteps_this_iter": 0, "agent_timesteps_total": 744000, "timers": {"sample_time_ms": 15189.309, "sample_throughput": 263.343, "load_time_ms": 0.349, "load_throughput": 11464545.579, "learn_time_ms": 7217.378, "learn_throughput": 554.218, "update_time_ms": 1.538}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.10439546267021327, "policy_loss": -0.01209327374454788, "vf_loss": 11.64831616724691, "vf_explained_var": 0.22009826719119985, "kl": 0.016928458658822726, "entropy": 0.143262936078733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 744000, "num_agent_steps_sampled": 744000, "num_steps_trained": 744000, "num_agent_steps_trained": 744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7440, "training_iteration": 186, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-28-16", "timestamp": 1643668096, "time_this_iter_s": 15.14662790298462, "time_total_s": 2769.6919906139374, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2769.6919906139374, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 20.272727272727273, "ram_util_percent": 71.98636363636363}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -83.4, "episode_reward_mean": -11.502, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -15.1, -3.3, -20.5, -3.2, -5.799999999999999, -17.700000000000006, -3.2, -10.399999999999999, -3.2, -9.799999999999999, -22.500000000000004, -4.300000000000001, -8.399999999999999, -23.1, -19.699999999999996, -17.0, -17.2, -4.4, -6.6000000000000005, -12.999999999999998, -14.199999999999996, -3.2, -4.2, -10.499999999999998, -8.5, -5.2, -16.2, -3.2, -4.300000000000001, -16.599999999999994, -29.900000000000006, -4.300000000000001, -4.2, -2.3000000000000003, -9.499999999999998, -9.3, -17.300000000000004, -3.2, -14.700000000000001, -20.599999999999998, -12.09999999999999, -20.200000000000003, -3.3, -14.7, -2.5, -12.7, -5.699999999999999, -4.2, -7.5, -11.7, -7.799999999999998, -9.199999999999998, -5.300000000000001, -19.599999999999998, -21.900000000000002, -20.70000000000001, -3.2, -7.8999999999999995, -3.2, -9.299999999999999, -8.700000000000001, -3.3, -11.599999999999998, -38.5, -3.2, -33.4, -14.5, -7.2, -15.3, -8.2, -13.3, -4.300000000000001, -3.3, -25.699999999999996, -8.5, -15.499999999999996, -9.2, -9.2, -7.2, -18.6, -3.2, -3.2, -12.299999999999997, -10.899999999999999, -25.2, -83.4, -16.5, -6.2, -3.3, -11.399999999999999, -15.7, -22.199999999999996, -3.2, -4.300000000000001, -3.2, -4.2, -15.899999999999999, -4.2, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9308911850215525, "mean_inference_ms": 1.1886660967135652, "mean_action_processing_ms": 0.06537755496531704, "mean_env_wait_ms": 5.433270380273962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 748000, "timesteps_this_iter": 0, "agent_timesteps_total": 748000, "timers": {"sample_time_ms": 15236.862, "sample_throughput": 262.521, "load_time_ms": 0.355, "load_throughput": 11269709.142, "learn_time_ms": 7253.459, "learn_throughput": 551.461, "update_time_ms": 1.543}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.4718710752584601, "policy_loss": -0.007723836570737824, "vf_loss": 47.95910873663041, "vf_explained_var": 0.05762836933135986, "kl": 0.011651664434188604, "entropy": 0.16611416816951768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 748000, "num_agent_steps_sampled": 748000, "num_steps_trained": 748000, "num_agent_steps_trained": 748000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7480, "training_iteration": 187, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-28-31", "timestamp": 1643668111, "time_this_iter_s": 15.526407957077026, "time_total_s": 2785.2183985710144, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2785.2183985710144, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 21.840909090909093, "ram_util_percent": 72.09545454545452}}
{"episode_reward_max": -2.5, "episode_reward_min": -83.4, "episode_reward_mean": -12.157, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.599999999999998, -12.09999999999999, -20.200000000000003, -3.3, -14.7, -2.5, -12.7, -5.699999999999999, -4.2, -7.5, -11.7, -7.799999999999998, -9.199999999999998, -5.300000000000001, -19.599999999999998, -21.900000000000002, -20.70000000000001, -3.2, -7.8999999999999995, -3.2, -9.299999999999999, -8.700000000000001, -3.3, -11.599999999999998, -38.5, -3.2, -33.4, -14.5, -7.2, -15.3, -8.2, -13.3, -4.300000000000001, -3.3, -25.699999999999996, -8.5, -15.499999999999996, -9.2, -9.2, -7.2, -18.6, -3.2, -3.2, -12.299999999999997, -10.899999999999999, -25.2, -83.4, -16.5, -6.2, -3.3, -11.399999999999999, -15.7, -22.199999999999996, -3.2, -4.300000000000001, -3.2, -4.2, -15.899999999999999, -4.2, -3.3, -5.4, -8.899999999999999, -10.499999999999996, -7.2, -30.600000000000037, -8.2, -13.099999999999996, -50.3, -10.499999999999998, -7.3, -20.799999999999997, -14.299999999999999, -5.3, -8.5, -10.799999999999999, -8.799999999999999, -3.2, -27.000000000000007, -6.3, -4.700000000000001, -17.799999999999997, -10.2, -5.300000000000001, -16.4, -3.2, -13.9, -3.2, -6.2, -12.7, -26.700000000000003, -7.2, -4.2, -14.3, -7.7, -8.4, -20.0, -19.799999999999997, -16.4, -3.3, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9305681992631013, "mean_inference_ms": 1.1887393230614172, "mean_action_processing_ms": 0.06538272918037186, "mean_env_wait_ms": 5.433774522343481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 752000, "timesteps_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"sample_time_ms": 15291.901, "sample_throughput": 261.576, "load_time_ms": 0.358, "load_throughput": 11185556.37, "learn_time_ms": 7364.097, "learn_throughput": 543.176, "update_time_ms": 1.578}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.2128342124853804, "policy_loss": -0.0036323613977880887, "vf_loss": 21.64639701971444, "vf_explained_var": 0.19231802359704048, "kl": 0.007924747475252143, "entropy": 0.16180564009294074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 752000, "num_agent_steps_sampled": 752000, "num_steps_trained": 752000, "num_agent_steps_trained": 752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7520, "training_iteration": 188, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-28-47", "timestamp": 1643668127, "time_this_iter_s": 15.67807912826538, "time_total_s": 2800.89647769928, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2800.89647769928, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 28.540909090909096, "ram_util_percent": 72.1090909090909}}
{"episode_reward_max": -2.2, "episode_reward_min": -83.4, "episode_reward_mean": -12.044, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.6, -3.2, -3.2, -12.299999999999997, -10.899999999999999, -25.2, -83.4, -16.5, -6.2, -3.3, -11.399999999999999, -15.7, -22.199999999999996, -3.2, -4.300000000000001, -3.2, -4.2, -15.899999999999999, -4.2, -3.3, -5.4, -8.899999999999999, -10.499999999999996, -7.2, -30.600000000000037, -8.2, -13.099999999999996, -50.3, -10.499999999999998, -7.3, -20.799999999999997, -14.299999999999999, -5.3, -8.5, -10.799999999999999, -8.799999999999999, -3.2, -27.000000000000007, -6.3, -4.700000000000001, -17.799999999999997, -10.2, -5.300000000000001, -16.4, -3.2, -13.9, -3.2, -6.2, -12.7, -26.700000000000003, -7.2, -4.2, -14.3, -7.7, -8.4, -20.0, -19.799999999999997, -16.4, -3.3, -3.3, -25.200000000000003, -19.4, -13.599999999999998, -3.3, -16.6, -8.3, -17.099999999999998, -24.900000000000002, -2.2, -3.3, -6.3999999999999995, -11.2, -3.3, -20.9, -9.7, -8.5, -6.999999999999998, -3.7000000000000006, -14.399999999999997, -11.3, -4.2, -12.3, -19.799999999999997, -14.799999999999999, -3.3, -7.2, -4.300000000000001, -23.999999999999996, -20.799999999999997, -16.3, -4.2, -12.499999999999998, -16.099999999999998, -17.2, -3.4, -4.300000000000001, -4.3, -10.2, -18.3, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9303797847614078, "mean_inference_ms": 1.1888872115827207, "mean_action_processing_ms": 0.06539153116708796, "mean_env_wait_ms": 5.434544860626909, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 756000, "timesteps_this_iter": 0, "agent_timesteps_total": 756000, "timers": {"sample_time_ms": 15458.32, "sample_throughput": 258.76, "load_time_ms": 0.361, "load_throughput": 11074800.977, "learn_time_ms": 7396.179, "learn_throughput": 540.82, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.08439799696257118, "policy_loss": -0.008085778973475899, "vf_loss": 9.24816941692624, "vf_explained_var": 0.26640871429956087, "kl": 0.006333168778277183, "entropy": 0.14141244192517574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 756000, "num_agent_steps_sampled": 756000, "num_steps_trained": 756000, "num_agent_steps_trained": 756000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7560, "training_iteration": 189, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-29-03", "timestamp": 1643668143, "time_this_iter_s": 15.747351169586182, "time_total_s": 2816.643828868866, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2816.643828868866, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 28.069565217391297, "ram_util_percent": 72.37826086956522}}
{"episode_reward_max": -2.2, "episode_reward_min": -39.3, "episode_reward_mean": -11.232999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.799999999999997, -10.2, -5.300000000000001, -16.4, -3.2, -13.9, -3.2, -6.2, -12.7, -26.700000000000003, -7.2, -4.2, -14.3, -7.7, -8.4, -20.0, -19.799999999999997, -16.4, -3.3, -3.3, -25.200000000000003, -19.4, -13.599999999999998, -3.3, -16.6, -8.3, -17.099999999999998, -24.900000000000002, -2.2, -3.3, -6.3999999999999995, -11.2, -3.3, -20.9, -9.7, -8.5, -6.999999999999998, -3.7000000000000006, -14.399999999999997, -11.3, -4.2, -12.3, -19.799999999999997, -14.799999999999999, -3.3, -7.2, -4.300000000000001, -23.999999999999996, -20.799999999999997, -16.3, -4.2, -12.499999999999998, -16.099999999999998, -17.2, -3.4, -4.300000000000001, -4.3, -10.2, -18.3, -4.3, -5.2, -17.4, -3.3, -4.2, -19.6, -4.8999999999999995, -8.4, -6.300000000000001, -6.5, -12.899999999999999, -4.2, -11.099999999999996, -8.2, -4.499999999999998, -28.6, -14.399999999999997, -3.3, -6.300000000000001, -7.499999999999999, -3.3, -20.700000000000003, -16.799999999999997, -4.200000000000001, -12.3, -21.2, -3.2, -20.1, -7.3, -4.2, -11.600000000000001, -39.3, -15.999999999999998, -19.3, -11.899999999999999, -4.3, -16.3, -16.2, -17.5, -4.2, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9302853897216592, "mean_inference_ms": 1.1890620105566299, "mean_action_processing_ms": 0.06540110908096115, "mean_env_wait_ms": 5.435276758161669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"sample_time_ms": 15501.773, "sample_throughput": 258.035, "load_time_ms": 0.358, "load_throughput": 11160258.099, "learn_time_ms": 7418.125, "learn_throughput": 539.22, "update_time_ms": 1.612}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.14534893941424626, "policy_loss": -0.008333296378854141, "vf_loss": 15.368001791514375, "vf_explained_var": 0.20281657377878826, "kl": 0.006740186052700812, "entropy": 0.14424521703954024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 760000, "num_steps_trained": 760000, "num_agent_steps_trained": 760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7600, "training_iteration": 190, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-29-18", "timestamp": 1643668158, "time_this_iter_s": 15.528311014175415, "time_total_s": 2832.1721398830414, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2832.1721398830414, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 28.45, "ram_util_percent": 72.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -39.3, "episode_reward_mean": -10.853999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -12.3, -19.799999999999997, -14.799999999999999, -3.3, -7.2, -4.300000000000001, -23.999999999999996, -20.799999999999997, -16.3, -4.2, -12.499999999999998, -16.099999999999998, -17.2, -3.4, -4.300000000000001, -4.3, -10.2, -18.3, -4.3, -5.2, -17.4, -3.3, -4.2, -19.6, -4.8999999999999995, -8.4, -6.300000000000001, -6.5, -12.899999999999999, -4.2, -11.099999999999996, -8.2, -4.499999999999998, -28.6, -14.399999999999997, -3.3, -6.300000000000001, -7.499999999999999, -3.3, -20.700000000000003, -16.799999999999997, -4.200000000000001, -12.3, -21.2, -3.2, -20.1, -7.3, -4.2, -11.600000000000001, -39.3, -15.999999999999998, -19.3, -11.899999999999999, -4.3, -16.3, -16.2, -17.5, -4.2, -4.300000000000001, -3.3, -19.3, -9.899999999999999, -3.2, -3.3, -21.60000000000001, -3.3, -4.300000000000001, -19.0, -26.3, -4.300000000000001, -6.2, -13.4, -7.3, -8.2, -6.8999999999999995, -11.1, -13.499999999999996, -18.700000000000003, -3.3, -4.2, -8.3, -3.2, -8.3, -10.0, -7.3, -33.0, -11.199999999999998, -3.2, -11.499999999999998, -14.799999999999999, -14.799999999999999, -3.3, -4.300000000000001, -16.999999999999996, -8.3, -11.1, -6.5, -3.3, -22.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9301874943935147, "mean_inference_ms": 1.1892220851521034, "mean_action_processing_ms": 0.06541003700875886, "mean_env_wait_ms": 5.436073064026789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 764000, "timesteps_this_iter": 0, "agent_timesteps_total": 764000, "timers": {"sample_time_ms": 15523.068, "sample_throughput": 257.681, "load_time_ms": 0.366, "load_throughput": 10928358.52, "learn_time_ms": 7437.029, "learn_throughput": 537.849, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.08976016159780244, "policy_loss": -0.0096212537097995, "vf_loss": 9.937859877431265, "vf_explained_var": 0.2630557330064876, "kl": 0.00855107031173196, "entropy": 0.14871672309774867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 764000, "num_agent_steps_sampled": 764000, "num_steps_trained": 764000, "num_agent_steps_trained": 764000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7640, "training_iteration": 191, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-29-34", "timestamp": 1643668174, "time_this_iter_s": 15.489078998565674, "time_total_s": 2847.661218881607, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2847.661218881607, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 27.563636363636366, "ram_util_percent": 72.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -39.3, "episode_reward_mean": -9.972000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.700000000000003, -16.799999999999997, -4.200000000000001, -12.3, -21.2, -3.2, -20.1, -7.3, -4.2, -11.600000000000001, -39.3, -15.999999999999998, -19.3, -11.899999999999999, -4.3, -16.3, -16.2, -17.5, -4.2, -4.300000000000001, -3.3, -19.3, -9.899999999999999, -3.2, -3.3, -21.60000000000001, -3.3, -4.300000000000001, -19.0, -26.3, -4.300000000000001, -6.2, -13.4, -7.3, -8.2, -6.8999999999999995, -11.1, -13.499999999999996, -18.700000000000003, -3.3, -4.2, -8.3, -3.2, -8.3, -10.0, -7.3, -33.0, -11.199999999999998, -3.2, -11.499999999999998, -14.799999999999999, -14.799999999999999, -3.3, -4.300000000000001, -16.999999999999996, -8.3, -11.1, -6.5, -3.3, -22.6, -3.2, -12.399999999999999, -3.3, -19.5, -13.4, -4.2, -11.7, -3.3, -9.8, -4.2, -3.2, -4.2, -4.300000000000001, -4.300000000000001, -22.000000000000007, -4.2, -4.300000000000001, -5.2, -17.400000000000006, -11.1, -3.3, -4.2, -10.4, -9.7, -3.6, -6.3, -11.999999999999998, -10.499999999999998, -3.2, -5.3, -9.4, -6.6, -8.299999999999999, -11.7, -6.5, -3.2, -11.199999999999998, -12.099999999999996, -3.3, -7.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9298353014075951, "mean_inference_ms": 1.18937509013197, "mean_action_processing_ms": 0.06541738171166252, "mean_env_wait_ms": 5.437079735552287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"sample_time_ms": 15571.515, "sample_throughput": 256.879, "load_time_ms": 0.377, "load_throughput": 10621180.046, "learn_time_ms": 7424.844, "learn_throughput": 538.732, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.04063620035366346, "policy_loss": -0.0012803661847306837, "vf_loss": 4.1914314763680585, "vf_explained_var": 0.41398614375822007, "kl": 0.006836120220840152, "entropy": 0.12556300887096955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 768000, "num_steps_trained": 768000, "num_agent_steps_trained": 768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7680, "training_iteration": 192, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-29-49", "timestamp": 1643668189, "time_this_iter_s": 15.590829849243164, "time_total_s": 2863.25204873085, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2863.25204873085, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 29.554545454545462, "ram_util_percent": 72.36818181818184}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.0, "episode_reward_mean": -8.981, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -8.3, -3.2, -8.3, -10.0, -7.3, -33.0, -11.199999999999998, -3.2, -11.499999999999998, -14.799999999999999, -14.799999999999999, -3.3, -4.300000000000001, -16.999999999999996, -8.3, -11.1, -6.5, -3.3, -22.6, -3.2, -12.399999999999999, -3.3, -19.5, -13.4, -4.2, -11.7, -3.3, -9.8, -4.2, -3.2, -4.2, -4.300000000000001, -4.300000000000001, -22.000000000000007, -4.2, -4.300000000000001, -5.2, -17.400000000000006, -11.1, -3.3, -4.2, -10.4, -9.7, -3.6, -6.3, -11.999999999999998, -10.499999999999998, -3.2, -5.3, -9.4, -6.6, -8.299999999999999, -11.7, -6.5, -3.2, -11.199999999999998, -12.099999999999996, -3.3, -7.699999999999999, -6.2, -4.2, -7.300000000000001, -14.999999999999998, -5.6, -19.800000000000004, -4.3, -22.000000000000007, -5.2, -9.7, -3.3, -14.199999999999998, -8.3, -16.6, -8.7, -3.3000000000000003, -3.3, -14.5, -19.6, -11.6, -11.399999999999997, -3.4, -4.4, -4.300000000000001, -12.899999999999999, -4.300000000000001, -5.300000000000001, -12.6, -14.3, -4.300000000000001, -9.2, -7.3, -9.399999999999999, -3.3, -4.2, -13.6, -9.499999999999998, -14.999999999999998, -14.499999999999998, -12.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9294891290150218, "mean_inference_ms": 1.189497138502761, "mean_action_processing_ms": 0.06542457604088817, "mean_env_wait_ms": 5.437933134183992, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 772000, "timesteps_this_iter": 0, "agent_timesteps_total": 772000, "timers": {"sample_time_ms": 15569.728, "sample_throughput": 256.909, "load_time_ms": 0.382, "load_throughput": 10458958.918, "learn_time_ms": 7455.484, "learn_throughput": 536.518, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.061383269650120566, "policy_loss": -0.003629434583408217, "vf_loss": 6.501098223911819, "vf_explained_var": 0.5216691447842505, "kl": 0.005230476305245092, "entropy": 0.11933880763188486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 772000, "num_agent_steps_sampled": 772000, "num_steps_trained": 772000, "num_agent_steps_trained": 772000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7720, "training_iteration": 193, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-30-05", "timestamp": 1643668205, "time_this_iter_s": 15.6720871925354, "time_total_s": 2878.9241359233856, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2878.9241359233856, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 30.368181818181814, "ram_util_percent": 72.40000000000003}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -22.000000000000007, "episode_reward_mean": -8.988999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -4.2, -10.4, -9.7, -3.6, -6.3, -11.999999999999998, -10.499999999999998, -3.2, -5.3, -9.4, -6.6, -8.299999999999999, -11.7, -6.5, -3.2, -11.199999999999998, -12.099999999999996, -3.3, -7.699999999999999, -6.2, -4.2, -7.300000000000001, -14.999999999999998, -5.6, -19.800000000000004, -4.3, -22.000000000000007, -5.2, -9.7, -3.3, -14.199999999999998, -8.3, -16.6, -8.7, -3.3000000000000003, -3.3, -14.5, -19.6, -11.6, -11.399999999999997, -3.4, -4.4, -4.300000000000001, -12.899999999999999, -4.300000000000001, -5.300000000000001, -12.6, -14.3, -4.300000000000001, -9.2, -7.3, -9.399999999999999, -3.3, -4.2, -13.6, -9.499999999999998, -14.999999999999998, -14.499999999999998, -12.3, -20.0, -13.5, -9.2, -4.300000000000001, -16.4, -12.199999999999998, -3.4, -3.4, -9.4, -4.2, -4.2, -4.2, -18.000000000000004, -4.2, -9.9, -11.499999999999993, -3.3, -3.2, -13.699999999999994, -13.2, -20.199999999999992, -4.300000000000001, -15.5, -3.4, -7.2, -4.4, -2.6000000000000005, -3.2, -11.1, -7.799999999999998, -5.2, -9.799999999999997, -12.8, -8.3, -15.999999999999998, -5.2, -20.2, -13.999999999999998, -9.2, -10.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9292255172612337, "mean_inference_ms": 1.1895065672177187, "mean_action_processing_ms": 0.06542511068287524, "mean_env_wait_ms": 5.438049198541908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 776000, "timesteps_this_iter": 0, "agent_timesteps_total": 776000, "timers": {"sample_time_ms": 15557.702, "sample_throughput": 257.107, "load_time_ms": 0.389, "load_throughput": 10277637.834, "learn_time_ms": 7464.824, "learn_throughput": 535.847, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003295898437500001, "cur_lr": 0.00010000000000000003, "total_loss": 0.05753833835804334, "policy_loss": 0.004253561081745291, "vf_loss": 5.328347968390231, "vf_explained_var": 0.47496035310529894, "kl": 0.00394711482932491, "entropy": 0.12261584010976617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 776000, "num_agent_steps_sampled": 776000, "num_steps_trained": 776000, "num_agent_steps_trained": 776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7760, "training_iteration": 194, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-30-20", "timestamp": 1643668220, "time_this_iter_s": 15.418030977249146, "time_total_s": 2894.3421669006348, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2894.3421669006348, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 27.45, "ram_util_percent": 72.40000000000003}}
{"episode_reward_max": -1.2, "episode_reward_min": -20.600000000000005, "episode_reward_mean": -9.267999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.399999999999997, -3.4, -4.4, -4.300000000000001, -12.899999999999999, -4.300000000000001, -5.300000000000001, -12.6, -14.3, -4.300000000000001, -9.2, -7.3, -9.399999999999999, -3.3, -4.2, -13.6, -9.499999999999998, -14.999999999999998, -14.499999999999998, -12.3, -20.0, -13.5, -9.2, -4.300000000000001, -16.4, -12.199999999999998, -3.4, -3.4, -9.4, -4.2, -4.2, -4.2, -18.000000000000004, -4.2, -9.9, -11.499999999999993, -3.3, -3.2, -13.699999999999994, -13.2, -20.199999999999992, -4.300000000000001, -15.5, -3.4, -7.2, -4.4, -2.6000000000000005, -3.2, -11.1, -7.799999999999998, -5.2, -9.799999999999997, -12.8, -8.3, -15.999999999999998, -5.2, -20.2, -13.999999999999998, -9.2, -10.399999999999999, -13.399999999999999, -14.299999999999995, -6.800000000000001, -3.4, -13.399999999999999, -5.9, -7.2, -7.1, -16.9, -3.3, -13.600000000000001, -13.899999999999999, -8.2, -8.2, -14.899999999999997, -15.999999999999995, -3.3, -12.699999999999998, -1.2, -17.2, -10.299999999999995, -10.600000000000001, -9.0, -3.2, -4.4, -4.300000000000001, -4.300000000000001, -14.6, -17.099999999999998, -11.599999999999996, -6.6000000000000005, -8.3, -20.600000000000005, -3.3, -11.399999999999995, -3.3, -8.700000000000001, -3.3, -6.0, -17.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9291209717377368, "mean_inference_ms": 1.1894807151791733, "mean_action_processing_ms": 0.06542488239381146, "mean_env_wait_ms": 5.437737764575773, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 15536.259, "sample_throughput": 257.462, "load_time_ms": 0.39, "load_throughput": 10260666.626, "learn_time_ms": 7493.091, "learn_throughput": 533.825, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00016479492187500004, "cur_lr": 0.00010000000000000003, "total_loss": 0.06513951168425622, "policy_loss": 0.0026672327650650854, "vf_loss": 6.247165254175022, "vf_explained_var": 0.3912492384833674, "kl": 0.0038160647463576724, "entropy": 0.11541764695317515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7800, "training_iteration": 195, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-30-36", "timestamp": 1643668236, "time_this_iter_s": 15.608972072601318, "time_total_s": 2909.951138973236, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2909.951138973236, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 29.509090909090904, "ram_util_percent": 72.41818181818184}}
{"episode_reward_max": -1.2, "episode_reward_min": -93.70000000000012, "episode_reward_mean": -10.303000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.199999999999992, -4.300000000000001, -15.5, -3.4, -7.2, -4.4, -2.6000000000000005, -3.2, -11.1, -7.799999999999998, -5.2, -9.799999999999997, -12.8, -8.3, -15.999999999999998, -5.2, -20.2, -13.999999999999998, -9.2, -10.399999999999999, -13.399999999999999, -14.299999999999995, -6.800000000000001, -3.4, -13.399999999999999, -5.9, -7.2, -7.1, -16.9, -3.3, -13.600000000000001, -13.899999999999999, -8.2, -8.2, -14.899999999999997, -15.999999999999995, -3.3, -12.699999999999998, -1.2, -17.2, -10.299999999999995, -10.600000000000001, -9.0, -3.2, -4.4, -4.300000000000001, -4.300000000000001, -14.6, -17.099999999999998, -11.599999999999996, -6.6000000000000005, -8.3, -20.600000000000005, -3.3, -11.399999999999995, -3.3, -8.700000000000001, -3.3, -6.0, -17.3, -6.2, -7.3, -3.3000000000000003, -5.300000000000001, -4.2, -5.2, -9.799999999999999, -11.699999999999998, -9.899999999999999, -8.999999999999998, -5.4, -10.999999999999998, -9.3, -7.2, -14.6, -7.2, -4.4, -4.2, -12.19999999999997, -19.2, -3.3, -28.80000000000002, -3.3, -16.7, -10.999999999999998, -11.600000000000001, -11.7, -4.800000000000001, -7.599999999999998, -3.3, -3.3, -4.2, -93.70000000000012, -7.800000000000001, -5.9, -22.600000000000005, -15.7, -11.600000000000001, -21.199999999999996, -5.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9289649377260026, "mean_inference_ms": 1.1895201613312207, "mean_action_processing_ms": 0.06542781225076941, "mean_env_wait_ms": 5.437784846328866, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 784000, "timesteps_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"sample_time_ms": 15599.875, "sample_throughput": 256.412, "load_time_ms": 0.392, "load_throughput": 10205119.221, "learn_time_ms": 7504.046, "learn_throughput": 533.046, "update_time_ms": 1.655}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.239746093750002e-05, "cur_lr": 0.00010000000000000003, "total_loss": 0.40953368865434203, "policy_loss": -0.004991132628813546, "vf_loss": 41.452406635720244, "vf_explained_var": 0.17530896106073934, "kl": 0.009368182565405751, "entropy": 0.13403131560051953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 784000, "num_agent_steps_sampled": 784000, "num_steps_trained": 784000, "num_agent_steps_trained": 784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7840, "training_iteration": 196, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-30-52", "timestamp": 1643668252, "time_this_iter_s": 15.606043815612793, "time_total_s": 2925.557182788849, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2925.557182788849, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 29.686956521739127, "ram_util_percent": 72.5}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -93.70000000000012, "episode_reward_mean": -10.747, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.299999999999995, -10.600000000000001, -9.0, -3.2, -4.4, -4.300000000000001, -4.300000000000001, -14.6, -17.099999999999998, -11.599999999999996, -6.6000000000000005, -8.3, -20.600000000000005, -3.3, -11.399999999999995, -3.3, -8.700000000000001, -3.3, -6.0, -17.3, -6.2, -7.3, -3.3000000000000003, -5.300000000000001, -4.2, -5.2, -9.799999999999999, -11.699999999999998, -9.899999999999999, -8.999999999999998, -5.4, -10.999999999999998, -9.3, -7.2, -14.6, -7.2, -4.4, -4.2, -12.19999999999997, -19.2, -3.3, -28.80000000000002, -3.3, -16.7, -10.999999999999998, -11.600000000000001, -11.7, -4.800000000000001, -7.599999999999998, -3.3, -3.3, -4.2, -93.70000000000012, -7.800000000000001, -5.9, -22.600000000000005, -15.7, -11.600000000000001, -21.199999999999996, -5.699999999999999, -6.2, -4.2, -3.3, -13.4, -15.899999999999999, -15.999999999999996, -10.5, -9.2, -5.300000000000001, -3.2, -4.2, -8.099999999999998, -3.3, -12.199999999999998, -10.2, -3.3, -8.5, -14.2, -2.3000000000000003, -8.3, -4.2, -11.7, -3.4, -4.2, -19.8, -4.2, -15.399999999999999, -78.99999999999991, -13.3, -4.300000000000001, -22.400000000000002, -5.4, -16.2, -16.7, -3.2, -14.999999999999996, -4.300000000000001, -12.299999999999999, -16.099999999999998, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9287620124861704, "mean_inference_ms": 1.1896102722529454, "mean_action_processing_ms": 0.06543166596545635, "mean_env_wait_ms": 5.438260929670626, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 788000, "timesteps_this_iter": 0, "agent_timesteps_total": 788000, "timers": {"sample_time_ms": 15592.007, "sample_throughput": 256.542, "load_time_ms": 0.384, "load_throughput": 10411577.51, "learn_time_ms": 7501.117, "learn_throughput": 533.254, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.239746093750002e-05, "cur_lr": 0.00010000000000000003, "total_loss": 0.3168857500668094, "policy_loss": -0.019652673833432697, "vf_loss": 33.65369970811311, "vf_explained_var": 0.18501121318468483, "kl": 0.01739262899557583, "entropy": 0.14041973035782576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 788000, "num_agent_steps_sampled": 788000, "num_steps_trained": 788000, "num_agent_steps_trained": 788000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7880, "training_iteration": 197, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-31-07", "timestamp": 1643668267, "time_this_iter_s": 15.2793710231781, "time_total_s": 2940.836553812027, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2940.836553812027, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 28.15909090909091, "ram_util_percent": 72.5090909090909}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -163.39999999999995, "episode_reward_mean": -12.816, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -28.80000000000002, -3.3, -16.7, -10.999999999999998, -11.600000000000001, -11.7, -4.800000000000001, -7.599999999999998, -3.3, -3.3, -4.2, -93.70000000000012, -7.800000000000001, -5.9, -22.600000000000005, -15.7, -11.600000000000001, -21.199999999999996, -5.699999999999999, -6.2, -4.2, -3.3, -13.4, -15.899999999999999, -15.999999999999996, -10.5, -9.2, -5.300000000000001, -3.2, -4.2, -8.099999999999998, -3.3, -12.199999999999998, -10.2, -3.3, -8.5, -14.2, -2.3000000000000003, -8.3, -4.2, -11.7, -3.4, -4.2, -19.8, -4.2, -15.399999999999999, -78.99999999999991, -13.3, -4.300000000000001, -22.400000000000002, -5.4, -16.2, -16.7, -3.2, -14.999999999999996, -4.300000000000001, -12.299999999999999, -16.099999999999998, -3.2, -12.199999999999998, -4.3, -18.3, -14.7, -19.20000000000001, -3.6000000000000005, -3.3, -10.399999999999999, -163.39999999999995, -3.2, -11.499999999999998, -7.499999999999998, -10.099999999999998, -3.3, -4.2, -10.700000000000001, -4.3, -22.100000000000012, -2.5, -8.2, -2.9000000000000004, -5.6, -31.100000000000033, -4.4, -12.299999999999997, -17.0, -9.700000000000001, -3.3, -3.3, -8.200000000000001, -23.1, -3.3, -4.300000000000001, -15.399999999999974, -13.599999999999998, -16.3, -9.699999999999998, -10.5, -17.5, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9285900547725237, "mean_inference_ms": 1.1896879997869905, "mean_action_processing_ms": 0.0654338336634624, "mean_env_wait_ms": 5.438890925473031, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 792000, "timesteps_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"sample_time_ms": 15602.466, "sample_throughput": 256.37, "load_time_ms": 0.383, "load_throughput": 10436188.106, "learn_time_ms": 7480.892, "learn_throughput": 534.696, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.239746093750002e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.370262226240424, "policy_loss": -0.012541310439857664, "vf_loss": 138.28017117810506, "vf_explained_var": -0.07928354849097549, "kl": 0.0224628618334829, "entropy": 0.1440578204649751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 792000, "num_agent_steps_sampled": 792000, "num_steps_trained": 792000, "num_agent_steps_trained": 792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7920, "training_iteration": 198, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-31-23", "timestamp": 1643668283, "time_this_iter_s": 15.601701021194458, "time_total_s": 2956.4382548332214, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2956.4382548332214, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 31.05, "ram_util_percent": 72.53636363636362}}
{"episode_reward_max": -2.5, "episode_reward_min": -163.39999999999995, "episode_reward_mean": -11.605, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -11.7, -3.4, -4.2, -19.8, -4.2, -15.399999999999999, -78.99999999999991, -13.3, -4.300000000000001, -22.400000000000002, -5.4, -16.2, -16.7, -3.2, -14.999999999999996, -4.300000000000001, -12.299999999999999, -16.099999999999998, -3.2, -12.199999999999998, -4.3, -18.3, -14.7, -19.20000000000001, -3.6000000000000005, -3.3, -10.399999999999999, -163.39999999999995, -3.2, -11.499999999999998, -7.499999999999998, -10.099999999999998, -3.3, -4.2, -10.700000000000001, -4.3, -22.100000000000012, -2.5, -8.2, -2.9000000000000004, -5.6, -31.100000000000033, -4.4, -12.299999999999997, -17.0, -9.700000000000001, -3.3, -3.3, -8.200000000000001, -23.1, -3.3, -4.300000000000001, -15.399999999999974, -13.599999999999998, -16.3, -9.699999999999998, -10.5, -17.5, -3.2, -12.099999999999996, -9.5, -10.3, -3.4, -5.4, -4.300000000000001, -4.3, -16.599999999999998, -4.300000000000001, -19.2, -3.4, -7.3, -6.199999999999999, -3.5, -6.3, -13.8, -4.2, -7.299999999999999, -8.899999999999999, -6.8, -3.2, -9.699999999999996, -13.899999999999999, -4.3, -5.3, -5.6000000000000005, -8.5, -3.2, -3.2, -14.0, -8.899999999999999, -23.999999999999986, -11.5, -14.700000000000001, -12.399999999999999, -8.5, -3.3, -4.2, -5.2, -13.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9285113651816053, "mean_inference_ms": 1.1897342351098579, "mean_action_processing_ms": 0.06543592375437729, "mean_env_wait_ms": 5.439307214775107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 796000, "timesteps_this_iter": 0, "agent_timesteps_total": 796000, "timers": {"sample_time_ms": 15561.016, "sample_throughput": 257.053, "load_time_ms": 0.38, "load_throughput": 10520609.519, "learn_time_ms": 7457.596, "learn_throughput": 536.366, "update_time_ms": 1.603}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.06742631164779987, "policy_loss": -0.005985954999723422, "vf_loss": 7.341053905730607, "vf_explained_var": 0.19999274156426872, "kl": 0.014009316498120237, "entropy": 0.14027211933887454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 796000, "num_agent_steps_sampled": 796000, "num_steps_trained": 796000, "num_agent_steps_trained": 796000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7960, "training_iteration": 199, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-31-38", "timestamp": 1643668298, "time_this_iter_s": 15.27372407913208, "time_total_s": 2971.7119789123535, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2971.7119789123535, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 28.77142857142857, "ram_util_percent": 72.59999999999998}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -31.100000000000033, "episode_reward_mean": -9.377999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.9000000000000004, -5.6, -31.100000000000033, -4.4, -12.299999999999997, -17.0, -9.700000000000001, -3.3, -3.3, -8.200000000000001, -23.1, -3.3, -4.300000000000001, -15.399999999999974, -13.599999999999998, -16.3, -9.699999999999998, -10.5, -17.5, -3.2, -12.099999999999996, -9.5, -10.3, -3.4, -5.4, -4.300000000000001, -4.3, -16.599999999999998, -4.300000000000001, -19.2, -3.4, -7.3, -6.199999999999999, -3.5, -6.3, -13.8, -4.2, -7.299999999999999, -8.899999999999999, -6.8, -3.2, -9.699999999999996, -13.899999999999999, -4.3, -5.3, -5.6000000000000005, -8.5, -3.2, -3.2, -14.0, -8.899999999999999, -23.999999999999986, -11.5, -14.700000000000001, -12.399999999999999, -8.5, -3.3, -4.2, -5.2, -13.799999999999999, -3.2, -27.800000000000004, -7.6000000000000005, -9.699999999999992, -13.399999999999999, -3.3, -17.2, -6.3, -7.2, -13.799999999999997, -3.2, -19.6, -10.599999999999998, -4.2, -10.2, -5.2, -4.2, -9.6, -4.300000000000001, -3.3, -7.3, -30.9, -4.2, -10.799999999999999, -9.499999999999998, -5.2, -4.3, -11.799999999999999, -10.199999999999998, -3.2, -13.699999999999998, -10.6, -16.800000000000004, -15.599999999999998, -3.3, -16.700000000000003, -15.2, -4.800000000000001, -7.299999999999999, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9288770742419703, "mean_inference_ms": 1.189928511827039, "mean_action_processing_ms": 0.0654416300062502, "mean_env_wait_ms": 5.439785662672077, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 15552.882, "sample_throughput": 257.187, "load_time_ms": 0.379, "load_throughput": 10560342.418, "learn_time_ms": 7467.158, "learn_throughput": 535.679, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.08179686671443363, "policy_loss": -0.006376508164459899, "vf_loss": 8.81721617694824, "vf_explained_var": 0.3410723411908714, "kl": 0.00982706531556842, "entropy": 0.12780768876114199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 800000, "num_steps_trained": 800000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8000, "training_iteration": 200, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-31-54", "timestamp": 1643668314, "time_this_iter_s": 15.772295951843262, "time_total_s": 2987.484274864197, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2987.484274864197, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 29.55652173913043, "ram_util_percent": 72.70869565217393}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.9, "episode_reward_mean": -9.870000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -9.699999999999996, -13.899999999999999, -4.3, -5.3, -5.6000000000000005, -8.5, -3.2, -3.2, -14.0, -8.899999999999999, -23.999999999999986, -11.5, -14.700000000000001, -12.399999999999999, -8.5, -3.3, -4.2, -5.2, -13.799999999999999, -3.2, -27.800000000000004, -7.6000000000000005, -9.699999999999992, -13.399999999999999, -3.3, -17.2, -6.3, -7.2, -13.799999999999997, -3.2, -19.6, -10.599999999999998, -4.2, -10.2, -5.2, -4.2, -9.6, -4.300000000000001, -3.3, -7.3, -30.9, -4.2, -10.799999999999999, -9.499999999999998, -5.2, -4.3, -11.799999999999999, -10.199999999999998, -3.2, -13.699999999999998, -10.6, -16.800000000000004, -15.599999999999998, -3.3, -16.700000000000003, -15.2, -4.800000000000001, -7.299999999999999, -3.3, -3.2, -3.2, -22.9, -4.4, -10.4, -5.3, -4.300000000000001, -18.4, -9.3, -13.2, -3.2, -15.899999999999997, -10.8, -25.199999999999996, -28.70000000000002, -25.6, -3.3, -8.2, -8.700000000000001, -21.500000000000004, -6.700000000000001, -3.3, -4.300000000000001, -4.2, -4.4, -21.799999999999997, -17.6, -3.2, -9.3, -3.2, -6.499999999999999, -3.2, -3.4, -18.2, -9.4, -13.099999999999998, -15.5, -6.2, -11.2, -10.600000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9292784249000693, "mean_inference_ms": 1.1901348502544766, "mean_action_processing_ms": 0.06544577666819977, "mean_env_wait_ms": 5.440163487076973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 804000, "timesteps_this_iter": 0, "agent_timesteps_total": 804000, "timers": {"sample_time_ms": 15559.291, "sample_throughput": 257.081, "load_time_ms": 0.392, "load_throughput": 10212573.655, "learn_time_ms": 7455.899, "learn_throughput": 536.488, "update_time_ms": 1.618}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.11360937014762913, "policy_loss": 0.002148208422686464, "vf_loss": 11.146022733725527, "vf_explained_var": 0.2545250445283869, "kl": 0.00759394456400032, "entropy": 0.13981354859487344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 804000, "num_agent_steps_sampled": 804000, "num_steps_trained": 804000, "num_agent_steps_trained": 804000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8040, "training_iteration": 201, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-32-09", "timestamp": 1643668329, "time_this_iter_s": 15.326435089111328, "time_total_s": 3002.810709953308, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3002.810709953308, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 28.854545454545452, "ram_util_percent": 72.71363636363637}}
{"episode_reward_max": -3.2, "episode_reward_min": -70.79999999999994, "episode_reward_mean": -11.38, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3, -30.9, -4.2, -10.799999999999999, -9.499999999999998, -5.2, -4.3, -11.799999999999999, -10.199999999999998, -3.2, -13.699999999999998, -10.6, -16.800000000000004, -15.599999999999998, -3.3, -16.700000000000003, -15.2, -4.800000000000001, -7.299999999999999, -3.3, -3.2, -3.2, -22.9, -4.4, -10.4, -5.3, -4.300000000000001, -18.4, -9.3, -13.2, -3.2, -15.899999999999997, -10.8, -25.199999999999996, -28.70000000000002, -25.6, -3.3, -8.2, -8.700000000000001, -21.500000000000004, -6.700000000000001, -3.3, -4.300000000000001, -4.2, -4.4, -21.799999999999997, -17.6, -3.2, -9.3, -3.2, -6.499999999999999, -3.2, -3.4, -18.2, -9.4, -13.099999999999998, -15.5, -6.2, -11.2, -10.600000000000001, -3.3, -15.399999999999997, -3.3, -3.2, -20.50000000000006, -9.3, -9.299999999999999, -16.199999999999996, -3.3, -8.9, -3.3, -20.200000000000003, -7.2, -8.2, -11.2, -3.2, -13.499999999999998, -9.6, -7.2, -18.6, -19.5, -21.5, -22.799999999999997, -11.8, -21.2, -13.599999999999998, -16.5, -5.6000000000000005, -9.0, -18.399999999999988, -4.4, -5.799999999999999, -18.200000000000003, -16.5, -4.300000000000001, -3.3, -12.599999999999998, -13.4, -8.2, -70.79999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9294545279994986, "mean_inference_ms": 1.1904288495819098, "mean_action_processing_ms": 0.06545318169864006, "mean_env_wait_ms": 5.44085937297925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 808000, "timesteps_this_iter": 0, "agent_timesteps_total": 808000, "timers": {"sample_time_ms": 15560.301, "sample_throughput": 257.064, "load_time_ms": 0.378, "load_throughput": 10584326.541, "learn_time_ms": 7470.069, "learn_throughput": 535.47, "update_time_ms": 1.586}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.255547752083149, "policy_loss": -0.025347915624258338, "vf_loss": 28.089483258288393, "vf_explained_var": 0.1422349786886605, "kl": 0.006849507734131937, "entropy": 0.13376197947129126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 808000, "num_agent_steps_sampled": 808000, "num_steps_trained": 808000, "num_agent_steps_trained": 808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8080, "training_iteration": 202, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-32-25", "timestamp": 1643668345, "time_this_iter_s": 15.844673156738281, "time_total_s": 3018.6553831100464, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3018.6553831100464, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 29.254545454545454, "ram_util_percent": 72.79090909090907}}
{"episode_reward_max": -3.2, "episode_reward_min": -70.79999999999994, "episode_reward_mean": -10.634, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.700000000000001, -3.3, -4.300000000000001, -4.2, -4.4, -21.799999999999997, -17.6, -3.2, -9.3, -3.2, -6.499999999999999, -3.2, -3.4, -18.2, -9.4, -13.099999999999998, -15.5, -6.2, -11.2, -10.600000000000001, -3.3, -15.399999999999997, -3.3, -3.2, -20.50000000000006, -9.3, -9.299999999999999, -16.199999999999996, -3.3, -8.9, -3.3, -20.200000000000003, -7.2, -8.2, -11.2, -3.2, -13.499999999999998, -9.6, -7.2, -18.6, -19.5, -21.5, -22.799999999999997, -11.8, -21.2, -13.599999999999998, -16.5, -5.6000000000000005, -9.0, -18.399999999999988, -4.4, -5.799999999999999, -18.200000000000003, -16.5, -4.300000000000001, -3.3, -12.599999999999998, -13.4, -8.2, -70.79999999999994, -3.2, -3.3, -4.300000000000001, -7.3, -4.300000000000001, -12.0, -21.50000000000001, -9.799999999999999, -9.0, -17.099999999999998, -11.799999999999999, -3.4, -5.800000000000001, -6.2, -5.2, -8.999999999999996, -3.2, -9.2, -19.000000000000007, -3.3, -21.599999999999998, -3.3, -14.8, -29.799999999999997, -4.300000000000001, -3.3, -14.8, -5.3, -6.300000000000001, -4.3, -13.099999999999996, -12.6, -8.2, -3.3, -13.9, -4.6000000000000005, -16.2, -7.8999999999999995, -6.3, -13.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9294948046330468, "mean_inference_ms": 1.1906056605340432, "mean_action_processing_ms": 0.06545924543018196, "mean_env_wait_ms": 5.441508567899336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 812000, "timesteps_this_iter": 0, "agent_timesteps_total": 812000, "timers": {"sample_time_ms": 15556.613, "sample_throughput": 257.125, "load_time_ms": 0.37, "load_throughput": 10805188.382, "learn_time_ms": 7413.02, "learn_throughput": 539.591, "update_time_ms": 1.582}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.07273207137921965, "policy_loss": -0.0018212564439783173, "vf_loss": 7.4552283553346514, "vf_explained_var": 0.3421279969394848, "kl": 0.008465136595889147, "entropy": 0.1489156167433467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 812000, "num_agent_steps_sampled": 812000, "num_steps_trained": 812000, "num_agent_steps_trained": 812000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8120, "training_iteration": 203, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-32-40", "timestamp": 1643668360, "time_this_iter_s": 14.958186864852905, "time_total_s": 3033.6135699748993, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3033.6135699748993, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 23.790476190476188, "ram_util_percent": 72.79523809523808}}
{"episode_reward_max": -2.5, "episode_reward_min": -70.79999999999994, "episode_reward_mean": -11.203999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.5, -21.5, -22.799999999999997, -11.8, -21.2, -13.599999999999998, -16.5, -5.6000000000000005, -9.0, -18.399999999999988, -4.4, -5.799999999999999, -18.200000000000003, -16.5, -4.300000000000001, -3.3, -12.599999999999998, -13.4, -8.2, -70.79999999999994, -3.2, -3.3, -4.300000000000001, -7.3, -4.300000000000001, -12.0, -21.50000000000001, -9.799999999999999, -9.0, -17.099999999999998, -11.799999999999999, -3.4, -5.800000000000001, -6.2, -5.2, -8.999999999999996, -3.2, -9.2, -19.000000000000007, -3.3, -21.599999999999998, -3.3, -14.8, -29.799999999999997, -4.300000000000001, -3.3, -14.8, -5.3, -6.300000000000001, -4.3, -13.099999999999996, -12.6, -8.2, -3.3, -13.9, -4.6000000000000005, -16.2, -7.8999999999999995, -6.3, -13.999999999999998, -12.699999999999996, -15.2, -8.2, -5.2, -4.2, -3.3, -15.2, -8.3, -14.499999999999998, -3.3, -7.8999999999999995, -3.3, -4.9, -19.599999999999998, -24.100000000000012, -3.3, -12.399999999999988, -15.699999999999998, -3.2, -7.3, -11.299999999999997, -7.2, -17.4, -14.999999999999998, -12.299999999999997, -14.299999999999999, -8.4, -2.5, -4.2, -13.699999999999998, -4.3, -3.3, -18.900000000000013, -3.3, -15.699999999999978, -19.4, -22.1, -24.800000000000004, -8.2, -9.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9293086631589655, "mean_inference_ms": 1.190770290935931, "mean_action_processing_ms": 0.06546778923851339, "mean_env_wait_ms": 5.442224116538927, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 816000, "timesteps_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"sample_time_ms": 15543.654, "sample_throughput": 257.34, "load_time_ms": 0.371, "load_throughput": 10779501.414, "learn_time_ms": 7393.792, "learn_throughput": 540.994, "update_time_ms": 1.573}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.08375118292407484, "policy_loss": -0.0025477455958964365, "vf_loss": 8.629774183098988, "vf_explained_var": 0.26857793061963975, "kl": 0.00963193462681152, "entropy": 0.1470309771256902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 816000, "num_agent_steps_sampled": 816000, "num_steps_trained": 816000, "num_agent_steps_trained": 816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8160, "training_iteration": 204, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-32-56", "timestamp": 1643668376, "time_this_iter_s": 15.662775039672852, "time_total_s": 3049.276345014572, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3049.276345014572, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 27.573913043478264, "ram_util_percent": 72.71304347826083}}
{"episode_reward_max": -2.5, "episode_reward_min": -29.799999999999997, "episode_reward_mean": -10.924, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.599999999999998, -3.3, -14.8, -29.799999999999997, -4.300000000000001, -3.3, -14.8, -5.3, -6.300000000000001, -4.3, -13.099999999999996, -12.6, -8.2, -3.3, -13.9, -4.6000000000000005, -16.2, -7.8999999999999995, -6.3, -13.999999999999998, -12.699999999999996, -15.2, -8.2, -5.2, -4.2, -3.3, -15.2, -8.3, -14.499999999999998, -3.3, -7.8999999999999995, -3.3, -4.9, -19.599999999999998, -24.100000000000012, -3.3, -12.399999999999988, -15.699999999999998, -3.2, -7.3, -11.299999999999997, -7.2, -17.4, -14.999999999999998, -12.299999999999997, -14.299999999999999, -8.4, -2.5, -4.2, -13.699999999999998, -4.3, -3.3, -18.900000000000013, -3.3, -15.699999999999978, -19.4, -22.1, -24.800000000000004, -8.2, -9.099999999999998, -8.799999999999997, -6.2, -20.1, -14.499999999999998, -10.999999999999998, -13.799999999999999, -9.599999999999998, -23.0, -4.3, -19.0, -18.9, -18.6, -9.199999999999998, -23.2, -6.2, -5.300000000000001, -15.099999999999978, -4.3, -8.999999999999998, -16.3, -20.3, -6.300000000000001, -9.5, -9.299999999999994, -3.3, -11.2, -10.9, -6.6, -3.3, -17.200000000000003, -5.2, -22.6, -10.299999999999997, -3.2, -10.399999999999995, -7.3, -13.0, -9.599999999999996, -10.799999999999999, -10.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9291869860732477, "mean_inference_ms": 1.190780080007217, "mean_action_processing_ms": 0.06546900829893035, "mean_env_wait_ms": 5.4422169173249495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"sample_time_ms": 15500.034, "sample_throughput": 258.064, "load_time_ms": 0.366, "load_throughput": 10919822.963, "learn_time_ms": 7346.162, "learn_throughput": 544.502, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.09356508397256895, "policy_loss": 0.0040855367297446855, "vf_loss": 8.947836746451674, "vf_explained_var": 0.37852638549702144, "kl": 0.00956705401204453, "entropy": 0.17513756614218476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 820000, "num_steps_trained": 820000, "num_agent_steps_trained": 820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8200, "training_iteration": 205, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-33-11", "timestamp": 1643668391, "time_this_iter_s": 14.874037027359009, "time_total_s": 3064.150382041931, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3064.150382041931, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 25.9, "ram_util_percent": 72.67619047619048}}
{"episode_reward_max": -2.5, "episode_reward_min": -44.2, "episode_reward_mean": -11.634, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.299999999999997, -7.2, -17.4, -14.999999999999998, -12.299999999999997, -14.299999999999999, -8.4, -2.5, -4.2, -13.699999999999998, -4.3, -3.3, -18.900000000000013, -3.3, -15.699999999999978, -19.4, -22.1, -24.800000000000004, -8.2, -9.099999999999998, -8.799999999999997, -6.2, -20.1, -14.499999999999998, -10.999999999999998, -13.799999999999999, -9.599999999999998, -23.0, -4.3, -19.0, -18.9, -18.6, -9.199999999999998, -23.2, -6.2, -5.300000000000001, -15.099999999999978, -4.3, -8.999999999999998, -16.3, -20.3, -6.300000000000001, -9.5, -9.299999999999994, -3.3, -11.2, -10.9, -6.6, -3.3, -17.200000000000003, -5.2, -22.6, -10.299999999999997, -3.2, -10.399999999999995, -7.3, -13.0, -9.599999999999996, -10.799999999999999, -10.599999999999998, -4.2, -44.2, -3.2, -10.5, -16.5, -3.3, -3.3, -23.700000000000028, -15.499999999999995, -17.4, -20.200000000000028, -13.5, -3.3, -22.300000000000004, -17.8, -4.4, -4.300000000000001, -3.3, -23.299999999999997, -22.6, -3.2, -14.399999999999999, -3.3, -21.0, -9.9, -9.0, -4.2, -3.3, -5.999999999999999, -3.2, -3.3, -15.5, -6.899999999999999, -3.2, -21.900000000000006, -3.3, -15.599999999999998, -17.400000000000002, -16.4, -12.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9291272550884601, "mean_inference_ms": 1.1908484081132318, "mean_action_processing_ms": 0.06547292067391859, "mean_env_wait_ms": 5.4424186112151505, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 824000, "timesteps_this_iter": 0, "agent_timesteps_total": 824000, "timers": {"sample_time_ms": 15468.458, "sample_throughput": 258.591, "load_time_ms": 0.357, "load_throughput": 11213966.981, "learn_time_ms": 7327.024, "learn_throughput": 545.924, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.12292635634701739, "policy_loss": -0.006038064711917472, "vf_loss": 12.896261169320793, "vf_explained_var": 0.3248939330859851, "kl": 0.014646238808318952, "entropy": 0.15788509798867087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 824000, "num_agent_steps_sampled": 824000, "num_steps_trained": 824000, "num_agent_steps_trained": 824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8240, "training_iteration": 206, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-33-26", "timestamp": 1643668406, "time_this_iter_s": 15.600000619888306, "time_total_s": 3079.7503826618195, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3079.7503826618195, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 30.427272727272722, "ram_util_percent": 72.70000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.2, "episode_reward_mean": -10.72, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.3, -6.300000000000001, -9.5, -9.299999999999994, -3.3, -11.2, -10.9, -6.6, -3.3, -17.200000000000003, -5.2, -22.6, -10.299999999999997, -3.2, -10.399999999999995, -7.3, -13.0, -9.599999999999996, -10.799999999999999, -10.599999999999998, -4.2, -44.2, -3.2, -10.5, -16.5, -3.3, -3.3, -23.700000000000028, -15.499999999999995, -17.4, -20.200000000000028, -13.5, -3.3, -22.300000000000004, -17.8, -4.4, -4.300000000000001, -3.3, -23.299999999999997, -22.6, -3.2, -14.399999999999999, -3.3, -21.0, -9.9, -9.0, -4.2, -3.3, -5.999999999999999, -3.2, -3.3, -15.5, -6.899999999999999, -3.2, -21.900000000000006, -3.3, -15.599999999999998, -17.400000000000002, -16.4, -12.899999999999999, -13.399999999999999, -10.799999999999997, -5.3, -3.3, -3.3, -16.699999999999996, -3.4, -17.6, -8.3, -15.8, -9.999999999999998, -4.3, -14.799999999999999, -7.7, -4.4, -7.2, -3.2, -16.4, -3.3, -4.300000000000001, -4.3, -5.300000000000001, -17.900000000000002, -14.7, -4.4, -9.5, -11.099999999999998, -21.1, -16.9, -13.399999999999999, -14.699999999999994, -15.099999999999998, -3.3, -3.3, -12.5, -3.3, -20.199999999999996, -3.2, -21.9, -10.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9291149121411197, "mean_inference_ms": 1.1908731948748275, "mean_action_processing_ms": 0.06547256044606449, "mean_env_wait_ms": 5.442315042643875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 828000, "timesteps_this_iter": 0, "agent_timesteps_total": 828000, "timers": {"sample_time_ms": 15429.252, "sample_throughput": 259.248, "load_time_ms": 0.357, "load_throughput": 11213966.981, "learn_time_ms": 7353.004, "learn_throughput": 543.995, "update_time_ms": 1.487}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.06686785897159929, "policy_loss": -0.002278091955769767, "vf_loss": 6.914488922700446, "vf_explained_var": 0.35793513130116206, "kl": 0.008593450291796135, "entropy": 0.16445006176388713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 828000, "num_agent_steps_sampled": 828000, "num_steps_trained": 828000, "num_agent_steps_trained": 828000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8280, "training_iteration": 207, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-33-42", "timestamp": 1643668422, "time_this_iter_s": 15.330948114395142, "time_total_s": 3095.0813307762146, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3095.0813307762146, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 27.513636363636355, "ram_util_percent": 72.76363636363635}}
{"episode_reward_max": -3.2, "episode_reward_min": -24.3, "episode_reward_mean": -10.108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -14.399999999999999, -3.3, -21.0, -9.9, -9.0, -4.2, -3.3, -5.999999999999999, -3.2, -3.3, -15.5, -6.899999999999999, -3.2, -21.900000000000006, -3.3, -15.599999999999998, -17.400000000000002, -16.4, -12.899999999999999, -13.399999999999999, -10.799999999999997, -5.3, -3.3, -3.3, -16.699999999999996, -3.4, -17.6, -8.3, -15.8, -9.999999999999998, -4.3, -14.799999999999999, -7.7, -4.4, -7.2, -3.2, -16.4, -3.3, -4.300000000000001, -4.3, -5.300000000000001, -17.900000000000002, -14.7, -4.4, -9.5, -11.099999999999998, -21.1, -16.9, -13.399999999999999, -14.699999999999994, -15.099999999999998, -3.3, -3.3, -12.5, -3.3, -20.199999999999996, -3.2, -21.9, -10.799999999999997, -19.9, -3.3, -18.699999999999996, -14.899999999999999, -21.500000000000004, -14.2, -6.2, -12.2, -3.3, -16.3, -3.3, -4.4, -11.5, -12.999999999999996, -12.999999999999998, -12.5, -10.899999999999999, -24.3, -4.5, -3.3, -3.2, -19.500000000000004, -6.8, -5.4, -3.3, -5.3, -14.5, -3.2, -5.3, -13.899999999999999, -4.3, -9.0, -3.3, -21.299999999999997, -13.299999999999974, -15.200000000000001, -22.0, -10.099999999999996, -3.2, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9290690830269324, "mean_inference_ms": 1.1908868143235514, "mean_action_processing_ms": 0.06547332497408634, "mean_env_wait_ms": 5.442322867388981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 832000, "timesteps_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"sample_time_ms": 15467.125, "sample_throughput": 258.613, "load_time_ms": 0.357, "load_throughput": 11191525.582, "learn_time_ms": 7311.989, "learn_throughput": 547.047, "update_time_ms": 1.49}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.08370910751012464, "policy_loss": -0.006343542123513837, "vf_loss": 9.005172191448109, "vf_explained_var": 0.31701847519925846, "kl": 0.007532925930378221, "entropy": 0.1424056276498783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 832000, "num_agent_steps_sampled": 832000, "num_steps_trained": 832000, "num_agent_steps_trained": 832000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8320, "training_iteration": 208, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-33-57", "timestamp": 1643668437, "time_this_iter_s": 15.313208103179932, "time_total_s": 3110.3945388793945, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3110.3945388793945, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 26.331818181818175, "ram_util_percent": 72.79999999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -40.2, "episode_reward_mean": -10.757, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -5.300000000000001, -17.900000000000002, -14.7, -4.4, -9.5, -11.099999999999998, -21.1, -16.9, -13.399999999999999, -14.699999999999994, -15.099999999999998, -3.3, -3.3, -12.5, -3.3, -20.199999999999996, -3.2, -21.9, -10.799999999999997, -19.9, -3.3, -18.699999999999996, -14.899999999999999, -21.500000000000004, -14.2, -6.2, -12.2, -3.3, -16.3, -3.3, -4.4, -11.5, -12.999999999999996, -12.999999999999998, -12.5, -10.899999999999999, -24.3, -4.5, -3.3, -3.2, -19.500000000000004, -6.8, -5.4, -3.3, -5.3, -14.5, -3.2, -5.3, -13.899999999999999, -4.3, -9.0, -3.3, -21.299999999999997, -13.299999999999974, -15.200000000000001, -22.0, -10.099999999999996, -3.2, -3.2, -14.999999999999996, -15.7, -3.3, -10.3, -13.9, -13.899999999999999, -11.0, -40.2, -23.599999999999994, -2.2, -3.3, -3.3, -5.2, -13.499999999999998, -4.3, -30.6, -13.5, -18.2, -4.3, -17.9, -15.599999999999998, -3.2, -11.299999999999999, -4.3, -16.3, -7.3, -8.399999999999999, -3.3, -6.1000000000000005, -15.599999999999973, -4.300000000000001, -18.299999999999997, -3.3, -3.2, -24.100000000000026, -3.3, -3.3, -11.399999999999999, -3.2, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9290596180010786, "mean_inference_ms": 1.1909016419855305, "mean_action_processing_ms": 0.06547333835789355, "mean_env_wait_ms": 5.44217595642739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 836000, "timesteps_this_iter": 0, "agent_timesteps_total": 836000, "timers": {"sample_time_ms": 15416.933, "sample_throughput": 259.455, "load_time_ms": 0.359, "load_throughput": 11147651.827, "learn_time_ms": 7306.922, "learn_throughput": 547.426, "update_time_ms": 1.484}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 0.11957860432805553, "policy_loss": -0.008368201345525761, "vf_loss": 12.794525608131963, "vf_explained_var": 0.2492860399907635, "kl": 0.012530798283823379, "entropy": 0.13229692776196747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 836000, "num_agent_steps_sampled": 836000, "num_steps_trained": 836000, "num_agent_steps_trained": 836000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8360, "training_iteration": 209, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-34-12", "timestamp": 1643668452, "time_this_iter_s": 15.142033100128174, "time_total_s": 3125.5365719795227, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3125.5365719795227, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 25.104761904761908, "ram_util_percent": 72.75238095238095}}
{"episode_reward_max": -2.2, "episode_reward_min": -119.6, "episode_reward_mean": -13.758, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -19.500000000000004, -6.8, -5.4, -3.3, -5.3, -14.5, -3.2, -5.3, -13.899999999999999, -4.3, -9.0, -3.3, -21.299999999999997, -13.299999999999974, -15.200000000000001, -22.0, -10.099999999999996, -3.2, -3.2, -14.999999999999996, -15.7, -3.3, -10.3, -13.9, -13.899999999999999, -11.0, -40.2, -23.599999999999994, -2.2, -3.3, -3.3, -5.2, -13.499999999999998, -4.3, -30.6, -13.5, -18.2, -4.3, -17.9, -15.599999999999998, -3.2, -11.299999999999999, -4.3, -16.3, -7.3, -8.399999999999999, -3.3, -6.1000000000000005, -15.599999999999973, -4.300000000000001, -18.299999999999997, -3.3, -3.2, -24.100000000000026, -3.3, -3.3, -11.399999999999999, -3.2, -3.3, -15.799999999999999, -119.6, -3.3, -21.60000000000001, -6.2, -5.6, -17.799999999999997, -27.500000000000004, -10.9, -5.3, -12.599999999999989, -3.2, -22.000000000000004, -5.2, -28.299999999999997, -3.3, -3.3, -11.999999999999972, -19.200000000000003, -16.099999999999998, -3.3, -3.3, -9.4, -3.0000000000000004, -4.2, -11.9, -6.5, -10.4, -4.4, -79.3, -4.4, -3.3, -84.3, -12.999999999999996, -4.300000000000001, -21.400000000000013, -6.2, -24.6, -14.899999999999999, -87.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9291399207925489, "mean_inference_ms": 1.190964314113653, "mean_action_processing_ms": 0.06547353085501922, "mean_env_wait_ms": 5.442179779894498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 15378.216, "sample_throughput": 260.108, "load_time_ms": 0.384, "load_throughput": 10412869.911, "learn_time_ms": 7270.007, "learn_throughput": 550.206, "update_time_ms": 1.456}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 0.00010000000000000003, "total_loss": 1.4406825029161028, "policy_loss": -0.033775130296827, "vf_loss": 147.44496748248736, "vf_explained_var": -0.15603554203946104, "kl": 0.06462487494198332, "entropy": 0.15016548639984542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000, "num_agent_steps_trained": 840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8400, "training_iteration": 210, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-34-27", "timestamp": 1643668467, "time_this_iter_s": 15.072145938873291, "time_total_s": 3140.608717918396, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3140.608717918396, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 26.19090909090909, "ram_util_percent": 72.79545454545452}}
{"episode_reward_max": -3.0000000000000004, "episode_reward_min": -119.6, "episode_reward_mean": -14.140999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.599999999999998, -3.2, -11.299999999999999, -4.3, -16.3, -7.3, -8.399999999999999, -3.3, -6.1000000000000005, -15.599999999999973, -4.300000000000001, -18.299999999999997, -3.3, -3.2, -24.100000000000026, -3.3, -3.3, -11.399999999999999, -3.2, -3.3, -15.799999999999999, -119.6, -3.3, -21.60000000000001, -6.2, -5.6, -17.799999999999997, -27.500000000000004, -10.9, -5.3, -12.599999999999989, -3.2, -22.000000000000004, -5.2, -28.299999999999997, -3.3, -3.3, -11.999999999999972, -19.200000000000003, -16.099999999999998, -3.3, -3.3, -9.4, -3.0000000000000004, -4.2, -11.9, -6.5, -10.4, -4.4, -79.3, -4.4, -3.3, -84.3, -12.999999999999996, -4.300000000000001, -21.400000000000013, -6.2, -24.6, -14.899999999999999, -87.3, -16.6, -15.499999999999998, -11.599999999999998, -16.299999999999997, -3.2, -7.4, -12.2, -8.4, -18.3, -17.0, -5.4, -13.19999999999997, -11.899999999999999, -10.599999999999998, -14.6, -10.9, -8.600000000000001, -19.2, -29.200000000000003, -13.3, -4.4, -7.3, -4.6000000000000005, -13.2, -5.3, -10.699999999999996, -26.0, -19.2, -9.799999999999997, -29.2, -8.4, -18.699999999999996, -10.599999999999998, -6.4, -16.5, -3.2, -19.099999999999998, -3.3, -3.2, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9291817026014545, "mean_inference_ms": 1.1910812743525556, "mean_action_processing_ms": 0.06547640062257026, "mean_env_wait_ms": 5.4422743572812395, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 844000, "timesteps_this_iter": 0, "agent_timesteps_total": 844000, "timers": {"sample_time_ms": 15342.823, "sample_throughput": 260.708, "load_time_ms": 0.365, "load_throughput": 10971954.745, "learn_time_ms": 7243.666, "learn_throughput": 552.207, "update_time_ms": 1.452}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.1173197965500676, "policy_loss": -0.010506575543593655, "vf_loss": 12.782343155914738, "vf_explained_var": 0.17615531836786577, "kl": 0.015884756380931588, "entropy": 0.15407454864953155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 844000, "num_agent_steps_sampled": 844000, "num_steps_trained": 844000, "num_agent_steps_trained": 844000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8440, "training_iteration": 211, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-34-42", "timestamp": 1643668482, "time_this_iter_s": 15.093008995056152, "time_total_s": 3155.701726913452, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3155.701726913452, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 27.271428571428572, "ram_util_percent": 72.79999999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -87.3, "episode_reward_mean": -14.011000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -3.3, -9.4, -3.0000000000000004, -4.2, -11.9, -6.5, -10.4, -4.4, -79.3, -4.4, -3.3, -84.3, -12.999999999999996, -4.300000000000001, -21.400000000000013, -6.2, -24.6, -14.899999999999999, -87.3, -16.6, -15.499999999999998, -11.599999999999998, -16.299999999999997, -3.2, -7.4, -12.2, -8.4, -18.3, -17.0, -5.4, -13.19999999999997, -11.899999999999999, -10.599999999999998, -14.6, -10.9, -8.600000000000001, -19.2, -29.200000000000003, -13.3, -4.4, -7.3, -4.6000000000000005, -13.2, -5.3, -10.699999999999996, -26.0, -19.2, -9.799999999999997, -29.2, -8.4, -18.699999999999996, -10.599999999999998, -6.4, -16.5, -3.2, -19.099999999999998, -3.3, -3.2, -4.300000000000001, -4.2, -38.1, -13.399999999999999, -13.399999999999997, -3.3, -9.7, -16.6, -13.700000000000001, -11.4, -5.2, -7.0, -5.2, -36.4, -22.400000000000006, -4.300000000000001, -10.799999999999995, -3.4, -19.6, -4.300000000000001, -33.3, -28.900000000000002, -16.5, -26.2, -5.2, -2.2, -10.7, -13.599999999999998, -8.3, -12.3, -4.2, -3.2, -18.6, -9.3, -2.9000000000000004, -4.300000000000001, -3.2, -22.900000000000002, -4.3, -16.199999999999974, -26.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9290782172245131, "mean_inference_ms": 1.191160273417661, "mean_action_processing_ms": 0.0654780707132182, "mean_env_wait_ms": 5.442414413551408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 848000, "timesteps_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"sample_time_ms": 15287.678, "sample_throughput": 261.649, "load_time_ms": 0.381, "load_throughput": 10502827.094, "learn_time_ms": 7184.137, "learn_throughput": 556.782, "update_time_ms": 1.441}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.17259035413804394, "policy_loss": -0.010045101263269943, "vf_loss": 18.263396896085432, "vf_explained_var": 0.04075953729691044, "kl": 0.008053862143490081, "entropy": 0.1657854461862195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 848000, "num_agent_steps_sampled": 848000, "num_steps_trained": 848000, "num_agent_steps_trained": 848000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8480, "training_iteration": 212, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-34-57", "timestamp": 1643668497, "time_this_iter_s": 14.967698097229004, "time_total_s": 3170.669425010681, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3170.669425010681, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 23.514285714285716, "ram_util_percent": 72.82857142857144}}
{"episode_reward_max": -2.2, "episode_reward_min": -43.4, "episode_reward_mean": -12.479000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -7.3, -4.6000000000000005, -13.2, -5.3, -10.699999999999996, -26.0, -19.2, -9.799999999999997, -29.2, -8.4, -18.699999999999996, -10.599999999999998, -6.4, -16.5, -3.2, -19.099999999999998, -3.3, -3.2, -4.300000000000001, -4.2, -38.1, -13.399999999999999, -13.399999999999997, -3.3, -9.7, -16.6, -13.700000000000001, -11.4, -5.2, -7.0, -5.2, -36.4, -22.400000000000006, -4.300000000000001, -10.799999999999995, -3.4, -19.6, -4.300000000000001, -33.3, -28.900000000000002, -16.5, -26.2, -5.2, -2.2, -10.7, -13.599999999999998, -8.3, -12.3, -4.2, -3.2, -18.6, -9.3, -2.9000000000000004, -4.300000000000001, -3.2, -22.900000000000002, -4.3, -16.199999999999974, -26.2, -15.799999999999997, -16.7, -13.699999999999998, -3.3, -4.4, -5.799999999999999, -16.099999999999998, -4.2, -14.7, -3.2, -3.3, -17.599999999999987, -10.4, -3.2, -3.4, -15.599999999999998, -14.599999999999998, -5.2, -3.2, -20.999999999999993, -20.0, -3.3, -12.199999999999985, -3.2, -39.10000000000006, -29.600000000000005, -11.5, -29.3, -13.5, -43.4, -6.699999999999998, -9.0, -4.700000000000002, -14.699999999999998, -6.300000000000001, -4.2, -14.5, -22.200000000000003, -11.3, -15.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9290159143177144, "mean_inference_ms": 1.1912357424258926, "mean_action_processing_ms": 0.06547824663574349, "mean_env_wait_ms": 5.44247816183123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 852000, "timesteps_this_iter": 0, "agent_timesteps_total": 852000, "timers": {"sample_time_ms": 15230.2, "sample_throughput": 262.636, "load_time_ms": 0.38, "load_throughput": 10521929.131, "learn_time_ms": 7190.986, "learn_throughput": 556.252, "update_time_ms": 1.426}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.19331423403865466, "policy_loss": -0.0022370399424045157, "vf_loss": 19.554946831221223, "vf_explained_var": 0.004097137528081094, "kl": 0.009768058654740034, "entropy": 0.18511142611543657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 852000, "num_agent_steps_sampled": 852000, "num_steps_trained": 852000, "num_agent_steps_trained": 852000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8520, "training_iteration": 213, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-35-12", "timestamp": 1643668512, "time_this_iter_s": 15.03806209564209, "time_total_s": 3185.7074871063232, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3185.7074871063232, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 24.345454545454547, "ram_util_percent": 72.82727272727271}}
{"episode_reward_max": -2.2, "episode_reward_min": -53.49999999999998, "episode_reward_mean": -13.270999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.900000000000002, -16.5, -26.2, -5.2, -2.2, -10.7, -13.599999999999998, -8.3, -12.3, -4.2, -3.2, -18.6, -9.3, -2.9000000000000004, -4.300000000000001, -3.2, -22.900000000000002, -4.3, -16.199999999999974, -26.2, -15.799999999999997, -16.7, -13.699999999999998, -3.3, -4.4, -5.799999999999999, -16.099999999999998, -4.2, -14.7, -3.2, -3.3, -17.599999999999987, -10.4, -3.2, -3.4, -15.599999999999998, -14.599999999999998, -5.2, -3.2, -20.999999999999993, -20.0, -3.3, -12.199999999999985, -3.2, -39.10000000000006, -29.600000000000005, -11.5, -29.3, -13.5, -43.4, -6.699999999999998, -9.0, -4.700000000000002, -14.699999999999998, -6.300000000000001, -4.2, -14.5, -22.200000000000003, -11.3, -15.5, -11.3, -13.499999999999996, -19.2, -28.0, -18.900000000000006, -13.8, -3.2, -3.2, -23.000000000000032, -3.4, -4.2, -13.999999999999972, -12.199999999999998, -18.2, -18.00000000000001, -16.9, -15.2, -15.3, -14.199999999999983, -8.0, -4.2, -10.7, -17.400000000000002, -5.3, -4.3, -15.499999999999996, -4.300000000000001, -14.499999999999995, -15.5, -7.2, -17.3, -17.499999999999996, -22.9, -53.49999999999998, -21.800000000000004, -12.799999999999997, -14.199999999999996, -24.799999999999997, -5.3, -15.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9289308264082067, "mean_inference_ms": 1.1912940892623844, "mean_action_processing_ms": 0.06547573949361889, "mean_env_wait_ms": 5.442428103407731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 856000, "timesteps_this_iter": 0, "agent_timesteps_total": 856000, "timers": {"sample_time_ms": 15216.087, "sample_throughput": 262.88, "load_time_ms": 0.38, "load_throughput": 10522589.062, "learn_time_ms": 7158.43, "learn_throughput": 558.782, "update_time_ms": 1.409}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.18213447870846877, "policy_loss": 0.0032475977725479554, "vf_loss": 17.88850638648515, "vf_explained_var": 0.17699218296235608, "kl": 0.009833825256336224, "entropy": 0.18469683771492332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 856000, "num_agent_steps_sampled": 856000, "num_steps_trained": 856000, "num_agent_steps_trained": 856000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8560, "training_iteration": 214, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-35-28", "timestamp": 1643668528, "time_this_iter_s": 15.143306970596313, "time_total_s": 3200.8507940769196, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3200.8507940769196, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 26.304761904761904, "ram_util_percent": 72.83333333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -133.30000000000007, "episode_reward_mean": -14.531999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -3.3, -12.199999999999985, -3.2, -39.10000000000006, -29.600000000000005, -11.5, -29.3, -13.5, -43.4, -6.699999999999998, -9.0, -4.700000000000002, -14.699999999999998, -6.300000000000001, -4.2, -14.5, -22.200000000000003, -11.3, -15.5, -11.3, -13.499999999999996, -19.2, -28.0, -18.900000000000006, -13.8, -3.2, -3.2, -23.000000000000032, -3.4, -4.2, -13.999999999999972, -12.199999999999998, -18.2, -18.00000000000001, -16.9, -15.2, -15.3, -14.199999999999983, -8.0, -4.2, -10.7, -17.400000000000002, -5.3, -4.3, -15.499999999999996, -4.300000000000001, -14.499999999999995, -15.5, -7.2, -17.3, -17.499999999999996, -22.9, -53.49999999999998, -21.800000000000004, -12.799999999999997, -14.199999999999996, -24.799999999999997, -5.3, -15.6, -10.500000000000002, -3.2, -9.899999999999999, -8.2, -10.399999999999997, -5.6, -21.100000000000012, -17.699999999999996, -8.3, -27.2, -7.3, -20.4, -5.4, -5.3, -16.6, -15.7, -3.4, -3.2, -7.0, -15.799999999999999, -21.3, -17.9, -3.2, -18.800000000000008, -3.3, -6.300000000000001, -10.3, -20.999999999999996, -5.2, -13.19999999999997, -133.30000000000007, -12.999999999999998, -3.3, -18.0, -10.6, -3.2, -12.299999999999997, -3.3, -14.599999999999998, -6.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9288624739818667, "mean_inference_ms": 1.1913322683777872, "mean_action_processing_ms": 0.06547400965873144, "mean_env_wait_ms": 5.442313825413237, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 860000, "timesteps_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"sample_time_ms": 15194.792, "sample_throughput": 263.248, "load_time_ms": 0.383, "load_throughput": 10434889.912, "learn_time_ms": 7150.646, "learn_throughput": 559.39, "update_time_ms": 1.411}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.7222317800743215, "policy_loss": -0.012290587215634283, "vf_loss": 73.45201451996321, "vf_explained_var": 0.16233909533869836, "kl": 0.012063549000165897, "entropy": 0.18092576244104935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 860000, "num_agent_steps_sampled": 860000, "num_steps_trained": 860000, "num_agent_steps_trained": 860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8600, "training_iteration": 215, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-35-42", "timestamp": 1643668542, "time_this_iter_s": 14.931782722473145, "time_total_s": 3215.7825767993927, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3215.7825767993927, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 26.468181818181822, "ram_util_percent": 72.85909090909091}}
{"episode_reward_max": -3.2, "episode_reward_min": -133.30000000000007, "episode_reward_mean": -12.868, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -10.7, -17.400000000000002, -5.3, -4.3, -15.499999999999996, -4.300000000000001, -14.499999999999995, -15.5, -7.2, -17.3, -17.499999999999996, -22.9, -53.49999999999998, -21.800000000000004, -12.799999999999997, -14.199999999999996, -24.799999999999997, -5.3, -15.6, -10.500000000000002, -3.2, -9.899999999999999, -8.2, -10.399999999999997, -5.6, -21.100000000000012, -17.699999999999996, -8.3, -27.2, -7.3, -20.4, -5.4, -5.3, -16.6, -15.7, -3.4, -3.2, -7.0, -15.799999999999999, -21.3, -17.9, -3.2, -18.800000000000008, -3.3, -6.300000000000001, -10.3, -20.999999999999996, -5.2, -13.19999999999997, -133.30000000000007, -12.999999999999998, -3.3, -18.0, -10.6, -3.2, -12.299999999999997, -3.3, -14.599999999999998, -6.4, -5.3, -28.3, -3.3, -26.20000000000001, -5.3, -15.799999999999992, -3.3, -33.199999999999946, -4.3, -3.3, -12.999999999999998, -15.999999999999996, -7.3, -11.299999999999995, -7.3, -16.7, -4.300000000000001, -19.9, -3.2, -7.3, -7.3, -12.199999999999998, -3.2, -4.2, -8.4, -3.2, -3.3, -20.799999999999997, -9.3, -10.799999999999999, -12.199999999999974, -25.2, -3.2, -9.399999999999999, -8.899999999999999, -4.3, -10.999999999999998, -3.3, -18.89999999999999, -7.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9289338826261024, "mean_inference_ms": 1.191419538531546, "mean_action_processing_ms": 0.06547626524273255, "mean_env_wait_ms": 5.442641372460068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 864000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 15172.273, "sample_throughput": 263.639, "load_time_ms": 0.389, "load_throughput": 10276378.782, "learn_time_ms": 7137.682, "learn_throughput": 560.406, "update_time_ms": 1.401}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.11771457484542763, "policy_loss": -0.00862638714813417, "vf_loss": 12.633992040605955, "vf_explained_var": 0.16197226515380286, "kl": 0.005644711941019843, "entropy": 0.1692706209236896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 864000, "num_agent_steps_sampled": 864000, "num_steps_trained": 864000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8640, "training_iteration": 216, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-35-58", "timestamp": 1643668558, "time_this_iter_s": 15.328134775161743, "time_total_s": 3231.1107115745544, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3231.1107115745544, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 23.052380952380947, "ram_util_percent": 72.90000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -133.30000000000007, "episode_reward_mean": -12.279000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.3, -17.9, -3.2, -18.800000000000008, -3.3, -6.300000000000001, -10.3, -20.999999999999996, -5.2, -13.19999999999997, -133.30000000000007, -12.999999999999998, -3.3, -18.0, -10.6, -3.2, -12.299999999999997, -3.3, -14.599999999999998, -6.4, -5.3, -28.3, -3.3, -26.20000000000001, -5.3, -15.799999999999992, -3.3, -33.199999999999946, -4.3, -3.3, -12.999999999999998, -15.999999999999996, -7.3, -11.299999999999995, -7.3, -16.7, -4.300000000000001, -19.9, -3.2, -7.3, -7.3, -12.199999999999998, -3.2, -4.2, -8.4, -3.2, -3.3, -20.799999999999997, -9.3, -10.799999999999999, -12.199999999999974, -25.2, -3.2, -9.399999999999999, -8.899999999999999, -4.3, -10.999999999999998, -3.3, -18.89999999999999, -7.799999999999999, -16.3, -9.2, -12.2, -6.2, -15.199999999999998, -12.899999999999999, -7.2, -15.999999999999982, -11.199999999999996, -3.3, -3.2, -17.800000000000004, -14.899999999999999, -3.2, -17.799999999999997, -14.799999999999999, -4.2, -3.3, -4.2, -24.9, -14.7, -13.499999999999998, -17.7, -18.6, -13.899999999999972, -3.2, -5.2, -17.7, -12.499999999999998, -3.2, -21.399999999999977, -22.2, -10.600000000000001, -8.299999999999997, -11.699999999999998, -4.4, -18.2, -15.2, -7.2, -10.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9290071473850494, "mean_inference_ms": 1.1915246209033739, "mean_action_processing_ms": 0.06547781289294312, "mean_env_wait_ms": 5.443075773084034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 868000, "timesteps_this_iter": 0, "agent_timesteps_total": 868000, "timers": {"sample_time_ms": 15158.367, "sample_throughput": 263.881, "load_time_ms": 0.394, "load_throughput": 10164313.583, "learn_time_ms": 7087.628, "learn_throughput": 564.364, "update_time_ms": 1.43}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.08675361307530653, "policy_loss": -0.00031109862830690156, "vf_loss": 8.706278002518479, "vf_explained_var": 0.35162286803286563, "kl": 0.010426113222058973, "entropy": 0.1873529878595183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 868000, "num_agent_steps_sampled": 868000, "num_steps_trained": 868000, "num_agent_steps_trained": 868000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8680, "training_iteration": 217, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-36-13", "timestamp": 1643668573, "time_this_iter_s": 14.860103130340576, "time_total_s": 3245.970814704895, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3245.970814704895, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 25.527272727272724, "ram_util_percent": 72.90000000000003}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.9, "episode_reward_mean": -11.521999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3, -12.199999999999998, -3.2, -4.2, -8.4, -3.2, -3.3, -20.799999999999997, -9.3, -10.799999999999999, -12.199999999999974, -25.2, -3.2, -9.399999999999999, -8.899999999999999, -4.3, -10.999999999999998, -3.3, -18.89999999999999, -7.799999999999999, -16.3, -9.2, -12.2, -6.2, -15.199999999999998, -12.899999999999999, -7.2, -15.999999999999982, -11.199999999999996, -3.3, -3.2, -17.800000000000004, -14.899999999999999, -3.2, -17.799999999999997, -14.799999999999999, -4.2, -3.3, -4.2, -24.9, -14.7, -13.499999999999998, -17.7, -18.6, -13.899999999999972, -3.2, -5.2, -17.7, -12.499999999999998, -3.2, -21.399999999999977, -22.2, -10.600000000000001, -8.299999999999997, -11.699999999999998, -4.4, -18.2, -15.2, -7.2, -10.499999999999998, -3.2, -9.3, -3.2, -3.4, -20.299999999999997, -3.2, -11.199999999999976, -9.499999999999996, -30.6, -18.099999999999998, -14.3, -11.3, -7.599999999999999, -30.9, -8.9, -16.599999999999998, -8.8, -15.599999999999998, -10.4, -4.2, -19.900000000000006, -13.2, -22.70000000000002, -17.8, -13.5, -17.4, -7.2, -30.2, -3.4, -3.2, -3.4, -12.3, -20.799999999999997, -4.4, -3.3, -9.099999999999998, -14.3, -13.9, -22.6, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9291282211415917, "mean_inference_ms": 1.1918840566722892, "mean_action_processing_ms": 0.06549028399141026, "mean_env_wait_ms": 5.444461611396216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 872000, "timesteps_this_iter": 0, "agent_timesteps_total": 872000, "timers": {"sample_time_ms": 15170.814, "sample_throughput": 263.664, "load_time_ms": 0.394, "load_throughput": 10154470.403, "learn_time_ms": 7130.444, "learn_throughput": 560.975, "update_time_ms": 1.435}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.11448056417447265, "policy_loss": -0.007583557851412284, "vf_loss": 12.206269909233175, "vf_explained_var": 0.19357010292750532, "kl": 0.007695782979721473, "entropy": 0.1785021048319596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 872000, "num_agent_steps_sampled": 872000, "num_steps_trained": 872000, "num_agent_steps_trained": 872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8720, "training_iteration": 218, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-36-29", "timestamp": 1643668589, "time_this_iter_s": 16.34880828857422, "time_total_s": 3262.3196229934692, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3262.3196229934692, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 34.43913043478261, "ram_util_percent": 73.14782608695653}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.3, "episode_reward_mean": -12.131999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.7, -13.499999999999998, -17.7, -18.6, -13.899999999999972, -3.2, -5.2, -17.7, -12.499999999999998, -3.2, -21.399999999999977, -22.2, -10.600000000000001, -8.299999999999997, -11.699999999999998, -4.4, -18.2, -15.2, -7.2, -10.499999999999998, -3.2, -9.3, -3.2, -3.4, -20.299999999999997, -3.2, -11.199999999999976, -9.499999999999996, -30.6, -18.099999999999998, -14.3, -11.3, -7.599999999999999, -30.9, -8.9, -16.599999999999998, -8.8, -15.599999999999998, -10.4, -4.2, -19.900000000000006, -13.2, -22.70000000000002, -17.8, -13.5, -17.4, -7.2, -30.2, -3.4, -3.2, -3.4, -12.3, -20.799999999999997, -4.4, -3.3, -9.099999999999998, -14.3, -13.9, -22.6, -4.2, -5.300000000000001, -13.3, -18.6, -12.5, -11.59999999999998, -3.3, -22.799999999999997, -7.3, -19.799999999999997, -3.2, -10.899999999999999, -12.7, -17.5, -20.5, -8.999999999999998, -11.600000000000001, -3.3, -3.2, -19.400000000000002, -7.3, -20.599999999999998, -7.799999999999999, -3.4, -12.399999999999999, -3.3, -14.999999999999998, -3.3, -3.3, -14.6, -3.3, -16.4, -3.4, -12.299999999999999, -14.999999999999998, -20.8, -3.3, -3.3, -12.799999999999997, -52.3, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9292330168289183, "mean_inference_ms": 1.1919750951531298, "mean_action_processing_ms": 0.06549006420025343, "mean_env_wait_ms": 5.444746879898243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 876000, "timesteps_this_iter": 0, "agent_timesteps_total": 876000, "timers": {"sample_time_ms": 15141.73, "sample_throughput": 264.171, "load_time_ms": 0.393, "load_throughput": 10173558.911, "learn_time_ms": 7122.691, "learn_throughput": 561.585, "update_time_ms": 1.479}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.1628055282405287, "policy_loss": -0.0057440864222664985, "vf_loss": 16.854771309129653, "vf_explained_var": 0.1800151098799962, "kl": 0.01028315324425183, "entropy": 0.15985044389362296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 876000, "num_agent_steps_sampled": 876000, "num_steps_trained": 876000, "num_agent_steps_trained": 876000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8760, "training_iteration": 219, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-36-43", "timestamp": 1643668603, "time_this_iter_s": 14.319808959960938, "time_total_s": 3276.63943195343, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3276.63943195343, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 27.079999999999995, "ram_util_percent": 73.30500000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.3, "episode_reward_mean": -12.408, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.900000000000006, -13.2, -22.70000000000002, -17.8, -13.5, -17.4, -7.2, -30.2, -3.4, -3.2, -3.4, -12.3, -20.799999999999997, -4.4, -3.3, -9.099999999999998, -14.3, -13.9, -22.6, -4.2, -5.300000000000001, -13.3, -18.6, -12.5, -11.59999999999998, -3.3, -22.799999999999997, -7.3, -19.799999999999997, -3.2, -10.899999999999999, -12.7, -17.5, -20.5, -8.999999999999998, -11.600000000000001, -3.3, -3.2, -19.400000000000002, -7.3, -20.599999999999998, -7.799999999999999, -3.4, -12.399999999999999, -3.3, -14.999999999999998, -3.3, -3.3, -14.6, -3.3, -16.4, -3.4, -12.299999999999999, -14.999999999999998, -20.8, -3.3, -3.3, -12.799999999999997, -52.3, -6.2, -3.3, -3.3, -46.2, -21.300000000000004, -8.4, -11.5, -13.699999999999998, -20.5, -15.2, -27.4, -3.4, -3.2, -22.299999999999997, -9.899999999999999, -15.8, -8.8, -6.4, -12.199999999999998, -15.5, -13.2, -18.900000000000006, -3.7, -12.5, -19.199999999999985, -21.3, -4.3, -30.4, -3.2, -30.200000000000017, -4.3, -4.2, -21.5, -17.699999999999996, -4.4, -3.3, -20.2, -6.3, -3.3, -3.3, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9292368030982093, "mean_inference_ms": 1.1922418027025101, "mean_action_processing_ms": 0.06552309152420217, "mean_env_wait_ms": 5.44614781217701, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"sample_time_ms": 15240.103, "sample_throughput": 262.465, "load_time_ms": 0.372, "load_throughput": 10753247.02, "learn_time_ms": 7041.945, "learn_throughput": 568.025, "update_time_ms": 1.484}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.17756435745596005, "policy_loss": -0.00950333018416679, "vf_loss": 18.706556099845518, "vf_explained_var": 0.22385587301305546, "kl": 0.011482803693866025, "entropy": 0.15637956889326213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 880000, "num_steps_trained": 880000, "num_agent_steps_trained": 880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8800, "training_iteration": 220, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-36-59", "timestamp": 1643668619, "time_this_iter_s": 15.30760908126831, "time_total_s": 3291.9470410346985, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3291.9470410346985, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 28.263636363636362, "ram_util_percent": 72.70454545454548}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.3, "episode_reward_mean": -12.172000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.599999999999998, -7.799999999999999, -3.4, -12.399999999999999, -3.3, -14.999999999999998, -3.3, -3.3, -14.6, -3.3, -16.4, -3.4, -12.299999999999999, -14.999999999999998, -20.8, -3.3, -3.3, -12.799999999999997, -52.3, -6.2, -3.3, -3.3, -46.2, -21.300000000000004, -8.4, -11.5, -13.699999999999998, -20.5, -15.2, -27.4, -3.4, -3.2, -22.299999999999997, -9.899999999999999, -15.8, -8.8, -6.4, -12.199999999999998, -15.5, -13.2, -18.900000000000006, -3.7, -12.5, -19.199999999999985, -21.3, -4.3, -30.4, -3.2, -30.200000000000017, -4.3, -4.2, -21.5, -17.699999999999996, -4.4, -3.3, -20.2, -6.3, -3.3, -3.3, -4.4, -3.2, -3.3, -12.5, -17.199999999999996, -3.4, -14.699999999999994, -4.2, -4.300000000000001, -6.4, -3.4, -13.799999999999997, -18.599999999999998, -13.2, -4.300000000000001, -22.9, -3.3, -22.900000000000002, -11.2, -15.7, -18.700000000000003, -7.3, -6.3, -10.8, -35.899999999999935, -21.599999999999994, -8.2, -15.5, -22.7, -21.5, -3.3, -26.600000000000005, -4.3, -3.2, -11.4, -3.4, -14.899999999999999, -3.2, -3.2, -12.899999999999999, -12.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.929043772620645, "mean_inference_ms": 1.1923739550371684, "mean_action_processing_ms": 0.06554835461462058, "mean_env_wait_ms": 5.447063604971211, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 884000, "timesteps_this_iter": 0, "agent_timesteps_total": 884000, "timers": {"sample_time_ms": 15123.459, "sample_throughput": 264.49, "load_time_ms": 0.37, "load_throughput": 10803796.767, "learn_time_ms": 7011.895, "learn_throughput": 570.459, "update_time_ms": 1.478}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.12733964045602147, "policy_loss": -0.0075209502381102375, "vf_loss": 13.485717663393226, "vf_explained_var": 0.3642874373543647, "kl": 0.018425549438609946, "entropy": 0.15625172185321007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 884000, "num_agent_steps_sampled": 884000, "num_steps_trained": 884000, "num_agent_steps_trained": 884000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8840, "training_iteration": 221, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-37-13", "timestamp": 1643668633, "time_this_iter_s": 14.433968782424927, "time_total_s": 3306.3810098171234, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3306.3810098171234, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 21.419047619047618, "ram_util_percent": 72.53333333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -36.60000000000001, "episode_reward_mean": -12.041000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.900000000000006, -3.7, -12.5, -19.199999999999985, -21.3, -4.3, -30.4, -3.2, -30.200000000000017, -4.3, -4.2, -21.5, -17.699999999999996, -4.4, -3.3, -20.2, -6.3, -3.3, -3.3, -4.4, -3.2, -3.3, -12.5, -17.199999999999996, -3.4, -14.699999999999994, -4.2, -4.300000000000001, -6.4, -3.4, -13.799999999999997, -18.599999999999998, -13.2, -4.300000000000001, -22.9, -3.3, -22.900000000000002, -11.2, -15.7, -18.700000000000003, -7.3, -6.3, -10.8, -35.899999999999935, -21.599999999999994, -8.2, -15.5, -22.7, -21.5, -3.3, -26.600000000000005, -4.3, -3.2, -11.4, -3.4, -14.899999999999999, -3.2, -3.2, -12.899999999999999, -12.899999999999999, -7.3, -3.3, -11.799999999999999, -3.3, -18.5, -36.60000000000001, -17.4, -13.599999999999998, -3.2, -9.3, -7.4, -10.7, -4.4, -21.599999999999994, -9.2, -7.2, -15.4, -12.999999999999972, -7.3, -21.4, -15.3, -4.300000000000001, -13.399999999999999, -20.5, -3.3, -23.799999999999997, -3.3, -5.3, -21.7, -8.099999999999998, -5.3, -14.5, -10.2, -20.900000000000006, -7.2, -14.5, -9.899999999999999, -14.7, -17.2, -25.900000000000027], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9288146552115952, "mean_inference_ms": 1.1922820621388146, "mean_action_processing_ms": 0.06556178447543727, "mean_env_wait_ms": 5.447055498465548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 888000, "timesteps_this_iter": 0, "agent_timesteps_total": 888000, "timers": {"sample_time_ms": 15046.97, "sample_throughput": 265.834, "load_time_ms": 0.358, "load_throughput": 11181828.846, "learn_time_ms": 7079.794, "learn_throughput": 564.988, "update_time_ms": 1.916}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.14472049862992578, "policy_loss": -0.004700817509744597, "vf_loss": 14.941945372025172, "vf_explained_var": 0.16452109480416902, "kl": 0.01007845019764723, "entropy": 0.15973793240965053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 888000, "num_agent_steps_sampled": 888000, "num_steps_trained": 888000, "num_agent_steps_trained": 888000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8880, "training_iteration": 222, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-37-28", "timestamp": 1643668648, "time_this_iter_s": 15.199169635772705, "time_total_s": 3321.580179452896, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3321.580179452896, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 30.599999999999994, "ram_util_percent": 72.98095238095236}}
{"episode_reward_max": -1.2, "episode_reward_min": -48.100000000000065, "episode_reward_mean": -12.726, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3, -6.3, -10.8, -35.899999999999935, -21.599999999999994, -8.2, -15.5, -22.7, -21.5, -3.3, -26.600000000000005, -4.3, -3.2, -11.4, -3.4, -14.899999999999999, -3.2, -3.2, -12.899999999999999, -12.899999999999999, -7.3, -3.3, -11.799999999999999, -3.3, -18.5, -36.60000000000001, -17.4, -13.599999999999998, -3.2, -9.3, -7.4, -10.7, -4.4, -21.599999999999994, -9.2, -7.2, -15.4, -12.999999999999972, -7.3, -21.4, -15.3, -4.300000000000001, -13.399999999999999, -20.5, -3.3, -23.799999999999997, -3.3, -5.3, -21.7, -8.099999999999998, -5.3, -14.5, -10.2, -20.900000000000006, -7.2, -14.5, -9.899999999999999, -14.7, -17.2, -25.900000000000027, -14.9, -20.7, -48.100000000000065, -1.2, -9.3, -8.7, -19.6, -8.2, -15.299999999999997, -15.6, -4.2, -3.3, -30.2, -9.3, -5.300000000000001, -21.3, -8.3, -31.200000000000003, -3.3, -22.7, -16.799999999999994, -15.999999999999998, -3.2, -9.100000000000001, -3.2, -3.3, -14.9, -11.599999999999996, -27.2, -3.3, -15.799999999999999, -12.6, -9.3, -13.6, -16.6, -4.5, -8.5, -11.199999999999976, -3.4, -17.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9285202320644811, "mean_inference_ms": 1.1921670182435358, "mean_action_processing_ms": 0.06555559460286993, "mean_env_wait_ms": 5.446768801255534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 892000, "timesteps_this_iter": 0, "agent_timesteps_total": 892000, "timers": {"sample_time_ms": 15143.761, "sample_throughput": 264.135, "load_time_ms": 0.356, "load_throughput": 11250815.451, "learn_time_ms": 7080.083, "learn_throughput": 564.965, "update_time_ms": 1.919}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.19481885305665914, "policy_loss": -0.0037853984788100243, "vf_loss": 19.860248303028843, "vf_explained_var": 0.015580123598857593, "kl": 0.009550869282408841, "entropy": 0.21479586989328425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 892000, "num_agent_steps_sampled": 892000, "num_steps_trained": 892000, "num_agent_steps_trained": 892000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8920, "training_iteration": 223, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-37-44", "timestamp": 1643668664, "time_this_iter_s": 15.310205936431885, "time_total_s": 3336.890385389328, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3336.890385389328, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 27.39545454545454, "ram_util_percent": 72.7863636363636}}
{"episode_reward_max": -1.2, "episode_reward_min": -106.99999999999991, "episode_reward_mean": -12.684000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.3, -4.300000000000001, -13.399999999999999, -20.5, -3.3, -23.799999999999997, -3.3, -5.3, -21.7, -8.099999999999998, -5.3, -14.5, -10.2, -20.900000000000006, -7.2, -14.5, -9.899999999999999, -14.7, -17.2, -25.900000000000027, -14.9, -20.7, -48.100000000000065, -1.2, -9.3, -8.7, -19.6, -8.2, -15.299999999999997, -15.6, -4.2, -3.3, -30.2, -9.3, -5.300000000000001, -21.3, -8.3, -31.200000000000003, -3.3, -22.7, -16.799999999999994, -15.999999999999998, -3.2, -9.100000000000001, -3.2, -3.3, -14.9, -11.599999999999996, -27.2, -3.3, -15.799999999999999, -12.6, -9.3, -13.6, -16.6, -4.5, -8.5, -11.199999999999976, -3.4, -17.5, -3.4, -21.900000000000002, -13.7, -5.9, -5.699999999999999, -10.8, -3.2, -24.800000000000008, -4.2, -23.70000000000001, -5.799999999999999, -3.2, -4.2, -5.4, -25.7, -21.799999999999997, -4.2, -3.3, -18.4, -3.2, -4.300000000000001, -22.999999999999996, -15.5, -14.599999999999998, -11.999999999999998, -3.2, -3.3, -3.2, -5.300000000000001, -106.99999999999991, -4.800000000000001, -29.900000000000013, -3.2, -3.3, -3.4, -3.4, -9.0, -3.2, -17.0, -5.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9283764642273675, "mean_inference_ms": 1.1921002806475607, "mean_action_processing_ms": 0.06555138520346997, "mean_env_wait_ms": 5.446746175415385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 896000, "timesteps_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"sample_time_ms": 15124.878, "sample_throughput": 264.465, "load_time_ms": 0.355, "load_throughput": 11268952.176, "learn_time_ms": 7063.801, "learn_throughput": 566.267, "update_time_ms": 2.024}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 0.00010000000000000003, "total_loss": 0.6655819320139946, "policy_loss": -0.015916312189011645, "vf_loss": 68.14929435586417, "vf_explained_var": -0.13534672106465986, "kl": 0.028719974237992083, "entropy": 0.1786097725633011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 896000, "num_agent_steps_sampled": 896000, "num_steps_trained": 896000, "num_agent_steps_trained": 896000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8960, "training_iteration": 224, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-37-59", "timestamp": 1643668679, "time_this_iter_s": 14.794854879379272, "time_total_s": 3351.6852402687073, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3351.6852402687073, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 25.5, "ram_util_percent": 72.53333333333335}}
{"episode_reward_max": -3.2, "episode_reward_min": -106.99999999999991, "episode_reward_mean": -10.812999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.799999999999994, -15.999999999999998, -3.2, -9.100000000000001, -3.2, -3.3, -14.9, -11.599999999999996, -27.2, -3.3, -15.799999999999999, -12.6, -9.3, -13.6, -16.6, -4.5, -8.5, -11.199999999999976, -3.4, -17.5, -3.4, -21.900000000000002, -13.7, -5.9, -5.699999999999999, -10.8, -3.2, -24.800000000000008, -4.2, -23.70000000000001, -5.799999999999999, -3.2, -4.2, -5.4, -25.7, -21.799999999999997, -4.2, -3.3, -18.4, -3.2, -4.300000000000001, -22.999999999999996, -15.5, -14.599999999999998, -11.999999999999998, -3.2, -3.3, -3.2, -5.300000000000001, -106.99999999999991, -4.800000000000001, -29.900000000000013, -3.2, -3.3, -3.4, -3.4, -9.0, -3.2, -17.0, -5.699999999999999, -4.2, -8.3, -3.3, -22.200000000000014, -17.500000000000004, -11.299999999999999, -3.3, -5.4, -18.9, -3.3, -6.3, -4.4, -7.3, -4.300000000000001, -12.5, -18.8, -3.3, -10.3, -3.3, -13.799999999999995, -10.5, -12.799999999999999, -6.3, -11.799999999999995, -14.0, -5.2, -19.700000000000006, -3.3, -10.899999999999999, -4.2, -4.2, -13.5, -18.700000000000003, -3.2, -18.3, -4.2, -4.3, -19.100000000000033, -3.3, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9284479039292054, "mean_inference_ms": 1.1922505837135022, "mean_action_processing_ms": 0.06556038722396645, "mean_env_wait_ms": 5.447954897054788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 900000, "timesteps_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 15213.894, "sample_throughput": 262.918, "load_time_ms": 0.354, "load_throughput": 11314550.85, "learn_time_ms": 7113.116, "learn_throughput": 562.341, "update_time_ms": 2.023}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002780914306640624, "cur_lr": 0.00010000000000000003, "total_loss": 0.06410397812023118, "policy_loss": -0.011312135983939453, "vf_loss": 7.541314366235528, "vf_explained_var": 0.2708052837079571, "kl": 0.010690028610396746, "entropy": 0.19557894489137076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 900000, "num_steps_trained": 900000, "num_agent_steps_trained": 900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9000, "training_iteration": 225, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-38-15", "timestamp": 1643668695, "time_this_iter_s": 16.473021268844604, "time_total_s": 3368.158261537552, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3368.158261537552, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 28.629166666666674, "ram_util_percent": 71.77499999999999}}
{"episode_reward_max": -1.2, "episode_reward_min": -106.99999999999991, "episode_reward_mean": -10.593, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -22.999999999999996, -15.5, -14.599999999999998, -11.999999999999998, -3.2, -3.3, -3.2, -5.300000000000001, -106.99999999999991, -4.800000000000001, -29.900000000000013, -3.2, -3.3, -3.4, -3.4, -9.0, -3.2, -17.0, -5.699999999999999, -4.2, -8.3, -3.3, -22.200000000000014, -17.500000000000004, -11.299999999999999, -3.3, -5.4, -18.9, -3.3, -6.3, -4.4, -7.3, -4.300000000000001, -12.5, -18.8, -3.3, -10.3, -3.3, -13.799999999999995, -10.5, -12.799999999999999, -6.3, -11.799999999999995, -14.0, -5.2, -19.700000000000006, -3.3, -10.899999999999999, -4.2, -4.2, -13.5, -18.700000000000003, -3.2, -18.3, -4.2, -4.3, -19.100000000000033, -3.3, -3.4, -4.2, -24.2, -5.000000000000001, -11.599999999999998, -17.599999999999998, -3.3, -14.399999999999999, -3.3, -21.199999999999957, -14.0, -5.300000000000001, -11.2, -13.19999999999997, -14.599999999999998, -6.2, -20.6, -15.799999999999999, -1.2, -5.2, -8.0, -11.3, -7.499999999999997, -7.3, -14.499999999999998, -14.899999999999999, -3.3, -7.2, -16.599999999999998, -4.2, -4.3, -10.7, -5.300000000000001, -14.399999999999999, -7.4, -4.2, -11.099999999999998, -11.9, -11.3, -21.400000000000016, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.928463235026995, "mean_inference_ms": 1.192474018748794, "mean_action_processing_ms": 0.06557283463384454, "mean_env_wait_ms": 5.449207893880221, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 904000, "timesteps_this_iter": 0, "agent_timesteps_total": 904000, "timers": {"sample_time_ms": 15257.275, "sample_throughput": 262.17, "load_time_ms": 0.353, "load_throughput": 11324479.244, "learn_time_ms": 7071.626, "learn_throughput": 565.641, "update_time_ms": 2.028}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002780914306640624, "cur_lr": 0.00010000000000000003, "total_loss": 0.06952872388365287, "policy_loss": -0.013325933857710772, "vf_loss": 8.285133256386684, "vf_explained_var": 0.2819838323900776, "kl": 0.011974671722075643, "entropy": 0.24133487923811842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 904000, "num_agent_steps_sampled": 904000, "num_steps_trained": 904000, "num_agent_steps_trained": 904000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9040, "training_iteration": 226, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-38-30", "timestamp": 1643668710, "time_this_iter_s": 14.853718996047974, "time_total_s": 3383.0119805336, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3383.0119805336, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 28.504761904761907, "ram_util_percent": 71.5809523809524}}
{"episode_reward_max": -1.2, "episode_reward_min": -90.3, "episode_reward_mean": -11.443999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -12.799999999999999, -6.3, -11.799999999999995, -14.0, -5.2, -19.700000000000006, -3.3, -10.899999999999999, -4.2, -4.2, -13.5, -18.700000000000003, -3.2, -18.3, -4.2, -4.3, -19.100000000000033, -3.3, -3.4, -4.2, -24.2, -5.000000000000001, -11.599999999999998, -17.599999999999998, -3.3, -14.399999999999999, -3.3, -21.199999999999957, -14.0, -5.300000000000001, -11.2, -13.19999999999997, -14.599999999999998, -6.2, -20.6, -15.799999999999999, -1.2, -5.2, -8.0, -11.3, -7.499999999999997, -7.3, -14.499999999999998, -14.899999999999999, -3.3, -7.2, -16.599999999999998, -4.2, -4.3, -10.7, -5.300000000000001, -14.399999999999999, -7.4, -4.2, -11.099999999999998, -11.9, -11.3, -21.400000000000016, -3.2, -11.599999999999998, -12.799999999999997, -5.3, -14.4, -4.4, -15.699999999999996, -13.899999999999999, -6.2, -7.2, -90.3, -12.0, -14.899999999999997, -25.800000000000004, -16.9, -11.499999999999996, -6.300000000000001, -6.2, -20.5, -19.7, -5.4, -8.899999999999999, -4.2, -15.6, -10.5, -3.3, -15.2, -10.9, -15.7, -3.2, -15.2, -17.8, -13.799999999999997, -4.2, -18.599999999999998, -11.399999999999997, -3.3, -6.0, -12.099999999999996, -9.0, -21.500000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9284119746679668, "mean_inference_ms": 1.1924958234969496, "mean_action_processing_ms": 0.06557436188282742, "mean_env_wait_ms": 5.449075381919304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 908000, "timesteps_this_iter": 0, "agent_timesteps_total": 908000, "timers": {"sample_time_ms": 15168.397, "sample_throughput": 263.706, "load_time_ms": 0.351, "load_throughput": 11409191.431, "learn_time_ms": 7182.077, "learn_throughput": 556.942, "update_time_ms": 1.988}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002780914306640624, "cur_lr": 0.00010000000000000003, "total_loss": 0.3608564117242412, "policy_loss": -0.00048463478263828064, "vf_loss": 36.13397005392659, "vf_explained_var": 0.20497792638758178, "kl": 0.004874337458469976, "entropy": 0.2098437415415882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 908000, "num_agent_steps_sampled": 908000, "num_steps_trained": 908000, "num_agent_steps_trained": 908000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9080, "training_iteration": 227, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-38-45", "timestamp": 1643668725, "time_this_iter_s": 15.489551782608032, "time_total_s": 3398.501532316208, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3398.501532316208, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 31.522727272727277, "ram_util_percent": 72.12272727272726}}
{"episode_reward_max": -3.2, "episode_reward_min": -90.3, "episode_reward_mean": -11.129000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -7.499999999999997, -7.3, -14.499999999999998, -14.899999999999999, -3.3, -7.2, -16.599999999999998, -4.2, -4.3, -10.7, -5.300000000000001, -14.399999999999999, -7.4, -4.2, -11.099999999999998, -11.9, -11.3, -21.400000000000016, -3.2, -11.599999999999998, -12.799999999999997, -5.3, -14.4, -4.4, -15.699999999999996, -13.899999999999999, -6.2, -7.2, -90.3, -12.0, -14.899999999999997, -25.800000000000004, -16.9, -11.499999999999996, -6.300000000000001, -6.2, -20.5, -19.7, -5.4, -8.899999999999999, -4.2, -15.6, -10.5, -3.3, -15.2, -10.9, -15.7, -3.2, -15.2, -17.8, -13.799999999999997, -4.2, -18.599999999999998, -11.399999999999997, -3.3, -6.0, -12.099999999999996, -9.0, -21.500000000000004, -6.699999999999999, -21.2, -3.3, -4.2, -3.3, -8.3, -7.3, -12.499999999999998, -6.6000000000000005, -3.3, -13.5, -19.6, -14.6, -3.3, -23.599999999999987, -32.99999999999997, -14.099999999999998, -3.3, -3.2, -5.300000000000001, -3.3, -14.899999999999999, -4.4, -4.4, -3.3, -4.4, -14.899999999999999, -9.7, -14.2, -4.4, -4.6000000000000005, -15.2, -8.2, -3.3, -8.799999999999999, -3.2, -21.300000000000004, -11.7, -3.2, -11.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9284632917682643, "mean_inference_ms": 1.192536453939549, "mean_action_processing_ms": 0.06557526935534964, "mean_env_wait_ms": 5.449327926749861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 912000, "timesteps_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"sample_time_ms": 15276.496, "sample_throughput": 261.84, "load_time_ms": 0.352, "load_throughput": 11360520.043, "learn_time_ms": 7141.661, "learn_throughput": 560.094, "update_time_ms": 1.994}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001390457153320312, "cur_lr": 0.00010000000000000003, "total_loss": 0.10393156744940306, "policy_loss": 7.18268325492259e-05, "vf_loss": 10.385873610678539, "vf_explained_var": 0.2656550396514195, "kl": 0.007261845023772281, "entropy": 0.15222396163209792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 912000, "num_agent_steps_sampled": 912000, "num_steps_trained": 912000, "num_agent_steps_trained": 912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9120, "training_iteration": 228, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-39-01", "timestamp": 1643668741, "time_this_iter_s": 15.943928956985474, "time_total_s": 3414.4454612731934, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3414.4454612731934, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 30.559090909090912, "ram_util_percent": 72.76818181818182}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.4, "episode_reward_mean": -10.941999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.899999999999999, -4.2, -15.6, -10.5, -3.3, -15.2, -10.9, -15.7, -3.2, -15.2, -17.8, -13.799999999999997, -4.2, -18.599999999999998, -11.399999999999997, -3.3, -6.0, -12.099999999999996, -9.0, -21.500000000000004, -6.699999999999999, -21.2, -3.3, -4.2, -3.3, -8.3, -7.3, -12.499999999999998, -6.6000000000000005, -3.3, -13.5, -19.6, -14.6, -3.3, -23.599999999999987, -32.99999999999997, -14.099999999999998, -3.3, -3.2, -5.300000000000001, -3.3, -14.899999999999999, -4.4, -4.4, -3.3, -4.4, -14.899999999999999, -9.7, -14.2, -4.4, -4.6000000000000005, -15.2, -8.2, -3.3, -8.799999999999999, -3.2, -21.300000000000004, -11.7, -3.2, -11.899999999999999, -25.100000000000012, -15.499999999999975, -79.4, -4.300000000000001, -9.3, -11.3, -4.4, -14.200000000000001, -3.2, -14.999999999999998, -13.3, -9.0, -4.2, -15.899999999999999, -3.3, -3.2, -3.3, -3.3, -8.3, -4.3, -15.100000000000001, -11.7, -19.700000000000003, -4.4, -4.2, -6.199999999999999, -17.699999999999996, -20.1, -19.6, -4.300000000000001, -27.700000000000003, -10.2, -26.700000000000006, -4.2, -10.2, -7.6, -17.099999999999998, -7.3, -6.3, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9285795008940432, "mean_inference_ms": 1.1925635427095589, "mean_action_processing_ms": 0.06557476974660202, "mean_env_wait_ms": 5.449686326296793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 916000, "timesteps_this_iter": 0, "agent_timesteps_total": 916000, "timers": {"sample_time_ms": 15297.012, "sample_throughput": 261.489, "load_time_ms": 0.359, "load_throughput": 11135074.003, "learn_time_ms": 7140.444, "learn_throughput": 560.189, "update_time_ms": 1.954}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001390457153320312, "cur_lr": 0.00010000000000000003, "total_loss": 0.4147896478050238, "policy_loss": -0.008667689107949295, "vf_loss": 42.345570978938895, "vf_explained_var": 0.22776642992932308, "kl": 0.0117754625241824, "entropy": 0.22223874488745327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 916000, "num_agent_steps_sampled": 916000, "num_steps_trained": 916000, "num_agent_steps_trained": 916000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9160, "training_iteration": 229, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-39-16", "timestamp": 1643668756, "time_this_iter_s": 14.960686206817627, "time_total_s": 3429.406147480011, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3429.406147480011, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 27.33181818181818, "ram_util_percent": 72.55909090909091}}
{"episode_reward_max": -3.2, "episode_reward_min": -79.4, "episode_reward_mean": -11.163, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -14.899999999999999, -4.4, -4.4, -3.3, -4.4, -14.899999999999999, -9.7, -14.2, -4.4, -4.6000000000000005, -15.2, -8.2, -3.3, -8.799999999999999, -3.2, -21.300000000000004, -11.7, -3.2, -11.899999999999999, -25.100000000000012, -15.499999999999975, -79.4, -4.300000000000001, -9.3, -11.3, -4.4, -14.200000000000001, -3.2, -14.999999999999998, -13.3, -9.0, -4.2, -15.899999999999999, -3.3, -3.2, -3.3, -3.3, -8.3, -4.3, -15.100000000000001, -11.7, -19.700000000000003, -4.4, -4.2, -6.199999999999999, -17.699999999999996, -20.1, -19.6, -4.300000000000001, -27.700000000000003, -10.2, -26.700000000000006, -4.2, -10.2, -7.6, -17.099999999999998, -7.3, -6.3, -4.2, -4.3, -18.0, -5.2, -4.2, -10.899999999999988, -42.70000000000009, -13.2, -9.599999999999996, -8.299999999999999, -4.2, -16.2, -6.599999999999999, -12.3, -15.399999999999997, -8.3, -20.299999999999994, -4.2, -7.2, -11.7, -3.3, -22.999999999999996, -3.3, -4.2, -11.5, -17.1, -16.499999999999996, -4.9, -7.299999999999999, -18.599999999999987, -4.3, -21.200000000000028, -14.799999999999999, -20.2, -11.499999999999998, -3.3, -3.2, -11.199999999999998, -3.3, -17.900000000000006, -9.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9288155766498833, "mean_inference_ms": 1.1924774176325783, "mean_action_processing_ms": 0.06558763500901142, "mean_env_wait_ms": 5.4494810049629585, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"sample_time_ms": 15159.448, "sample_throughput": 263.862, "load_time_ms": 0.358, "load_throughput": 11181828.846, "learn_time_ms": 7153.143, "learn_throughput": 559.195, "update_time_ms": 1.968}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001390457153320312, "cur_lr": 0.00010000000000000003, "total_loss": 0.11445588318590996, "policy_loss": -0.01185351827241961, "vf_loss": 12.630785119918086, "vf_explained_var": 0.17318622175083365, "kl": 0.01116980284402658, "entropy": 0.21880990958181762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 920000, "num_steps_trained": 920000, "num_agent_steps_trained": 920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9200, "training_iteration": 230, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-39-30", "timestamp": 1643668770, "time_this_iter_s": 14.088512182235718, "time_total_s": 3443.4946596622467, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3443.4946596622467, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 26.119999999999997, "ram_util_percent": 71.81499999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -42.70000000000009, "episode_reward_mean": -11.437999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.100000000000001, -11.7, -19.700000000000003, -4.4, -4.2, -6.199999999999999, -17.699999999999996, -20.1, -19.6, -4.300000000000001, -27.700000000000003, -10.2, -26.700000000000006, -4.2, -10.2, -7.6, -17.099999999999998, -7.3, -6.3, -4.2, -4.3, -18.0, -5.2, -4.2, -10.899999999999988, -42.70000000000009, -13.2, -9.599999999999996, -8.299999999999999, -4.2, -16.2, -6.599999999999999, -12.3, -15.399999999999997, -8.3, -20.299999999999994, -4.2, -7.2, -11.7, -3.3, -22.999999999999996, -3.3, -4.2, -11.5, -17.1, -16.499999999999996, -4.9, -7.299999999999999, -18.599999999999987, -4.3, -21.200000000000028, -14.799999999999999, -20.2, -11.499999999999998, -3.3, -3.2, -11.199999999999998, -3.3, -17.900000000000006, -9.3, -17.500000000000004, -3.4, -13.8, -4.4, -5.4, -7.2, -9.2, -11.700000000000001, -19.5, -14.6, -4.2, -13.5, -11.799999999999997, -2.2, -14.599999999999994, -18.5, -3.3, -4.2, -15.099999999999996, -29.500000000000018, -4.2, -14.399999999999999, -12.2, -18.799999999999997, -11.199999999999985, -6.2, -22.70000000000001, -21.700000000000006, -12.399999999999999, -5.7, -12.399999999999999, -4.2, -10.999999999999998, -8.600000000000001, -8.499999999999993, -6.699999999999999, -3.3, -19.5, -11.699999999999996, -7.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9286054356127624, "mean_inference_ms": 1.1921516217936539, "mean_action_processing_ms": 0.0655892719470133, "mean_env_wait_ms": 5.448271824732784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 924000, "timesteps_this_iter": 0, "agent_timesteps_total": 924000, "timers": {"sample_time_ms": 15134.162, "sample_throughput": 264.303, "load_time_ms": 0.355, "load_throughput": 11253834.183, "learn_time_ms": 7125.364, "learn_throughput": 561.375, "update_time_ms": 1.975}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001390457153320312, "cur_lr": 0.00010000000000000003, "total_loss": 0.0948884887180181, "policy_loss": -0.004312183363463289, "vf_loss": 9.919904675406794, "vf_explained_var": 0.2975635934901494, "kl": 0.011717788397738339, "entropy": 0.24940528059678693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 924000, "num_agent_steps_sampled": 924000, "num_steps_trained": 924000, "num_agent_steps_trained": 924000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9240, "training_iteration": 231, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-39-44", "timestamp": 1643668784, "time_this_iter_s": 13.780577898025513, "time_total_s": 3457.275237560272, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3457.275237560272, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 25.436842105263157, "ram_util_percent": 71.80526315789473}}
{"episode_reward_max": -2.2, "episode_reward_min": -117.89999999999985, "episode_reward_mean": -11.426999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.999999999999996, -3.3, -4.2, -11.5, -17.1, -16.499999999999996, -4.9, -7.299999999999999, -18.599999999999987, -4.3, -21.200000000000028, -14.799999999999999, -20.2, -11.499999999999998, -3.3, -3.2, -11.199999999999998, -3.3, -17.900000000000006, -9.3, -17.500000000000004, -3.4, -13.8, -4.4, -5.4, -7.2, -9.2, -11.700000000000001, -19.5, -14.6, -4.2, -13.5, -11.799999999999997, -2.2, -14.599999999999994, -18.5, -3.3, -4.2, -15.099999999999996, -29.500000000000018, -4.2, -14.399999999999999, -12.2, -18.799999999999997, -11.199999999999985, -6.2, -22.70000000000001, -21.700000000000006, -12.399999999999999, -5.7, -12.399999999999999, -4.2, -10.999999999999998, -8.600000000000001, -8.499999999999993, -6.699999999999999, -3.3, -19.5, -11.699999999999996, -7.6, -13.599999999999998, -3.3, -4.300000000000001, -4.300000000000001, -4.300000000000001, -16.2, -9.499999999999998, -15.899999999999997, -7.2, -3.3, -8.1, -7.2, -3.2, -17.399999999999974, -11.899999999999999, -7.300000000000001, -20.3, -8.899999999999997, -4.2, -4.300000000000001, -3.3, -16.5, -4.300000000000001, -13.4, -17.400000000000002, -13.1, -4.2, -6.2, -17.5, -12.5, -6.899999999999999, -12.999999999999998, -3.2, -16.799999999999997, -8.8, -7.799999999999999, -4.5, -2.6000000000000005, -117.89999999999985, -4.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9281796540977113, "mean_inference_ms": 1.1917610360889668, "mean_action_processing_ms": 0.06558758749932232, "mean_env_wait_ms": 5.44686423529524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 928000, "timesteps_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"sample_time_ms": 15084.113, "sample_throughput": 265.18, "load_time_ms": 0.352, "load_throughput": 11374383.729, "learn_time_ms": 7009.536, "learn_throughput": 570.651, "update_time_ms": 1.539}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001390457153320312, "cur_lr": 0.00010000000000000003, "total_loss": 0.6314058890596272, "policy_loss": -0.017214899313365742, "vf_loss": 64.86170260422332, "vf_explained_var": 0.354832806446219, "kl": 0.027206934756385876, "entropy": 0.2330966445667449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 928000, "num_agent_steps_sampled": 928000, "num_steps_trained": 928000, "num_agent_steps_trained": 928000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9280, "training_iteration": 232, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-39-58", "timestamp": 1643668798, "time_this_iter_s": 13.80228590965271, "time_total_s": 3471.077523469925, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3471.077523469925, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 26.45, "ram_util_percent": 71.83999999999999}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -117.89999999999985, "episode_reward_mean": -11.571999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -14.399999999999999, -12.2, -18.799999999999997, -11.199999999999985, -6.2, -22.70000000000001, -21.700000000000006, -12.399999999999999, -5.7, -12.399999999999999, -4.2, -10.999999999999998, -8.600000000000001, -8.499999999999993, -6.699999999999999, -3.3, -19.5, -11.699999999999996, -7.6, -13.599999999999998, -3.3, -4.300000000000001, -4.300000000000001, -4.300000000000001, -16.2, -9.499999999999998, -15.899999999999997, -7.2, -3.3, -8.1, -7.2, -3.2, -17.399999999999974, -11.899999999999999, -7.300000000000001, -20.3, -8.899999999999997, -4.2, -4.300000000000001, -3.3, -16.5, -4.300000000000001, -13.4, -17.400000000000002, -13.1, -4.2, -6.2, -17.5, -12.5, -6.899999999999999, -12.999999999999998, -3.2, -16.799999999999997, -8.8, -7.799999999999999, -4.5, -2.6000000000000005, -117.89999999999985, -4.9, -4.2, -11.5, -4.300000000000001, -4.3, -26.3, -7.1999999999999975, -4.2, -23.100000000000026, -4.2, -18.70000000000003, -19.400000000000006, -5.300000000000001, -21.0, -8.399999999999999, -12.899999999999999, -3.3, -5.2, -16.0, -22.400000000000006, -18.2, -12.599999999999993, -11.899999999999999, -6.399999999999997, -3.3, -12.3, -18.1, -14.899999999999999, -4.300000000000001, -12.199999999999994, -14.4, -12.4, -8.5, -12.799999999999999, -17.4, -11.099999999999994, -3.2, -11.099999999999996, -15.0, -8.3, -14.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9277294215342993, "mean_inference_ms": 1.1913395240596125, "mean_action_processing_ms": 0.06556525838699497, "mean_env_wait_ms": 5.445140390525155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 932000, "timesteps_this_iter": 0, "agent_timesteps_total": 932000, "timers": {"sample_time_ms": 14870.217, "sample_throughput": 268.994, "load_time_ms": 0.364, "load_throughput": 10974825.669, "learn_time_ms": 6933.383, "learn_throughput": 576.919, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.07436865473626762, "policy_loss": -0.018950945851943825, "vf_loss": 9.331740828675608, "vf_explained_var": 0.2579414749017326, "kl": 0.010526295231334833, "entropy": 0.23937315490617547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 932000, "num_agent_steps_sampled": 932000, "num_steps_trained": 932000, "num_agent_steps_trained": 932000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9320, "training_iteration": 233, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-40-12", "timestamp": 1643668812, "time_this_iter_s": 13.600130081176758, "time_total_s": 3484.6776535511017, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3484.6776535511017, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 20.931578947368422, "ram_util_percent": 71.8736842105263}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -117.89999999999985, "episode_reward_mean": -12.094999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -16.5, -4.300000000000001, -13.4, -17.400000000000002, -13.1, -4.2, -6.2, -17.5, -12.5, -6.899999999999999, -12.999999999999998, -3.2, -16.799999999999997, -8.8, -7.799999999999999, -4.5, -2.6000000000000005, -117.89999999999985, -4.9, -4.2, -11.5, -4.300000000000001, -4.3, -26.3, -7.1999999999999975, -4.2, -23.100000000000026, -4.2, -18.70000000000003, -19.400000000000006, -5.300000000000001, -21.0, -8.399999999999999, -12.899999999999999, -3.3, -5.2, -16.0, -22.400000000000006, -18.2, -12.599999999999993, -11.899999999999999, -6.399999999999997, -3.3, -12.3, -18.1, -14.899999999999999, -4.300000000000001, -12.199999999999994, -14.4, -12.4, -8.5, -12.799999999999999, -17.4, -11.099999999999994, -3.2, -11.099999999999996, -15.0, -8.3, -14.399999999999999, -5.5, -8.5, -6.300000000000001, -13.999999999999996, -9.6, -13.399999999999999, -21.200000000000003, -7.2, -4.2, -3.3, -9.799999999999999, -15.7, -14.2, -5.300000000000001, -13.899999999999997, -10.599999999999998, -12.600000000000001, -18.5, -8.599999999999998, -3.3, -3.2, -26.5, -12.600000000000001, -4.300000000000001, -5.300000000000001, -28.600000000000048, -3.3, -3.3, -4.2, -18.3, -6.2, -21.699999999999996, -4.4, -14.499999999999998, -3.2, -27.900000000000013, -6.300000000000001, -29.400000000000002, -12.799999999999997, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9274464903468826, "mean_inference_ms": 1.1910321068984289, "mean_action_processing_ms": 0.06555097425359496, "mean_env_wait_ms": 5.443904636171757, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 936000, "timesteps_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"sample_time_ms": 14796.429, "sample_throughput": 270.335, "load_time_ms": 0.361, "load_throughput": 11085045.259, "learn_time_ms": 6897.217, "learn_throughput": 579.944, "update_time_ms": 1.431}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.10684487290119613, "policy_loss": -0.0003810279792354953, "vf_loss": 10.722177140879374, "vf_explained_var": 0.32859751601372994, "kl": 0.019810735202186104, "entropy": 0.1986367325789185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 936000, "num_agent_steps_sampled": 936000, "num_steps_trained": 936000, "num_agent_steps_trained": 936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9360, "training_iteration": 234, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-40-26", "timestamp": 1643668826, "time_this_iter_s": 14.450913906097412, "time_total_s": 3499.128567457199, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3499.128567457199, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 22.642857142857146, "ram_util_percent": 72.0095238095238}}
{"episode_reward_max": -3.2, "episode_reward_min": -154.3, "episode_reward_mean": -13.168, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.599999999999993, -11.899999999999999, -6.399999999999997, -3.3, -12.3, -18.1, -14.899999999999999, -4.300000000000001, -12.199999999999994, -14.4, -12.4, -8.5, -12.799999999999999, -17.4, -11.099999999999994, -3.2, -11.099999999999996, -15.0, -8.3, -14.399999999999999, -5.5, -8.5, -6.300000000000001, -13.999999999999996, -9.6, -13.399999999999999, -21.200000000000003, -7.2, -4.2, -3.3, -9.799999999999999, -15.7, -14.2, -5.300000000000001, -13.899999999999997, -10.599999999999998, -12.600000000000001, -18.5, -8.599999999999998, -3.3, -3.2, -26.5, -12.600000000000001, -4.300000000000001, -5.300000000000001, -28.600000000000048, -3.3, -3.3, -4.2, -18.3, -6.2, -21.699999999999996, -4.4, -14.499999999999998, -3.2, -27.900000000000013, -6.300000000000001, -29.400000000000002, -12.799999999999997, -8.3, -15.099999999999975, -26.3, -15.7, -3.3, -4.300000000000001, -23.3, -13.799999999999999, -11.5, -8.6, -3.2, -19.900000000000006, -3.3, -4.3, -18.6, -3.4, -23.800000000000004, -21.4, -3.2, -3.3, -19.499999999999996, -4.2, -154.3, -5.2, -17.5, -19.000000000000007, -4.300000000000001, -3.3, -23.5, -17.099999999999994, -13.19999999999997, -13.7, -4.300000000000001, -11.7, -21.699999999999996, -23.5, -17.399999999999995, -5.2, -9.1, -14.899999999999999, -13.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9274384329266354, "mean_inference_ms": 1.1908879392686011, "mean_action_processing_ms": 0.06554425965410453, "mean_env_wait_ms": 5.443309320483925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 940000, "timesteps_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"sample_time_ms": 14671.161, "sample_throughput": 272.644, "load_time_ms": 0.363, "load_throughput": 11032561.32, "learn_time_ms": 6796.335, "learn_throughput": 588.552, "update_time_ms": 1.446}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.7131809804502184, "policy_loss": -0.014602630087224547, "vf_loss": 72.77809593062247, "vf_explained_var": 0.0929007327043882, "kl": 0.012846371389640825, "entropy": 0.204968461638657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 940000, "num_agent_steps_sampled": 940000, "num_steps_trained": 940000, "num_agent_steps_trained": 940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9400, "training_iteration": 235, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-40-41", "timestamp": 1643668841, "time_this_iter_s": 14.583969116210938, "time_total_s": 3513.71253657341, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3513.71253657341, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 23.280952380952378, "ram_util_percent": 72.10476190476189}}
{"episode_reward_max": -2.2, "episode_reward_min": -154.3, "episode_reward_mean": -13.461000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -26.5, -12.600000000000001, -4.300000000000001, -5.300000000000001, -28.600000000000048, -3.3, -3.3, -4.2, -18.3, -6.2, -21.699999999999996, -4.4, -14.499999999999998, -3.2, -27.900000000000013, -6.300000000000001, -29.400000000000002, -12.799999999999997, -8.3, -15.099999999999975, -26.3, -15.7, -3.3, -4.300000000000001, -23.3, -13.799999999999999, -11.5, -8.6, -3.2, -19.900000000000006, -3.3, -4.3, -18.6, -3.4, -23.800000000000004, -21.4, -3.2, -3.3, -19.499999999999996, -4.2, -154.3, -5.2, -17.5, -19.000000000000007, -4.300000000000001, -3.3, -23.5, -17.099999999999994, -13.19999999999997, -13.7, -4.300000000000001, -11.7, -21.699999999999996, -23.5, -17.399999999999995, -5.2, -9.1, -14.899999999999999, -13.3, -13.499999999999998, -12.499999999999998, -16.2, -6.100000000000001, -5.300000000000001, -31.3, -25.300000000000004, -14.4, -3.3, -4.2, -18.8, -16.399999999999995, -14.999999999999998, -4.300000000000001, -6.2, -22.20000000000001, -6.300000000000001, -4.2, -14.399999999999999, -12.2, -4.2, -8.6, -13.999999999999998, -2.2, -15.499999999999991, -8.799999999999999, -12.3, -3.3, -10.399999999999999, -22.1, -5.300000000000001, -8.3, -11.399999999999999, -14.5, -7.499999999999999, -7.3, -20.5, -6.199999999999999, -7.5, -17.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9274772540618094, "mean_inference_ms": 1.1909027445768066, "mean_action_processing_ms": 0.06554414077757582, "mean_env_wait_ms": 5.443384087152172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 944000, "timesteps_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"sample_time_ms": 14572.565, "sample_throughput": 274.488, "load_time_ms": 0.361, "load_throughput": 11093841.169, "learn_time_ms": 6813.374, "learn_throughput": 587.081, "update_time_ms": 1.473}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.11643948423205525, "policy_loss": -0.007973257622992, "vf_loss": 12.44104703241779, "vf_explained_var": 0.21717013857697928, "kl": 0.010913556409843685, "entropy": 0.22159552548521308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 944000, "num_agent_steps_sampled": 944000, "num_steps_trained": 944000, "num_agent_steps_trained": 944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9440, "training_iteration": 236, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-40-56", "timestamp": 1643668856, "time_this_iter_s": 15.043367862701416, "time_total_s": 3528.7559044361115, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3528.7559044361115, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 25.70952380952381, "ram_util_percent": 72.15238095238094}}
{"episode_reward_max": -2.2, "episode_reward_min": -154.3, "episode_reward_mean": -13.824999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -154.3, -5.2, -17.5, -19.000000000000007, -4.300000000000001, -3.3, -23.5, -17.099999999999994, -13.19999999999997, -13.7, -4.300000000000001, -11.7, -21.699999999999996, -23.5, -17.399999999999995, -5.2, -9.1, -14.899999999999999, -13.3, -13.499999999999998, -12.499999999999998, -16.2, -6.100000000000001, -5.300000000000001, -31.3, -25.300000000000004, -14.4, -3.3, -4.2, -18.8, -16.399999999999995, -14.999999999999998, -4.300000000000001, -6.2, -22.20000000000001, -6.300000000000001, -4.2, -14.399999999999999, -12.2, -4.2, -8.6, -13.999999999999998, -2.2, -15.499999999999991, -8.799999999999999, -12.3, -3.3, -10.399999999999999, -22.1, -5.300000000000001, -8.3, -11.399999999999999, -14.5, -7.499999999999999, -7.3, -20.5, -6.199999999999999, -7.5, -17.6, -6.300000000000001, -4.9, -9.2, -9.799999999999999, -17.199999999999992, -3.2, -37.3, -12.999999999999996, -13.799999999999999, -6.2, -4.300000000000001, -17.799999999999994, -19.3, -8.299999999999997, -14.499999999999998, -4.6000000000000005, -17.799999999999997, -4.2, -5.3999999999999995, -6.899999999999999, -17.2, -22.700000000000003, -7.999999999999998, -14.999999999999982, -3.2, -17.799999999999997, -18.5, -10.799999999999999, -3.3, -4.300000000000001, -5.2, -5.300000000000001, -12.699999999999985, -14.099999999999998, -20.900000000000006, -4.4, -82.69999999999992, -9.799999999999997, -23.300000000000022, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9274132387041082, "mean_inference_ms": 1.1907875363209002, "mean_action_processing_ms": 0.06553709815105402, "mean_env_wait_ms": 5.442831635349563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 948000, "timesteps_this_iter": 0, "agent_timesteps_total": 948000, "timers": {"sample_time_ms": 14597.191, "sample_throughput": 274.025, "load_time_ms": 0.361, "load_throughput": 11087242.929, "learn_time_ms": 6646.011, "learn_throughput": 601.865, "update_time_ms": 1.55}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.3694245621995119, "policy_loss": -0.011507703692862584, "vf_loss": 38.092946296866224, "vf_explained_var": 0.1342922599725826, "kl": 0.01348070836848794, "entropy": 0.23106478064130712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 948000, "num_agent_steps_sampled": 948000, "num_steps_trained": 948000, "num_agent_steps_trained": 948000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9480, "training_iteration": 237, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-41-10", "timestamp": 1643668870, "time_this_iter_s": 13.895080327987671, "time_total_s": 3542.650984764099, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3542.650984764099, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 23.62, "ram_util_percent": 72.09999999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -82.69999999999992, "episode_reward_mean": -11.988, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -8.6, -13.999999999999998, -2.2, -15.499999999999991, -8.799999999999999, -12.3, -3.3, -10.399999999999999, -22.1, -5.300000000000001, -8.3, -11.399999999999999, -14.5, -7.499999999999999, -7.3, -20.5, -6.199999999999999, -7.5, -17.6, -6.300000000000001, -4.9, -9.2, -9.799999999999999, -17.199999999999992, -3.2, -37.3, -12.999999999999996, -13.799999999999999, -6.2, -4.300000000000001, -17.799999999999994, -19.3, -8.299999999999997, -14.499999999999998, -4.6000000000000005, -17.799999999999997, -4.2, -5.3999999999999995, -6.899999999999999, -17.2, -22.700000000000003, -7.999999999999998, -14.999999999999982, -3.2, -17.799999999999997, -18.5, -10.799999999999999, -3.3, -4.300000000000001, -5.2, -5.300000000000001, -12.699999999999985, -14.099999999999998, -20.900000000000006, -4.4, -82.69999999999992, -9.799999999999997, -23.300000000000022, -3.3, -4.300000000000001, -12.899999999999999, -3.3, -6.9, -17.2, -21.9, -9.3, -4.2, -4.2, -38.60000000000008, -8.399999999999997, -4.4, -12.900000000000002, -11.899999999999999, -11.7, -3.2, -17.6, -12.2, -19.500000000000004, -3.3, -11.299999999999999, -26.8, -4.2, -3.3, -13.499999999999993, -19.700000000000006, -10.999999999999991, -3.4, -12.399999999999999, -3.3, -18.200000000000006, -9.2, -13.100000000000001, -10.999999999999996, -11.9, -5.2, -10.2, -15.3, -8.7, -25.20000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9272794442529569, "mean_inference_ms": 1.190636665579664, "mean_action_processing_ms": 0.06552798109441742, "mean_env_wait_ms": 5.442109355779551, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 952000, "timesteps_this_iter": 0, "agent_timesteps_total": 952000, "timers": {"sample_time_ms": 14339.979, "sample_throughput": 278.94, "load_time_ms": 0.356, "load_throughput": 11227475.072, "learn_time_ms": 6573.899, "learn_throughput": 608.467, "update_time_ms": 1.549}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.11621843319065789, "policy_loss": -0.017455839552986685, "vf_loss": 13.367237924375841, "vf_explained_var": 0.22857373094045988, "kl": 0.009111249785572923, "entropy": 0.2369891805994895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 952000, "num_agent_steps_sampled": 952000, "num_steps_trained": 952000, "num_agent_steps_trained": 952000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9520, "training_iteration": 238, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-41-24", "timestamp": 1643668884, "time_this_iter_s": 14.298728227615356, "time_total_s": 3556.9497129917145, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3556.9497129917145, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 25.845000000000006, "ram_util_percent": 72.14499999999998}}
{"episode_reward_max": -3.000000000000001, "episode_reward_min": -82.69999999999992, "episode_reward_mean": -11.621999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.2, -22.700000000000003, -7.999999999999998, -14.999999999999982, -3.2, -17.799999999999997, -18.5, -10.799999999999999, -3.3, -4.300000000000001, -5.2, -5.300000000000001, -12.699999999999985, -14.099999999999998, -20.900000000000006, -4.4, -82.69999999999992, -9.799999999999997, -23.300000000000022, -3.3, -4.300000000000001, -12.899999999999999, -3.3, -6.9, -17.2, -21.9, -9.3, -4.2, -4.2, -38.60000000000008, -8.399999999999997, -4.4, -12.900000000000002, -11.899999999999999, -11.7, -3.2, -17.6, -12.2, -19.500000000000004, -3.3, -11.299999999999999, -26.8, -4.2, -3.3, -13.499999999999993, -19.700000000000006, -10.999999999999991, -3.4, -12.399999999999999, -3.3, -18.200000000000006, -9.2, -13.100000000000001, -10.999999999999996, -11.9, -5.2, -10.2, -15.3, -8.7, -25.20000000000004, -12.199999999999996, -13.19999999999997, -6.899999999999999, -13.999999999999998, -8.2, -22.10000000000001, -8.799999999999997, -3.2, -11.3, -7.3999999999999995, -15.5, -13.3, -5.2, -3.2, -12.799999999999999, -4.2, -3.000000000000001, -3.2, -18.4, -6.6, -17.4, -3.2, -6.3, -20.10000000000001, -6.2, -3.2, -14.2, -15.2, -6.9, -8.3, -4.300000000000001, -19.600000000000005, -10.2, -7.2, -8.3, -4.2, -18.799999999999997, -13.799999999999999, -11.499999999999998, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9271363057987443, "mean_inference_ms": 1.1905223372581357, "mean_action_processing_ms": 0.06552836681392382, "mean_env_wait_ms": 5.441597390672963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 956000, "timesteps_this_iter": 0, "agent_timesteps_total": 956000, "timers": {"sample_time_ms": 14263.701, "sample_throughput": 280.432, "load_time_ms": 0.351, "load_throughput": 11410743.386, "learn_time_ms": 6525.232, "learn_throughput": 613.005, "update_time_ms": 1.548}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.06438686217041185, "policy_loss": -0.012182267464857588, "vf_loss": 7.656765242609927, "vf_explained_var": 0.19539653825503522, "kl": 0.0070987256574003375, "entropy": 0.18761961903142674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 956000, "num_agent_steps_sampled": 956000, "num_steps_trained": 956000, "num_agent_steps_trained": 956000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9560, "training_iteration": 239, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-41-39", "timestamp": 1643668899, "time_this_iter_s": 14.43627381324768, "time_total_s": 3571.385986804962, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3571.385986804962, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 28.885714285714286, "ram_util_percent": 72.13333333333331}}
{"episode_reward_max": -3.000000000000001, "episode_reward_min": -52.2, "episode_reward_mean": -11.601, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.299999999999999, -26.8, -4.2, -3.3, -13.499999999999993, -19.700000000000006, -10.999999999999991, -3.4, -12.399999999999999, -3.3, -18.200000000000006, -9.2, -13.100000000000001, -10.999999999999996, -11.9, -5.2, -10.2, -15.3, -8.7, -25.20000000000004, -12.199999999999996, -13.19999999999997, -6.899999999999999, -13.999999999999998, -8.2, -22.10000000000001, -8.799999999999997, -3.2, -11.3, -7.3999999999999995, -15.5, -13.3, -5.2, -3.2, -12.799999999999999, -4.2, -3.000000000000001, -3.2, -18.4, -6.6, -17.4, -3.2, -6.3, -20.10000000000001, -6.2, -3.2, -14.2, -15.2, -6.9, -8.3, -4.300000000000001, -19.600000000000005, -10.2, -7.2, -8.3, -4.2, -18.799999999999997, -13.799999999999999, -11.499999999999998, -3.3, -21.6, -11.5, -4.3, -27.500000000000004, -18.2, -10.7, -23.900000000000027, -15.199999999999998, -9.2, -11.2, -3.2, -23.600000000000005, -14.7, -11.999999999999998, -12.7, -52.2, -4.300000000000001, -9.799999999999999, -5.300000000000001, -4.300000000000001, -21.2, -15.599999999999982, -3.3, -4.2, -4.2, -9.6, -3.3, -5.4, -8.999999999999998, -11.0, -21.4, -19.700000000000003, -8.599999999999998, -25.29999999999999, -18.4, -5.3, -10.500000000000002, -4.2, -18.799999999999997, -13.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9269280351613767, "mean_inference_ms": 1.1905176342233548, "mean_action_processing_ms": 0.06552595024800621, "mean_env_wait_ms": 5.441000577607926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 14211.466, "sample_throughput": 281.463, "load_time_ms": 0.345, "load_throughput": 11582475.664, "learn_time_ms": 6560.727, "learn_throughput": 609.689, "update_time_ms": 1.636}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.22470888635644348, "policy_loss": -0.009045439988114341, "vf_loss": 23.375159194905272, "vf_explained_var": 0.04841674662405445, "kl": 0.013137624150180131, "entropy": 0.21424525037247646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9600, "training_iteration": 240, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-41-53", "timestamp": 1643668913, "time_this_iter_s": 14.40947675704956, "time_total_s": 3585.7954635620117, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3585.7954635620117, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 23.885, "ram_util_percent": 72.08500000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.3, "episode_reward_mean": -12.148000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.4, -3.2, -6.3, -20.10000000000001, -6.2, -3.2, -14.2, -15.2, -6.9, -8.3, -4.300000000000001, -19.600000000000005, -10.2, -7.2, -8.3, -4.2, -18.799999999999997, -13.799999999999999, -11.499999999999998, -3.3, -21.6, -11.5, -4.3, -27.500000000000004, -18.2, -10.7, -23.900000000000027, -15.199999999999998, -9.2, -11.2, -3.2, -23.600000000000005, -14.7, -11.999999999999998, -12.7, -52.2, -4.300000000000001, -9.799999999999999, -5.300000000000001, -4.300000000000001, -21.2, -15.599999999999982, -3.3, -4.2, -4.2, -9.6, -3.3, -5.4, -8.999999999999998, -11.0, -21.4, -19.700000000000003, -8.599999999999998, -25.29999999999999, -18.4, -5.3, -10.500000000000002, -4.2, -18.799999999999997, -13.899999999999999, -4.300000000000001, -11.199999999999976, -4.4, -4.2, -24.3, -6.3, -22.800000000000008, -16.099999999999998, -3.3, -18.9, -4.4, -3.3, -14.099999999999998, -3.3, -11.399999999999999, -3.3, -14.1, -5.2, -8.999999999999998, -3.5, -4.300000000000001, -6.2, -5.300000000000001, -4.2, -17.699999999999996, -3.3, -10.599999999999998, -9.5, -6.300000000000001, -29.500000000000004, -11.2, -17.0, -7.300000000000001, -7.300000000000001, -4.699999999999999, -98.3, -13.399999999999999, -12.899999999999999, -4.2, -23.700000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9267328098163924, "mean_inference_ms": 1.1904381536991628, "mean_action_processing_ms": 0.06551946852466926, "mean_env_wait_ms": 5.440174181204136, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 964000, "timesteps_this_iter": 0, "agent_timesteps_total": 964000, "timers": {"sample_time_ms": 14284.978, "sample_throughput": 280.014, "load_time_ms": 0.353, "load_throughput": 11339021.357, "learn_time_ms": 6615.962, "learn_throughput": 604.598, "update_time_ms": 1.62}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.3413103730217504, "policy_loss": -0.0038734886965524126, "vf_loss": 34.51825872159773, "vf_explained_var": 0.1023188296825655, "kl": 0.006178338143570275, "entropy": 0.1754623509302575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 964000, "num_agent_steps_sampled": 964000, "num_steps_trained": 964000, "num_agent_steps_trained": 964000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9640, "training_iteration": 241, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-42-08", "timestamp": 1643668928, "time_this_iter_s": 14.710549116134644, "time_total_s": 3600.5060126781464, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3600.5060126781464, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 21.623809523809523, "ram_util_percent": 71.8809523809524}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.3, "episode_reward_mean": -12.110999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.2, -15.599999999999982, -3.3, -4.2, -4.2, -9.6, -3.3, -5.4, -8.999999999999998, -11.0, -21.4, -19.700000000000003, -8.599999999999998, -25.29999999999999, -18.4, -5.3, -10.500000000000002, -4.2, -18.799999999999997, -13.899999999999999, -4.300000000000001, -11.199999999999976, -4.4, -4.2, -24.3, -6.3, -22.800000000000008, -16.099999999999998, -3.3, -18.9, -4.4, -3.3, -14.099999999999998, -3.3, -11.399999999999999, -3.3, -14.1, -5.2, -8.999999999999998, -3.5, -4.300000000000001, -6.2, -5.300000000000001, -4.2, -17.699999999999996, -3.3, -10.599999999999998, -9.5, -6.300000000000001, -29.500000000000004, -11.2, -17.0, -7.300000000000001, -7.300000000000001, -4.699999999999999, -98.3, -13.399999999999999, -12.899999999999999, -4.2, -23.700000000000006, -19.1, -4.4, -19.3, -3.8000000000000003, -6.2, -13.699999999999994, -4.2, -14.099999999999998, -3.3, -20.300000000000004, -13.3, -15.399999999999997, -21.099999999999998, -10.2, -4.300000000000001, -3.4000000000000004, -9.3, -15.7, -7.1, -3.4, -18.7, -24.700000000000003, -22.499999999999996, -9.099999999999998, -7.0, -25.8, -13.7, -12.999999999999998, -4.300000000000001, -17.799999999999997, -12.2, -19.6, -3.2, -5.2, -15.3, -7.899999999999999, -16.9, -10.5, -22.699999999999996, -12.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9264702964165181, "mean_inference_ms": 1.1902551067190423, "mean_action_processing_ms": 0.0655046873502056, "mean_env_wait_ms": 5.439433537894152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 968000, "timesteps_this_iter": 0, "agent_timesteps_total": 968000, "timers": {"sample_time_ms": 14360.158, "sample_throughput": 278.548, "load_time_ms": 0.352, "load_throughput": 11377469.144, "learn_time_ms": 6606.787, "learn_throughput": 605.438, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.12250231410607054, "policy_loss": -0.004879987891262738, "vf_loss": 12.738045536446315, "vf_explained_var": 0.13228225387552733, "kl": 0.008870033189072576, "entropy": 0.20208363914762134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 968000, "num_agent_steps_sampled": 968000, "num_steps_trained": 968000, "num_agent_steps_trained": 968000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9680, "training_iteration": 242, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-42-22", "timestamp": 1643668942, "time_this_iter_s": 13.910270929336548, "time_total_s": 3614.416283607483, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3614.416283607483, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 22.630000000000003, "ram_util_percent": 70.68499999999997}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.3, "episode_reward_mean": -12.519000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -6.2, -5.300000000000001, -4.2, -17.699999999999996, -3.3, -10.599999999999998, -9.5, -6.300000000000001, -29.500000000000004, -11.2, -17.0, -7.300000000000001, -7.300000000000001, -4.699999999999999, -98.3, -13.399999999999999, -12.899999999999999, -4.2, -23.700000000000006, -19.1, -4.4, -19.3, -3.8000000000000003, -6.2, -13.699999999999994, -4.2, -14.099999999999998, -3.3, -20.300000000000004, -13.3, -15.399999999999997, -21.099999999999998, -10.2, -4.300000000000001, -3.4000000000000004, -9.3, -15.7, -7.1, -3.4, -18.7, -24.700000000000003, -22.499999999999996, -9.099999999999998, -7.0, -25.8, -13.7, -12.999999999999998, -4.300000000000001, -17.799999999999997, -12.2, -19.6, -3.2, -5.2, -15.3, -7.899999999999999, -16.9, -10.5, -22.699999999999996, -12.2, -15.7, -16.6, -4.2, -15.3, -3.4, -18.200000000000017, -4.800000000000001, -21.400000000000002, -3.3, -17.0, -25.400000000000002, -5.300000000000001, -12.199999999999998, -8.4, -10.299999999999997, -6.199999999999999, -6.9, -13.3, -3.3, -8.2, -12.5, -19.199999999999996, -40.300000000000054, -15.2, -3.3, -17.099999999999998, -4.300000000000001, -4.300000000000001, -4.300000000000001, -19.600000000000005, -7.1, -9.2, -8.2, -8.3, -8.299999999999997, -9.399999999999997, -11.2, -9.799999999999999, -18.900000000000006, -11.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9263718069237578, "mean_inference_ms": 1.1900513607547634, "mean_action_processing_ms": 0.06549290448766108, "mean_env_wait_ms": 5.438869672987837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 972000, "timesteps_this_iter": 0, "agent_timesteps_total": 972000, "timers": {"sample_time_ms": 14407.044, "sample_throughput": 277.642, "load_time_ms": 0.341, "load_throughput": 11728218.106, "learn_time_ms": 6732.361, "learn_throughput": 594.145, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.12809152310045677, "policy_loss": -0.0038913154974579813, "vf_loss": 13.198072960428012, "vf_explained_var": 0.10934851554132277, "kl": 0.010126623740243507, "entropy": 0.2073325256506602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 972000, "num_agent_steps_sampled": 972000, "num_steps_trained": 972000, "num_agent_steps_trained": 972000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9720, "training_iteration": 243, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-42-37", "timestamp": 1643668957, "time_this_iter_s": 15.415449857711792, "time_total_s": 3629.8317334651947, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3629.8317334651947, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 29.431818181818176, "ram_util_percent": 71.04090909090907}}
{"episode_reward_max": -3.2, "episode_reward_min": -40.300000000000054, "episode_reward_mean": -11.091000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.7, -24.700000000000003, -22.499999999999996, -9.099999999999998, -7.0, -25.8, -13.7, -12.999999999999998, -4.300000000000001, -17.799999999999997, -12.2, -19.6, -3.2, -5.2, -15.3, -7.899999999999999, -16.9, -10.5, -22.699999999999996, -12.2, -15.7, -16.6, -4.2, -15.3, -3.4, -18.200000000000017, -4.800000000000001, -21.400000000000002, -3.3, -17.0, -25.400000000000002, -5.300000000000001, -12.199999999999998, -8.4, -10.299999999999997, -6.199999999999999, -6.9, -13.3, -3.3, -8.2, -12.5, -19.199999999999996, -40.300000000000054, -15.2, -3.3, -17.099999999999998, -4.300000000000001, -4.300000000000001, -4.300000000000001, -19.600000000000005, -7.1, -9.2, -8.2, -8.3, -8.299999999999997, -9.399999999999997, -11.2, -9.799999999999999, -18.900000000000006, -11.199999999999996, -8.2, -5.699999999999999, -17.4, -8.399999999999999, -20.2, -4.300000000000001, -4.2, -5.899999999999999, -8.2, -4.300000000000001, -5.2, -5.9, -14.399999999999999, -22.700000000000003, -15.2, -10.799999999999999, -3.2, -7.899999999999999, -12.7, -8.600000000000001, -15.299999999999997, -5.1000000000000005, -3.2, -21.6, -5.300000000000001, -24.800000000000004, -3.3, -12.600000000000001, -13.7, -15.099999999999998, -3.3, -3.3, -10.5, -3.3, -6.2, -7.699999999999998, -3.3, -4.2, -4.800000000000001, -5.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9264183101837534, "mean_inference_ms": 1.1900757708495044, "mean_action_processing_ms": 0.06549475782293498, "mean_env_wait_ms": 5.439205060224733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 976000, "timesteps_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"sample_time_ms": 14610.668, "sample_throughput": 273.773, "load_time_ms": 0.346, "load_throughput": 11550579.002, "learn_time_ms": 6758.738, "learn_throughput": 591.827, "update_time_ms": 1.638}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.0744260934544527, "policy_loss": -0.0016182498730999487, "vf_loss": 7.604304170993067, "vf_explained_var": 0.23592728228979212, "kl": 0.00625900720541019, "entropy": 0.18595519228087318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 976000, "num_agent_steps_sampled": 976000, "num_steps_trained": 976000, "num_agent_steps_trained": 976000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9760, "training_iteration": 244, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-42-53", "timestamp": 1643668973, "time_this_iter_s": 15.493338823318481, "time_total_s": 3645.325072288513, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3645.325072288513, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 30.35909090909091, "ram_util_percent": 71.46363636363637}}
{"episode_reward_max": -3.2, "episode_reward_min": -40.300000000000054, "episode_reward_mean": -10.367, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.5, -19.199999999999996, -40.300000000000054, -15.2, -3.3, -17.099999999999998, -4.300000000000001, -4.300000000000001, -4.300000000000001, -19.600000000000005, -7.1, -9.2, -8.2, -8.3, -8.299999999999997, -9.399999999999997, -11.2, -9.799999999999999, -18.900000000000006, -11.199999999999996, -8.2, -5.699999999999999, -17.4, -8.399999999999999, -20.2, -4.300000000000001, -4.2, -5.899999999999999, -8.2, -4.300000000000001, -5.2, -5.9, -14.399999999999999, -22.700000000000003, -15.2, -10.799999999999999, -3.2, -7.899999999999999, -12.7, -8.600000000000001, -15.299999999999997, -5.1000000000000005, -3.2, -21.6, -5.300000000000001, -24.800000000000004, -3.3, -12.600000000000001, -13.7, -15.099999999999998, -3.3, -3.3, -10.5, -3.3, -6.2, -7.699999999999998, -3.3, -4.2, -4.800000000000001, -5.699999999999999, -15.899999999999999, -3.2, -5.300000000000001, -10.799999999999999, -30.900000000000023, -5.2, -16.700000000000003, -3.3, -7.599999999999999, -9.299999999999997, -8.5, -14.1, -13.2, -4.3, -21.1, -3.3, -16.599999999999998, -3.3, -5.2, -6.7, -3.3, -8.700000000000001, -7.799999999999998, -9.2, -4.300000000000001, -11.399999999999995, -26.400000000000002, -4.2, -5.300000000000001, -18.9, -3.3, -7.300000000000001, -5.300000000000001, -4.300000000000001, -9.0, -18.699999999999996, -3.3, -5.300000000000001, -38.90000000000006, -29.900000000000052], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9263999053427275, "mean_inference_ms": 1.1900542734288604, "mean_action_processing_ms": 0.0654931505459498, "mean_env_wait_ms": 5.439429117759442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 980000, "timesteps_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"sample_time_ms": 14594.82, "sample_throughput": 274.07, "load_time_ms": 0.344, "load_throughput": 11620984.969, "learn_time_ms": 6732.764, "learn_throughput": 594.11, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.1302336515157774, "policy_loss": -0.002690636142287203, "vf_loss": 13.292297623490775, "vf_explained_var": 0.4177738706911764, "kl": 0.006317399889532861, "entropy": 0.1788410533580088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 980000, "num_agent_steps_sampled": 980000, "num_steps_trained": 980000, "num_agent_steps_trained": 980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9800, "training_iteration": 245, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-43-06", "timestamp": 1643668986, "time_this_iter_s": 13.89951491355896, "time_total_s": 3659.224587202072, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3659.224587202072, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 26.29, "ram_util_percent": 71.515}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.90000000000006, "episode_reward_mean": -9.475000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.299999999999997, -5.1000000000000005, -3.2, -21.6, -5.300000000000001, -24.800000000000004, -3.3, -12.600000000000001, -13.7, -15.099999999999998, -3.3, -3.3, -10.5, -3.3, -6.2, -7.699999999999998, -3.3, -4.2, -4.800000000000001, -5.699999999999999, -15.899999999999999, -3.2, -5.300000000000001, -10.799999999999999, -30.900000000000023, -5.2, -16.700000000000003, -3.3, -7.599999999999999, -9.299999999999997, -8.5, -14.1, -13.2, -4.3, -21.1, -3.3, -16.599999999999998, -3.3, -5.2, -6.7, -3.3, -8.700000000000001, -7.799999999999998, -9.2, -4.300000000000001, -11.399999999999995, -26.400000000000002, -4.2, -5.300000000000001, -18.9, -3.3, -7.300000000000001, -5.300000000000001, -4.300000000000001, -9.0, -18.699999999999996, -3.3, -5.300000000000001, -38.90000000000006, -29.900000000000052, -6.300000000000001, -8.899999999999999, -6.4, -6.2, -15.099999999999994, -4.2, -18.3, -3.2, -21.5, -10.399999999999986, -8.899999999999999, -17.900000000000002, -3.3, -14.599999999999989, -5.300000000000001, -9.2, -4.300000000000001, -4.300000000000001, -23.9, -3.3, -3.3, -13.299999999999995, -5.0, -14.199999999999996, -4.7, -10.999999999999998, -13.4, -3.2, -9.5, -11.799999999999999, -8.8, -5.4, -6.300000000000001, -5.800000000000001, -3.3000000000000003, -12.4, -3.3, -4.300000000000001, -8.2, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9262642647051575, "mean_inference_ms": 1.1898107408433334, "mean_action_processing_ms": 0.06547946177131514, "mean_env_wait_ms": 5.438681607618657, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 984000, "timesteps_this_iter": 0, "agent_timesteps_total": 984000, "timers": {"sample_time_ms": 14485.717, "sample_throughput": 276.134, "load_time_ms": 0.345, "load_throughput": 11590477.375, "learn_time_ms": 6677.3, "learn_throughput": 599.045, "update_time_ms": 1.587}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.05700756345965689, "policy_loss": -0.009628039335591658, "vf_loss": 6.663441963862347, "vf_explained_var": 0.2361738637570412, "kl": 0.0056834902183616936, "entropy": 0.21880440553349834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 984000, "num_agent_steps_sampled": 984000, "num_steps_trained": 984000, "num_agent_steps_trained": 984000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9840, "training_iteration": 246, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-43-20", "timestamp": 1643669000, "time_this_iter_s": 13.660243034362793, "time_total_s": 3672.884830236435, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3672.884830236435, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 24.442105263157895, "ram_util_percent": 71.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.90000000000006, "episode_reward_mean": -9.361000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -8.700000000000001, -7.799999999999998, -9.2, -4.300000000000001, -11.399999999999995, -26.400000000000002, -4.2, -5.300000000000001, -18.9, -3.3, -7.300000000000001, -5.300000000000001, -4.300000000000001, -9.0, -18.699999999999996, -3.3, -5.300000000000001, -38.90000000000006, -29.900000000000052, -6.300000000000001, -8.899999999999999, -6.4, -6.2, -15.099999999999994, -4.2, -18.3, -3.2, -21.5, -10.399999999999986, -8.899999999999999, -17.900000000000002, -3.3, -14.599999999999989, -5.300000000000001, -9.2, -4.300000000000001, -4.300000000000001, -23.9, -3.3, -3.3, -13.299999999999995, -5.0, -14.199999999999996, -4.7, -10.999999999999998, -13.4, -3.2, -9.5, -11.799999999999999, -8.8, -5.4, -6.300000000000001, -5.800000000000001, -3.3000000000000003, -12.4, -3.3, -4.300000000000001, -8.2, -3.2, -8.3, -6.6000000000000005, -11.600000000000001, -11.1, -13.800000000000002, -3.2, -5.2, -7.299999999999999, -3.3, -4.2, -4.2, -5.6, -13.2, -4.2, -5.2, -6.300000000000001, -9.2, -22.1, -6.9, -7.899999999999999, -6.199999999999999, -23.400000000000002, -4.3, -3.2, -8.4, -4.2, -4.300000000000001, -5.800000000000001, -24.100000000000016, -3.3, -4.2, -27.400000000000002, -12.5, -4.300000000000001, -4.2, -10.699999999999996, -19.10000000000001, -23.700000000000003, -3.2, -9.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9259011746833559, "mean_inference_ms": 1.1894047209016665, "mean_action_processing_ms": 0.06545634460176694, "mean_env_wait_ms": 5.43728603700315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 988000, "timesteps_this_iter": 0, "agent_timesteps_total": 988000, "timers": {"sample_time_ms": 14423.033, "sample_throughput": 277.334, "load_time_ms": 0.346, "load_throughput": 11556944.272, "learn_time_ms": 6669.345, "learn_throughput": 599.759, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.0915225113086122, "policy_loss": 0.0009758593394390998, "vf_loss": 9.054544719380717, "vf_explained_var": 0.30776248401211154, "kl": 0.005798865828552365, "entropy": 0.18308643346992873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 988000, "num_agent_steps_sampled": 988000, "num_steps_trained": 988000, "num_agent_steps_trained": 988000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9880, "training_iteration": 247, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-43-34", "timestamp": 1643669014, "time_this_iter_s": 13.74074411392212, "time_total_s": 3686.625574350357, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3686.625574350357, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 24.825, "ram_util_percent": 71.44000000000003}}
{"episode_reward_max": -3.2, "episode_reward_min": -27.799999999999994, "episode_reward_mean": -9.036, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -13.299999999999995, -5.0, -14.199999999999996, -4.7, -10.999999999999998, -13.4, -3.2, -9.5, -11.799999999999999, -8.8, -5.4, -6.300000000000001, -5.800000000000001, -3.3000000000000003, -12.4, -3.3, -4.300000000000001, -8.2, -3.2, -8.3, -6.6000000000000005, -11.600000000000001, -11.1, -13.800000000000002, -3.2, -5.2, -7.299999999999999, -3.3, -4.2, -4.2, -5.6, -13.2, -4.2, -5.2, -6.300000000000001, -9.2, -22.1, -6.9, -7.899999999999999, -6.199999999999999, -23.400000000000002, -4.3, -3.2, -8.4, -4.2, -4.300000000000001, -5.800000000000001, -24.100000000000016, -3.3, -4.2, -27.400000000000002, -12.5, -4.300000000000001, -4.2, -10.699999999999996, -19.10000000000001, -23.700000000000003, -3.2, -9.499999999999998, -18.2, -3.4, -5.800000000000001, -4.2, -5.2, -11.3, -4.900000000000002, -12.399999999999999, -3.3, -4.300000000000001, -16.3, -18.1, -3.3, -6.300000000000001, -15.2, -5.5, -6.7, -9.5, -4.2, -15.5, -11.899999999999999, -5.1, -15.1, -4.300000000000001, -12.1, -12.399999999999974, -5.2, -17.2, -27.799999999999994, -9.9, -3.3, -4.4, -4.300000000000001, -7.9, -11.3, -15.099999999999998, -12.599999999999998, -18.799999999999997, -5.2, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9255314547583218, "mean_inference_ms": 1.188961757964377, "mean_action_processing_ms": 0.06543183691413582, "mean_env_wait_ms": 5.435697990791414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 992000, "timesteps_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"sample_time_ms": 14363.95, "sample_throughput": 278.475, "load_time_ms": 0.349, "load_throughput": 11462978.956, "learn_time_ms": 6660.228, "learn_throughput": 600.58, "update_time_ms": 1.503}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.06985138270162768, "policy_loss": -0.007613713999268829, "vf_loss": 7.746378263318411, "vf_explained_var": 0.3404437793839362, "kl": 0.006305610270899232, "entropy": 0.1846408238774666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 992000, "num_agent_steps_sampled": 992000, "num_steps_trained": 992000, "num_agent_steps_trained": 992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9920, "training_iteration": 248, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-43-48", "timestamp": 1643669028, "time_this_iter_s": 13.7220139503479, "time_total_s": 3700.347588300705, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3700.347588300705, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 24.263157894736842, "ram_util_percent": 71.42105263157895}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.40000000000008, "episode_reward_mean": -10.427999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.199999999999999, -23.400000000000002, -4.3, -3.2, -8.4, -4.2, -4.300000000000001, -5.800000000000001, -24.100000000000016, -3.3, -4.2, -27.400000000000002, -12.5, -4.300000000000001, -4.2, -10.699999999999996, -19.10000000000001, -23.700000000000003, -3.2, -9.499999999999998, -18.2, -3.4, -5.800000000000001, -4.2, -5.2, -11.3, -4.900000000000002, -12.399999999999999, -3.3, -4.300000000000001, -16.3, -18.1, -3.3, -6.300000000000001, -15.2, -5.5, -6.7, -9.5, -4.2, -15.5, -11.899999999999999, -5.1, -15.1, -4.300000000000001, -12.1, -12.399999999999974, -5.2, -17.2, -27.799999999999994, -9.9, -3.3, -4.4, -4.300000000000001, -7.9, -11.3, -15.099999999999998, -12.599999999999998, -18.799999999999997, -5.2, -10.3, -12.49999999999998, -7.699999999999999, -4.4, -12.899999999999997, -3.3, -13.2, -14.799999999999981, -22.3, -13.899999999999999, -3.3, -13.399999999999997, -5.2, -5.300000000000001, -6.2, -4.2, -29.300000000000026, -12.999999999999998, -3.2, -8.3, -17.599999999999998, -12.599999999999998, -6.2, -7.799999999999999, -16.5, -10.700000000000001, -9.699999999999998, -52.40000000000008, -13.499999999999998, -9.399999999999999, -3.4, -4.3, -3.3, -5.2, -5.800000000000001, -9.5, -7.7, -8.799999999999999, -23.3, -11.799999999999999, -13.099999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9251836462317645, "mean_inference_ms": 1.1885045098901552, "mean_action_processing_ms": 0.06540662960916525, "mean_env_wait_ms": 5.433968383959275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 996000, "timesteps_this_iter": 0, "agent_timesteps_total": 996000, "timers": {"sample_time_ms": 14308.162, "sample_throughput": 279.561, "load_time_ms": 0.344, "load_throughput": 11641951.287, "learn_time_ms": 6629.799, "learn_throughput": 603.337, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.11048477384817576, "policy_loss": -0.020947904368081402, "vf_loss": 13.143011395665265, "vf_explained_var": 0.3658304469559782, "kl": 0.012327381792423124, "entropy": 0.20388026612019666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 996000, "num_agent_steps_sampled": 996000, "num_steps_trained": 996000, "num_agent_steps_trained": 996000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 9960, "training_iteration": 249, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-44-01", "timestamp": 1643669041, "time_this_iter_s": 13.665616273880005, "time_total_s": 3714.013204574585, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3714.013204574585, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 23.625, "ram_util_percent": 71.40000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -73.4, "episode_reward_mean": -11.245, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999999, -5.1, -15.1, -4.300000000000001, -12.1, -12.399999999999974, -5.2, -17.2, -27.799999999999994, -9.9, -3.3, -4.4, -4.300000000000001, -7.9, -11.3, -15.099999999999998, -12.599999999999998, -18.799999999999997, -5.2, -10.3, -12.49999999999998, -7.699999999999999, -4.4, -12.899999999999997, -3.3, -13.2, -14.799999999999981, -22.3, -13.899999999999999, -3.3, -13.399999999999997, -5.2, -5.300000000000001, -6.2, -4.2, -29.300000000000026, -12.999999999999998, -3.2, -8.3, -17.599999999999998, -12.599999999999998, -6.2, -7.799999999999999, -16.5, -10.700000000000001, -9.699999999999998, -52.40000000000008, -13.499999999999998, -9.399999999999999, -3.4, -4.3, -3.3, -5.2, -5.800000000000001, -9.5, -7.7, -8.799999999999999, -23.3, -11.799999999999999, -13.099999999999996, -15.399999999999997, -11.199999999999998, -3.4, -17.499999999999993, -3.3, -6.199999999999999, -8.599999999999998, -5.000000000000002, -5.799999999999999, -32.3, -15.6, -3.2, -14.1, -16.7, -12.19999999999997, -13.999999999999995, -3.3, -73.4, -21.800000000000004, -16.999999999999986, -11.8, -13.8, -3.2, -4.2, -10.3, -5.300000000000001, -3.2, -8.2, -11.8, -17.5, -3.2, -4.2, -5.2, -4.300000000000001, -11.3, -6.2, -23.900000000000077, -3.2, -7.300000000000001, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9249067771935324, "mean_inference_ms": 1.188043599148422, "mean_action_processing_ms": 0.06538087751900357, "mean_env_wait_ms": 5.432175796413679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"sample_time_ms": 14240.962, "sample_throughput": 280.88, "load_time_ms": 0.346, "load_throughput": 11560926.13, "learn_time_ms": 6586.002, "learn_throughput": 607.349, "update_time_ms": 1.411}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002085685729980468, "cur_lr": 0.00010000000000000003, "total_loss": 0.3226180216597934, "policy_loss": -0.01672735635631828, "vf_loss": 33.93402649433382, "vf_explained_var": 0.1477158684243438, "kl": 0.024559211869727097, "entropy": 0.19152609542492896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 1000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 1000000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10000, "training_iteration": 250, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-44-15", "timestamp": 1643669055, "time_this_iter_s": 13.60657286643982, "time_total_s": 3727.619777441025, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3727.619777441025, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 24.810526315789474, "ram_util_percent": 71.42105263157896}}
{"episode_reward_max": -3.2, "episode_reward_min": -73.4, "episode_reward_mean": -11.345000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.599999999999998, -6.2, -7.799999999999999, -16.5, -10.700000000000001, -9.699999999999998, -52.40000000000008, -13.499999999999998, -9.399999999999999, -3.4, -4.3, -3.3, -5.2, -5.800000000000001, -9.5, -7.7, -8.799999999999999, -23.3, -11.799999999999999, -13.099999999999996, -15.399999999999997, -11.199999999999998, -3.4, -17.499999999999993, -3.3, -6.199999999999999, -8.599999999999998, -5.000000000000002, -5.799999999999999, -32.3, -15.6, -3.2, -14.1, -16.7, -12.19999999999997, -13.999999999999995, -3.3, -73.4, -21.800000000000004, -16.999999999999986, -11.8, -13.8, -3.2, -4.2, -10.3, -5.300000000000001, -3.2, -8.2, -11.8, -17.5, -3.2, -4.2, -5.2, -4.300000000000001, -11.3, -6.2, -23.900000000000077, -3.2, -7.300000000000001, -3.2, -4.2, -3.3, -4.2, -13.799999999999999, -15.1, -4.3, -7.3, -7.300000000000001, -19.4, -4.4, -3.3, -4.2, -9.3, -4.2, -15.099999999999993, -16.00000000000001, -15.9, -16.700000000000003, -5.3, -13.5, -17.699999999999996, -4.2, -13.9, -14.899999999999997, -17.5, -18.799999999999997, -19.099999999999994, -19.800000000000004, -18.4, -3.3, -19.599999999999998, -6.899999999999999, -3.3000000000000003, -7.699999999999998, -23.999999999999993, -10.399999999999999, -10.999999999999998, -12.0, -3.2, -5.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9245842017778539, "mean_inference_ms": 1.1876113849049879, "mean_action_processing_ms": 0.06535630459025268, "mean_env_wait_ms": 5.430482587422009, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1004000, "timesteps_this_iter": 0, "agent_timesteps_total": 1004000, "timers": {"sample_time_ms": 14161.105, "sample_throughput": 282.464, "load_time_ms": 0.344, "load_throughput": 11618570.637, "learn_time_ms": 6519.524, "learn_throughput": 613.542, "update_time_ms": 1.436}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.09877799435678909, "policy_loss": 0.0035955782028375773, "vf_loss": 9.517944561409694, "vf_explained_var": 0.27019990189101106, "kl": 0.009503074084964142, "entropy": 0.1960143180704245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1004000, "num_agent_steps_sampled": 1004000, "num_steps_trained": 1004000, "num_agent_steps_trained": 1004000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10040, "training_iteration": 251, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-44-29", "timestamp": 1643669069, "time_this_iter_s": 13.687592267990112, "time_total_s": 3741.307369709015, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3741.307369709015, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 20.895, "ram_util_percent": 71.44500000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -71.49999999999996, "episode_reward_mean": -10.957999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.8, -13.8, -3.2, -4.2, -10.3, -5.300000000000001, -3.2, -8.2, -11.8, -17.5, -3.2, -4.2, -5.2, -4.300000000000001, -11.3, -6.2, -23.900000000000077, -3.2, -7.300000000000001, -3.2, -4.2, -3.3, -4.2, -13.799999999999999, -15.1, -4.3, -7.3, -7.300000000000001, -19.4, -4.4, -3.3, -4.2, -9.3, -4.2, -15.099999999999993, -16.00000000000001, -15.9, -16.700000000000003, -5.3, -13.5, -17.699999999999996, -4.2, -13.9, -14.899999999999997, -17.5, -18.799999999999997, -19.099999999999994, -19.800000000000004, -18.4, -3.3, -19.599999999999998, -6.899999999999999, -3.3000000000000003, -7.699999999999998, -23.999999999999993, -10.399999999999999, -10.999999999999998, -12.0, -3.2, -5.699999999999999, -9.3, -20.4, -7.299999999999999, -3.2, -14.999999999999998, -23.5, -10.599999999999996, -30.3, -4.3, -71.49999999999996, -4.4, -24.300000000000004, -17.999999999999986, -4.300000000000001, -11.3, -5.300000000000001, -12.1, -14.0, -7.2, -16.700000000000003, -13.4, -4.2, -3.7000000000000006, -15.899999999999999, -11.4, -3.2, -21.6, -3.2, -4.9, -11.2, -5.3, -10.499999999999998, -4.800000000000001, -3.4, -9.599999999999998, -13.799999999999999, -12.7, -4.3, -19.59999999999999, -6.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9242147182662077, "mean_inference_ms": 1.187178658763558, "mean_action_processing_ms": 0.06533163940436006, "mean_env_wait_ms": 5.428772524325746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1008000, "timesteps_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"sample_time_ms": 14070.371, "sample_throughput": 284.285, "load_time_ms": 0.357, "load_throughput": 11196753.871, "learn_time_ms": 6504.536, "learn_throughput": 614.955, "update_time_ms": 1.431}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.3131196689243699, "policy_loss": -0.007055449395150106, "vf_loss": 32.01709295966292, "vf_explained_var": 0.13052172692873146, "kl": 0.013428278806361977, "entropy": 0.22749868226788378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1008000, "num_agent_steps_sampled": 1008000, "num_steps_trained": 1008000, "num_agent_steps_trained": 1008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10080, "training_iteration": 252, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-44-42", "timestamp": 1643669082, "time_this_iter_s": 13.518499851226807, "time_total_s": 3754.8258695602417, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3754.8258695602417, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 18.83157894736842, "ram_util_percent": 71.42105263157895}}
{"episode_reward_max": -3.2, "episode_reward_min": -71.49999999999996, "episode_reward_mean": -11.751, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.699999999999996, -4.2, -13.9, -14.899999999999997, -17.5, -18.799999999999997, -19.099999999999994, -19.800000000000004, -18.4, -3.3, -19.599999999999998, -6.899999999999999, -3.3000000000000003, -7.699999999999998, -23.999999999999993, -10.399999999999999, -10.999999999999998, -12.0, -3.2, -5.699999999999999, -9.3, -20.4, -7.299999999999999, -3.2, -14.999999999999998, -23.5, -10.599999999999996, -30.3, -4.3, -71.49999999999996, -4.4, -24.300000000000004, -17.999999999999986, -4.300000000000001, -11.3, -5.300000000000001, -12.1, -14.0, -7.2, -16.700000000000003, -13.4, -4.2, -3.7000000000000006, -15.899999999999999, -11.4, -3.2, -21.6, -3.2, -4.9, -11.2, -5.3, -10.499999999999998, -4.800000000000001, -3.4, -9.599999999999998, -13.799999999999999, -12.7, -4.3, -19.59999999999999, -6.6, -3.2, -5.800000000000001, -18.5, -16.799999999999997, -3.3, -6.300000000000001, -19.80000000000005, -9.599999999999998, -18.800000000000004, -4.300000000000001, -3.3, -8.2, -19.700000000000006, -9.499999999999998, -15.599999999999998, -13.900000000000002, -17.900000000000013, -13.499999999999998, -8.4, -3.2, -7.199999999999999, -14.2, -13.699999999999992, -25.900000000000013, -9.0, -15.399999999999999, -6.2, -5.300000000000001, -4.2, -18.3, -12.399999999999995, -4.800000000000001, -6.2, -3.4, -13.599999999999994, -4.300000000000001, -11.699999999999983, -13.3, -11.5, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9238784354584069, "mean_inference_ms": 1.1867972134358569, "mean_action_processing_ms": 0.06531064381134541, "mean_env_wait_ms": 5.427266622819961, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1012000, "timesteps_this_iter": 0, "agent_timesteps_total": 1012000, "timers": {"sample_time_ms": 14020.427, "sample_throughput": 285.298, "load_time_ms": 0.352, "load_throughput": 11368217.916, "learn_time_ms": 6379.625, "learn_throughput": 626.996, "update_time_ms": 1.41}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.09201685203920289, "policy_loss": -0.0037228324941249303, "vf_loss": 9.573736598927487, "vf_explained_var": 0.19415084924749149, "kl": 0.007420388211314381, "entropy": 0.19333923499911063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1012000, "num_agent_steps_sampled": 1012000, "num_steps_trained": 1012000, "num_agent_steps_trained": 1012000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10120, "training_iteration": 253, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-44-56", "timestamp": 1643669096, "time_this_iter_s": 13.815975189208984, "time_total_s": 3768.6418447494507, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3768.6418447494507, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 22.105263157894733, "ram_util_percent": 71.51052631578948}}
{"episode_reward_max": -3.2, "episode_reward_min": -50.100000000000044, "episode_reward_mean": -10.935, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.4, -4.2, -3.7000000000000006, -15.899999999999999, -11.4, -3.2, -21.6, -3.2, -4.9, -11.2, -5.3, -10.499999999999998, -4.800000000000001, -3.4, -9.599999999999998, -13.799999999999999, -12.7, -4.3, -19.59999999999999, -6.6, -3.2, -5.800000000000001, -18.5, -16.799999999999997, -3.3, -6.300000000000001, -19.80000000000005, -9.599999999999998, -18.800000000000004, -4.300000000000001, -3.3, -8.2, -19.700000000000006, -9.499999999999998, -15.599999999999998, -13.900000000000002, -17.900000000000013, -13.499999999999998, -8.4, -3.2, -7.199999999999999, -14.2, -13.699999999999992, -25.900000000000013, -9.0, -15.399999999999999, -6.2, -5.300000000000001, -4.2, -18.3, -12.399999999999995, -4.800000000000001, -6.2, -3.4, -13.599999999999994, -4.300000000000001, -11.699999999999983, -13.3, -11.5, -7.2, -4.2, -5.2, -15.999999999999998, -3.3, -22.100000000000033, -4.3, -8.9, -15.099999999999998, -18.3, -8.299999999999999, -12.1, -17.6, -7.8, -6.3, -4.300000000000001, -5.300000000000001, -9.299999999999995, -7.6, -17.3, -3.3, -13.2, -9.999999999999998, -3.3, -4.2, -8.2, -20.399999999999984, -12.199999999999998, -9.799999999999997, -3.5, -20.000000000000004, -3.3, -11.799999999999995, -25.599999999999998, -50.100000000000044, -22.3, -13.399999999999977, -16.9, -23.600000000000005, -11.2, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9236895747223532, "mean_inference_ms": 1.1864054418449728, "mean_action_processing_ms": 0.06528943741438717, "mean_env_wait_ms": 5.425750626818992, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1016000, "timesteps_this_iter": 0, "agent_timesteps_total": 1016000, "timers": {"sample_time_ms": 13752.581, "sample_throughput": 290.855, "load_time_ms": 0.35, "load_throughput": 11417732.408, "learn_time_ms": 6317.033, "learn_throughput": 633.209, "update_time_ms": 1.411}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.16557617459486249, "policy_loss": -0.009054622466685952, "vf_loss": 17.462834128961767, "vf_explained_var": 0.15854454816028635, "kl": 0.007870117704891289, "entropy": 0.2041021640382467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1016000, "num_agent_steps_sampled": 1016000, "num_steps_trained": 1016000, "num_agent_steps_trained": 1016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10160, "training_iteration": 254, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-45-09", "timestamp": 1643669109, "time_this_iter_s": 13.442866802215576, "time_total_s": 3782.0847115516663, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3782.0847115516663, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 22.904999999999998, "ram_util_percent": 71.5}}
{"episode_reward_max": -3.0000000000000004, "episode_reward_min": -50.100000000000044, "episode_reward_mean": -10.277999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.199999999999999, -14.2, -13.699999999999992, -25.900000000000013, -9.0, -15.399999999999999, -6.2, -5.300000000000001, -4.2, -18.3, -12.399999999999995, -4.800000000000001, -6.2, -3.4, -13.599999999999994, -4.300000000000001, -11.699999999999983, -13.3, -11.5, -7.2, -4.2, -5.2, -15.999999999999998, -3.3, -22.100000000000033, -4.3, -8.9, -15.099999999999998, -18.3, -8.299999999999999, -12.1, -17.6, -7.8, -6.3, -4.300000000000001, -5.300000000000001, -9.299999999999995, -7.6, -17.3, -3.3, -13.2, -9.999999999999998, -3.3, -4.2, -8.2, -20.399999999999984, -12.199999999999998, -9.799999999999997, -3.5, -20.000000000000004, -3.3, -11.799999999999995, -25.599999999999998, -50.100000000000044, -22.3, -13.399999999999977, -16.9, -23.600000000000005, -11.2, -3.2, -5.8999999999999995, -3.2, -16.7, -15.999999999999998, -17.400000000000002, -9.2, -6.800000000000001, -4.300000000000001, -14.499999999999998, -4.300000000000001, -11.4, -11.700000000000001, -7.4, -5.2, -7.799999999999998, -5.3, -16.6, -8.4, -9.2, -7.699999999999999, -6.699999999999999, -4.3, -6.2, -7.2, -13.099999999999998, -8.0, -8.7, -4.2, -10.299999999999997, -3.3, -6.300000000000001, -4.300000000000001, -7.2, -3.0000000000000004, -4.300000000000001, -4.2, -18.699999999999996, -3.3, -14.899999999999999, -9.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9235177649019554, "mean_inference_ms": 1.1859934090685618, "mean_action_processing_ms": 0.0652669957424055, "mean_env_wait_ms": 5.4241511047875415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1020000, "timesteps_this_iter": 0, "agent_timesteps_total": 1020000, "timers": {"sample_time_ms": 13667.147, "sample_throughput": 292.673, "load_time_ms": 0.359, "load_throughput": 11143949.518, "learn_time_ms": 6322.702, "learn_throughput": 632.641, "update_time_ms": 1.421}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.03528892195518179, "policy_loss": -0.01704241270499845, "vf_loss": 5.232784733336459, "vf_explained_var": 0.31535009517464585, "kl": 0.011158548603383202, "entropy": 0.1975696095215377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1020000, "num_agent_steps_sampled": 1020000, "num_steps_trained": 1020000, "num_agent_steps_trained": 1020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10200, "training_iteration": 255, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-45-23", "timestamp": 1643669123, "time_this_iter_s": 13.729390859603882, "time_total_s": 3795.81410241127, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3795.81410241127, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 25.08421052631579, "ram_util_percent": 71.5}}
{"episode_reward_max": -3.0000000000000004, "episode_reward_min": -50.100000000000044, "episode_reward_mean": -9.849, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.2, -9.999999999999998, -3.3, -4.2, -8.2, -20.399999999999984, -12.199999999999998, -9.799999999999997, -3.5, -20.000000000000004, -3.3, -11.799999999999995, -25.599999999999998, -50.100000000000044, -22.3, -13.399999999999977, -16.9, -23.600000000000005, -11.2, -3.2, -5.8999999999999995, -3.2, -16.7, -15.999999999999998, -17.400000000000002, -9.2, -6.800000000000001, -4.300000000000001, -14.499999999999998, -4.300000000000001, -11.4, -11.700000000000001, -7.4, -5.2, -7.799999999999998, -5.3, -16.6, -8.4, -9.2, -7.699999999999999, -6.699999999999999, -4.3, -6.2, -7.2, -13.099999999999998, -8.0, -8.7, -4.2, -10.299999999999997, -3.3, -6.300000000000001, -4.300000000000001, -7.2, -3.0000000000000004, -4.300000000000001, -4.2, -18.699999999999996, -3.3, -14.899999999999999, -9.999999999999998, -12.0, -4.1, -13.9, -4.2, -3.3, -8.7, -5.700000000000001, -4.3, -23.600000000000005, -16.099999999999998, -11.2, -3.3, -7.300000000000001, -8.399999999999999, -22.4, -3.2, -4.3, -5.3, -13.599999999999998, -3.2, -11.999999999999998, -7.999999999999997, -3.3, -12.5, -3.2, -7.300000000000001, -5.300000000000001, -26.6, -4.2, -9.699999999999998, -11.699999999999987, -14.0, -3.2, -6.699999999999999, -17.2, -10.5, -7.699999999999999, -9.899999999999999, -4.2, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9232552038564609, "mean_inference_ms": 1.185664502082442, "mean_action_processing_ms": 0.06524610200786594, "mean_env_wait_ms": 5.422813980309443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1024000, "timesteps_this_iter": 0, "agent_timesteps_total": 1024000, "timers": {"sample_time_ms": 13696.94, "sample_throughput": 292.036, "load_time_ms": 0.359, "load_throughput": 11131380.042, "learn_time_ms": 6329.313, "learn_throughput": 631.98, "update_time_ms": 1.416}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.0740608354649877, "policy_loss": -0.005180177176671644, "vf_loss": 7.923935618836393, "vf_explained_var": 0.2507025474502194, "kl": 0.0053079214728216926, "entropy": 0.1838025453109895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1024000, "num_agent_steps_sampled": 1024000, "num_steps_trained": 1024000, "num_agent_steps_trained": 1024000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10240, "training_iteration": 256, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-45-37", "timestamp": 1643669137, "time_this_iter_s": 13.966180086135864, "time_total_s": 3809.780282497406, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3809.780282497406, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 25.395, "ram_util_percent": 71.5}}
{"episode_reward_max": -3.0000000000000004, "episode_reward_min": -35.000000000000064, "episode_reward_mean": -9.231, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.699999999999999, -4.3, -6.2, -7.2, -13.099999999999998, -8.0, -8.7, -4.2, -10.299999999999997, -3.3, -6.300000000000001, -4.300000000000001, -7.2, -3.0000000000000004, -4.300000000000001, -4.2, -18.699999999999996, -3.3, -14.899999999999999, -9.999999999999998, -12.0, -4.1, -13.9, -4.2, -3.3, -8.7, -5.700000000000001, -4.3, -23.600000000000005, -16.099999999999998, -11.2, -3.3, -7.300000000000001, -8.399999999999999, -22.4, -3.2, -4.3, -5.3, -13.599999999999998, -3.2, -11.999999999999998, -7.999999999999997, -3.3, -12.5, -3.2, -7.300000000000001, -5.300000000000001, -26.6, -4.2, -9.699999999999998, -11.699999999999987, -14.0, -3.2, -6.699999999999999, -17.2, -10.5, -7.699999999999999, -9.899999999999999, -4.2, -6.2, -9.899999999999999, -20.099999999999998, -3.4, -5.2, -5.300000000000001, -14.1, -3.2, -11.600000000000001, -6.899999999999999, -9.1, -9.8, -15.799999999999999, -18.900000000000006, -9.799999999999999, -8.299999999999999, -14.3, -5.300000000000001, -4.2, -6.2, -17.6, -22.3, -10.299999999999995, -8.799999999999997, -21.4, -3.2, -3.9000000000000004, -16.099999999999998, -10.0, -4.2, -6.199999999999999, -4.2, -4.300000000000001, -5.2, -35.000000000000064, -20.300000000000008, -3.3, -13.299999999999997, -3.2, -13.9, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9228125208303356, "mean_inference_ms": 1.1853363245321173, "mean_action_processing_ms": 0.06522559451967376, "mean_env_wait_ms": 5.421578977135201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1028000, "timesteps_this_iter": 0, "agent_timesteps_total": 1028000, "timers": {"sample_time_ms": 13699.001, "sample_throughput": 291.992, "load_time_ms": 0.355, "load_throughput": 11262900.107, "learn_time_ms": 6322.57, "learn_throughput": 632.654, "update_time_ms": 1.396}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.08857429109173276, "policy_loss": -0.005185417711774829, "vf_loss": 9.375791469344529, "vf_explained_var": 0.3195336103439331, "kl": 0.005745527249485682, "entropy": 0.1640331392887459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1028000, "num_agent_steps_sampled": 1028000, "num_steps_trained": 1028000, "num_agent_steps_trained": 1028000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10280, "training_iteration": 257, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-45-51", "timestamp": 1643669151, "time_this_iter_s": 13.627538204193115, "time_total_s": 3823.407820701599, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3823.407820701599, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 24.936842105263157, "ram_util_percent": 71.51578947368422}}
{"episode_reward_max": -3.2, "episode_reward_min": -66.30000000000004, "episode_reward_mean": -11.077, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.999999999999998, -7.999999999999997, -3.3, -12.5, -3.2, -7.300000000000001, -5.300000000000001, -26.6, -4.2, -9.699999999999998, -11.699999999999987, -14.0, -3.2, -6.699999999999999, -17.2, -10.5, -7.699999999999999, -9.899999999999999, -4.2, -6.2, -9.899999999999999, -20.099999999999998, -3.4, -5.2, -5.300000000000001, -14.1, -3.2, -11.600000000000001, -6.899999999999999, -9.1, -9.8, -15.799999999999999, -18.900000000000006, -9.799999999999999, -8.299999999999999, -14.3, -5.300000000000001, -4.2, -6.2, -17.6, -22.3, -10.299999999999995, -8.799999999999997, -21.4, -3.2, -3.9000000000000004, -16.099999999999998, -10.0, -4.2, -6.199999999999999, -4.2, -4.300000000000001, -5.2, -35.000000000000064, -20.300000000000008, -3.3, -13.299999999999997, -3.2, -13.9, -5.3, -66.30000000000004, -49.800000000000004, -9.799999999999999, -16.199999999999996, -4.4, -19.0, -16.099999999999994, -9.799999999999997, -11.299999999999999, -20.000000000000004, -3.3, -9.200000000000001, -8.9, -6.799999999999999, -9.4, -7.2, -17.099999999999998, -14.199999999999998, -18.5, -11.7, -10.3, -4.2, -7.800000000000001, -12.299999999999997, -3.2, -4.300000000000001, -8.999999999999998, -3.3, -18.10000000000002, -15.9, -5.2, -12.999999999999996, -13.2, -17.600000000000005, -11.2, -10.899999999999977, -6.300000000000001, -3.3, -9.5, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9222986236019426, "mean_inference_ms": 1.1849735883884864, "mean_action_processing_ms": 0.06520386567680252, "mean_env_wait_ms": 5.42026664095908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1032000, "timesteps_this_iter": 0, "agent_timesteps_total": 1032000, "timers": {"sample_time_ms": 13682.208, "sample_throughput": 292.35, "load_time_ms": 0.353, "load_throughput": 11344388.397, "learn_time_ms": 6319.95, "learn_throughput": 632.916, "update_time_ms": 1.404}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0003128528594970703, "cur_lr": 0.00010000000000000003, "total_loss": 0.3178637992983724, "policy_loss": -0.0183562397068086, "vf_loss": 33.620899158395744, "vf_explained_var": 0.138029751213648, "kl": 0.035329192423662004, "entropy": 0.2325253082699673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1032000, "num_agent_steps_sampled": 1032000, "num_steps_trained": 1032000, "num_agent_steps_trained": 1032000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10320, "training_iteration": 258, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-46-04", "timestamp": 1643669164, "time_this_iter_s": 13.595603942871094, "time_total_s": 3837.00342464447, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3837.00342464447, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 22.799999999999994, "ram_util_percent": 71.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -66.30000000000004, "episode_reward_mean": -10.983000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.3, -10.299999999999995, -8.799999999999997, -21.4, -3.2, -3.9000000000000004, -16.099999999999998, -10.0, -4.2, -6.199999999999999, -4.2, -4.300000000000001, -5.2, -35.000000000000064, -20.300000000000008, -3.3, -13.299999999999997, -3.2, -13.9, -5.3, -66.30000000000004, -49.800000000000004, -9.799999999999999, -16.199999999999996, -4.4, -19.0, -16.099999999999994, -9.799999999999997, -11.299999999999999, -20.000000000000004, -3.3, -9.200000000000001, -8.9, -6.799999999999999, -9.4, -7.2, -17.099999999999998, -14.199999999999998, -18.5, -11.7, -10.3, -4.2, -7.800000000000001, -12.299999999999997, -3.2, -4.300000000000001, -8.999999999999998, -3.3, -18.10000000000002, -15.9, -5.2, -12.999999999999996, -13.2, -17.600000000000005, -11.2, -10.899999999999977, -6.300000000000001, -3.3, -9.5, -3.3, -9.899999999999997, -4.3, -14.099999999999996, -3.2, -10.1, -22.6, -9.3, -3.2, -16.2, -9.899999999999999, -7.2, -3.2, -12.599999999999998, -10.0, -4.2, -16.3, -4.300000000000001, -21.299999999999997, -9.3, -10.9, -7.9, -6.999999999999999, -10.1, -4.4, -4.2, -13.8, -8.799999999999999, -9.8, -3.2, -16.59999999999999, -14.7, -3.3, -5.2, -14.6, -13.2, -11.299999999999999, -4.4, -4.300000000000001, -4.2, -9.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9218151339352216, "mean_inference_ms": 1.184567581505076, "mean_action_processing_ms": 0.0651810511043106, "mean_env_wait_ms": 5.418682064616133, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1036000, "timesteps_this_iter": 0, "agent_timesteps_total": 1036000, "timers": {"sample_time_ms": 13660.36, "sample_throughput": 292.818, "load_time_ms": 0.355, "load_throughput": 11255344.157, "learn_time_ms": 6329.387, "learn_throughput": 631.973, "update_time_ms": 1.406}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00046927928924560535, "cur_lr": 0.00010000000000000003, "total_loss": 0.03977659664026672, "policy_loss": -0.012786601373665435, "vf_loss": 5.255310092433806, "vf_explained_var": 0.44603794229927884, "kl": 0.021517617171615117, "entropy": 0.2276370767143465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1036000, "num_agent_steps_sampled": 1036000, "num_steps_trained": 1036000, "num_agent_steps_trained": 1036000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10360, "training_iteration": 259, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-46-18", "timestamp": 1643669178, "time_this_iter_s": 13.56919002532959, "time_total_s": 3850.5726146698, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3850.5726146698, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 24.22105263157895, "ram_util_percent": 71.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.5, "episode_reward_mean": -10.800999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -4.2, -7.800000000000001, -12.299999999999997, -3.2, -4.300000000000001, -8.999999999999998, -3.3, -18.10000000000002, -15.9, -5.2, -12.999999999999996, -13.2, -17.600000000000005, -11.2, -10.899999999999977, -6.300000000000001, -3.3, -9.5, -3.3, -9.899999999999997, -4.3, -14.099999999999996, -3.2, -10.1, -22.6, -9.3, -3.2, -16.2, -9.899999999999999, -7.2, -3.2, -12.599999999999998, -10.0, -4.2, -16.3, -4.300000000000001, -21.299999999999997, -9.3, -10.9, -7.9, -6.999999999999999, -10.1, -4.4, -4.2, -13.8, -8.799999999999999, -9.8, -3.2, -16.59999999999999, -14.7, -3.3, -5.2, -14.6, -13.2, -11.299999999999999, -4.4, -4.300000000000001, -4.2, -9.899999999999999, -4.800000000000001, -5.2, -18.6, -18.3, -5.4, -21.3, -30.3, -5.2, -4.300000000000001, -7.3, -12.3, -7.499999999999999, -16.0, -12.299999999999999, -17.0, -12.999999999999998, -7.499999999999999, -19.299999999999997, -6.0, -6.2, -6.499999999999999, -6.5, -11.399999999999997, -18.2, -4.700000000000001, -3.2, -95.5, -6.2, -7.2, -16.799999999999997, -20.999999999999996, -14.3, -4.2, -14.700000000000001, -12.999999999999996, -10.499999999999998, -19.7, -5.3, -4.3, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9214602601371661, "mean_inference_ms": 1.1841655672016633, "mean_action_processing_ms": 0.06515906159884023, "mean_env_wait_ms": 5.417015479969995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1040000, "timesteps_this_iter": 0, "agent_timesteps_total": 1040000, "timers": {"sample_time_ms": 13663.537, "sample_throughput": 292.75, "load_time_ms": 0.354, "load_throughput": 11287906.883, "learn_time_ms": 6340.455, "learn_throughput": 630.87, "update_time_ms": 1.424}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.5415648420869563, "policy_loss": -0.009652324858051474, "vf_loss": 55.12113100110844, "vf_explained_var": -0.0011190022832603865, "kl": 0.00833569499145232, "entropy": 0.2794081466653014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1040000, "num_agent_steps_sampled": 1040000, "num_steps_trained": 1040000, "num_agent_steps_trained": 1040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10400, "training_iteration": 260, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-46-32", "timestamp": 1643669192, "time_this_iter_s": 13.654461860656738, "time_total_s": 3864.2270765304565, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3864.2270765304565, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 24.24736842105263, "ram_util_percent": 71.52631578947368}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.5, "episode_reward_mean": -11.512, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.9, -6.999999999999999, -10.1, -4.4, -4.2, -13.8, -8.799999999999999, -9.8, -3.2, -16.59999999999999, -14.7, -3.3, -5.2, -14.6, -13.2, -11.299999999999999, -4.4, -4.300000000000001, -4.2, -9.899999999999999, -4.800000000000001, -5.2, -18.6, -18.3, -5.4, -21.3, -30.3, -5.2, -4.300000000000001, -7.3, -12.3, -7.499999999999999, -16.0, -12.299999999999999, -17.0, -12.999999999999998, -7.499999999999999, -19.299999999999997, -6.0, -6.2, -6.499999999999999, -6.5, -11.399999999999997, -18.2, -4.700000000000001, -3.2, -95.5, -6.2, -7.2, -16.799999999999997, -20.999999999999996, -14.3, -4.2, -14.700000000000001, -12.999999999999996, -10.499999999999998, -19.7, -5.3, -4.3, -4.2, -15.399999999999997, -6.3, -15.5, -4.2, -15.8, -14.899999999999997, -21.000000000000007, -11.3, -20.6, -14.099999999999998, -9.5, -10.0, -6.499999999999999, -10.799999999999999, -6.2, -6.4, -8.3, -11.600000000000001, -7.5, -11.099999999999998, -19.3, -3.2, -8.2, -5.4, -6.2, -22.8, -18.800000000000004, -13.899999999999999, -4.3, -10.2, -8.7, -9.2, -21.2, -6.300000000000001, -17.4, -11.699999999999996, -8.7, -9.6, -13.899999999999999, -9.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9211216135108228, "mean_inference_ms": 1.1837616334817342, "mean_action_processing_ms": 0.06513775405480313, "mean_env_wait_ms": 5.415269270550814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1044000, "timesteps_this_iter": 0, "agent_timesteps_total": 1044000, "timers": {"sample_time_ms": 13662.546, "sample_throughput": 292.771, "load_time_ms": 0.351, "load_throughput": 11402987.834, "learn_time_ms": 6335.815, "learn_throughput": 631.332, "update_time_ms": 1.412}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.06984574257306034, "policy_loss": -0.00924983133551895, "vf_loss": 7.9084709544976555, "vf_explained_var": 0.33040452343161386, "kl": 0.015437197888198594, "entropy": 0.201275006433328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1044000, "num_agent_steps_sampled": 1044000, "num_steps_trained": 1044000, "num_agent_steps_trained": 1044000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10440, "training_iteration": 261, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-46-45", "timestamp": 1643669205, "time_this_iter_s": 13.517479181289673, "time_total_s": 3877.744555711746, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3877.744555711746, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 23.279999999999998, "ram_util_percent": 71.54999999999998}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -95.5, "episode_reward_mean": -11.295, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.499999999999999, -6.5, -11.399999999999997, -18.2, -4.700000000000001, -3.2, -95.5, -6.2, -7.2, -16.799999999999997, -20.999999999999996, -14.3, -4.2, -14.700000000000001, -12.999999999999996, -10.499999999999998, -19.7, -5.3, -4.3, -4.2, -15.399999999999997, -6.3, -15.5, -4.2, -15.8, -14.899999999999997, -21.000000000000007, -11.3, -20.6, -14.099999999999998, -9.5, -10.0, -6.499999999999999, -10.799999999999999, -6.2, -6.4, -8.3, -11.600000000000001, -7.5, -11.099999999999998, -19.3, -3.2, -8.2, -5.4, -6.2, -22.8, -18.800000000000004, -13.899999999999999, -4.3, -10.2, -8.7, -9.2, -21.2, -6.300000000000001, -17.4, -11.699999999999996, -8.7, -9.6, -13.899999999999999, -9.099999999999998, -7.2, -9.7, -3.3, -8.599999999999998, -4.3, -30.3, -13.2, -12.999999999999988, -3.3, -17.499999999999996, -13.299999999999994, -8.5, -7.800000000000001, -12.5, -15.899999999999999, -4.2, -11.600000000000001, -16.799999999999997, -6.3, -7.0, -4.2, -24.4, -4.2, -13.699999999999998, -8.2, -4.3, -9.8, -9.600000000000001, -3.2, -8.3, -8.899999999999999, -19.299999999999997, -8.999999999999996, -9.600000000000001, -4.6, -2.9000000000000004, -7.1, -12.2, -5.4, -3.8000000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9207918174027028, "mean_inference_ms": 1.183357893230763, "mean_action_processing_ms": 0.06511572130589521, "mean_env_wait_ms": 5.413452387336865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1048000, "timesteps_this_iter": 0, "agent_timesteps_total": 1048000, "timers": {"sample_time_ms": 13646.643, "sample_throughput": 293.112, "load_time_ms": 0.337, "load_throughput": 11869272.02, "learn_time_ms": 6356.236, "learn_throughput": 629.303, "update_time_ms": 1.399}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.11158254703166344, "policy_loss": -0.00016255357292711093, "vf_loss": 11.174020976340898, "vf_explained_var": 0.27942876553022733, "kl": 0.006957811662852951, "entropy": 0.21492335356531606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1048000, "num_agent_steps_sampled": 1048000, "num_steps_trained": 1048000, "num_agent_steps_trained": 1048000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10480, "training_iteration": 262, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-46-59", "timestamp": 1643669219, "time_this_iter_s": 13.610045909881592, "time_total_s": 3891.354601621628, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3891.354601621628, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 24.48421052631579, "ram_util_percent": 71.52105263157894}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -30.3, "episode_reward_mean": -10.351, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.3, -3.2, -8.2, -5.4, -6.2, -22.8, -18.800000000000004, -13.899999999999999, -4.3, -10.2, -8.7, -9.2, -21.2, -6.300000000000001, -17.4, -11.699999999999996, -8.7, -9.6, -13.899999999999999, -9.099999999999998, -7.2, -9.7, -3.3, -8.599999999999998, -4.3, -30.3, -13.2, -12.999999999999988, -3.3, -17.499999999999996, -13.299999999999994, -8.5, -7.800000000000001, -12.5, -15.899999999999999, -4.2, -11.600000000000001, -16.799999999999997, -6.3, -7.0, -4.2, -24.4, -4.2, -13.699999999999998, -8.2, -4.3, -9.8, -9.600000000000001, -3.2, -8.3, -8.899999999999999, -19.299999999999997, -8.999999999999996, -9.600000000000001, -4.6, -2.9000000000000004, -7.1, -12.2, -5.4, -3.8000000000000007, -15.5, -3.8000000000000007, -11.6, -13.999999999999996, -5.999999999999999, -12.5, -10.299999999999997, -14.19999999999999, -24.0, -3.3, -4.5, -15.999999999999998, -7.700000000000001, -8.5, -9.2, -19.2, -13.7, -3.2, -12.7, -7.2, -8.499999999999996, -9.7, -4.9, -14.799999999999999, -3.2, -27.20000000000005, -3.5000000000000004, -19.900000000000006, -5.300000000000001, -6.2, -8.899999999999997, -7.300000000000001, -17.500000000000004, -13.499999999999998, -5.3, -13.1, -11.299999999999999, -3.7000000000000006, -14.899999999999999, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9205628945832766, "mean_inference_ms": 1.1829442748268055, "mean_action_processing_ms": 0.06509273830673039, "mean_env_wait_ms": 5.411685103251598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1052000, "timesteps_this_iter": 0, "agent_timesteps_total": 1052000, "timers": {"sample_time_ms": 13642.695, "sample_throughput": 293.197, "load_time_ms": 0.34, "load_throughput": 11774311.18, "learn_time_ms": 6349.704, "learn_throughput": 629.951, "update_time_ms": 1.404}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.10055555987261956, "policy_loss": 4.934612461315688e-05, "vf_loss": 10.049836551374005, "vf_explained_var": 0.22325990975544016, "kl": 0.011151796167658207, "entropy": 0.21025661717980137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1052000, "num_agent_steps_sampled": 1052000, "num_steps_trained": 1052000, "num_agent_steps_trained": 1052000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10520, "training_iteration": 263, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-47-12", "timestamp": 1643669232, "time_this_iter_s": 13.50757098197937, "time_total_s": 3904.862172603607, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3904.862172603607, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 20.415789473684207, "ram_util_percent": 71.5894736842105}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -58.2, "episode_reward_mean": -10.797, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -24.4, -4.2, -13.699999999999998, -8.2, -4.3, -9.8, -9.600000000000001, -3.2, -8.3, -8.899999999999999, -19.299999999999997, -8.999999999999996, -9.600000000000001, -4.6, -2.9000000000000004, -7.1, -12.2, -5.4, -3.8000000000000007, -15.5, -3.8000000000000007, -11.6, -13.999999999999996, -5.999999999999999, -12.5, -10.299999999999997, -14.19999999999999, -24.0, -3.3, -4.5, -15.999999999999998, -7.700000000000001, -8.5, -9.2, -19.2, -13.7, -3.2, -12.7, -7.2, -8.499999999999996, -9.7, -4.9, -14.799999999999999, -3.2, -27.20000000000005, -3.5000000000000004, -19.900000000000006, -5.300000000000001, -6.2, -8.899999999999997, -7.300000000000001, -17.500000000000004, -13.499999999999998, -5.3, -13.1, -11.299999999999999, -3.7000000000000006, -14.899999999999999, -4.2, -12.3, -4.2, -19.699999999999996, -12.3, -8.5, -23.2, -9.099999999999993, -8.5, -4.3, -5.3, -13.799999999999997, -3.2, -19.599999999999998, -5.2, -4.2, -5.4, -7.699999999999998, -16.1, -4.2, -58.2, -14.799999999999997, -5.2, -20.9, -22.700000000000003, -4.700000000000001, -20.59999999999999, -18.3, -16.89999999999999, -3.7000000000000006, -3.4, -4.300000000000001, -24.5, -14.099999999999998, -9.3, -16.799999999999997, -3.3, -6.3, -12.2, -9.7, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9203122903089409, "mean_inference_ms": 1.1825492902123818, "mean_action_processing_ms": 0.0650707953518604, "mean_env_wait_ms": 5.40998705216712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1056000, "timesteps_this_iter": 0, "agent_timesteps_total": 1056000, "timers": {"sample_time_ms": 13660.083, "sample_throughput": 292.824, "load_time_ms": 0.339, "load_throughput": 11812445.258, "learn_time_ms": 6358.3, "learn_throughput": 629.099, "update_time_ms": 1.393}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.2013320430342148, "policy_loss": -0.008696431712678043, "vf_loss": 21.001845121447758, "vf_explained_var": 0.23649434690834373, "kl": 0.014240335965688208, "entropy": 0.21258373096264818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1056000, "num_agent_steps_sampled": 1056000, "num_steps_trained": 1056000, "num_agent_steps_trained": 1056000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10560, "training_iteration": 264, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-47-26", "timestamp": 1643669246, "time_this_iter_s": 13.767151117324829, "time_total_s": 3918.629323720932, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3918.629323720932, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 24.04, "ram_util_percent": 71.59999999999998}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -106.5, "episode_reward_mean": -13.286000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.499999999999996, -9.7, -4.9, -14.799999999999999, -3.2, -27.20000000000005, -3.5000000000000004, -19.900000000000006, -5.300000000000001, -6.2, -8.899999999999997, -7.300000000000001, -17.500000000000004, -13.499999999999998, -5.3, -13.1, -11.299999999999999, -3.7000000000000006, -14.899999999999999, -4.2, -12.3, -4.2, -19.699999999999996, -12.3, -8.5, -23.2, -9.099999999999993, -8.5, -4.3, -5.3, -13.799999999999997, -3.2, -19.599999999999998, -5.2, -4.2, -5.4, -7.699999999999998, -16.1, -4.2, -58.2, -14.799999999999997, -5.2, -20.9, -22.700000000000003, -4.700000000000001, -20.59999999999999, -18.3, -16.89999999999999, -3.7000000000000006, -3.4, -4.300000000000001, -24.5, -14.099999999999998, -9.3, -16.799999999999997, -3.3, -6.3, -12.2, -9.7, -10.3, -38.3, -15.899999999999999, -12.899999999999999, -7.9, -5.3, -4.9, -12.1, -8.3, -6.300000000000001, -15.2, -16.9, -33.500000000000014, -15.399999999999974, -2.4000000000000004, -15.5, -13.3, -16.8, -3.2, -28.4, -6.199999999999999, -5.300000000000001, -13.500000000000002, -17.9, -25.000000000000004, -19.0, -4.7, -5.300000000000001, -15.899999999999999, -24.00000000000001, -10.3, -3.6000000000000005, -106.5, -11.7, -6.3, -11.399999999999999, -50.5, -5.2, -12.5, -6.2, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9202043767531981, "mean_inference_ms": 1.1824943599068947, "mean_action_processing_ms": 0.06506797010299298, "mean_env_wait_ms": 5.410020195184281, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1060000, "timesteps_this_iter": 0, "agent_timesteps_total": 1060000, "timers": {"sample_time_ms": 13807.809, "sample_throughput": 289.691, "load_time_ms": 0.33, "load_throughput": 12127523.493, "learn_time_ms": 6348.71, "learn_throughput": 630.049, "update_time_ms": 1.388}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.6475208507345048, "policy_loss": -0.007960467495184432, "vf_loss": 65.54733019926215, "vf_explained_var": -0.04225995655982725, "kl": 0.01141058133754025, "entropy": 0.25540871230024165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1060000, "num_agent_steps_sampled": 1060000, "num_steps_trained": 1060000, "num_agent_steps_trained": 1060000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10600, "training_iteration": 265, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-47-41", "timestamp": 1643669261, "time_this_iter_s": 15.023575067520142, "time_total_s": 3933.652898788452, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3933.652898788452, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 34.94285714285714, "ram_util_percent": 72.08095238095237}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -106.5, "episode_reward_mean": -13.050999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.799999999999997, -5.2, -20.9, -22.700000000000003, -4.700000000000001, -20.59999999999999, -18.3, -16.89999999999999, -3.7000000000000006, -3.4, -4.300000000000001, -24.5, -14.099999999999998, -9.3, -16.799999999999997, -3.3, -6.3, -12.2, -9.7, -10.3, -38.3, -15.899999999999999, -12.899999999999999, -7.9, -5.3, -4.9, -12.1, -8.3, -6.300000000000001, -15.2, -16.9, -33.500000000000014, -15.399999999999974, -2.4000000000000004, -15.5, -13.3, -16.8, -3.2, -28.4, -6.199999999999999, -5.300000000000001, -13.500000000000002, -17.9, -25.000000000000004, -19.0, -4.7, -5.300000000000001, -15.899999999999999, -24.00000000000001, -10.3, -3.6000000000000005, -106.5, -11.7, -6.3, -11.399999999999999, -50.5, -5.2, -12.5, -6.2, -5.2, -3.2, -20.2, -14.099999999999996, -21.3, -15.4, -6.4, -17.099999999999998, -12.199999999999998, -5.300000000000001, -5.9, -16.299999999999997, -7.899999999999999, -14.299999999999997, -15.499999999999995, -6.499999999999999, -4.2, -15.199999999999973, -6.2, -6.300000000000001, -8.500000000000002, -8.2, -5.300000000000001, -8.2, -9.5, -4.2, -24.2, -3.5000000000000004, -5.2, -9.5, -8.3, -11.899999999999997, -6.1, -14.599999999999998, -20.2, -7.399999999999999, -4.3, -23.5, -5.2, -7.4, -15.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9200736935558291, "mean_inference_ms": 1.1825250233400018, "mean_action_processing_ms": 0.06506903717601832, "mean_env_wait_ms": 5.410390699716463, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1064000, "timesteps_this_iter": 0, "agent_timesteps_total": 1064000, "timers": {"sample_time_ms": 13795.592, "sample_throughput": 289.948, "load_time_ms": 0.329, "load_throughput": 12172397.881, "learn_time_ms": 6343.373, "learn_throughput": 630.579, "update_time_ms": 1.381}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.09304164756610188, "policy_loss": -0.005737693363460162, "vf_loss": 9.877398559931786, "vf_explained_var": 0.16257581319860231, "kl": 0.007612392670632934, "entropy": 0.2096095635846097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1064000, "num_agent_steps_sampled": 1064000, "num_steps_trained": 1064000, "num_agent_steps_trained": 1064000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10640, "training_iteration": 266, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-47-55", "timestamp": 1643669275, "time_this_iter_s": 13.888903141021729, "time_total_s": 3947.541801929474, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3947.541801929474, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 27.78, "ram_util_percent": 72.12999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -106.5, "episode_reward_mean": -14.498999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -13.500000000000002, -17.9, -25.000000000000004, -19.0, -4.7, -5.300000000000001, -15.899999999999999, -24.00000000000001, -10.3, -3.6000000000000005, -106.5, -11.7, -6.3, -11.399999999999999, -50.5, -5.2, -12.5, -6.2, -5.2, -3.2, -20.2, -14.099999999999996, -21.3, -15.4, -6.4, -17.099999999999998, -12.199999999999998, -5.300000000000001, -5.9, -16.299999999999997, -7.899999999999999, -14.299999999999997, -15.499999999999995, -6.499999999999999, -4.2, -15.199999999999973, -6.2, -6.300000000000001, -8.500000000000002, -8.2, -5.300000000000001, -8.2, -9.5, -4.2, -24.2, -3.5000000000000004, -5.2, -9.5, -8.3, -11.899999999999997, -6.1, -14.599999999999998, -20.2, -7.399999999999999, -4.3, -23.5, -5.2, -7.4, -15.7, -12.399999999999999, -9.600000000000001, -16.799999999999997, -14.0, -16.9, -8.3, -14.099999999999998, -4.4, -16.899999999999995, -3.2, -19.3, -5.2, -97.2, -4.300000000000001, -99.19999999999986, -4.2, -4.3, -13.2, -24.000000000000007, -6.3, -15.2, -22.3, -12.3, -10.3, -21.3, -4.3, -15.499999999999998, -27.599999999999998, -8.600000000000001, -12.7, -23.3, -14.2, -15.999999999999998, -9.999999999999996, -13.9, -5.3, -8.399999999999999, -10.3, -16.999999999999996, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.919823384376773, "mean_inference_ms": 1.1824799807655604, "mean_action_processing_ms": 0.06506685650476694, "mean_env_wait_ms": 5.410278535421919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1068000, "timesteps_this_iter": 0, "agent_timesteps_total": 1068000, "timers": {"sample_time_ms": 13825.863, "sample_throughput": 289.313, "load_time_ms": 0.329, "load_throughput": 12172397.881, "learn_time_ms": 6366.312, "learn_throughput": 628.307, "update_time_ms": 1.388}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.7829078311871697, "policy_loss": -0.009132586269369048, "vf_loss": 79.20325722950761, "vf_explained_var": 0.05205467606103548, "kl": 0.011180184977445119, "entropy": 0.23418637460037586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1068000, "num_agent_steps_sampled": 1068000, "num_steps_trained": 1068000, "num_agent_steps_trained": 1068000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10680, "training_iteration": 267, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-48-09", "timestamp": 1643669289, "time_this_iter_s": 14.212731122970581, "time_total_s": 3961.7545330524445, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3961.7545330524445, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 30.405, "ram_util_percent": 72.28999999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -99.19999999999986, "episode_reward_mean": -13.549, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -5.300000000000001, -8.2, -9.5, -4.2, -24.2, -3.5000000000000004, -5.2, -9.5, -8.3, -11.899999999999997, -6.1, -14.599999999999998, -20.2, -7.399999999999999, -4.3, -23.5, -5.2, -7.4, -15.7, -12.399999999999999, -9.600000000000001, -16.799999999999997, -14.0, -16.9, -8.3, -14.099999999999998, -4.4, -16.899999999999995, -3.2, -19.3, -5.2, -97.2, -4.300000000000001, -99.19999999999986, -4.2, -4.3, -13.2, -24.000000000000007, -6.3, -15.2, -22.3, -12.3, -10.3, -21.3, -4.3, -15.499999999999998, -27.599999999999998, -8.600000000000001, -12.7, -23.3, -14.2, -15.999999999999998, -9.999999999999996, -13.9, -5.3, -8.399999999999999, -10.3, -16.999999999999996, -3.2, -13.5, -16.6, -3.3, -33.3, -8.099999999999998, -14.1, -6.3, -5.3, -15.399999999999974, -4.300000000000001, -11.3, -21.400000000000002, -4.3, -4.3, -23.5, -12.3, -18.8, -7.300000000000001, -6.2, -12.200000000000001, -11.3, -12.0, -14.8, -13.0, -14.7, -12.7, -10.1, -3.6000000000000005, -32.2, -5.2, -4.3, -14.899999999999999, -16.799999999999997, -4.2, -8.799999999999999, -8.899999999999999, -3.4, -16.3, -20.2, -17.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9195632038312738, "mean_inference_ms": 1.1822881112094372, "mean_action_processing_ms": 0.06505834379164581, "mean_env_wait_ms": 5.409493395428837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1072000, "timesteps_this_iter": 0, "agent_timesteps_total": 1072000, "timers": {"sample_time_ms": 13873.417, "sample_throughput": 288.321, "load_time_ms": 0.333, "load_throughput": 12017202.206, "learn_time_ms": 6401.138, "learn_throughput": 624.889, "update_time_ms": 1.398}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.12441690209952573, "policy_loss": -0.010292725008662029, "vf_loss": 13.470476225755547, "vf_explained_var": 0.15031876660162402, "kl": 0.00691457593892582, "entropy": 0.22134981843172222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1072000, "num_agent_steps_sampled": 1072000, "num_steps_trained": 1072000, "num_agent_steps_trained": 1072000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10720, "training_iteration": 268, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-48-24", "timestamp": 1643669304, "time_this_iter_s": 14.189296960830688, "time_total_s": 3975.943830013275, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3975.943830013275, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 25.339999999999996, "ram_util_percent": 72.29999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -108.89999999999992, "episode_reward_mean": -13.622999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.2, -22.3, -12.3, -10.3, -21.3, -4.3, -15.499999999999998, -27.599999999999998, -8.600000000000001, -12.7, -23.3, -14.2, -15.999999999999998, -9.999999999999996, -13.9, -5.3, -8.399999999999999, -10.3, -16.999999999999996, -3.2, -13.5, -16.6, -3.3, -33.3, -8.099999999999998, -14.1, -6.3, -5.3, -15.399999999999974, -4.300000000000001, -11.3, -21.400000000000002, -4.3, -4.3, -23.5, -12.3, -18.8, -7.300000000000001, -6.2, -12.200000000000001, -11.3, -12.0, -14.8, -13.0, -14.7, -12.7, -10.1, -3.6000000000000005, -32.2, -5.2, -4.3, -14.899999999999999, -16.799999999999997, -4.2, -8.799999999999999, -8.899999999999999, -3.4, -16.3, -20.2, -17.799999999999997, -9.199999999999998, -10.2, -41.40000000000008, -15.099999999999998, -12.899999999999997, -15.599999999999998, -5.300000000000001, -11.099999999999998, -10.599999999999998, -18.700000000000003, -9.6, -12.9, -13.3, -8.7, -5.3, -5.3, -5.2, -25.10000000000001, -3.2, -11.099999999999996, -13.799999999999997, -5.3, -3.7, -19.499999999999996, -14.5, -24.3, -108.89999999999992, -6.300000000000001, -4.3, -7.3, -4.2, -5.300000000000001, -21.1, -14.2, -19.199999999999992, -25.799999999999997, -20.999999999999993, -12.999999999999995, -14.1, -8.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9192951734633844, "mean_inference_ms": 1.182088523077625, "mean_action_processing_ms": 0.06505076722912774, "mean_env_wait_ms": 5.40853758009908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1076000, "timesteps_this_iter": 0, "agent_timesteps_total": 1076000, "timers": {"sample_time_ms": 13948.313, "sample_throughput": 286.773, "load_time_ms": 0.326, "load_throughput": 12286500.183, "learn_time_ms": 6424.308, "learn_throughput": 622.635, "update_time_ms": 1.396}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.618568412892981, "policy_loss": -0.00889946733230865, "vf_loss": 62.74601407140814, "vf_explained_var": 0.027271573133366082, "kl": 0.011023009102800798, "entropy": 0.21070484289078303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1076000, "num_agent_steps_sampled": 1076000, "num_steps_trained": 1076000, "num_agent_steps_trained": 1076000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10760, "training_iteration": 269, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-48-38", "timestamp": 1643669318, "time_this_iter_s": 14.200206995010376, "time_total_s": 3990.1440370082855, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3990.1440370082855, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 30.625, "ram_util_percent": 72.005}}
{"episode_reward_max": -3.2, "episode_reward_min": -108.89999999999992, "episode_reward_mean": -13.574000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -12.0, -14.8, -13.0, -14.7, -12.7, -10.1, -3.6000000000000005, -32.2, -5.2, -4.3, -14.899999999999999, -16.799999999999997, -4.2, -8.799999999999999, -8.899999999999999, -3.4, -16.3, -20.2, -17.799999999999997, -9.199999999999998, -10.2, -41.40000000000008, -15.099999999999998, -12.899999999999997, -15.599999999999998, -5.300000000000001, -11.099999999999998, -10.599999999999998, -18.700000000000003, -9.6, -12.9, -13.3, -8.7, -5.3, -5.3, -5.2, -25.10000000000001, -3.2, -11.099999999999996, -13.799999999999997, -5.3, -3.7, -19.499999999999996, -14.5, -24.3, -108.89999999999992, -6.300000000000001, -4.3, -7.3, -4.2, -5.300000000000001, -21.1, -14.2, -19.199999999999992, -25.799999999999997, -20.999999999999993, -12.999999999999995, -14.1, -8.0, -7.799999999999999, -10.4, -5.3, -9.3, -19.2, -6.599999999999999, -3.6000000000000005, -25.2, -7.3, -3.9000000000000004, -8.4, -5.3, -20.800000000000022, -4.2, -5.3, -15.299999999999995, -13.5, -10.199999999999998, -25.9, -7.300000000000001, -25.600000000000005, -17.6, -4.3, -4.3, -16.3, -8.3, -4.4, -9.5, -6.300000000000001, -14.3, -95.59999999999997, -4.2, -21.0, -11.3, -3.4000000000000004, -4.3, -4.2, -6.300000000000001, -5.2, -27.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9189737932690271, "mean_inference_ms": 1.181866130451107, "mean_action_processing_ms": 0.06504175741780985, "mean_env_wait_ms": 5.407515273547984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1080000, "timesteps_this_iter": 0, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 13993.725, "sample_throughput": 285.842, "load_time_ms": 0.327, "load_throughput": 12236318.285, "learn_time_ms": 6443.874, "learn_throughput": 620.745, "update_time_ms": 1.374}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.4116463643633911, "policy_loss": -0.010159576179519776, "vf_loss": 42.180094166853095, "vf_explained_var": 0.09065899470800995, "kl": 0.007106918867697394, "entropy": 0.18221106112243668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1080000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 1080000, "num_agent_steps_trained": 1080000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10800, "training_iteration": 270, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-48-52", "timestamp": 1643669332, "time_this_iter_s": 14.070466041564941, "time_total_s": 4004.2145030498505, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4004.2145030498505, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 28.754999999999995, "ram_util_percent": 72.07499999999997}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -108.89999999999992, "episode_reward_mean": -13.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.799999999999997, -5.3, -3.7, -19.499999999999996, -14.5, -24.3, -108.89999999999992, -6.300000000000001, -4.3, -7.3, -4.2, -5.300000000000001, -21.1, -14.2, -19.199999999999992, -25.799999999999997, -20.999999999999993, -12.999999999999995, -14.1, -8.0, -7.799999999999999, -10.4, -5.3, -9.3, -19.2, -6.599999999999999, -3.6000000000000005, -25.2, -7.3, -3.9000000000000004, -8.4, -5.3, -20.800000000000022, -4.2, -5.3, -15.299999999999995, -13.5, -10.199999999999998, -25.9, -7.300000000000001, -25.600000000000005, -17.6, -4.3, -4.3, -16.3, -8.3, -4.4, -9.5, -6.300000000000001, -14.3, -95.59999999999997, -4.2, -21.0, -11.3, -3.4000000000000004, -4.3, -4.2, -6.300000000000001, -5.2, -27.4, -20.7, -12.7, -10.7, -13.299999999999981, -5.2, -22.799999999999994, -10.2, -28.2, -19.300000000000004, -9.700000000000001, -2.3000000000000003, -33.10000000000004, -8.899999999999997, -5.3, -3.3, -21.2, -4.2, -14.299999999999999, -11.2, -4.4, -11.899999999999997, -11.999999999999998, -14.600000000000001, -5.3, -5.3, -11.2, -16.2, -8.599999999999998, -26.3, -9.899999999999999, -5.3, -17.299999999999997, -4.2, -14.9, -18.3, -24.900000000000016, -6.2, -15.2, -16.9, -12.100000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9187227501580812, "mean_inference_ms": 1.181649365026104, "mean_action_processing_ms": 0.06503276592870835, "mean_env_wait_ms": 5.406616470185634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1084000, "timesteps_this_iter": 0, "agent_timesteps_total": 1084000, "timers": {"sample_time_ms": 14052.209, "sample_throughput": 284.653, "load_time_ms": 0.332, "load_throughput": 12049135.306, "learn_time_ms": 6460.356, "learn_throughput": 619.161, "update_time_ms": 1.371}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.1842343799389338, "policy_loss": -0.004031172937523293, "vf_loss": 18.825886857125067, "vf_explained_var": 0.08199782134384237, "kl": 0.009506015404274317, "entropy": 0.2682785270034626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1084000, "num_agent_steps_sampled": 1084000, "num_steps_trained": 1084000, "num_agent_steps_trained": 1084000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10840, "training_iteration": 271, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-49-06", "timestamp": 1643669346, "time_this_iter_s": 14.073791980743408, "time_total_s": 4018.288295030594, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4018.288295030594, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 28.445, "ram_util_percent": 72.16499999999999}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -95.59999999999997, "episode_reward_mean": -13.474, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.600000000000005, -17.6, -4.3, -4.3, -16.3, -8.3, -4.4, -9.5, -6.300000000000001, -14.3, -95.59999999999997, -4.2, -21.0, -11.3, -3.4000000000000004, -4.3, -4.2, -6.300000000000001, -5.2, -27.4, -20.7, -12.7, -10.7, -13.299999999999981, -5.2, -22.799999999999994, -10.2, -28.2, -19.300000000000004, -9.700000000000001, -2.3000000000000003, -33.10000000000004, -8.899999999999997, -5.3, -3.3, -21.2, -4.2, -14.299999999999999, -11.2, -4.4, -11.899999999999997, -11.999999999999998, -14.600000000000001, -5.3, -5.3, -11.2, -16.2, -8.599999999999998, -26.3, -9.899999999999999, -5.3, -17.299999999999997, -4.2, -14.9, -18.3, -24.900000000000016, -6.2, -15.2, -16.9, -12.100000000000001, -7.3, -14.5, -29.2, -23.3, -6.3999999999999995, -19.8, -14.799999999999997, -11.499999999999998, -8.6, -14.5, -11.3, -13.4, -12.7, -11.2, -8.499999999999998, -4.9, -5.4, -17.2, -9.3, -3.7000000000000006, -12.899999999999997, -19.0, -10.2, -9.3, -9.999999999999996, -8.100000000000001, -15.3, -19.800000000000004, -5.3, -46.2, -19.3, -14.199999999999998, -4.2, -5.300000000000001, -22.799999999999997, -9.699999999999982, -12.6, -12.9, -20.20000000000004, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9184294736412335, "mean_inference_ms": 1.1814186099061785, "mean_action_processing_ms": 0.06502309779303465, "mean_env_wait_ms": 5.405688085300308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1088000, "timesteps_this_iter": 0, "agent_timesteps_total": 1088000, "timers": {"sample_time_ms": 14098.876, "sample_throughput": 283.711, "load_time_ms": 0.328, "load_throughput": 12188315.292, "learn_time_ms": 6488.418, "learn_throughput": 616.483, "update_time_ms": 1.387}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.19330218489311876, "policy_loss": -0.010711169783626833, "vf_loss": 20.400632635495995, "vf_explained_var": 0.08515915479711307, "kl": 0.00999080756195998, "entropy": 0.24381812679511244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1088000, "num_agent_steps_sampled": 1088000, "num_steps_trained": 1088000, "num_agent_steps_trained": 1088000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10880, "training_iteration": 272, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-49-20", "timestamp": 1643669360, "time_this_iter_s": 14.191148042678833, "time_total_s": 4032.4794430732727, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4032.4794430732727, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 30.59499999999999, "ram_util_percent": 72.19000000000001}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -46.2, "episode_reward_mean": -13.568, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.899999999999997, -11.999999999999998, -14.600000000000001, -5.3, -5.3, -11.2, -16.2, -8.599999999999998, -26.3, -9.899999999999999, -5.3, -17.299999999999997, -4.2, -14.9, -18.3, -24.900000000000016, -6.2, -15.2, -16.9, -12.100000000000001, -7.3, -14.5, -29.2, -23.3, -6.3999999999999995, -19.8, -14.799999999999997, -11.499999999999998, -8.6, -14.5, -11.3, -13.4, -12.7, -11.2, -8.499999999999998, -4.9, -5.4, -17.2, -9.3, -3.7000000000000006, -12.899999999999997, -19.0, -10.2, -9.3, -9.999999999999996, -8.100000000000001, -15.3, -19.800000000000004, -5.3, -46.2, -19.3, -14.199999999999998, -4.2, -5.300000000000001, -22.799999999999997, -9.699999999999982, -12.6, -12.9, -20.20000000000004, -11.2, -11.1, -9.000000000000002, -7.2, -5.2, -20.300000000000004, -37.2, -11.4, -8.899999999999999, -4.2, -9.8, -19.799999999999994, -17.800000000000004, -11.7, -2.6000000000000005, -6.499999999999999, -19.5, -26.3, -8.3, -13.599999999999994, -13.599999999999998, -20.8, -4.2, -9.4, -9.3, -38.1, -9.3, -18.7, -4.9, -11.199999999999998, -30.3, -9.3, -5.300000000000001, -16.6, -15.099999999999998, -40.2, -20.200000000000003, -13.8, -4.700000000000001, -8.5, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.918285739420185, "mean_inference_ms": 1.1811684531345632, "mean_action_processing_ms": 0.06501211780836741, "mean_env_wait_ms": 5.404620739636779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1092000, "timesteps_this_iter": 0, "agent_timesteps_total": 1092000, "timers": {"sample_time_ms": 14166.881, "sample_throughput": 282.349, "load_time_ms": 0.328, "load_throughput": 12182120.244, "learn_time_ms": 6523.551, "learn_throughput": 613.163, "update_time_ms": 1.398}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.17036800799310528, "policy_loss": -0.01744490376728717, "vf_loss": 18.780313024597785, "vf_explained_var": 0.17426219198011583, "kl": 0.013902318376303895, "entropy": 0.26131958171565045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1092000, "num_agent_steps_sampled": 1092000, "num_steps_trained": 1092000, "num_agent_steps_trained": 1092000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10920, "training_iteration": 273, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-49-34", "timestamp": 1643669374, "time_this_iter_s": 14.25636076927185, "time_total_s": 4046.7358038425446, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4046.7358038425446, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 27.495238095238093, "ram_util_percent": 72.1857142857143}}
{"episode_reward_max": -2.5, "episode_reward_min": -138.6, "episode_reward_mean": -15.894000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999997, -19.0, -10.2, -9.3, -9.999999999999996, -8.100000000000001, -15.3, -19.800000000000004, -5.3, -46.2, -19.3, -14.199999999999998, -4.2, -5.300000000000001, -22.799999999999997, -9.699999999999982, -12.6, -12.9, -20.20000000000004, -11.2, -11.1, -9.000000000000002, -7.2, -5.2, -20.300000000000004, -37.2, -11.4, -8.899999999999999, -4.2, -9.8, -19.799999999999994, -17.800000000000004, -11.7, -2.6000000000000005, -6.499999999999999, -19.5, -26.3, -8.3, -13.599999999999994, -13.599999999999998, -20.8, -4.2, -9.4, -9.3, -38.1, -9.3, -18.7, -4.9, -11.199999999999998, -30.3, -9.3, -5.300000000000001, -16.6, -15.099999999999998, -40.2, -20.200000000000003, -13.8, -4.700000000000001, -8.5, -10.3, -16.9, -3.2, -14.3, -5.699999999999999, -4.3, -3.4, -9.899999999999999, -9.3, -58.8, -6.8999999999999995, -10.1, -17.099999999999998, -11.700000000000001, -13.699999999999998, -7.3, -5.3, -116.2, -4.300000000000001, -8.600000000000001, -5.3, -2.5, -5.3, -39.60000000000001, -10.7, -9.5, -11.7, -16.0, -4.300000000000001, -138.6, -43.20000000000001, -6.2, -14.2, -19.299999999999997, -9.799999999999999, -7.2, -4.3, -22.399999999999995, -21.2, -14.199999999999996, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9181316279124729, "mean_inference_ms": 1.1809179739999334, "mean_action_processing_ms": 0.06500084993720044, "mean_env_wait_ms": 5.403552644383722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1096000, "timesteps_this_iter": 0, "agent_timesteps_total": 1096000, "timers": {"sample_time_ms": 14212.358, "sample_throughput": 281.445, "load_time_ms": 0.327, "load_throughput": 12214937.022, "learn_time_ms": 6534.273, "learn_throughput": 612.157, "update_time_ms": 1.391}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 1.7012132857693358, "policy_loss": -0.007753861781399978, "vf_loss": 170.89568173167527, "vf_explained_var": -0.427573037403886, "kl": 0.014737479634317726, "entropy": 0.24566623385875455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1096000, "num_agent_steps_sampled": 1096000, "num_steps_trained": 1096000, "num_agent_steps_trained": 1096000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 10960, "training_iteration": 274, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-49-48", "timestamp": 1643669388, "time_this_iter_s": 13.976941108703613, "time_total_s": 4060.712744951248, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4060.712744951248, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 29.489473684210523, "ram_util_percent": 72.2}}
{"episode_reward_max": -2.5, "episode_reward_min": -138.6, "episode_reward_mean": -16.107999999999993, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.8, -4.2, -9.4, -9.3, -38.1, -9.3, -18.7, -4.9, -11.199999999999998, -30.3, -9.3, -5.300000000000001, -16.6, -15.099999999999998, -40.2, -20.200000000000003, -13.8, -4.700000000000001, -8.5, -10.3, -16.9, -3.2, -14.3, -5.699999999999999, -4.3, -3.4, -9.899999999999999, -9.3, -58.8, -6.8999999999999995, -10.1, -17.099999999999998, -11.700000000000001, -13.699999999999998, -7.3, -5.3, -116.2, -4.300000000000001, -8.600000000000001, -5.3, -2.5, -5.3, -39.60000000000001, -10.7, -9.5, -11.7, -16.0, -4.300000000000001, -138.6, -43.20000000000001, -6.2, -14.2, -19.299999999999997, -9.799999999999999, -7.2, -4.3, -22.399999999999995, -21.2, -14.199999999999996, -4.2, -95.59999999999987, -14.5, -3.3, -18.0, -14.399999999999997, -13.199999999999998, -14.2, -20.5, -15.2, -14.499999999999982, -4.800000000000001, -3.3, -16.999999999999996, -6.2, -20.799999999999997, -16.799999999999997, -5.3, -9.2, -16.3, -24.3, -11.0, -11.899999999999999, -17.4, -18.9, -13.2, -3.3, -6.300000000000001, -14.799999999999999, -4.2, -11.100000000000001, -26.600000000000005, -4.2, -15.799999999999974, -11.3, -7.4, -11.7, -7.599999999999998, -15.3, -4.2, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9181213003306412, "mean_inference_ms": 1.1807745510534449, "mean_action_processing_ms": 0.06499386384263418, "mean_env_wait_ms": 5.4028308494396375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1100000, "timesteps_this_iter": 0, "agent_timesteps_total": 1100000, "timers": {"sample_time_ms": 14128.186, "sample_throughput": 283.122, "load_time_ms": 0.33, "load_throughput": 12104773.449, "learn_time_ms": 6571.066, "learn_throughput": 608.729, "update_time_ms": 1.401}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.4915471956960016, "policy_loss": -0.008888467913994225, "vf_loss": 50.04244128068288, "vf_explained_var": 0.008021588927956038, "kl": 0.015989971953518284, "entropy": 0.24606932913183524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1100000, "num_agent_steps_sampled": 1100000, "num_steps_trained": 1100000, "num_agent_steps_trained": 1100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11000, "training_iteration": 275, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-50-03", "timestamp": 1643669403, "time_this_iter_s": 14.440963745117188, "time_total_s": 4075.1537086963654, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4075.1537086963654, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 30.838095238095246, "ram_util_percent": 72.16666666666667}}
{"episode_reward_max": -2.5, "episode_reward_min": -138.6, "episode_reward_mean": -13.949999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -5.3, -39.60000000000001, -10.7, -9.5, -11.7, -16.0, -4.300000000000001, -138.6, -43.20000000000001, -6.2, -14.2, -19.299999999999997, -9.799999999999999, -7.2, -4.3, -22.399999999999995, -21.2, -14.199999999999996, -4.2, -95.59999999999987, -14.5, -3.3, -18.0, -14.399999999999997, -13.199999999999998, -14.2, -20.5, -15.2, -14.499999999999982, -4.800000000000001, -3.3, -16.999999999999996, -6.2, -20.799999999999997, -16.799999999999997, -5.3, -9.2, -16.3, -24.3, -11.0, -11.899999999999999, -17.4, -18.9, -13.2, -3.3, -6.300000000000001, -14.799999999999999, -4.2, -11.100000000000001, -26.600000000000005, -4.2, -15.799999999999974, -11.3, -7.4, -11.7, -7.599999999999998, -15.3, -4.2, -10.3, -13.2, -9.200000000000001, -7.700000000000001, -10.3, -14.799999999999999, -15.1, -23.600000000000005, -4.9, -18.500000000000004, -12.499999999999995, -11.399999999999999, -3.2, -12.199999999999998, -7.799999999999998, -17.7, -3.2, -5.300000000000001, -10.799999999999997, -5.2, -3.3, -3.5000000000000004, -8.200000000000001, -7.699999999999999, -8.8, -9.2, -12.399999999999999, -6.199999999999999, -33.2, -6.3, -4.0, -22.500000000000014, -4.5, -13.2, -4.2, -12.5, -4.300000000000001, -5.3, -12.2, -13.3, -15.299999999999974], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9180596608549498, "mean_inference_ms": 1.1806507688674126, "mean_action_processing_ms": 0.06498813363569753, "mean_env_wait_ms": 5.402160198278382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1104000, "timesteps_this_iter": 0, "agent_timesteps_total": 1104000, "timers": {"sample_time_ms": 14165.118, "sample_throughput": 282.384, "load_time_ms": 0.334, "load_throughput": 11963217.342, "learn_time_ms": 6598.861, "learn_throughput": 606.165, "update_time_ms": 1.441}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.09914468067788308, "policy_loss": -0.012334603638518401, "vf_loss": 11.147165463688554, "vf_explained_var": 0.2183521132315359, "kl": 0.010845863494402991, "entropy": 0.231072700127799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1104000, "num_agent_steps_sampled": 1104000, "num_steps_trained": 1104000, "num_agent_steps_trained": 1104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11040, "training_iteration": 276, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-50-17", "timestamp": 1643669417, "time_this_iter_s": 14.166870832443237, "time_total_s": 4089.3205795288086, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4089.3205795288086, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 30.47, "ram_util_percent": 72.06999999999998}}
{"episode_reward_max": -2.3, "episode_reward_min": -33.2, "episode_reward_mean": -10.788, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -11.899999999999999, -17.4, -18.9, -13.2, -3.3, -6.300000000000001, -14.799999999999999, -4.2, -11.100000000000001, -26.600000000000005, -4.2, -15.799999999999974, -11.3, -7.4, -11.7, -7.599999999999998, -15.3, -4.2, -10.3, -13.2, -9.200000000000001, -7.700000000000001, -10.3, -14.799999999999999, -15.1, -23.600000000000005, -4.9, -18.500000000000004, -12.499999999999995, -11.399999999999999, -3.2, -12.199999999999998, -7.799999999999998, -17.7, -3.2, -5.300000000000001, -10.799999999999997, -5.2, -3.3, -3.5000000000000004, -8.200000000000001, -7.699999999999999, -8.8, -9.2, -12.399999999999999, -6.199999999999999, -33.2, -6.3, -4.0, -22.500000000000014, -4.5, -13.2, -4.2, -12.5, -4.300000000000001, -5.3, -12.2, -13.3, -15.299999999999974, -11.3, -13.099999999999998, -10.3, -24.800000000000004, -10.8, -3.2, -12.999999999999998, -6.3, -12.2, -13.999999999999996, -16.89999999999999, -9.5, -11.7, -9.199999999999996, -5.4, -17.4, -12.2, -16.299999999999997, -17.6, -18.799999999999997, -9.799999999999999, -7.8999999999999995, -15.599999999999998, -2.3, -11.0, -3.3, -8.599999999999998, -3.8000000000000007, -17.199999999999992, -2.3, -19.600000000000005, -10.5, -4.2, -5.2, -7.399999999999999, -8.4, -5.300000000000001, -11.3, -19.7, -8.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9180058768572983, "mean_inference_ms": 1.1805152013596478, "mean_action_processing_ms": 0.06498248099149066, "mean_env_wait_ms": 5.401472953873806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1108000, "timesteps_this_iter": 0, "agent_timesteps_total": 1108000, "timers": {"sample_time_ms": 14202.897, "sample_throughput": 281.633, "load_time_ms": 0.339, "load_throughput": 11810782.119, "learn_time_ms": 6633.304, "learn_throughput": 603.018, "update_time_ms": 1.446}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.0930696426004532, "policy_loss": -0.0031699933562307587, "vf_loss": 9.623151240425726, "vf_explained_var": 0.16540225898065875, "kl": 0.011544631598995127, "entropy": 0.2787691580031508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1108000, "num_agent_steps_sampled": 1108000, "num_steps_trained": 1108000, "num_agent_steps_trained": 1108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11080, "training_iteration": 277, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-50-32", "timestamp": 1643669432, "time_this_iter_s": 14.654076099395752, "time_total_s": 4103.974655628204, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4103.974655628204, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 21.995238095238097, "ram_util_percent": 72.4952380952381}}
{"episode_reward_max": -2.3, "episode_reward_min": -33.2, "episode_reward_mean": -10.925, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -8.200000000000001, -7.699999999999999, -8.8, -9.2, -12.399999999999999, -6.199999999999999, -33.2, -6.3, -4.0, -22.500000000000014, -4.5, -13.2, -4.2, -12.5, -4.300000000000001, -5.3, -12.2, -13.3, -15.299999999999974, -11.3, -13.099999999999998, -10.3, -24.800000000000004, -10.8, -3.2, -12.999999999999998, -6.3, -12.2, -13.999999999999996, -16.89999999999999, -9.5, -11.7, -9.199999999999996, -5.4, -17.4, -12.2, -16.299999999999997, -17.6, -18.799999999999997, -9.799999999999999, -7.8999999999999995, -15.599999999999998, -2.3, -11.0, -3.3, -8.599999999999998, -3.8000000000000007, -17.199999999999992, -2.3, -19.600000000000005, -10.5, -4.2, -5.2, -7.399999999999999, -8.4, -5.300000000000001, -11.3, -19.7, -8.2, -6.300000000000001, -20.499999999999996, -3.2, -12.399999999999993, -13.9, -15.7, -7.7, -4.4, -17.799999999999997, -5.6, -10.599999999999998, -18.3, -18.5, -9.799999999999999, -19.200000000000003, -14.199999999999996, -4.700000000000001, -17.3, -10.3, -3.3, -7.600000000000001, -11.4, -28.2, -10.5, -14.6, -4.2, -4.4, -10.3, -9.1, -3.2, -13.399999999999995, -5.1, -8.3, -20.100000000000005, -22.3, -3.2, -12.899999999999999, -13.799999999999999, -10.599999999999998, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9179222278926423, "mean_inference_ms": 1.1803695224298096, "mean_action_processing_ms": 0.0649771326659371, "mean_env_wait_ms": 5.400821123689843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1112000, "timesteps_this_iter": 0, "agent_timesteps_total": 1112000, "timers": {"sample_time_ms": 14252.969, "sample_throughput": 280.643, "load_time_ms": 0.338, "load_throughput": 11835778.483, "learn_time_ms": 6622.868, "learn_throughput": 603.968, "update_time_ms": 1.439}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.10016350942032952, "policy_loss": -0.009988747191645445, "vf_loss": 11.014366642249527, "vf_explained_var": 0.1941170940476079, "kl": 0.012207395022494903, "entropy": 0.22369807321698434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1112000, "num_agent_steps_sampled": 1112000, "num_steps_trained": 1112000, "num_agent_steps_trained": 1112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11120, "training_iteration": 278, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-50-46", "timestamp": 1643669446, "time_this_iter_s": 14.23914384841919, "time_total_s": 4118.2137994766235, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4118.2137994766235, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 19.890000000000004, "ram_util_percent": 72.45500000000001}}
{"episode_reward_max": -2.3, "episode_reward_min": -41.100000000000065, "episode_reward_mean": -10.764000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999999, -7.8999999999999995, -15.599999999999998, -2.3, -11.0, -3.3, -8.599999999999998, -3.8000000000000007, -17.199999999999992, -2.3, -19.600000000000005, -10.5, -4.2, -5.2, -7.399999999999999, -8.4, -5.300000000000001, -11.3, -19.7, -8.2, -6.300000000000001, -20.499999999999996, -3.2, -12.399999999999993, -13.9, -15.7, -7.7, -4.4, -17.799999999999997, -5.6, -10.599999999999998, -18.3, -18.5, -9.799999999999999, -19.200000000000003, -14.199999999999996, -4.700000000000001, -17.3, -10.3, -3.3, -7.600000000000001, -11.4, -28.2, -10.5, -14.6, -4.2, -4.4, -10.3, -9.1, -3.2, -13.399999999999995, -5.1, -8.3, -20.100000000000005, -22.3, -3.2, -12.899999999999999, -13.799999999999999, -10.599999999999998, -3.2, -19.0, -24.1, -4.2, -7.399999999999999, -21.900000000000006, -8.399999999999999, -4.800000000000001, -14.499999999999998, -22.3, -12.100000000000001, -7.800000000000001, -41.100000000000065, -6.300000000000001, -18.0, -3.3, -5.3, -22.8, -13.0, -15.0, -11.2, -3.3, -6.300000000000001, -7.6000000000000005, -2.3, -10.1, -10.099999999999998, -15.799999999999997, -3.2, -3.2, -13.2, -3.4, -13.2, -17.5, -3.3, -5.300000000000001, -13.3, -8.2, -8.600000000000001, -5.300000000000001, -9.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9178260352653441, "mean_inference_ms": 1.1802045292246301, "mean_action_processing_ms": 0.06497024292714966, "mean_env_wait_ms": 5.400213465203775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1116000, "timesteps_this_iter": 0, "agent_timesteps_total": 1116000, "timers": {"sample_time_ms": 14244.62, "sample_throughput": 280.808, "load_time_ms": 0.343, "load_throughput": 11661372.072, "learn_time_ms": 6621.626, "learn_throughput": 604.081, "update_time_ms": 1.432}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.13628306252711642, "policy_loss": -0.008722846848409503, "vf_loss": 14.500034195633345, "vf_explained_var": 0.27024691790662786, "kl": 0.007918482834445031, "entropy": 0.2030975140951654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1116000, "num_agent_steps_sampled": 1116000, "num_steps_trained": 1116000, "num_agent_steps_trained": 1116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11160, "training_iteration": 279, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-51-00", "timestamp": 1643669460, "time_this_iter_s": 14.209243774414062, "time_total_s": 4132.423043251038, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4132.423043251038, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 21.669999999999995, "ram_util_percent": 72.5}}
{"episode_reward_max": -2.3, "episode_reward_min": -114.90000000000013, "episode_reward_mean": -12.423000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.600000000000001, -11.4, -28.2, -10.5, -14.6, -4.2, -4.4, -10.3, -9.1, -3.2, -13.399999999999995, -5.1, -8.3, -20.100000000000005, -22.3, -3.2, -12.899999999999999, -13.799999999999999, -10.599999999999998, -3.2, -19.0, -24.1, -4.2, -7.399999999999999, -21.900000000000006, -8.399999999999999, -4.800000000000001, -14.499999999999998, -22.3, -12.100000000000001, -7.800000000000001, -41.100000000000065, -6.300000000000001, -18.0, -3.3, -5.3, -22.8, -13.0, -15.0, -11.2, -3.3, -6.300000000000001, -7.6000000000000005, -2.3, -10.1, -10.099999999999998, -15.799999999999997, -3.2, -3.2, -13.2, -3.4, -13.2, -17.5, -3.3, -5.300000000000001, -13.3, -8.2, -8.600000000000001, -5.300000000000001, -9.0, -14.4, -4.2, -11.4, -9.200000000000001, -9.5, -11.2, -12.699999999999996, -20.6, -23.5, -14.5, -9.3, -12.2, -7.2, -20.20000000000005, -4.300000000000001, -7.300000000000001, -8.3, -14.499999999999998, -9.6, -114.90000000000013, -13.399999999999999, -7.5, -12.3, -7.3, -4.3, -17.6, -14.899999999999999, -17.5, -13.4, -3.3, -6.2, -30.799999999999997, -6.1, -27.200000000000017, -6.4, -13.1, -17.3, -16.1, -3.2, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9176101756030149, "mean_inference_ms": 1.1799981348365987, "mean_action_processing_ms": 0.06496101520342372, "mean_env_wait_ms": 5.399397576172005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1120000, "timesteps_this_iter": 0, "agent_timesteps_total": 1120000, "timers": {"sample_time_ms": 14244.331, "sample_throughput": 280.813, "load_time_ms": 0.342, "load_throughput": 11706940.2, "learn_time_ms": 6596.3, "learn_throughput": 606.401, "update_time_ms": 1.451}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.5285494979811451, "policy_loss": -0.017820532039629036, "vf_loss": 54.63560146394596, "vf_explained_var": 0.11333928890125726, "kl": 0.019925166853059624, "entropy": 0.2598762201766173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1120000, "num_agent_steps_sampled": 1120000, "num_steps_trained": 1120000, "num_agent_steps_trained": 1120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11200, "training_iteration": 280, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-51-14", "timestamp": 1643669474, "time_this_iter_s": 13.826313257217407, "time_total_s": 4146.249356508255, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4146.249356508255, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 20.431578947368422, "ram_util_percent": 72.5}}
{"episode_reward_max": -2.3, "episode_reward_min": -114.90000000000013, "episode_reward_mean": -12.004000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -6.300000000000001, -7.6000000000000005, -2.3, -10.1, -10.099999999999998, -15.799999999999997, -3.2, -3.2, -13.2, -3.4, -13.2, -17.5, -3.3, -5.300000000000001, -13.3, -8.2, -8.600000000000001, -5.300000000000001, -9.0, -14.4, -4.2, -11.4, -9.200000000000001, -9.5, -11.2, -12.699999999999996, -20.6, -23.5, -14.5, -9.3, -12.2, -7.2, -20.20000000000005, -4.300000000000001, -7.300000000000001, -8.3, -14.499999999999998, -9.6, -114.90000000000013, -13.399999999999999, -7.5, -12.3, -7.3, -4.3, -17.6, -14.899999999999999, -17.5, -13.4, -3.3, -6.2, -30.799999999999997, -6.1, -27.200000000000017, -6.4, -13.1, -17.3, -16.1, -3.2, -4.3, -40.3, -4.800000000000001, -7.8, -9.600000000000001, -17.700000000000003, -6.300000000000001, -6.899999999999999, -8.3, -3.3, -13.699999999999998, -14.0, -13.2, -4.4, -11.4, -3.2, -7.2, -3.2, -3.3, -3.3, -11.8, -3.4, -15.499999999999996, -4.2, -13.299999999999999, -12.799999999999997, -27.999999999999993, -20.799999999999997, -13.5, -13.299999999999997, -12.5, -6.3, -4.2, -16.299999999999997, -3.2, -17.6, -7.5, -6.2, -43.1, -18.4, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9174511087798853, "mean_inference_ms": 1.179812913719417, "mean_action_processing_ms": 0.06495288102976934, "mean_env_wait_ms": 5.398722302125554, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1124000, "timesteps_this_iter": 0, "agent_timesteps_total": 1124000, "timers": {"sample_time_ms": 14234.086, "sample_throughput": 281.016, "load_time_ms": 0.339, "load_throughput": 11810782.119, "learn_time_ms": 6604.466, "learn_throughput": 605.651, "update_time_ms": 1.465}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.15034363869757902, "policy_loss": -0.01954651486769479, "vf_loss": 16.988021269344515, "vf_explained_var": 0.22681654281513666, "kl": 0.014131366098110476, "entropy": 0.23411814673373135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1124000, "num_agent_steps_sampled": 1124000, "num_steps_trained": 1124000, "num_agent_steps_trained": 1124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11240, "training_iteration": 281, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-51-28", "timestamp": 1643669488, "time_this_iter_s": 14.306403875350952, "time_total_s": 4160.555760383606, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4160.555760383606, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 21.242857142857147, "ram_util_percent": 72.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -164.3, "episode_reward_mean": -14.649000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.399999999999999, -7.5, -12.3, -7.3, -4.3, -17.6, -14.899999999999999, -17.5, -13.4, -3.3, -6.2, -30.799999999999997, -6.1, -27.200000000000017, -6.4, -13.1, -17.3, -16.1, -3.2, -4.3, -40.3, -4.800000000000001, -7.8, -9.600000000000001, -17.700000000000003, -6.300000000000001, -6.899999999999999, -8.3, -3.3, -13.699999999999998, -14.0, -13.2, -4.4, -11.4, -3.2, -7.2, -3.2, -3.3, -3.3, -11.8, -3.4, -15.499999999999996, -4.2, -13.299999999999999, -12.799999999999997, -27.999999999999993, -20.799999999999997, -13.5, -13.299999999999997, -12.5, -6.3, -4.2, -16.299999999999997, -3.2, -17.6, -7.5, -6.2, -43.1, -18.4, -3.2, -11.199999999999994, -4.2, -71.5, -7.3, -5.300000000000001, -3.3, -17.2, -10.0, -6.299999999999995, -6.699999999999999, -21.800000000000004, -4.300000000000001, -9.899999999999999, -3.2, -6.300000000000001, -10.299999999999999, -11.799999999999999, -8.599999999999998, -7.300000000000001, -9.999999999999996, -17.799999999999983, -4.300000000000001, -5.2, -4.2, -23.9, -13.9, -40.4, -16.2, -11.499999999999995, -13.600000000000001, -31.2, -164.3, -14.2, -10.5, -15.299999999999986, -15.799999999999997, -24.5, -17.400000000000006, -6.2, -78.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9173566169351693, "mean_inference_ms": 1.1796353312184025, "mean_action_processing_ms": 0.06494583940766185, "mean_env_wait_ms": 5.397989826491792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1128000, "timesteps_this_iter": 0, "agent_timesteps_total": 1128000, "timers": {"sample_time_ms": 14250.746, "sample_throughput": 280.687, "load_time_ms": 0.347, "load_throughput": 11518857.535, "learn_time_ms": 6630.945, "learn_throughput": 603.232, "update_time_ms": 1.443}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 1.4940273251770044, "policy_loss": -0.01771044905888297, "vf_loss": 151.17289189305356, "vf_explained_var": -0.23098622964274498, "kl": 0.012613094892067465, "entropy": 0.22665487734941386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1128000, "num_agent_steps_sampled": 1128000, "num_steps_trained": 1128000, "num_agent_steps_trained": 1128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11280, "training_iteration": 282, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-51-43", "timestamp": 1643669503, "time_this_iter_s": 14.539642095565796, "time_total_s": 4175.095402479172, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4175.095402479172, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 22.055, "ram_util_percent": 72.50999999999999}}
{"episode_reward_max": -2.2, "episode_reward_min": -164.3, "episode_reward_mean": -14.333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -15.499999999999996, -4.2, -13.299999999999999, -12.799999999999997, -27.999999999999993, -20.799999999999997, -13.5, -13.299999999999997, -12.5, -6.3, -4.2, -16.299999999999997, -3.2, -17.6, -7.5, -6.2, -43.1, -18.4, -3.2, -11.199999999999994, -4.2, -71.5, -7.3, -5.300000000000001, -3.3, -17.2, -10.0, -6.299999999999995, -6.699999999999999, -21.800000000000004, -4.300000000000001, -9.899999999999999, -3.2, -6.300000000000001, -10.299999999999999, -11.799999999999999, -8.599999999999998, -7.300000000000001, -9.999999999999996, -17.799999999999983, -4.300000000000001, -5.2, -4.2, -23.9, -13.9, -40.4, -16.2, -11.499999999999995, -13.600000000000001, -31.2, -164.3, -14.2, -10.5, -15.299999999999986, -15.799999999999997, -24.5, -17.400000000000006, -6.2, -78.8, -3.2, -15.2, -4.2, -11.8, -4.2, -13.999999999999996, -10.799999999999999, -3.2, -8.2, -9.999999999999998, -9.000000000000002, -8.3, -2.2, -9.2, -19.2, -3.2, -25.10000000000007, -10.3, -20.599999999999987, -17.799999999999997, -3.3, -34.4, -19.600000000000005, -5.2, -3.3, -6.2, -3.2, -4.300000000000001, -11.3, -4.4, -15.799999999999999, -14.7, -13.4, -5.1, -12.2, -8.2, -4.300000000000001, -12.7, -3.2, -9.799999999999981], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9172563402811401, "mean_inference_ms": 1.1794266829753068, "mean_action_processing_ms": 0.0649373116653548, "mean_env_wait_ms": 5.397166837434874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1132000, "timesteps_this_iter": 0, "agent_timesteps_total": 1132000, "timers": {"sample_time_ms": 14246.179, "sample_throughput": 280.777, "load_time_ms": 0.344, "load_throughput": 11614548.979, "learn_time_ms": 6606.365, "learn_throughput": 605.477, "update_time_ms": 1.472}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.1069933844324682, "policy_loss": -0.009872010977117604, "vf_loss": 11.685367170264644, "vf_explained_var": 0.06606832403008656, "kl": 0.01665651771894847, "entropy": 0.23465168327093125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1132000, "num_agent_steps_sampled": 1132000, "num_steps_trained": 1132000, "num_agent_steps_trained": 1132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11320, "training_iteration": 283, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-51-57", "timestamp": 1643669517, "time_this_iter_s": 13.702090978622437, "time_total_s": 4188.797493457794, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4188.797493457794, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 20.110000000000003, "ram_util_percent": 72.5}}
{"episode_reward_max": -2.2, "episode_reward_min": -164.3, "episode_reward_mean": -13.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.799999999999983, -4.300000000000001, -5.2, -4.2, -23.9, -13.9, -40.4, -16.2, -11.499999999999995, -13.600000000000001, -31.2, -164.3, -14.2, -10.5, -15.299999999999986, -15.799999999999997, -24.5, -17.400000000000006, -6.2, -78.8, -3.2, -15.2, -4.2, -11.8, -4.2, -13.999999999999996, -10.799999999999999, -3.2, -8.2, -9.999999999999998, -9.000000000000002, -8.3, -2.2, -9.2, -19.2, -3.2, -25.10000000000007, -10.3, -20.599999999999987, -17.799999999999997, -3.3, -34.4, -19.600000000000005, -5.2, -3.3, -6.2, -3.2, -4.300000000000001, -11.3, -4.4, -15.799999999999999, -14.7, -13.4, -5.1, -12.2, -8.2, -4.300000000000001, -12.7, -3.2, -9.799999999999981, -5.3, -6.300000000000001, -9.999999999999998, -5.3, -6.2, -3.4, -4.2, -5.2, -5.2, -5.2, -23.200000000000035, -6.2, -5.9, -11.899999999999999, -4.2, -6.3, -37.5, -3.2, -10.899999999999977, -4.2, -2.4000000000000004, -13.799999999999997, -14.399999999999999, -8.8, -15.499999999999996, -16.2, -8.3, -24.60000000000001, -8.3, -3.3, -7.3, -3.6000000000000005, -26.800000000000008, -5.2, -6.2, -10.2, -10.2, -17.5, -17.599999999999994, -11.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.917120615045435, "mean_inference_ms": 1.1792040848577126, "mean_action_processing_ms": 0.06492807059842001, "mean_env_wait_ms": 5.396288462183553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1136000, "timesteps_this_iter": 0, "agent_timesteps_total": 1136000, "timers": {"sample_time_ms": 14227.37, "sample_throughput": 281.148, "load_time_ms": 0.343, "load_throughput": 11666237.397, "learn_time_ms": 6598.846, "learn_throughput": 606.167, "update_time_ms": 1.485}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.13657996309420434, "policy_loss": -0.011995319056735244, "vf_loss": 14.856902490315898, "vf_explained_var": 0.20637478822021074, "kl": 0.00889556685806903, "entropy": 0.20949134729321925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1136000, "num_agent_steps_sampled": 1136000, "num_steps_trained": 1136000, "num_agent_steps_trained": 1136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11360, "training_iteration": 284, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-52-11", "timestamp": 1643669531, "time_this_iter_s": 13.956569194793701, "time_total_s": 4202.754062652588, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4202.754062652588, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 27.294736842105266, "ram_util_percent": 72.56842105263156}}
{"episode_reward_max": -1.5000000000000002, "episode_reward_min": -91.2, "episode_reward_mean": -11.224, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -34.4, -19.600000000000005, -5.2, -3.3, -6.2, -3.2, -4.300000000000001, -11.3, -4.4, -15.799999999999999, -14.7, -13.4, -5.1, -12.2, -8.2, -4.300000000000001, -12.7, -3.2, -9.799999999999981, -5.3, -6.300000000000001, -9.999999999999998, -5.3, -6.2, -3.4, -4.2, -5.2, -5.2, -5.2, -23.200000000000035, -6.2, -5.9, -11.899999999999999, -4.2, -6.3, -37.5, -3.2, -10.899999999999977, -4.2, -2.4000000000000004, -13.799999999999997, -14.399999999999999, -8.8, -15.499999999999996, -16.2, -8.3, -24.60000000000001, -8.3, -3.3, -7.3, -3.6000000000000005, -26.800000000000008, -5.2, -6.2, -10.2, -10.2, -17.5, -17.599999999999994, -11.5, -21.4, -3.2, -15.2, -72.6, -10.199999999999998, -16.2, -5.0, -8.3, -1.5000000000000002, -4.300000000000001, -15.0, -91.2, -4.300000000000001, -20.199999999999996, -11.399999999999999, -4.700000000000001, -11.899999999999999, -5.3, -14.3, -7.2, -4.3, -29.800000000000047, -6.3, -15.699999999999996, -4.2, -8.7, -8.2, -6.300000000000001, -5.8999999999999995, -12.2, -7.3, -23.9, -11.1, -12.199999999999998, -3.1, -3.2, -2.5, -4.2, -9.6, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9170138482928718, "mean_inference_ms": 1.1789889475340112, "mean_action_processing_ms": 0.06491925239560203, "mean_env_wait_ms": 5.395474256857995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1140000, "timesteps_this_iter": 0, "agent_timesteps_total": 1140000, "timers": {"sample_time_ms": 14178.62, "sample_throughput": 282.115, "load_time_ms": 0.341, "load_throughput": 11733139.38, "learn_time_ms": 6596.827, "learn_throughput": 606.352, "update_time_ms": 1.474}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.6668064160122266, "policy_loss": -0.011454484303311635, "vf_loss": 67.82541402956491, "vf_explained_var": -0.1315189637804544, "kl": 0.009628186939963786, "entropy": 0.23442801137765248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1140000, "num_agent_steps_sampled": 1140000, "num_steps_trained": 1140000, "num_agent_steps_trained": 1140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11400, "training_iteration": 285, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-52-25", "timestamp": 1643669545, "time_this_iter_s": 14.009216070175171, "time_total_s": 4216.763278722763, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4216.763278722763, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 28.23999999999999, "ram_util_percent": 72.54}}
{"episode_reward_max": -1.5000000000000002, "episode_reward_min": -91.2, "episode_reward_mean": -11.847999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.4000000000000004, -13.799999999999997, -14.399999999999999, -8.8, -15.499999999999996, -16.2, -8.3, -24.60000000000001, -8.3, -3.3, -7.3, -3.6000000000000005, -26.800000000000008, -5.2, -6.2, -10.2, -10.2, -17.5, -17.599999999999994, -11.5, -21.4, -3.2, -15.2, -72.6, -10.199999999999998, -16.2, -5.0, -8.3, -1.5000000000000002, -4.300000000000001, -15.0, -91.2, -4.300000000000001, -20.199999999999996, -11.399999999999999, -4.700000000000001, -11.899999999999999, -5.3, -14.3, -7.2, -4.3, -29.800000000000047, -6.3, -15.699999999999996, -4.2, -8.7, -8.2, -6.300000000000001, -5.8999999999999995, -12.2, -7.3, -23.9, -11.1, -12.199999999999998, -3.1, -3.2, -2.5, -4.2, -9.6, -4.2, -3.8000000000000003, -16.79999999999999, -16.099999999999994, -12.3, -7.7, -4.4, -3.2, -21.6, -9.799999999999997, -7.7, -34.2, -3.2, -14.9, -14.099999999999998, -13.600000000000001, -4.800000000000001, -6.399999999999999, -17.3, -3.3, -3.3, -5.2, -11.999999999999998, -15.3, -11.199999999999998, -21.7, -7.3, -12.3, -14.799999999999997, -19.000000000000004, -3.2, -3.3, -3.4, -11.7, -2.9000000000000004, -4.300000000000001, -3.2, -3.4, -25.30000000000002, -15.700000000000001, -13.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9170149627898483, "mean_inference_ms": 1.1787846316294166, "mean_action_processing_ms": 0.06491079591775571, "mean_env_wait_ms": 5.394626828321784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1144000, "timesteps_this_iter": 0, "agent_timesteps_total": 1144000, "timers": {"sample_time_ms": 14183.747, "sample_throughput": 282.013, "load_time_ms": 0.337, "load_throughput": 11871791.678, "learn_time_ms": 6570.16, "learn_throughput": 608.813, "update_time_ms": 1.44}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.10516256106922263, "policy_loss": -0.015293241404898225, "vf_loss": 12.044499527895322, "vf_explained_var": 0.184038467625136, "kl": 0.015359478660295384, "entropy": 0.229426354125783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1144000, "num_agent_steps_sampled": 1144000, "num_steps_trained": 1144000, "num_agent_steps_trained": 1144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11440, "training_iteration": 286, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-52-39", "timestamp": 1643669559, "time_this_iter_s": 13.96992802619934, "time_total_s": 4230.733206748962, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4230.733206748962, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 28.904999999999994, "ram_util_percent": 72.5}}
{"episode_reward_max": -2.5, "episode_reward_min": -34.2, "episode_reward_mean": -9.806, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -29.800000000000047, -6.3, -15.699999999999996, -4.2, -8.7, -8.2, -6.300000000000001, -5.8999999999999995, -12.2, -7.3, -23.9, -11.1, -12.199999999999998, -3.1, -3.2, -2.5, -4.2, -9.6, -4.2, -3.8000000000000003, -16.79999999999999, -16.099999999999994, -12.3, -7.7, -4.4, -3.2, -21.6, -9.799999999999997, -7.7, -34.2, -3.2, -14.9, -14.099999999999998, -13.600000000000001, -4.800000000000001, -6.399999999999999, -17.3, -3.3, -3.3, -5.2, -11.999999999999998, -15.3, -11.199999999999998, -21.7, -7.3, -12.3, -14.799999999999997, -19.000000000000004, -3.2, -3.3, -3.4, -11.7, -2.9000000000000004, -4.300000000000001, -3.2, -3.4, -25.30000000000002, -15.700000000000001, -13.1, -7.3999999999999995, -11.5, -12.699999999999998, -3.2, -6.1, -15.399999999999999, -30.700000000000014, -4.300000000000001, -13.5, -3.1, -3.4, -10.3, -3.2, -3.4, -3.3, -24.69999999999999, -16.9, -4.300000000000001, -22.4, -5.2, -8.3, -3.4, -11.199999999999996, -20.5, -3.2, -4.3, -3.3, -13.7, -12.699999999999998, -9.7, -4.2, -4.2, -3.3, -3.3, -8.8, -9.0, -3.2, -9.3, -14.399999999999999, -15.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9169306685084558, "mean_inference_ms": 1.1785614777672258, "mean_action_processing_ms": 0.06490089107949133, "mean_env_wait_ms": 5.3937726895843126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1148000, "timesteps_this_iter": 0, "agent_timesteps_total": 1148000, "timers": {"sample_time_ms": 14134.28, "sample_throughput": 283.0, "load_time_ms": 0.332, "load_throughput": 12051731.916, "learn_time_ms": 6532.728, "learn_throughput": 612.302, "update_time_ms": 1.45}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.06854990778080318, "policy_loss": -0.00908138243761915, "vf_loss": 7.76257049374042, "vf_explained_var": 0.4049930664159918, "kl": 0.007935154721274276, "entropy": 0.17525382335548118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1148000, "num_agent_steps_sampled": 1148000, "num_steps_trained": 1148000, "num_agent_steps_trained": 1148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11480, "training_iteration": 287, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-52-53", "timestamp": 1643669573, "time_this_iter_s": 14.054238080978394, "time_total_s": 4244.787444829941, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4244.787444829941, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 29.545000000000005, "ram_util_percent": 72.58999999999999}}
{"episode_reward_max": -2.9000000000000004, "episode_reward_min": -54.3, "episode_reward_mean": -11.336999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -11.999999999999998, -15.3, -11.199999999999998, -21.7, -7.3, -12.3, -14.799999999999997, -19.000000000000004, -3.2, -3.3, -3.4, -11.7, -2.9000000000000004, -4.300000000000001, -3.2, -3.4, -25.30000000000002, -15.700000000000001, -13.1, -7.3999999999999995, -11.5, -12.699999999999998, -3.2, -6.1, -15.399999999999999, -30.700000000000014, -4.300000000000001, -13.5, -3.1, -3.4, -10.3, -3.2, -3.4, -3.3, -24.69999999999999, -16.9, -4.300000000000001, -22.4, -5.2, -8.3, -3.4, -11.199999999999996, -20.5, -3.2, -4.3, -3.3, -13.7, -12.699999999999998, -9.7, -4.2, -4.2, -3.3, -3.3, -8.8, -9.0, -3.2, -9.3, -14.399999999999999, -15.899999999999999, -3.4, -26.099999999999994, -15.2, -19.6, -28.600000000000005, -4.3, -19.400000000000006, -27.2, -13.3, -3.3, -3.4, -15.8, -24.1, -16.4, -8.2, -10.499999999999998, -3.5000000000000004, -19.699999999999996, -16.0, -54.3, -3.3, -19.6, -12.999999999999998, -8.5, -25.000000000000007, -19.800000000000008, -11.3, -21.4, -3.3, -4.3, -7.299999999999998, -25.200000000000003, -5.3, -6.399999999999999, -9.1, -4.300000000000001, -3.4, -7.3, -6.300000000000001, -18.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9168823495278652, "mean_inference_ms": 1.1784374719673363, "mean_action_processing_ms": 0.06489354658088083, "mean_env_wait_ms": 5.3933540780123055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1152000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 14125.146, "sample_throughput": 283.183, "load_time_ms": 0.33, "load_throughput": 12117888.046, "learn_time_ms": 6529.889, "learn_throughput": 612.568, "update_time_ms": 1.426}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.2664011847272876, "policy_loss": -0.010061195135236747, "vf_loss": 27.645253019563615, "vf_explained_var": 0.13138166384030414, "kl": 0.014006183730614285, "entropy": 0.24991375191878246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1152000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 1152000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11520, "training_iteration": 288, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-53-07", "timestamp": 1643669587, "time_this_iter_s": 14.49426794052124, "time_total_s": 4259.281712770462, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4259.281712770462, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 33.325, "ram_util_percent": 72.67000000000002}}
{"episode_reward_max": -3.2, "episode_reward_min": -56.40000000000002, "episode_reward_mean": -12.561999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -3.4, -11.199999999999996, -20.5, -3.2, -4.3, -3.3, -13.7, -12.699999999999998, -9.7, -4.2, -4.2, -3.3, -3.3, -8.8, -9.0, -3.2, -9.3, -14.399999999999999, -15.899999999999999, -3.4, -26.099999999999994, -15.2, -19.6, -28.600000000000005, -4.3, -19.400000000000006, -27.2, -13.3, -3.3, -3.4, -15.8, -24.1, -16.4, -8.2, -10.499999999999998, -3.5000000000000004, -19.699999999999996, -16.0, -54.3, -3.3, -19.6, -12.999999999999998, -8.5, -25.000000000000007, -19.800000000000008, -11.3, -21.4, -3.3, -4.3, -7.299999999999998, -25.200000000000003, -5.3, -6.399999999999999, -9.1, -4.300000000000001, -3.4, -7.3, -6.300000000000001, -18.099999999999998, -26.099999999999994, -3.5000000000000004, -8.899999999999999, -4.4, -11.199999999999976, -24.2, -14.2, -16.39999999999998, -16.7, -12.999999999999998, -18.699999999999996, -30.400000000000013, -3.2, -16.199999999999996, -15.399999999999999, -12.699999999999998, -17.099999999999998, -11.099999999999996, -4.9, -4.300000000000001, -15.899999999999993, -17.799999999999997, -6.2, -20.1, -13.9, -13.799999999999997, -4.4, -56.40000000000002, -3.900000000000001, -11.899999999999993, -4.9, -32.10000000000004, -12.799999999999999, -7.4, -5.300000000000001, -3.4, -10.3, -13.7, -4.300000000000001, -4.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9168107749196591, "mean_inference_ms": 1.178367326468408, "mean_action_processing_ms": 0.06488976580350178, "mean_env_wait_ms": 5.3931556736836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1156000, "timesteps_this_iter": 0, "agent_timesteps_total": 1156000, "timers": {"sample_time_ms": 14132.756, "sample_throughput": 283.03, "load_time_ms": 0.329, "load_throughput": 12145961.051, "learn_time_ms": 6561.587, "learn_throughput": 609.609, "update_time_ms": 1.437}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.20137038718162967, "policy_loss": -0.007940066267325673, "vf_loss": 20.93022189588957, "vf_explained_var": 0.12133406830090349, "kl": 0.011704415177807752, "entropy": 0.23428573157357913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1156000, "num_agent_steps_sampled": 1156000, "num_steps_trained": 1156000, "num_agent_steps_trained": 1156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11560, "training_iteration": 289, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-53-22", "timestamp": 1643669602, "time_this_iter_s": 14.630248069763184, "time_total_s": 4273.911960840225, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4273.911960840225, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 33.547619047619044, "ram_util_percent": 72.79523809523809}}
{"episode_reward_max": -3.2, "episode_reward_min": -56.40000000000002, "episode_reward_mean": -11.932999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -19.6, -12.999999999999998, -8.5, -25.000000000000007, -19.800000000000008, -11.3, -21.4, -3.3, -4.3, -7.299999999999998, -25.200000000000003, -5.3, -6.399999999999999, -9.1, -4.300000000000001, -3.4, -7.3, -6.300000000000001, -18.099999999999998, -26.099999999999994, -3.5000000000000004, -8.899999999999999, -4.4, -11.199999999999976, -24.2, -14.2, -16.39999999999998, -16.7, -12.999999999999998, -18.699999999999996, -30.400000000000013, -3.2, -16.199999999999996, -15.399999999999999, -12.699999999999998, -17.099999999999998, -11.099999999999996, -4.9, -4.300000000000001, -15.899999999999993, -17.799999999999997, -6.2, -20.1, -13.9, -13.799999999999997, -4.4, -56.40000000000002, -3.900000000000001, -11.899999999999993, -4.9, -32.10000000000004, -12.799999999999999, -7.4, -5.300000000000001, -3.4, -10.3, -13.7, -4.300000000000001, -4.700000000000001, -11.5, -8.4, -5.4, -8.3, -4.300000000000001, -4.300000000000001, -11.199999999999976, -22.4, -17.6, -7.300000000000001, -8.2, -5.2, -10.2, -15.2, -3.2, -3.4, -15.3, -8.6, -12.799999999999997, -21.200000000000028, -11.599999999999998, -3.3, -9.5, -11.299999999999999, -6.2, -21.6, -12.099999999999996, -5.4, -3.3, -21.6, -24.500000000000018, -25.4, -17.9, -7.499999999999999, -12.899999999999999, -15.799999999999995, -9.299999999999999, -4.2, -3.6000000000000005, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9167774756093994, "mean_inference_ms": 1.178325123366667, "mean_action_processing_ms": 0.06488787127589779, "mean_env_wait_ms": 5.3929589619313685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1160000, "timesteps_this_iter": 0, "agent_timesteps_total": 1160000, "timers": {"sample_time_ms": 14201.342, "sample_throughput": 281.664, "load_time_ms": 0.345, "load_throughput": 11586475.138, "learn_time_ms": 6633.561, "learn_throughput": 602.994, "update_time_ms": 1.433}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.11463430466165425, "policy_loss": 0.0029727038797191393, "vf_loss": 11.165025923329015, "vf_explained_var": 0.1472332655101694, "kl": 0.016114052268970155, "entropy": 0.23626381276996547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1160000, "num_agent_steps_sampled": 1160000, "num_steps_trained": 1160000, "num_agent_steps_trained": 1160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11600, "training_iteration": 290, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_22-53-37", "timestamp": 1643669617, "time_this_iter_s": 14.905174016952515, "time_total_s": 4288.817134857178, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4288.817134857178, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 34.29523809523809, "ram_util_percent": 72.90952380952382}}
{"episode_reward_max": -3.2, "episode_reward_min": -60.40000000000008, "episode_reward_mean": -12.975000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.899999999999993, -17.799999999999997, -6.2, -20.1, -13.9, -13.799999999999997, -4.4, -56.40000000000002, -3.900000000000001, -11.899999999999993, -4.9, -32.10000000000004, -12.799999999999999, -7.4, -5.300000000000001, -3.4, -10.3, -13.7, -4.300000000000001, -4.700000000000001, -11.5, -8.4, -5.4, -8.3, -4.300000000000001, -4.300000000000001, -11.199999999999976, -22.4, -17.6, -7.300000000000001, -8.2, -5.2, -10.2, -15.2, -3.2, -3.4, -15.3, -8.6, -12.799999999999997, -21.200000000000028, -11.599999999999998, -3.3, -9.5, -11.299999999999999, -6.2, -21.6, -12.099999999999996, -5.4, -3.3, -21.6, -24.500000000000018, -25.4, -17.9, -7.499999999999999, -12.899999999999999, -15.799999999999995, -9.299999999999999, -4.2, -3.6000000000000005, -4.300000000000001, -14.499999999999996, -11.199999999999976, -7.300000000000001, -5.000000000000001, -3.3, -4.3, -12.2, -6.3999999999999995, -19.3, -58.8, -5.2, -4.4, -17.2, -60.40000000000008, -40.2, -5.4, -40.3, -6.0, -22.6, -15.7, -22.999999999999996, -5.2, -7.199999999999999, -4.2, -10.499999999999998, -8.3, -6.199999999999999, -4.300000000000001, -36.5, -5.300000000000001, -12.0, -22.20000000000004, -11.299999999999999, -9.099999999999993, -4.2, -16.699999999999996, -4.2, -27.3, -16.199999999999996, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9182747006285136, "mean_inference_ms": 1.1807234011467616, "mean_action_processing_ms": 0.06500570891747291, "mean_env_wait_ms": 7.912505678229325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1164000, "timesteps_this_iter": 0, "agent_timesteps_total": 1164000, "timers": {"sample_time_ms": 15630.059, "sample_throughput": 255.917, "load_time_ms": 0.358, "load_throughput": 11184810.667, "learn_time_ms": 7352.623, "learn_throughput": 544.024, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.4973996844403045, "policy_loss": -0.011435340545190279, "vf_loss": 50.88225949823215, "vf_explained_var": -0.0823959622972755, "kl": 0.017674428279753403, "entropy": 0.25373480476198657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1164000, "num_agent_steps_sampled": 1164000, "num_steps_trained": 1164000, "num_agent_steps_trained": 1164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11640, "training_iteration": 291, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-24-35", "timestamp": 1643671475, "time_this_iter_s": 1858.057774066925, "time_total_s": 6146.874908924103, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6146.874908924103, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 49.60638297872342, "ram_util_percent": 72.45744680851062}}
{"episode_reward_max": -3.3, "episode_reward_min": -131.6, "episode_reward_mean": -14.782000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.599999999999998, -3.3, -9.5, -11.299999999999999, -6.2, -21.6, -12.099999999999996, -5.4, -3.3, -21.6, -24.500000000000018, -25.4, -17.9, -7.499999999999999, -12.899999999999999, -15.799999999999995, -9.299999999999999, -4.2, -3.6000000000000005, -4.300000000000001, -14.499999999999996, -11.199999999999976, -7.300000000000001, -5.000000000000001, -3.3, -4.3, -12.2, -6.3999999999999995, -19.3, -58.8, -5.2, -4.4, -17.2, -60.40000000000008, -40.2, -5.4, -40.3, -6.0, -22.6, -15.7, -22.999999999999996, -5.2, -7.199999999999999, -4.2, -10.499999999999998, -8.3, -6.199999999999999, -4.300000000000001, -36.5, -5.300000000000001, -12.0, -22.20000000000004, -11.299999999999999, -9.099999999999993, -4.2, -16.699999999999996, -4.2, -27.3, -16.199999999999996, -5.4, -6.3, -131.6, -37.3, -10.699999999999994, -5.300000000000001, -5.2, -16.899999999999995, -14.0, -7.799999999999998, -9.2, -28.500000000000014, -15.599999999999998, -18.30000000000002, -6.2, -3.3, -10.3, -14.2, -16.199999999999974, -11.600000000000001, -13.499999999999991, -5.300000000000001, -38.0, -10.6, -14.599999999999998, -10.599999999999993, -20.700000000000003, -10.499999999999995, -9.899999999999999, -9.399999999999999, -4.4, -9.3, -13.7, -33.4, -14.999999999999996, -8.3, -11.3, -10.899999999999997, -5.300000000000001, -3.4, -21.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9231500556861808, "mean_inference_ms": 1.187899797802401, "mean_action_processing_ms": 0.06538387928942824, "mean_env_wait_ms": 10.449824370281997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1168000, "timesteps_this_iter": 0, "agent_timesteps_total": 1168000, "timers": {"sample_time_ms": 18968.269, "sample_throughput": 210.878, "load_time_ms": 0.447, "load_throughput": 8947848.533, "learn_time_ms": 9499.372, "learn_throughput": 421.08, "update_time_ms": 2.189}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.8953962990229258, "policy_loss": -0.004578670046182089, "vf_loss": 89.99676480934184, "vf_explained_var": -0.11646549419690204, "kl": 0.010433555252841429, "entropy": 0.2483538030456471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1168000, "num_agent_steps_sampled": 1168000, "num_steps_trained": 1168000, "num_agent_steps_trained": 1168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11680, "training_iteration": 292, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-25-37", "timestamp": 1643671537, "time_this_iter_s": 62.156200885772705, "time_total_s": 6209.0311098098755, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6209.0311098098755, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 41.17840909090909, "ram_util_percent": 72.80681818181819}}
{"episode_reward_max": -2.2, "episode_reward_min": -131.6, "episode_reward_mean": -13.200999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.999999999999996, -5.2, -7.199999999999999, -4.2, -10.499999999999998, -8.3, -6.199999999999999, -4.300000000000001, -36.5, -5.300000000000001, -12.0, -22.20000000000004, -11.299999999999999, -9.099999999999993, -4.2, -16.699999999999996, -4.2, -27.3, -16.199999999999996, -5.4, -6.3, -131.6, -37.3, -10.699999999999994, -5.300000000000001, -5.2, -16.899999999999995, -14.0, -7.799999999999998, -9.2, -28.500000000000014, -15.599999999999998, -18.30000000000002, -6.2, -3.3, -10.3, -14.2, -16.199999999999974, -11.600000000000001, -13.499999999999991, -5.300000000000001, -38.0, -10.6, -14.599999999999998, -10.599999999999993, -20.700000000000003, -10.499999999999995, -9.899999999999999, -9.399999999999999, -4.4, -9.3, -13.7, -33.4, -14.999999999999996, -8.3, -11.3, -10.899999999999997, -5.300000000000001, -3.4, -21.3, -12.7, -7.499999999999999, -3.3, -16.5, -15.3, -13.3, -13.5, -12.2, -8.599999999999998, -16.0, -11.7, -7.800000000000001, -4.0, -22.700000000000006, -19.4, -7.0, -9.799999999999999, -6.199999999999999, -4.4, -7.3, -5.300000000000001, -5.3, -22.600000000000016, -15.799999999999999, -10.799999999999999, -2.2, -7.2, -17.2, -21.500000000000004, -11.5, -3.3, -12.1, -10.1, -3.2, -17.1, -14.1, -4.2, -11.3, -14.6, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9315941456389746, "mean_inference_ms": 1.198444535079536, "mean_action_processing_ms": 0.06597357066157944, "mean_env_wait_ms": 11.745898354598715, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1172000, "timesteps_this_iter": 0, "agent_timesteps_total": 1172000, "timers": {"sample_time_ms": 23864.731, "sample_throughput": 167.611, "load_time_ms": 0.557, "load_throughput": 7185103.212, "learn_time_ms": 11685.218, "learn_throughput": 342.313, "update_time_ms": 2.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.10270333165022474, "policy_loss": -0.015125477978939652, "vf_loss": 11.781980931310244, "vf_explained_var": 0.18593050190197524, "kl": 0.012792835764674514, "entropy": 0.2633775682218613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1172000, "num_agent_steps_sampled": 1172000, "num_steps_trained": 1172000, "num_agent_steps_trained": 1172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11720, "training_iteration": 293, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-26-40", "timestamp": 1643671600, "time_this_iter_s": 63.0083167552948, "time_total_s": 6272.03942656517, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6272.03942656517, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 44.09550561797752, "ram_util_percent": 72.71797752808988}}
{"episode_reward_max": -2.2, "episode_reward_min": -38.0, "episode_reward_mean": -11.106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -38.0, -10.6, -14.599999999999998, -10.599999999999993, -20.700000000000003, -10.499999999999995, -9.899999999999999, -9.399999999999999, -4.4, -9.3, -13.7, -33.4, -14.999999999999996, -8.3, -11.3, -10.899999999999997, -5.300000000000001, -3.4, -21.3, -12.7, -7.499999999999999, -3.3, -16.5, -15.3, -13.3, -13.5, -12.2, -8.599999999999998, -16.0, -11.7, -7.800000000000001, -4.0, -22.700000000000006, -19.4, -7.0, -9.799999999999999, -6.199999999999999, -4.4, -7.3, -5.300000000000001, -5.3, -22.600000000000016, -15.799999999999999, -10.799999999999999, -2.2, -7.2, -17.2, -21.500000000000004, -11.5, -3.3, -12.1, -10.1, -3.2, -17.1, -14.1, -4.2, -11.3, -14.6, -4.300000000000001, -8.3, -5.8999999999999995, -19.599999999999998, -14.5, -10.2, -3.900000000000001, -20.3, -6.2, -9.3, -20.5, -15.5, -4.4, -13.999999999999998, -9.3, -4.2, -14.700000000000001, -8.799999999999997, -4.300000000000001, -16.799999999999997, -14.2, -5.8999999999999995, -9.1, -7.300000000000001, -6.300000000000001, -11.999999999999998, -5.2, -12.3, -10.3, -8.099999999999998, -8.2, -6.300000000000001, -12.899999999999997, -15.7, -9.199999999999998, -14.2, -16.39999999999998, -10.499999999999991, -3.2, -8.5, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9408155922478756, "mean_inference_ms": 1.2098606997117898, "mean_action_processing_ms": 0.06661253581420346, "mean_env_wait_ms": 11.7880794619451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1176000, "timesteps_this_iter": 0, "agent_timesteps_total": 1176000, "timers": {"sample_time_ms": 28458.3, "sample_throughput": 140.557, "load_time_ms": 0.652, "load_throughput": 6131799.276, "learn_time_ms": 14021.892, "learn_throughput": 285.268, "update_time_ms": 3.034}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.061034691786413554, "policy_loss": -0.010161153321224515, "vf_loss": 7.118952808200672, "vf_explained_var": 0.3191319545110067, "kl": 0.008977193883676413, "entropy": 0.23728796699514954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1176000, "num_agent_steps_sampled": 1176000, "num_steps_trained": 1176000, "num_agent_steps_trained": 1176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11760, "training_iteration": 294, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-27-42", "timestamp": 1643671662, "time_this_iter_s": 61.35303616523743, "time_total_s": 6333.392462730408, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6333.392462730408, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 49.46781609195401, "ram_util_percent": 72.74137931034481}}
{"episode_reward_max": -2.2, "episode_reward_min": -35.4, "episode_reward_mean": -10.84, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -5.3, -22.600000000000016, -15.799999999999999, -10.799999999999999, -2.2, -7.2, -17.2, -21.500000000000004, -11.5, -3.3, -12.1, -10.1, -3.2, -17.1, -14.1, -4.2, -11.3, -14.6, -4.300000000000001, -8.3, -5.8999999999999995, -19.599999999999998, -14.5, -10.2, -3.900000000000001, -20.3, -6.2, -9.3, -20.5, -15.5, -4.4, -13.999999999999998, -9.3, -4.2, -14.700000000000001, -8.799999999999997, -4.300000000000001, -16.799999999999997, -14.2, -5.8999999999999995, -9.1, -7.300000000000001, -6.300000000000001, -11.999999999999998, -5.2, -12.3, -10.3, -8.099999999999998, -8.2, -6.300000000000001, -12.899999999999997, -15.7, -9.199999999999998, -14.2, -16.39999999999998, -10.499999999999991, -3.2, -8.5, -5.3, -22.500000000000004, -7.2, -16.3, -6.4, -7.4, -6.300000000000001, -15.099999999999994, -11.2, -3.7, -11.2, -12.599999999999998, -5.4, -11.799999999999997, -9.499999999999998, -14.099999999999998, -9.3, -9.2, -5.799999999999999, -6.300000000000001, -14.499999999999998, -7.2, -15.799999999999997, -14.3, -13.399999999999999, -6.4, -16.3, -35.4, -5.8999999999999995, -14.799999999999997, -5.1, -16.4, -7.300000000000001, -8.3, -12.7, -7.4, -11.799999999999999, -7.399999999999999, -13.599999999999998, -25.200000000000003, -8.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.950625742346584, "mean_inference_ms": 1.2221200739190448, "mean_action_processing_ms": 0.06728714562915701, "mean_env_wait_ms": 11.835110135517947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1180000, "timesteps_this_iter": 0, "agent_timesteps_total": 1180000, "timers": {"sample_time_ms": 34064.775, "sample_throughput": 117.423, "load_time_ms": 0.797, "load_throughput": 5020713.431, "learn_time_ms": 16444.443, "learn_throughput": 243.243, "update_time_ms": 3.498}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.08946146512634412, "policy_loss": -0.0038001063850618176, "vf_loss": 9.325454925849874, "vf_explained_var": 0.2927914282967967, "kl": 0.009981845411298646, "entropy": 0.23045260117899988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1180000, "num_agent_steps_sampled": 1180000, "num_steps_trained": 1180000, "num_agent_steps_trained": 1180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11800, "training_iteration": 295, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-28-52", "timestamp": 1643671732, "time_this_iter_s": 70.8875298500061, "time_total_s": 6404.279992580414, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6404.279992580414, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 60.922000000000004, "ram_util_percent": 72.49299999999998}}
{"episode_reward_max": -2.3, "episode_reward_min": -43.4, "episode_reward_mean": -10.965000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.8999999999999995, -9.1, -7.300000000000001, -6.300000000000001, -11.999999999999998, -5.2, -12.3, -10.3, -8.099999999999998, -8.2, -6.300000000000001, -12.899999999999997, -15.7, -9.199999999999998, -14.2, -16.39999999999998, -10.499999999999991, -3.2, -8.5, -5.3, -22.500000000000004, -7.2, -16.3, -6.4, -7.4, -6.300000000000001, -15.099999999999994, -11.2, -3.7, -11.2, -12.599999999999998, -5.4, -11.799999999999997, -9.499999999999998, -14.099999999999998, -9.3, -9.2, -5.799999999999999, -6.300000000000001, -14.499999999999998, -7.2, -15.799999999999997, -14.3, -13.399999999999999, -6.4, -16.3, -35.4, -5.8999999999999995, -14.799999999999997, -5.1, -16.4, -7.300000000000001, -8.3, -12.7, -7.4, -11.799999999999999, -7.399999999999999, -13.599999999999998, -25.200000000000003, -8.0, -10.799999999999999, -13.799999999999999, -6.799999999999998, -20.5, -7.0, -4.9, -6.4, -31.2, -11.599999999999998, -9.2, -7.4, -18.4, -5.300000000000001, -6.300000000000001, -17.2, -6.2, -6.199999999999999, -7.3, -4.3, -7.699999999999999, -4.9, -12.199999999999998, -23.3, -2.3, -11.2, -6.2, -10.499999999999998, -11.499999999999996, -5.4, -20.400000000000002, -6.2, -6.2, -22.899999999999988, -7.2, -12.999999999999996, -5.3, -9.3, -5.4, -43.4, -15.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9603692808855421, "mean_inference_ms": 1.2347352625885286, "mean_action_processing_ms": 0.06798559252561237, "mean_env_wait_ms": 11.884680547040658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1184000, "timesteps_this_iter": 0, "agent_timesteps_total": 1184000, "timers": {"sample_time_ms": 39330.931, "sample_throughput": 101.701, "load_time_ms": 0.894, "load_throughput": 4476431.068, "learn_time_ms": 18951.122, "learn_throughput": 211.069, "update_time_ms": 3.906}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.13692152155262807, "policy_loss": -0.004421662170720357, "vf_loss": 14.133727246330631, "vf_explained_var": 0.2611638784408569, "kl": 0.0084081106638434, "entropy": 0.2288710238071539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1184000, "num_agent_steps_sampled": 1184000, "num_steps_trained": 1184000, "num_agent_steps_trained": 1184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11840, "training_iteration": 296, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-30-00", "timestamp": 1643671800, "time_this_iter_s": 67.42016673088074, "time_total_s": 6471.700159311295, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6471.700159311295, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 62.28541666666666, "ram_util_percent": 72.10208333333334}}
{"episode_reward_max": -2.3, "episode_reward_min": -43.4, "episode_reward_mean": -11.848000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -15.799999999999997, -14.3, -13.399999999999999, -6.4, -16.3, -35.4, -5.8999999999999995, -14.799999999999997, -5.1, -16.4, -7.300000000000001, -8.3, -12.7, -7.4, -11.799999999999999, -7.399999999999999, -13.599999999999998, -25.200000000000003, -8.0, -10.799999999999999, -13.799999999999999, -6.799999999999998, -20.5, -7.0, -4.9, -6.4, -31.2, -11.599999999999998, -9.2, -7.4, -18.4, -5.300000000000001, -6.300000000000001, -17.2, -6.2, -6.199999999999999, -7.3, -4.3, -7.699999999999999, -4.9, -12.199999999999998, -23.3, -2.3, -11.2, -6.2, -10.499999999999998, -11.499999999999996, -5.4, -20.400000000000002, -6.2, -6.2, -22.899999999999988, -7.2, -12.999999999999996, -5.3, -9.3, -5.4, -43.4, -15.8, -8.7, -8.3, -5.3, -11.299999999999999, -14.299999999999999, -19.700000000000006, -10.2, -22.0, -6.5, -6.4, -18.5, -11.0, -6.300000000000001, -13.099999999999998, -5.3, -6.2, -14.199999999999998, -8.3, -4.4, -20.700000000000003, -14.799999999999997, -10.600000000000001, -4.3, -8.3, -9.3, -6.300000000000001, -18.9, -22.299999999999997, -18.2, -7.300000000000001, -21.300000000000004, -4.3, -16.0, -16.099999999999998, -16.9, -20.700000000000003, -4.4, -22.400000000000002, -10.7, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.970199080595041, "mean_inference_ms": 1.2473527473756025, "mean_action_processing_ms": 0.0686895486378753, "mean_env_wait_ms": 11.933937051133453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1188000, "timesteps_this_iter": 0, "agent_timesteps_total": 1188000, "timers": {"sample_time_ms": 44657.138, "sample_throughput": 89.571, "load_time_ms": 1.016, "load_throughput": 3935172.867, "learn_time_ms": 21141.327, "learn_throughput": 189.203, "update_time_ms": 4.334}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.07807961827524568, "policy_loss": -0.00844511866158936, "vf_loss": 8.651862097811955, "vf_explained_var": 0.2211173306870204, "kl": 0.008691802905348529, "entropy": 0.2173978357625905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1188000, "num_agent_steps_sampled": 1188000, "num_steps_trained": 1188000, "num_agent_steps_trained": 1188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11880, "training_iteration": 297, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-31-04", "timestamp": 1643671864, "time_this_iter_s": 64.10012888908386, "time_total_s": 6535.800288200378, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6535.800288200378, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 55.76703296703297, "ram_util_percent": 69.43846153846152}}
{"episode_reward_max": -2.3, "episode_reward_min": -43.4, "episode_reward_mean": -11.542, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.9, -12.199999999999998, -23.3, -2.3, -11.2, -6.2, -10.499999999999998, -11.499999999999996, -5.4, -20.400000000000002, -6.2, -6.2, -22.899999999999988, -7.2, -12.999999999999996, -5.3, -9.3, -5.4, -43.4, -15.8, -8.7, -8.3, -5.3, -11.299999999999999, -14.299999999999999, -19.700000000000006, -10.2, -22.0, -6.5, -6.4, -18.5, -11.0, -6.300000000000001, -13.099999999999998, -5.3, -6.2, -14.199999999999998, -8.3, -4.4, -20.700000000000003, -14.799999999999997, -10.600000000000001, -4.3, -8.3, -9.3, -6.300000000000001, -18.9, -22.299999999999997, -18.2, -7.300000000000001, -21.300000000000004, -4.3, -16.0, -16.099999999999998, -16.9, -20.700000000000003, -4.4, -22.400000000000002, -10.7, -7.2, -22.100000000000023, -6.3, -5.9, -8.599999999999998, -6.800000000000001, -15.700000000000001, -9.199999999999994, -7.2, -4.3, -10.2, -5.3, -5.2, -10.6, -19.2, -23.600000000000005, -6.4, -16.699999999999996, -7.2, -16.29999999999999, -5.4, -5.300000000000001, -13.3, -19.299999999999997, -5.4, -7.3, -13.299999999999997, -5.3, -16.1, -12.3, -12.399999999999999, -13.899999999999999, -7.2, -14.2, -9.2, -11.699999999999998, -7.799999999999999, -7.300000000000001, -7.4, -14.499999999999996, -15.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9791005287906512, "mean_inference_ms": 1.2589438684786904, "mean_action_processing_ms": 0.0693460043213202, "mean_env_wait_ms": 11.976907472887216, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1192000, "timesteps_this_iter": 0, "agent_timesteps_total": 1192000, "timers": {"sample_time_ms": 49221.975, "sample_throughput": 81.265, "load_time_ms": 1.13, "load_throughput": 3541065.873, "learn_time_ms": 23327.086, "learn_throughput": 171.474, "update_time_ms": 4.712}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.061582186119130224, "policy_loss": -0.008478793077250963, "vf_loss": 7.005326992754013, "vf_explained_var": 0.2987387712283801, "kl": 0.010956608300095117, "entropy": 0.2130255115969527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1192000, "num_agent_steps_sampled": 1192000, "num_steps_trained": 1192000, "num_agent_steps_trained": 1192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11920, "training_iteration": 298, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-32-04", "timestamp": 1643671924, "time_this_iter_s": 60.05839490890503, "time_total_s": 6595.858683109283, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6595.858683109283, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 43.60235294117647, "ram_util_percent": 69.15411764705881}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -38.3, "episode_reward_mean": -12.622, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.799999999999997, -10.600000000000001, -4.3, -8.3, -9.3, -6.300000000000001, -18.9, -22.299999999999997, -18.2, -7.300000000000001, -21.300000000000004, -4.3, -16.0, -16.099999999999998, -16.9, -20.700000000000003, -4.4, -22.400000000000002, -10.7, -7.2, -22.100000000000023, -6.3, -5.9, -8.599999999999998, -6.800000000000001, -15.700000000000001, -9.199999999999994, -7.2, -4.3, -10.2, -5.3, -5.2, -10.6, -19.2, -23.600000000000005, -6.4, -16.699999999999996, -7.2, -16.29999999999999, -5.4, -5.300000000000001, -13.3, -19.299999999999997, -5.4, -7.3, -13.299999999999997, -5.3, -16.1, -12.3, -12.399999999999999, -13.899999999999999, -7.2, -14.2, -9.2, -11.699999999999998, -7.799999999999999, -7.300000000000001, -7.4, -14.499999999999996, -15.199999999999996, -21.5, -12.6, -13.599999999999998, -18.199999999999996, -20.000000000000004, -22.700000000000003, -5.800000000000001, -2.4000000000000004, -16.700000000000003, -17.3, -18.0, -15.499999999999998, -7.300000000000001, -16.1, -10.200000000000001, -3.2, -33.4, -7.999999999999998, -4.4, -9.8, -36.50000000000005, -16.3, -7.3, -9.199999999999996, -11.999999999999998, -12.299999999999995, -19.3, -10.600000000000001, -22.2, -9.3, -8.5, -5.0, -8.0, -15.3, -28.700000000000017, -9.0, -9.899999999999997, -6.1, -10.8, -38.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9871704566263756, "mean_inference_ms": 1.2696524256528428, "mean_action_processing_ms": 0.06995420436941574, "mean_env_wait_ms": 12.01430386766137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1196000, "timesteps_this_iter": 0, "agent_timesteps_total": 1196000, "timers": {"sample_time_ms": 53738.483, "sample_throughput": 74.435, "load_time_ms": 1.225, "load_throughput": 3265828.856, "learn_time_ms": 25368.412, "learn_throughput": 157.676, "update_time_ms": 5.104}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.20544367367501862, "policy_loss": -0.02031340676620202, "vf_loss": 22.574893147201948, "vf_explained_var": 0.06754534654719856, "kl": 0.011582692727471828, "entropy": 0.2641297807456345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1196000, "num_agent_steps_sampled": 1196000, "num_steps_trained": 1196000, "num_agent_steps_trained": 1196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 11960, "training_iteration": 299, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-33-03", "timestamp": 1643671983, "time_this_iter_s": 58.307069301605225, "time_total_s": 6654.165752410889, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6654.165752410889, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 42.573170731707314, "ram_util_percent": 69.50731707317073}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -171.3, "episode_reward_mean": -18.104000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -13.3, -19.299999999999997, -5.4, -7.3, -13.299999999999997, -5.3, -16.1, -12.3, -12.399999999999999, -13.899999999999999, -7.2, -14.2, -9.2, -11.699999999999998, -7.799999999999999, -7.300000000000001, -7.4, -14.499999999999996, -15.199999999999996, -21.5, -12.6, -13.599999999999998, -18.199999999999996, -20.000000000000004, -22.700000000000003, -5.800000000000001, -2.4000000000000004, -16.700000000000003, -17.3, -18.0, -15.499999999999998, -7.300000000000001, -16.1, -10.200000000000001, -3.2, -33.4, -7.999999999999998, -4.4, -9.8, -36.50000000000005, -16.3, -7.3, -9.199999999999996, -11.999999999999998, -12.299999999999995, -19.3, -10.600000000000001, -22.2, -9.3, -8.5, -5.0, -8.0, -15.3, -28.700000000000017, -9.0, -9.899999999999997, -6.1, -10.8, -38.3, -9.4, -27.09999999999997, -6.2, -3.4, -20.800000000000004, -10.899999999999999, -4.300000000000001, -18.900000000000023, -17.799999999999997, -171.3, -4.3, -149.0, -5.2, -23.6, -4.300000000000001, -44.4, -6.199999999999999, -12.799999999999999, -4.2, -23.2, -6.4, -13.299999999999999, -5.300000000000001, -22.300000000000004, -9.899999999999999, -55.40000000000001, -127.5, -11.199999999999998, -6.3, -6.4, -5.799999999999999, -5.4, -9.999999999999998, -11.599999999999998, -5.0, -6.300000000000001, -8.2, -126.3, -5.4, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9946227583319514, "mean_inference_ms": 1.2793801886543161, "mean_action_processing_ms": 0.07050830707906777, "mean_env_wait_ms": 12.045687952557628, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1200000, "timesteps_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 57815.593, "sample_throughput": 69.185, "load_time_ms": 1.31, "load_throughput": 3052734.088, "learn_time_ms": 27395.614, "learn_throughput": 146.009, "update_time_ms": 5.466}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 3.032932906270388, "policy_loss": -0.009124279728219394, "vf_loss": 304.20493006437056, "vf_explained_var": -0.190682638524681, "kl": 0.011293572598143675, "entropy": 0.21319594386444296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1200000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 1200000, "num_agent_steps_trained": 1200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12000, "training_iteration": 300, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-33-58", "timestamp": 1643672038, "time_this_iter_s": 55.50653100013733, "time_total_s": 6709.672283411026, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6709.672283411026, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 41.75822784810126, "ram_util_percent": 70.31012658227844}}
{"episode_reward_max": -3.3, "episode_reward_min": -171.3, "episode_reward_mean": -17.417, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.50000000000005, -16.3, -7.3, -9.199999999999996, -11.999999999999998, -12.299999999999995, -19.3, -10.600000000000001, -22.2, -9.3, -8.5, -5.0, -8.0, -15.3, -28.700000000000017, -9.0, -9.899999999999997, -6.1, -10.8, -38.3, -9.4, -27.09999999999997, -6.2, -3.4, -20.800000000000004, -10.899999999999999, -4.300000000000001, -18.900000000000023, -17.799999999999997, -171.3, -4.3, -149.0, -5.2, -23.6, -4.300000000000001, -44.4, -6.199999999999999, -12.799999999999999, -4.2, -23.2, -6.4, -13.299999999999999, -5.300000000000001, -22.300000000000004, -9.899999999999999, -55.40000000000001, -127.5, -11.199999999999998, -6.3, -6.4, -5.799999999999999, -5.4, -9.999999999999998, -11.599999999999998, -5.0, -6.300000000000001, -8.2, -126.3, -5.4, -5.4, -5.3, -6.4, -5.9, -6.199999999999999, -6.300000000000001, -8.999999999999996, -3.3, -8.9, -6.300000000000001, -8.4, -4.4, -29.200000000000006, -5.300000000000001, -6.300000000000001, -5.300000000000001, -11.6, -8.4, -12.2, -21.400000000000052, -5.899999999999999, -24.5, -18.699999999999996, -9.8, -5.700000000000001, -13.799999999999988, -10.999999999999996, -5.4, -15.2, -5.2, -23.8, -15.799999999999997, -5.2, -4.6000000000000005, -7.300000000000001, -17.099999999999998, -21.89999999999999, -5.2, -20.2, -9.2, -10.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0016364518406027, "mean_inference_ms": 1.288778538799476, "mean_action_processing_ms": 0.07105754520699803, "mean_env_wait_ms": 12.074789900811377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1204000, "timesteps_this_iter": 0, "agent_timesteps_total": 1204000, "timers": {"sample_time_ms": 60617.616, "sample_throughput": 65.987, "load_time_ms": 1.389, "load_throughput": 2879319.009, "learn_time_ms": 28767.326, "learn_throughput": 139.047, "update_time_ms": 5.579}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000703918933868408, "cur_lr": 0.00010000000000000003, "total_loss": 0.13282851710419863, "policy_loss": -0.007088652595637306, "vf_loss": 13.988263728477621, "vf_explained_var": -0.0336108733248967, "kl": 0.049065547542794144, "entropy": 0.2745741873098317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1204000, "num_agent_steps_sampled": 1204000, "num_steps_trained": 1204000, "num_agent_steps_trained": 1204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12040, "training_iteration": 301, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-34-55", "timestamp": 1643672095, "time_this_iter_s": 56.486193895339966, "time_total_s": 6766.158477306366, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6766.158477306366, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 42.483544303797466, "ram_util_percent": 71.57088607594939}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -187.6999999999999, "episode_reward_mean": -17.619, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -13.299999999999999, -5.300000000000001, -22.300000000000004, -9.899999999999999, -55.40000000000001, -127.5, -11.199999999999998, -6.3, -6.4, -5.799999999999999, -5.4, -9.999999999999998, -11.599999999999998, -5.0, -6.300000000000001, -8.2, -126.3, -5.4, -5.4, -5.3, -6.4, -5.9, -6.199999999999999, -6.300000000000001, -8.999999999999996, -3.3, -8.9, -6.300000000000001, -8.4, -4.4, -29.200000000000006, -5.300000000000001, -6.300000000000001, -5.300000000000001, -11.6, -8.4, -12.2, -21.400000000000052, -5.899999999999999, -24.5, -18.699999999999996, -9.8, -5.700000000000001, -13.799999999999988, -10.999999999999996, -5.4, -15.2, -5.2, -23.8, -15.799999999999997, -5.2, -4.6000000000000005, -7.300000000000001, -17.099999999999998, -21.89999999999999, -5.2, -20.2, -9.2, -10.799999999999997, -13.499999999999998, -45.2, -24.3, -35.3, -187.6999999999999, -45.2, -34.3, -34.4, -18.799999999999997, -4.2, -17.699999999999996, -17.099999999999998, -10.3, -59.4, -15.199999999999992, -11.0, -14.8, -16.5, -23.4, -17.6, -2.6000000000000005, -4.5, -7.199999999999999, -32.3, -12.3, -7.4, -10.799999999999999, -10.5, -14.899999999999999, -7.199999999999998, -5.4, -9.0, -9.600000000000001, -16.4, -6.4, -14.199999999999998, -13.700000000000001, -9.799999999999999, -7.599999999999999, -34.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0082713507704135, "mean_inference_ms": 1.2978224552420425, "mean_action_processing_ms": 0.07158883632137146, "mean_env_wait_ms": 12.101893337776547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1208000, "timesteps_this_iter": 0, "agent_timesteps_total": 1208000, "timers": {"sample_time_ms": 61343.932, "sample_throughput": 65.206, "load_time_ms": 1.399, "load_throughput": 2859785.225, "learn_time_ms": 28729.757, "learn_throughput": 139.228, "update_time_ms": 5.647}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 1.9377570851906252, "policy_loss": -0.02393337774681308, "vf_loss": 196.1676340292859, "vf_explained_var": -0.033113126472760275, "kl": 0.0133847567286137, "entropy": 0.3145265274150397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1208000, "num_agent_steps_sampled": 1208000, "num_steps_trained": 1208000, "num_agent_steps_trained": 1208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12080, "training_iteration": 302, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-35-50", "timestamp": 1643672150, "time_this_iter_s": 55.333256244659424, "time_total_s": 6821.491733551025, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6821.491733551025, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 41.26075949367088, "ram_util_percent": 72.31645569620254}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -187.6999999999999, "episode_reward_mean": -20.5, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.5, -18.699999999999996, -9.8, -5.700000000000001, -13.799999999999988, -10.999999999999996, -5.4, -15.2, -5.2, -23.8, -15.799999999999997, -5.2, -4.6000000000000005, -7.300000000000001, -17.099999999999998, -21.89999999999999, -5.2, -20.2, -9.2, -10.799999999999997, -13.499999999999998, -45.2, -24.3, -35.3, -187.6999999999999, -45.2, -34.3, -34.4, -18.799999999999997, -4.2, -17.699999999999996, -17.099999999999998, -10.3, -59.4, -15.199999999999992, -11.0, -14.8, -16.5, -23.4, -17.6, -2.6000000000000005, -4.5, -7.199999999999999, -32.3, -12.3, -7.4, -10.799999999999999, -10.5, -14.899999999999999, -7.199999999999998, -5.4, -9.0, -9.600000000000001, -16.4, -6.4, -14.199999999999998, -13.700000000000001, -9.799999999999999, -7.599999999999999, -34.4, -19.39999999999999, -19.999999999999996, -14.699999999999998, -26.2, -12.7, -8.2, -52.3, -29.2, -10.7, -16.200000000000003, -116.5, -6.0, -15.799999999999999, -49.4, -18.600000000000005, -9.5, -22.500000000000004, -3.8000000000000003, -24.700000000000003, -28.3, -35.699999999999996, -6.0, -5.5, -16.3, -14.2, -45.4, -30.4, -6.300000000000001, -6.1, -35.4, -24.099999999999998, -14.0, -3.7, -76.4, -16.2, -24.3, -12.3, -4.800000000000001, -23.199999999999996, -12.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0153029015863142, "mean_inference_ms": 1.307005331595697, "mean_action_processing_ms": 0.07212312470358817, "mean_env_wait_ms": 12.130005684185026, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1212000, "timesteps_this_iter": 0, "agent_timesteps_total": 1212000, "timers": {"sample_time_ms": 60811.318, "sample_throughput": 65.777, "load_time_ms": 1.382, "load_throughput": 2894170.332, "learn_time_ms": 28711.533, "learn_throughput": 139.317, "update_time_ms": 5.526}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 1.0992197394621388, "policy_loss": -0.006895939329318622, "vf_loss": 110.61060792348718, "vf_explained_var": 0.02040027335125913, "kl": 0.009115856836833398, "entropy": 0.3106262924129604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1212000, "num_agent_steps_sampled": 1212000, "num_steps_trained": 1212000, "num_agent_steps_trained": 1212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12120, "training_iteration": 303, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-36-48", "timestamp": 1643672208, "time_this_iter_s": 57.8604211807251, "time_total_s": 6879.3521547317505, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6879.3521547317505, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 41.83536585365853, "ram_util_percent": 72.4829268292683}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -116.5, "episode_reward_mean": -18.88, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.6000000000000005, -4.5, -7.199999999999999, -32.3, -12.3, -7.4, -10.799999999999999, -10.5, -14.899999999999999, -7.199999999999998, -5.4, -9.0, -9.600000000000001, -16.4, -6.4, -14.199999999999998, -13.700000000000001, -9.799999999999999, -7.599999999999999, -34.4, -19.39999999999999, -19.999999999999996, -14.699999999999998, -26.2, -12.7, -8.2, -52.3, -29.2, -10.7, -16.200000000000003, -116.5, -6.0, -15.799999999999999, -49.4, -18.600000000000005, -9.5, -22.500000000000004, -3.8000000000000003, -24.700000000000003, -28.3, -35.699999999999996, -6.0, -5.5, -16.3, -14.2, -45.4, -30.4, -6.300000000000001, -6.1, -35.4, -24.099999999999998, -14.0, -3.7, -76.4, -16.2, -24.3, -12.3, -4.800000000000001, -23.199999999999996, -12.5, -9.1, -11.7, -14.2, -26.2, -10.799999999999999, -26.3, -16.699999999999996, -21.4, -27.4, -16.999999999999996, -11.699999999999978, -28.3, -20.9, -21.3, -12.2, -10.29999999999999, -27.300000000000015, -29.000000000000004, -8.399999999999999, -15.2, -17.500000000000004, -27.600000000000044, -5.1000000000000005, -13.3, -26.2, -40.3, -6.4, -20.8, -10.399999999999997, -15.299999999999974, -18.9, -5.300000000000001, -19.7, -42.3, -21.400000000000002, -20.9, -16.3, -20.3, -12.799999999999995, -8.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.022124261069402, "mean_inference_ms": 1.3160086241309152, "mean_action_processing_ms": 0.07263148055329084, "mean_env_wait_ms": 12.158118971554828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1216000, "timesteps_this_iter": 0, "agent_timesteps_total": 1216000, "timers": {"sample_time_ms": 60481.136, "sample_throughput": 66.136, "load_time_ms": 1.38, "load_throughput": 2897969.703, "learn_time_ms": 28532.888, "learn_throughput": 140.189, "update_time_ms": 5.587}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 0.21448792760030075, "policy_loss": -0.014415110575325627, "vf_loss": 22.888824905887727, "vf_explained_var": 0.0913823942343394, "kl": 0.014010789305951048, "entropy": 0.34672049050049114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1216000, "num_agent_steps_sampled": 1216000, "num_steps_trained": 1216000, "num_agent_steps_trained": 1216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12160, "training_iteration": 304, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-37-45", "timestamp": 1643672265, "time_this_iter_s": 56.45782494544983, "time_total_s": 6935.8099796772, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6935.8099796772, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 36.35124999999999, "ram_util_percent": 72.55}}
{"episode_reward_max": -2.8000000000000003, "episode_reward_min": -76.4, "episode_reward_mean": -19.534000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.699999999999996, -6.0, -5.5, -16.3, -14.2, -45.4, -30.4, -6.300000000000001, -6.1, -35.4, -24.099999999999998, -14.0, -3.7, -76.4, -16.2, -24.3, -12.3, -4.800000000000001, -23.199999999999996, -12.5, -9.1, -11.7, -14.2, -26.2, -10.799999999999999, -26.3, -16.699999999999996, -21.4, -27.4, -16.999999999999996, -11.699999999999978, -28.3, -20.9, -21.3, -12.2, -10.29999999999999, -27.300000000000015, -29.000000000000004, -8.399999999999999, -15.2, -17.500000000000004, -27.600000000000044, -5.1000000000000005, -13.3, -26.2, -40.3, -6.4, -20.8, -10.399999999999997, -15.299999999999974, -18.9, -5.300000000000001, -19.7, -42.3, -21.400000000000002, -20.9, -16.3, -20.3, -12.799999999999995, -8.099999999999998, -20.4, -13.2, -42.2, -11.3, -17.9, -20.2, -29.5, -8.2, -12.799999999999999, -21.400000000000006, -11.799999999999999, -15.299999999999999, -24.1, -23.3, -34.099999999999994, -22.2, -21.500000000000007, -35.80000000000002, -38.2, -23.0, -17.8, -13.2, -2.8000000000000003, -21.2, -13.899999999999999, -18.300000000000008, -12.5, -23.4, -7.2, -4.000000000000001, -8.2, -26.400000000000013, -41.3, -15.5, -28.3, -18.3, -15.399999999999997, -36.3, -21.600000000000005, -14.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.028821313690143, "mean_inference_ms": 1.3249056581967398, "mean_action_processing_ms": 0.07313181647624685, "mean_env_wait_ms": 12.185405049331326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1220000, "timesteps_this_iter": 0, "agent_timesteps_total": 1220000, "timers": {"sample_time_ms": 59142.868, "sample_throughput": 67.633, "load_time_ms": 1.335, "load_throughput": 2996520.031, "learn_time_ms": 28210.385, "learn_throughput": 141.792, "update_time_ms": 5.47}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 0.2706943295262654, "policy_loss": -0.01010160169273775, "vf_loss": 28.07772612366625, "vf_explained_var": 0.125865452648491, "kl": 0.01768938140490574, "entropy": 0.30827571381163854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1220000, "num_agent_steps_sampled": 1220000, "num_steps_trained": 1220000, "num_agent_steps_trained": 1220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12200, "training_iteration": 305, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-38-41", "timestamp": 1643672321, "time_this_iter_s": 56.07885694503784, "time_total_s": 6991.888836622238, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6991.888836622238, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 39.5746835443038, "ram_util_percent": 72.52531645569618}}
{"episode_reward_max": -1.2, "episode_reward_min": -59.4, "episode_reward_mean": -18.835, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.500000000000004, -27.600000000000044, -5.1000000000000005, -13.3, -26.2, -40.3, -6.4, -20.8, -10.399999999999997, -15.299999999999974, -18.9, -5.300000000000001, -19.7, -42.3, -21.400000000000002, -20.9, -16.3, -20.3, -12.799999999999995, -8.099999999999998, -20.4, -13.2, -42.2, -11.3, -17.9, -20.2, -29.5, -8.2, -12.799999999999999, -21.400000000000006, -11.799999999999999, -15.299999999999999, -24.1, -23.3, -34.099999999999994, -22.2, -21.500000000000007, -35.80000000000002, -38.2, -23.0, -17.8, -13.2, -2.8000000000000003, -21.2, -13.899999999999999, -18.300000000000008, -12.5, -23.4, -7.2, -4.000000000000001, -8.2, -26.400000000000013, -41.3, -15.5, -28.3, -18.3, -15.399999999999997, -36.3, -21.600000000000005, -14.3, -3.2, -13.399999999999999, -3.3000000000000003, -37.2, -13.4, -1.2, -16.2, -40.4, -10.4, -16.3, -12.2, -4.800000000000001, -13.599999999999975, -28.3, -13.6, -15.600000000000001, -45.700000000000024, -23.800000000000004, -9.999999999999998, -24.800000000000008, -6.4, -14.099999999999987, -9.700000000000001, -31.800000000000008, -11.3, -15.3, -20.199999999999992, -21.000000000000064, -10.3, -14.499999999999979, -15.4, -36.50000000000001, -19.3, -59.4, -15.299999999999999, -12.5, -12.5, -8.7, -12.2, -14.499999999999984], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.035311044911582, "mean_inference_ms": 1.3334886940663477, "mean_action_processing_ms": 0.07361949349220058, "mean_env_wait_ms": 12.210492031481838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1224000, "timesteps_this_iter": 0, "agent_timesteps_total": 1224000, "timers": {"sample_time_ms": 57944.152, "sample_throughput": 69.032, "load_time_ms": 1.335, "load_throughput": 2995824.435, "learn_time_ms": 27786.037, "learn_throughput": 143.957, "update_time_ms": 5.387}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 0.3660967855343735, "policy_loss": -0.015365934600272486, "vf_loss": 38.145077874583585, "vf_explained_var": 0.013182952647568077, "kl": 0.011315171281519666, "entropy": 0.31877146569951886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1224000, "num_agent_steps_sampled": 1224000, "num_steps_trained": 1224000, "num_agent_steps_trained": 1224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12240, "training_iteration": 306, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-39-35", "timestamp": 1643672375, "time_this_iter_s": 54.40536189079285, "time_total_s": 7046.294198513031, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7046.294198513031, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 38.89870129870131, "ram_util_percent": 72.5051948051948}}
{"episode_reward_max": -1.2, "episode_reward_min": -59.4, "episode_reward_mean": -17.058, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.8, -13.2, -2.8000000000000003, -21.2, -13.899999999999999, -18.300000000000008, -12.5, -23.4, -7.2, -4.000000000000001, -8.2, -26.400000000000013, -41.3, -15.5, -28.3, -18.3, -15.399999999999997, -36.3, -21.600000000000005, -14.3, -3.2, -13.399999999999999, -3.3000000000000003, -37.2, -13.4, -1.2, -16.2, -40.4, -10.4, -16.3, -12.2, -4.800000000000001, -13.599999999999975, -28.3, -13.6, -15.600000000000001, -45.700000000000024, -23.800000000000004, -9.999999999999998, -24.800000000000008, -6.4, -14.099999999999987, -9.700000000000001, -31.800000000000008, -11.3, -15.3, -20.199999999999992, -21.000000000000064, -10.3, -14.499999999999979, -15.4, -36.50000000000001, -19.3, -59.4, -15.299999999999999, -12.5, -12.5, -8.7, -12.2, -14.499999999999984, -15.2, -18.3, -6.199999999999999, -5.7, -23.7, -9.899999999999999, -33.300000000000004, -12.3, -9.799999999999997, -18.9, -23.2, -19.6, -12.3, -22.3, -10.799999999999994, -17.999999999999993, -32.3, -48.3, -16.9, -15.399999999999991, -12.2, -10.699999999999998, -7.499999999999999, -10.3, -14.3, -20.3, -13.4, -4.6, -19.199999999999996, -9.799999999999992, -7.699999999999995, -17.3, -7.599999999999999, -16.9, -28.600000000000005, -28.3, -8.799999999999997, -7.499999999999998, -3.5, -16.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0421601116254915, "mean_inference_ms": 1.3421564060217404, "mean_action_processing_ms": 0.07412630441964325, "mean_env_wait_ms": 12.236343365199193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1228000, "timesteps_this_iter": 0, "agent_timesteps_total": 1228000, "timers": {"sample_time_ms": 56917.554, "sample_throughput": 70.277, "load_time_ms": 1.304, "load_throughput": 3068030.137, "learn_time_ms": 27685.058, "learn_throughput": 144.482, "update_time_ms": 5.335}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 0.23174038658153906, "policy_loss": -0.015579063165932893, "vf_loss": 24.73043748947882, "vf_explained_var": 0.05807270638404354, "kl": 0.014282132935789418, "entropy": 0.29085219031380066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1228000, "num_agent_steps_sampled": 1228000, "num_steps_trained": 1228000, "num_agent_steps_trained": 1228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12280, "training_iteration": 307, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-40-32", "timestamp": 1643672432, "time_this_iter_s": 57.080775022506714, "time_total_s": 7103.374973535538, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7103.374973535538, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 44.451851851851856, "ram_util_percent": 72.50617283950618}}
{"episode_reward_max": -3.5, "episode_reward_min": -59.4, "episode_reward_mean": -16.375000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.4, -14.099999999999987, -9.700000000000001, -31.800000000000008, -11.3, -15.3, -20.199999999999992, -21.000000000000064, -10.3, -14.499999999999979, -15.4, -36.50000000000001, -19.3, -59.4, -15.299999999999999, -12.5, -12.5, -8.7, -12.2, -14.499999999999984, -15.2, -18.3, -6.199999999999999, -5.7, -23.7, -9.899999999999999, -33.300000000000004, -12.3, -9.799999999999997, -18.9, -23.2, -19.6, -12.3, -22.3, -10.799999999999994, -17.999999999999993, -32.3, -48.3, -16.9, -15.399999999999991, -12.2, -10.699999999999998, -7.499999999999999, -10.3, -14.3, -20.3, -13.4, -4.6, -19.199999999999996, -9.799999999999992, -7.699999999999995, -17.3, -7.599999999999999, -16.9, -28.600000000000005, -28.3, -8.799999999999997, -7.499999999999998, -3.5, -16.7, -12.799999999999999, -42.09999999999993, -11.199999999999998, -15.7, -13.3, -24.500000000000103, -8.3, -48.40000000000005, -15.599999999999996, -16.3, -18.3, -10.3, -12.2, -16.599999999999987, -9.3, -16.299999999999997, -8.1, -8.299999999999999, -19.4, -18.699999999999996, -14.3, -19.9, -13.999999999999998, -12.399999999999999, -14.799999999999997, -14.1, -7.2, -16.7, -13.6, -12.4, -21.9, -9.3, -18.3, -14.199999999999998, -13.3, -15.699999999999985, -10.2, -18.400000000000006, -17.2, -15.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0489121558500722, "mean_inference_ms": 1.3505130515236163, "mean_action_processing_ms": 0.0746164142922375, "mean_env_wait_ms": 12.260636544132275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1232000, "timesteps_this_iter": 0, "agent_timesteps_total": 1232000, "timers": {"sample_time_ms": 56291.905, "sample_throughput": 71.058, "load_time_ms": 1.287, "load_throughput": 3108158.139, "learn_time_ms": 27518.782, "learn_throughput": 145.355, "update_time_ms": 5.286}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0010558784008026126, "cur_lr": 0.00010000000000000003, "total_loss": 0.1428307973329098, "policy_loss": -0.01620202860995246, "vf_loss": 15.901085846142102, "vf_explained_var": 0.37508334203432964, "kl": 0.020808255398907058, "entropy": 0.2902444687101149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1232000, "num_agent_steps_sampled": 1232000, "num_steps_trained": 1232000, "num_agent_steps_trained": 1232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12320, "training_iteration": 308, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-41-26", "timestamp": 1643672486, "time_this_iter_s": 53.145220041275024, "time_total_s": 7156.520193576813, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7156.520193576813, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 26.901333333333334, "ram_util_percent": 72.476}}
{"episode_reward_max": -3.5, "episode_reward_min": -107.10000000000015, "episode_reward_mean": -16.234, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.2, -10.699999999999998, -7.499999999999999, -10.3, -14.3, -20.3, -13.4, -4.6, -19.199999999999996, -9.799999999999992, -7.699999999999995, -17.3, -7.599999999999999, -16.9, -28.600000000000005, -28.3, -8.799999999999997, -7.499999999999998, -3.5, -16.7, -12.799999999999999, -42.09999999999993, -11.199999999999998, -15.7, -13.3, -24.500000000000103, -8.3, -48.40000000000005, -15.599999999999996, -16.3, -18.3, -10.3, -12.2, -16.599999999999987, -9.3, -16.299999999999997, -8.1, -8.299999999999999, -19.4, -18.699999999999996, -14.3, -19.9, -13.999999999999998, -12.399999999999999, -14.799999999999997, -14.1, -7.2, -16.7, -13.6, -12.4, -21.9, -9.3, -18.3, -14.199999999999998, -13.3, -15.699999999999985, -10.2, -18.400000000000006, -17.2, -15.4, -15.2, -7.3, -17.2, -40.20000000000003, -16.2, -16.199999999999996, -12.3, -7.800000000000001, -30.200000000000003, -13.3, -6.3, -19.4, -17.199999999999996, -18.2, -6.699999999999999, -11.799999999999997, -16.799999999999997, -7.2, -11.9, -5.799999999999999, -20.4, -8.3, -19.100000000000005, -7.3, -9.399999999999999, -39.4, -17.9, -107.10000000000015, -7.999999999999988, -12.599999999999998, -14.999999999999998, -12.799999999999997, -11.999999999999995, -10.3, -55.600000000000016, -15.3, -10.3, -10.6, -13.2, -17.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0551368034781072, "mean_inference_ms": 1.358431146685451, "mean_action_processing_ms": 0.07508048429357586, "mean_env_wait_ms": 12.283011817549381, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1236000, "timesteps_this_iter": 0, "agent_timesteps_total": 1236000, "timers": {"sample_time_ms": 55681.069, "sample_throughput": 71.838, "load_time_ms": 1.283, "load_throughput": 3116935.31, "learn_time_ms": 27417.095, "learn_throughput": 145.894, "update_time_ms": 5.223}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.7055968267883184, "policy_loss": -0.01596091276895936, "vf_loss": 72.15371271153931, "vf_explained_var": 0.03148269364910741, "kl": 0.013016126837256546, "entropy": 0.29855808008422136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1236000, "num_agent_steps_sampled": 1236000, "num_steps_trained": 1236000, "num_agent_steps_trained": 1236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12360, "training_iteration": 309, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-42-18", "timestamp": 1643672538, "time_this_iter_s": 52.84531784057617, "time_total_s": 7209.365511417389, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7209.365511417389, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 27.773333333333333, "ram_util_percent": 72.46133333333331}}
{"episode_reward_max": -4.6, "episode_reward_min": -107.10000000000015, "episode_reward_mean": -17.783000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.3, -19.9, -13.999999999999998, -12.399999999999999, -14.799999999999997, -14.1, -7.2, -16.7, -13.6, -12.4, -21.9, -9.3, -18.3, -14.199999999999998, -13.3, -15.699999999999985, -10.2, -18.400000000000006, -17.2, -15.4, -15.2, -7.3, -17.2, -40.20000000000003, -16.2, -16.199999999999996, -12.3, -7.800000000000001, -30.200000000000003, -13.3, -6.3, -19.4, -17.199999999999996, -18.2, -6.699999999999999, -11.799999999999997, -16.799999999999997, -7.2, -11.9, -5.799999999999999, -20.4, -8.3, -19.100000000000005, -7.3, -9.399999999999999, -39.4, -17.9, -107.10000000000015, -7.999999999999988, -12.599999999999998, -14.999999999999998, -12.799999999999997, -11.999999999999995, -10.3, -55.600000000000016, -15.3, -10.3, -10.6, -13.2, -17.4, -25.3, -9.4, -22.4, -13.799999999999997, -19.800000000000008, -9.3, -27.500000000000025, -13.3, -13.5, -72.3, -7.3, -29.9, -8.3, -6.199999999999999, -21.500000000000004, -20.999999999999996, -6.3, -17.400000000000006, -13.099999999999996, -13.4, -16.599999999999998, -17.3, -23.600000000000005, -20.1, -19.600000000000016, -12.3, -16.3, -38.3, -21.3, -35.09999999999995, -10.3, -24.10000000000001, -7.300000000000001, -17.3, -30.80000000000006, -14.7, -4.6, -24.400000000000023, -24.900000000000006, -15.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0608372067257834, "mean_inference_ms": 1.3660763292654605, "mean_action_processing_ms": 0.07552101541685574, "mean_env_wait_ms": 12.304029424891853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1240000, "timesteps_this_iter": 0, "agent_timesteps_total": 1240000, "timers": {"sample_time_ms": 55412.953, "sample_throughput": 72.185, "load_time_ms": 1.278, "load_throughput": 3130369.624, "learn_time_ms": 27344.091, "learn_throughput": 146.284, "update_time_ms": 5.189}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.3463934547876218, "policy_loss": -0.007686415943567471, "vf_loss": 35.40603919080509, "vf_explained_var": 0.14203115778584635, "kl": 0.012304411615356909, "entropy": 0.25921328453126774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1240000, "num_agent_steps_sampled": 1240000, "num_steps_trained": 1240000, "num_agent_steps_trained": 1240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12400, "training_iteration": 310, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-43-12", "timestamp": 1643672592, "time_this_iter_s": 53.11011481285095, "time_total_s": 7262.47562623024, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7262.47562623024, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 29.274666666666658, "ram_util_percent": 72.36133333333332}}
{"episode_reward_max": -3.7, "episode_reward_min": -107.10000000000015, "episode_reward_mean": -18.831, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.4, -8.3, -19.100000000000005, -7.3, -9.399999999999999, -39.4, -17.9, -107.10000000000015, -7.999999999999988, -12.599999999999998, -14.999999999999998, -12.799999999999997, -11.999999999999995, -10.3, -55.600000000000016, -15.3, -10.3, -10.6, -13.2, -17.4, -25.3, -9.4, -22.4, -13.799999999999997, -19.800000000000008, -9.3, -27.500000000000025, -13.3, -13.5, -72.3, -7.3, -29.9, -8.3, -6.199999999999999, -21.500000000000004, -20.999999999999996, -6.3, -17.400000000000006, -13.099999999999996, -13.4, -16.599999999999998, -17.3, -23.600000000000005, -20.1, -19.600000000000016, -12.3, -16.3, -38.3, -21.3, -35.09999999999995, -10.3, -24.10000000000001, -7.300000000000001, -17.3, -30.80000000000006, -14.7, -4.6, -24.400000000000023, -24.900000000000006, -15.899999999999999, -19.3, -30.20000000000001, -19.799999999999997, -6.2, -12.3, -18.9, -11.299999999999997, -6.9, -13.8, -62.59999999999993, -19.599999999999998, -16.099999999999994, -12.199999999999989, -15.799999999999999, -26.2, -27.700000000000053, -8.7, -37.10000000000004, -14.3, -29.500000000000014, -12.0, -11.3, -10.6, -3.7, -13.0, -9.8, -8.3, -12.2, -14.7, -18.500000000000004, -27.20000000000007, -13.3, -25.10000000000001, -23.10000000000003, -13.2, -13.899999999999983, -23.1, -6.1, -18.6, -9.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0665561434479214, "mean_inference_ms": 1.3735980604780968, "mean_action_processing_ms": 0.07595283259259569, "mean_env_wait_ms": 12.324297205375325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1244000, "timesteps_this_iter": 0, "agent_timesteps_total": 1244000, "timers": {"sample_time_ms": 55022.183, "sample_throughput": 72.698, "load_time_ms": 1.28, "load_throughput": 3125471.041, "learn_time_ms": 27254.065, "learn_throughput": 146.767, "update_time_ms": 5.158}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.284349218119056, "policy_loss": -0.01136234456332781, "vf_loss": 29.568572642726284, "vf_explained_var": 0.13790856087079612, "kl": 0.016317401449069607, "entropy": 0.3099916593762495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1244000, "num_agent_steps_sampled": 1244000, "num_steps_trained": 1244000, "num_agent_steps_trained": 1244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12440, "training_iteration": 311, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-44-04", "timestamp": 1643672644, "time_this_iter_s": 52.415982723236084, "time_total_s": 7314.891608953476, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7314.891608953476, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 29.098648648648645, "ram_util_percent": 72.4391891891892}}
{"episode_reward_max": -3.7, "episode_reward_min": -62.59999999999993, "episode_reward_mean": -16.165000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.599999999999998, -17.3, -23.600000000000005, -20.1, -19.600000000000016, -12.3, -16.3, -38.3, -21.3, -35.09999999999995, -10.3, -24.10000000000001, -7.300000000000001, -17.3, -30.80000000000006, -14.7, -4.6, -24.400000000000023, -24.900000000000006, -15.899999999999999, -19.3, -30.20000000000001, -19.799999999999997, -6.2, -12.3, -18.9, -11.299999999999997, -6.9, -13.8, -62.59999999999993, -19.599999999999998, -16.099999999999994, -12.199999999999989, -15.799999999999999, -26.2, -27.700000000000053, -8.7, -37.10000000000004, -14.3, -29.500000000000014, -12.0, -11.3, -10.6, -3.7, -13.0, -9.8, -8.3, -12.2, -14.7, -18.500000000000004, -27.20000000000007, -13.3, -25.10000000000001, -23.10000000000003, -13.2, -13.899999999999983, -23.1, -6.1, -18.6, -9.1, -5.2, -7.2, -8.3, -18.599999999999994, -25.900000000000002, -9.5, -14.6, -18.700000000000006, -22.400000000000006, -7.999999999999997, -7.3, -11.399999999999999, -10.3, -10.2, -11.2, -12.6, -24.3, -19.5, -9.3, -16.6, -5.8, -12.3, -10.4, -13.3, -9.0, -29.2, -18.09999999999997, -10.3, -20.7, -11.199999999999992, -9.899999999999997, -15.2, -10.299999999999999, -9.3, -15.799999999999997, -7.700000000000001, -12.4, -10.3, -11.199999999999998, -12.899999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0722626075619646, "mean_inference_ms": 1.3813725877806993, "mean_action_processing_ms": 0.07639269205358694, "mean_env_wait_ms": 12.345834468833639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1248000, "timesteps_this_iter": 0, "agent_timesteps_total": 1248000, "timers": {"sample_time_ms": 54960.397, "sample_throughput": 72.78, "load_time_ms": 1.269, "load_throughput": 3152071.544, "learn_time_ms": 27070.221, "learn_throughput": 147.764, "update_time_ms": 4.928}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.1125858349725604, "policy_loss": -0.00907579264954053, "vf_loss": 12.164659578184928, "vf_explained_var": 0.24770086888344056, "kl": 0.009492244333790817, "entropy": 0.27253754090878274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1248000, "num_agent_steps_sampled": 1248000, "num_steps_trained": 1248000, "num_agent_steps_trained": 1248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12480, "training_iteration": 312, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-44-58", "timestamp": 1643672698, "time_this_iter_s": 53.771384716033936, "time_total_s": 7368.66299366951, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7368.66299366951, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 31.655263157894733, "ram_util_percent": 72.39868421052628}}
{"episode_reward_max": -1.5000000000000002, "episode_reward_min": -54.100000000000065, "episode_reward_mean": -14.255, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -11.3, -10.6, -3.7, -13.0, -9.8, -8.3, -12.2, -14.7, -18.500000000000004, -27.20000000000007, -13.3, -25.10000000000001, -23.10000000000003, -13.2, -13.899999999999983, -23.1, -6.1, -18.6, -9.1, -5.2, -7.2, -8.3, -18.599999999999994, -25.900000000000002, -9.5, -14.6, -18.700000000000006, -22.400000000000006, -7.999999999999997, -7.3, -11.399999999999999, -10.3, -10.2, -11.2, -12.6, -24.3, -19.5, -9.3, -16.6, -5.8, -12.3, -10.4, -13.3, -9.0, -29.2, -18.09999999999997, -10.3, -20.7, -11.199999999999992, -9.899999999999997, -15.2, -10.299999999999999, -9.3, -15.799999999999997, -7.700000000000001, -12.4, -10.3, -11.199999999999998, -12.899999999999997, -16.299999999999997, -9.2, -7.800000000000001, -12.099999999999998, -14.2, -12.3, -21.700000000000003, -12.600000000000001, -13.2, -12.2, -40.2, -13.5, -32.800000000000026, -9.799999999999997, -15.0, -16.3, -54.100000000000065, -2.5, -13.699999999999973, -18.2, -18.100000000000005, -9.999999999999998, -7.300000000000001, -20.1, -1.5000000000000002, -16.699999999999996, -7.2, -21.800000000000004, -5.2, -8.2, -24.5, -11.2, -15.3, -9.2, -26.1, -15.6, -7.3, -12.1, -9.3, -17.899999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.078150396847914, "mean_inference_ms": 1.3890422746510616, "mean_action_processing_ms": 0.07682663375780678, "mean_env_wait_ms": 12.367394523642878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1252000, "timesteps_this_iter": 0, "agent_timesteps_total": 1252000, "timers": {"sample_time_ms": 54426.83, "sample_throughput": 73.493, "load_time_ms": 1.268, "load_throughput": 3155806.858, "learn_time_ms": 26900.12, "learn_throughput": 148.698, "update_time_ms": 4.877}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.16972366261936883, "policy_loss": -0.019338151281298968, "vf_loss": 18.903382833286, "vf_explained_var": 0.06513690333212575, "kl": 0.017672024901685755, "entropy": 0.2873742148119916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1252000, "num_agent_steps_sampled": 1252000, "num_steps_trained": 1252000, "num_agent_steps_trained": 1252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12520, "training_iteration": 313, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-45-51", "timestamp": 1643672751, "time_this_iter_s": 52.68502902984619, "time_total_s": 7421.348022699356, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7421.348022699356, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 29.58648648648649, "ram_util_percent": 72.42837837837837}}
{"episode_reward_max": -1.5000000000000002, "episode_reward_min": -54.100000000000065, "episode_reward_mean": -14.178000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.8, -12.3, -10.4, -13.3, -9.0, -29.2, -18.09999999999997, -10.3, -20.7, -11.199999999999992, -9.899999999999997, -15.2, -10.299999999999999, -9.3, -15.799999999999997, -7.700000000000001, -12.4, -10.3, -11.199999999999998, -12.899999999999997, -16.299999999999997, -9.2, -7.800000000000001, -12.099999999999998, -14.2, -12.3, -21.700000000000003, -12.600000000000001, -13.2, -12.2, -40.2, -13.5, -32.800000000000026, -9.799999999999997, -15.0, -16.3, -54.100000000000065, -2.5, -13.699999999999973, -18.2, -18.100000000000005, -9.999999999999998, -7.300000000000001, -20.1, -1.5000000000000002, -16.699999999999996, -7.2, -21.800000000000004, -5.2, -8.2, -24.5, -11.2, -15.3, -9.2, -26.1, -15.6, -7.3, -12.1, -9.3, -17.899999999999995, -12.3, -8.899999999999999, -10.999999999999998, -13.4, -5.8999999999999995, -4.3, -13.2, -9.3, -5.1000000000000005, -19.9, -13.3, -15.899999999999999, -12.899999999999988, -13.3, -13.2, -13.099999999999998, -8.2, -20.400000000000013, -16.599999999999987, -13.499999999999998, -19.2, -18.5, -9.600000000000001, -14.899999999999999, -14.2, -22.199999999999957, -5.2, -17.8, -13.399999999999983, -17.2, -12.6, -40.3, -11.999999999999996, -14.2, -8.3, -17.999999999999996, -12.3, -11.4, -13.899999999999995, -11.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0839987432242943, "mean_inference_ms": 1.396565084026698, "mean_action_processing_ms": 0.07725265322836124, "mean_env_wait_ms": 12.388355903504525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1256000, "timesteps_this_iter": 0, "agent_timesteps_total": 1256000, "timers": {"sample_time_ms": 54078.64, "sample_throughput": 73.966, "load_time_ms": 1.29, "load_throughput": 3100289.384, "learn_time_ms": 26714.754, "learn_throughput": 149.73, "update_time_ms": 4.767}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.14129874536326975, "policy_loss": -0.008294443206320848, "vf_loss": 14.957312524190513, "vf_explained_var": 0.27470169695474767, "kl": 0.012670790319916721, "entropy": 0.3047152948155198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1256000, "num_agent_steps_sampled": 1256000, "num_steps_trained": 1256000, "num_agent_steps_trained": 1256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12560, "training_iteration": 314, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-46-44", "timestamp": 1643672804, "time_this_iter_s": 52.821391105651855, "time_total_s": 7474.169413805008, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7474.169413805008, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 27.333333333333332, "ram_util_percent": 72.4053333333333}}
{"episode_reward_max": -1.5000000000000002, "episode_reward_min": -40.3, "episode_reward_mean": -12.62, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.100000000000005, -9.999999999999998, -7.300000000000001, -20.1, -1.5000000000000002, -16.699999999999996, -7.2, -21.800000000000004, -5.2, -8.2, -24.5, -11.2, -15.3, -9.2, -26.1, -15.6, -7.3, -12.1, -9.3, -17.899999999999995, -12.3, -8.899999999999999, -10.999999999999998, -13.4, -5.8999999999999995, -4.3, -13.2, -9.3, -5.1000000000000005, -19.9, -13.3, -15.899999999999999, -12.899999999999988, -13.3, -13.2, -13.099999999999998, -8.2, -20.400000000000013, -16.599999999999987, -13.499999999999998, -19.2, -18.5, -9.600000000000001, -14.899999999999999, -14.2, -22.199999999999957, -5.2, -17.8, -13.399999999999983, -17.2, -12.6, -40.3, -11.999999999999996, -14.2, -8.3, -17.999999999999996, -12.3, -11.4, -13.899999999999995, -11.299999999999999, -18.100000000000012, -13.899999999999999, -14.8, -7.3, -6.6, -15.3, -25.700000000000006, -13.799999999999999, -11.899999999999997, -5.6000000000000005, -12.7, -5.300000000000001, -7.0, -7.700000000000001, -11.3, -4.2, -17.799999999999997, -16.599999999999987, -18.799999999999997, -10.699999999999982, -5.300000000000001, -13.099999999999998, -5.4, -6.2, -7.2, -6.300000000000001, -7.199999999999998, -11.3, -29.700000000000067, -12.8, -7.300000000000001, -7.2, -7.2, -5.2, -14.999999999999984, -17.0, -4.7, -6.4, -19.299999999999997, -8.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0898285395940734, "mean_inference_ms": 1.4038034579441747, "mean_action_processing_ms": 0.07766672753707611, "mean_env_wait_ms": 12.4080622711415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1260000, "timesteps_this_iter": 0, "agent_timesteps_total": 1260000, "timers": {"sample_time_ms": 53678.728, "sample_throughput": 74.517, "load_time_ms": 1.284, "load_throughput": 3114736.373, "learn_time_ms": 27315.827, "learn_throughput": 146.435, "update_time_ms": 5.521}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.09293738987437018, "policy_loss": -0.0011884951743707862, "vf_loss": 9.411128600182073, "vf_explained_var": 0.22030459277091488, "kl": 0.009219470265266766, "entropy": 0.24237075569809124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1260000, "num_agent_steps_sampled": 1260000, "num_steps_trained": 1260000, "num_agent_steps_trained": 1260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12600, "training_iteration": 315, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-47-44", "timestamp": 1643672864, "time_this_iter_s": 59.967768907547, "time_total_s": 7534.137182712555, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7534.137182712555, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 41.411764705882355, "ram_util_percent": 72.87882352941179}}
{"episode_reward_max": -4.2, "episode_reward_min": -128.5999999999999, "episode_reward_mean": -14.083, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.2, -18.5, -9.600000000000001, -14.899999999999999, -14.2, -22.199999999999957, -5.2, -17.8, -13.399999999999983, -17.2, -12.6, -40.3, -11.999999999999996, -14.2, -8.3, -17.999999999999996, -12.3, -11.4, -13.899999999999995, -11.299999999999999, -18.100000000000012, -13.899999999999999, -14.8, -7.3, -6.6, -15.3, -25.700000000000006, -13.799999999999999, -11.899999999999997, -5.6000000000000005, -12.7, -5.300000000000001, -7.0, -7.700000000000001, -11.3, -4.2, -17.799999999999997, -16.599999999999987, -18.799999999999997, -10.699999999999982, -5.300000000000001, -13.099999999999998, -5.4, -6.2, -7.2, -6.300000000000001, -7.199999999999998, -11.3, -29.700000000000067, -12.8, -7.300000000000001, -7.2, -7.2, -5.2, -14.999999999999984, -17.0, -4.7, -6.4, -19.299999999999997, -8.3, -24.50000000000009, -7.2, -14.899999999999999, -21.799999999999997, -17.599999999999998, -18.7, -13.999999999999998, -16.7, -5.2, -9.799999999999997, -5.2, -5.2, -9.3, -16.7, -17.699999999999996, -9.2, -22.099999999999994, -5.999999999999999, -128.5999999999999, -12.799999999999997, -13.2, -11.5, -8.4, -10.899999999999999, -8.0, -8.2, -6.2, -12.5, -24.0, -8.3, -16.3, -17.2, -15.7, -10.3, -15.199999999999996, -7.3, -11.9, -47.2, -12.799999999999999, -6.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0947066868851918, "mean_inference_ms": 1.4094637490203896, "mean_action_processing_ms": 0.07799599080398353, "mean_env_wait_ms": 12.45351080101179, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1264000, "timesteps_this_iter": 0, "agent_timesteps_total": 1264000, "timers": {"sample_time_ms": 53553.05, "sample_throughput": 74.692, "load_time_ms": 1.189, "load_throughput": 3363515.638, "learn_time_ms": 26202.509, "learn_throughput": 152.657, "update_time_ms": 5.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.8106101252328884, "policy_loss": -0.009761305033199249, "vf_loss": 82.03546106052654, "vf_explained_var": 0.19797986412561067, "kl": 0.010634541185331487, "entropy": 0.26185862277784655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1264000, "num_agent_steps_sampled": 1264000, "num_steps_trained": 1264000, "num_agent_steps_trained": 1264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12640, "training_iteration": 316, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-48-45", "timestamp": 1643672925, "time_this_iter_s": 61.28186511993408, "time_total_s": 7595.419047832489, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7595.419047832489, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 45.98367346938776, "ram_util_percent": 72.20204081632653}}
{"episode_reward_max": -4.7, "episode_reward_min": -128.5999999999999, "episode_reward_mean": -13.961999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -13.099999999999998, -5.4, -6.2, -7.2, -6.300000000000001, -7.199999999999998, -11.3, -29.700000000000067, -12.8, -7.300000000000001, -7.2, -7.2, -5.2, -14.999999999999984, -17.0, -4.7, -6.4, -19.299999999999997, -8.3, -24.50000000000009, -7.2, -14.899999999999999, -21.799999999999997, -17.599999999999998, -18.7, -13.999999999999998, -16.7, -5.2, -9.799999999999997, -5.2, -5.2, -9.3, -16.7, -17.699999999999996, -9.2, -22.099999999999994, -5.999999999999999, -128.5999999999999, -12.799999999999997, -13.2, -11.5, -8.4, -10.899999999999999, -8.0, -8.2, -6.2, -12.5, -24.0, -8.3, -16.3, -17.2, -15.7, -10.3, -15.199999999999996, -7.3, -11.9, -47.2, -12.799999999999999, -6.3, -5.3, -13.3, -8.3, -5.4, -36.3, -6.300000000000001, -5.999999999999999, -10.7, -18.3, -10.799999999999999, -8.8, -7.3, -16.7, -11.3, -5.4, -7.8, -21.3, -6.300000000000001, -9.4, -6.2, -13.3, -76.3, -19.799999999999997, -8.099999999999998, -6.2, -17.3, -11.3, -18.6, -9.9, -8.3, -15.299999999999997, -19.600000000000005, -5.2, -15.2, -15.5, -11.2, -16.599999999999998, -6.300000000000001, -17.0, -7.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.099836406879796, "mean_inference_ms": 1.4152216011486263, "mean_action_processing_ms": 0.07832844316239015, "mean_env_wait_ms": 12.49926272958925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1268000, "timesteps_this_iter": 0, "agent_timesteps_total": 1268000, "timers": {"sample_time_ms": 52160.563, "sample_throughput": 76.686, "load_time_ms": 1.193, "load_throughput": 3353230.068, "learn_time_ms": 32065.426, "learn_throughput": 124.745, "update_time_ms": 5.206}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.30095556650450955, "policy_loss": -0.013714005735011832, "vf_loss": 31.464081198425703, "vf_explained_var": 0.28108899734353504, "kl": 0.01816700807324699, "entropy": 0.2287754401965167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1268000, "num_agent_steps_sampled": 1268000, "num_steps_trained": 1268000, "num_agent_steps_trained": 1268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12680, "training_iteration": 317, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-01-31_23-50-38", "timestamp": 1643673038, "time_this_iter_s": 112.89527893066406, "time_total_s": 7708.314326763153, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7708.314326763153, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 35.58979591836735, "ram_util_percent": 71.83265306122449}}
{"episode_reward_max": -4.2, "episode_reward_min": -76.3, "episode_reward_mean": -13.173999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.2, -11.5, -8.4, -10.899999999999999, -8.0, -8.2, -6.2, -12.5, -24.0, -8.3, -16.3, -17.2, -15.7, -10.3, -15.199999999999996, -7.3, -11.9, -47.2, -12.799999999999999, -6.3, -5.3, -13.3, -8.3, -5.4, -36.3, -6.300000000000001, -5.999999999999999, -10.7, -18.3, -10.799999999999999, -8.8, -7.3, -16.7, -11.3, -5.4, -7.8, -21.3, -6.300000000000001, -9.4, -6.2, -13.3, -76.3, -19.799999999999997, -8.099999999999998, -6.2, -17.3, -11.3, -18.6, -9.9, -8.3, -15.299999999999997, -19.600000000000005, -5.2, -15.2, -15.5, -11.2, -16.599999999999998, -6.300000000000001, -17.0, -7.300000000000001, -11.299999999999997, -4.2, -12.3, -4.3, -12.599999999999998, -5.300000000000001, -23.800000000000004, -5.4, -9.699999999999998, -13.29999999999998, -23.599999999999955, -6.3, -19.100000000000005, -42.29999999999992, -9.399999999999999, -14.099999999999998, -9.299999999999999, -5.700000000000001, -14.3, -11.999999999999977, -32.5, -15.9, -8.3, -26.7, -5.2, -6.1, -6.499999999999999, -23.599999999999987, -5.3, -12.3, -6.2, -16.999999999999996, -15.399999999999991, -6.799999999999999, -12.999999999999998, -5.2, -7.099999999999999, -5.300000000000001, -17.599999999999998, -12.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1041607944717695, "mean_inference_ms": 1.42057520083804, "mean_action_processing_ms": 0.07863817445150742, "mean_env_wait_ms": 12.526343033367162, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1272000, "timesteps_this_iter": 0, "agent_timesteps_total": 1272000, "timers": {"sample_time_ms": 49611.259, "sample_throughput": 80.627, "load_time_ms": 1.189, "load_throughput": 3364190.094, "learn_time_ms": 97113.961, "learn_throughput": 41.189, "update_time_ms": 5.067}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.16007423406386728, "policy_loss": -0.005926096112397249, "vf_loss": 16.59857240184661, "vf_explained_var": 0.23173008920044028, "kl": 0.009225005317039275, "entropy": 0.2639583103599087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1272000, "num_agent_steps_sampled": 1272000, "num_steps_trained": 1272000, "num_agent_steps_trained": 1272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12720, "training_iteration": 318, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-02-15", "timestamp": 1643673735, "time_this_iter_s": 697.2335088253021, "time_total_s": 8405.547835588455, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8405.547835588455, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 32.878461538461536, "ram_util_percent": 72.0953846153846}}
{"episode_reward_max": -3.3, "episode_reward_min": -76.3, "episode_reward_mean": -13.247999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.3, -76.3, -19.799999999999997, -8.099999999999998, -6.2, -17.3, -11.3, -18.6, -9.9, -8.3, -15.299999999999997, -19.600000000000005, -5.2, -15.2, -15.5, -11.2, -16.599999999999998, -6.300000000000001, -17.0, -7.300000000000001, -11.299999999999997, -4.2, -12.3, -4.3, -12.599999999999998, -5.300000000000001, -23.800000000000004, -5.4, -9.699999999999998, -13.29999999999998, -23.599999999999955, -6.3, -19.100000000000005, -42.29999999999992, -9.399999999999999, -14.099999999999998, -9.299999999999999, -5.700000000000001, -14.3, -11.999999999999977, -32.5, -15.9, -8.3, -26.7, -5.2, -6.1, -6.499999999999999, -23.599999999999987, -5.3, -12.3, -6.2, -16.999999999999996, -15.399999999999991, -6.799999999999999, -12.999999999999998, -5.2, -7.099999999999999, -5.300000000000001, -17.599999999999998, -12.199999999999998, -29.3, -4.3, -11.199999999999994, -38.2, -5.9, -4.2, -23.100000000000005, -12.2, -4.3, -11.599999999999998, -9.9, -7.2, -28.000000000000007, -14.599999999999998, -14.29999999999998, -3.6000000000000005, -40.10000000000001, -3.3, -20.0, -9.499999999999996, -4.300000000000001, -10.599999999999998, -6.1, -8.499999999999996, -4.2, -4.2, -6.499999999999999, -3.6000000000000005, -14.499999999999998, -19.799999999999997, -9.3, -21.6, -6.2, -4.4, -14.2, -12.7, -19.099999999999998, -8.2, -10.399999999999999, -16.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1067400564722532, "mean_inference_ms": 1.4238268199645936, "mean_action_processing_ms": 0.07882439878611734, "mean_env_wait_ms": 12.525633459074779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1276000, "timesteps_this_iter": 0, "agent_timesteps_total": 1276000, "timers": {"sample_time_ms": 48005.569, "sample_throughput": 83.324, "load_time_ms": 1.304, "load_throughput": 3067188.797, "learn_time_ms": 97218.544, "learn_throughput": 41.144, "update_time_ms": 5.095}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.16547975925883898, "policy_loss": -0.0122091840304214, "vf_loss": 17.767256122378893, "vf_explained_var": 0.048311452711782145, "kl": 0.010345632987108238, "entropy": 0.23530425232664873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1276000, "num_agent_steps_sampled": 1276000, "num_steps_trained": 1276000, "num_agent_steps_trained": 1276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12760, "training_iteration": 319, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-02-53", "timestamp": 1643673773, "time_this_iter_s": 37.750216007232666, "time_total_s": 8443.298051595688, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8443.298051595688, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 31.194339622641504, "ram_util_percent": 72.16981132075473}}
{"episode_reward_max": -3.2, "episode_reward_min": -40.10000000000001, "episode_reward_mean": -12.174999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.5, -15.9, -8.3, -26.7, -5.2, -6.1, -6.499999999999999, -23.599999999999987, -5.3, -12.3, -6.2, -16.999999999999996, -15.399999999999991, -6.799999999999999, -12.999999999999998, -5.2, -7.099999999999999, -5.300000000000001, -17.599999999999998, -12.199999999999998, -29.3, -4.3, -11.199999999999994, -38.2, -5.9, -4.2, -23.100000000000005, -12.2, -4.3, -11.599999999999998, -9.9, -7.2, -28.000000000000007, -14.599999999999998, -14.29999999999998, -3.6000000000000005, -40.10000000000001, -3.3, -20.0, -9.499999999999996, -4.300000000000001, -10.599999999999998, -6.1, -8.499999999999996, -4.2, -4.2, -6.499999999999999, -3.6000000000000005, -14.499999999999998, -19.799999999999997, -9.3, -21.6, -6.2, -4.4, -14.2, -12.7, -19.099999999999998, -8.2, -10.399999999999999, -16.799999999999997, -4.700000000000001, -7.3, -13.099999999999994, -3.2, -8.3, -15.899999999999999, -26.900000000000013, -12.2, -8.299999999999999, -6.4, -12.199999999999992, -12.29999999999998, -9.2, -21.200000000000003, -18.100000000000005, -10.799999999999997, -13.299999999999999, -13.3, -9.3, -32.0, -7.2, -5.300000000000001, -19.6, -7.6999999999999975, -9.2, -8.399999999999999, -7.2, -19.799999999999997, -14.2, -7.300000000000001, -11.599999999999998, -3.2, -12.199999999999998, -9.2, -10.2, -16.4, -16.6, -8.4, -7.300000000000001, -10.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1082263946354791, "mean_inference_ms": 1.4267217546411763, "mean_action_processing_ms": 0.0789808960707032, "mean_env_wait_ms": 13.660876306414748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1280000, "timesteps_this_iter": 0, "agent_timesteps_total": 1280000, "timers": {"sample_time_ms": 47566.538, "sample_throughput": 84.093, "load_time_ms": 1.211, "load_throughput": 3303186.785, "learn_time_ms": 95261.35, "learn_throughput": 41.99, "update_time_ms": 4.775}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001583817601203918, "cur_lr": 0.00010000000000000003, "total_loss": 0.09731572376443974, "policy_loss": -0.01756523354279418, "vf_loss": 11.484136789973064, "vf_explained_var": 0.29184966837206194, "kl": 0.024998206394473216, "entropy": 0.2553370698966006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1280000, "num_agent_steps_sampled": 1280000, "num_steps_trained": 1280000, "num_agent_steps_trained": 1280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12800, "training_iteration": 320, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-18-31", "timestamp": 1643674711, "time_this_iter_s": 937.8991749286652, "time_total_s": 9381.197226524353, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9381.197226524353, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 53.77692307692307, "ram_util_percent": 72.86923076923075}}
{"episode_reward_max": -3.2, "episode_reward_min": -50.2, "episode_reward_mean": -12.41, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -10.599999999999998, -6.1, -8.499999999999996, -4.2, -4.2, -6.499999999999999, -3.6000000000000005, -14.499999999999998, -19.799999999999997, -9.3, -21.6, -6.2, -4.4, -14.2, -12.7, -19.099999999999998, -8.2, -10.399999999999999, -16.799999999999997, -4.700000000000001, -7.3, -13.099999999999994, -3.2, -8.3, -15.899999999999999, -26.900000000000013, -12.2, -8.299999999999999, -6.4, -12.199999999999992, -12.29999999999998, -9.2, -21.200000000000003, -18.100000000000005, -10.799999999999997, -13.299999999999999, -13.3, -9.3, -32.0, -7.2, -5.300000000000001, -19.6, -7.6999999999999975, -9.2, -8.399999999999999, -7.2, -19.799999999999997, -14.2, -7.300000000000001, -11.599999999999998, -3.2, -12.199999999999998, -9.2, -10.2, -16.4, -16.6, -8.4, -7.300000000000001, -10.3, -8.3, -48.100000000000065, -21.09999999999999, -3.3, -7.3, -16.9, -9.0, -50.2, -7.699999999999998, -7.2, -22.799999999999997, -11.5, -13.899999999999975, -7.3, -25.099999999999998, -43.2, -11.5, -17.199999999999996, -4.2, -7.3, -27.3, -6.499999999999999, -16.799999999999997, -7.5, -7.299999999999999, -18.4, -6.2, -8.699999999999998, -12.2, -5.4, -7.3, -14.6, -4.2, -5.3, -7.5, -8.3, -19.000000000000007, -6.4, -29.3, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.109156293786824, "mean_inference_ms": 1.4285143920797316, "mean_action_processing_ms": 0.07907577515066803, "mean_env_wait_ms": 14.786807887759158, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1284000, "timesteps_this_iter": 0, "agent_timesteps_total": 1284000, "timers": {"sample_time_ms": 43875.782, "sample_throughput": 91.166, "load_time_ms": 1.116, "load_throughput": 3584415.673, "learn_time_ms": 93248.812, "learn_throughput": 42.896, "update_time_ms": 4.406}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.3241363462944445, "policy_loss": -0.012753749787632216, "vf_loss": 33.68531248454125, "vf_explained_var": 0.0673293157931297, "kl": 0.015563740923140734, "entropy": 0.2297824906886265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1284000, "num_agent_steps_sampled": 1284000, "num_steps_trained": 1284000, "num_agent_steps_trained": 1284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12840, "training_iteration": 321, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-18-46", "timestamp": 1643674726, "time_this_iter_s": 14.979304790496826, "time_total_s": 9396.17653131485, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9396.17653131485, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 32.8952380952381, "ram_util_percent": 71.99047619047619}}
{"episode_reward_max": -3.2, "episode_reward_min": -121.5, "episode_reward_mean": -13.704, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -5.300000000000001, -19.6, -7.6999999999999975, -9.2, -8.399999999999999, -7.2, -19.799999999999997, -14.2, -7.300000000000001, -11.599999999999998, -3.2, -12.199999999999998, -9.2, -10.2, -16.4, -16.6, -8.4, -7.300000000000001, -10.3, -8.3, -48.100000000000065, -21.09999999999999, -3.3, -7.3, -16.9, -9.0, -50.2, -7.699999999999998, -7.2, -22.799999999999997, -11.5, -13.899999999999975, -7.3, -25.099999999999998, -43.2, -11.5, -17.199999999999996, -4.2, -7.3, -27.3, -6.499999999999999, -16.799999999999997, -7.5, -7.299999999999999, -18.4, -6.2, -8.699999999999998, -12.2, -5.4, -7.3, -14.6, -4.2, -5.3, -7.5, -8.3, -19.000000000000007, -6.4, -29.3, -5.2, -12.899999999999997, -13.1, -7.6, -8.399999999999999, -21.10000000000001, -6.3, -4.3, -19.200000000000003, -6.4, -3.2, -12.499999999999998, -14.8, -13.2, -3.2, -8.399999999999999, -121.5, -14.8, -4.2, -8.3, -19.3, -34.699999999999946, -5.2, -25.400000000000013, -3.2, -15.399999999999975, -30.300000000000036, -5.3, -8.899999999999999, -4.699999999999999, -18.2, -34.2, -3.3, -9.100000000000001, -8.3, -5.2, -7.3, -12.3, -15.3, -17.4, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1093520636075294, "mean_inference_ms": 1.428811126743077, "mean_action_processing_ms": 0.07909353277402614, "mean_env_wait_ms": 15.333184744826417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1288000, "timesteps_this_iter": 0, "agent_timesteps_total": 1288000, "timers": {"sample_time_ms": 39864.287, "sample_throughput": 100.34, "load_time_ms": 1.028, "load_throughput": 3892444.898, "learn_time_ms": 91272.726, "learn_throughput": 43.825, "update_time_ms": 4.089}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.7734779748414713, "policy_loss": -0.01021209107611769, "vf_loss": 78.36568098068237, "vf_explained_var": 0.0011052695653771842, "kl": 0.014006415277618242, "entropy": 0.22927283496465733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1288000, "num_agent_steps_sampled": 1288000, "num_steps_trained": 1288000, "num_agent_steps_trained": 1288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12880, "training_iteration": 322, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-19-00", "timestamp": 1643674740, "time_this_iter_s": 14.062782049179077, "time_total_s": 9410.239313364029, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9410.239313364029, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 30.04, "ram_util_percent": 71.52000000000001}}
{"episode_reward_max": -1.3, "episode_reward_min": -121.5, "episode_reward_mean": -12.759999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.3, -6.499999999999999, -16.799999999999997, -7.5, -7.299999999999999, -18.4, -6.2, -8.699999999999998, -12.2, -5.4, -7.3, -14.6, -4.2, -5.3, -7.5, -8.3, -19.000000000000007, -6.4, -29.3, -5.2, -12.899999999999997, -13.1, -7.6, -8.399999999999999, -21.10000000000001, -6.3, -4.3, -19.200000000000003, -6.4, -3.2, -12.499999999999998, -14.8, -13.2, -3.2, -8.399999999999999, -121.5, -14.8, -4.2, -8.3, -19.3, -34.699999999999946, -5.2, -25.400000000000013, -3.2, -15.399999999999975, -30.300000000000036, -5.3, -8.899999999999999, -4.699999999999999, -18.2, -34.2, -3.3, -9.100000000000001, -8.3, -5.2, -7.3, -12.3, -15.3, -17.4, -6.2, -17.199999999999996, -32.30000000000003, -13.5, -3.3, -19.7, -5.300000000000001, -14.2, -6.699999999999999, -4.800000000000001, -18.70000000000001, -1.3, -7.699999999999999, -6.0, -55.79999999999997, -21.100000000000005, -8.8, -18.400000000000002, -4.5, -13.4, -3.3, -16.2, -3.2, -18.4, -22.60000000000001, -11.3, -4.2, -4.9, -4.2, -5.3, -5.2, -4.2, -14.299999999999995, -8.2, -21.799999999999997, -15.0, -10.599999999999998, -2.2, -4.3, -3.3, -4.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1088065139194467, "mean_inference_ms": 1.4279475043463201, "mean_action_processing_ms": 0.07904592016214823, "mean_env_wait_ms": 15.301878308532771, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1292000, "timesteps_this_iter": 0, "agent_timesteps_total": 1292000, "timers": {"sample_time_ms": 35973.874, "sample_throughput": 111.192, "load_time_ms": 0.938, "load_throughput": 4265538.493, "learn_time_ms": 89259.612, "learn_throughput": 44.813, "update_time_ms": 3.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.25387136218718864, "policy_loss": -0.003788846737695157, "vf_loss": 25.76281240717057, "vf_explained_var": -0.05423070999883836, "kl": 0.01350805780771747, "entropy": 0.25372377479428887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1292000, "num_agent_steps_sampled": 1292000, "num_steps_trained": 1292000, "num_agent_steps_trained": 1292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12920, "training_iteration": 323, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-19-13", "timestamp": 1643674753, "time_this_iter_s": 13.449378967285156, "time_total_s": 9423.688692331314, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9423.688692331314, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 34.810526315789474, "ram_util_percent": 71.94210526315791}}
{"episode_reward_max": -1.3, "episode_reward_min": -55.79999999999997, "episode_reward_mean": -12.252, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.699999999999946, -5.2, -25.400000000000013, -3.2, -15.399999999999975, -30.300000000000036, -5.3, -8.899999999999999, -4.699999999999999, -18.2, -34.2, -3.3, -9.100000000000001, -8.3, -5.2, -7.3, -12.3, -15.3, -17.4, -6.2, -17.199999999999996, -32.30000000000003, -13.5, -3.3, -19.7, -5.300000000000001, -14.2, -6.699999999999999, -4.800000000000001, -18.70000000000001, -1.3, -7.699999999999999, -6.0, -55.79999999999997, -21.100000000000005, -8.8, -18.400000000000002, -4.5, -13.4, -3.3, -16.2, -3.2, -18.4, -22.60000000000001, -11.3, -4.2, -4.9, -4.2, -5.3, -5.2, -4.2, -14.299999999999995, -8.2, -21.799999999999997, -15.0, -10.599999999999998, -2.2, -4.3, -3.3, -4.6000000000000005, -8.599999999999998, -3.3, -19.3, -4.4, -15.2, -3.3000000000000003, -5.4, -20.9, -4.2, -21.7, -11.799999999999999, -17.1, -3.6000000000000005, -7.499999999999998, -18.499999999999996, -11.099999999999996, -8.3, -5.2, -8.3, -17.900000000000006, -5.2, -6.300000000000001, -11.3, -16.199999999999996, -16.6, -6.699999999999999, -30.3, -15.999999999999998, -4.300000000000001, -15.9, -20.8, -19.2, -13.3, -48.2, -5.2, -16.499999999999982, -5.2, -5.300000000000001, -13.0, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.108111182086974, "mean_inference_ms": 1.4270498868627175, "mean_action_processing_ms": 0.07899646073109885, "mean_env_wait_ms": 15.270570911743134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1296000, "timesteps_this_iter": 0, "agent_timesteps_total": 1296000, "timers": {"sample_time_ms": 32064.821, "sample_throughput": 124.747, "load_time_ms": 0.821, "load_throughput": 4871857.595, "learn_time_ms": 87366.956, "learn_throughput": 45.784, "update_time_ms": 3.4}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.20331997100303892, "policy_loss": -0.017640625544252896, "vf_loss": 22.092456513835536, "vf_explained_var": 0.0642015246293878, "kl": 0.01516915718510069, "entropy": 0.24858264195662672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1296000, "num_agent_steps_sampled": 1296000, "num_steps_trained": 1296000, "num_agent_steps_trained": 1296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 12960, "training_iteration": 324, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-19-28", "timestamp": 1643674768, "time_this_iter_s": 14.981136798858643, "time_total_s": 9438.669829130173, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9438.669829130173, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 40.518181818181816, "ram_util_percent": 72.12727272727271}}
{"episode_reward_max": -2.2, "episode_reward_min": -48.2, "episode_reward_mean": -11.984000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.2, -3.2, -18.4, -22.60000000000001, -11.3, -4.2, -4.9, -4.2, -5.3, -5.2, -4.2, -14.299999999999995, -8.2, -21.799999999999997, -15.0, -10.599999999999998, -2.2, -4.3, -3.3, -4.6000000000000005, -8.599999999999998, -3.3, -19.3, -4.4, -15.2, -3.3000000000000003, -5.4, -20.9, -4.2, -21.7, -11.799999999999999, -17.1, -3.6000000000000005, -7.499999999999998, -18.499999999999996, -11.099999999999996, -8.3, -5.2, -8.3, -17.900000000000006, -5.2, -6.300000000000001, -11.3, -16.199999999999996, -16.6, -6.699999999999999, -30.3, -15.999999999999998, -4.300000000000001, -15.9, -20.8, -19.2, -13.3, -48.2, -5.2, -16.499999999999982, -5.2, -5.300000000000001, -13.0, -4.2, -13.6, -8.9, -3.3, -17.099999999999998, -18.7, -10.5, -4.300000000000001, -33.3, -11.999999999999996, -8.3, -10.2, -18.699999999999996, -4.4, -9.2, -6.2, -13.399999999999999, -4.800000000000001, -46.2, -16.6, -19.9, -8.2, -6.300000000000001, -11.3, -6.1, -4.3, -16.699999999999996, -5.3, -23.200000000000014, -5.799999999999999, -10.3, -5.1, -43.3, -8.499999999999991, -8.6, -5.8, -3.3, -21.2, -10.799999999999999, -10.2, -25.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1075596006481216, "mean_inference_ms": 1.4264244854140191, "mean_action_processing_ms": 0.07896235067331753, "mean_env_wait_ms": 15.240657924225115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1300000, "timesteps_this_iter": 0, "agent_timesteps_total": 1300000, "timers": {"sample_time_ms": 28429.527, "sample_throughput": 140.699, "load_time_ms": 0.727, "load_throughput": 5505419.702, "learn_time_ms": 84693.456, "learn_throughput": 47.229, "update_time_ms": 2.329}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.26420216981674577, "policy_loss": -0.014175702293994286, "vf_loss": 27.834216799787296, "vf_explained_var": 0.10830417544611039, "kl": 0.015031403930678106, "entropy": 0.26107063967213834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1300000, "num_agent_steps_sampled": 1300000, "num_steps_trained": 1300000, "num_agent_steps_trained": 1300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13000, "training_iteration": 325, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-19-44", "timestamp": 1643674784, "time_this_iter_s": 15.81559705734253, "time_total_s": 9454.485426187515, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9454.485426187515, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 45.04090909090909, "ram_util_percent": 72.36818181818184}}
{"episode_reward_max": -3.2, "episode_reward_min": -48.2, "episode_reward_mean": -12.346999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -6.300000000000001, -11.3, -16.199999999999996, -16.6, -6.699999999999999, -30.3, -15.999999999999998, -4.300000000000001, -15.9, -20.8, -19.2, -13.3, -48.2, -5.2, -16.499999999999982, -5.2, -5.300000000000001, -13.0, -4.2, -13.6, -8.9, -3.3, -17.099999999999998, -18.7, -10.5, -4.300000000000001, -33.3, -11.999999999999996, -8.3, -10.2, -18.699999999999996, -4.4, -9.2, -6.2, -13.399999999999999, -4.800000000000001, -46.2, -16.6, -19.9, -8.2, -6.300000000000001, -11.3, -6.1, -4.3, -16.699999999999996, -5.3, -23.200000000000014, -5.799999999999999, -10.3, -5.1, -43.3, -8.499999999999991, -8.6, -5.8, -3.3, -21.2, -10.799999999999999, -10.2, -25.2, -6.300000000000001, -9.1, -17.4, -7.4, -5.2, -4.3, -25.7, -18.199999999999985, -10.2, -4.2, -5.799999999999999, -5.3, -5.2, -14.799999999999999, -10.099999999999996, -18.7, -3.900000000000001, -10.3, -15.899999999999997, -20.5, -5.300000000000001, -19.7, -3.2, -25.900000000000038, -16.6, -4.2, -11.6, -6.300000000000001, -3.4, -5.300000000000001, -19.200000000000003, -4.2, -26.3, -10.2, -7.6000000000000005, -4.3, -11.1, -3.2, -16.499999999999982, -13.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.107113689113004, "mean_inference_ms": 1.425957777602022, "mean_action_processing_ms": 0.07893801493178274, "mean_env_wait_ms": 15.211695239804623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1304000, "timesteps_this_iter": 0, "agent_timesteps_total": 1304000, "timers": {"sample_time_ms": 24595.264, "sample_throughput": 162.633, "load_time_ms": 0.727, "load_throughput": 5498563.188, "learn_time_ms": 83797.543, "learn_throughput": 47.734, "update_time_ms": 1.928}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.10402738990322236, "policy_loss": -0.01707951850708454, "vf_loss": 12.107204075205711, "vf_explained_var": 0.0808280050754547, "kl": 0.014677463458561444, "entropy": 0.22953817501503934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1304000, "num_agent_steps_sampled": 1304000, "num_steps_trained": 1304000, "num_agent_steps_trained": 1304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13040, "training_iteration": 326, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-20-00", "timestamp": 1643674800, "time_this_iter_s": 15.50005292892456, "time_total_s": 9469.98547911644, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9469.98547911644, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 44.24999999999999, "ram_util_percent": 72.46818181818182}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.3, "episode_reward_mean": -11.017999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -6.300000000000001, -11.3, -6.1, -4.3, -16.699999999999996, -5.3, -23.200000000000014, -5.799999999999999, -10.3, -5.1, -43.3, -8.499999999999991, -8.6, -5.8, -3.3, -21.2, -10.799999999999999, -10.2, -25.2, -6.300000000000001, -9.1, -17.4, -7.4, -5.2, -4.3, -25.7, -18.199999999999985, -10.2, -4.2, -5.799999999999999, -5.3, -5.2, -14.799999999999999, -10.099999999999996, -18.7, -3.900000000000001, -10.3, -15.899999999999997, -20.5, -5.300000000000001, -19.7, -3.2, -25.900000000000038, -16.6, -4.2, -11.6, -6.300000000000001, -3.4, -5.300000000000001, -19.200000000000003, -4.2, -26.3, -10.2, -7.6000000000000005, -4.3, -11.1, -3.2, -16.499999999999982, -13.3, -14.699999999999994, -10.3, -15.099999999999998, -10.3, -6.1, -10.3, -16.599999999999998, -11.999999999999995, -7.000000000000001, -7.2, -4.2, -10.3, -4.300000000000001, -14.6, -4.3, -3.3, -14.699999999999974, -5.300000000000001, -15.999999999999998, -9.6, -12.999999999999998, -15.199999999999998, -11.399999999999999, -10.7, -11.700000000000001, -11.7, -6.1, -23.39999999999999, -3.6, -4.4, -3.6000000000000005, -4.3, -10.1, -13.999999999999998, -3.3, -13.999999999999998, -24.100000000000005, -3.3, -24.00000000000001, -18.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1066499273591537, "mean_inference_ms": 1.4254639209255147, "mean_action_processing_ms": 0.07891412935076417, "mean_env_wait_ms": 15.18279549426225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1308000, "timesteps_this_iter": 0, "agent_timesteps_total": 1308000, "timers": {"sample_time_ms": 21827.374, "sample_throughput": 183.256, "load_time_ms": 0.635, "load_throughput": 6301775.157, "learn_time_ms": 75875.673, "learn_throughput": 52.718, "update_time_ms": 2.512}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.05491727354225292, "policy_loss": -0.01560282923020823, "vf_loss": 7.0499307021018, "vf_explained_var": 0.28241900949067966, "kl": 0.008754206225784657, "entropy": 0.22809625857619828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1308000, "num_agent_steps_sampled": 1308000, "num_steps_trained": 1308000, "num_agent_steps_trained": 1308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13080, "training_iteration": 327, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-20-15", "timestamp": 1643674815, "time_this_iter_s": 15.032426834106445, "time_total_s": 9485.017905950546, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9485.017905950546, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 40.96666666666666, "ram_util_percent": 72.34761904761906}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.6, "episode_reward_mean": -12.185, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -19.7, -3.2, -25.900000000000038, -16.6, -4.2, -11.6, -6.300000000000001, -3.4, -5.300000000000001, -19.200000000000003, -4.2, -26.3, -10.2, -7.6000000000000005, -4.3, -11.1, -3.2, -16.499999999999982, -13.3, -14.699999999999994, -10.3, -15.099999999999998, -10.3, -6.1, -10.3, -16.599999999999998, -11.999999999999995, -7.000000000000001, -7.2, -4.2, -10.3, -4.300000000000001, -14.6, -4.3, -3.3, -14.699999999999974, -5.300000000000001, -15.999999999999998, -9.6, -12.999999999999998, -15.199999999999998, -11.399999999999999, -10.7, -11.700000000000001, -11.7, -6.1, -23.39999999999999, -3.6, -4.4, -3.6000000000000005, -4.3, -10.1, -13.999999999999998, -3.3, -13.999999999999998, -24.100000000000005, -3.3, -24.00000000000001, -18.3, -11.799999999999997, -12.599999999999998, -13.600000000000001, -14.199999999999998, -4.800000000000001, -12.5, -13.899999999999999, -8.2, -7.300000000000001, -19.2, -5.3, -8.2, -20.3, -27.099999999999955, -18.000000000000004, -16.89999999999997, -33.6, -20.300000000000004, -22.599999999999998, -10.1, -24.6, -17.0, -13.3, -7.300000000000001, -28.300000000000026, -11.2, -8.2, -14.5, -21.40000000000003, -15.0, -12.799999999999999, -13.19999999999999, -4.2, -5.300000000000001, -24.2, -5.2, -13.2, -10.2, -14.299999999999974, -10.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1060727921608775, "mean_inference_ms": 1.4247883303218902, "mean_action_processing_ms": 0.07887926488861344, "mean_env_wait_ms": 15.153161142711467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1312000, "timesteps_this_iter": 0, "agent_timesteps_total": 1312000, "timers": {"sample_time_ms": 20450.453, "sample_throughput": 195.595, "load_time_ms": 0.544, "load_throughput": 7354879.663, "learn_time_ms": 8795.094, "learn_throughput": 454.799, "update_time_ms": 2.34}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.1116089322514111, "policy_loss": -0.0054464577521968595, "vf_loss": 11.702982252259408, "vf_explained_var": 0.27350590799444463, "kl": 0.01076181545679377, "entropy": 0.2300487921042468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1312000, "num_agent_steps_sampled": 1312000, "num_steps_trained": 1312000, "num_agent_steps_trained": 1312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13120, "training_iteration": 328, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-20-29", "timestamp": 1643674829, "time_this_iter_s": 14.145080089569092, "time_total_s": 9499.162986040115, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9499.162986040115, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 28.835, "ram_util_percent": 72.61}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.6, "episode_reward_mean": -12.975999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.999999999999998, -15.199999999999998, -11.399999999999999, -10.7, -11.700000000000001, -11.7, -6.1, -23.39999999999999, -3.6, -4.4, -3.6000000000000005, -4.3, -10.1, -13.999999999999998, -3.3, -13.999999999999998, -24.100000000000005, -3.3, -24.00000000000001, -18.3, -11.799999999999997, -12.599999999999998, -13.600000000000001, -14.199999999999998, -4.800000000000001, -12.5, -13.899999999999999, -8.2, -7.300000000000001, -19.2, -5.3, -8.2, -20.3, -27.099999999999955, -18.000000000000004, -16.89999999999997, -33.6, -20.300000000000004, -22.599999999999998, -10.1, -24.6, -17.0, -13.3, -7.300000000000001, -28.300000000000026, -11.2, -8.2, -14.5, -21.40000000000003, -15.0, -12.799999999999999, -13.19999999999999, -4.2, -5.300000000000001, -24.2, -5.2, -13.2, -10.2, -14.299999999999974, -10.799999999999999, -16.5, -12.4, -10.8, -5.2, -22.6, -21.500000000000004, -11.29999999999999, -25.70000000000004, -28.4, -3.2, -9.7, -14.999999999999998, -8.599999999999998, -5.2, -15.299999999999997, -4.2, -20.200000000000003, -19.5, -16.1, -5.300000000000001, -19.4, -3.4, -18.7, -8.7, -4.3, -5.799999999999999, -13.100000000000001, -8.2, -15.199999999999998, -5.1, -5.9, -8.999999999999996, -14.099999999999971, -10.799999999999997, -12.499999999999977, -11.299999999999981, -9.2, -20.200000000000006, -4.3, -16.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.105373284164622, "mean_inference_ms": 1.4239033654321966, "mean_action_processing_ms": 0.07883140366741452, "mean_env_wait_ms": 15.122911657015324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1316000, "timesteps_this_iter": 0, "agent_timesteps_total": 1316000, "timers": {"sample_time_ms": 18094.992, "sample_throughput": 221.056, "load_time_ms": 0.34, "load_throughput": 11752865.849, "learn_time_ms": 6687.103, "learn_throughput": 598.166, "update_time_ms": 2.006}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.10585851933787106, "policy_loss": -0.008484237625574072, "vf_loss": 11.429718130891041, "vf_explained_var": 0.17627382002851014, "kl": 0.019185507647237983, "entropy": 0.2357786378472723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1316000, "num_agent_steps_sampled": 1316000, "num_steps_trained": 1316000, "num_agent_steps_trained": 1316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13160, "training_iteration": 329, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-20-43", "timestamp": 1643674843, "time_this_iter_s": 13.565786838531494, "time_total_s": 9512.728772878647, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9512.728772878647, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 23.860000000000003, "ram_util_percent": 72.59999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -28.4, "episode_reward_mean": -12.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.6, -17.0, -13.3, -7.300000000000001, -28.300000000000026, -11.2, -8.2, -14.5, -21.40000000000003, -15.0, -12.799999999999999, -13.19999999999999, -4.2, -5.300000000000001, -24.2, -5.2, -13.2, -10.2, -14.299999999999974, -10.799999999999999, -16.5, -12.4, -10.8, -5.2, -22.6, -21.500000000000004, -11.29999999999999, -25.70000000000004, -28.4, -3.2, -9.7, -14.999999999999998, -8.599999999999998, -5.2, -15.299999999999997, -4.2, -20.200000000000003, -19.5, -16.1, -5.300000000000001, -19.4, -3.4, -18.7, -8.7, -4.3, -5.799999999999999, -13.100000000000001, -8.2, -15.199999999999998, -5.1, -5.9, -8.999999999999996, -14.099999999999971, -10.799999999999997, -12.499999999999977, -11.299999999999981, -9.2, -20.200000000000006, -4.3, -16.799999999999997, -5.3, -6.300000000000001, -9.2, -4.2, -15.2, -20.799999999999997, -4.2, -14.2, -7.4, -7.4, -21.20000000000001, -4.2, -17.3, -9.2, -16.999999999999996, -11.899999999999999, -10.899999999999999, -17.2, -11.599999999999994, -3.3, -19.20000000000003, -15.5, -3.2, -4.300000000000001, -4.300000000000001, -10.2, -8.3, -9.199999999999998, -16.9, -24.400000000000002, -13.3, -3.3, -20.9, -4.3, -11.999999999999995, -9.600000000000001, -4.300000000000001, -7.999999999999995, -19.599999999999998, -21.299999999999955], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1047342973340475, "mean_inference_ms": 1.4663465617516465, "mean_action_processing_ms": 0.07877548267439315, "mean_env_wait_ms": 15.135920825483595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1320000, "timesteps_this_iter": 0, "agent_timesteps_total": 1320000, "timers": {"sample_time_ms": 14769.425, "sample_throughput": 270.83, "load_time_ms": 0.346, "load_throughput": 11576082.247, "learn_time_ms": 7639.75, "learn_throughput": 523.577, "update_time_ms": 2.324}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.07788998740675149, "policy_loss": -0.008755060801062212, "vf_loss": 8.662292903277182, "vf_explained_var": 0.3671768303840391, "kl": 0.009311863345485267, "entropy": 0.21263362005833655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1320000, "num_agent_steps_sampled": 1320000, "num_steps_trained": 1320000, "num_agent_steps_trained": 1320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13200, "training_iteration": 330, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-22-18", "timestamp": 1643674938, "time_this_iter_s": 95.85328984260559, "time_total_s": 9608.582062721252, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9608.582062721252, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 29.64117647058824, "ram_util_percent": 72.84411764705882}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.89999999999995, "episode_reward_mean": -11.045999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.4, -3.4, -18.7, -8.7, -4.3, -5.799999999999999, -13.100000000000001, -8.2, -15.199999999999998, -5.1, -5.9, -8.999999999999996, -14.099999999999971, -10.799999999999997, -12.499999999999977, -11.299999999999981, -9.2, -20.200000000000006, -4.3, -16.799999999999997, -5.3, -6.300000000000001, -9.2, -4.2, -15.2, -20.799999999999997, -4.2, -14.2, -7.4, -7.4, -21.20000000000001, -4.2, -17.3, -9.2, -16.999999999999996, -11.899999999999999, -10.899999999999999, -17.2, -11.599999999999994, -3.3, -19.20000000000003, -15.5, -3.2, -4.300000000000001, -4.300000000000001, -10.2, -8.3, -9.199999999999998, -16.9, -24.400000000000002, -13.3, -3.3, -20.9, -4.3, -11.999999999999995, -9.600000000000001, -4.300000000000001, -7.999999999999995, -19.599999999999998, -21.299999999999955, -4.3, -4.300000000000001, -9.5, -33.89999999999995, -11.1, -8.2, -3.4, -8.6, -12.0, -12.7, -17.900000000000006, -8.5, -10.5, -5.300000000000001, -4.2, -13.399999999999999, -10.3, -7.3, -7.6000000000000005, -12.7, -22.1, -20.3, -13.299999999999978, -3.2, -15.799999999999997, -14.899999999999999, -4.2, -6.3, -5.800000000000001, -6.3, -18.199999999999996, -10.999999999999996, -5.300000000000001, -20.2, -4.3, -4.2, -12.3, -18.299999999999997, -8.1, -18.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6127265068242895, "mean_inference_ms": 1.5117855173226586, "mean_action_processing_ms": 0.07889767378651082, "mean_env_wait_ms": 15.165855160204863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1324000, "timesteps_this_iter": 0, "agent_timesteps_total": 1324000, "timers": {"sample_time_ms": 17716.321, "sample_throughput": 225.781, "load_time_ms": 0.376, "load_throughput": 10627908.273, "learn_time_ms": 7728.836, "learn_throughput": 517.542, "update_time_ms": 2.32}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.08679100262521897, "policy_loss": -0.009887688583444043, "vf_loss": 9.665633346508908, "vf_explained_var": 0.26835414715992506, "kl": 0.009412193336898373, "entropy": 0.2011635839057866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1324000, "num_agent_steps_sampled": 1324000, "num_steps_trained": 1324000, "num_agent_steps_trained": 1324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13240, "training_iteration": 331, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-50-49", "timestamp": 1643676649, "time_this_iter_s": 1710.5280401706696, "time_total_s": 11319.110102891922, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11319.110102891922, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 37.806, "ram_util_percent": 72.02599999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -86.3, "episode_reward_mean": -13.585, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.20000000000003, -15.5, -3.2, -4.300000000000001, -4.300000000000001, -10.2, -8.3, -9.199999999999998, -16.9, -24.400000000000002, -13.3, -3.3, -20.9, -4.3, -11.999999999999995, -9.600000000000001, -4.300000000000001, -7.999999999999995, -19.599999999999998, -21.299999999999955, -4.3, -4.300000000000001, -9.5, -33.89999999999995, -11.1, -8.2, -3.4, -8.6, -12.0, -12.7, -17.900000000000006, -8.5, -10.5, -5.300000000000001, -4.2, -13.399999999999999, -10.3, -7.3, -7.6000000000000005, -12.7, -22.1, -20.3, -13.299999999999978, -3.2, -15.799999999999997, -14.899999999999999, -4.2, -6.3, -5.800000000000001, -6.3, -18.199999999999996, -10.999999999999996, -5.300000000000001, -20.2, -4.3, -4.2, -12.3, -18.299999999999997, -8.1, -18.700000000000003, -10.5, -5.300000000000001, -31.300000000000068, -12.899999999999999, -15.099999999999998, -20.499999999999993, -4.2, -12.3, -5.2, -18.699999999999996, -15.899999999999979, -22.4, -14.3, -17.799999999999997, -4.3, -20.299999999999976, -11.2, -62.70000000000002, -16.3, -10.700000000000001, -5.300000000000001, -10.799999999999997, -7.2, -9.399999999999999, -16.7, -11.5, -15.2, -34.2, -15.09999999999998, -6.300000000000001, -10.799999999999999, -4.300000000000001, -86.3, -8.6, -6.4, -17.7, -60.3, -4.3, -16.4, -9.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1214045518461604, "mean_inference_ms": 1.538362834034142, "mean_action_processing_ms": 0.07918145288813987, "mean_env_wait_ms": 15.190220912787808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1328000, "timesteps_this_iter": 0, "agent_timesteps_total": 1328000, "timers": {"sample_time_ms": 19602.574, "sample_throughput": 204.055, "load_time_ms": 0.465, "load_throughput": 8601054.035, "learn_time_ms": 9758.579, "learn_throughput": 409.896, "update_time_ms": 2.726}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 0.00010000000000000003, "total_loss": 0.7758435508977342, "policy_loss": -0.01903652720033161, "vf_loss": 79.48176100330969, "vf_explained_var": 0.10565204376815468, "kl": 0.026300455024827685, "entropy": 0.2473407991230488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1328000, "num_agent_steps_sampled": 1328000, "num_steps_trained": 1328000, "num_agent_steps_trained": 1328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13280, "training_iteration": 332, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-51-41", "timestamp": 1643676701, "time_this_iter_s": 52.32578372955322, "time_total_s": 11371.435886621475, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11371.435886621475, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 45.8445945945946, "ram_util_percent": 71.36756756756755}}
{"episode_reward_max": -3.2, "episode_reward_min": -86.3, "episode_reward_mean": -14.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.1, -20.3, -13.299999999999978, -3.2, -15.799999999999997, -14.899999999999999, -4.2, -6.3, -5.800000000000001, -6.3, -18.199999999999996, -10.999999999999996, -5.300000000000001, -20.2, -4.3, -4.2, -12.3, -18.299999999999997, -8.1, -18.700000000000003, -10.5, -5.300000000000001, -31.300000000000068, -12.899999999999999, -15.099999999999998, -20.499999999999993, -4.2, -12.3, -5.2, -18.699999999999996, -15.899999999999979, -22.4, -14.3, -17.799999999999997, -4.3, -20.299999999999976, -11.2, -62.70000000000002, -16.3, -10.700000000000001, -5.300000000000001, -10.799999999999997, -7.2, -9.399999999999999, -16.7, -11.5, -15.2, -34.2, -15.09999999999998, -6.300000000000001, -10.799999999999999, -4.300000000000001, -86.3, -8.6, -6.4, -17.7, -60.3, -4.3, -16.4, -9.199999999999998, -23.5, -24.1, -3.2, -3.3, -6.2, -11.699999999999998, -6.500000000000003, -5.300000000000001, -13.7, -16.799999999999997, -7.399999999999999, -8.899999999999999, -14.599999999999998, -4.2, -29.10000000000001, -33.30000000000001, -7.1, -18.0, -12.099999999999996, -20.3, -6.2, -15.7, -15.699999999999998, -15.099999999999998, -4.3, -5.3, -17.900000000000006, -10.799999999999999, -3.3, -39.7, -17.700000000000003, -27.900000000000045, -10.8, -11.899999999999999, -22.799999999999997, -22.700000000000003, -7.3, -4.300000000000001, -21.3, -9.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.123835850892753, "mean_inference_ms": 1.5451624613093535, "mean_action_processing_ms": 0.07957748991082213, "mean_env_wait_ms": 15.203500592583868, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1332000, "timesteps_this_iter": 0, "agent_timesteps_total": 1332000, "timers": {"sample_time_ms": 23839.98, "sample_throughput": 167.785, "load_time_ms": 0.564, "load_throughput": 7091261.676, "learn_time_ms": 11793.444, "learn_throughput": 339.171, "update_time_ms": 3.081}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.15991589534171527, "policy_loss": -0.010132877112075847, "vf_loss": 16.9988052389955, "vf_explained_var": 0.032321003752370035, "kl": 0.01704015560999631, "entropy": 0.24739905081849586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1332000, "num_agent_steps_sampled": 1332000, "num_steps_trained": 1332000, "num_agent_steps_trained": 1332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13320, "training_iteration": 333, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-52-37", "timestamp": 1643676757, "time_this_iter_s": 55.832059144973755, "time_total_s": 11427.267945766449, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11427.267945766449, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 42.356962025316456, "ram_util_percent": 71.45063291139243}}
{"episode_reward_max": -3.2, "episode_reward_min": -86.3, "episode_reward_mean": -14.133000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -10.799999999999997, -7.2, -9.399999999999999, -16.7, -11.5, -15.2, -34.2, -15.09999999999998, -6.300000000000001, -10.799999999999999, -4.300000000000001, -86.3, -8.6, -6.4, -17.7, -60.3, -4.3, -16.4, -9.199999999999998, -23.5, -24.1, -3.2, -3.3, -6.2, -11.699999999999998, -6.500000000000003, -5.300000000000001, -13.7, -16.799999999999997, -7.399999999999999, -8.899999999999999, -14.599999999999998, -4.2, -29.10000000000001, -33.30000000000001, -7.1, -18.0, -12.099999999999996, -20.3, -6.2, -15.7, -15.699999999999998, -15.099999999999998, -4.3, -5.3, -17.900000000000006, -10.799999999999999, -3.3, -39.7, -17.700000000000003, -27.900000000000045, -10.8, -11.899999999999999, -22.799999999999997, -22.700000000000003, -7.3, -4.300000000000001, -21.3, -9.299999999999999, -6.599999999999999, -6.0, -8.799999999999997, -74.5, -5.2, -3.3, -11.399999999999999, -15.399999999999999, -5.2, -4.3, -26.99999999999999, -3.7000000000000006, -4.300000000000001, -23.4, -17.7, -17.0, -3.2, -6.300000000000001, -9.3, -12.6, -12.99999999999998, -9.999999999999998, -13.99999999999998, -13.300000000000013, -10.3, -20.2, -6.1, -8.2, -4.4, -13.099999999999998, -22.999999999999996, -11.899999999999993, -7.5, -17.6, -5.300000000000001, -11.999999999999998, -12.199999999999996, -18.2, -8.2, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1268127564663306, "mean_inference_ms": 1.5525379661567047, "mean_action_processing_ms": 0.08001071395337314, "mean_env_wait_ms": 15.220142509140993, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1336000, "timesteps_this_iter": 0, "agent_timesteps_total": 1336000, "timers": {"sample_time_ms": 28088.117, "sample_throughput": 142.409, "load_time_ms": 0.66, "load_throughput": 6064638.519, "learn_time_ms": 13807.287, "learn_throughput": 289.702, "update_time_ms": 3.577}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.3378128008626562, "policy_loss": -0.016707107551415922, "vf_loss": 35.446965931307886, "vf_explained_var": 0.03676842790777965, "kl": 0.01410180489479243, "entropy": 0.23650643697348975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1336000, "num_agent_steps_sampled": 1336000, "num_steps_trained": 1336000, "num_agent_steps_trained": 1336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13360, "training_iteration": 334, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-53-35", "timestamp": 1643676815, "time_this_iter_s": 57.204038858413696, "time_total_s": 11484.471984624863, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11484.471984624863, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 39.19382716049383, "ram_util_percent": 71.45925925925927}}
{"episode_reward_max": -3.2, "episode_reward_min": -74.5, "episode_reward_mean": -12.361999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -15.7, -15.699999999999998, -15.099999999999998, -4.3, -5.3, -17.900000000000006, -10.799999999999999, -3.3, -39.7, -17.700000000000003, -27.900000000000045, -10.8, -11.899999999999999, -22.799999999999997, -22.700000000000003, -7.3, -4.300000000000001, -21.3, -9.299999999999999, -6.599999999999999, -6.0, -8.799999999999997, -74.5, -5.2, -3.3, -11.399999999999999, -15.399999999999999, -5.2, -4.3, -26.99999999999999, -3.7000000000000006, -4.300000000000001, -23.4, -17.7, -17.0, -3.2, -6.300000000000001, -9.3, -12.6, -12.99999999999998, -9.999999999999998, -13.99999999999998, -13.300000000000013, -10.3, -20.2, -6.1, -8.2, -4.4, -13.099999999999998, -22.999999999999996, -11.899999999999993, -7.5, -17.6, -5.300000000000001, -11.999999999999998, -12.199999999999996, -18.2, -8.2, -4.3, -5.2, -4.2, -16.1, -4.2, -4.300000000000001, -18.4, -5.300000000000001, -36.3, -13.799999999999997, -14.799999999999999, -8.2, -9.799999999999999, -3.2, -8.5, -15.299999999999994, -3.2, -19.3, -3.3, -5.300000000000001, -20.800000000000004, -16.9, -11.599999999999998, -18.9, -4.3, -26.70000000000001, -3.2, -3.2, -14.9, -3.3, -6.2, -16.199999999999996, -15.699999999999998, -18.90000000000001, -9.2, -4.2, -12.999999999999998, -3.2, -20.799999999999997, -14.999999999999979, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1306526939946586, "mean_inference_ms": 1.5608504873643385, "mean_action_processing_ms": 0.0804911041903725, "mean_env_wait_ms": 15.24224732960472, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1340000, "timesteps_this_iter": 0, "agent_timesteps_total": 1340000, "timers": {"sample_time_ms": 32631.214, "sample_throughput": 122.582, "load_time_ms": 0.77, "load_throughput": 5191612.823, "learn_time_ms": 15804.779, "learn_throughput": 253.088, "update_time_ms": 3.95}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.09889100972683199, "policy_loss": -0.01077788702302402, "vf_loss": 10.961663029046468, "vf_explained_var": 0.23223597413750105, "kl": 0.014667351275806042, "entropy": 0.2179666188535511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1340000, "num_agent_steps_sampled": 1340000, "num_steps_trained": 1340000, "num_agent_steps_trained": 1340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13400, "training_iteration": 335, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-54-36", "timestamp": 1643676876, "time_this_iter_s": 61.03867983818054, "time_total_s": 11545.510664463043, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11545.510664463043, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 47.97093023255814, "ram_util_percent": 71.96976744186045}}
{"episode_reward_max": -3.2, "episode_reward_min": -36.3, "episode_reward_mean": -11.370999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.99999999999998, -9.999999999999998, -13.99999999999998, -13.300000000000013, -10.3, -20.2, -6.1, -8.2, -4.4, -13.099999999999998, -22.999999999999996, -11.899999999999993, -7.5, -17.6, -5.300000000000001, -11.999999999999998, -12.199999999999996, -18.2, -8.2, -4.3, -5.2, -4.2, -16.1, -4.2, -4.300000000000001, -18.4, -5.300000000000001, -36.3, -13.799999999999997, -14.799999999999999, -8.2, -9.799999999999999, -3.2, -8.5, -15.299999999999994, -3.2, -19.3, -3.3, -5.300000000000001, -20.800000000000004, -16.9, -11.599999999999998, -18.9, -4.3, -26.70000000000001, -3.2, -3.2, -14.9, -3.3, -6.2, -16.199999999999996, -15.699999999999998, -18.90000000000001, -9.2, -4.2, -12.999999999999998, -3.2, -20.799999999999997, -14.999999999999979, -3.3, -6.3, -25.700000000000006, -7.399999999999998, -13.5, -12.5, -13.399999999999999, -10.5, -19.2, -13.8, -3.4, -3.2, -4.300000000000001, -16.3, -3.3, -9.899999999999999, -7.499999999999999, -25.2, -3.3, -15.3, -18.1, -25.700000000000006, -3.3, -4.2, -4.2, -30.500000000000004, -6.099999999999998, -13.999999999999996, -27.3, -8.299999999999997, -5.1, -4.300000000000001, -4.300000000000001, -13.799999999999999, -12.2, -4.3, -16.299999999999997, -20.1, -4.2, -8.2, -7.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.134571978042578, "mean_inference_ms": 1.5693305849462273, "mean_action_processing_ms": 0.08098549294598895, "mean_env_wait_ms": 15.265531517061177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1344000, "timesteps_this_iter": 0, "agent_timesteps_total": 1344000, "timers": {"sample_time_ms": 36891.126, "sample_throughput": 108.427, "load_time_ms": 0.887, "load_throughput": 4509276.998, "learn_time_ms": 17771.091, "learn_throughput": 225.085, "update_time_ms": 4.34}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.10601223385467204, "policy_loss": -0.009319011788935431, "vf_loss": 11.529236509883276, "vf_explained_var": 0.18257804724477952, "kl": 0.010910937423723234, "entropy": 0.24941563440026135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1344000, "num_agent_steps_sampled": 1344000, "num_steps_trained": 1344000, "num_agent_steps_trained": 1344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13440, "training_iteration": 336, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-55-33", "timestamp": 1643676933, "time_this_iter_s": 57.74475407600403, "time_total_s": 11603.255418539047, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11603.255418539047, "timesteps_since_restore": 0, "iterations_since_restore": 336, "perf": {"cpu_util_percent": 36.425609756097565, "ram_util_percent": 70.80731707317074}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.500000000000004, "episode_reward_mean": -11.116000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.9, -11.599999999999998, -18.9, -4.3, -26.70000000000001, -3.2, -3.2, -14.9, -3.3, -6.2, -16.199999999999996, -15.699999999999998, -18.90000000000001, -9.2, -4.2, -12.999999999999998, -3.2, -20.799999999999997, -14.999999999999979, -3.3, -6.3, -25.700000000000006, -7.399999999999998, -13.5, -12.5, -13.399999999999999, -10.5, -19.2, -13.8, -3.4, -3.2, -4.300000000000001, -16.3, -3.3, -9.899999999999999, -7.499999999999999, -25.2, -3.3, -15.3, -18.1, -25.700000000000006, -3.3, -4.2, -4.2, -30.500000000000004, -6.099999999999998, -13.999999999999996, -27.3, -8.299999999999997, -5.1, -4.300000000000001, -4.300000000000001, -13.799999999999999, -12.2, -4.3, -16.299999999999997, -20.1, -4.2, -8.2, -7.6, -12.2, -17.999999999999996, -8.299999999999999, -8.700000000000001, -7.3, -10.199999999999998, -10.399999999999999, -11.600000000000001, -3.2, -22.000000000000007, -17.2, -3.2, -4.2, -5.6, -20.3, -6.300000000000001, -17.39999999999999, -4.4, -8.2, -4.2, -3.3, -18.499999999999993, -15.49999999999998, -9.3, -9.3, -16.199999999999996, -22.700000000000003, -15.9, -3.2, -4.300000000000001, -3.3, -12.499999999999975, -3.2, -15.399999999999984, -3.2, -5.3999999999999995, -18.700000000000006, -20.5, -4.4, -19.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.138042729273805, "mean_inference_ms": 1.577526413178735, "mean_action_processing_ms": 0.08146442009042308, "mean_env_wait_ms": 15.287419404790421, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1348000, "timesteps_this_iter": 0, "agent_timesteps_total": 1348000, "timers": {"sample_time_ms": 41040.055, "sample_throughput": 97.466, "load_time_ms": 0.978, "load_throughput": 4091804.302, "learn_time_ms": 19763.262, "learn_throughput": 202.396, "update_time_ms": 4.121}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.07617967248924316, "policy_loss": -0.005674954796189903, "vf_loss": 8.182717870255953, "vf_explained_var": 0.35811082772029346, "kl": 0.007703417920573031, "entropy": 0.2266172340199832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1348000, "num_agent_steps_sampled": 1348000, "num_steps_trained": 1348000, "num_agent_steps_trained": 1348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13480, "training_iteration": 337, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-56-30", "timestamp": 1643676990, "time_this_iter_s": 56.68578290939331, "time_total_s": 11659.94120144844, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11659.94120144844, "timesteps_since_restore": 0, "iterations_since_restore": 337, "perf": {"cpu_util_percent": 44.8725, "ram_util_percent": 70.30125000000001}}
{"episode_reward_max": -3.2, "episode_reward_min": -124.4999999999999, "episode_reward_mean": -11.695999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.700000000000006, -3.3, -4.2, -4.2, -30.500000000000004, -6.099999999999998, -13.999999999999996, -27.3, -8.299999999999997, -5.1, -4.300000000000001, -4.300000000000001, -13.799999999999999, -12.2, -4.3, -16.299999999999997, -20.1, -4.2, -8.2, -7.6, -12.2, -17.999999999999996, -8.299999999999999, -8.700000000000001, -7.3, -10.199999999999998, -10.399999999999999, -11.600000000000001, -3.2, -22.000000000000007, -17.2, -3.2, -4.2, -5.6, -20.3, -6.300000000000001, -17.39999999999999, -4.4, -8.2, -4.2, -3.3, -18.499999999999993, -15.49999999999998, -9.3, -9.3, -16.199999999999996, -22.700000000000003, -15.9, -3.2, -4.300000000000001, -3.3, -12.499999999999975, -3.2, -15.399999999999984, -3.2, -5.3999999999999995, -18.700000000000006, -20.5, -4.4, -19.1, -3.3, -6.300000000000001, -14.3, -10.399999999999999, -11.5, -3.3, -8.6, -7.299999999999999, -5.2, -13.9, -5.4, -12.499999999999996, -124.4999999999999, -5.6, -3.4, -10.5, -13.0, -23.699999999999996, -17.6, -3.2, -4.300000000000001, -13.7, -11.099999999999998, -22.499999999999993, -16.499999999999993, -8.599999999999998, -3.2, -5.8999999999999995, -10.999999999999996, -3.3, -9.6, -5.1000000000000005, -3.3, -18.9, -3.2, -25.9, -4.2, -24.1, -16.7, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.139528932805969, "mean_inference_ms": 1.5836193774464482, "mean_action_processing_ms": 0.08172842724536206, "mean_env_wait_ms": 15.288710229191167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1352000, "timesteps_this_iter": 0, "agent_timesteps_total": 1352000, "timers": {"sample_time_ms": 43187.796, "sample_throughput": 92.619, "load_time_ms": 0.973, "load_throughput": 4111256.616, "learn_time_ms": 21278.196, "learn_throughput": 187.986, "update_time_ms": 4.561}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.8205722959321593, "policy_loss": -0.015057002136143305, "vf_loss": 83.55948695264837, "vf_explained_var": 0.11742455273546198, "kl": 0.009668551886476195, "entropy": 0.23952724449737098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1352000, "num_agent_steps_sampled": 1352000, "num_steps_trained": 1352000, "num_agent_steps_trained": 1352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13520, "training_iteration": 338, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_00-57-03", "timestamp": 1643677023, "time_this_iter_s": 32.65630602836609, "time_total_s": 11692.597507476807, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11692.597507476807, "timesteps_since_restore": 0, "iterations_since_restore": 338, "perf": {"cpu_util_percent": 39.421428571428564, "ram_util_percent": 69.61428571428571}}
{"episode_reward_max": -2.5, "episode_reward_min": -124.4999999999999, "episode_reward_mean": -11.511999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -18.499999999999993, -15.49999999999998, -9.3, -9.3, -16.199999999999996, -22.700000000000003, -15.9, -3.2, -4.300000000000001, -3.3, -12.499999999999975, -3.2, -15.399999999999984, -3.2, -5.3999999999999995, -18.700000000000006, -20.5, -4.4, -19.1, -3.3, -6.300000000000001, -14.3, -10.399999999999999, -11.5, -3.3, -8.6, -7.299999999999999, -5.2, -13.9, -5.4, -12.499999999999996, -124.4999999999999, -5.6, -3.4, -10.5, -13.0, -23.699999999999996, -17.6, -3.2, -4.300000000000001, -13.7, -11.099999999999998, -22.499999999999993, -16.499999999999993, -8.599999999999998, -3.2, -5.8999999999999995, -10.999999999999996, -3.3, -9.6, -5.1000000000000005, -3.3, -18.9, -3.2, -25.9, -4.2, -24.1, -16.7, -4.2, -4.2, -10.5, -4.4, -4.2, -9.600000000000001, -9.899999999999995, -3.2, -4.300000000000001, -4.2, -19.9, -21.6, -5.300000000000001, -5.2, -5.2, -19.5, -5.3, -14.7, -18.900000000000002, -11.3, -3.3, -10.8, -10.999999999999995, -4.4, -7.399999999999999, -8.599999999999998, -15.299999999999999, -6.3, -3.3, -23.40000000000001, -20.5, -13.6, -21.900000000000002, -13.8, -2.5, -9.399999999999995, -17.800000000000004, -12.7, -13.199999999999994, -3.3, -4.6000000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.13985465637114, "mean_inference_ms": 1.5885407750928118, "mean_action_processing_ms": 0.08191572623638234, "mean_env_wait_ms": 16.342933500479457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1356000, "timesteps_this_iter": 0, "agent_timesteps_total": 1356000, "timers": {"sample_time_ms": 46417.681, "sample_throughput": 86.174, "load_time_ms": 0.982, "load_throughput": 4073128.429, "learn_time_ms": 21314.672, "learn_throughput": 187.664, "update_time_ms": 4.534}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.09353420056242456, "policy_loss": 0.00027259337084908637, "vf_loss": 9.323141949503652, "vf_explained_var": 0.20319164952924174, "kl": 0.008472114850599219, "entropy": 0.2228613317012787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1356000, "num_agent_steps_sampled": 1356000, "num_steps_trained": 1356000, "num_agent_steps_trained": 1356000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13560, "training_iteration": 339, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-12-30", "timestamp": 1643677950, "time_this_iter_s": 927.4796409606934, "time_total_s": 12620.0771484375, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12620.0771484375, "timesteps_since_restore": 0, "iterations_since_restore": 339, "perf": {"cpu_util_percent": 46.89767441860465, "ram_util_percent": 70.12558139534885}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -42.4, "episode_reward_mean": -10.501, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -13.7, -11.099999999999998, -22.499999999999993, -16.499999999999993, -8.599999999999998, -3.2, -5.8999999999999995, -10.999999999999996, -3.3, -9.6, -5.1000000000000005, -3.3, -18.9, -3.2, -25.9, -4.2, -24.1, -16.7, -4.2, -4.2, -10.5, -4.4, -4.2, -9.600000000000001, -9.899999999999995, -3.2, -4.300000000000001, -4.2, -19.9, -21.6, -5.300000000000001, -5.2, -5.2, -19.5, -5.3, -14.7, -18.900000000000002, -11.3, -3.3, -10.8, -10.999999999999995, -4.4, -7.399999999999999, -8.599999999999998, -15.299999999999999, -6.3, -3.3, -23.40000000000001, -20.5, -13.6, -21.900000000000002, -13.8, -2.5, -9.399999999999995, -17.800000000000004, -12.7, -13.199999999999994, -3.3, -4.6000000000000005, -3.3, -9.9, -3.3, -8.8, -3.2, -9.3, -11.0, -12.699999999999998, -3.2, -16.4, -19.7, -6.499999999999998, -13.3, -13.4, -9.299999999999999, -5.699999999999999, -4.4, -5.300000000000001, -11.799999999999999, -3.3, -20.600000000000005, -42.4, -4.5, -18.5, -8.2, -9.799999999999999, -16.5, -13.5, -2.4000000000000004, -15.2, -8.2, -3.3, -4.2, -4.2, -28.500000000000014, -8.2, -4.300000000000001, -13.3, -5.300000000000001, -21.400000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1419507663409503, "mean_inference_ms": 1.5936241612274167, "mean_action_processing_ms": 0.0822061704307966, "mean_env_wait_ms": 17.405325558222152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1360000, "timesteps_this_iter": 0, "agent_timesteps_total": 1360000, "timers": {"sample_time_ms": 48764.923, "sample_throughput": 82.026, "load_time_ms": 1.07, "load_throughput": 3738822.009, "learn_time_ms": 110900.693, "learn_throughput": 36.068, "update_time_ms": 4.211}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.13312981255272383, "policy_loss": -0.004658331056325746, "vf_loss": 13.775900579684524, "vf_explained_var": 0.12635710572683684, "kl": 0.00817792083373731, "entropy": 0.21871455677093998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1360000, "num_agent_steps_sampled": 1360000, "num_steps_trained": 1360000, "num_agent_steps_trained": 1360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13600, "training_iteration": 340, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-28-15", "timestamp": 1643678895, "time_this_iter_s": 944.48393201828, "time_total_s": 13564.56108045578, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13564.56108045578, "timesteps_since_restore": 0, "iterations_since_restore": 340, "perf": {"cpu_util_percent": 50.91060606060605, "ram_util_percent": 70.7378787878788}}
{"episode_reward_max": -2.2, "episode_reward_min": -45.2, "episode_reward_mean": -11.627999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.8, -10.999999999999995, -4.4, -7.399999999999999, -8.599999999999998, -15.299999999999999, -6.3, -3.3, -23.40000000000001, -20.5, -13.6, -21.900000000000002, -13.8, -2.5, -9.399999999999995, -17.800000000000004, -12.7, -13.199999999999994, -3.3, -4.6000000000000005, -3.3, -9.9, -3.3, -8.8, -3.2, -9.3, -11.0, -12.699999999999998, -3.2, -16.4, -19.7, -6.499999999999998, -13.3, -13.4, -9.299999999999999, -5.699999999999999, -4.4, -5.300000000000001, -11.799999999999999, -3.3, -20.600000000000005, -42.4, -4.5, -18.5, -8.2, -9.799999999999999, -16.5, -13.5, -2.4000000000000004, -15.2, -8.2, -3.3, -4.2, -4.2, -28.500000000000014, -8.2, -4.300000000000001, -13.3, -5.300000000000001, -21.400000000000002, -3.2, -22.400000000000006, -13.7, -3.4, -10.999999999999998, -7.399999999999999, -3.3, -31.9, -3.2, -12.6, -7.299999999999999, -15.5, -3.2, -8.3, -16.5, -32.60000000000001, -21.500000000000007, -10.3, -45.2, -19.9, -13.699999999999982, -10.59999999999999, -3.3, -3.2, -4.4, -15.1, -14.099999999999978, -11.799999999999997, -13.999999999999996, -3.3, -9.099999999999985, -17.700000000000003, -2.2, -3.8000000000000007, -21.600000000000005, -22.2, -23.3, -9.8, -13.799999999999999, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1444155994355993, "mean_inference_ms": 1.6000054353012982, "mean_action_processing_ms": 0.08257274559017691, "mean_env_wait_ms": 17.941161690381964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1364000, "timesteps_this_iter": 0, "agent_timesteps_total": 1364000, "timers": {"sample_time_ms": 48230.472, "sample_throughput": 82.935, "load_time_ms": 1.132, "load_throughput": 3532863.611, "learn_time_ms": 113092.521, "learn_throughput": 35.369, "update_time_ms": 4.613}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.18559077445327515, "policy_loss": -0.009143549490279408, "vf_loss": 19.470669769599873, "vf_explained_var": 0.1753553298852777, "kl": 0.007753527867174163, "entropy": 0.2254815606140001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1364000, "num_agent_steps_sampled": 1364000, "num_steps_trained": 1364000, "num_agent_steps_trained": 1364000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13640, "training_iteration": 341, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-29-09", "timestamp": 1643678949, "time_this_iter_s": 53.52191090583801, "time_total_s": 13618.082991361618, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13618.082991361618, "timesteps_since_restore": 0, "iterations_since_restore": 341, "perf": {"cpu_util_percent": 53.748000000000005, "ram_util_percent": 70.90933333333334}}
{"episode_reward_max": -2.2, "episode_reward_min": -45.2, "episode_reward_mean": -12.744000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.600000000000005, -42.4, -4.5, -18.5, -8.2, -9.799999999999999, -16.5, -13.5, -2.4000000000000004, -15.2, -8.2, -3.3, -4.2, -4.2, -28.500000000000014, -8.2, -4.300000000000001, -13.3, -5.300000000000001, -21.400000000000002, -3.2, -22.400000000000006, -13.7, -3.4, -10.999999999999998, -7.399999999999999, -3.3, -31.9, -3.2, -12.6, -7.299999999999999, -15.5, -3.2, -8.3, -16.5, -32.60000000000001, -21.500000000000007, -10.3, -45.2, -19.9, -13.699999999999982, -10.59999999999999, -3.3, -3.2, -4.4, -15.1, -14.099999999999978, -11.799999999999997, -13.999999999999996, -3.3, -9.099999999999985, -17.700000000000003, -2.2, -3.8000000000000007, -21.600000000000005, -22.2, -23.3, -9.8, -13.799999999999999, -3.3, -12.7, -30.200000000000024, -4.9, -4.3, -22.8, -2.6000000000000005, -5.3999999999999995, -15.9, -10.399999999999999, -10.599999999999996, -11.2, -4.4, -7.5, -14.299999999999995, -6.999999999999999, -7.4, -4.4, -5.9, -14.599999999999994, -11.0, -5.2, -4.300000000000001, -4.4, -24.500000000000004, -14.799999999999999, -7.2, -4.4, -18.2, -33.60000000000001, -3.3, -4.300000000000001, -13.3, -12.099999999999996, -41.3, -42.7, -6.0, -15.999999999999998, -22.9, -9.5, -13.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1475870179976737, "mean_inference_ms": 1.6070566972743439, "mean_action_processing_ms": 0.0829933101177485, "mean_env_wait_ms": 17.95043245757732, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1368000, "timesteps_this_iter": 0, "agent_timesteps_total": 1368000, "timers": {"sample_time_ms": 51149.828, "sample_throughput": 78.202, "load_time_ms": 1.134, "load_throughput": 3526922.155, "learn_time_ms": 113069.525, "learn_throughput": 35.376, "update_time_ms": 4.549}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.20351445736784127, "policy_loss": -0.008179656271972964, "vf_loss": 21.16578317021811, "vf_explained_var": -0.1106697302992626, "kl": 0.010182729307007471, "entropy": 0.2428585527805231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1368000, "num_agent_steps_sampled": 1368000, "num_steps_trained": 1368000, "num_agent_steps_trained": 1368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13680, "training_iteration": 342, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-30-08", "timestamp": 1643679008, "time_this_iter_s": 59.320075035095215, "time_total_s": 13677.403066396713, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13677.403066396713, "timesteps_since_restore": 0, "iterations_since_restore": 342, "perf": {"cpu_util_percent": 48.95529411764706, "ram_util_percent": 70.7835294117647}}
{"episode_reward_max": -2.2, "episode_reward_min": -42.7, "episode_reward_mean": -11.643000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.699999999999982, -10.59999999999999, -3.3, -3.2, -4.4, -15.1, -14.099999999999978, -11.799999999999997, -13.999999999999996, -3.3, -9.099999999999985, -17.700000000000003, -2.2, -3.8000000000000007, -21.600000000000005, -22.2, -23.3, -9.8, -13.799999999999999, -3.3, -12.7, -30.200000000000024, -4.9, -4.3, -22.8, -2.6000000000000005, -5.3999999999999995, -15.9, -10.399999999999999, -10.599999999999996, -11.2, -4.4, -7.5, -14.299999999999995, -6.999999999999999, -7.4, -4.4, -5.9, -14.599999999999994, -11.0, -5.2, -4.300000000000001, -4.4, -24.500000000000004, -14.799999999999999, -7.2, -4.4, -18.2, -33.60000000000001, -3.3, -4.300000000000001, -13.3, -12.099999999999996, -41.3, -42.7, -6.0, -15.999999999999998, -22.9, -9.5, -13.7, -8.2, -31.6, -4.3, -7.0, -22.6, -15.0, -4.2, -9.5, -3.3, -11.099999999999998, -4.4, -20.799999999999997, -3.3, -3.4, -16.5, -5.4, -4.5, -14.199999999999974, -15.399999999999997, -19.000000000000004, -9.7, -4.700000000000001, -3.3, -20.699999999999996, -6.3, -4.3, -7.699999999999998, -9.5, -9.9, -14.899999999999999, -3.3, -5.300000000000001, -27.300000000000043, -10.3, -13.699999999999978, -14.399999999999999, -3.2, -18.900000000000002, -18.5, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.150706105495234, "mean_inference_ms": 1.6142505032105214, "mean_action_processing_ms": 0.08341065855568168, "mean_env_wait_ms": 17.960057216189618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1372000, "timesteps_this_iter": 0, "agent_timesteps_total": 1372000, "timers": {"sample_time_ms": 51080.344, "sample_throughput": 78.308, "load_time_ms": 1.13, "load_throughput": 3538899.764, "learn_time_ms": 113111.794, "learn_throughput": 35.363, "update_time_ms": 4.562}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.10096643010394708, "policy_loss": -0.011606598947878166, "vf_loss": 11.252552895520322, "vf_explained_var": 0.1589438065405815, "kl": 0.013329623731907114, "entropy": 0.22466634292235618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1372000, "num_agent_steps_sampled": 1372000, "num_steps_trained": 1372000, "num_agent_steps_trained": 1372000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13720, "training_iteration": 343, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-31-04", "timestamp": 1643679064, "time_this_iter_s": 55.77046298980713, "time_total_s": 13733.17352938652, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13733.17352938652, "timesteps_since_restore": 0, "iterations_since_restore": 343, "perf": {"cpu_util_percent": 40.08461538461538, "ram_util_percent": 70.75769230769232}}
{"episode_reward_max": -2.7, "episode_reward_min": -42.7, "episode_reward_mean": -11.748, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -4.300000000000001, -4.4, -24.500000000000004, -14.799999999999999, -7.2, -4.4, -18.2, -33.60000000000001, -3.3, -4.300000000000001, -13.3, -12.099999999999996, -41.3, -42.7, -6.0, -15.999999999999998, -22.9, -9.5, -13.7, -8.2, -31.6, -4.3, -7.0, -22.6, -15.0, -4.2, -9.5, -3.3, -11.099999999999998, -4.4, -20.799999999999997, -3.3, -3.4, -16.5, -5.4, -4.5, -14.199999999999974, -15.399999999999997, -19.000000000000004, -9.7, -4.700000000000001, -3.3, -20.699999999999996, -6.3, -4.3, -7.699999999999998, -9.5, -9.9, -14.899999999999999, -3.3, -5.300000000000001, -27.300000000000043, -10.3, -13.699999999999978, -14.399999999999999, -3.2, -18.900000000000002, -18.5, -5.2, -10.899999999999999, -16.799999999999997, -16.999999999999996, -17.2, -19.9, -5.4, -2.7, -8.699999999999998, -14.499999999999998, -24.00000000000002, -13.299999999999999, -5.6, -6.3, -17.999999999999993, -3.2, -4.2, -12.399999999999997, -14.599999999999998, -14.999999999999982, -3.2, -10.1, -13.7, -4.4, -4.300000000000001, -20.400000000000002, -3.3, -18.900000000000006, -12.1, -13.2, -10.6, -17.199999999999996, -3.3, -4.300000000000001, -15.2, -11.0, -7.3999999999999995, -13.5, -8.3, -4.300000000000001, -9.899999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1536932725690576, "mean_inference_ms": 1.621484158483064, "mean_action_processing_ms": 0.08383598148384142, "mean_env_wait_ms": 17.96973779594803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1376000, "timesteps_this_iter": 0, "agent_timesteps_total": 1376000, "timers": {"sample_time_ms": 51006.851, "sample_throughput": 78.421, "load_time_ms": 1.127, "load_throughput": 3548630.653, "learn_time_ms": 113118.756, "learn_throughput": 35.361, "update_time_ms": 4.409}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.08507634477529635, "policy_loss": 0.0016277175036168868, "vf_loss": 8.341142303456543, "vf_explained_var": 0.31507548286068826, "kl": 0.010440902396272664, "entropy": 0.23409324773056533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1376000, "num_agent_steps_sampled": 1376000, "num_steps_trained": 1376000, "num_agent_steps_trained": 1376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13760, "training_iteration": 344, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-32-00", "timestamp": 1643679120, "time_this_iter_s": 56.10045599937439, "time_total_s": 13789.273985385895, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13789.273985385895, "timesteps_since_restore": 0, "iterations_since_restore": 344, "perf": {"cpu_util_percent": 39.03125, "ram_util_percent": 70.8475}}
{"episode_reward_max": -2.5, "episode_reward_min": -37.49999999999995, "episode_reward_mean": -10.989, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.7, -4.700000000000001, -3.3, -20.699999999999996, -6.3, -4.3, -7.699999999999998, -9.5, -9.9, -14.899999999999999, -3.3, -5.300000000000001, -27.300000000000043, -10.3, -13.699999999999978, -14.399999999999999, -3.2, -18.900000000000002, -18.5, -5.2, -10.899999999999999, -16.799999999999997, -16.999999999999996, -17.2, -19.9, -5.4, -2.7, -8.699999999999998, -14.499999999999998, -24.00000000000002, -13.299999999999999, -5.6, -6.3, -17.999999999999993, -3.2, -4.2, -12.399999999999997, -14.599999999999998, -14.999999999999982, -3.2, -10.1, -13.7, -4.4, -4.300000000000001, -20.400000000000002, -3.3, -18.900000000000006, -12.1, -13.2, -10.6, -17.199999999999996, -3.3, -4.300000000000001, -15.2, -11.0, -7.3999999999999995, -13.5, -8.3, -4.300000000000001, -9.899999999999997, -9.899999999999988, -15.5, -15.199999999999994, -8.3, -16.299999999999997, -11.799999999999999, -2.5, -7.799999999999998, -5.699999999999999, -9.0, -23.700000000000006, -4.3, -4.300000000000001, -6.4, -8.9, -13.399999999999979, -7.2, -11.3, -17.2, -10.4, -10.4, -16.2, -10.799999999999994, -4.2, -5.2, -10.899999999999999, -6.299999999999999, -12.499999999999998, -16.799999999999997, -19.900000000000006, -4.300000000000001, -5.2, -6.5, -24.900000000000023, -3.900000000000001, -17.700000000000003, -11.299999999999995, -37.49999999999995, -9.899999999999997, -5.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.156474097278661, "mean_inference_ms": 1.6285945425724353, "mean_action_processing_ms": 0.0842534226974863, "mean_env_wait_ms": 17.97842526667831, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1380000, "timesteps_this_iter": 0, "agent_timesteps_total": 1380000, "timers": {"sample_time_ms": 50596.095, "sample_throughput": 79.057, "load_time_ms": 1.108, "load_throughput": 3610177.311, "learn_time_ms": 113125.628, "learn_throughput": 35.359, "update_time_ms": 4.347}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.11997429108101955, "policy_loss": -0.007373891099886868, "vf_loss": 12.731253285882293, "vf_explained_var": 0.1733045320357046, "kl": 0.010005685546093194, "entropy": 0.23760864966178452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1380000, "num_agent_steps_sampled": 1380000, "num_steps_trained": 1380000, "num_agent_steps_trained": 1380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13800, "training_iteration": 345, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-32-57", "timestamp": 1643679177, "time_this_iter_s": 56.926199197769165, "time_total_s": 13846.200184583664, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13846.200184583664, "timesteps_since_restore": 0, "iterations_since_restore": 345, "perf": {"cpu_util_percent": 39.86049382716049, "ram_util_percent": 70.9716049382716}}
{"episode_reward_max": -2.5, "episode_reward_min": -96.3, "episode_reward_mean": -11.977, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -13.7, -4.4, -4.300000000000001, -20.400000000000002, -3.3, -18.900000000000006, -12.1, -13.2, -10.6, -17.199999999999996, -3.3, -4.300000000000001, -15.2, -11.0, -7.3999999999999995, -13.5, -8.3, -4.300000000000001, -9.899999999999997, -9.899999999999988, -15.5, -15.199999999999994, -8.3, -16.299999999999997, -11.799999999999999, -2.5, -7.799999999999998, -5.699999999999999, -9.0, -23.700000000000006, -4.3, -4.300000000000001, -6.4, -8.9, -13.399999999999979, -7.2, -11.3, -17.2, -10.4, -10.4, -16.2, -10.799999999999994, -4.2, -5.2, -10.899999999999999, -6.299999999999999, -12.499999999999998, -16.799999999999997, -19.900000000000006, -4.300000000000001, -5.2, -6.5, -24.900000000000023, -3.900000000000001, -17.700000000000003, -11.299999999999995, -37.49999999999995, -9.899999999999997, -5.999999999999998, -3.3, -7.2, -15.600000000000001, -3.3000000000000003, -4.2, -10.499999999999996, -3.2, -9.7, -14.6, -13.2, -21.4, -4.300000000000001, -14.8, -18.300000000000004, -13.099999999999998, -6.8999999999999995, -13.699999999999998, -17.3, -4.2, -96.3, -9.5, -3.3, -14.399999999999999, -4.300000000000001, -17.599999999999994, -8.3, -3.2, -8.9, -4.2, -7.8000000000000025, -8.7, -11.59999999999998, -3.2, -12.099999999999989, -13.799999999999999, -81.00000000000006, -10.9, -3.8000000000000007, -14.8, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1594314192241297, "mean_inference_ms": 1.6357976776548913, "mean_action_processing_ms": 0.08468010585229382, "mean_env_wait_ms": 17.988238870622645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1384000, "timesteps_this_iter": 0, "agent_timesteps_total": 1384000, "timers": {"sample_time_ms": 50541.787, "sample_throughput": 79.142, "load_time_ms": 1.084, "load_throughput": 3690463.474, "learn_time_ms": 113177.534, "learn_throughput": 35.343, "update_time_ms": 4.329}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.7583672065698411, "policy_loss": -0.010064030781648652, "vf_loss": 76.83951593727194, "vf_explained_var": 0.0026648429773187127, "kl": 0.010131370867638524, "entropy": 0.21577001342209437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1384000, "num_agent_steps_sampled": 1384000, "num_steps_trained": 1384000, "num_agent_steps_trained": 1384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13840, "training_iteration": 346, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-33-55", "timestamp": 1643679235, "time_this_iter_s": 57.647392988204956, "time_total_s": 13903.847577571869, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13903.847577571869, "timesteps_since_restore": 0, "iterations_since_restore": 346, "perf": {"cpu_util_percent": 38.86049382716049, "ram_util_percent": 70.9641975308642}}
{"episode_reward_max": -3.2, "episode_reward_min": -96.3, "episode_reward_mean": -12.619999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.4, -16.2, -10.799999999999994, -4.2, -5.2, -10.899999999999999, -6.299999999999999, -12.499999999999998, -16.799999999999997, -19.900000000000006, -4.300000000000001, -5.2, -6.5, -24.900000000000023, -3.900000000000001, -17.700000000000003, -11.299999999999995, -37.49999999999995, -9.899999999999997, -5.999999999999998, -3.3, -7.2, -15.600000000000001, -3.3000000000000003, -4.2, -10.499999999999996, -3.2, -9.7, -14.6, -13.2, -21.4, -4.300000000000001, -14.8, -18.300000000000004, -13.099999999999998, -6.8999999999999995, -13.699999999999998, -17.3, -4.2, -96.3, -9.5, -3.3, -14.399999999999999, -4.300000000000001, -17.599999999999994, -8.3, -3.2, -8.9, -4.2, -7.8000000000000025, -8.7, -11.59999999999998, -3.2, -12.099999999999989, -13.799999999999999, -81.00000000000006, -10.9, -3.8000000000000007, -14.8, -6.300000000000001, -6.300000000000001, -15.399999999999999, -8.999999999999998, -11.599999999999989, -20.199999999999996, -3.3, -18.4, -22.3, -7.300000000000001, -5.300000000000001, -5.2, -5.4, -21.2, -8.999999999999996, -16.199999999999996, -4.300000000000001, -8.2, -14.399999999999999, -9.5, -29.200000000000003, -16.499999999999975, -4.4, -4.2, -4.300000000000001, -18.3, -22.700000000000003, -11.199999999999996, -4.2, -17.199999999999996, -6.3, -15.6, -12.899999999999999, -4.9, -10.7, -4.2, -14.199999999999982, -8.3, -13.2, -27.3, -16.499999999999986], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.162156048211971, "mean_inference_ms": 1.6427943664263587, "mean_action_processing_ms": 0.08509203948225473, "mean_env_wait_ms": 17.997122357358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1388000, "timesteps_this_iter": 0, "agent_timesteps_total": 1388000, "timers": {"sample_time_ms": 50408.941, "sample_throughput": 79.351, "load_time_ms": 1.086, "load_throughput": 3683414.42, "learn_time_ms": 113164.845, "learn_throughput": 35.347, "update_time_ms": 4.31}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.11116181837535033, "policy_loss": -0.011464449062302548, "vf_loss": 12.25950007207932, "vf_explained_var": 0.06792644704541852, "kl": 0.008774888214605219, "entropy": 0.17593468526598588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1388000, "num_agent_steps_sampled": 1388000, "num_steps_trained": 1388000, "num_agent_steps_trained": 1388000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13880, "training_iteration": 347, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-34-49", "timestamp": 1643679289, "time_this_iter_s": 54.74728512763977, "time_total_s": 13958.594862699509, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13958.594862699509, "timesteps_since_restore": 0, "iterations_since_restore": 347, "perf": {"cpu_util_percent": 32.537179487179486, "ram_util_percent": 70.92307692307693}}
{"episode_reward_max": -3.2, "episode_reward_min": -81.00000000000006, "episode_reward_mean": -12.333999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -3.3, -14.399999999999999, -4.300000000000001, -17.599999999999994, -8.3, -3.2, -8.9, -4.2, -7.8000000000000025, -8.7, -11.59999999999998, -3.2, -12.099999999999989, -13.799999999999999, -81.00000000000006, -10.9, -3.8000000000000007, -14.8, -6.300000000000001, -6.300000000000001, -15.399999999999999, -8.999999999999998, -11.599999999999989, -20.199999999999996, -3.3, -18.4, -22.3, -7.300000000000001, -5.300000000000001, -5.2, -5.4, -21.2, -8.999999999999996, -16.199999999999996, -4.300000000000001, -8.2, -14.399999999999999, -9.5, -29.200000000000003, -16.499999999999975, -4.4, -4.2, -4.300000000000001, -18.3, -22.700000000000003, -11.199999999999996, -4.2, -17.199999999999996, -6.3, -15.6, -12.899999999999999, -4.9, -10.7, -4.2, -14.199999999999982, -8.3, -13.2, -27.3, -16.499999999999986, -5.4, -5.2, -14.899999999999999, -45.90000000000002, -25.3, -6.2, -14.2, -10.899999999999999, -23.2, -11.7, -4.9, -5.300000000000001, -32.10000000000001, -11.699999999999974, -3.4, -33.699999999999946, -30.100000000000026, -4.2, -17.39999999999999, -10.1, -10.49999999999999, -7.3999999999999995, -9.4, -4.4, -7.899999999999999, -13.0, -4.300000000000001, -12.1, -15.299999999999995, -11.499999999999998, -5.799999999999999, -5.300000000000001, -11.599999999999998, -6.4, -4.800000000000001, -20.70000000000001, -3.3, -5.300000000000001, -6.4, -25.700000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1646707478354914, "mean_inference_ms": 1.649211739791026, "mean_action_processing_ms": 0.08547269789785902, "mean_env_wait_ms": 18.00272601012266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1392000, "timesteps_this_iter": 0, "agent_timesteps_total": 1392000, "timers": {"sample_time_ms": 52105.7, "sample_throughput": 76.767, "load_time_ms": 1.181, "load_throughput": 3386805.014, "learn_time_ms": 113625.647, "learn_throughput": 35.203, "update_time_ms": 4.187}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.18239001405014788, "policy_loss": -0.01516350651540423, "vf_loss": 19.75169968784496, "vf_explained_var": 0.04594148788400876, "kl": 0.010251020527259647, "entropy": 0.20984302786008646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1392000, "num_agent_steps_sampled": 1392000, "num_steps_trained": 1392000, "num_agent_steps_trained": 1392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13920, "training_iteration": 348, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-35-42", "timestamp": 1643679342, "time_this_iter_s": 52.56240916252136, "time_total_s": 14011.15727186203, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14011.15727186203, "timesteps_since_restore": 0, "iterations_since_restore": 348, "perf": {"cpu_util_percent": 29.14324324324324, "ram_util_percent": 70.85810810810811}}
{"episode_reward_max": -3.2, "episode_reward_min": -45.90000000000002, "episode_reward_mean": -11.825999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.499999999999975, -4.4, -4.2, -4.300000000000001, -18.3, -22.700000000000003, -11.199999999999996, -4.2, -17.199999999999996, -6.3, -15.6, -12.899999999999999, -4.9, -10.7, -4.2, -14.199999999999982, -8.3, -13.2, -27.3, -16.499999999999986, -5.4, -5.2, -14.899999999999999, -45.90000000000002, -25.3, -6.2, -14.2, -10.899999999999999, -23.2, -11.7, -4.9, -5.300000000000001, -32.10000000000001, -11.699999999999974, -3.4, -33.699999999999946, -30.100000000000026, -4.2, -17.39999999999999, -10.1, -10.49999999999999, -7.3999999999999995, -9.4, -4.4, -7.899999999999999, -13.0, -4.300000000000001, -12.1, -15.299999999999995, -11.499999999999998, -5.799999999999999, -5.300000000000001, -11.599999999999998, -6.4, -4.800000000000001, -20.70000000000001, -3.3, -5.300000000000001, -6.4, -25.700000000000006, -14.899999999999999, -3.2, -10.299999999999997, -22.6, -5.9, -4.300000000000001, -6.2, -5.300000000000001, -4.300000000000001, -14.799999999999999, -14.999999999999979, -4.300000000000001, -22.200000000000003, -13.5, -13.0, -4.300000000000001, -4.300000000000001, -8.3, -12.399999999999999, -17.599999999999994, -17.2, -3.4, -4.2, -15.799999999999999, -11.3, -3.2, -21.100000000000005, -25.700000000000003, -13.699999999999994, -12.899999999999999, -4.7, -3.2, -17.5, -4.300000000000001, -4.300000000000001, -18.5, -17.500000000000004, -6.199999999999999, -4.300000000000001, -22.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.166818038791853, "mean_inference_ms": 1.6551823573130913, "mean_action_processing_ms": 0.08582834800552414, "mean_env_wait_ms": 18.00642083531731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1396000, "timesteps_this_iter": 0, "agent_timesteps_total": 1396000, "timers": {"sample_time_ms": 52831.366, "sample_throughput": 75.713, "load_time_ms": 1.275, "load_throughput": 3138274.598, "learn_time_ms": 115609.535, "learn_throughput": 34.599, "update_time_ms": 4.497}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.09247935559520477, "policy_loss": -0.010496715976986834, "vf_loss": 10.294581371353518, "vf_explained_var": 0.22900936449727705, "kl": 0.008491387194671313, "entropy": 0.19091824358829887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1396000, "num_agent_steps_sampled": 1396000, "num_steps_trained": 1396000, "num_agent_steps_trained": 1396000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 13960, "training_iteration": 349, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-36-36", "timestamp": 1643679396, "time_this_iter_s": 53.502293825149536, "time_total_s": 14064.65956568718, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14064.65956568718, "timesteps_since_restore": 0, "iterations_since_restore": 349, "perf": {"cpu_util_percent": 28.82763157894737, "ram_util_percent": 70.90921052631576}}
{"episode_reward_max": -1.4000000000000001, "episode_reward_min": -25.700000000000006, "episode_reward_mean": -10.495, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.49999999999999, -7.3999999999999995, -9.4, -4.4, -7.899999999999999, -13.0, -4.300000000000001, -12.1, -15.299999999999995, -11.499999999999998, -5.799999999999999, -5.300000000000001, -11.599999999999998, -6.4, -4.800000000000001, -20.70000000000001, -3.3, -5.300000000000001, -6.4, -25.700000000000006, -14.899999999999999, -3.2, -10.299999999999997, -22.6, -5.9, -4.300000000000001, -6.2, -5.300000000000001, -4.300000000000001, -14.799999999999999, -14.999999999999979, -4.300000000000001, -22.200000000000003, -13.5, -13.0, -4.300000000000001, -4.300000000000001, -8.3, -12.399999999999999, -17.599999999999994, -17.2, -3.4, -4.2, -15.799999999999999, -11.3, -3.2, -21.100000000000005, -25.700000000000003, -13.699999999999994, -12.899999999999999, -4.7, -3.2, -17.5, -4.300000000000001, -4.300000000000001, -18.5, -17.500000000000004, -6.199999999999999, -4.300000000000001, -22.9, -10.499999999999998, -5.799999999999999, -3.2, -4.4, -4.300000000000001, -5.300000000000001, -18.700000000000003, -25.000000000000004, -11.099999999999998, -16.6, -4.4, -5.2, -10.099999999999998, -11.699999999999974, -1.4000000000000001, -16.499999999999982, -9.7, -9.3, -3.2, -5.2, -20.600000000000005, -7.3, -11.0, -23.600000000000005, -22.3, -20.5, -15.7, -13.7, -8.2, -3.5000000000000004, -2.2, -3.3, -15.2, -21.9, -8.3, -4.300000000000001, -15.700000000000001, -3.2, -7.199999999999999, -10.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.168841652891797, "mean_inference_ms": 1.6608938149038528, "mean_action_processing_ms": 0.08617246912646115, "mean_env_wait_ms": 18.00914795939937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1400000, "timesteps_this_iter": 0, "agent_timesteps_total": 1400000, "timers": {"sample_time_ms": 54245.352, "sample_throughput": 73.739, "load_time_ms": 1.285, "load_throughput": 3113406.944, "learn_time_ms": 27097.648, "learn_throughput": 147.614, "update_time_ms": 4.825}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.10688638943898421, "policy_loss": -0.008352184332206204, "vf_loss": 11.51939477947771, "vf_explained_var": 0.27220511019870797, "kl": 0.012523940671875974, "entropy": 0.18557804565756553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1400000, "num_agent_steps_sampled": 1400000, "num_steps_trained": 1400000, "num_agent_steps_trained": 1400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14000, "training_iteration": 350, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-37-29", "timestamp": 1643679449, "time_this_iter_s": 53.599555253982544, "time_total_s": 14118.259120941162, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14118.259120941162, "timesteps_since_restore": 0, "iterations_since_restore": 350, "perf": {"cpu_util_percent": 27.17236842105263, "ram_util_percent": 70.95394736842107}}
{"episode_reward_max": -1.4000000000000001, "episode_reward_min": -81.59999999999997, "episode_reward_mean": -11.115, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.2, -3.4, -4.2, -15.799999999999999, -11.3, -3.2, -21.100000000000005, -25.700000000000003, -13.699999999999994, -12.899999999999999, -4.7, -3.2, -17.5, -4.300000000000001, -4.300000000000001, -18.5, -17.500000000000004, -6.199999999999999, -4.300000000000001, -22.9, -10.499999999999998, -5.799999999999999, -3.2, -4.4, -4.300000000000001, -5.300000000000001, -18.700000000000003, -25.000000000000004, -11.099999999999998, -16.6, -4.4, -5.2, -10.099999999999998, -11.699999999999974, -1.4000000000000001, -16.499999999999982, -9.7, -9.3, -3.2, -5.2, -20.600000000000005, -7.3, -11.0, -23.600000000000005, -22.3, -20.5, -15.7, -13.7, -8.2, -3.5000000000000004, -2.2, -3.3, -15.2, -21.9, -8.3, -4.300000000000001, -15.700000000000001, -3.2, -7.199999999999999, -10.5, -10.799999999999999, -4.4, -36.40000000000008, -6.1, -25.2, -3.6000000000000005, -4.300000000000001, -16.1, -4.300000000000001, -10.999999999999998, -4.4, -14.6, -7.799999999999999, -15.8, -5.5, -4.4, -81.59999999999997, -2.4000000000000004, -10.599999999999998, -10.299999999999997, -3.2, -8.899999999999999, -8.6, -3.4, -8.2, -13.199999999999998, -4.2, -14.699999999999978, -6.8999999999999995, -11.3, -5.300000000000001, -11.999999999999973, -13.2, -5.3, -15.799999999999999, -7.899999999999999, -6.2, -15.999999999999998, -4.4, -11.499999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1708545672699473, "mean_inference_ms": 1.666630714224824, "mean_action_processing_ms": 0.08651860672187929, "mean_env_wait_ms": 18.012148091473872, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1404000, "timesteps_this_iter": 0, "agent_timesteps_total": 1404000, "timers": {"sample_time_ms": 55717.388, "sample_throughput": 71.791, "load_time_ms": 1.286, "load_throughput": 3109771.27, "learn_time_ms": 26811.572, "learn_throughput": 149.189, "update_time_ms": 4.816}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.33606272061250264, "policy_loss": -0.011153867726104074, "vf_loss": 34.71756832779095, "vf_explained_var": 0.21544710737402722, "kl": 0.011480573521833006, "entropy": 0.19969087386083217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1404000, "num_agent_steps_sampled": 1404000, "num_steps_trained": 1404000, "num_agent_steps_trained": 1404000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14040, "training_iteration": 351, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-38-23", "timestamp": 1643679503, "time_this_iter_s": 53.478501081466675, "time_total_s": 14171.737622022629, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14171.737622022629, "timesteps_since_restore": 0, "iterations_since_restore": 351, "perf": {"cpu_util_percent": 24.686666666666664, "ram_util_percent": 70.8733333333333}}
{"episode_reward_max": -2.2, "episode_reward_min": -81.59999999999997, "episode_reward_mean": -12.542, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.600000000000005, -7.3, -11.0, -23.600000000000005, -22.3, -20.5, -15.7, -13.7, -8.2, -3.5000000000000004, -2.2, -3.3, -15.2, -21.9, -8.3, -4.300000000000001, -15.700000000000001, -3.2, -7.199999999999999, -10.5, -10.799999999999999, -4.4, -36.40000000000008, -6.1, -25.2, -3.6000000000000005, -4.300000000000001, -16.1, -4.300000000000001, -10.999999999999998, -4.4, -14.6, -7.799999999999999, -15.8, -5.5, -4.4, -81.59999999999997, -2.4000000000000004, -10.599999999999998, -10.299999999999997, -3.2, -8.899999999999999, -8.6, -3.4, -8.2, -13.199999999999998, -4.2, -14.699999999999978, -6.8999999999999995, -11.3, -5.300000000000001, -11.999999999999973, -13.2, -5.3, -15.799999999999999, -7.899999999999999, -6.2, -15.999999999999998, -4.4, -11.499999999999996, -18.799999999999997, -3.7000000000000006, -41.3, -27.0, -14.599999999999998, -12.199999999999998, -3.7000000000000006, -14.7, -13.6, -7.3, -3.3, -20.500000000000004, -13.2, -16.5, -4.2, -18.3, -32.40000000000003, -10.699999999999998, -8.599999999999998, -16.4, -15.299999999999994, -48.89999999999996, -3.2, -23.4, -4.5, -8.699999999999998, -8.3, -7.799999999999999, -17.7, -7.1, -13.199999999999998, -10.999999999999993, -6.3, -19.0, -5.699999999999999, -17.5, -6.0, -9.5, -12.899999999999999, -9.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1727028210789383, "mean_inference_ms": 1.672417371448065, "mean_action_processing_ms": 0.08686720049025037, "mean_env_wait_ms": 18.01511327930933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1408000, "timesteps_this_iter": 0, "agent_timesteps_total": 1408000, "timers": {"sample_time_ms": 54785.055, "sample_throughput": 73.013, "load_time_ms": 1.285, "load_throughput": 3112136.378, "learn_time_ms": 26787.26, "learn_throughput": 149.325, "update_time_ms": 4.812}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.18401335368824182, "policy_loss": -0.007977060615635847, "vf_loss": 19.196140612453544, "vf_explained_var": 0.05062319424844557, "kl": 0.008141728226979903, "entropy": 0.21783342922246585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1408000, "num_agent_steps_sampled": 1408000, "num_steps_trained": 1408000, "num_agent_steps_trained": 1408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14080, "training_iteration": 352, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-39-15", "timestamp": 1643679555, "time_this_iter_s": 52.62792611122131, "time_total_s": 14224.36554813385, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14224.36554813385, "timesteps_since_restore": 0, "iterations_since_restore": 352, "perf": {"cpu_util_percent": 27.596000000000004, "ram_util_percent": 70.79333333333332}}
{"episode_reward_max": -2.2, "episode_reward_min": -48.89999999999996, "episode_reward_mean": -11.818999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -8.899999999999999, -8.6, -3.4, -8.2, -13.199999999999998, -4.2, -14.699999999999978, -6.8999999999999995, -11.3, -5.300000000000001, -11.999999999999973, -13.2, -5.3, -15.799999999999999, -7.899999999999999, -6.2, -15.999999999999998, -4.4, -11.499999999999996, -18.799999999999997, -3.7000000000000006, -41.3, -27.0, -14.599999999999998, -12.199999999999998, -3.7000000000000006, -14.7, -13.6, -7.3, -3.3, -20.500000000000004, -13.2, -16.5, -4.2, -18.3, -32.40000000000003, -10.699999999999998, -8.599999999999998, -16.4, -15.299999999999994, -48.89999999999996, -3.2, -23.4, -4.5, -8.699999999999998, -8.3, -7.799999999999999, -17.7, -7.1, -13.199999999999998, -10.999999999999993, -6.3, -19.0, -5.699999999999999, -17.5, -6.0, -9.5, -12.899999999999999, -9.2, -5.2, -4.300000000000001, -19.7, -4.300000000000001, -25.600000000000005, -5.300000000000001, -44.4, -18.800000000000004, -6.300000000000001, -10.299999999999999, -6.6000000000000005, -20.999999999999996, -4.300000000000001, -17.6, -8.2, -5.4, -6.4, -4.4, -17.0, -2.2, -15.6, -6.199999999999999, -4.2, -6.300000000000001, -10.199999999999998, -8.3, -19.6, -13.999999999999998, -21.5, -8.2, -7.5, -4.800000000000001, -16.299999999999997, -4.2, -8.3, -5.4, -5.300000000000001, -21.7, -3.3, -17.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1747953150550003, "mean_inference_ms": 1.6782179894175302, "mean_action_processing_ms": 0.08721477652725085, "mean_env_wait_ms": 18.0184204268143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1412000, "timesteps_this_iter": 0, "agent_timesteps_total": 1412000, "timers": {"sample_time_ms": 54570.602, "sample_throughput": 73.3, "load_time_ms": 1.287, "load_throughput": 3108906.884, "learn_time_ms": 26702.041, "learn_throughput": 149.801, "update_time_ms": 4.931}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.1321171158203675, "policy_loss": -0.01571357877103872, "vf_loss": 14.778367412218483, "vf_explained_var": 0.19431520911955064, "kl": 0.013195356950986779, "entropy": 0.16196596832765686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1412000, "num_agent_steps_sampled": 1412000, "num_steps_trained": 1412000, "num_agent_steps_trained": 1412000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14120, "training_iteration": 353, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-40-09", "timestamp": 1643679609, "time_this_iter_s": 53.02407503128052, "time_total_s": 14277.38962316513, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14277.38962316513, "timesteps_since_restore": 0, "iterations_since_restore": 353, "perf": {"cpu_util_percent": 28.510666666666662, "ram_util_percent": 70.80799999999999}}
{"episode_reward_max": -2.2, "episode_reward_min": -48.89999999999996, "episode_reward_mean": -11.783, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.299999999999994, -48.89999999999996, -3.2, -23.4, -4.5, -8.699999999999998, -8.3, -7.799999999999999, -17.7, -7.1, -13.199999999999998, -10.999999999999993, -6.3, -19.0, -5.699999999999999, -17.5, -6.0, -9.5, -12.899999999999999, -9.2, -5.2, -4.300000000000001, -19.7, -4.300000000000001, -25.600000000000005, -5.300000000000001, -44.4, -18.800000000000004, -6.300000000000001, -10.299999999999999, -6.6000000000000005, -20.999999999999996, -4.300000000000001, -17.6, -8.2, -5.4, -6.4, -4.4, -17.0, -2.2, -15.6, -6.199999999999999, -4.2, -6.300000000000001, -10.199999999999998, -8.3, -19.6, -13.999999999999998, -21.5, -8.2, -7.5, -4.800000000000001, -16.299999999999997, -4.2, -8.3, -5.4, -5.300000000000001, -21.7, -3.3, -17.3, -8.2, -19.3, -7.300000000000001, -19.700000000000003, -16.4, -3.2, -10.2, -10.0, -10.799999999999999, -27.2, -13.399999999999999, -9.0, -15.1, -8.2, -13.4, -15.299999999999992, -10.499999999999998, -13.999999999999998, -18.89999999999999, -19.500000000000014, -3.4000000000000004, -4.4, -7.800000000000001, -11.8, -18.199999999999996, -4.2, -24.7, -8.5, -5.2, -5.4, -8.799999999999997, -4.300000000000001, -10.5, -16.999999999999996, -4.2, -7.599999999999997, -12.899999999999999, -19.99999999999996, -18.1, -11.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1769024315170067, "mean_inference_ms": 1.683992486713403, "mean_action_processing_ms": 0.0875646069033801, "mean_env_wait_ms": 18.0217811242657, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1416000, "timesteps_this_iter": 0, "agent_timesteps_total": 1416000, "timers": {"sample_time_ms": 54330.091, "sample_throughput": 73.624, "load_time_ms": 1.299, "load_throughput": 3080366.474, "learn_time_ms": 26598.566, "learn_throughput": 150.384, "update_time_ms": 4.897}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.08673379870171669, "policy_loss": -0.010823806055811465, "vf_loss": 9.752933737891977, "vf_explained_var": 0.33530934356874037, "kl": 0.007933263349354397, "entropy": 0.19342464995720693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1416000, "num_agent_steps_sampled": 1416000, "num_steps_trained": 1416000, "num_agent_steps_trained": 1416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14160, "training_iteration": 354, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-41-02", "timestamp": 1643679662, "time_this_iter_s": 53.511337995529175, "time_total_s": 14330.90096116066, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14330.90096116066, "timesteps_since_restore": 0, "iterations_since_restore": 354, "perf": {"cpu_util_percent": 26.435999999999996, "ram_util_percent": 70.82666666666664}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.00000000000006, "episode_reward_mean": -11.026000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.6, -6.199999999999999, -4.2, -6.300000000000001, -10.199999999999998, -8.3, -19.6, -13.999999999999998, -21.5, -8.2, -7.5, -4.800000000000001, -16.299999999999997, -4.2, -8.3, -5.4, -5.300000000000001, -21.7, -3.3, -17.3, -8.2, -19.3, -7.300000000000001, -19.700000000000003, -16.4, -3.2, -10.2, -10.0, -10.799999999999999, -27.2, -13.399999999999999, -9.0, -15.1, -8.2, -13.4, -15.299999999999992, -10.499999999999998, -13.999999999999998, -18.89999999999999, -19.500000000000014, -3.4000000000000004, -4.4, -7.800000000000001, -11.8, -18.199999999999996, -4.2, -24.7, -8.5, -5.2, -5.4, -8.799999999999997, -4.300000000000001, -10.5, -16.999999999999996, -4.2, -7.599999999999997, -12.899999999999999, -19.99999999999996, -18.1, -11.0, -4.4, -5.300000000000001, -10.3, -12.799999999999997, -5.000000000000001, -6.0, -19.599999999999998, -10.3, -17.700000000000003, -20.299999999999983, -14.299999999999997, -15.7, -15.2, -10.799999999999999, -5.4, -8.2, -5.4, -9.700000000000001, -11.999999999999998, -12.600000000000001, -8.2, -8.5, -4.3, -5.2, -9.499999999999998, -19.5, -33.00000000000006, -11.899999999999997, -6.4, -9.4, -11.9, -4.4, -4.300000000000001, -4.2, -10.2, -12.6, -11.2, -10.3, -5.4, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.17883110715528, "mean_inference_ms": 1.6899625904215703, "mean_action_processing_ms": 0.08792240780894268, "mean_env_wait_ms": 18.026566744800057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1420000, "timesteps_this_iter": 0, "agent_timesteps_total": 1420000, "timers": {"sample_time_ms": 54051.815, "sample_throughput": 74.003, "load_time_ms": 1.303, "load_throughput": 3069995.059, "learn_time_ms": 26553.55, "learn_throughput": 150.639, "update_time_ms": 4.858}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0035635896027088176, "cur_lr": 0.00010000000000000003, "total_loss": 0.08448529364190675, "policy_loss": -0.003052067027617526, "vf_loss": 8.746079001343379, "vf_explained_var": 0.3138039575469109, "kl": 0.021488102965299207, "entropy": 0.18810096137145513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1420000, "num_agent_steps_sampled": 1420000, "num_steps_trained": 1420000, "num_agent_steps_trained": 1420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14200, "training_iteration": 355, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-41-57", "timestamp": 1643679717, "time_this_iter_s": 54.70222187042236, "time_total_s": 14385.603183031082, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14385.603183031082, "timesteps_since_restore": 0, "iterations_since_restore": 355, "perf": {"cpu_util_percent": 28.064102564102566, "ram_util_percent": 70.87051282051279}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.00000000000006, "episode_reward_mean": -10.916000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -4.4, -7.800000000000001, -11.8, -18.199999999999996, -4.2, -24.7, -8.5, -5.2, -5.4, -8.799999999999997, -4.300000000000001, -10.5, -16.999999999999996, -4.2, -7.599999999999997, -12.899999999999999, -19.99999999999996, -18.1, -11.0, -4.4, -5.300000000000001, -10.3, -12.799999999999997, -5.000000000000001, -6.0, -19.599999999999998, -10.3, -17.700000000000003, -20.299999999999983, -14.299999999999997, -15.7, -15.2, -10.799999999999999, -5.4, -8.2, -5.4, -9.700000000000001, -11.999999999999998, -12.600000000000001, -8.2, -8.5, -4.3, -5.2, -9.499999999999998, -19.5, -33.00000000000006, -11.899999999999997, -6.4, -9.4, -11.9, -4.4, -4.300000000000001, -4.2, -10.2, -12.6, -11.2, -10.3, -5.4, -5.4, -8.700000000000001, -5.2, -7.699999999999999, -6.499999999999999, -21.900000000000006, -8.3, -11.2, -18.700000000000003, -17.800000000000004, -7.2, -9.2, -6.1, -9.3, -15.799999999999999, -3.2, -8.4, -7.2, -8.2, -17.9, -13.999999999999998, -19.6, -9.4, -9.2, -20.799999999999997, -11.2, -7.300000000000001, -7.1, -27.700000000000006, -11.7, -4.300000000000001, -15.5, -8.099999999999998, -24.3, -5.8999999999999995, -19.900000000000013, -7.9, -8.5, -21.2, -5.0, -9.700000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.180879383709529, "mean_inference_ms": 1.6957895984687306, "mean_action_processing_ms": 0.08827151181466128, "mean_env_wait_ms": 18.030558186014368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1424000, "timesteps_this_iter": 0, "agent_timesteps_total": 1424000, "timers": {"sample_time_ms": 53623.263, "sample_throughput": 74.594, "load_time_ms": 1.337, "load_throughput": 2991284.255, "learn_time_ms": 26450.333, "learn_throughput": 151.227, "update_time_ms": 4.807}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.10676035042051026, "policy_loss": -0.0067903719892505035, "vf_loss": 11.349922254393178, "vf_explained_var": 0.3256313515606747, "kl": 0.0096352049734438, "entropy": 0.20258558603223933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1424000, "num_agent_steps_sampled": 1424000, "num_steps_trained": 1424000, "num_agent_steps_trained": 1424000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14240, "training_iteration": 356, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-42-50", "timestamp": 1643679770, "time_this_iter_s": 52.78849196434021, "time_total_s": 14438.391674995422, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14438.391674995422, "timesteps_since_restore": 0, "iterations_since_restore": 356, "perf": {"cpu_util_percent": 25.490666666666673, "ram_util_percent": 70.89866666666664}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -33.00000000000006, "episode_reward_mean": -11.578999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -8.5, -4.3, -5.2, -9.499999999999998, -19.5, -33.00000000000006, -11.899999999999997, -6.4, -9.4, -11.9, -4.4, -4.300000000000001, -4.2, -10.2, -12.6, -11.2, -10.3, -5.4, -5.4, -8.700000000000001, -5.2, -7.699999999999999, -6.499999999999999, -21.900000000000006, -8.3, -11.2, -18.700000000000003, -17.800000000000004, -7.2, -9.2, -6.1, -9.3, -15.799999999999999, -3.2, -8.4, -7.2, -8.2, -17.9, -13.999999999999998, -19.6, -9.4, -9.2, -20.799999999999997, -11.2, -7.300000000000001, -7.1, -27.700000000000006, -11.7, -4.300000000000001, -15.5, -8.099999999999998, -24.3, -5.8999999999999995, -19.900000000000013, -7.9, -8.5, -21.2, -5.0, -9.700000000000001, -14.6, -4.2, -10.4, -17.5, -22.70000000000001, -13.799999999999997, -12.499999999999998, -17.3, -6.199999999999999, -16.5, -8.7, -19.4, -20.800000000000004, -2.6000000000000005, -20.300000000000004, -10.6, -13.5, -6.2, -12.4, -8.4, -5.2, -9.7, -6.2, -13.7, -13.399999999999999, -15.5, -16.4, -9.599999999999998, -18.500000000000007, -10.399999999999999, -10.100000000000001, -11.099999999999998, -3.3, -11.000000000000002, -5.4, -20.9, -16.4, -11.599999999999998, -13.0, -15.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.182763245165935, "mean_inference_ms": 1.7014440848116659, "mean_action_processing_ms": 0.08860974478220957, "mean_env_wait_ms": 18.0334186010446, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1428000, "timesteps_this_iter": 0, "agent_timesteps_total": 1428000, "timers": {"sample_time_ms": 53356.641, "sample_throughput": 74.967, "load_time_ms": 1.34, "load_throughput": 2984048.521, "learn_time_ms": 26513.976, "learn_throughput": 150.864, "update_time_ms": 4.841}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.10012976975250308, "policy_loss": 0.012269427737481492, "vf_loss": 8.779258572798904, "vf_explained_var": 0.24974953468127917, "kl": 0.012676434350100282, "entropy": 0.2180941328085879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1428000, "num_agent_steps_sampled": 1428000, "num_steps_trained": 1428000, "num_agent_steps_trained": 1428000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14280, "training_iteration": 357, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-43-44", "timestamp": 1643679824, "time_this_iter_s": 53.75361514091492, "time_total_s": 14492.145290136337, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14492.145290136337, "timesteps_since_restore": 0, "iterations_since_restore": 357, "perf": {"cpu_util_percent": 26.806578947368422, "ram_util_percent": 70.93552631578946}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -32.4, "episode_reward_mean": -11.86, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.6, -9.4, -9.2, -20.799999999999997, -11.2, -7.300000000000001, -7.1, -27.700000000000006, -11.7, -4.300000000000001, -15.5, -8.099999999999998, -24.3, -5.8999999999999995, -19.900000000000013, -7.9, -8.5, -21.2, -5.0, -9.700000000000001, -14.6, -4.2, -10.4, -17.5, -22.70000000000001, -13.799999999999997, -12.499999999999998, -17.3, -6.199999999999999, -16.5, -8.7, -19.4, -20.800000000000004, -2.6000000000000005, -20.300000000000004, -10.6, -13.5, -6.2, -12.4, -8.4, -5.2, -9.7, -6.2, -13.7, -13.399999999999999, -15.5, -16.4, -9.599999999999998, -18.500000000000007, -10.399999999999999, -10.100000000000001, -11.099999999999998, -3.3, -11.000000000000002, -5.4, -20.9, -16.4, -11.599999999999998, -13.0, -15.3, -6.300000000000001, -4.2, -6.300000000000001, -12.099999999999998, -4.7, -3.2, -5.300000000000001, -10.2, -16.099999999999994, -10.600000000000001, -4.300000000000001, -14.299999999999997, -24.5, -10.899999999999999, -6.3999999999999995, -20.800000000000004, -18.1, -13.0, -5.3, -6.300000000000001, -14.2, -8.7, -6.4, -11.2, -6.300000000000001, -22.7, -4.300000000000001, -15.6, -5.4, -6.4, -13.999999999999998, -4.3, -32.4, -8.2, -11.399999999999999, -21.9, -9.6, -6.5, -10.599999999999998, -13.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.184645770428956, "mean_inference_ms": 1.706886490630664, "mean_action_processing_ms": 0.0889378721448335, "mean_env_wait_ms": 18.035180721730775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1432000, "timesteps_this_iter": 0, "agent_timesteps_total": 1432000, "timers": {"sample_time_ms": 53384.683, "sample_throughput": 74.928, "load_time_ms": 1.34, "load_throughput": 2984420.094, "learn_time_ms": 26544.832, "learn_throughput": 150.688, "update_time_ms": 4.834}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.10428477934391428, "policy_loss": -0.0006735850085494339, "vf_loss": 10.49067384889049, "vf_explained_var": 0.22814933766600906, "kl": 0.009658062069849125, "entropy": 0.19974423119778273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1432000, "num_agent_steps_sampled": 1432000, "num_steps_trained": 1432000, "num_agent_steps_trained": 1432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14320, "training_iteration": 358, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-44-36", "timestamp": 1643679876, "time_this_iter_s": 52.51146697998047, "time_total_s": 14544.656757116318, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14544.656757116318, "timesteps_since_restore": 0, "iterations_since_restore": 358, "perf": {"cpu_util_percent": 25.962162162162162, "ram_util_percent": 70.99324324324324}}
{"episode_reward_max": -3.2, "episode_reward_min": -32.4, "episode_reward_mean": -10.966000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -9.7, -6.2, -13.7, -13.399999999999999, -15.5, -16.4, -9.599999999999998, -18.500000000000007, -10.399999999999999, -10.100000000000001, -11.099999999999998, -3.3, -11.000000000000002, -5.4, -20.9, -16.4, -11.599999999999998, -13.0, -15.3, -6.300000000000001, -4.2, -6.300000000000001, -12.099999999999998, -4.7, -3.2, -5.300000000000001, -10.2, -16.099999999999994, -10.600000000000001, -4.300000000000001, -14.299999999999997, -24.5, -10.899999999999999, -6.3999999999999995, -20.800000000000004, -18.1, -13.0, -5.3, -6.300000000000001, -14.2, -8.7, -6.4, -11.2, -6.300000000000001, -22.7, -4.300000000000001, -15.6, -5.4, -6.4, -13.999999999999998, -4.3, -32.4, -8.2, -11.399999999999999, -21.9, -9.6, -6.5, -10.599999999999998, -13.4, -6.1, -6.300000000000001, -7.999999999999998, -11.399999999999997, -6.300000000000001, -20.600000000000005, -4.300000000000001, -20.900000000000006, -11.399999999999999, -15.8, -5.300000000000001, -5.300000000000001, -10.7, -13.099999999999998, -15.5, -12.0, -5.4, -4.2, -4.4, -5.4, -9.799999999999999, -9.3, -19.2, -5.799999999999999, -9.5, -12.799999999999999, -6.4, -14.6, -4.4, -18.3, -4.1, -9.099999999999998, -16.4, -14.6, -14.199999999999998, -10.4, -17.4, -12.999999999999996, -6.3, -15.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.186492133854453, "mean_inference_ms": 1.7122864759186984, "mean_action_processing_ms": 0.08926448760445903, "mean_env_wait_ms": 18.03706351926917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1436000, "timesteps_this_iter": 0, "agent_timesteps_total": 1436000, "timers": {"sample_time_ms": 53361.212, "sample_throughput": 74.961, "load_time_ms": 1.327, "load_throughput": 3013907.232, "learn_time_ms": 26610.365, "learn_throughput": 150.317, "update_time_ms": 4.878}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.0674281242518856, "policy_loss": -0.004112236253837103, "vf_loss": 7.14776505904813, "vf_explained_var": 0.36328180848911246, "kl": 0.01173179521377482, "entropy": 0.18706578966430437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1436000, "num_agent_steps_sampled": 1436000, "num_steps_trained": 1436000, "num_agent_steps_trained": 1436000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14360, "training_iteration": 359, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-45-30", "timestamp": 1643679930, "time_this_iter_s": 53.617883920669556, "time_total_s": 14598.274641036987, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14598.274641036987, "timesteps_since_restore": 0, "iterations_since_restore": 359, "perf": {"cpu_util_percent": 29.12631578947369, "ram_util_percent": 70.98947368421052}}
{"episode_reward_max": -2.5, "episode_reward_min": -46.30000000000003, "episode_reward_mean": -10.876000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -8.7, -6.4, -11.2, -6.300000000000001, -22.7, -4.300000000000001, -15.6, -5.4, -6.4, -13.999999999999998, -4.3, -32.4, -8.2, -11.399999999999999, -21.9, -9.6, -6.5, -10.599999999999998, -13.4, -6.1, -6.300000000000001, -7.999999999999998, -11.399999999999997, -6.300000000000001, -20.600000000000005, -4.300000000000001, -20.900000000000006, -11.399999999999999, -15.8, -5.300000000000001, -5.300000000000001, -10.7, -13.099999999999998, -15.5, -12.0, -5.4, -4.2, -4.4, -5.4, -9.799999999999999, -9.3, -19.2, -5.799999999999999, -9.5, -12.799999999999999, -6.4, -14.6, -4.4, -18.3, -4.1, -9.099999999999998, -16.4, -14.6, -14.199999999999998, -10.4, -17.4, -12.999999999999996, -6.3, -15.5, -22.200000000000003, -3.4, -13.8, -4.5, -20.90000000000001, -10.3, -9.8, -14.4, -7.4, -4.3, -5.2, -7.300000000000001, -8.3, -4.300000000000001, -6.4, -4.300000000000001, -12.499999999999995, -5.2, -7.4, -16.8, -14.4, -8.1, -2.5, -9.7, -17.3, -17.1, -13.499999999999996, -21.5, -6.4, -16.29999999999999, -12.099999999999998, -3.3000000000000003, -12.2, -9.5, -7.4, -46.30000000000003, -7.199999999999999, -5.4, -9.200000000000001, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1883373497758765, "mean_inference_ms": 1.717741441971912, "mean_action_processing_ms": 0.08959407093260968, "mean_env_wait_ms": 18.039309709258678, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1440000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 53486.577, "sample_throughput": 74.785, "load_time_ms": 1.34, "load_throughput": 2984154.675, "learn_time_ms": 26528.114, "learn_throughput": 150.783, "update_time_ms": 4.82}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.13816970886201949, "policy_loss": 0.0021932906220837305, "vf_loss": 13.592150274976607, "vf_explained_var": 0.14833562425387803, "kl": 0.010274071927107878, "entropy": 0.20966291422805478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1440000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 1440000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14400, "training_iteration": 360, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-46-23", "timestamp": 1643679983, "time_this_iter_s": 53.35285401344299, "time_total_s": 14651.62749505043, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14651.62749505043, "timesteps_since_restore": 0, "iterations_since_restore": 360, "perf": {"cpu_util_percent": 30.567999999999998, "ram_util_percent": 70.95599999999999}}
{"episode_reward_max": -2.5, "episode_reward_min": -46.30000000000003, "episode_reward_mean": -11.604000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.799999999999999, -9.3, -19.2, -5.799999999999999, -9.5, -12.799999999999999, -6.4, -14.6, -4.4, -18.3, -4.1, -9.099999999999998, -16.4, -14.6, -14.199999999999998, -10.4, -17.4, -12.999999999999996, -6.3, -15.5, -22.200000000000003, -3.4, -13.8, -4.5, -20.90000000000001, -10.3, -9.8, -14.4, -7.4, -4.3, -5.2, -7.300000000000001, -8.3, -4.300000000000001, -6.4, -4.300000000000001, -12.499999999999995, -5.2, -7.4, -16.8, -14.4, -8.1, -2.5, -9.7, -17.3, -17.1, -13.499999999999996, -21.5, -6.4, -16.29999999999999, -12.099999999999998, -3.3000000000000003, -12.2, -9.5, -7.4, -46.30000000000003, -7.199999999999999, -5.4, -9.200000000000001, -2.5, -4.300000000000001, -28.599999999999998, -6.999999999999998, -20.3, -13.399999999999999, -22.7, -4.300000000000001, -41.3, -7.4, -12.3, -13.699999999999998, -4.3, -5.4, -10.7, -23.999999999999996, -5.3, -10.3, -3.3000000000000003, -8.9, -9.2, -6.2, -13.3, -13.899999999999999, -18.2, -7.3, -20.099999999999998, -16.0, -5.999999999999998, -11.3, -12.099999999999998, -3.2, -16.700000000000003, -4.7, -24.0, -11.499999999999998, -18.5, -6.2, -17.5, -3.4, -11.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.190165830711683, "mean_inference_ms": 1.723123707268362, "mean_action_processing_ms": 0.08992074666536606, "mean_env_wait_ms": 18.041004242657547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1444000, "timesteps_this_iter": 0, "agent_timesteps_total": 1444000, "timers": {"sample_time_ms": 53265.421, "sample_throughput": 75.096, "load_time_ms": 1.365, "load_throughput": 2930159.806, "learn_time_ms": 26544.303, "learn_throughput": 150.691, "update_time_ms": 4.979}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.12695998344770681, "policy_loss": -0.018048220975024086, "vf_loss": 14.49095032340096, "vf_explained_var": 0.27703518534219396, "kl": 0.0184655293810436, "entropy": 0.2099179359373226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1444000, "num_agent_steps_sampled": 1444000, "num_steps_trained": 1444000, "num_agent_steps_trained": 1444000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14440, "training_iteration": 361, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-47-16", "timestamp": 1643680036, "time_this_iter_s": 52.25705814361572, "time_total_s": 14703.884553194046, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14703.884553194046, "timesteps_since_restore": 0, "iterations_since_restore": 361, "perf": {"cpu_util_percent": 23.025675675675675, "ram_util_percent": 70.99189189189188}}
{"episode_reward_max": -2.5, "episode_reward_min": -46.30000000000003, "episode_reward_mean": -12.195, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.4, -8.1, -2.5, -9.7, -17.3, -17.1, -13.499999999999996, -21.5, -6.4, -16.29999999999999, -12.099999999999998, -3.3000000000000003, -12.2, -9.5, -7.4, -46.30000000000003, -7.199999999999999, -5.4, -9.200000000000001, -2.5, -4.300000000000001, -28.599999999999998, -6.999999999999998, -20.3, -13.399999999999999, -22.7, -4.300000000000001, -41.3, -7.4, -12.3, -13.699999999999998, -4.3, -5.4, -10.7, -23.999999999999996, -5.3, -10.3, -3.3000000000000003, -8.9, -9.2, -6.2, -13.3, -13.899999999999999, -18.2, -7.3, -20.099999999999998, -16.0, -5.999999999999998, -11.3, -12.099999999999998, -3.2, -16.700000000000003, -4.7, -24.0, -11.499999999999998, -18.5, -6.2, -17.5, -3.4, -11.899999999999999, -18.70000000000001, -18.6, -3.3, -5.300000000000001, -5.300000000000001, -7.300000000000001, -18.4, -3.8000000000000003, -14.2, -5.2, -6.300000000000001, -14.1, -4.4, -8.8, -19.6, -7.4, -6.8, -23.5, -13.5, -20.900000000000002, -3.3, -23.2, -4.2, -4.4, -18.9, -17.3, -6.4, -10.6, -12.199999999999998, -4.300000000000001, -14.0, -5.3, -7.2, -7.5, -24.600000000000005, -14.799999999999999, -10.8, -25.9, -22.000000000000004, -16.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1922542934454845, "mean_inference_ms": 1.728579814519426, "mean_action_processing_ms": 0.09026195202518089, "mean_env_wait_ms": 18.04348331828518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1448000, "timesteps_this_iter": 0, "agent_timesteps_total": 1448000, "timers": {"sample_time_ms": 53422.084, "sample_throughput": 74.875, "load_time_ms": 1.373, "load_throughput": 2913115.711, "learn_time_ms": 26643.282, "learn_throughput": 150.132, "update_time_ms": 4.946}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.11103386105869406, "policy_loss": -0.0011845875766769212, "vf_loss": 11.21657459907314, "vf_explained_var": 0.1729146103064219, "kl": 0.00986036223593303, "entropy": 0.20552646477296146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1448000, "num_agent_steps_sampled": 1448000, "num_steps_trained": 1448000, "num_agent_steps_trained": 1448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14480, "training_iteration": 362, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-48-11", "timestamp": 1643680091, "time_this_iter_s": 54.98468899726868, "time_total_s": 14758.869242191315, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14758.869242191315, "timesteps_since_restore": 0, "iterations_since_restore": 362, "perf": {"cpu_util_percent": 27.375641025641023, "ram_util_percent": 70.93846153846151}}
{"episode_reward_max": -3.2, "episode_reward_min": -25.9, "episode_reward_mean": -11.187999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -13.3, -13.899999999999999, -18.2, -7.3, -20.099999999999998, -16.0, -5.999999999999998, -11.3, -12.099999999999998, -3.2, -16.700000000000003, -4.7, -24.0, -11.499999999999998, -18.5, -6.2, -17.5, -3.4, -11.899999999999999, -18.70000000000001, -18.6, -3.3, -5.300000000000001, -5.300000000000001, -7.300000000000001, -18.4, -3.8000000000000003, -14.2, -5.2, -6.300000000000001, -14.1, -4.4, -8.8, -19.6, -7.4, -6.8, -23.5, -13.5, -20.900000000000002, -3.3, -23.2, -4.2, -4.4, -18.9, -17.3, -6.4, -10.6, -12.199999999999998, -4.300000000000001, -14.0, -5.3, -7.2, -7.5, -24.600000000000005, -14.799999999999999, -10.8, -25.9, -22.000000000000004, -16.6, -4.300000000000001, -4.300000000000001, -4.2, -4.4, -4.4, -13.1, -14.599999999999998, -10.3, -5.300000000000001, -9.700000000000001, -14.3, -4.2, -6.300000000000001, -15.0, -5.300000000000001, -15.1, -5.4, -18.5, -12.099999999999998, -4.4, -5.300000000000001, -11.3, -3.2, -16.599999999999998, -6.2, -6.300000000000001, -5.2, -14.099999999999998, -16.599999999999998, -11.0, -8.3, -21.0, -24.900000000000002, -3.3, -4.9, -17.700000000000003, -4.000000000000001, -13.7, -8.5, -20.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1943646445040317, "mean_inference_ms": 1.7340676779469357, "mean_action_processing_ms": 0.09060370209388954, "mean_env_wait_ms": 18.046597443538996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1452000, "timesteps_this_iter": 0, "agent_timesteps_total": 1452000, "timers": {"sample_time_ms": 53484.86, "sample_throughput": 74.788, "load_time_ms": 1.387, "load_throughput": 2884814.554, "learn_time_ms": 26663.59, "learn_throughput": 150.017, "update_time_ms": 4.869}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.07374857171408591, "policy_loss": -0.0016014070350236149, "vf_loss": 7.527921348041104, "vf_explained_var": 0.48803217218768213, "kl": 0.013238831179065637, "entropy": 0.20224737947185834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1452000, "num_agent_steps_sampled": 1452000, "num_steps_trained": 1452000, "num_agent_steps_trained": 1452000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14520, "training_iteration": 363, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-49-04", "timestamp": 1643680144, "time_this_iter_s": 52.87528109550476, "time_total_s": 14811.74452328682, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14811.74452328682, "timesteps_since_restore": 0, "iterations_since_restore": 363, "perf": {"cpu_util_percent": 28.79733333333333, "ram_util_percent": 70.94800000000001}}
{"episode_reward_max": -2.5, "episode_reward_min": -25.9, "episode_reward_mean": -10.304, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -23.2, -4.2, -4.4, -18.9, -17.3, -6.4, -10.6, -12.199999999999998, -4.300000000000001, -14.0, -5.3, -7.2, -7.5, -24.600000000000005, -14.799999999999999, -10.8, -25.9, -22.000000000000004, -16.6, -4.300000000000001, -4.300000000000001, -4.2, -4.4, -4.4, -13.1, -14.599999999999998, -10.3, -5.300000000000001, -9.700000000000001, -14.3, -4.2, -6.300000000000001, -15.0, -5.300000000000001, -15.1, -5.4, -18.5, -12.099999999999998, -4.4, -5.300000000000001, -11.3, -3.2, -16.599999999999998, -6.2, -6.300000000000001, -5.2, -14.099999999999998, -16.599999999999998, -11.0, -8.3, -21.0, -24.900000000000002, -3.3, -4.9, -17.700000000000003, -4.000000000000001, -13.7, -8.5, -20.6, -3.3, -4.300000000000001, -4.4, -4.300000000000001, -5.999999999999998, -19.9, -4.4, -10.2, -4.300000000000001, -6.4, -18.3, -13.999999999999998, -17.3, -4.300000000000001, -5.300000000000001, -5.300000000000001, -21.999999999999996, -11.8, -6.4, -6.3, -17.9, -8.2, -18.8, -15.3, -6.499999999999999, -8.700000000000001, -4.9, -2.5, -10.2, -13.6, -4.300000000000001, -22.3, -3.4, -11.499999999999977, -6.4, -11.3, -3.3, -4.2, -10.8, -16.400000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1963281717460337, "mean_inference_ms": 1.7395948351824668, "mean_action_processing_ms": 0.09094804335544479, "mean_env_wait_ms": 18.050181778595853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1456000, "timesteps_this_iter": 0, "agent_timesteps_total": 1456000, "timers": {"sample_time_ms": 53497.91, "sample_throughput": 74.769, "load_time_ms": 1.376, "load_throughput": 2906001.074, "learn_time_ms": 26721.913, "learn_throughput": 149.69, "update_time_ms": 4.913}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.059244931364051436, "policy_loss": -0.015361199914027126, "vf_loss": 7.45508905892731, "vf_explained_var": 0.35992598309311813, "kl": 0.010334860543687176, "entropy": 0.20853748128459018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1456000, "num_agent_steps_sampled": 1456000, "num_steps_trained": 1456000, "num_agent_steps_trained": 1456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14560, "training_iteration": 364, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-49-58", "timestamp": 1643680198, "time_this_iter_s": 54.0231249332428, "time_total_s": 14865.767648220062, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14865.767648220062, "timesteps_since_restore": 0, "iterations_since_restore": 364, "perf": {"cpu_util_percent": 31.49473684210527, "ram_util_percent": 70.98157894736842}}
{"episode_reward_max": -2.5, "episode_reward_min": -25.6, "episode_reward_mean": -9.944999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -11.3, -3.2, -16.599999999999998, -6.2, -6.300000000000001, -5.2, -14.099999999999998, -16.599999999999998, -11.0, -8.3, -21.0, -24.900000000000002, -3.3, -4.9, -17.700000000000003, -4.000000000000001, -13.7, -8.5, -20.6, -3.3, -4.300000000000001, -4.4, -4.300000000000001, -5.999999999999998, -19.9, -4.4, -10.2, -4.300000000000001, -6.4, -18.3, -13.999999999999998, -17.3, -4.300000000000001, -5.300000000000001, -5.300000000000001, -21.999999999999996, -11.8, -6.4, -6.3, -17.9, -8.2, -18.8, -15.3, -6.499999999999999, -8.700000000000001, -4.9, -2.5, -10.2, -13.6, -4.300000000000001, -22.3, -3.4, -11.499999999999977, -6.4, -11.3, -3.3, -4.2, -10.8, -16.400000000000002, -7.300000000000001, -14.600000000000001, -13.7, -5.800000000000001, -3.2, -25.6, -21.500000000000004, -8.8, -6.3, -4.300000000000001, -4.2, -5.300000000000001, -8.500000000000002, -9.599999999999998, -3.3, -13.899999999999999, -5.599999999999998, -11.499999999999996, -15.2, -3.3, -19.600000000000005, -4.4, -3.8000000000000007, -3.3, -10.399999999999999, -5.300000000000001, -8.099999999999998, -24.299999999999997, -4.3, -4.2, -16.9, -13.999999999999996, -7.3, -6.6, -4.300000000000001, -12.7, -5.8, -19.400000000000002, -19.1, -7.499999999999989], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1980874454721477, "mean_inference_ms": 1.7450123657779897, "mean_action_processing_ms": 0.09128774889542768, "mean_env_wait_ms": 18.053059485348452, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1460000, "timesteps_this_iter": 0, "agent_timesteps_total": 1460000, "timers": {"sample_time_ms": 53382.73, "sample_throughput": 74.931, "load_time_ms": 1.372, "load_throughput": 2914937.8, "learn_time_ms": 26741.618, "learn_throughput": 149.58, "update_time_ms": 4.976}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.0878361945541235, "policy_loss": -0.006618212473889192, "vf_loss": 9.442227778030981, "vf_explained_var": 0.17597204889020612, "kl": 0.006011529730216471, "entropy": 0.21327528726830278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1460000, "num_agent_steps_sampled": 1460000, "num_steps_trained": 1460000, "num_agent_steps_trained": 1460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14600, "training_iteration": 365, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-50-51", "timestamp": 1643680251, "time_this_iter_s": 53.17700386047363, "time_total_s": 14918.944652080536, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14918.944652080536, "timesteps_since_restore": 0, "iterations_since_restore": 365, "perf": {"cpu_util_percent": 26.393333333333334, "ram_util_percent": 70.97466666666665}}
{"episode_reward_max": -2.5, "episode_reward_min": -25.6, "episode_reward_mean": -9.626, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.9, -8.2, -18.8, -15.3, -6.499999999999999, -8.700000000000001, -4.9, -2.5, -10.2, -13.6, -4.300000000000001, -22.3, -3.4, -11.499999999999977, -6.4, -11.3, -3.3, -4.2, -10.8, -16.400000000000002, -7.300000000000001, -14.600000000000001, -13.7, -5.800000000000001, -3.2, -25.6, -21.500000000000004, -8.8, -6.3, -4.300000000000001, -4.2, -5.300000000000001, -8.500000000000002, -9.599999999999998, -3.3, -13.899999999999999, -5.599999999999998, -11.499999999999996, -15.2, -3.3, -19.600000000000005, -4.4, -3.8000000000000007, -3.3, -10.399999999999999, -5.300000000000001, -8.099999999999998, -24.299999999999997, -4.3, -4.2, -16.9, -13.999999999999996, -7.3, -6.6, -4.300000000000001, -12.7, -5.8, -19.400000000000002, -19.1, -7.499999999999989, -16.199999999999996, -3.4, -23.400000000000034, -3.3, -13.999999999999998, -11.2, -3.2, -4.300000000000001, -4.4, -8.2, -7.399999999999999, -4.300000000000001, -19.399999999999984, -9.0, -3.2, -3.4, -6.2, -13.699999999999998, -3.6000000000000005, -15.4, -18.700000000000003, -13.5, -3.3, -4.2, -7.300000000000001, -3.3, -8.399999999999999, -3.3, -10.3, -15.799999999999997, -3.2, -12.699999999999983, -12.799999999999999, -17.3, -3.3, -4.2, -12.9, -17.199999999999996, -3.900000000000001, -16.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1999938604408196, "mean_inference_ms": 1.7503927263039318, "mean_action_processing_ms": 0.0916283382967972, "mean_env_wait_ms": 18.055670920363312, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1464000, "timesteps_this_iter": 0, "agent_timesteps_total": 1464000, "timers": {"sample_time_ms": 53440.507, "sample_throughput": 74.85, "load_time_ms": 1.337, "load_throughput": 2992297.924, "learn_time_ms": 26916.407, "learn_throughput": 148.608, "update_time_ms": 4.968}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.005345384404063225, "cur_lr": 0.00010000000000000003, "total_loss": 0.04708901779796247, "policy_loss": -0.009584633863821466, "vf_loss": 5.655862442604316, "vf_explained_var": 0.31579909843783227, "kl": 0.021519530844207296, "entropy": 0.19566311365974848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1464000, "num_agent_steps_sampled": 1464000, "num_steps_trained": 1464000, "num_agent_steps_trained": 1464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14640, "training_iteration": 366, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-51-46", "timestamp": 1643680306, "time_this_iter_s": 54.89910387992859, "time_total_s": 14973.843755960464, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14973.843755960464, "timesteps_since_restore": 0, "iterations_since_restore": 366, "perf": {"cpu_util_percent": 36.68461538461538, "ram_util_percent": 70.91153846153841}}
{"episode_reward_max": -3.2, "episode_reward_min": -27.5, "episode_reward_mean": -9.535, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.600000000000005, -4.4, -3.8000000000000007, -3.3, -10.399999999999999, -5.300000000000001, -8.099999999999998, -24.299999999999997, -4.3, -4.2, -16.9, -13.999999999999996, -7.3, -6.6, -4.300000000000001, -12.7, -5.8, -19.400000000000002, -19.1, -7.499999999999989, -16.199999999999996, -3.4, -23.400000000000034, -3.3, -13.999999999999998, -11.2, -3.2, -4.300000000000001, -4.4, -8.2, -7.399999999999999, -4.300000000000001, -19.399999999999984, -9.0, -3.2, -3.4, -6.2, -13.699999999999998, -3.6000000000000005, -15.4, -18.700000000000003, -13.5, -3.3, -4.2, -7.300000000000001, -3.3, -8.399999999999999, -3.3, -10.3, -15.799999999999997, -3.2, -12.699999999999983, -12.799999999999999, -17.3, -3.3, -4.2, -12.9, -17.199999999999996, -3.900000000000001, -16.5, -6.300000000000001, -22.900000000000006, -3.3, -4.2, -4.2, -14.799999999999978, -3.4, -9.6, -7.599999999999999, -16.799999999999997, -3.3, -4.2, -9.3, -4.300000000000001, -16.099999999999998, -3.3, -6.4, -15.2, -4.800000000000001, -9.200000000000001, -7.3, -27.5, -3.3, -11.2, -10.0, -8.0, -3.3, -23.5, -19.800000000000004, -17.6, -20.0, -3.2, -4.2, -6.1, -9.799999999999999, -4.2, -11.100000000000001, -13.3, -3.2, -7.099999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.202147022734897, "mean_inference_ms": 1.7559467836670337, "mean_action_processing_ms": 0.09197091819149009, "mean_env_wait_ms": 18.059514907060553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1468000, "timesteps_this_iter": 0, "agent_timesteps_total": 1468000, "timers": {"sample_time_ms": 53817.391, "sample_throughput": 74.325, "load_time_ms": 1.339, "load_throughput": 2987342.818, "learn_time_ms": 26970.262, "learn_throughput": 148.311, "update_time_ms": 5.041}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.07265828431493813, "policy_loss": -0.0005178851320818868, "vf_loss": 7.309043866780496, "vf_explained_var": 0.2968095670464218, "kl": 0.010692317018971569, "entropy": 0.18369926779020218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1468000, "num_agent_steps_sampled": 1468000, "num_steps_trained": 1468000, "num_agent_steps_trained": 1468000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14680, "training_iteration": 367, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-52-42", "timestamp": 1643680362, "time_this_iter_s": 56.314270973205566, "time_total_s": 15030.15802693367, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15030.15802693367, "timesteps_since_restore": 0, "iterations_since_restore": 367, "perf": {"cpu_util_percent": 38.6375, "ram_util_percent": 70.85625}}
{"episode_reward_max": -2.2, "episode_reward_min": -43.3, "episode_reward_mean": -10.265999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.700000000000003, -13.5, -3.3, -4.2, -7.300000000000001, -3.3, -8.399999999999999, -3.3, -10.3, -15.799999999999997, -3.2, -12.699999999999983, -12.799999999999999, -17.3, -3.3, -4.2, -12.9, -17.199999999999996, -3.900000000000001, -16.5, -6.300000000000001, -22.900000000000006, -3.3, -4.2, -4.2, -14.799999999999978, -3.4, -9.6, -7.599999999999999, -16.799999999999997, -3.3, -4.2, -9.3, -4.300000000000001, -16.099999999999998, -3.3, -6.4, -15.2, -4.800000000000001, -9.200000000000001, -7.3, -27.5, -3.3, -11.2, -10.0, -8.0, -3.3, -23.5, -19.800000000000004, -17.6, -20.0, -3.2, -4.2, -6.1, -9.799999999999999, -4.2, -11.100000000000001, -13.3, -3.2, -7.099999999999999, -18.8, -9.2, -8.5, -6.4, -17.4, -14.6, -15.299999999999999, -17.5, -9.3, -4.2, -16.5, -3.2, -18.0, -21.6, -2.2, -14.0, -43.3, -10.899999999999999, -8.1, -11.2, -3.2, -4.2, -4.4, -16.4, -19.6, -17.200000000000003, -7.3, -13.2, -4.300000000000001, -9.3, -16.4, -3.3, -15.799999999999999, -2.2, -3.3, -7.099999999999998, -11.3, -5.2, -14.299999999999997, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2043717784571073, "mean_inference_ms": 1.7617793295604958, "mean_action_processing_ms": 0.0923217645447342, "mean_env_wait_ms": 18.064933332095492, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1472000, "timesteps_this_iter": 0, "agent_timesteps_total": 1472000, "timers": {"sample_time_ms": 54095.202, "sample_throughput": 73.944, "load_time_ms": 1.363, "load_throughput": 2934105.631, "learn_time_ms": 27110.432, "learn_throughput": 147.545, "update_time_ms": 5.154}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.12915872706561, "policy_loss": -0.012324210928292363, "vf_loss": 14.139064358126733, "vf_explained_var": 0.22717920221308227, "kl": 0.011511069702290946, "entropy": 0.2153300616209225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1472000, "num_agent_steps_sampled": 1472000, "num_steps_trained": 1472000, "num_agent_steps_trained": 1472000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14720, "training_iteration": 368, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-53-39", "timestamp": 1643680419, "time_this_iter_s": 56.13112807273865, "time_total_s": 15086.289155006409, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15086.289155006409, "timesteps_since_restore": 0, "iterations_since_restore": 368, "perf": {"cpu_util_percent": 42.28987341772151, "ram_util_percent": 70.67468354430382}}
{"episode_reward_max": -2.2, "episode_reward_min": -43.3, "episode_reward_mean": -11.033000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3, -27.5, -3.3, -11.2, -10.0, -8.0, -3.3, -23.5, -19.800000000000004, -17.6, -20.0, -3.2, -4.2, -6.1, -9.799999999999999, -4.2, -11.100000000000001, -13.3, -3.2, -7.099999999999999, -18.8, -9.2, -8.5, -6.4, -17.4, -14.6, -15.299999999999999, -17.5, -9.3, -4.2, -16.5, -3.2, -18.0, -21.6, -2.2, -14.0, -43.3, -10.899999999999999, -8.1, -11.2, -3.2, -4.2, -4.4, -16.4, -19.6, -17.200000000000003, -7.3, -13.2, -4.300000000000001, -9.3, -16.4, -3.3, -15.799999999999999, -2.2, -3.3, -7.099999999999998, -11.3, -5.2, -14.299999999999997, -3.4, -28.0, -5.2, -14.799999999999999, -13.7, -3.3, -6.300000000000001, -4.8, -8.2, -4.4, -14.2, -7.5, -19.5, -18.600000000000005, -20.199999999999992, -15.600000000000001, -10.899999999999999, -20.3, -15.7, -15.799999999999999, -3.3, -5.300000000000001, -9.4, -4.3, -13.5, -16.699999999999996, -3.4, -4.300000000000001, -9.3, -10.399999999999999, -10.2, -5.300000000000001, -5.300000000000001, -15.099999999999998, -13.8, -15.399999999999999, -15.599999999999998, -3.2, -8.3, -11.699999999999998, -7.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2068856120191196, "mean_inference_ms": 1.7677522266401027, "mean_action_processing_ms": 0.0926788107050898, "mean_env_wait_ms": 18.071221047096437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1476000, "timesteps_this_iter": 0, "agent_timesteps_total": 1476000, "timers": {"sample_time_ms": 54466.586, "sample_throughput": 73.44, "load_time_ms": 1.362, "load_throughput": 2936467.953, "learn_time_ms": 27148.06, "learn_throughput": 147.34, "update_time_ms": 5.101}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.07022512030677609, "policy_loss": -0.009528293917256016, "vf_loss": 7.969512593650049, "vf_explained_var": 0.3330367369677431, "kl": 0.007270044113405063, "entropy": 0.2110517893266934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1476000, "num_agent_steps_sampled": 1476000, "num_steps_trained": 1476000, "num_agent_steps_trained": 1476000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14760, "training_iteration": 369, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-54-35", "timestamp": 1643680475, "time_this_iter_s": 56.31009578704834, "time_total_s": 15142.599250793457, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15142.599250793457, "timesteps_since_restore": 0, "iterations_since_restore": 369, "perf": {"cpu_util_percent": 40.575, "ram_util_percent": 70.75874999999999}}
{"episode_reward_max": -1.2, "episode_reward_min": -42.4, "episode_reward_mean": -11.185000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -4.2, -4.4, -16.4, -19.6, -17.200000000000003, -7.3, -13.2, -4.300000000000001, -9.3, -16.4, -3.3, -15.799999999999999, -2.2, -3.3, -7.099999999999998, -11.3, -5.2, -14.299999999999997, -3.4, -28.0, -5.2, -14.799999999999999, -13.7, -3.3, -6.300000000000001, -4.8, -8.2, -4.4, -14.2, -7.5, -19.5, -18.600000000000005, -20.199999999999992, -15.600000000000001, -10.899999999999999, -20.3, -15.7, -15.799999999999999, -3.3, -5.300000000000001, -9.4, -4.3, -13.5, -16.699999999999996, -3.4, -4.300000000000001, -9.3, -10.399999999999999, -10.2, -5.300000000000001, -5.300000000000001, -15.099999999999998, -13.8, -15.399999999999999, -15.599999999999998, -3.2, -8.3, -11.699999999999998, -7.2, -19.2, -7.3, -11.2, -4.2, -16.3, -15.799999999999999, -3.3, -15.499999999999996, -3.3, -18.299999999999997, -6.2, -8.099999999999998, -42.4, -14.2, -14.600000000000001, -1.2, -4.4, -13.899999999999997, -20.7, -8.0, -13.899999999999997, -16.299999999999997, -23.5, -3.3, -18.0, -3.3, -16.2, -4.4, -15.099999999999998, -3.4, -19.900000000000006, -13.7, -20.3, -5.9, -9.3, -16.4, -17.099999999999998, -3.4, -4.4, -23.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.209362154574521, "mean_inference_ms": 1.7736606832971207, "mean_action_processing_ms": 0.09303369685567787, "mean_env_wait_ms": 18.077229493037542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1480000, "timesteps_this_iter": 0, "agent_timesteps_total": 1480000, "timers": {"sample_time_ms": 54632.616, "sample_throughput": 73.216, "load_time_ms": 1.348, "load_throughput": 2968368.011, "learn_time_ms": 27304.639, "learn_throughput": 146.495, "update_time_ms": 5.155}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.121757089787273, "policy_loss": -0.013928197204856382, "vf_loss": 13.558806473817876, "vf_explained_var": 0.22507291769468657, "kl": 0.012125793318277383, "entropy": 0.20584453431669103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1480000, "num_agent_steps_sampled": 1480000, "num_steps_trained": 1480000, "num_agent_steps_trained": 1480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14800, "training_iteration": 370, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-55-31", "timestamp": 1643680531, "time_this_iter_s": 56.19600701332092, "time_total_s": 15198.795257806778, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15198.795257806778, "timesteps_since_restore": 0, "iterations_since_restore": 370, "perf": {"cpu_util_percent": 34.0575, "ram_util_percent": 70.89874999999999}}
{"episode_reward_max": -1.2, "episode_reward_min": -87.3, "episode_reward_mean": -11.881000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -9.4, -4.3, -13.5, -16.699999999999996, -3.4, -4.300000000000001, -9.3, -10.399999999999999, -10.2, -5.300000000000001, -5.300000000000001, -15.099999999999998, -13.8, -15.399999999999999, -15.599999999999998, -3.2, -8.3, -11.699999999999998, -7.2, -19.2, -7.3, -11.2, -4.2, -16.3, -15.799999999999999, -3.3, -15.499999999999996, -3.3, -18.299999999999997, -6.2, -8.099999999999998, -42.4, -14.2, -14.600000000000001, -1.2, -4.4, -13.899999999999997, -20.7, -8.0, -13.899999999999997, -16.299999999999997, -23.5, -3.3, -18.0, -3.3, -16.2, -4.4, -15.099999999999998, -3.4, -19.900000000000006, -13.7, -20.3, -5.9, -9.3, -16.4, -17.099999999999998, -3.4, -4.4, -23.199999999999996, -11.399999999999997, -8.2, -4.300000000000001, -11.8, -12.899999999999997, -3.3, -87.3, -15.4, -7.5, -30.500000000000014, -3.3, -13.899999999999999, -24.799999999999997, -7.599999999999998, -13.399999999999999, -3.2, -12.799999999999997, -7.799999999999998, -8.299999999999997, -10.7, -4.300000000000001, -9.8, -16.999999999999993, -3.3, -6.2, -19.099999999999994, -7.1000000000000005, -4.4, -4.300000000000001, -4.2, -3.3, -4.700000000000001, -7.1, -31.300000000000082, -4.2, -19.500000000000004, -19.4, -12.299999999999997, -7.2, -14.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.211785284719498, "mean_inference_ms": 1.7794546714789612, "mean_action_processing_ms": 0.0933831500649254, "mean_env_wait_ms": 18.08283532647962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1484000, "timesteps_this_iter": 0, "agent_timesteps_total": 1484000, "timers": {"sample_time_ms": 55071.601, "sample_throughput": 72.633, "load_time_ms": 1.322, "load_throughput": 3024883.889, "learn_time_ms": 27388.3, "learn_throughput": 146.048, "update_time_ms": 5.009}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.37584048081289534, "policy_loss": -0.0020754746026209283, "vf_loss": 37.78561734114924, "vf_explained_var": 0.011275587479273479, "kl": 0.0074568199529596755, "entropy": 0.18355742961328517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1484000, "num_agent_steps_sampled": 1484000, "num_steps_trained": 1484000, "num_agent_steps_trained": 1484000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14840, "training_iteration": 371, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-56-27", "timestamp": 1643680587, "time_this_iter_s": 55.91310167312622, "time_total_s": 15254.708359479904, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15254.708359479904, "timesteps_since_restore": 0, "iterations_since_restore": 371, "perf": {"cpu_util_percent": 33.718987341772156, "ram_util_percent": 70.96835443037975}}
{"episode_reward_max": -3.2, "episode_reward_min": -87.3, "episode_reward_mean": -11.502000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.899999999999997, -16.299999999999997, -23.5, -3.3, -18.0, -3.3, -16.2, -4.4, -15.099999999999998, -3.4, -19.900000000000006, -13.7, -20.3, -5.9, -9.3, -16.4, -17.099999999999998, -3.4, -4.4, -23.199999999999996, -11.399999999999997, -8.2, -4.300000000000001, -11.8, -12.899999999999997, -3.3, -87.3, -15.4, -7.5, -30.500000000000014, -3.3, -13.899999999999999, -24.799999999999997, -7.599999999999998, -13.399999999999999, -3.2, -12.799999999999997, -7.799999999999998, -8.299999999999997, -10.7, -4.300000000000001, -9.8, -16.999999999999993, -3.3, -6.2, -19.099999999999994, -7.1000000000000005, -4.4, -4.300000000000001, -4.2, -3.3, -4.700000000000001, -7.1, -31.300000000000082, -4.2, -19.500000000000004, -19.4, -12.299999999999997, -7.2, -14.199999999999998, -4.300000000000001, -11.699999999999998, -3.3, -8.2, -24.3, -3.2, -15.1, -8.99999999999999, -3.2, -14.0, -9.2, -7.3, -8.2, -4.2, -14.699999999999998, -6.599999999999999, -17.3, -8.2, -7.9, -14.799999999999997, -18.1, -3.2, -6.699999999999998, -15.499999999999998, -23.799999999999997, -6.2, -4.2, -4.2, -7.9, -8.899999999999999, -3.3, -6.4, -7.199999999999999, -19.5, -25.90000000000002, -3.2, -4.4, -17.2, -10.0, -7.399999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.21394906221345, "mean_inference_ms": 1.78522363066821, "mean_action_processing_ms": 0.09372929084744949, "mean_env_wait_ms": 18.08853255695849, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1488000, "timesteps_this_iter": 0, "agent_timesteps_total": 1488000, "timers": {"sample_time_ms": 55205.93, "sample_throughput": 72.456, "load_time_ms": 1.337, "load_throughput": 2991871.032, "learn_time_ms": 27362.937, "learn_throughput": 146.183, "update_time_ms": 5.112}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.08373454300967115, "policy_loss": -0.006587583805003795, "vf_loss": 9.022609719602011, "vf_explained_var": 0.24610832993702222, "kl": 0.011976824725479424, "entropy": 0.18926471432130182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1488000, "num_agent_steps_sampled": 1488000, "num_steps_trained": 1488000, "num_agent_steps_trained": 1488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14880, "training_iteration": 372, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_01-57-23", "timestamp": 1643680643, "time_this_iter_s": 55.24781084060669, "time_total_s": 15309.95617032051, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15309.95617032051, "timesteps_since_restore": 0, "iterations_since_restore": 372, "perf": {"cpu_util_percent": 40.67435897435898, "ram_util_percent": 70.96923076923075}}
{"episode_reward_max": -3.2, "episode_reward_min": -31.300000000000082, "episode_reward_mean": -9.821000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -9.8, -16.999999999999993, -3.3, -6.2, -19.099999999999994, -7.1000000000000005, -4.4, -4.300000000000001, -4.2, -3.3, -4.700000000000001, -7.1, -31.300000000000082, -4.2, -19.500000000000004, -19.4, -12.299999999999997, -7.2, -14.199999999999998, -4.300000000000001, -11.699999999999998, -3.3, -8.2, -24.3, -3.2, -15.1, -8.99999999999999, -3.2, -14.0, -9.2, -7.3, -8.2, -4.2, -14.699999999999998, -6.599999999999999, -17.3, -8.2, -7.9, -14.799999999999997, -18.1, -3.2, -6.699999999999998, -15.499999999999998, -23.799999999999997, -6.2, -4.2, -4.2, -7.9, -8.899999999999999, -3.3, -6.4, -7.199999999999999, -19.5, -25.90000000000002, -3.2, -4.4, -17.2, -10.0, -7.399999999999997, -11.0, -22.2, -3.3, -10.9, -3.4, -8.5, -3.7, -12.099999999999998, -5.1, -17.2, -3.4, -4.2, -23.0, -5.3999999999999995, -19.700000000000003, -4.300000000000001, -4.2, -10.399999999999999, -3.4, -4.300000000000001, -3.3, -7.2, -8.599999999999998, -13.3, -3.3, -28.799999999999997, -3.4, -17.3, -8.8, -6.6, -23.000000000000053, -3.2, -9.7, -3.3, -17.2, -12.499999999999998, -13.999999999999998, -5.3, -4.4, -8.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2166836673992067, "mean_inference_ms": 1.7913616722310264, "mean_action_processing_ms": 0.09411290874502322, "mean_env_wait_ms": 18.09698040361829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1492000, "timesteps_this_iter": 0, "agent_timesteps_total": 1492000, "timers": {"sample_time_ms": 55688.999, "sample_throughput": 71.827, "load_time_ms": 1.319, "load_throughput": 3032483.687, "learn_time_ms": 116874.372, "learn_throughput": 34.225, "update_time_ms": 5.82}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.0883238417006308, "policy_loss": -0.008243779715911675, "vf_loss": 9.650205021167315, "vf_explained_var": 0.34976622455863543, "kl": 0.008177935380910412, "entropy": 0.16719792254910032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1492000, "num_agent_steps_sampled": 1492000, "num_steps_trained": 1492000, "num_agent_steps_trained": 1492000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14920, "training_iteration": 373, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_02-13-16", "timestamp": 1643681596, "time_this_iter_s": 953.0665969848633, "time_total_s": 16263.022767305374, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16263.022767305374, "timesteps_since_restore": 0, "iterations_since_restore": 373, "perf": {"cpu_util_percent": 42.612820512820505, "ram_util_percent": 70.9179487179487}}
{"episode_reward_max": -2.2, "episode_reward_min": -43.10000000000001, "episode_reward_mean": -10.98, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.1, -3.2, -6.699999999999998, -15.499999999999998, -23.799999999999997, -6.2, -4.2, -4.2, -7.9, -8.899999999999999, -3.3, -6.4, -7.199999999999999, -19.5, -25.90000000000002, -3.2, -4.4, -17.2, -10.0, -7.399999999999997, -11.0, -22.2, -3.3, -10.9, -3.4, -8.5, -3.7, -12.099999999999998, -5.1, -17.2, -3.4, -4.2, -23.0, -5.3999999999999995, -19.700000000000003, -4.300000000000001, -4.2, -10.399999999999999, -3.4, -4.300000000000001, -3.3, -7.2, -8.599999999999998, -13.3, -3.3, -28.799999999999997, -3.4, -17.3, -8.8, -6.6, -23.000000000000053, -3.2, -9.7, -3.3, -17.2, -12.499999999999998, -13.999999999999998, -5.3, -4.4, -8.399999999999999, -11.3, -23.6, -19.700000000000003, -27.5, -5.9, -4.4, -4.300000000000001, -24.3, -14.399999999999999, -20.5, -12.3, -12.7, -43.10000000000001, -3.3, -9.2, -3.3, -11.499999999999991, -8.899999999999999, -3.4, -4.300000000000001, -19.0, -5.1, -2.2, -3.3, -5.4, -11.500000000000004, -14.2, -6.9, -3.3, -11.2, -25.3, -11.100000000000001, -24.9, -16.099999999999998, -3.3, -4.2, -14.7, -15.999999999999998, -29.3, -18.600000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2174373812115693, "mean_inference_ms": 1.7947729851771748, "mean_action_processing_ms": 0.09434106067989642, "mean_env_wait_ms": 18.090880086138686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1496000, "timesteps_this_iter": 0, "agent_timesteps_total": 1496000, "timers": {"sample_time_ms": 53785.583, "sample_throughput": 74.369, "load_time_ms": 1.323, "load_throughput": 3023575.548, "learn_time_ms": 117614.868, "learn_throughput": 34.009, "update_time_ms": 6.156}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.1543175974530318, "policy_loss": -0.007116546934490563, "vf_loss": 16.13746064452715, "vf_explained_var": 0.1393490448433866, "kl": 0.007426059434717854, "entropy": 0.1862316071306185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1496000, "num_agent_steps_sampled": 1496000, "num_steps_trained": 1496000, "num_agent_steps_trained": 1496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 14960, "training_iteration": 374, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_02-14-00", "timestamp": 1643681640, "time_this_iter_s": 44.06420612335205, "time_total_s": 16307.086973428726, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16307.086973428726, "timesteps_since_restore": 0, "iterations_since_restore": 374, "perf": {"cpu_util_percent": 55.104838709677416, "ram_util_percent": 71.04999999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -67.4, "episode_reward_mean": -12.826, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -7.2, -8.599999999999998, -13.3, -3.3, -28.799999999999997, -3.4, -17.3, -8.8, -6.6, -23.000000000000053, -3.2, -9.7, -3.3, -17.2, -12.499999999999998, -13.999999999999998, -5.3, -4.4, -8.399999999999999, -11.3, -23.6, -19.700000000000003, -27.5, -5.9, -4.4, -4.300000000000001, -24.3, -14.399999999999999, -20.5, -12.3, -12.7, -43.10000000000001, -3.3, -9.2, -3.3, -11.499999999999991, -8.899999999999999, -3.4, -4.300000000000001, -19.0, -5.1, -2.2, -3.3, -5.4, -11.500000000000004, -14.2, -6.9, -3.3, -11.2, -25.3, -11.100000000000001, -24.9, -16.099999999999998, -3.3, -4.2, -14.7, -15.999999999999998, -29.3, -18.600000000000005, -3.3, -4.4, -4.300000000000001, -10.700000000000001, -17.600000000000005, -19.8, -31.10000000000005, -9.499999999999998, -11.299999999999995, -15.0, -67.4, -28.7, -4.300000000000001, -19.799999999999997, -25.6, -4.4, -15.7, -21.5, -14.499999999999998, -7.3, -46.2, -3.3, -6.999999999999998, -31.600000000000005, -3.3, -10.700000000000001, -26.799999999999997, -3.3, -15.499999999999996, -20.5, -16.599999999999998, -3.3, -4.300000000000001, -5.2, -4.300000000000001, -9.5, -5.6000000000000005, -6.699999999999998, -3.3, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4557869607737794, "mean_inference_ms": 1.7955195518869136, "mean_action_processing_ms": 0.09440590301050676, "mean_env_wait_ms": 18.789960689195087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1500000, "timesteps_this_iter": 0, "agent_timesteps_total": 1500000, "timers": {"sample_time_ms": 53153.744, "sample_throughput": 75.253, "load_time_ms": 1.23, "load_throughput": 3251839.591, "learn_time_ms": 117476.398, "learn_throughput": 34.049, "update_time_ms": 6.187}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.31808018618493633, "policy_loss": -0.009137123181254312, "vf_loss": 32.716247155076715, "vf_explained_var": -0.023062875834844447, "kl": 0.00683992050611354, "entropy": 0.16998570685184772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1500000, "num_agent_steps_sampled": 1500000, "num_steps_trained": 1500000, "num_agent_steps_trained": 1500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15000, "training_iteration": 375, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_02-29-36", "timestamp": 1643682576, "time_this_iter_s": 935.9502141475677, "time_total_s": 17243.037187576294, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 17243.037187576294, "timesteps_since_restore": 0, "iterations_since_restore": 375, "perf": {"cpu_util_percent": 46.99622641509435, "ram_util_percent": 70.94716981132075}}
{"episode_reward_max": -2.2, "episode_reward_min": -146.6, "episode_reward_mean": -14.792000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, -5.1, -2.2, -3.3, -5.4, -11.500000000000004, -14.2, -6.9, -3.3, -11.2, -25.3, -11.100000000000001, -24.9, -16.099999999999998, -3.3, -4.2, -14.7, -15.999999999999998, -29.3, -18.600000000000005, -3.3, -4.4, -4.300000000000001, -10.700000000000001, -17.600000000000005, -19.8, -31.10000000000005, -9.499999999999998, -11.299999999999995, -15.0, -67.4, -28.7, -4.300000000000001, -19.799999999999997, -25.6, -4.4, -15.7, -21.5, -14.499999999999998, -7.3, -46.2, -3.3, -6.999999999999998, -31.600000000000005, -3.3, -10.700000000000001, -26.799999999999997, -3.3, -15.499999999999996, -20.5, -16.599999999999998, -3.3, -4.300000000000001, -5.2, -4.300000000000001, -9.5, -5.6000000000000005, -6.699999999999998, -3.3, -4.300000000000001, -21.9, -4.4, -16.3, -16.2, -14.899999999999997, -12.6, -3.4, -13.4, -4.300000000000001, -19.699999999999996, -9.599999999999994, -3.6000000000000005, -3.3, -7.300000000000001, -17.900000000000002, -5.8999999999999995, -38.40000000000004, -26.2, -4.2, -18.299999999999997, -13.399999999999999, -15.999999999999998, -14.2, -5.999999999999998, -9.5, -24.6, -4.2, -4.300000000000001, -14.299999999999999, -3.3, -4.300000000000001, -22.300000000000004, -12.2, -22.900000000000006, -146.6, -20.800000000000008, -26.600000000000005, -21.4, -3.2, -14.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.693063143942207, "mean_inference_ms": 1.7963402312670738, "mean_action_processing_ms": 0.09446654723035675, "mean_env_wait_ms": 20.444463400671182, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1504000, "timesteps_this_iter": 0, "agent_timesteps_total": 1504000, "timers": {"sample_time_ms": 52550.399, "sample_throughput": 76.117, "load_time_ms": 1.139, "load_throughput": 3510465.35, "learn_time_ms": 115896.047, "learn_throughput": 34.514, "update_time_ms": 6.194}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.9620515945860716, "policy_loss": -0.0051240644668058685, "vf_loss": 96.71047651716458, "vf_explained_var": 0.014633658111736338, "kl": 0.008844479719222389, "entropy": 0.1914717701453996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1504000, "num_agent_steps_sampled": 1504000, "num_steps_trained": 1504000, "num_agent_steps_trained": 1504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15040, "training_iteration": 376, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_02-45-08", "timestamp": 1643683508, "time_this_iter_s": 932.2859902381897, "time_total_s": 18175.323177814484, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 18175.323177814484, "timesteps_since_restore": 0, "iterations_since_restore": 376, "perf": {"cpu_util_percent": 43.09166666666666, "ram_util_percent": 70.82916666666667}}
{"episode_reward_max": -1.3, "episode_reward_min": -146.6, "episode_reward_mean": -13.642000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.2, -3.3, -6.999999999999998, -31.600000000000005, -3.3, -10.700000000000001, -26.799999999999997, -3.3, -15.499999999999996, -20.5, -16.599999999999998, -3.3, -4.300000000000001, -5.2, -4.300000000000001, -9.5, -5.6000000000000005, -6.699999999999998, -3.3, -4.300000000000001, -21.9, -4.4, -16.3, -16.2, -14.899999999999997, -12.6, -3.4, -13.4, -4.300000000000001, -19.699999999999996, -9.599999999999994, -3.6000000000000005, -3.3, -7.300000000000001, -17.900000000000002, -5.8999999999999995, -38.40000000000004, -26.2, -4.2, -18.299999999999997, -13.399999999999999, -15.999999999999998, -14.2, -5.999999999999998, -9.5, -24.6, -4.2, -4.300000000000001, -14.299999999999999, -3.3, -4.300000000000001, -22.300000000000004, -12.2, -22.900000000000006, -146.6, -20.800000000000008, -26.600000000000005, -21.4, -3.2, -14.2, -3.3, -18.4, -10.1, -13.600000000000001, -3.3, -4.2, -4.300000000000001, -20.699999999999996, -3.2, -23.2, -15.699999999999992, -4.3, -12.3, -4.4, -4.300000000000001, -22.6, -3.2, -5.4, -5.699999999999999, -27.700000000000003, -19.800000000000004, -3.4, -5.300000000000001, -24.2, -30.400000000000002, -6.700000000000001, -11.600000000000001, -11.9, -13.5, -8.9, -1.3, -3.3, -15.499999999999979, -23.4, -17.5, -21.9, -10.99999999999999, -3.3, -4.4, -19.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9318847969761648, "mean_inference_ms": 1.799788586510296, "mean_action_processing_ms": 0.09467921153431608, "mean_env_wait_ms": 21.629610781888406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1508000, "timesteps_this_iter": 0, "agent_timesteps_total": 1508000, "timers": {"sample_time_ms": 51061.783, "sample_throughput": 78.336, "load_time_ms": 1.134, "load_throughput": 3527367.071, "learn_time_ms": 204059.352, "learn_throughput": 19.602, "update_time_ms": 5.874}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.11435806705986941, "policy_loss": -0.005760069995597806, "vf_loss": 12.005154144828037, "vf_explained_var": 0.25569494296145695, "kl": 0.008306328225317888, "entropy": 0.17084632760654855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1508000, "num_agent_steps_sampled": 1508000, "num_steps_trained": 1508000, "num_agent_steps_trained": 1508000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15080, "training_iteration": 377, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-00-47", "timestamp": 1643684447, "time_this_iter_s": 938.8330769538879, "time_total_s": 19114.15625476837, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19114.15625476837, "timesteps_since_restore": 0, "iterations_since_restore": 377, "perf": {"cpu_util_percent": 38.21551724137931, "ram_util_percent": 70.77586206896552}}
{"episode_reward_max": -1.3, "episode_reward_min": -146.6, "episode_reward_mean": -12.418, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.399999999999999, -15.999999999999998, -14.2, -5.999999999999998, -9.5, -24.6, -4.2, -4.300000000000001, -14.299999999999999, -3.3, -4.300000000000001, -22.300000000000004, -12.2, -22.900000000000006, -146.6, -20.800000000000008, -26.600000000000005, -21.4, -3.2, -14.2, -3.3, -18.4, -10.1, -13.600000000000001, -3.3, -4.2, -4.300000000000001, -20.699999999999996, -3.2, -23.2, -15.699999999999992, -4.3, -12.3, -4.4, -4.300000000000001, -22.6, -3.2, -5.4, -5.699999999999999, -27.700000000000003, -19.800000000000004, -3.4, -5.300000000000001, -24.2, -30.400000000000002, -6.700000000000001, -11.600000000000001, -11.9, -13.5, -8.9, -1.3, -3.3, -15.499999999999979, -23.4, -17.5, -21.9, -10.99999999999999, -3.3, -4.4, -19.599999999999998, -4.300000000000001, -19.5, -9.299999999999995, -16.7, -30.00000000000001, -4.2, -4.2, -6.5, -7.299999999999999, -10.5, -4.2, -4.300000000000001, -4.300000000000001, -4.6000000000000005, -6.500000000000002, -25.2, -5.3, -14.999999999999998, -6.8999999999999995, -3.3, -4.300000000000001, -19.700000000000006, -4.3, -6.2, -22.4, -26.5, -16.899999999999995, -4.300000000000001, -4.300000000000001, -4.4, -3.8000000000000007, -3.2, -10.0, -14.8, -7.8, -4.4, -4.300000000000001, -4.300000000000001, -9.5, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9314036504204295, "mean_inference_ms": 1.8043926971304023, "mean_action_processing_ms": 0.0949569609922224, "mean_env_wait_ms": 22.100271040831167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1512000, "timesteps_this_iter": 0, "agent_timesteps_total": 1512000, "timers": {"sample_time_ms": 49193.096, "sample_throughput": 81.312, "load_time_ms": 1.109, "load_throughput": 3608469.05, "learn_time_ms": 204033.005, "learn_throughput": 19.605, "update_time_ms": 5.846}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.07654415606771425, "policy_loss": -0.019281025689535883, "vf_loss": 9.567405757227892, "vf_explained_var": 0.08306547005971272, "kl": 0.01884840931557162, "entropy": 0.17732831472831387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1512000, "num_agent_steps_sampled": 1512000, "num_steps_trained": 1512000, "num_agent_steps_trained": 1512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15120, "training_iteration": 378, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-01-40", "timestamp": 1643684500, "time_this_iter_s": 52.61605906486511, "time_total_s": 19166.772313833237, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19166.772313833237, "timesteps_since_restore": 0, "iterations_since_restore": 378, "perf": {"cpu_util_percent": 37.31621621621622, "ram_util_percent": 70.73513513513514}}
{"episode_reward_max": -1.3, "episode_reward_min": -56.20000000000002, "episode_reward_mean": -11.324000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.800000000000004, -3.4, -5.300000000000001, -24.2, -30.400000000000002, -6.700000000000001, -11.600000000000001, -11.9, -13.5, -8.9, -1.3, -3.3, -15.499999999999979, -23.4, -17.5, -21.9, -10.99999999999999, -3.3, -4.4, -19.599999999999998, -4.300000000000001, -19.5, -9.299999999999995, -16.7, -30.00000000000001, -4.2, -4.2, -6.5, -7.299999999999999, -10.5, -4.2, -4.300000000000001, -4.300000000000001, -4.6000000000000005, -6.500000000000002, -25.2, -5.3, -14.999999999999998, -6.8999999999999995, -3.3, -4.300000000000001, -19.700000000000006, -4.3, -6.2, -22.4, -26.5, -16.899999999999995, -4.300000000000001, -4.300000000000001, -4.4, -3.8000000000000007, -3.2, -10.0, -14.8, -7.8, -4.4, -4.300000000000001, -4.300000000000001, -9.5, -3.2, -13.599999999999998, -13.699999999999998, -3.8000000000000003, -18.099999999999994, -9.8, -13.2, -5.700000000000001, -11.5, -3.4, -20.6, -4.2, -18.700000000000003, -3.4000000000000004, -16.2, -3.2, -5.4, -27.2, -15.799999999999999, -4.2, -9.3, -7.299999999999999, -18.700000000000003, -3.2, -4.300000000000001, -8.2, -6.300000000000001, -14.3, -15.299999999999997, -16.7, -56.20000000000002, -4.300000000000001, -18.3, -7.2, -5.4, -34.8, -6.4, -6.8999999999999995, -19.5, -19.999999999999996, -10.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9311748845386614, "mean_inference_ms": 1.8092780070826624, "mean_action_processing_ms": 0.09525034210001423, "mean_env_wait_ms": 22.092566086162254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1516000, "timesteps_this_iter": 0, "agent_timesteps_total": 1516000, "timers": {"sample_time_ms": 48962.099, "sample_throughput": 81.696, "load_time_ms": 1.108, "load_throughput": 3609555.938, "learn_time_ms": 203935.753, "learn_throughput": 19.614, "update_time_ms": 5.916}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.2701023591882599, "policy_loss": -0.0017050623906255569, "vf_loss": 27.172783069440754, "vf_explained_var": 0.0824790047701969, "kl": 0.009927104175937168, "entropy": 0.17714682926413833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1516000, "num_agent_steps_sampled": 1516000, "num_steps_trained": 1516000, "num_agent_steps_trained": 1516000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15160, "training_iteration": 379, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-02-33", "timestamp": 1643684553, "time_this_iter_s": 53.2891149520874, "time_total_s": 19220.061428785324, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19220.061428785324, "timesteps_since_restore": 0, "iterations_since_restore": 379, "perf": {"cpu_util_percent": 23.80526315789474, "ram_util_percent": 70.69342105263156}}
{"episode_reward_max": -2.2, "episode_reward_min": -56.20000000000002, "episode_reward_mean": -11.445000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -19.700000000000006, -4.3, -6.2, -22.4, -26.5, -16.899999999999995, -4.300000000000001, -4.300000000000001, -4.4, -3.8000000000000007, -3.2, -10.0, -14.8, -7.8, -4.4, -4.300000000000001, -4.300000000000001, -9.5, -3.2, -13.599999999999998, -13.699999999999998, -3.8000000000000003, -18.099999999999994, -9.8, -13.2, -5.700000000000001, -11.5, -3.4, -20.6, -4.2, -18.700000000000003, -3.4000000000000004, -16.2, -3.2, -5.4, -27.2, -15.799999999999999, -4.2, -9.3, -7.299999999999999, -18.700000000000003, -3.2, -4.300000000000001, -8.2, -6.300000000000001, -14.3, -15.299999999999997, -16.7, -56.20000000000002, -4.300000000000001, -18.3, -7.2, -5.4, -34.8, -6.4, -6.8999999999999995, -19.5, -19.999999999999996, -10.499999999999998, -6.499999999999999, -3.3, -14.299999999999999, -13.5, -20.4, -5.300000000000001, -13.2, -3.3, -4.2, -10.3, -5.4, -9.2, -9.3, -28.099999999999998, -17.2, -16.199999999999996, -3.3, -5.9, -9.6, -3.7000000000000006, -2.2, -14.4, -3.2, -13.5, -11.799999999999999, -13.299999999999997, -22.00000000000001, -15.700000000000001, -9.5, -12.3, -12.2, -20.2, -12.600000000000001, -17.7, -4.300000000000001, -19.5, -3.2, -17.5, -19.4, -14.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.930984991974845, "mean_inference_ms": 1.8140984837062137, "mean_action_processing_ms": 0.09554728478309031, "mean_env_wait_ms": 22.08444492293487, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1520000, "timesteps_this_iter": 0, "agent_timesteps_total": 1520000, "timers": {"sample_time_ms": 48703.731, "sample_throughput": 82.129, "load_time_ms": 1.097, "load_throughput": 3646031.946, "learn_time_ms": 203823.133, "learn_throughput": 19.625, "update_time_ms": 5.933}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00801807660609484, "cur_lr": 0.00010000000000000003, "total_loss": 0.09622777570389532, "policy_loss": -0.011861377554414894, "vf_loss": 10.789569743442279, "vf_explained_var": 0.29445864853038584, "kl": 0.024128062249773253, "entropy": 0.21677369227813137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1520000, "num_agent_steps_sampled": 1520000, "num_steps_trained": 1520000, "num_agent_steps_trained": 1520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15200, "training_iteration": 380, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-03-27", "timestamp": 1643684607, "time_this_iter_s": 53.49383902549744, "time_total_s": 19273.55526781082, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19273.55526781082, "timesteps_since_restore": 0, "iterations_since_restore": 380, "perf": {"cpu_util_percent": 26.862666666666666, "ram_util_percent": 70.72800000000001}}
{"episode_reward_max": -2.2, "episode_reward_min": -84.2, "episode_reward_mean": -13.599000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.299999999999999, -18.700000000000003, -3.2, -4.300000000000001, -8.2, -6.300000000000001, -14.3, -15.299999999999997, -16.7, -56.20000000000002, -4.300000000000001, -18.3, -7.2, -5.4, -34.8, -6.4, -6.8999999999999995, -19.5, -19.999999999999996, -10.499999999999998, -6.499999999999999, -3.3, -14.299999999999999, -13.5, -20.4, -5.300000000000001, -13.2, -3.3, -4.2, -10.3, -5.4, -9.2, -9.3, -28.099999999999998, -17.2, -16.199999999999996, -3.3, -5.9, -9.6, -3.7000000000000006, -2.2, -14.4, -3.2, -13.5, -11.799999999999999, -13.299999999999997, -22.00000000000001, -15.700000000000001, -9.5, -12.3, -12.2, -20.2, -12.600000000000001, -17.7, -4.300000000000001, -19.5, -3.2, -17.5, -19.4, -14.4, -18.0, -18.0, -26.5, -7.4, -14.899999999999999, -4.3, -23.700000000000003, -46.4, -4.2, -15.799999999999999, -3.4, -10.3, -84.2, -9.799999999999999, -6.299999999999999, -7.3, -6.2, -12.399999999999995, -13.2, -5.3, -18.900000000000006, -10.4, -18.1, -7.2, -12.0, -5.300000000000001, -80.49999999999997, -17.6, -6.4, -14.6, -12.7, -4.3, -7.2, -9.2, -5.700000000000001, -5.3, -7.4, -11.399999999999999, -18.9, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9310342455151797, "mean_inference_ms": 1.819097681572349, "mean_action_processing_ms": 0.0958544524641005, "mean_env_wait_ms": 22.076532166332953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1524000, "timesteps_this_iter": 0, "agent_timesteps_total": 1524000, "timers": {"sample_time_ms": 48424.796, "sample_throughput": 82.602, "load_time_ms": 1.096, "load_throughput": 3649998.042, "learn_time_ms": 203711.257, "learn_throughput": 19.636, "update_time_ms": 5.828}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.6878027680072112, "policy_loss": -0.00963453091480719, "vf_loss": 69.73069578351513, "vf_explained_var": 0.1953374892793676, "kl": 0.010837878981165118, "entropy": 0.21191364102946814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1524000, "num_agent_steps_sampled": 1524000, "num_steps_trained": 1524000, "num_agent_steps_trained": 1524000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15240, "training_iteration": 381, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-04-20", "timestamp": 1643684660, "time_this_iter_s": 53.1150221824646, "time_total_s": 19326.670289993286, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19326.670289993286, "timesteps_since_restore": 0, "iterations_since_restore": 381, "perf": {"cpu_util_percent": 27.271052631578947, "ram_util_percent": 70.8}}
{"episode_reward_max": -2.2, "episode_reward_min": -84.2, "episode_reward_mean": -13.833, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2, -14.4, -3.2, -13.5, -11.799999999999999, -13.299999999999997, -22.00000000000001, -15.700000000000001, -9.5, -12.3, -12.2, -20.2, -12.600000000000001, -17.7, -4.300000000000001, -19.5, -3.2, -17.5, -19.4, -14.4, -18.0, -18.0, -26.5, -7.4, -14.899999999999999, -4.3, -23.700000000000003, -46.4, -4.2, -15.799999999999999, -3.4, -10.3, -84.2, -9.799999999999999, -6.299999999999999, -7.3, -6.2, -12.399999999999995, -13.2, -5.3, -18.900000000000006, -10.4, -18.1, -7.2, -12.0, -5.300000000000001, -80.49999999999997, -17.6, -6.4, -14.6, -12.7, -4.3, -7.2, -9.2, -5.700000000000001, -5.3, -7.4, -11.399999999999999, -18.9, -4.3, -6.3, -13.199999999999989, -15.299999999999974, -18.4, -18.099999999999994, -19.4, -18.7, -8.5, -18.4, -15.299999999999997, -18.600000000000012, -12.499999999999998, -8.3, -8.6, -13.5, -43.2, -3.2, -12.3, -7.3, -6.2, -18.6, -18.6, -14.499999999999977, -11.5, -8.3, -18.799999999999997, -6.3, -6.300000000000001, -17.9, -24.2, -5.300000000000001, -9.2, -4.800000000000001, -13.3, -7.199999999999999, -4.2, -7.2, -6.300000000000001, -12.9, -8.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9309333161686997, "mean_inference_ms": 1.8240868783823303, "mean_action_processing_ms": 0.09616163998621013, "mean_env_wait_ms": 22.068234048746262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1528000, "timesteps_this_iter": 0, "agent_timesteps_total": 1528000, "timers": {"sample_time_ms": 48160.242, "sample_throughput": 83.056, "load_time_ms": 1.073, "load_throughput": 3728187.374, "learn_time_ms": 203647.744, "learn_throughput": 19.642, "update_time_ms": 5.688}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.15676016488553135, "policy_loss": -0.012817870079469617, "vf_loss": 16.9379330319743, "vf_explained_var": 0.14183006299439296, "kl": 0.016521620121868894, "entropy": 0.2591663845203897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1528000, "num_agent_steps_sampled": 1528000, "num_steps_trained": 1528000, "num_agent_steps_trained": 1528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15280, "training_iteration": 382, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-05-13", "timestamp": 1643684713, "time_this_iter_s": 53.09079694747925, "time_total_s": 19379.761086940765, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19379.761086940765, "timesteps_since_restore": 0, "iterations_since_restore": 382, "perf": {"cpu_util_percent": 28.821333333333325, "ram_util_percent": 70.76}}
{"episode_reward_max": -3.2, "episode_reward_min": -80.49999999999997, "episode_reward_mean": -12.693000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.900000000000006, -10.4, -18.1, -7.2, -12.0, -5.300000000000001, -80.49999999999997, -17.6, -6.4, -14.6, -12.7, -4.3, -7.2, -9.2, -5.700000000000001, -5.3, -7.4, -11.399999999999999, -18.9, -4.3, -6.3, -13.199999999999989, -15.299999999999974, -18.4, -18.099999999999994, -19.4, -18.7, -8.5, -18.4, -15.299999999999997, -18.600000000000012, -12.499999999999998, -8.3, -8.6, -13.5, -43.2, -3.2, -12.3, -7.3, -6.2, -18.6, -18.6, -14.499999999999977, -11.5, -8.3, -18.799999999999997, -6.3, -6.300000000000001, -17.9, -24.2, -5.300000000000001, -9.2, -4.800000000000001, -13.3, -7.199999999999999, -4.2, -7.2, -6.300000000000001, -12.9, -8.7, -5.8999999999999995, -5.2, -14.5, -37.2, -5.3, -7.300000000000001, -5.4, -12.5, -5.4, -21.2, -6.4, -4.700000000000001, -4.3, -6.3, -7.4, -7.4, -13.5, -36.2, -7.5, -15.199999999999998, -5.800000000000001, -8.9, -13.299999999999997, -6.7, -6.300000000000001, -46.2, -7.1, -5.2, -14.799999999999999, -11.899999999999997, -7.300000000000001, -6.2, -23.799999999999997, -26.2, -12.999999999999986, -3.7, -9.5, -18.700000000000003, -9.7, -9.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.930287905014836, "mean_inference_ms": 1.8286260152991525, "mean_action_processing_ms": 0.09643316628590835, "mean_env_wait_ms": 22.0565171144518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1532000, "timesteps_this_iter": 0, "agent_timesteps_total": 1532000, "timers": {"sample_time_ms": 47142.095, "sample_throughput": 84.85, "load_time_ms": 1.096, "load_throughput": 3649204.133, "learn_time_ms": 114162.335, "learn_throughput": 35.038, "update_time_ms": 4.951}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.17724258134226686, "policy_loss": -0.013551182271812552, "vf_loss": 19.06453385583816, "vf_explained_var": 0.11520561281070914, "kl": 0.012341543227117118, "entropy": 0.2175713922427867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1532000, "num_agent_steps_sampled": 1532000, "num_steps_trained": 1532000, "num_agent_steps_trained": 1532000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15320, "training_iteration": 383, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-06-02", "timestamp": 1643684762, "time_this_iter_s": 48.67630481719971, "time_total_s": 19428.437391757965, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19428.437391757965, "timesteps_since_restore": 0, "iterations_since_restore": 383, "perf": {"cpu_util_percent": 20.4536231884058, "ram_util_percent": 70.83768115942026}}
{"episode_reward_max": -3.4, "episode_reward_min": -46.2, "episode_reward_mean": -11.976999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.6, -18.6, -14.499999999999977, -11.5, -8.3, -18.799999999999997, -6.3, -6.300000000000001, -17.9, -24.2, -5.300000000000001, -9.2, -4.800000000000001, -13.3, -7.199999999999999, -4.2, -7.2, -6.300000000000001, -12.9, -8.7, -5.8999999999999995, -5.2, -14.5, -37.2, -5.3, -7.300000000000001, -5.4, -12.5, -5.4, -21.2, -6.4, -4.700000000000001, -4.3, -6.3, -7.4, -7.4, -13.5, -36.2, -7.5, -15.199999999999998, -5.800000000000001, -8.9, -13.299999999999997, -6.7, -6.300000000000001, -46.2, -7.1, -5.2, -14.799999999999999, -11.899999999999997, -7.300000000000001, -6.2, -23.799999999999997, -26.2, -12.999999999999986, -3.7, -9.5, -18.700000000000003, -9.7, -9.4, -15.199999999999998, -15.699999999999998, -8.399999999999999, -42.2, -4.3, -20.800000000000026, -15.999999999999998, -9.999999999999998, -8.3, -16.599999999999994, -6.3, -13.199999999999973, -13.499999999999998, -5.3, -20.2, -9.4, -10.0, -17.700000000000003, -8.199999999999998, -4.4, -3.4, -9.3, -21.600000000000048, -18.1, -13.099999999999998, -5.0, -18.0, -5.300000000000001, -12.199999999999998, -22.799999999999997, -13.199999999999998, -5.2, -10.299999999999986, -10.7, -12.0, -6.6000000000000005, -6.3, -11.6, -10.999999999999998, -9.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9295667481350107, "mean_inference_ms": 1.8329947227951449, "mean_action_processing_ms": 0.0966949064054127, "mean_env_wait_ms": 22.044175375263826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1536000, "timesteps_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"sample_time_ms": 48933.202, "sample_throughput": 81.744, "load_time_ms": 1.09, "load_throughput": 3669236.287, "learn_time_ms": 113395.417, "learn_throughput": 35.275, "update_time_ms": 4.661}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.11860649504007832, "policy_loss": 0.000246167911957669, "vf_loss": 11.824690422960506, "vf_explained_var": 0.2004729906717936, "kl": 0.009430865130913915, "entropy": 0.23294416906772764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1536000, "num_agent_steps_sampled": 1536000, "num_steps_trained": 1536000, "num_agent_steps_trained": 1536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15360, "training_iteration": 384, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-06-54", "timestamp": 1643684814, "time_this_iter_s": 52.37842583656311, "time_total_s": 19480.81581759453, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19480.81581759453, "timesteps_since_restore": 0, "iterations_since_restore": 384, "perf": {"cpu_util_percent": 26.70135135135135, "ram_util_percent": 70.87702702702703}}
{"episode_reward_max": -2.2, "episode_reward_min": -46.2, "episode_reward_mean": -13.200999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.800000000000001, -8.9, -13.299999999999997, -6.7, -6.300000000000001, -46.2, -7.1, -5.2, -14.799999999999999, -11.899999999999997, -7.300000000000001, -6.2, -23.799999999999997, -26.2, -12.999999999999986, -3.7, -9.5, -18.700000000000003, -9.7, -9.4, -15.199999999999998, -15.699999999999998, -8.399999999999999, -42.2, -4.3, -20.800000000000026, -15.999999999999998, -9.999999999999998, -8.3, -16.599999999999994, -6.3, -13.199999999999973, -13.499999999999998, -5.3, -20.2, -9.4, -10.0, -17.700000000000003, -8.199999999999998, -4.4, -3.4, -9.3, -21.600000000000048, -18.1, -13.099999999999998, -5.0, -18.0, -5.300000000000001, -12.199999999999998, -22.799999999999997, -13.199999999999998, -5.2, -10.299999999999986, -10.7, -12.0, -6.6000000000000005, -6.3, -11.6, -10.999999999999998, -9.7, -2.2, -5.2, -9.1, -18.800000000000008, -17.699999999999996, -4.3, -19.3, -18.2, -23.7, -6.2, -15.19999999999998, -10.9, -22.2, -16.6, -10.599999999999989, -11.3, -10.999999999999998, -8.799999999999999, -3.2, -22.700000000000003, -15.2, -11.999999999999998, -4.3, -24.4, -18.299999999999997, -37.7, -5.300000000000001, -6.2, -17.1, -15.6, -29.199999999999996, -28.3, -20.700000000000003, -11.599999999999998, -7.399999999999999, -5.300000000000001, -28.3, -6.3, -7.300000000000001, -17.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9289907741901366, "mean_inference_ms": 1.8374480362456678, "mean_action_processing_ms": 0.0969615540112767, "mean_env_wait_ms": 22.032989186026047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1540000, "timesteps_this_iter": 0, "agent_timesteps_total": 1540000, "timers": {"sample_time_ms": 49499.394, "sample_throughput": 80.809, "load_time_ms": 1.184, "load_throughput": 3378212.351, "learn_time_ms": 113636.481, "learn_throughput": 35.2, "update_time_ms": 4.568}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.18827535248091143, "policy_loss": -0.0055513858039092315, "vf_loss": 19.372528388295123, "vf_explained_var": 0.2162511965279938, "kl": 0.008435755682952057, "entropy": 0.228607246311762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1540000, "num_agent_steps_sampled": 1540000, "num_steps_trained": 1540000, "num_agent_steps_trained": 1540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15400, "training_iteration": 385, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-07-48", "timestamp": 1643684868, "time_this_iter_s": 53.81396698951721, "time_total_s": 19534.629784584045, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19534.629784584045, "timesteps_since_restore": 0, "iterations_since_restore": 385, "perf": {"cpu_util_percent": 29.043421052631583, "ram_util_percent": 70.88684210526314}}
{"episode_reward_max": -2.2, "episode_reward_min": -37.7, "episode_reward_mean": -12.863999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -9.3, -21.600000000000048, -18.1, -13.099999999999998, -5.0, -18.0, -5.300000000000001, -12.199999999999998, -22.799999999999997, -13.199999999999998, -5.2, -10.299999999999986, -10.7, -12.0, -6.6000000000000005, -6.3, -11.6, -10.999999999999998, -9.7, -2.2, -5.2, -9.1, -18.800000000000008, -17.699999999999996, -4.3, -19.3, -18.2, -23.7, -6.2, -15.19999999999998, -10.9, -22.2, -16.6, -10.599999999999989, -11.3, -10.999999999999998, -8.799999999999999, -3.2, -22.700000000000003, -15.2, -11.999999999999998, -4.3, -24.4, -18.299999999999997, -37.7, -5.300000000000001, -6.2, -17.1, -15.6, -29.199999999999996, -28.3, -20.700000000000003, -11.599999999999998, -7.399999999999999, -5.300000000000001, -28.3, -6.3, -7.300000000000001, -17.6, -4.2, -19.800000000000004, -28.500000000000007, -9.699999999999998, -12.099999999999998, -7.799999999999998, -6.300000000000001, -19.300000000000004, -10.499999999999993, -25.600000000000005, -20.099999999999998, -6.3, -5.300000000000001, -7.099999999999998, -16.7, -8.2, -14.2, -11.5, -14.799999999999997, -9.3, -5.3, -16.799999999999997, -11.999999999999998, -9.7, -4.3, -12.799999999999997, -3.2, -7.300000000000001, -7.2, -27.7, -3.3, -9.3, -23.10000000000001, -14.999999999999996, -5.2, -17.499999999999996, -11.399999999999999, -9.3, -17.7, -10.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.928762609583016, "mean_inference_ms": 1.8421526255493417, "mean_action_processing_ms": 0.09725609409816702, "mean_env_wait_ms": 22.023889133122907, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1544000, "timesteps_this_iter": 0, "agent_timesteps_total": 1544000, "timers": {"sample_time_ms": 50189.47, "sample_throughput": 79.698, "load_time_ms": 1.273, "load_throughput": 3141036.077, "learn_time_ms": 115047.05, "learn_throughput": 34.768, "update_time_ms": 4.544}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.12086749254495546, "policy_loss": -0.012196958584771041, "vf_loss": 13.295586602790381, "vf_explained_var": 0.23353979645236847, "kl": 0.009028414318286333, "entropy": 0.24325126892616672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1544000, "num_agent_steps_sampled": 1544000, "num_steps_trained": 1544000, "num_agent_steps_trained": 1544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15440, "training_iteration": 386, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-08-41", "timestamp": 1643684921, "time_this_iter_s": 53.03060293197632, "time_total_s": 19587.66038751602, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19587.66038751602, "timesteps_since_restore": 0, "iterations_since_restore": 386, "perf": {"cpu_util_percent": 27.858666666666668, "ram_util_percent": 70.92533333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.00000000000002, "episode_reward_mean": -12.481000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.2, -11.999999999999998, -4.3, -24.4, -18.299999999999997, -37.7, -5.300000000000001, -6.2, -17.1, -15.6, -29.199999999999996, -28.3, -20.700000000000003, -11.599999999999998, -7.399999999999999, -5.300000000000001, -28.3, -6.3, -7.300000000000001, -17.6, -4.2, -19.800000000000004, -28.500000000000007, -9.699999999999998, -12.099999999999998, -7.799999999999998, -6.300000000000001, -19.300000000000004, -10.499999999999993, -25.600000000000005, -20.099999999999998, -6.3, -5.300000000000001, -7.099999999999998, -16.7, -8.2, -14.2, -11.5, -14.799999999999997, -9.3, -5.3, -16.799999999999997, -11.999999999999998, -9.7, -4.3, -12.799999999999997, -3.2, -7.300000000000001, -7.2, -27.7, -3.3, -9.3, -23.10000000000001, -14.999999999999996, -5.2, -17.499999999999996, -11.399999999999999, -9.3, -17.7, -10.299999999999997, -19.3, -4.3, -5.300000000000001, -5.300000000000001, -18.199999999999996, -6.2, -13.2, -16.5, -6.3, -4.2, -10.399999999999999, -22.4, -11.3, -22.900000000000006, -3.3, -22.700000000000003, -10.3, -13.899999999999997, -5.3, -5.2, -14.2, -8.1, -23.099999999999998, -6.300000000000001, -5.300000000000001, -44.00000000000002, -5.8999999999999995, -13.6, -10.100000000000001, -4.2, -6.6, -4.2, -15.799999999999999, -3.8000000000000003, -13.799999999999999, -5.3, -16.4, -4.2, -6.2, -6.699999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9288287982642633, "mean_inference_ms": 1.846896292489435, "mean_action_processing_ms": 0.09755532071960048, "mean_env_wait_ms": 22.01495402531261, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1548000, "timesteps_this_iter": 0, "agent_timesteps_total": 1548000, "timers": {"sample_time_ms": 51304.25, "sample_throughput": 77.966, "load_time_ms": 1.275, "load_throughput": 3136866.353, "learn_time_ms": 26832.849, "learn_throughput": 149.071, "update_time_ms": 4.974}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.14951929217304594, "policy_loss": -0.002518777295907018, "vf_loss": 15.186442964435905, "vf_explained_var": 0.32611346462721463, "kl": 0.014437379678796752, "entropy": 0.22279669718957076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1548000, "num_agent_steps_sampled": 1548000, "num_steps_trained": 1548000, "num_agent_steps_trained": 1548000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15480, "training_iteration": 387, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-09-35", "timestamp": 1643684975, "time_this_iter_s": 53.75505876541138, "time_total_s": 19641.415446281433, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19641.415446281433, "timesteps_since_restore": 0, "iterations_since_restore": 387, "perf": {"cpu_util_percent": 22.542105263157897, "ram_util_percent": 70.89342105263158}}
{"episode_reward_max": -2.5, "episode_reward_min": -80.8, "episode_reward_mean": -11.105, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3, -16.799999999999997, -11.999999999999998, -9.7, -4.3, -12.799999999999997, -3.2, -7.300000000000001, -7.2, -27.7, -3.3, -9.3, -23.10000000000001, -14.999999999999996, -5.2, -17.499999999999996, -11.399999999999999, -9.3, -17.7, -10.299999999999997, -19.3, -4.3, -5.300000000000001, -5.300000000000001, -18.199999999999996, -6.2, -13.2, -16.5, -6.3, -4.2, -10.399999999999999, -22.4, -11.3, -22.900000000000006, -3.3, -22.700000000000003, -10.3, -13.899999999999997, -5.3, -5.2, -14.2, -8.1, -23.099999999999998, -6.300000000000001, -5.300000000000001, -44.00000000000002, -5.8999999999999995, -13.6, -10.100000000000001, -4.2, -6.6, -4.2, -15.799999999999999, -3.8000000000000003, -13.799999999999999, -5.3, -16.4, -4.2, -6.2, -6.699999999999999, -4.300000000000001, -17.1, -80.8, -2.5, -16.899999999999988, -17.299999999999997, -14.9, -4.3, -10.8, -4.2, -4.300000000000001, -7.300000000000001, -6.9, -8.3, -9.2, -4.300000000000001, -5.300000000000001, -8.099999999999996, -13.199999999999989, -4.2, -4.4, -44.20000000000006, -3.3, -4.300000000000001, -6.4, -6.2, -10.49999999999999, -9.599999999999998, -3.3, -23.2, -5.4, -9.9, -3.3, -11.099999999999996, -6.300000000000001, -8.2, -4.300000000000001, -5.4, -20.1, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.929036396207873, "mean_inference_ms": 1.8516286518284801, "mean_action_processing_ms": 0.09784377261745007, "mean_env_wait_ms": 22.006726643484935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1552000, "timesteps_this_iter": 0, "agent_timesteps_total": 1552000, "timers": {"sample_time_ms": 52993.921, "sample_throughput": 75.48, "load_time_ms": 1.276, "load_throughput": 3135459.371, "learn_time_ms": 26745.022, "learn_throughput": 149.561, "update_time_ms": 4.889}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.3081491565462002, "policy_loss": -0.017101014011930073, "vf_loss": 32.5112350179944, "vf_explained_var": 0.08427939402159824, "kl": 0.011459382099390854, "entropy": 0.20479482073457012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1552000, "num_agent_steps_sampled": 1552000, "num_steps_trained": 1552000, "num_agent_steps_trained": 1552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15520, "training_iteration": 388, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-10-29", "timestamp": 1643685029, "time_this_iter_s": 53.727622747421265, "time_total_s": 19695.143069028854, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19695.143069028854, "timesteps_since_restore": 0, "iterations_since_restore": 388, "perf": {"cpu_util_percent": 29.757894736842104, "ram_util_percent": 70.91184210526313}}
{"episode_reward_max": -1.3, "episode_reward_min": -80.8, "episode_reward_mean": -10.178000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.2, -8.1, -23.099999999999998, -6.300000000000001, -5.300000000000001, -44.00000000000002, -5.8999999999999995, -13.6, -10.100000000000001, -4.2, -6.6, -4.2, -15.799999999999999, -3.8000000000000003, -13.799999999999999, -5.3, -16.4, -4.2, -6.2, -6.699999999999999, -4.300000000000001, -17.1, -80.8, -2.5, -16.899999999999988, -17.299999999999997, -14.9, -4.3, -10.8, -4.2, -4.300000000000001, -7.300000000000001, -6.9, -8.3, -9.2, -4.300000000000001, -5.300000000000001, -8.099999999999996, -13.199999999999989, -4.2, -4.4, -44.20000000000006, -3.3, -4.300000000000001, -6.4, -6.2, -10.49999999999999, -9.599999999999998, -3.3, -23.2, -5.4, -9.9, -3.3, -11.099999999999996, -6.300000000000001, -8.2, -4.300000000000001, -5.4, -20.1, -4.2, -10.799999999999999, -5.0, -3.4, -7.2, -4.2, -16.7, -4.2, -5.2, -3.5000000000000004, -12.799999999999999, -20.9, -8.999999999999998, -9.4, -9.4, -20.10000000000001, -7.199999999999998, -6.5, -1.3, -15.399999999999999, -9.5, -8.999999999999996, -15.299999999999997, -15.7, -3.4, -5.2, -5.700000000000001, -4.2, -5.300000000000001, -23.900000000000027, -4.700000000000001, -11.9, -3.2, -6.4, -10.7, -5.2, -5.2, -7.2, -4.300000000000001, -22.8, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.929119408243447, "mean_inference_ms": 1.8563528554885207, "mean_action_processing_ms": 0.09812677691296802, "mean_env_wait_ms": 21.998832544291467, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1556000, "timesteps_this_iter": 0, "agent_timesteps_total": 1556000, "timers": {"sample_time_ms": 52891.815, "sample_throughput": 75.626, "load_time_ms": 1.315, "load_throughput": 3042713.143, "learn_time_ms": 26816.899, "learn_throughput": 149.16, "update_time_ms": 4.888}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.07799507118461113, "policy_loss": -0.008359373962726964, "vf_loss": 8.623092132197913, "vf_explained_var": 0.17895151113951077, "kl": 0.010270543734440446, "entropy": 0.21677089043522393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1556000, "num_agent_steps_sampled": 1556000, "num_steps_trained": 1556000, "num_agent_steps_trained": 1556000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15560, "training_iteration": 389, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-11-23", "timestamp": 1643685083, "time_this_iter_s": 53.87525510787964, "time_total_s": 19749.018324136734, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19749.018324136734, "timesteps_since_restore": 0, "iterations_since_restore": 389, "perf": {"cpu_util_percent": 29.728947368421053, "ram_util_percent": 70.96052631578948}}
{"episode_reward_max": -1.3, "episode_reward_min": -98.80000000000008, "episode_reward_mean": -11.698000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -44.20000000000006, -3.3, -4.300000000000001, -6.4, -6.2, -10.49999999999999, -9.599999999999998, -3.3, -23.2, -5.4, -9.9, -3.3, -11.099999999999996, -6.300000000000001, -8.2, -4.300000000000001, -5.4, -20.1, -4.2, -10.799999999999999, -5.0, -3.4, -7.2, -4.2, -16.7, -4.2, -5.2, -3.5000000000000004, -12.799999999999999, -20.9, -8.999999999999998, -9.4, -9.4, -20.10000000000001, -7.199999999999998, -6.5, -1.3, -15.399999999999999, -9.5, -8.999999999999996, -15.299999999999997, -15.7, -3.4, -5.2, -5.700000000000001, -4.2, -5.300000000000001, -23.900000000000027, -4.700000000000001, -11.9, -3.2, -6.4, -10.7, -5.2, -5.2, -7.2, -4.300000000000001, -22.8, -11.2, -9.499999999999998, -17.099999999999998, -16.5, -23.000000000000004, -5.0, -8.3, -19.79999999999999, -11.199999999999978, -4.7, -6.1000000000000005, -22.2, -3.2, -23.200000000000003, -4.6000000000000005, -17.800000000000004, -18.60000000000001, -5.3, -8.099999999999998, -4.2, -40.400000000000006, -18.2, -3.2, -13.099999999999998, -3.3, -5.300000000000001, -17.6, -17.7, -20.700000000000014, -3.2, -98.80000000000008, -15.099999999999998, -4.300000000000001, -9.2, -21.9, -17.5, -24.000000000000007, -5.5, -15.199999999999998, -14.799999999999999, -16.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9294608962660997, "mean_inference_ms": 1.86101754818562, "mean_action_processing_ms": 0.09840695871358324, "mean_env_wait_ms": 21.990837322367387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1560000, "timers": {"sample_time_ms": 52941.393, "sample_throughput": 75.555, "load_time_ms": 1.315, "load_throughput": 3041720.181, "learn_time_ms": 26808.378, "learn_throughput": 149.207, "update_time_ms": 4.856}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.5479817102255139, "policy_loss": -0.012227279368427492, "vf_loss": 56.00547515961431, "vf_explained_var": 0.07336741570503481, "kl": 0.012825869222854256, "entropy": 0.21932967248302634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1560000, "num_agent_steps_sampled": 1560000, "num_steps_trained": 1560000, "num_agent_steps_trained": 1560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15600, "training_iteration": 390, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-12-16", "timestamp": 1643685136, "time_this_iter_s": 53.165159940719604, "time_total_s": 19802.183484077454, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19802.183484077454, "timesteps_since_restore": 0, "iterations_since_restore": 390, "perf": {"cpu_util_percent": 26.698684210526313, "ram_util_percent": 70.9486842105263}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.80000000000008, "episode_reward_mean": -12.576000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.999999999999996, -15.299999999999997, -15.7, -3.4, -5.2, -5.700000000000001, -4.2, -5.300000000000001, -23.900000000000027, -4.700000000000001, -11.9, -3.2, -6.4, -10.7, -5.2, -5.2, -7.2, -4.300000000000001, -22.8, -11.2, -9.499999999999998, -17.099999999999998, -16.5, -23.000000000000004, -5.0, -8.3, -19.79999999999999, -11.199999999999978, -4.7, -6.1000000000000005, -22.2, -3.2, -23.200000000000003, -4.6000000000000005, -17.800000000000004, -18.60000000000001, -5.3, -8.099999999999998, -4.2, -40.400000000000006, -18.2, -3.2, -13.099999999999998, -3.3, -5.300000000000001, -17.6, -17.7, -20.700000000000014, -3.2, -98.80000000000008, -15.099999999999998, -4.300000000000001, -9.2, -21.9, -17.5, -24.000000000000007, -5.5, -15.199999999999998, -14.799999999999999, -16.6, -14.2, -23.400000000000002, -11.5, -7.499999999999999, -3.2, -10.399999999999995, -15.6, -5.4, -15.899999999999999, -4.3, -4.4, -5.4, -4.2, -11.5, -40.6, -12.9, -3.3, -17.0, -12.3, -10.3, -4.7, -4.700000000000001, -5.4, -4.300000000000001, -11.8, -13.799999999999997, -5.8, -14.2, -3.4, -11.5, -9.899999999999999, -3.4, -33.4, -8.999999999999996, -16.7, -42.2, -6.3, -4.2, -18.8, -6.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.929680592255193, "mean_inference_ms": 1.8656534204069721, "mean_action_processing_ms": 0.09868586232285721, "mean_env_wait_ms": 21.982735226429696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1564000, "timesteps_this_iter": 0, "agent_timesteps_total": 1564000, "timers": {"sample_time_ms": 52895.677, "sample_throughput": 75.621, "load_time_ms": 1.317, "load_throughput": 3036929.983, "learn_time_ms": 26898.416, "learn_throughput": 148.708, "update_time_ms": 4.86}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.14843945002273445, "policy_loss": -0.014104193051205447, "vf_loss": 16.244224648514102, "vf_explained_var": 0.1181349838933637, "kl": 0.008430999420247035, "entropy": 0.17743909076176664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1564000, "num_agent_steps_sampled": 1564000, "num_steps_trained": 1564000, "num_agent_steps_trained": 1564000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15640, "training_iteration": 391, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-13-10", "timestamp": 1643685190, "time_this_iter_s": 53.62314701080322, "time_total_s": 19855.806631088257, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19855.806631088257, "timesteps_since_restore": 0, "iterations_since_restore": 391, "perf": {"cpu_util_percent": 23.580263157894738, "ram_util_percent": 70.93421052631577}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.80000000000008, "episode_reward_mean": -12.589, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.2, -3.2, -13.099999999999998, -3.3, -5.300000000000001, -17.6, -17.7, -20.700000000000014, -3.2, -98.80000000000008, -15.099999999999998, -4.300000000000001, -9.2, -21.9, -17.5, -24.000000000000007, -5.5, -15.199999999999998, -14.799999999999999, -16.6, -14.2, -23.400000000000002, -11.5, -7.499999999999999, -3.2, -10.399999999999995, -15.6, -5.4, -15.899999999999999, -4.3, -4.4, -5.4, -4.2, -11.5, -40.6, -12.9, -3.3, -17.0, -12.3, -10.3, -4.7, -4.700000000000001, -5.4, -4.300000000000001, -11.8, -13.799999999999997, -5.8, -14.2, -3.4, -11.5, -9.899999999999999, -3.4, -33.4, -8.999999999999996, -16.7, -42.2, -6.3, -4.2, -18.8, -6.300000000000001, -4.4, -5.2, -11.999999999999998, -18.000000000000007, -4.300000000000001, -12.899999999999997, -3.3, -12.6, -10.499999999999998, -8.4, -4.4, -10.6, -3.3, -6.1, -3.3, -9.3, -20.099999999999998, -13.0, -3.3, -4.300000000000001, -12.999999999999998, -3.3, -22.199999999999996, -3.2, -4.300000000000001, -15.3, -31.1, -10.599999999999994, -29.500000000000004, -6.999999999999998, -16.099999999999998, -24.599999999999998, -7.0, -5.799999999999999, -17.09999999999999, -10.599999999999996, -23.500000000000004, -5.800000000000001, -18.0, -13.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.929735895556704, "mean_inference_ms": 1.8703627982639126, "mean_action_processing_ms": 0.09896817648805226, "mean_env_wait_ms": 21.97528485568674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1568000, "timesteps_this_iter": 0, "agent_timesteps_total": 1568000, "timers": {"sample_time_ms": 52997.616, "sample_throughput": 75.475, "load_time_ms": 1.317, "load_throughput": 3036710.107, "learn_time_ms": 27000.742, "learn_throughput": 148.144, "update_time_ms": 4.923}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.13797818118285748, "policy_loss": 0.0012324319110922916, "vf_loss": 13.66726920088773, "vf_explained_var": 0.17133056720097858, "kl": 0.006074511747933855, "entropy": 0.17764922683277437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1568000, "num_agent_steps_sampled": 1568000, "num_steps_trained": 1568000, "num_agent_steps_trained": 1568000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15680, "training_iteration": 392, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-14-04", "timestamp": 1643685244, "time_this_iter_s": 54.241636753082275, "time_total_s": 19910.04826784134, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19910.04826784134, "timesteps_since_restore": 0, "iterations_since_restore": 392, "perf": {"cpu_util_percent": 31.219736842105267, "ram_util_percent": 70.97894736842105}}
{"episode_reward_max": -3.2, "episode_reward_min": -64.0, "episode_reward_mean": -12.424000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.7, -4.700000000000001, -5.4, -4.300000000000001, -11.8, -13.799999999999997, -5.8, -14.2, -3.4, -11.5, -9.899999999999999, -3.4, -33.4, -8.999999999999996, -16.7, -42.2, -6.3, -4.2, -18.8, -6.300000000000001, -4.4, -5.2, -11.999999999999998, -18.000000000000007, -4.300000000000001, -12.899999999999997, -3.3, -12.6, -10.499999999999998, -8.4, -4.4, -10.6, -3.3, -6.1, -3.3, -9.3, -20.099999999999998, -13.0, -3.3, -4.300000000000001, -12.999999999999998, -3.3, -22.199999999999996, -3.2, -4.300000000000001, -15.3, -31.1, -10.599999999999994, -29.500000000000004, -6.999999999999998, -16.099999999999998, -24.599999999999998, -7.0, -5.799999999999999, -17.09999999999999, -10.599999999999996, -23.500000000000004, -5.800000000000001, -18.0, -13.299999999999999, -3.8000000000000003, -5.3, -9.3, -4.300000000000001, -15.899999999999999, -18.00000000000002, -3.4, -13.799999999999999, -20.099999999999998, -14.499999999999993, -4.300000000000001, -12.9, -3.4, -28.1, -3.3, -8.2, -53.2, -8.4, -4.2, -11.0, -12.299999999999997, -9.2, -7.2, -12.999999999999998, -24.700000000000003, -10.2, -11.200000000000001, -15.499999999999998, -19.400000000000027, -3.3, -64.0, -27.700000000000006, -5.2, -9.799999999999997, -10.7, -35.1, -17.6, -12.899999999999999, -3.4, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.929521298788854, "mean_inference_ms": 1.874959076352676, "mean_action_processing_ms": 0.09924483977565064, "mean_env_wait_ms": 21.967341143282905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1572000, "timesteps_this_iter": 0, "agent_timesteps_total": 1572000, "timers": {"sample_time_ms": 53466.553, "sample_throughput": 74.813, "load_time_ms": 1.295, "load_throughput": 3088759.688, "learn_time_ms": 27069.675, "learn_throughput": 147.767, "update_time_ms": 4.86}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.326512127295537, "policy_loss": -0.010640770024670067, "vf_loss": 33.70334658712469, "vf_explained_var": 0.038783570579303206, "kl": 0.009930607231130319, "entropy": 0.17526414218528938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1572000, "num_agent_steps_sampled": 1572000, "num_steps_trained": 1572000, "num_agent_steps_trained": 1572000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15720, "training_iteration": 393, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-14-57", "timestamp": 1643685297, "time_this_iter_s": 53.03009486198425, "time_total_s": 19963.078362703323, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19963.078362703323, "timesteps_since_restore": 0, "iterations_since_restore": 393, "perf": {"cpu_util_percent": 24.71578947368421, "ram_util_percent": 70.98815789473683}}
{"episode_reward_max": -3.2, "episode_reward_min": -64.0, "episode_reward_mean": -13.168, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.999999999999998, -3.3, -22.199999999999996, -3.2, -4.300000000000001, -15.3, -31.1, -10.599999999999994, -29.500000000000004, -6.999999999999998, -16.099999999999998, -24.599999999999998, -7.0, -5.799999999999999, -17.09999999999999, -10.599999999999996, -23.500000000000004, -5.800000000000001, -18.0, -13.299999999999999, -3.8000000000000003, -5.3, -9.3, -4.300000000000001, -15.899999999999999, -18.00000000000002, -3.4, -13.799999999999999, -20.099999999999998, -14.499999999999993, -4.300000000000001, -12.9, -3.4, -28.1, -3.3, -8.2, -53.2, -8.4, -4.2, -11.0, -12.299999999999997, -9.2, -7.2, -12.999999999999998, -24.700000000000003, -10.2, -11.200000000000001, -15.499999999999998, -19.400000000000027, -3.3, -64.0, -27.700000000000006, -5.2, -9.799999999999997, -10.7, -35.1, -17.6, -12.899999999999999, -3.4, -4.2, -6.2, -14.3, -23.100000000000005, -33.10000000000007, -9.499999999999998, -6.3, -7.499999999999999, -9.800000000000002, -5.6000000000000005, -4.2, -10.7, -19.800000000000004, -9.2, -16.4, -11.999999999999998, -3.4, -4.2, -4.300000000000001, -31.500000000000004, -15.899999999999999, -9.5, -5.3, -4.4, -23.0, -9.3, -12.099999999999984, -3.2, -4.9, -14.599999999999994, -4.300000000000001, -29.100000000000012, -3.2, -4.4, -10.799999999999997, -11.89999999999999, -17.799999999999997, -23.900000000000038, -11.999999999999996, -18.599999999999994, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9292659966024535, "mean_inference_ms": 1.879452552344033, "mean_action_processing_ms": 0.099516771412801, "mean_env_wait_ms": 21.958802185779586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1576000, "timesteps_this_iter": 0, "agent_timesteps_total": 1576000, "timers": {"sample_time_ms": 53582.593, "sample_throughput": 74.651, "load_time_ms": 1.296, "load_throughput": 3087338.707, "learn_time_ms": 27123.765, "learn_throughput": 147.472, "update_time_ms": 4.775}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.15788374074424308, "policy_loss": -0.013477971802355462, "vf_loss": 17.125201978157925, "vf_explained_var": 0.06710198681841614, "kl": 0.009120819839719026, "entropy": 0.1883714882797131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1576000, "num_agent_steps_sampled": 1576000, "num_steps_trained": 1576000, "num_agent_steps_trained": 1576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15760, "training_iteration": 394, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-15-50", "timestamp": 1643685350, "time_this_iter_s": 53.39273691177368, "time_total_s": 20016.471099615097, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20016.471099615097, "timesteps_since_restore": 0, "iterations_since_restore": 394, "perf": {"cpu_util_percent": 23.519999999999996, "ram_util_percent": 70.97333333333333}}
{"episode_reward_max": -3.2, "episode_reward_min": -64.0, "episode_reward_mean": -13.118, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.299999999999997, -9.2, -7.2, -12.999999999999998, -24.700000000000003, -10.2, -11.200000000000001, -15.499999999999998, -19.400000000000027, -3.3, -64.0, -27.700000000000006, -5.2, -9.799999999999997, -10.7, -35.1, -17.6, -12.899999999999999, -3.4, -4.2, -6.2, -14.3, -23.100000000000005, -33.10000000000007, -9.499999999999998, -6.3, -7.499999999999999, -9.800000000000002, -5.6000000000000005, -4.2, -10.7, -19.800000000000004, -9.2, -16.4, -11.999999999999998, -3.4, -4.2, -4.300000000000001, -31.500000000000004, -15.899999999999999, -9.5, -5.3, -4.4, -23.0, -9.3, -12.099999999999984, -3.2, -4.9, -14.599999999999994, -4.300000000000001, -29.100000000000012, -3.2, -4.4, -10.799999999999997, -11.89999999999999, -17.799999999999997, -23.900000000000038, -11.999999999999996, -18.599999999999994, -4.2, -3.5000000000000004, -3.2, -4.3, -18.799999999999997, -28.60000000000001, -3.3, -5.2, -4.300000000000001, -18.999999999999996, -20.700000000000003, -21.100000000000005, -20.000000000000007, -11.5, -13.299999999999988, -20.0, -3.3, -33.3, -5.2, -41.3, -10.899999999999999, -9.3, -4.300000000000001, -9.6, -3.3, -17.200000000000003, -8.3, -23.5, -4.3, -10.899999999999999, -16.799999999999997, -8.8, -15.79999999999998, -3.2, -4.300000000000001, -23.8, -17.2, -28.3, -9.5, -8.2, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.929095373421004, "mean_inference_ms": 1.883952765764096, "mean_action_processing_ms": 0.09978881938042193, "mean_env_wait_ms": 21.950455893373263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1580000, "timesteps_this_iter": 0, "agent_timesteps_total": 1580000, "timers": {"sample_time_ms": 53703.762, "sample_throughput": 74.483, "load_time_ms": 1.295, "load_throughput": 3087622.798, "learn_time_ms": 27027.411, "learn_throughput": 147.998, "update_time_ms": 4.774}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.191854818271453, "policy_loss": -0.006986871973100689, "vf_loss": 19.87655416919339, "vf_explained_var": 0.0895891111384156, "kl": 0.006331773965196205, "entropy": 0.1708484711345806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1580000, "num_agent_steps_sampled": 1580000, "num_steps_trained": 1580000, "num_agent_steps_trained": 1580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15800, "training_iteration": 395, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-16-44", "timestamp": 1643685404, "time_this_iter_s": 53.53998899459839, "time_total_s": 20070.011088609695, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20070.011088609695, "timesteps_since_restore": 0, "iterations_since_restore": 395, "perf": {"cpu_util_percent": 26.250000000000004, "ram_util_percent": 71.00263157894737}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.90000000000015, "episode_reward_mean": -13.545000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.5, -5.3, -4.4, -23.0, -9.3, -12.099999999999984, -3.2, -4.9, -14.599999999999994, -4.300000000000001, -29.100000000000012, -3.2, -4.4, -10.799999999999997, -11.89999999999999, -17.799999999999997, -23.900000000000038, -11.999999999999996, -18.599999999999994, -4.2, -3.5000000000000004, -3.2, -4.3, -18.799999999999997, -28.60000000000001, -3.3, -5.2, -4.300000000000001, -18.999999999999996, -20.700000000000003, -21.100000000000005, -20.000000000000007, -11.5, -13.299999999999988, -20.0, -3.3, -33.3, -5.2, -41.3, -10.899999999999999, -9.3, -4.300000000000001, -9.6, -3.3, -17.200000000000003, -8.3, -23.5, -4.3, -10.899999999999999, -16.799999999999997, -8.8, -15.79999999999998, -3.2, -4.300000000000001, -23.8, -17.2, -28.3, -9.5, -8.2, -4.300000000000001, -14.399999999999995, -4.2, -4.3, -9.6, -14.399999999999999, -14.699999999999998, -16.099999999999998, -10.7, -20.500000000000007, -12.999999999999998, -3.2, -4.4, -25.400000000000002, -23.3, -20.800000000000004, -4.7, -7.499999999999999, -3.3, -14.799999999999983, -8.3, -5.2, -4.2, -4.300000000000001, -28.900000000000006, -38.2, -4.2, -3.5000000000000004, -17.199999999999996, -3.8000000000000003, -3.2, -18.700000000000003, -27.599999999999998, -32.60000000000001, -6.0, -21.1, -5.4, -4.2, -23.700000000000003, -17.800000000000004, -98.90000000000015], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.928939449626164, "mean_inference_ms": 1.8885082585436581, "mean_action_processing_ms": 0.10006225083681429, "mean_env_wait_ms": 21.94271624115563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1584000, "timesteps_this_iter": 0, "agent_timesteps_total": 1584000, "timers": {"sample_time_ms": 53573.998, "sample_throughput": 74.663, "load_time_ms": 1.299, "load_throughput": 3078275.293, "learn_time_ms": 27081.468, "learn_throughput": 147.702, "update_time_ms": 4.823}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.4848957138655517, "policy_loss": -0.026531629152195427, "vf_loss": 51.13283091700205, "vf_explained_var": 0.07883668106089356, "kl": 0.008235331659313503, "entropy": 0.16428951584603838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1584000, "num_agent_steps_sampled": 1584000, "num_steps_trained": 1584000, "num_agent_steps_trained": 1584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15840, "training_iteration": 396, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-17-37", "timestamp": 1643685457, "time_this_iter_s": 53.263436794281006, "time_total_s": 20123.274525403976, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20123.274525403976, "timesteps_since_restore": 0, "iterations_since_restore": 396, "perf": {"cpu_util_percent": 26.43733333333333, "ram_util_percent": 71.02133333333335}}
{"episode_reward_max": -3.2, "episode_reward_min": -98.90000000000015, "episode_reward_mean": -13.697000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.3, -4.300000000000001, -9.6, -3.3, -17.200000000000003, -8.3, -23.5, -4.3, -10.899999999999999, -16.799999999999997, -8.8, -15.79999999999998, -3.2, -4.300000000000001, -23.8, -17.2, -28.3, -9.5, -8.2, -4.300000000000001, -14.399999999999995, -4.2, -4.3, -9.6, -14.399999999999999, -14.699999999999998, -16.099999999999998, -10.7, -20.500000000000007, -12.999999999999998, -3.2, -4.4, -25.400000000000002, -23.3, -20.800000000000004, -4.7, -7.499999999999999, -3.3, -14.799999999999983, -8.3, -5.2, -4.2, -4.300000000000001, -28.900000000000006, -38.2, -4.2, -3.5000000000000004, -17.199999999999996, -3.8000000000000003, -3.2, -18.700000000000003, -27.599999999999998, -32.60000000000001, -6.0, -21.1, -5.4, -4.2, -23.700000000000003, -17.800000000000004, -98.90000000000015, -34.5, -3.4, -6.0, -6.2, -35.9, -3.3, -28.2, -6.8999999999999995, -11.5, -13.599999999999998, -4.300000000000001, -5.300000000000001, -4.4, -4.2, -12.49999999999998, -20.099999999999994, -3.3, -12.799999999999999, -28.200000000000028, -17.59999999999997, -14.299999999999999, -14.399999999999999, -19.3, -4.2, -24.700000000000003, -3.3, -10.6, -11.2, -34.3, -19.000000000000004, -5.0, -3.4, -4.2, -14.0, -15.7, -5.3, -19.900000000000002, -13.299999999999999, -3.3, -30.90000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9290073042544345, "mean_inference_ms": 1.8930921614286509, "mean_action_processing_ms": 0.10033721168293264, "mean_env_wait_ms": 21.935229135165955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1588000, "timesteps_this_iter": 0, "agent_timesteps_total": 1588000, "timers": {"sample_time_ms": 53711.659, "sample_throughput": 74.472, "load_time_ms": 1.296, "load_throughput": 3086770.68, "learn_time_ms": 27009.219, "learn_throughput": 148.098, "update_time_ms": 4.663}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.17344530104979952, "policy_loss": -0.006363033821746226, "vf_loss": 17.97297379752641, "vf_explained_var": 0.0442844715169681, "kl": 0.006535285952751223, "entropy": 0.15782173919060857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1588000, "num_agent_steps_sampled": 1588000, "num_steps_trained": 1588000, "num_agent_steps_trained": 1588000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15880, "training_iteration": 397, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-18-31", "timestamp": 1643685511, "time_this_iter_s": 53.84365797042847, "time_total_s": 20177.118183374405, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20177.118183374405, "timesteps_since_restore": 0, "iterations_since_restore": 397, "perf": {"cpu_util_percent": 29.18701298701298, "ram_util_percent": 71.02337662337662}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -98.90000000000015, "episode_reward_mean": -13.200000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -4.2, -4.300000000000001, -28.900000000000006, -38.2, -4.2, -3.5000000000000004, -17.199999999999996, -3.8000000000000003, -3.2, -18.700000000000003, -27.599999999999998, -32.60000000000001, -6.0, -21.1, -5.4, -4.2, -23.700000000000003, -17.800000000000004, -98.90000000000015, -34.5, -3.4, -6.0, -6.2, -35.9, -3.3, -28.2, -6.8999999999999995, -11.5, -13.599999999999998, -4.300000000000001, -5.300000000000001, -4.4, -4.2, -12.49999999999998, -20.099999999999994, -3.3, -12.799999999999999, -28.200000000000028, -17.59999999999997, -14.299999999999999, -14.399999999999999, -19.3, -4.2, -24.700000000000003, -3.3, -10.6, -11.2, -34.3, -19.000000000000004, -5.0, -3.4, -4.2, -14.0, -15.7, -5.3, -19.900000000000002, -13.299999999999999, -3.3, -30.90000000000001, -15.799999999999999, -3.3, -4.4, -6.999999999999998, -18.299999999999997, -4.9, -21.599999999999998, -15.2, -13.5, -3.3, -3.2, -10.5, -9.0, -27.700000000000003, -18.9, -24.8, -10.899999999999999, -18.7, -3.3, -14.29999999999998, -3.2, -24.600000000000005, -2.6000000000000005, -8.8, -3.3, -4.2, -7.199999999999999, -7.3, -11.3, -3.5, -3.5, -10.799999999999999, -7.199999999999999, -21.1, -11.899999999999999, -21.1, -4.9, -3.3, -4.2, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9289744444860157, "mean_inference_ms": 1.8977559979216811, "mean_action_processing_ms": 0.10061446147479437, "mean_env_wait_ms": 21.928315687146945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1592000, "timesteps_this_iter": 0, "agent_timesteps_total": 1592000, "timers": {"sample_time_ms": 53652.425, "sample_throughput": 74.554, "load_time_ms": 1.296, "load_throughput": 3085862.272, "learn_time_ms": 26997.245, "learn_throughput": 148.163, "update_time_ms": 4.694}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.12585649591700365, "policy_loss": -0.009752630270637011, "vf_loss": 13.545661720104755, "vf_explained_var": -0.05314914808478407, "kl": 0.012680814099982103, "entropy": 0.17484216839475658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1592000, "num_agent_steps_sampled": 1592000, "num_steps_trained": 1592000, "num_agent_steps_trained": 1592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15920, "training_iteration": 398, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-19-25", "timestamp": 1643685565, "time_this_iter_s": 53.742626905441284, "time_total_s": 20230.860810279846, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20230.860810279846, "timesteps_since_restore": 0, "iterations_since_restore": 398, "perf": {"cpu_util_percent": 28.02631578947369, "ram_util_percent": 70.87894736842104}}
{"episode_reward_max": -1.3, "episode_reward_min": -93.00000000000009, "episode_reward_mean": -11.808000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.299999999999999, -14.399999999999999, -19.3, -4.2, -24.700000000000003, -3.3, -10.6, -11.2, -34.3, -19.000000000000004, -5.0, -3.4, -4.2, -14.0, -15.7, -5.3, -19.900000000000002, -13.299999999999999, -3.3, -30.90000000000001, -15.799999999999999, -3.3, -4.4, -6.999999999999998, -18.299999999999997, -4.9, -21.599999999999998, -15.2, -13.5, -3.3, -3.2, -10.5, -9.0, -27.700000000000003, -18.9, -24.8, -10.899999999999999, -18.7, -3.3, -14.29999999999998, -3.2, -24.600000000000005, -2.6000000000000005, -8.8, -3.3, -4.2, -7.199999999999999, -7.3, -11.3, -3.5, -3.5, -10.799999999999999, -7.199999999999999, -21.1, -11.899999999999999, -21.1, -4.9, -3.3, -4.2, -6.2, -12.899999999999999, -18.300000000000004, -20.099999999999994, -11.199999999999976, -5.300000000000001, -5.4, -8.4, -11.299999999999999, -16.0, -7.799999999999999, -3.3, -16.799999999999997, -1.3, -13.799999999999999, -13.999999999999998, -12.199999999999998, -6.3999999999999995, -3.2, -13.0, -6.9, -5.0, -10.999999999999977, -13.799999999999999, -6.399999999999999, -7.9, -16.4, -4.4, -10.799999999999999, -15.799999999999997, -93.00000000000009, -22.499999999999996, -3.3, -5.300000000000001, -4.2, -3.3, -4.300000000000001, -4.2, -16.9, -9.700000000000001, -25.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9289725464863454, "mean_inference_ms": 1.9024966708799693, "mean_action_processing_ms": 0.10089549313618029, "mean_env_wait_ms": 21.922132343037063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1596000, "timesteps_this_iter": 0, "agent_timesteps_total": 1596000, "timers": {"sample_time_ms": 53741.4, "sample_throughput": 74.431, "load_time_ms": 1.258, "load_throughput": 3179008.243, "learn_time_ms": 26931.747, "learn_throughput": 148.524, "update_time_ms": 4.66}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.44803097117441876, "policy_loss": -0.011130958077277467, "vf_loss": 45.906072617730786, "vf_explained_var": -0.1596367625780003, "kl": 0.008415210737439898, "entropy": 0.1659752825695661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1596000, "num_agent_steps_sampled": 1596000, "num_steps_trained": 1596000, "num_agent_steps_trained": 1596000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 15960, "training_iteration": 399, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-20-19", "timestamp": 1643685619, "time_this_iter_s": 54.23425579071045, "time_total_s": 20285.095066070557, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20285.095066070557, "timesteps_since_restore": 0, "iterations_since_restore": 399, "perf": {"cpu_util_percent": 28.01842105263158, "ram_util_percent": 70.74342105263156}}
{"episode_reward_max": -1.2, "episode_reward_min": -93.00000000000009, "episode_reward_mean": -13.808000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -24.600000000000005, -2.6000000000000005, -8.8, -3.3, -4.2, -7.199999999999999, -7.3, -11.3, -3.5, -3.5, -10.799999999999999, -7.199999999999999, -21.1, -11.899999999999999, -21.1, -4.9, -3.3, -4.2, -6.2, -12.899999999999999, -18.300000000000004, -20.099999999999994, -11.199999999999976, -5.300000000000001, -5.4, -8.4, -11.299999999999999, -16.0, -7.799999999999999, -3.3, -16.799999999999997, -1.3, -13.799999999999999, -13.999999999999998, -12.199999999999998, -6.3999999999999995, -3.2, -13.0, -6.9, -5.0, -10.999999999999977, -13.799999999999999, -6.399999999999999, -7.9, -16.4, -4.4, -10.799999999999999, -15.799999999999997, -93.00000000000009, -22.499999999999996, -3.3, -5.300000000000001, -4.2, -3.3, -4.300000000000001, -4.2, -16.9, -9.700000000000001, -25.9, -30.7, -3.3, -21.700000000000003, -6.1000000000000005, -65.80000000000005, -14.299999999999997, -4.300000000000001, -27.499999999999996, -1.2, -15.699999999999998, -10.7, -3.4, -10.899999999999999, -53.2, -17.6, -16.199999999999996, -18.900000000000006, -90.40000000000013, -14.799999999999997, -16.399999999999995, -4.2, -4.300000000000001, -4.300000000000001, -4.300000000000001, -14.299999999999997, -6.699999999999998, -13.5, -36.3, -3.3, -4.300000000000001, -12.2, -15.999999999999996, -27.400000000000006, -6.999999999999998, -25.90000000000001, -13.299999999999999, -41.3, -4.2, -27.699999999999996, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9287605593973205, "mean_inference_ms": 1.9071950188162874, "mean_action_processing_ms": 0.10116975423213599, "mean_env_wait_ms": 21.915863750583902, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1600000, "timesteps_this_iter": 0, "agent_timesteps_total": 1600000, "timers": {"sample_time_ms": 53707.637, "sample_throughput": 74.477, "load_time_ms": 1.284, "load_throughput": 3114736.373, "learn_time_ms": 26912.418, "learn_throughput": 148.63, "update_time_ms": 4.685}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012027114909142258, "cur_lr": 0.00010000000000000003, "total_loss": 0.6522940000594263, "policy_loss": -0.015443814960395997, "vf_loss": 66.74658539782288, "vf_explained_var": -0.019983196258544923, "kl": 0.022613707493405848, "entropy": 0.18674668650473317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1600000, "num_agent_steps_sampled": 1600000, "num_steps_trained": 1600000, "num_agent_steps_trained": 1600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16000, "training_iteration": 400, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-21-13", "timestamp": 1643685673, "time_this_iter_s": 53.30001497268677, "time_total_s": 20338.395081043243, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20338.395081043243, "timesteps_since_restore": 0, "iterations_since_restore": 400, "perf": {"cpu_util_percent": 18.13157894736842, "ram_util_percent": 71.00263157894736}}
{"episode_reward_max": -1.2, "episode_reward_min": -93.00000000000009, "episode_reward_mean": -14.695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -10.999999999999977, -13.799999999999999, -6.399999999999999, -7.9, -16.4, -4.4, -10.799999999999999, -15.799999999999997, -93.00000000000009, -22.499999999999996, -3.3, -5.300000000000001, -4.2, -3.3, -4.300000000000001, -4.2, -16.9, -9.700000000000001, -25.9, -30.7, -3.3, -21.700000000000003, -6.1000000000000005, -65.80000000000005, -14.299999999999997, -4.300000000000001, -27.499999999999996, -1.2, -15.699999999999998, -10.7, -3.4, -10.899999999999999, -53.2, -17.6, -16.199999999999996, -18.900000000000006, -90.40000000000013, -14.799999999999997, -16.399999999999995, -4.2, -4.300000000000001, -4.300000000000001, -4.300000000000001, -14.299999999999997, -6.699999999999998, -13.5, -36.3, -3.3, -4.300000000000001, -12.2, -15.999999999999996, -27.400000000000006, -6.999999999999998, -25.90000000000001, -13.299999999999999, -41.3, -4.2, -27.699999999999996, -5.300000000000001, -3.2, -7.2, -4.2, -4.300000000000001, -32.7, -8.2, -10.3, -15.8, -13.499999999999998, -9.799999999999997, -4.3, -5.4, -5.2, -7.2, -7.399999999999999, -15.899999999999999, -5.2, -3.3, -11.899999999999999, -10.899999999999999, -5.4, -17.2, -23.000000000000007, -19.9, -10.8, -3.2, -4.2, -23.799999999999997, -15.899999999999997, -16.8, -27.9, -18.300000000000004, -4.3, -4.300000000000001, -12.399999999999999, -2.2, -4.3, -39.6, -8.6, -18.500000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9284704860338304, "mean_inference_ms": 1.9118893596022222, "mean_action_processing_ms": 0.10144449748527959, "mean_env_wait_ms": 21.90967730419681, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1604000, "timesteps_this_iter": 0, "agent_timesteps_total": 1604000, "timers": {"sample_time_ms": 53774.76, "sample_throughput": 74.384, "load_time_ms": 1.284, "load_throughput": 3114678.548, "learn_time_ms": 26896.336, "learn_throughput": 148.719, "update_time_ms": 4.722}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.1729197093550997, "policy_loss": -0.012982592136368796, "vf_loss": 18.56296461008249, "vf_explained_var": -0.02883976915831207, "kl": 0.015113634703852116, "entropy": 0.14882842028733864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1604000, "num_agent_steps_sampled": 1604000, "num_steps_trained": 1604000, "num_agent_steps_trained": 1604000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16040, "training_iteration": 401, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-22-07", "timestamp": 1643685727, "time_this_iter_s": 54.35775303840637, "time_total_s": 20392.75283408165, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20392.75283408165, "timesteps_since_restore": 0, "iterations_since_restore": 401, "perf": {"cpu_util_percent": 29.611688311688305, "ram_util_percent": 71.20129870129868}}
{"episode_reward_max": -2.2, "episode_reward_min": -63.900000000000105, "episode_reward_mean": -12.742000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.2, -4.300000000000001, -4.300000000000001, -4.300000000000001, -14.299999999999997, -6.699999999999998, -13.5, -36.3, -3.3, -4.300000000000001, -12.2, -15.999999999999996, -27.400000000000006, -6.999999999999998, -25.90000000000001, -13.299999999999999, -41.3, -4.2, -27.699999999999996, -5.300000000000001, -3.2, -7.2, -4.2, -4.300000000000001, -32.7, -8.2, -10.3, -15.8, -13.499999999999998, -9.799999999999997, -4.3, -5.4, -5.2, -7.2, -7.399999999999999, -15.899999999999999, -5.2, -3.3, -11.899999999999999, -10.899999999999999, -5.4, -17.2, -23.000000000000007, -19.9, -10.8, -3.2, -4.2, -23.799999999999997, -15.899999999999997, -16.8, -27.9, -18.300000000000004, -4.3, -4.300000000000001, -12.399999999999999, -2.2, -4.3, -39.6, -8.6, -18.500000000000007, -9.1, -13.399999999999999, -12.499999999999995, -27.4, -63.900000000000105, -14.999999999999979, -2.5, -5.499999999999999, -12.8, -15.899999999999999, -45.3, -8.599999999999998, -3.4, -26.8, -3.3, -30.800000000000008, -13.1, -7.3999999999999995, -9.4, -3.4, -24.800000000000004, -3.3, -3.6000000000000005, -12.399999999999995, -10.8, -17.099999999999998, -7.4, -7.699999999999998, -21.300000000000004, -3.2, -7.2, -4.300000000000001, -4.2, -23.1, -3.2, -8.5, -9.3, -21.699999999999996, -3.9000000000000004, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.928222302798771, "mean_inference_ms": 1.916534217975056, "mean_action_processing_ms": 0.1017188374997749, "mean_env_wait_ms": 21.903163838902323, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1608000, "timesteps_this_iter": 0, "agent_timesteps_total": 1608000, "timers": {"sample_time_ms": 53752.05, "sample_throughput": 74.416, "load_time_ms": 1.288, "load_throughput": 3105971.564, "learn_time_ms": 26782.21, "learn_throughput": 149.353, "update_time_ms": 4.762}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.36910431515938674, "policy_loss": -0.013745805378552646, "vf_loss": 38.26568482216968, "vf_explained_var": -0.06948696163392835, "kl": 0.010713383857405737, "entropy": 0.20985179277116894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1608000, "num_agent_steps_sampled": 1608000, "num_steps_trained": 1608000, "num_agent_steps_trained": 1608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16080, "training_iteration": 402, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-23-00", "timestamp": 1643685780, "time_this_iter_s": 53.02017402648926, "time_total_s": 20445.77300810814, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20445.77300810814, "timesteps_since_restore": 0, "iterations_since_restore": 402, "perf": {"cpu_util_percent": 25.832, "ram_util_percent": 71.272}}
{"episode_reward_max": -2.2, "episode_reward_min": -65.3, "episode_reward_mean": -14.389000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -17.2, -23.000000000000007, -19.9, -10.8, -3.2, -4.2, -23.799999999999997, -15.899999999999997, -16.8, -27.9, -18.300000000000004, -4.3, -4.300000000000001, -12.399999999999999, -2.2, -4.3, -39.6, -8.6, -18.500000000000007, -9.1, -13.399999999999999, -12.499999999999995, -27.4, -63.900000000000105, -14.999999999999979, -2.5, -5.499999999999999, -12.8, -15.899999999999999, -45.3, -8.599999999999998, -3.4, -26.8, -3.3, -30.800000000000008, -13.1, -7.3999999999999995, -9.4, -3.4, -24.800000000000004, -3.3, -3.6000000000000005, -12.399999999999995, -10.8, -17.099999999999998, -7.4, -7.699999999999998, -21.300000000000004, -3.2, -7.2, -4.300000000000001, -4.2, -23.1, -3.2, -8.5, -9.3, -21.699999999999996, -3.9000000000000004, -5.4, -8.899999999999999, -19.0, -3.4, -4.2, -14.7, -13.899999999999999, -29.3, -3.3, -5.2, -21.2, -62.2, -25.300000000000004, -26.7, -7.6, -12.899999999999999, -9.7, -6.4, -3.3, -65.3, -8.299999999999999, -3.6000000000000005, -17.1, -9.3, -4.2, -17.099999999999998, -4.4, -14.399999999999999, -48.599999999999994, -18.0, -5.2, -29.40000000000004, -26.5, -4.3, -14.3, -8.6, -14.4, -16.1, -5.3, -6.300000000000001, -8.499999999999991], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9280290284881074, "mean_inference_ms": 1.9209968484878663, "mean_action_processing_ms": 0.10198816826357379, "mean_env_wait_ms": 21.895951974472336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1612000, "timesteps_this_iter": 0, "agent_timesteps_total": 1612000, "timers": {"sample_time_ms": 53681.862, "sample_throughput": 74.513, "load_time_ms": 1.302, "load_throughput": 3071175.221, "learn_time_ms": 26743.435, "learn_throughput": 149.569, "update_time_ms": 4.767}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.43868647192840177, "policy_loss": -0.014534652118961657, "vf_loss": 45.29689058257687, "vf_explained_var": 0.03262228824759043, "kl": 0.013981051682549752, "entropy": 0.21214532578984896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1612000, "num_agent_steps_sampled": 1612000, "num_steps_trained": 1612000, "num_agent_steps_trained": 1612000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16120, "training_iteration": 403, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-23-53", "timestamp": 1643685833, "time_this_iter_s": 53.061718225479126, "time_total_s": 20498.834726333618, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20498.834726333618, "timesteps_since_restore": 0, "iterations_since_restore": 403, "perf": {"cpu_util_percent": 27.801333333333332, "ram_util_percent": 71.32533333333332}}
{"episode_reward_max": -2.7, "episode_reward_min": -65.3, "episode_reward_mean": -13.048, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.800000000000004, -3.3, -3.6000000000000005, -12.399999999999995, -10.8, -17.099999999999998, -7.4, -7.699999999999998, -21.300000000000004, -3.2, -7.2, -4.300000000000001, -4.2, -23.1, -3.2, -8.5, -9.3, -21.699999999999996, -3.9000000000000004, -5.4, -8.899999999999999, -19.0, -3.4, -4.2, -14.7, -13.899999999999999, -29.3, -3.3, -5.2, -21.2, -62.2, -25.300000000000004, -26.7, -7.6, -12.899999999999999, -9.7, -6.4, -3.3, -65.3, -8.299999999999999, -3.6000000000000005, -17.1, -9.3, -4.2, -17.099999999999998, -4.4, -14.399999999999999, -48.599999999999994, -18.0, -5.2, -29.40000000000004, -26.5, -4.3, -14.3, -8.6, -14.4, -16.1, -5.3, -6.300000000000001, -8.499999999999991, -4.4, -13.799999999999999, -7.8999999999999995, -7.3, -15.299999999999999, -9.499999999999998, -4.2, -8.3, -3.2, -17.3, -5.1000000000000005, -5.300000000000001, -8.8, -25.0, -12.89999999999998, -24.4, -11.699999999999996, -3.3, -10.899999999999999, -2.7, -15.799999999999999, -24.4, -11.9, -27.000000000000007, -13.2, -16.2, -3.2, -18.0, -12.899999999999999, -5.2, -8.999999999999998, -31.799999999999997, -5.9, -3.3, -4.4, -19.1, -18.400000000000013, -7.599999999999999, -23.10000000000001, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.927791301736257, "mean_inference_ms": 1.9253278095012525, "mean_action_processing_ms": 0.10225091250632982, "mean_env_wait_ms": 21.88821244118385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1616000, "timesteps_this_iter": 0, "agent_timesteps_total": 1616000, "timers": {"sample_time_ms": 53667.577, "sample_throughput": 74.533, "load_time_ms": 1.302, "load_throughput": 3071119.003, "learn_time_ms": 26683.628, "learn_throughput": 149.905, "update_time_ms": 4.815}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.1623577126572209, "policy_loss": -0.013348838500678539, "vf_loss": 17.552789334456126, "vf_explained_var": 0.16934495209365763, "kl": 0.009903329109524076, "entropy": 0.19596147248020737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1616000, "num_agent_steps_sampled": 1616000, "num_steps_trained": 1616000, "num_agent_steps_trained": 1616000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16160, "training_iteration": 404, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-24-47", "timestamp": 1643685887, "time_this_iter_s": 53.02268886566162, "time_total_s": 20551.85741519928, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20551.85741519928, "timesteps_since_restore": 0, "iterations_since_restore": 404, "perf": {"cpu_util_percent": 28.426666666666662, "ram_util_percent": 71.39999999999998}}
{"episode_reward_max": -1.3, "episode_reward_min": -55.4, "episode_reward_mean": -12.076, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -17.1, -9.3, -4.2, -17.099999999999998, -4.4, -14.399999999999999, -48.599999999999994, -18.0, -5.2, -29.40000000000004, -26.5, -4.3, -14.3, -8.6, -14.4, -16.1, -5.3, -6.300000000000001, -8.499999999999991, -4.4, -13.799999999999999, -7.8999999999999995, -7.3, -15.299999999999999, -9.499999999999998, -4.2, -8.3, -3.2, -17.3, -5.1000000000000005, -5.300000000000001, -8.8, -25.0, -12.89999999999998, -24.4, -11.699999999999996, -3.3, -10.899999999999999, -2.7, -15.799999999999999, -24.4, -11.9, -27.000000000000007, -13.2, -16.2, -3.2, -18.0, -12.899999999999999, -5.2, -8.999999999999998, -31.799999999999997, -5.9, -3.3, -4.4, -19.1, -18.400000000000013, -7.599999999999999, -23.10000000000001, -4.3, -8.2, -5.2, -55.4, -27.700000000000017, -19.7, -4.4, -6.300000000000001, -10.6, -7.799999999999999, -3.2, -1.3, -4.3, -5.799999999999999, -4.3, -7.300000000000001, -6.999999999999998, -10.699999999999998, -3.2, -9.7, -15.799999999999999, -22.099999999999998, -18.0, -3.3, -20.700000000000006, -5.999999999999999, -13.799999999999986, -9.2, -7.799999999999998, -6.4, -19.5, -13.999999999999996, -20.4, -7.399999999999999, -6.300000000000001, -9.9, -5.4, -16.7, -7.2, -12.1, -11.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.927482779932914, "mean_inference_ms": 1.9296123840378896, "mean_action_processing_ms": 0.10250879650797946, "mean_env_wait_ms": 21.88025714788013, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1620000, "timesteps_this_iter": 0, "agent_timesteps_total": 1620000, "timers": {"sample_time_ms": 53558.683, "sample_throughput": 74.684, "load_time_ms": 1.306, "load_throughput": 3062206.323, "learn_time_ms": 26711.843, "learn_throughput": 149.746, "update_time_ms": 4.905}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.2578033372361754, "policy_loss": -0.011855414046114812, "vf_loss": 26.942803415816318, "vf_explained_var": -0.11639020071234754, "kl": 0.01278907945975363, "entropy": 0.24128397018198044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1620000, "num_agent_steps_sampled": 1620000, "num_steps_trained": 1620000, "num_agent_steps_trained": 1620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16200, "training_iteration": 405, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-25-40", "timestamp": 1643685940, "time_this_iter_s": 53.30790305137634, "time_total_s": 20605.165318250656, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20605.165318250656, "timesteps_since_restore": 0, "iterations_since_restore": 405, "perf": {"cpu_util_percent": 24.667105263157893, "ram_util_percent": 71.38421052631577}}
{"episode_reward_max": -1.2, "episode_reward_min": -86.19999999999995, "episode_reward_mean": -13.214000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999999, -24.4, -11.9, -27.000000000000007, -13.2, -16.2, -3.2, -18.0, -12.899999999999999, -5.2, -8.999999999999998, -31.799999999999997, -5.9, -3.3, -4.4, -19.1, -18.400000000000013, -7.599999999999999, -23.10000000000001, -4.3, -8.2, -5.2, -55.4, -27.700000000000017, -19.7, -4.4, -6.300000000000001, -10.6, -7.799999999999999, -3.2, -1.3, -4.3, -5.799999999999999, -4.3, -7.300000000000001, -6.999999999999998, -10.699999999999998, -3.2, -9.7, -15.799999999999999, -22.099999999999998, -18.0, -3.3, -20.700000000000006, -5.999999999999999, -13.799999999999986, -9.2, -7.799999999999998, -6.4, -19.5, -13.999999999999996, -20.4, -7.399999999999999, -6.300000000000001, -9.9, -5.4, -16.7, -7.2, -12.1, -11.9, -8.4, -8.2, -14.199999999999998, -8.0, -17.3, -3.4, -7.300000000000001, -86.19999999999995, -6.799999999999999, -3.4, -17.799999999999997, -16.6, -14.399999999999999, -15.799999999999999, -12.4, -15.7, -25.40000000000001, -13.1, -3.3, -17.3, -3.3, -13.799999999999997, -1.2, -13.199999999999998, -5.300000000000001, -4.2, -7.300000000000001, -3.3, -22.699999999999996, -52.2, -16.3, -20.900000000000006, -36.0, -14.400000000000006, -6.0, -6.4, -13.899999999999986, -3.3, -5.300000000000001, -26.700000000000024], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9272632221539574, "mean_inference_ms": 1.9339795857552218, "mean_action_processing_ms": 0.1027805132158223, "mean_env_wait_ms": 21.873327413775552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1624000, "timesteps_this_iter": 0, "agent_timesteps_total": 1624000, "timers": {"sample_time_ms": 53693.875, "sample_throughput": 74.496, "load_time_ms": 1.303, "load_throughput": 3069995.059, "learn_time_ms": 26645.58, "learn_throughput": 150.119, "update_time_ms": 4.846}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.4590083200324287, "policy_loss": -0.01406638354103091, "vf_loss": 47.279908355141195, "vf_explained_var": -0.06428517359559253, "kl": 0.015278265168650149, "entropy": 0.21149357915004735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1624000, "num_agent_steps_sampled": 1624000, "num_steps_trained": 1624000, "num_agent_steps_trained": 1624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16240, "training_iteration": 406, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-26-34", "timestamp": 1643685994, "time_this_iter_s": 53.635164976119995, "time_total_s": 20658.800483226776, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20658.800483226776, "timesteps_since_restore": 0, "iterations_since_restore": 406, "perf": {"cpu_util_percent": 27.735526315789482, "ram_util_percent": 71.38552631578946}}
{"episode_reward_max": -1.2, "episode_reward_min": -86.19999999999995, "episode_reward_mean": -14.155, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.099999999999998, -18.0, -3.3, -20.700000000000006, -5.999999999999999, -13.799999999999986, -9.2, -7.799999999999998, -6.4, -19.5, -13.999999999999996, -20.4, -7.399999999999999, -6.300000000000001, -9.9, -5.4, -16.7, -7.2, -12.1, -11.9, -8.4, -8.2, -14.199999999999998, -8.0, -17.3, -3.4, -7.300000000000001, -86.19999999999995, -6.799999999999999, -3.4, -17.799999999999997, -16.6, -14.399999999999999, -15.799999999999999, -12.4, -15.7, -25.40000000000001, -13.1, -3.3, -17.3, -3.3, -13.799999999999997, -1.2, -13.199999999999998, -5.300000000000001, -4.2, -7.300000000000001, -3.3, -22.699999999999996, -52.2, -16.3, -20.900000000000006, -36.0, -14.400000000000006, -6.0, -6.4, -13.899999999999986, -3.3, -5.300000000000001, -26.700000000000024, -4.300000000000001, -15.599999999999998, -4.4, -15.799999999999999, -16.799999999999997, -4.3, -18.3, -16.9, -20.400000000000006, -3.4, -31.1, -19.499999999999993, -19.3, -11.4, -4.4, -27.7, -11.2, -11.3, -4.2, -25.700000000000003, -23.200000000000006, -14.999999999999998, -36.2, -4.300000000000001, -16.699999999999996, -3.3, -10.799999999999997, -8.699999999999998, -3.2, -44.2, -21.80000000000001, -3.2, -4.4, -38.7, -10.999999999999998, -20.400000000000002, -5.300000000000001, -15.2, -10.799999999999997, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9269995386704353, "mean_inference_ms": 1.9383562746107963, "mean_action_processing_ms": 0.10305612161102612, "mean_env_wait_ms": 21.866570535948227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1628000, "timesteps_this_iter": 0, "agent_timesteps_total": 1628000, "timers": {"sample_time_ms": 53546.863, "sample_throughput": 74.701, "load_time_ms": 1.305, "load_throughput": 3066179.798, "learn_time_ms": 26615.557, "learn_throughput": 150.288, "update_time_ms": 4.795}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.2211837435461661, "policy_loss": -0.01394660501109977, "vf_loss": 23.481135627018507, "vf_explained_var": 0.04832238939500624, "kl": 0.017682157124553864, "entropy": 0.22102824897775727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1628000, "num_agent_steps_sampled": 1628000, "num_steps_trained": 1628000, "num_agent_steps_trained": 1628000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16280, "training_iteration": 407, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-27-26", "timestamp": 1643686046, "time_this_iter_s": 52.761669874191284, "time_total_s": 20711.562153100967, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20711.562153100967, "timesteps_since_restore": 0, "iterations_since_restore": 407, "perf": {"cpu_util_percent": 27.17972972972973, "ram_util_percent": 71.35405405405405}}
{"episode_reward_max": -1.2, "episode_reward_min": -52.2, "episode_reward_mean": -14.041999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -13.799999999999997, -1.2, -13.199999999999998, -5.300000000000001, -4.2, -7.300000000000001, -3.3, -22.699999999999996, -52.2, -16.3, -20.900000000000006, -36.0, -14.400000000000006, -6.0, -6.4, -13.899999999999986, -3.3, -5.300000000000001, -26.700000000000024, -4.300000000000001, -15.599999999999998, -4.4, -15.799999999999999, -16.799999999999997, -4.3, -18.3, -16.9, -20.400000000000006, -3.4, -31.1, -19.499999999999993, -19.3, -11.4, -4.4, -27.7, -11.2, -11.3, -4.2, -25.700000000000003, -23.200000000000006, -14.999999999999998, -36.2, -4.300000000000001, -16.699999999999996, -3.3, -10.799999999999997, -8.699999999999998, -3.2, -44.2, -21.80000000000001, -3.2, -4.4, -38.7, -10.999999999999998, -20.400000000000002, -5.300000000000001, -15.2, -10.799999999999997, -4.3, -4.4, -4.300000000000001, -5.2, -22.099999999999994, -14.399999999999999, -37.7, -15.399999999999999, -7.3, -28.000000000000004, -15.599999999999973, -18.1, -27.200000000000003, -4.4, -4.300000000000001, -5.700000000000001, -7.2, -10.799999999999999, -18.799999999999997, -3.3, -4.2, -8.0, -14.899999999999999, -3.2, -21.800000000000004, -3.4, -9.2, -4.2, -15.399999999999999, -4.4, -9.3, -15.599999999999998, -35.60000000000001, -13.999999999999988, -43.2, -32.10000000000001, -11.599999999999977, -2.800000000000001, -23.299999999999997, -7.1, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9268763103147855, "mean_inference_ms": 1.9427994781059255, "mean_action_processing_ms": 0.10333164162084364, "mean_env_wait_ms": 21.860190458440666, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1632000, "timesteps_this_iter": 0, "agent_timesteps_total": 1632000, "timers": {"sample_time_ms": 53545.382, "sample_throughput": 74.703, "load_time_ms": 1.305, "load_throughput": 3065003.471, "learn_time_ms": 26621.27, "learn_throughput": 150.256, "update_time_ms": 4.761}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.1848896022295199, "policy_loss": -0.011999519155310686, "vf_loss": 19.674463679713586, "vf_explained_var": 0.14048901892477467, "kl": 0.008009218995478408, "entropy": 0.2174852797060564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1632000, "num_agent_steps_sampled": 1632000, "num_steps_trained": 1632000, "num_agent_steps_trained": 1632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16320, "training_iteration": 408, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-28-21", "timestamp": 1643686101, "time_this_iter_s": 54.05337381362915, "time_total_s": 20765.615526914597, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20765.615526914597, "timesteps_since_restore": 0, "iterations_since_restore": 408, "perf": {"cpu_util_percent": 28.741558441558446, "ram_util_percent": 71.33376623376623}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -47.6, "episode_reward_mean": -13.103000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.200000000000006, -14.999999999999998, -36.2, -4.300000000000001, -16.699999999999996, -3.3, -10.799999999999997, -8.699999999999998, -3.2, -44.2, -21.80000000000001, -3.2, -4.4, -38.7, -10.999999999999998, -20.400000000000002, -5.300000000000001, -15.2, -10.799999999999997, -4.3, -4.4, -4.300000000000001, -5.2, -22.099999999999994, -14.399999999999999, -37.7, -15.399999999999999, -7.3, -28.000000000000004, -15.599999999999973, -18.1, -27.200000000000003, -4.4, -4.300000000000001, -5.700000000000001, -7.2, -10.799999999999999, -18.799999999999997, -3.3, -4.2, -8.0, -14.899999999999999, -3.2, -21.800000000000004, -3.4, -9.2, -4.2, -15.399999999999999, -4.4, -9.3, -15.599999999999998, -35.60000000000001, -13.999999999999988, -43.2, -32.10000000000001, -11.599999999999977, -2.800000000000001, -23.299999999999997, -7.1, -4.300000000000001, -9.899999999999999, -3.4, -19.799999999999997, -5.000000000000001, -5.300000000000001, -18.6, -12.2, -10.499999999999998, -4.300000000000001, -17.0, -2.7000000000000006, -4.300000000000001, -4.300000000000001, -14.0, -11.9, -12.5, -3.4, -4.2, -15.199999999999973, -3.3, -4.3, -33.50000000000001, -15.699999999999994, -3.8000000000000003, -4.4, -6.300000000000001, -3.4, -11.099999999999996, -3.2, -4.300000000000001, -3.3, -23.30000000000003, -47.6, -4.3, -22.9, -19.2, -9.599999999999998, -36.900000000000006, -22.900000000000006, -6.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9267591070725287, "mean_inference_ms": 1.947119913617471, "mean_action_processing_ms": 0.10359515383538445, "mean_env_wait_ms": 21.85332582454358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1636000, "timesteps_this_iter": 0, "agent_timesteps_total": 1636000, "timers": {"sample_time_ms": 53406.907, "sample_throughput": 74.897, "load_time_ms": 1.309, "load_throughput": 3054846.322, "learn_time_ms": 26661.263, "learn_throughput": 150.03, "update_time_ms": 4.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.1594510006337797, "policy_loss": -0.006604659474224493, "vf_loss": 16.587156966520894, "vf_explained_var": 0.08923585645614132, "kl": 0.010204512806171791, "entropy": 0.23143515781930057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1636000, "num_agent_steps_sampled": 1636000, "num_steps_trained": 1636000, "num_agent_steps_trained": 1636000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16360, "training_iteration": 409, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-29-14", "timestamp": 1643686154, "time_this_iter_s": 53.19411587715149, "time_total_s": 20818.809642791748, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20818.809642791748, "timesteps_since_restore": 0, "iterations_since_restore": 409, "perf": {"cpu_util_percent": 27.12533333333333, "ram_util_percent": 71.29866666666668}}
{"episode_reward_max": -2.7, "episode_reward_min": -53.3, "episode_reward_mean": -11.835, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, -14.899999999999999, -3.2, -21.800000000000004, -3.4, -9.2, -4.2, -15.399999999999999, -4.4, -9.3, -15.599999999999998, -35.60000000000001, -13.999999999999988, -43.2, -32.10000000000001, -11.599999999999977, -2.800000000000001, -23.299999999999997, -7.1, -4.300000000000001, -9.899999999999999, -3.4, -19.799999999999997, -5.000000000000001, -5.300000000000001, -18.6, -12.2, -10.499999999999998, -4.300000000000001, -17.0, -2.7000000000000006, -4.300000000000001, -4.300000000000001, -14.0, -11.9, -12.5, -3.4, -4.2, -15.199999999999973, -3.3, -4.3, -33.50000000000001, -15.699999999999994, -3.8000000000000003, -4.4, -6.300000000000001, -3.4, -11.099999999999996, -3.2, -4.300000000000001, -3.3, -23.30000000000003, -47.6, -4.3, -22.9, -19.2, -9.599999999999998, -36.900000000000006, -22.900000000000006, -6.0, -4.300000000000001, -8.3, -53.3, -6.2, -16.69999999999999, -2.7, -4.4, -4.2, -6.099999999999999, -20.0, -18.9, -33.800000000000004, -10.699999999999998, -11.2, -7.3, -4.2, -4.800000000000001, -15.899999999999993, -7.799999999999999, -3.3, -5.300000000000001, -9.3, -4.4, -5.300000000000001, -12.7, -3.2, -18.500000000000004, -10.799999999999999, -19.600000000000037, -7.300000000000001, -16.5, -11.799999999999999, -4.3, -7.300000000000001, -14.899999999999999, -5.4, -5.300000000000001, -4.4, -5.300000000000001, -16.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.926751956985107, "mean_inference_ms": 1.9514824282907728, "mean_action_processing_ms": 0.10385664733287385, "mean_env_wait_ms": 21.846524164671763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1640000, "timesteps_this_iter": 0, "agent_timesteps_total": 1640000, "timers": {"sample_time_ms": 53493.631, "sample_throughput": 74.775, "load_time_ms": 1.286, "load_throughput": 3110174.814, "learn_time_ms": 26696.78, "learn_throughput": 149.831, "update_time_ms": 4.746}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.1990712360669208, "policy_loss": -0.006866392105947979, "vf_loss": 20.571611773631265, "vf_explained_var": 0.07100002707973603, "kl": 0.01227878739148673, "entropy": 0.21824459428748777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1640000, "num_agent_steps_sampled": 1640000, "num_steps_trained": 1640000, "num_agent_steps_trained": 1640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16400, "training_iteration": 410, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-30-08", "timestamp": 1643686208, "time_this_iter_s": 54.12901997566223, "time_total_s": 20872.93866276741, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20872.93866276741, "timesteps_since_restore": 0, "iterations_since_restore": 410, "perf": {"cpu_util_percent": 30.702597402597394, "ram_util_percent": 71.22337662337665}}
{"episode_reward_max": -2.7, "episode_reward_min": -95.70000000000014, "episode_reward_mean": -14.045000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -33.50000000000001, -15.699999999999994, -3.8000000000000003, -4.4, -6.300000000000001, -3.4, -11.099999999999996, -3.2, -4.300000000000001, -3.3, -23.30000000000003, -47.6, -4.3, -22.9, -19.2, -9.599999999999998, -36.900000000000006, -22.900000000000006, -6.0, -4.300000000000001, -8.3, -53.3, -6.2, -16.69999999999999, -2.7, -4.4, -4.2, -6.099999999999999, -20.0, -18.9, -33.800000000000004, -10.699999999999998, -11.2, -7.3, -4.2, -4.800000000000001, -15.899999999999993, -7.799999999999999, -3.3, -5.300000000000001, -9.3, -4.4, -5.300000000000001, -12.7, -3.2, -18.500000000000004, -10.799999999999999, -19.600000000000037, -7.300000000000001, -16.5, -11.799999999999999, -4.3, -7.300000000000001, -14.899999999999999, -5.4, -5.300000000000001, -4.4, -5.300000000000001, -16.6, -66.6, -21.000000000000004, -23.199999999999996, -28.900000000000002, -3.2, -4.4, -11.3, -9.399999999999997, -3.3, -16.3, -5.2, -4.4, -23.900000000000006, -14.699999999999998, -3.5000000000000004, -13.8, -26.9, -7.9, -25.200000000000003, -3.3, -14.5, -4.300000000000001, -5.4, -10.699999999999998, -14.6, -10.499999999999996, -4.2, -13.5, -23.199999999999996, -36.69999999999993, -20.9, -95.70000000000014, -7.9, -5.6, -3.2, -47.500000000000064, -10.5, -22.0, -15.7, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9267085927453387, "mean_inference_ms": 1.9557155239642197, "mean_action_processing_ms": 0.10411363633982085, "mean_env_wait_ms": 21.839207122782746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1644000, "timesteps_this_iter": 0, "agent_timesteps_total": 1644000, "timers": {"sample_time_ms": 53407.308, "sample_throughput": 74.896, "load_time_ms": 1.284, "load_throughput": 3114852.029, "learn_time_ms": 126269.22, "learn_throughput": 31.678, "update_time_ms": 4.458}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.7698395794117322, "policy_loss": -0.015406480339425866, "vf_loss": 78.49966688463765, "vf_explained_var": -0.1721525433883872, "kl": 0.01382491179256948, "entropy": 0.24620669522593097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1644000, "num_agent_steps_sampled": 1644000, "num_steps_trained": 1644000, "num_agent_steps_trained": 1644000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16440, "training_iteration": 411, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-47-37", "timestamp": 1643687257, "time_this_iter_s": 1048.8434147834778, "time_total_s": 21921.782077550888, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 21921.782077550888, "timesteps_since_restore": 0, "iterations_since_restore": 411, "perf": {"cpu_util_percent": 27.093421052631584, "ram_util_percent": 71.16315789473684}}
{"episode_reward_max": -3.2, "episode_reward_min": -95.70000000000014, "episode_reward_mean": -14.163000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -9.3, -4.4, -5.300000000000001, -12.7, -3.2, -18.500000000000004, -10.799999999999999, -19.600000000000037, -7.300000000000001, -16.5, -11.799999999999999, -4.3, -7.300000000000001, -14.899999999999999, -5.4, -5.300000000000001, -4.4, -5.300000000000001, -16.6, -66.6, -21.000000000000004, -23.199999999999996, -28.900000000000002, -3.2, -4.4, -11.3, -9.399999999999997, -3.3, -16.3, -5.2, -4.4, -23.900000000000006, -14.699999999999998, -3.5000000000000004, -13.8, -26.9, -7.9, -25.200000000000003, -3.3, -14.5, -4.300000000000001, -5.4, -10.699999999999998, -14.6, -10.499999999999996, -4.2, -13.5, -23.199999999999996, -36.69999999999993, -20.9, -95.70000000000014, -7.9, -5.6, -3.2, -47.500000000000064, -10.5, -22.0, -15.7, -3.2, -3.3, -5.499999999999999, -3.4, -14.3, -9.200000000000001, -19.700000000000003, -3.3, -22.099999999999994, -4.3, -3.6000000000000005, -30.2, -3.3, -4.300000000000001, -11.899999999999999, -3.3, -9.999999999999998, -3.3, -42.5, -26.50000000000004, -18.600000000000005, -18.900000000000002, -10.9, -33.10000000000001, -7.2, -14.099999999999998, -20.9, -12.199999999999973, -12.69999999999999, -40.3, -3.4, -4.300000000000001, -4.4, -7.300000000000001, -10.6, -6.899999999999999, -3.4, -21.300000000000004, -12.499999999999998, -44.4, -10.499999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.924694595498934, "mean_inference_ms": 1.9574078513718465, "mean_action_processing_ms": 0.10422712986020402, "mean_env_wait_ms": 21.81860423851911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1648000, "timesteps_this_iter": 0, "agent_timesteps_total": 1648000, "timers": {"sample_time_ms": 51611.868, "sample_throughput": 77.502, "load_time_ms": 1.187, "load_throughput": 3370814.112, "learn_time_ms": 126351.478, "learn_throughput": 31.658, "update_time_ms": 4.399}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.23635472629559778, "policy_loss": -0.014522278322387608, "vf_loss": 25.063811484716272, "vf_explained_var": -0.12416303632079914, "kl": 0.013242126018675011, "entropy": 0.20107893793573303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1648000, "num_agent_steps_sampled": 1648000, "num_steps_trained": 1648000, "num_agent_steps_trained": 1648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16480, "training_iteration": 412, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_03-48-12", "timestamp": 1643687292, "time_this_iter_s": 34.54751896858215, "time_total_s": 21956.32959651947, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 21956.32959651947, "timesteps_since_restore": 0, "iterations_since_restore": 412, "perf": {"cpu_util_percent": 33.16458333333333, "ram_util_percent": 71.19791666666667}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -95.70000000000014, "episode_reward_mean": -14.017000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.5, -4.300000000000001, -5.4, -10.699999999999998, -14.6, -10.499999999999996, -4.2, -13.5, -23.199999999999996, -36.69999999999993, -20.9, -95.70000000000014, -7.9, -5.6, -3.2, -47.500000000000064, -10.5, -22.0, -15.7, -3.2, -3.3, -5.499999999999999, -3.4, -14.3, -9.200000000000001, -19.700000000000003, -3.3, -22.099999999999994, -4.3, -3.6000000000000005, -30.2, -3.3, -4.300000000000001, -11.899999999999999, -3.3, -9.999999999999998, -3.3, -42.5, -26.50000000000004, -18.600000000000005, -18.900000000000002, -10.9, -33.10000000000001, -7.2, -14.099999999999998, -20.9, -12.199999999999973, -12.69999999999999, -40.3, -3.4, -4.300000000000001, -4.4, -7.300000000000001, -10.6, -6.899999999999999, -3.4, -21.300000000000004, -12.499999999999998, -44.4, -10.499999999999998, -16.4, -12.199999999999998, -17.1, -8.8, -11.199999999999976, -3.2, -13.099999999999993, -17.4, -24.799999999999997, -4.4, -22.499999999999996, -4.4, -18.800000000000004, -28.800000000000047, -5.3, -22.2, -4.300000000000001, -13.1, -7.3, -5.2, -12.799999999999997, -24.19999999999999, -3.5000000000000004, -10.699999999999994, -3.900000000000001, -3.3, -8.299999999999997, -5.4, -22.9, -13.899999999999999, -15.799999999999999, -18.9, -2.3000000000000003, -9.0, -4.300000000000001, -6.1, -6.799999999999999, -23.200000000000003, -15.299999999999978, -18.899999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.918957061683134, "mean_inference_ms": 1.9580252351556737, "mean_action_processing_ms": 0.10427391903821182, "mean_env_wait_ms": 21.79265685524366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1652000, "timesteps_this_iter": 0, "agent_timesteps_total": 1652000, "timers": {"sample_time_ms": 51091.123, "sample_throughput": 78.291, "load_time_ms": 1.077, "load_throughput": 3715143.382, "learn_time_ms": 124627.905, "learn_throughput": 32.096, "update_time_ms": 4.579}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.14354054954664042, "policy_loss": -0.013952021571176667, "vf_loss": 15.72606940320743, "vf_explained_var": -0.009806045665535876, "kl": 0.012853217238329044, "entropy": 0.25540432380412215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1652000, "num_agent_steps_sampled": 1652000, "num_steps_trained": 1652000, "num_agent_steps_trained": 1652000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16520, "training_iteration": 413, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_04-05-49", "timestamp": 1643688349, "time_this_iter_s": 1057.7698030471802, "time_total_s": 23014.09939956665, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 23014.09939956665, "timesteps_since_restore": 0, "iterations_since_restore": 413, "perf": {"cpu_util_percent": 31.942857142857147, "ram_util_percent": 71.12857142857143}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -44.4, "episode_reward_mean": -12.526, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.900000000000002, -10.9, -33.10000000000001, -7.2, -14.099999999999998, -20.9, -12.199999999999973, -12.69999999999999, -40.3, -3.4, -4.300000000000001, -4.4, -7.300000000000001, -10.6, -6.899999999999999, -3.4, -21.300000000000004, -12.499999999999998, -44.4, -10.499999999999998, -16.4, -12.199999999999998, -17.1, -8.8, -11.199999999999976, -3.2, -13.099999999999993, -17.4, -24.799999999999997, -4.4, -22.499999999999996, -4.4, -18.800000000000004, -28.800000000000047, -5.3, -22.2, -4.300000000000001, -13.1, -7.3, -5.2, -12.799999999999997, -24.19999999999999, -3.5000000000000004, -10.699999999999994, -3.900000000000001, -3.3, -8.299999999999997, -5.4, -22.9, -13.899999999999999, -15.799999999999999, -18.9, -2.3000000000000003, -9.0, -4.300000000000001, -6.1, -6.799999999999999, -23.200000000000003, -15.299999999999978, -18.899999999999995, -4.2, -8.4, -4.300000000000001, -26.500000000000007, -10.899999999999999, -4.4, -11.499999999999993, -37.3, -2.4000000000000004, -4.4, -10.2, -4.4, -15.3, -19.3, -12.199999999999998, -5.8999999999999995, -15.7, -6.4, -3.3, -36.300000000000004, -3.4, -19.300000000000004, -8.7, -3.4, -15.099999999999998, -20.1, -26.199999999999996, -3.3, -14.2, -4.300000000000001, -5.999999999999998, -12.0, -5.9, -7.800000000000001, -26.900000000000002, -10.799999999999986, -3.3, -4.4, -14.1, -10.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.912394673101077, "mean_inference_ms": 1.9603187845560286, "mean_action_processing_ms": 0.10442078533685754, "mean_env_wait_ms": 21.776215808395936, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1656000, "timesteps_this_iter": 0, "agent_timesteps_total": 1656000, "timers": {"sample_time_ms": 49773.52, "sample_throughput": 80.364, "load_time_ms": 1.078, "load_throughput": 3712184.091, "learn_time_ms": 214561.833, "learn_throughput": 18.643, "update_time_ms": 4.346}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.14722732835304073, "policy_loss": -0.007495508473166214, "vf_loss": 15.450123865277536, "vf_explained_var": 0.052640812691821845, "kl": 0.01228353058676381, "entropy": 0.24082085684903207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1656000, "num_agent_steps_sampled": 1656000, "num_steps_trained": 1656000, "num_agent_steps_trained": 1656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16560, "training_iteration": 414, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_04-21-46", "timestamp": 1643689306, "time_this_iter_s": 956.3969521522522, "time_total_s": 23970.496351718903, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 23970.496351718903, "timesteps_since_restore": 0, "iterations_since_restore": 414, "perf": {"cpu_util_percent": 42.77457627118645, "ram_util_percent": 70.9813559322034}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -52.900000000000105, "episode_reward_mean": -12.217000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999997, -24.19999999999999, -3.5000000000000004, -10.699999999999994, -3.900000000000001, -3.3, -8.299999999999997, -5.4, -22.9, -13.899999999999999, -15.799999999999999, -18.9, -2.3000000000000003, -9.0, -4.300000000000001, -6.1, -6.799999999999999, -23.200000000000003, -15.299999999999978, -18.899999999999995, -4.2, -8.4, -4.300000000000001, -26.500000000000007, -10.899999999999999, -4.4, -11.499999999999993, -37.3, -2.4000000000000004, -4.4, -10.2, -4.4, -15.3, -19.3, -12.199999999999998, -5.8999999999999995, -15.7, -6.4, -3.3, -36.300000000000004, -3.4, -19.300000000000004, -8.7, -3.4, -15.099999999999998, -20.1, -26.199999999999996, -3.3, -14.2, -4.300000000000001, -5.999999999999998, -12.0, -5.9, -7.800000000000001, -26.900000000000002, -10.799999999999986, -3.3, -4.4, -14.1, -10.8, -4.2, -52.900000000000105, -3.4, -4.3, -23.9, -8.5, -15.799999999999997, -32.4, -11.999999999999998, -12.399999999999999, -17.800000000000004, -3.3, -4.300000000000001, -6.999999999999999, -31.7, -5.2, -3.2, -4.4, -15.399999999999997, -14.899999999999984, -21.8, -32.7, -14.999999999999998, -7.2, -6.999999999999998, -21.29999999999996, -3.4, -18.700000000000003, -3.4, -20.400000000000055, -8.2, -26.700000000000014, -3.4, -4.4, -16.19999999999998, -4.300000000000001, -6.699999999999999, -11.999999999999988, -14.699999999999994, -4.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.405405762409053, "mean_inference_ms": 1.9634367200483347, "mean_action_processing_ms": 0.10460932132815229, "mean_env_wait_ms": 21.765801243669184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1660000, "timesteps_this_iter": 0, "agent_timesteps_total": 1660000, "timers": {"sample_time_ms": 47876.67, "sample_throughput": 83.548, "load_time_ms": 1.078, "load_throughput": 3710049.756, "learn_time_ms": 310500.567, "learn_throughput": 12.882, "update_time_ms": 4.021}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.241448731804567, "policy_loss": -0.012730829209409733, "vf_loss": 25.400789267401542, "vf_explained_var": 0.12976168432543356, "kl": 0.009516002679470009, "entropy": 0.22603920376108538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1660000, "num_agent_steps_sampled": 1660000, "num_steps_trained": 1660000, "num_agent_steps_trained": 1660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16600, "training_iteration": 415, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_04-38-33", "timestamp": 1643690313, "time_this_iter_s": 1007.3532111644745, "time_total_s": 24977.849562883377, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 24977.849562883377, "timesteps_since_restore": 0, "iterations_since_restore": 415, "perf": {"cpu_util_percent": 48.392424242424234, "ram_util_percent": 71.12575757575758}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.900000000000105, "episode_reward_mean": -11.995999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -19.300000000000004, -8.7, -3.4, -15.099999999999998, -20.1, -26.199999999999996, -3.3, -14.2, -4.300000000000001, -5.999999999999998, -12.0, -5.9, -7.800000000000001, -26.900000000000002, -10.799999999999986, -3.3, -4.4, -14.1, -10.8, -4.2, -52.900000000000105, -3.4, -4.3, -23.9, -8.5, -15.799999999999997, -32.4, -11.999999999999998, -12.399999999999999, -17.800000000000004, -3.3, -4.300000000000001, -6.999999999999999, -31.7, -5.2, -3.2, -4.4, -15.399999999999997, -14.899999999999984, -21.8, -32.7, -14.999999999999998, -7.2, -6.999999999999998, -21.29999999999996, -3.4, -18.700000000000003, -3.4, -20.400000000000055, -8.2, -26.700000000000014, -3.4, -4.4, -16.19999999999998, -4.300000000000001, -6.699999999999999, -11.999999999999988, -14.699999999999994, -4.4, -12.199999999999998, -6.300000000000001, -12.3, -3.4, -4.300000000000001, -4.4, -3.4, -7.4, -22.1, -24.000000000000007, -21.3, -4.300000000000001, -20.999999999999996, -4.700000000000001, -15.999999999999998, -9.299999999999997, -19.200000000000003, -20.3, -13.999999999999998, -3.3, -3.9000000000000004, -11.399999999999995, -24.4, -3.3, -15.899999999999999, -25.6, -11.799999999999999, -25.800000000000004, -3.3, -4.4, -4.300000000000001, -12.799999999999981, -19.3, -4.1000000000000005, -6.700000000000001, -3.3, -9.2, -4.1, -19.599999999999998, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.396860991921016, "mean_inference_ms": 1.9642712719980913, "mean_action_processing_ms": 0.10466230924767995, "mean_env_wait_ms": 21.743151087298756, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1664000, "timesteps_this_iter": 0, "agent_timesteps_total": 1664000, "timers": {"sample_time_ms": 45750.158, "sample_throughput": 87.431, "load_time_ms": 0.984, "load_throughput": 4063165.339, "learn_time_ms": 310502.065, "learn_throughput": 12.882, "update_time_ms": 4.089}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.1129307101080094, "policy_loss": -0.016961820920308433, "vf_loss": 12.969267858612922, "vf_explained_var": 0.19915015274478542, "kl": 0.011078086155440559, "entropy": 0.22184992561978037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1664000, "num_agent_steps_sampled": 1664000, "num_steps_trained": 1664000, "num_agent_steps_trained": 1664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16640, "training_iteration": 416, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_04-39-06", "timestamp": 1643690346, "time_this_iter_s": 33.02751803398132, "time_total_s": 25010.87708091736, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 25010.87708091736, "timesteps_since_restore": 0, "iterations_since_restore": 416, "perf": {"cpu_util_percent": 28.682978723404254, "ram_util_percent": 71.09574468085108}}
{"episode_reward_max": -3.2, "episode_reward_min": -32.7, "episode_reward_mean": -11.611, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.8, -32.7, -14.999999999999998, -7.2, -6.999999999999998, -21.29999999999996, -3.4, -18.700000000000003, -3.4, -20.400000000000055, -8.2, -26.700000000000014, -3.4, -4.4, -16.19999999999998, -4.300000000000001, -6.699999999999999, -11.999999999999988, -14.699999999999994, -4.4, -12.199999999999998, -6.300000000000001, -12.3, -3.4, -4.300000000000001, -4.4, -3.4, -7.4, -22.1, -24.000000000000007, -21.3, -4.300000000000001, -20.999999999999996, -4.700000000000001, -15.999999999999998, -9.299999999999997, -19.200000000000003, -20.3, -13.999999999999998, -3.3, -3.9000000000000004, -11.399999999999995, -24.4, -3.3, -15.899999999999999, -25.6, -11.799999999999999, -25.800000000000004, -3.3, -4.4, -4.300000000000001, -12.799999999999981, -19.3, -4.1000000000000005, -6.700000000000001, -3.3, -9.2, -4.1, -19.599999999999998, -4.3, -7.3, -8.5, -16.799999999999997, -13.899999999999999, -17.2, -6.1, -14.399999999999999, -23.5, -12.799999999999999, -3.3, -21.1, -3.4, -19.89999999999999, -4.3, -16.199999999999996, -10.3, -10.999999999999996, -3.4, -16.1, -4.300000000000001, -15.1, -28.199999999999996, -13.899999999999999, -19.900000000000002, -17.2, -17.6, -3.4, -4.300000000000001, -4.4, -4.300000000000001, -12.700000000000001, -3.2, -6.6, -7.3, -4.3, -6.2, -12.899999999999999, -12.299999999999997, -18.0, -12.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.387719338628329, "mean_inference_ms": 2.6358958338695824, "mean_action_processing_ms": 0.10468793608872831, "mean_env_wait_ms": 23.73108097015297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1668000, "timesteps_this_iter": 0, "agent_timesteps_total": 1668000, "timers": {"sample_time_ms": 45258.061, "sample_throughput": 88.382, "load_time_ms": 0.887, "load_throughput": 4509883.068, "learn_time_ms": 309058.611, "learn_throughput": 12.943, "update_time_ms": 4.084}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.09697458216737735, "policy_loss": 0.0017073726952476526, "vf_loss": 9.512584432030238, "vf_explained_var": 0.25277157355380314, "kl": 0.007836141820522603, "entropy": 0.25663422201910324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1668000, "num_agent_steps_sampled": 1668000, "num_steps_trained": 1668000, "num_agent_steps_trained": 1668000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16680, "training_iteration": 417, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-26-18", "timestamp": 1643693178, "time_this_iter_s": 2831.584578037262, "time_total_s": 27842.46165895462, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 27842.46165895462, "timesteps_since_restore": 0, "iterations_since_restore": 417, "perf": {"cpu_util_percent": 41.27391304347826, "ram_util_percent": 71.03695652173913}}
{"episode_reward_max": -3.2, "episode_reward_min": -46.3, "episode_reward_mean": -12.020000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -11.399999999999995, -24.4, -3.3, -15.899999999999999, -25.6, -11.799999999999999, -25.800000000000004, -3.3, -4.4, -4.300000000000001, -12.799999999999981, -19.3, -4.1000000000000005, -6.700000000000001, -3.3, -9.2, -4.1, -19.599999999999998, -4.3, -7.3, -8.5, -16.799999999999997, -13.899999999999999, -17.2, -6.1, -14.399999999999999, -23.5, -12.799999999999999, -3.3, -21.1, -3.4, -19.89999999999999, -4.3, -16.199999999999996, -10.3, -10.999999999999996, -3.4, -16.1, -4.300000000000001, -15.1, -28.199999999999996, -13.899999999999999, -19.900000000000002, -17.2, -17.6, -3.4, -4.300000000000001, -4.4, -4.300000000000001, -12.700000000000001, -3.2, -6.6, -7.3, -4.3, -6.2, -12.899999999999999, -12.299999999999997, -18.0, -12.9, -15.199999999999974, -6.899999999999999, -3.4, -23.699999999999996, -6.9, -46.3, -8.4, -4.300000000000001, -16.700000000000003, -22.4, -4.5, -28.6, -5.5, -18.500000000000004, -18.3, -9.399999999999999, -14.899999999999999, -4.4, -8.999999999999996, -11.699999999999998, -4.300000000000001, -11.700000000000001, -4.3, -5.300000000000001, -11.899999999999999, -26.10000000000001, -7.899999999999995, -23.1, -12.0, -15.999999999999998, -15.1, -15.1, -9.600000000000001, -9.6, -19.699999999999996, -3.3, -23.199999999999996, -6.5, -3.4, -18.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.380045129089592, "mean_inference_ms": 3.3079806972927766, "mean_action_processing_ms": 0.104826949521571, "mean_env_wait_ms": 25.72490061217963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1672000, "timesteps_this_iter": 0, "agent_timesteps_total": 1672000, "timers": {"sample_time_ms": 43969.161, "sample_throughput": 90.973, "load_time_ms": 0.888, "load_throughput": 4503225.252, "learn_time_ms": 309139.933, "learn_throughput": 12.939, "update_time_ms": 4.222}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.19058469860471525, "policy_loss": -0.0012763303974943777, "vf_loss": 19.167874893706333, "vf_explained_var": 0.06797722302457337, "kl": 0.010104188488375087, "entropy": 0.2494227387812189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1672000, "num_agent_steps_sampled": 1672000, "num_steps_trained": 1672000, "num_agent_steps_trained": 1672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16720, "training_iteration": 418, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-27-14", "timestamp": 1643693234, "time_this_iter_s": 56.430320262908936, "time_total_s": 27898.89197921753, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 27898.89197921753, "timesteps_since_restore": 0, "iterations_since_restore": 418, "perf": {"cpu_util_percent": 36.339999999999996, "ram_util_percent": 71.03875000000001}}
{"episode_reward_max": -2.2, "episode_reward_min": -46.3, "episode_reward_mean": -12.945, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.1, -28.199999999999996, -13.899999999999999, -19.900000000000002, -17.2, -17.6, -3.4, -4.300000000000001, -4.4, -4.300000000000001, -12.700000000000001, -3.2, -6.6, -7.3, -4.3, -6.2, -12.899999999999999, -12.299999999999997, -18.0, -12.9, -15.199999999999974, -6.899999999999999, -3.4, -23.699999999999996, -6.9, -46.3, -8.4, -4.300000000000001, -16.700000000000003, -22.4, -4.5, -28.6, -5.5, -18.500000000000004, -18.3, -9.399999999999999, -14.899999999999999, -4.4, -8.999999999999996, -11.699999999999998, -4.300000000000001, -11.700000000000001, -4.3, -5.300000000000001, -11.899999999999999, -26.10000000000001, -7.899999999999995, -23.1, -12.0, -15.999999999999998, -15.1, -15.1, -9.600000000000001, -9.6, -19.699999999999996, -3.3, -23.199999999999996, -6.5, -3.4, -18.9, -42.9, -15.3, -4.300000000000001, -2.2, -23.900000000000006, -4.300000000000001, -34.900000000000006, -13.4, -16.4, -15.499999999999998, -16.799999999999997, -5.6000000000000005, -3.4, -12.8, -7.3, -19.4, -27.7, -21.200000000000017, -38.7, -3.3, -14.0, -13.399999999999999, -3.3, -22.400000000000016, -5.0, -12.5, -4.3, -13.099999999999998, -20.8, -14.599999999999982, -4.4, -16.9, -17.099999999999998, -7.3, -5.300000000000001, -4.4, -4.300000000000001, -21.6, -6.4, -3.4000000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3737183854717685, "mean_inference_ms": 3.980072858269401, "mean_action_processing_ms": 0.10505932138174826, "mean_env_wait_ms": 26.37968070448586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1676000, "timesteps_this_iter": 0, "agent_timesteps_total": 1676000, "timers": {"sample_time_ms": 44024.335, "sample_throughput": 90.859, "load_time_ms": 0.886, "load_throughput": 4516195.86, "learn_time_ms": 309126.762, "learn_throughput": 12.94, "update_time_ms": 4.305}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.18975963836375584, "policy_loss": -0.0025464877336015624, "vf_loss": 19.21391385357867, "vf_explained_var": 0.10177416352815526, "kl": 0.009256443190593528, "entropy": 0.22692895997916498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1676000, "num_agent_steps_sampled": 1676000, "num_steps_trained": 1676000, "num_agent_steps_trained": 1676000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16760, "training_iteration": 419, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-28-07", "timestamp": 1643693287, "time_this_iter_s": 52.800621032714844, "time_total_s": 27951.692600250244, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 27951.692600250244, "timesteps_since_restore": 0, "iterations_since_restore": 419, "perf": {"cpu_util_percent": 29.143999999999995, "ram_util_percent": 71.048}}
{"episode_reward_max": -2.2, "episode_reward_min": -42.9, "episode_reward_mean": -13.055, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -11.700000000000001, -4.3, -5.300000000000001, -11.899999999999999, -26.10000000000001, -7.899999999999995, -23.1, -12.0, -15.999999999999998, -15.1, -15.1, -9.600000000000001, -9.6, -19.699999999999996, -3.3, -23.199999999999996, -6.5, -3.4, -18.9, -42.9, -15.3, -4.300000000000001, -2.2, -23.900000000000006, -4.300000000000001, -34.900000000000006, -13.4, -16.4, -15.499999999999998, -16.799999999999997, -5.6000000000000005, -3.4, -12.8, -7.3, -19.4, -27.7, -21.200000000000017, -38.7, -3.3, -14.0, -13.399999999999999, -3.3, -22.400000000000016, -5.0, -12.5, -4.3, -13.099999999999998, -20.8, -14.599999999999982, -4.4, -16.9, -17.099999999999998, -7.3, -5.300000000000001, -4.4, -4.300000000000001, -21.6, -6.4, -3.4000000000000004, -3.3, -5.4, -20.5, -26.900000000000006, -3.4, -11.2, -4.4, -10.199999999999998, -10.2, -24.8, -6.899999999999999, -20.900000000000002, -25.19999999999997, -29.500000000000007, -15.399999999999999, -18.5, -8.8, -20.2, -3.3, -4.300000000000001, -15.899999999999995, -3.4, -4.300000000000001, -4.4, -19.9, -8.999999999999996, -11.6, -28.20000000000001, -3.3, -22.400000000000002, -3.4, -23.899999999999995, -6.4, -10.3, -12.199999999999998, -12.4, -4.800000000000001, -30.299999999999997, -10.299999999999994, -5.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.36779552127751, "mean_inference_ms": 3.9793957642810596, "mean_action_processing_ms": 0.10530751674808364, "mean_env_wait_ms": 26.36246802292844, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1680000, "timesteps_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"sample_time_ms": 43935.449, "sample_throughput": 91.043, "load_time_ms": 0.903, "load_throughput": 4428809.461, "learn_time_ms": 309070.555, "learn_throughput": 12.942, "update_time_ms": 4.236}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.1340939699521949, "policy_loss": -0.007458468946197661, "vf_loss": 14.138155243089122, "vf_explained_var": 0.2220877533317894, "kl": 0.009472515522133804, "entropy": 0.23832158219189414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1680000, "num_agent_steps_sampled": 1680000, "num_steps_trained": 1680000, "num_agent_steps_trained": 1680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16800, "training_iteration": 420, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-29-00", "timestamp": 1643693340, "time_this_iter_s": 52.80566620826721, "time_total_s": 28004.49826645851, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28004.49826645851, "timesteps_since_restore": 0, "iterations_since_restore": 420, "perf": {"cpu_util_percent": 25.096, "ram_util_percent": 71.06000000000002}}
{"episode_reward_max": -1.3, "episode_reward_min": -32.80000000000001, "episode_reward_mean": -12.412, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.0, -13.399999999999999, -3.3, -22.400000000000016, -5.0, -12.5, -4.3, -13.099999999999998, -20.8, -14.599999999999982, -4.4, -16.9, -17.099999999999998, -7.3, -5.300000000000001, -4.4, -4.300000000000001, -21.6, -6.4, -3.4000000000000004, -3.3, -5.4, -20.5, -26.900000000000006, -3.4, -11.2, -4.4, -10.199999999999998, -10.2, -24.8, -6.899999999999999, -20.900000000000002, -25.19999999999997, -29.500000000000007, -15.399999999999999, -18.5, -8.8, -20.2, -3.3, -4.300000000000001, -15.899999999999995, -3.4, -4.300000000000001, -4.4, -19.9, -8.999999999999996, -11.6, -28.20000000000001, -3.3, -22.400000000000002, -3.4, -23.899999999999995, -6.4, -10.3, -12.199999999999998, -12.4, -4.800000000000001, -30.299999999999997, -10.299999999999994, -5.0, -11.8, -15.699999999999996, -7.3, -5.300000000000001, -4.4, -18.1, -1.3, -13.399999999999999, -18.799999999999997, -9.399999999999999, -6.699999999999999, -18.0, -7.699999999999999, -7.799999999999999, -17.799999999999997, -32.3, -19.6, -9.500000000000002, -11.4, -27.90000000000001, -19.19999999999997, -18.699999999999996, -13.199999999999976, -4.9, -11.9, -3.4, -9.5, -3.3, -18.1, -22.7, -3.4, -15.199999999999998, -7.1999999999999975, -23.299999999999997, -32.80000000000001, -13.799999999999999, -3.2, -15.3, -5.4, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.362217126084737, "mean_inference_ms": 3.97882560376149, "mean_action_processing_ms": 0.10555951405364572, "mean_env_wait_ms": 26.345999997831623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1684000, "timesteps_this_iter": 0, "agent_timesteps_total": 1684000, "timers": {"sample_time_ms": 44173.432, "sample_throughput": 90.552, "load_time_ms": 0.903, "load_throughput": 4430680.822, "learn_time_ms": 209495.457, "learn_throughput": 19.093, "update_time_ms": 4.495}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.16149385926784365, "policy_loss": -0.012275936482824705, "vf_loss": 17.360748164692232, "vf_explained_var": 0.10327166421439057, "kl": 0.008997489120316561, "entropy": 0.24179193824930217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1684000, "num_agent_steps_sampled": 1684000, "num_steps_trained": 1684000, "num_agent_steps_trained": 1684000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16840, "training_iteration": 421, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-29-56", "timestamp": 1643693396, "time_this_iter_s": 56.03252935409546, "time_total_s": 28060.530795812607, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28060.530795812607, "timesteps_since_restore": 0, "iterations_since_restore": 421, "perf": {"cpu_util_percent": 30.850632911392402, "ram_util_percent": 71.0835443037975}}
{"episode_reward_max": -1.3, "episode_reward_min": -75.4, "episode_reward_mean": -12.655000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.899999999999995, -3.4, -4.300000000000001, -4.4, -19.9, -8.999999999999996, -11.6, -28.20000000000001, -3.3, -22.400000000000002, -3.4, -23.899999999999995, -6.4, -10.3, -12.199999999999998, -12.4, -4.800000000000001, -30.299999999999997, -10.299999999999994, -5.0, -11.8, -15.699999999999996, -7.3, -5.300000000000001, -4.4, -18.1, -1.3, -13.399999999999999, -18.799999999999997, -9.399999999999999, -6.699999999999999, -18.0, -7.699999999999999, -7.799999999999999, -17.799999999999997, -32.3, -19.6, -9.500000000000002, -11.4, -27.90000000000001, -19.19999999999997, -18.699999999999996, -13.199999999999976, -4.9, -11.9, -3.4, -9.5, -3.3, -18.1, -22.7, -3.4, -15.199999999999998, -7.1999999999999975, -23.299999999999997, -32.80000000000001, -13.799999999999999, -3.2, -15.3, -5.4, -3.3, -3.3, -24.200000000000003, -24.800000000000004, -24.5, -3.4, -10.3, -6.999999999999998, -22.700000000000006, -6.0, -4.4, -5.3, -5.300000000000001, -4.300000000000001, -14.1, -4.6000000000000005, -6.799999999999999, -3.2, -51.00000000000001, -3.4, -19.0, -5.9, -7.1, -19.000000000000007, -6.4, -22.8, -12.599999999999994, -9.600000000000001, -5.899999999999998, -9.999999999999998, -13.0, -5.4, -12.9, -4.4, -7.300000000000001, -20.9, -7.299999999999999, -4.4, -75.4, -10.9, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.356663606662973, "mean_inference_ms": 3.9783319881964148, "mean_action_processing_ms": 0.10581383720112637, "mean_env_wait_ms": 26.330282319066974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1688000, "timesteps_this_iter": 0, "agent_timesteps_total": 1688000, "timers": {"sample_time_ms": 45958.236, "sample_throughput": 87.036, "load_time_ms": 1.0, "load_throughput": 3999527.033, "learn_time_ms": 209448.977, "learn_throughput": 19.098, "update_time_ms": 4.531}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.42183470862456945, "policy_loss": -0.015539288557364896, "vf_loss": 43.71250531622159, "vf_explained_var": 0.10003017904937908, "kl": 0.013799413414239861, "entropy": 0.22634543045874564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1688000, "num_agent_steps_sampled": 1688000, "num_steps_trained": 1688000, "num_agent_steps_trained": 1688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16880, "training_iteration": 422, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-30-50", "timestamp": 1643693450, "time_this_iter_s": 53.31835174560547, "time_total_s": 28113.849147558212, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28113.849147558212, "timesteps_since_restore": 0, "iterations_since_restore": 422, "perf": {"cpu_util_percent": 28.606666666666666, "ram_util_percent": 71.01066666666665}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.4, "episode_reward_mean": -12.802, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.19999999999997, -18.699999999999996, -13.199999999999976, -4.9, -11.9, -3.4, -9.5, -3.3, -18.1, -22.7, -3.4, -15.199999999999998, -7.1999999999999975, -23.299999999999997, -32.80000000000001, -13.799999999999999, -3.2, -15.3, -5.4, -3.3, -3.3, -24.200000000000003, -24.800000000000004, -24.5, -3.4, -10.3, -6.999999999999998, -22.700000000000006, -6.0, -4.4, -5.3, -5.300000000000001, -4.300000000000001, -14.1, -4.6000000000000005, -6.799999999999999, -3.2, -51.00000000000001, -3.4, -19.0, -5.9, -7.1, -19.000000000000007, -6.4, -22.8, -12.599999999999994, -9.600000000000001, -5.899999999999998, -9.999999999999998, -13.0, -5.4, -12.9, -4.4, -7.300000000000001, -20.9, -7.299999999999999, -4.4, -75.4, -10.9, -3.3, -14.699999999999996, -18.400000000000006, -7.899999999999998, -3.4, -12.1, -12.199999999999998, -15.399999999999997, -8.899999999999999, -7.4, -3.4, -8.799999999999997, -9.4, -54.3, -8.4, -29.799999999999997, -3.3, -9.999999999999998, -25.5, -5.4, -15.899999999999979, -12.3, -8.100000000000001, -12.2, -18.199999999999996, -3.2, -5.300000000000001, -24.4, -3.4, -4.300000000000001, -21.0, -4.300000000000001, -11.799999999999999, -7.2, -24.599999999999998, -7.2, -28.30000000000005, -10.199999999999998, -12.2, -15.899999999999999, -11.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.350963316165408, "mean_inference_ms": 3.9777111904247624, "mean_action_processing_ms": 0.10606015395818495, "mean_env_wait_ms": 26.313721588051184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1692000, "timesteps_this_iter": 0, "agent_timesteps_total": 1692000, "timers": {"sample_time_ms": 46546.285, "sample_throughput": 85.936, "load_time_ms": 1.173, "load_throughput": 3410072.562, "learn_time_ms": 210963.458, "learn_throughput": 18.961, "update_time_ms": 4.328}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.2733829414175313, "policy_loss": -0.010662201255239466, "vf_loss": 28.381199142753438, "vf_explained_var": 0.05917192659070415, "kl": 0.012923691514681113, "entropy": 0.2471462865670522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1692000, "num_agent_steps_sampled": 1692000, "num_steps_trained": 1692000, "num_agent_steps_trained": 1692000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16920, "training_iteration": 423, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-31-41", "timestamp": 1643693501, "time_this_iter_s": 51.27953219413757, "time_total_s": 28165.12867975235, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28165.12867975235, "timesteps_since_restore": 0, "iterations_since_restore": 423, "perf": {"cpu_util_percent": 26.146575342465756, "ram_util_percent": 71.0027397260274}}
{"episode_reward_max": -3.2, "episode_reward_min": -75.4, "episode_reward_mean": -12.690000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.9, -7.1, -19.000000000000007, -6.4, -22.8, -12.599999999999994, -9.600000000000001, -5.899999999999998, -9.999999999999998, -13.0, -5.4, -12.9, -4.4, -7.300000000000001, -20.9, -7.299999999999999, -4.4, -75.4, -10.9, -3.3, -14.699999999999996, -18.400000000000006, -7.899999999999998, -3.4, -12.1, -12.199999999999998, -15.399999999999997, -8.899999999999999, -7.4, -3.4, -8.799999999999997, -9.4, -54.3, -8.4, -29.799999999999997, -3.3, -9.999999999999998, -25.5, -5.4, -15.899999999999979, -12.3, -8.100000000000001, -12.2, -18.199999999999996, -3.2, -5.300000000000001, -24.4, -3.4, -4.300000000000001, -21.0, -4.300000000000001, -11.799999999999999, -7.2, -24.599999999999998, -7.2, -28.30000000000005, -10.199999999999998, -12.2, -15.899999999999999, -11.599999999999998, -27.10000000000001, -7.300000000000001, -4.300000000000001, -4.300000000000001, -7.300000000000001, -12.2, -19.699999999999996, -3.4, -7.699999999999998, -13.599999999999996, -14.7, -15.799999999999999, -8.3, -9.7, -3.3, -12.199999999999996, -14.4, -11.699999999999998, -15.699999999999998, -4.4, -9.599999999999996, -14.399999999999999, -6.799999999999999, -5.0, -63.60000000000004, -15.8, -21.400000000000002, -3.3, -3.6000000000000005, -5.300000000000001, -7.3, -12.799999999999999, -3.4, -15.0, -12.599999999999998, -4.4, -19.099999999999998, -21.4, -3.4, -18.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.344674072850634, "mean_inference_ms": 3.976520003591655, "mean_action_processing_ms": 0.10626670625126099, "mean_env_wait_ms": 26.292641712625432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1696000, "timesteps_this_iter": 0, "agent_timesteps_total": 1696000, "timers": {"sample_time_ms": 47177.164, "sample_throughput": 84.787, "load_time_ms": 1.15, "load_throughput": 3477936.11, "learn_time_ms": 120966.884, "learn_throughput": 33.067, "update_time_ms": 4.497}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.27474050389312366, "policy_loss": -0.013213440382312383, "vf_loss": 28.7659907847002, "vf_explained_var": 0.28600238638539466, "kl": 0.016299059286277204, "entropy": 0.2724652030014543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1696000, "num_agent_steps_sampled": 1696000, "num_steps_trained": 1696000, "num_agent_steps_trained": 1696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 16960, "training_iteration": 424, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-32-29", "timestamp": 1643693549, "time_this_iter_s": 47.66486692428589, "time_total_s": 28212.793546676636, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28212.793546676636, "timesteps_since_restore": 0, "iterations_since_restore": 424, "perf": {"cpu_util_percent": 25.73134328358209, "ram_util_percent": 71.0}}
{"episode_reward_max": -2.3, "episode_reward_min": -63.60000000000004, "episode_reward_mean": -11.312000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -8.100000000000001, -12.2, -18.199999999999996, -3.2, -5.300000000000001, -24.4, -3.4, -4.300000000000001, -21.0, -4.300000000000001, -11.799999999999999, -7.2, -24.599999999999998, -7.2, -28.30000000000005, -10.199999999999998, -12.2, -15.899999999999999, -11.599999999999998, -27.10000000000001, -7.300000000000001, -4.300000000000001, -4.300000000000001, -7.300000000000001, -12.2, -19.699999999999996, -3.4, -7.699999999999998, -13.599999999999996, -14.7, -15.799999999999999, -8.3, -9.7, -3.3, -12.199999999999996, -14.4, -11.699999999999998, -15.699999999999998, -4.4, -9.599999999999996, -14.399999999999999, -6.799999999999999, -5.0, -63.60000000000004, -15.8, -21.400000000000002, -3.3, -3.6000000000000005, -5.300000000000001, -7.3, -12.799999999999999, -3.4, -15.0, -12.599999999999998, -4.4, -19.099999999999998, -21.4, -3.4, -18.9, -2.3, -3.5, -3.4, -12.7, -4.3, -11.900000000000002, -9.8, -19.0, -8.299999999999997, -25.6, -18.7, -3.4, -9.7, -7.3, -6.199999999999999, -18.099999999999998, -16.099999999999994, -3.4, -15.399999999999997, -3.4, -11.2, -9.299999999999997, -7.3, -22.000000000000004, -13.699999999999994, -4.300000000000001, -9.999999999999998, -15.5, -3.3, -7.099999999999999, -12.3, -4.300000000000001, -24.6, -4.3, -5.799999999999999, -15.299999999999999, -3.3, -6.300000000000001, -3.4, -15.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3384049086528735, "mean_inference_ms": 3.9752657842104484, "mean_action_processing_ms": 0.1064692431713203, "mean_env_wait_ms": 26.27118273565634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1700000, "timesteps_this_iter": 0, "agent_timesteps_total": 1700000, "timers": {"sample_time_ms": 49025.054, "sample_throughput": 81.591, "load_time_ms": 1.145, "load_throughput": 3492924.717, "learn_time_ms": 25015.592, "learn_throughput": 159.9, "update_time_ms": 4.751}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.07601416793411538, "policy_loss": -0.012635964644892562, "vf_loss": 8.843267477680278, "vf_explained_var": 0.11488762901675316, "kl": 0.012053991232883735, "entropy": 0.2666547902529278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1700000, "num_agent_steps_sampled": 1700000, "num_steps_trained": 1700000, "num_agent_steps_trained": 1700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17000, "training_iteration": 425, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-33-22", "timestamp": 1643693602, "time_this_iter_s": 53.33645582199097, "time_total_s": 28266.130002498627, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28266.130002498627, "timesteps_since_restore": 0, "iterations_since_restore": 425, "perf": {"cpu_util_percent": 26.85, "ram_util_percent": 71.0078947368421}}
{"episode_reward_max": -2.3, "episode_reward_min": -63.60000000000004, "episode_reward_mean": -11.708, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.599999999999996, -14.399999999999999, -6.799999999999999, -5.0, -63.60000000000004, -15.8, -21.400000000000002, -3.3, -3.6000000000000005, -5.300000000000001, -7.3, -12.799999999999999, -3.4, -15.0, -12.599999999999998, -4.4, -19.099999999999998, -21.4, -3.4, -18.9, -2.3, -3.5, -3.4, -12.7, -4.3, -11.900000000000002, -9.8, -19.0, -8.299999999999997, -25.6, -18.7, -3.4, -9.7, -7.3, -6.199999999999999, -18.099999999999998, -16.099999999999994, -3.4, -15.399999999999997, -3.4, -11.2, -9.299999999999997, -7.3, -22.000000000000004, -13.699999999999994, -4.300000000000001, -9.999999999999998, -15.5, -3.3, -7.099999999999999, -12.3, -4.300000000000001, -24.6, -4.3, -5.799999999999999, -15.299999999999999, -3.3, -6.300000000000001, -3.4, -15.5, -22.6, -5.4, -3.3, -5.4, -4.300000000000001, -14.6, -22.1, -15.399999999999997, -5.3, -13.799999999999999, -2.3000000000000003, -5.3, -11.099999999999996, -4.3, -4.3, -12.299999999999999, -18.199999999999996, -18.900000000000006, -15.199999999999998, -13.0, -18.999999999999982, -6.4, -43.3, -9.299999999999997, -11.6, -12.699999999999998, -7.700000000000001, -19.099999999999998, -11.199999999999998, -48.2, -5.3, -13.899999999999999, -12.099999999999998, -9.499999999999998, -16.99999999999997, -14.7, -3.3, -6.300000000000001, -8.3, -6.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.332559669102336, "mean_inference_ms": 3.974262124827331, "mean_action_processing_ms": 0.10668781263233822, "mean_env_wait_ms": 26.251648222574875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1704000, "timesteps_this_iter": 0, "agent_timesteps_total": 1704000, "timers": {"sample_time_ms": 51079.888, "sample_throughput": 78.309, "load_time_ms": 1.241, "load_throughput": 3222297.853, "learn_time_ms": 25061.214, "learn_throughput": 159.609, "update_time_ms": 4.706}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.018040672363713383, "cur_lr": 0.00010000000000000003, "total_loss": 0.19455767670916693, "policy_loss": -0.02584175783715221, "vf_loss": 21.999466990014557, "vf_explained_var": 0.10438627158441852, "kl": 0.0224364769098634, "entropy": 0.26851983412459335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1704000, "num_agent_steps_sampled": 1704000, "num_steps_trained": 1704000, "num_agent_steps_trained": 1704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17040, "training_iteration": 426, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-34-16", "timestamp": 1643693656, "time_this_iter_s": 53.54601168632507, "time_total_s": 28319.67601418495, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28319.67601418495, "timesteps_since_restore": 0, "iterations_since_restore": 426, "perf": {"cpu_util_percent": 28.967105263157894, "ram_util_percent": 71.02894736842104}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -48.2, "episode_reward_mean": -11.597000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -9.299999999999997, -7.3, -22.000000000000004, -13.699999999999994, -4.300000000000001, -9.999999999999998, -15.5, -3.3, -7.099999999999999, -12.3, -4.300000000000001, -24.6, -4.3, -5.799999999999999, -15.299999999999999, -3.3, -6.300000000000001, -3.4, -15.5, -22.6, -5.4, -3.3, -5.4, -4.300000000000001, -14.6, -22.1, -15.399999999999997, -5.3, -13.799999999999999, -2.3000000000000003, -5.3, -11.099999999999996, -4.3, -4.3, -12.299999999999999, -18.199999999999996, -18.900000000000006, -15.199999999999998, -13.0, -18.999999999999982, -6.4, -43.3, -9.299999999999997, -11.6, -12.699999999999998, -7.700000000000001, -19.099999999999998, -11.199999999999998, -48.2, -5.3, -13.899999999999999, -12.099999999999998, -9.499999999999998, -16.99999999999997, -14.7, -3.3, -6.300000000000001, -8.3, -6.4, -5.300000000000001, -19.299999999999997, -15.099999999999998, -4.300000000000001, -17.2, -12.8, -16.799999999999997, -12.7, -9.6, -10.7, -5.3, -10.3, -17.1, -26.000000000000007, -9.600000000000001, -5.1000000000000005, -12.299999999999997, -9.8, -9.4, -17.0, -10.2, -10.299999999999999, -41.3, -7.3, -4.300000000000001, -13.899999999999999, -4.4, -4.2, -7.2, -18.7, -13.199999999999998, -4.4, -11.2, -5.4, -5.300000000000001, -5.499999999999999, -16.4, -12.4, -4.3, -12.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.326900575901675, "mean_inference_ms": 3.973490794259518, "mean_action_processing_ms": 0.10692192536318756, "mean_env_wait_ms": 26.233958533145643, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1708000, "timesteps_this_iter": 0, "agent_timesteps_total": 1708000, "timers": {"sample_time_ms": 51598.827, "sample_throughput": 77.521, "load_time_ms": 1.339, "load_throughput": 2986757.815, "learn_time_ms": 26427.142, "learn_throughput": 151.36, "update_time_ms": 4.671}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.10792352173938065, "policy_loss": -0.00791578447992002, "vf_loss": 11.560026200356022, "vf_explained_var": 0.27848876073796264, "kl": 0.008833561695852565, "entropy": 0.24137052309609228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1708000, "num_agent_steps_sampled": 1708000, "num_steps_trained": 1708000, "num_agent_steps_trained": 1708000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17080, "training_iteration": 427, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-35-08", "timestamp": 1643693708, "time_this_iter_s": 51.785489082336426, "time_total_s": 28371.46150326729, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28371.46150326729, "timesteps_since_restore": 0, "iterations_since_restore": 427, "perf": {"cpu_util_percent": 23.85753424657534, "ram_util_percent": 71.03698630136986}}
{"episode_reward_max": -3.3, "episode_reward_min": -85.8, "episode_reward_mean": -13.129000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.999999999999982, -6.4, -43.3, -9.299999999999997, -11.6, -12.699999999999998, -7.700000000000001, -19.099999999999998, -11.199999999999998, -48.2, -5.3, -13.899999999999999, -12.099999999999998, -9.499999999999998, -16.99999999999997, -14.7, -3.3, -6.300000000000001, -8.3, -6.4, -5.300000000000001, -19.299999999999997, -15.099999999999998, -4.300000000000001, -17.2, -12.8, -16.799999999999997, -12.7, -9.6, -10.7, -5.3, -10.3, -17.1, -26.000000000000007, -9.600000000000001, -5.1000000000000005, -12.299999999999997, -9.8, -9.4, -17.0, -10.2, -10.299999999999999, -41.3, -7.3, -4.300000000000001, -13.899999999999999, -4.4, -4.2, -7.2, -18.7, -13.199999999999998, -4.4, -11.2, -5.4, -5.300000000000001, -5.499999999999999, -16.4, -12.4, -4.3, -12.9, -25.099999999999998, -25.5, -11.999999999999998, -9.299999999999997, -4.699999999999999, -14.8, -19.800000000000004, -14.5, -4.4, -6.999999999999997, -6.3, -4.4, -22.000000000000004, -5.4, -25.800000000000004, -25.6, -12.3, -13.999999999999995, -85.8, -5.300000000000001, -18.800000000000004, -7.899999999999998, -4.300000000000001, -15.2, -5.2, -18.4, -44.10000000000002, -9.2, -4.4, -13.3, -11.7, -10.399999999999999, -8.899999999999999, -8.4, -16.2, -5.1, -3.4, -9.3, -4.9, -6.000000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.320784528497268, "mean_inference_ms": 3.9723618841641577, "mean_action_processing_ms": 0.10713000005163831, "mean_env_wait_ms": 26.21368882881827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1712000, "timesteps_this_iter": 0, "agent_timesteps_total": 1712000, "timers": {"sample_time_ms": 52326.458, "sample_throughput": 76.443, "load_time_ms": 1.34, "load_throughput": 2984738.659, "learn_time_ms": 26304.343, "learn_throughput": 152.066, "update_time_ms": 4.523}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.479908197909914, "policy_loss": -0.016379875639173133, "vf_loss": 49.593387691308095, "vf_explained_var": 0.09814329595975979, "kl": 0.01308914704090042, "entropy": 0.24572179665168126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1712000, "num_agent_steps_sampled": 1712000, "num_steps_trained": 1712000, "num_agent_steps_trained": 1712000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17120, "training_iteration": 428, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-35-56", "timestamp": 1643693756, "time_this_iter_s": 48.848877906799316, "time_total_s": 28420.310381174088, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28420.310381174088, "timesteps_since_restore": 0, "iterations_since_restore": 428, "perf": {"cpu_util_percent": 26.60724637681159, "ram_util_percent": 71.0449275362319}}
{"episode_reward_max": -3.3, "episode_reward_min": -85.8, "episode_reward_mean": -12.541999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -10.299999999999999, -41.3, -7.3, -4.300000000000001, -13.899999999999999, -4.4, -4.2, -7.2, -18.7, -13.199999999999998, -4.4, -11.2, -5.4, -5.300000000000001, -5.499999999999999, -16.4, -12.4, -4.3, -12.9, -25.099999999999998, -25.5, -11.999999999999998, -9.299999999999997, -4.699999999999999, -14.8, -19.800000000000004, -14.5, -4.4, -6.999999999999997, -6.3, -4.4, -22.000000000000004, -5.4, -25.800000000000004, -25.6, -12.3, -13.999999999999995, -85.8, -5.300000000000001, -18.800000000000004, -7.899999999999998, -4.300000000000001, -15.2, -5.2, -18.4, -44.10000000000002, -9.2, -4.4, -13.3, -11.7, -10.399999999999999, -8.899999999999999, -8.4, -16.2, -5.1, -3.4, -9.3, -4.9, -6.000000000000001, -7.299999999999999, -4.3, -4.4, -25.999999999999975, -8.3, -17.7, -10.2, -7.999999999999998, -14.2, -22.5, -4.4, -17.6, -6.999999999999998, -15.1, -9.099999999999998, -15.399999999999986, -3.4, -16.3, -13.3, -20.4, -9.2, -5.4, -12.899999999999993, -11.7, -9.2, -12.099999999999998, -17.500000000000007, -9.399999999999999, -6.1, -13.399999999999997, -21.9, -16.9, -16.4, -5.3, -11.5, -4.3, -11.3, -13.499999999999998, -3.3, -16.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.314723413770082, "mean_inference_ms": 3.9713987225971437, "mean_action_processing_ms": 0.10735881108309002, "mean_env_wait_ms": 26.19433860221193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1716000, "timesteps_this_iter": 0, "agent_timesteps_total": 1716000, "timers": {"sample_time_ms": 52315.574, "sample_throughput": 76.459, "load_time_ms": 1.339, "load_throughput": 2988247.364, "learn_time_ms": 26259.113, "learn_throughput": 152.328, "update_time_ms": 4.568}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.07114033420640294, "policy_loss": -0.014196936187825056, "vf_loss": 8.499760946278931, "vf_explained_var": 0.16801235720675478, "kl": 0.012551775934852856, "entropy": 0.2251206441111462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1716000, "num_agent_steps_sampled": 1716000, "num_steps_trained": 1716000, "num_agent_steps_trained": 1716000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17160, "training_iteration": 429, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-36-50", "timestamp": 1643693810, "time_this_iter_s": 53.46037006378174, "time_total_s": 28473.77075123787, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28473.77075123787, "timesteps_since_restore": 0, "iterations_since_restore": 429, "perf": {"cpu_util_percent": 29.44342105263157, "ram_util_percent": 71.0592105263158}}
{"episode_reward_max": -3.2, "episode_reward_min": -44.10000000000002, "episode_reward_mean": -11.347000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.800000000000004, -7.899999999999998, -4.300000000000001, -15.2, -5.2, -18.4, -44.10000000000002, -9.2, -4.4, -13.3, -11.7, -10.399999999999999, -8.899999999999999, -8.4, -16.2, -5.1, -3.4, -9.3, -4.9, -6.000000000000001, -7.299999999999999, -4.3, -4.4, -25.999999999999975, -8.3, -17.7, -10.2, -7.999999999999998, -14.2, -22.5, -4.4, -17.6, -6.999999999999998, -15.1, -9.099999999999998, -15.399999999999986, -3.4, -16.3, -13.3, -20.4, -9.2, -5.4, -12.899999999999993, -11.7, -9.2, -12.099999999999998, -17.500000000000007, -9.399999999999999, -6.1, -13.399999999999997, -21.9, -16.9, -16.4, -5.3, -11.5, -4.3, -11.3, -13.499999999999998, -3.3, -16.099999999999998, -11.999999999999998, -5.4, -14.399999999999999, -3.7, -3.4, -4.300000000000001, -21.800000000000004, -3.2, -12.899999999999999, -5.800000000000001, -4.3, -17.9, -10.399999999999999, -5.4, -19.5, -10.1, -15.299999999999995, -7.2, -5.300000000000001, -10.2, -3.3, -14.299999999999999, -11.2, -6.000000000000001, -18.5, -21.2, -3.3, -17.5, -5.4, -4.2, -26.30000000000004, -10.3, -25.4, -5.4, -7.3, -20.699999999999996, -7.4, -6.3, -14.3, -16.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3087783592582936, "mean_inference_ms": 3.970615065956448, "mean_action_processing_ms": 0.10759667109237732, "mean_env_wait_ms": 26.17631798534743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1720000, "timesteps_this_iter": 0, "agent_timesteps_total": 1720000, "timers": {"sample_time_ms": 52271.764, "sample_throughput": 76.523, "load_time_ms": 1.322, "load_throughput": 3024992.968, "learn_time_ms": 26245.26, "learn_throughput": 152.408, "update_time_ms": 4.676}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.09016136742367219, "policy_loss": -0.003812234078644104, "vf_loss": 9.371427711620125, "vf_explained_var": 0.3389699275775622, "kl": 0.009583099102627723, "entropy": 0.17173105874048766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1720000, "num_agent_steps_sampled": 1720000, "num_steps_trained": 1720000, "num_agent_steps_trained": 1720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17200, "training_iteration": 430, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-37-43", "timestamp": 1643693863, "time_this_iter_s": 52.684407234191895, "time_total_s": 28526.45515847206, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28526.45515847206, "timesteps_since_restore": 0, "iterations_since_restore": 430, "perf": {"cpu_util_percent": 30.47972972972973, "ram_util_percent": 71.03378378378379}}
{"episode_reward_max": -3.2, "episode_reward_min": -29.800000000000004, "episode_reward_mean": -11.195, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -5.4, -12.899999999999993, -11.7, -9.2, -12.099999999999998, -17.500000000000007, -9.399999999999999, -6.1, -13.399999999999997, -21.9, -16.9, -16.4, -5.3, -11.5, -4.3, -11.3, -13.499999999999998, -3.3, -16.099999999999998, -11.999999999999998, -5.4, -14.399999999999999, -3.7, -3.4, -4.300000000000001, -21.800000000000004, -3.2, -12.899999999999999, -5.800000000000001, -4.3, -17.9, -10.399999999999999, -5.4, -19.5, -10.1, -15.299999999999995, -7.2, -5.300000000000001, -10.2, -3.3, -14.299999999999999, -11.2, -6.000000000000001, -18.5, -21.2, -3.3, -17.5, -5.4, -4.2, -26.30000000000004, -10.3, -25.4, -5.4, -7.3, -20.699999999999996, -7.4, -6.3, -14.3, -16.5, -3.3, -15.4, -11.5, -11.2, -8.2, -9.2, -6.300000000000001, -17.3, -18.199999999999996, -4.3, -14.2, -3.4, -5.300000000000001, -18.4, -29.800000000000004, -4.4, -16.6, -4.2, -16.9, -14.7, -4.4, -18.599999999999994, -15.6, -4.2, -4.2, -7.199999999999999, -20.400000000000006, -7.299999999999999, -14.799999999999999, -9.899999999999999, -13.3, -27.99999999999998, -5.0, -10.500000000000002, -3.3, -6.300000000000001, -13.5, -8.499999999999998, -7.4, -19.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.303089211675374, "mean_inference_ms": 3.9700202086295735, "mean_action_processing_ms": 0.10784563197947612, "mean_env_wait_ms": 26.160074346070232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1724000, "timesteps_this_iter": 0, "agent_timesteps_total": 1724000, "timers": {"sample_time_ms": 52086.431, "sample_throughput": 76.795, "load_time_ms": 1.322, "load_throughput": 3025047.511, "learn_time_ms": 26189.553, "learn_throughput": 152.733, "update_time_ms": 4.756}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.08621087596120854, "policy_loss": -0.01120396120679034, "vf_loss": 9.720132284843794, "vf_explained_var": 0.2018173332496356, "kl": 0.007890264543418176, "entropy": 0.20527137862418288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1724000, "num_agent_steps_sampled": 1724000, "num_steps_trained": 1724000, "num_agent_steps_trained": 1724000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17240, "training_iteration": 431, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-38-37", "timestamp": 1643693917, "time_this_iter_s": 53.78013324737549, "time_total_s": 28580.235291719437, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28580.235291719437, "timesteps_since_restore": 0, "iterations_since_restore": 431, "perf": {"cpu_util_percent": 23.022368421052633, "ram_util_percent": 71.05263157894737}}
{"episode_reward_max": -3.3, "episode_reward_min": -89.4, "episode_reward_mean": -12.512, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -14.299999999999999, -11.2, -6.000000000000001, -18.5, -21.2, -3.3, -17.5, -5.4, -4.2, -26.30000000000004, -10.3, -25.4, -5.4, -7.3, -20.699999999999996, -7.4, -6.3, -14.3, -16.5, -3.3, -15.4, -11.5, -11.2, -8.2, -9.2, -6.300000000000001, -17.3, -18.199999999999996, -4.3, -14.2, -3.4, -5.300000000000001, -18.4, -29.800000000000004, -4.4, -16.6, -4.2, -16.9, -14.7, -4.4, -18.599999999999994, -15.6, -4.2, -4.2, -7.199999999999999, -20.400000000000006, -7.299999999999999, -14.799999999999999, -9.899999999999999, -13.3, -27.99999999999998, -5.0, -10.500000000000002, -3.3, -6.300000000000001, -13.5, -8.499999999999998, -7.4, -19.599999999999998, -4.1000000000000005, -13.399999999999988, -19.0, -15.599999999999998, -5.2, -12.3, -12.099999999999998, -10.499999999999996, -3.3, -12.3, -5.300000000000001, -4.300000000000001, -7.4, -13.799999999999999, -12.599999999999998, -11.3, -8.8, -4.2, -14.1, -13.899999999999999, -24.500000000000004, -67.09999999999997, -10.9, -11.5, -5.8999999999999995, -89.4, -5.4, -13.299999999999997, -12.2, -9.5, -7.099999999999999, -10.899999999999999, -18.7, -10.5, -8.8, -11.999999999999998, -4.4, -10.9, -11.799999999999999, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.297392437798476, "mean_inference_ms": 3.9693519230994365, "mean_action_processing_ms": 0.10807497109174273, "mean_env_wait_ms": 26.143358395250242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1728000, "timesteps_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"sample_time_ms": 52003.468, "sample_throughput": 76.918, "load_time_ms": 1.323, "load_throughput": 3024229.577, "learn_time_ms": 26272.258, "learn_throughput": 152.252, "update_time_ms": 4.711}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.5276669232357514, "policy_loss": -0.014983139069931161, "vf_loss": 54.211417352191866, "vf_explained_var": 0.1509168243536385, "kl": 0.01980345848885087, "entropy": 0.24281036358687186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1728000, "num_agent_steps_sampled": 1728000, "num_steps_trained": 1728000, "num_agent_steps_trained": 1728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17280, "training_iteration": 432, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-39-30", "timestamp": 1643693970, "time_this_iter_s": 53.880926847457886, "time_total_s": 28634.116218566895, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28634.116218566895, "timesteps_since_restore": 0, "iterations_since_restore": 432, "perf": {"cpu_util_percent": 28.441558441558442, "ram_util_percent": 71.02467532467534}}
{"episode_reward_max": -1.2, "episode_reward_min": -89.4, "episode_reward_mean": -13.435999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -18.599999999999994, -15.6, -4.2, -4.2, -7.199999999999999, -20.400000000000006, -7.299999999999999, -14.799999999999999, -9.899999999999999, -13.3, -27.99999999999998, -5.0, -10.500000000000002, -3.3, -6.300000000000001, -13.5, -8.499999999999998, -7.4, -19.599999999999998, -4.1000000000000005, -13.399999999999988, -19.0, -15.599999999999998, -5.2, -12.3, -12.099999999999998, -10.499999999999996, -3.3, -12.3, -5.300000000000001, -4.300000000000001, -7.4, -13.799999999999999, -12.599999999999998, -11.3, -8.8, -4.2, -14.1, -13.899999999999999, -24.500000000000004, -67.09999999999997, -10.9, -11.5, -5.8999999999999995, -89.4, -5.4, -13.299999999999997, -12.2, -9.5, -7.099999999999999, -10.899999999999999, -18.7, -10.5, -8.8, -11.999999999999998, -4.4, -10.9, -11.799999999999999, -3.3, -15.199999999999996, -11.999999999999998, -8.3, -18.199999999999996, -19.299999999999997, -11.2, -17.2, -16.4, -23.00000000000001, -6.0, -10.3, -22.4, -11.3, -7.300000000000001, -1.2, -7.2, -12.4, -10.2, -15.3, -3.1, -11.2, -12.699999999999998, -7.1, -14.899999999999999, -24.0, -8.4, -18.4, -11.399999999999999, -4.2, -15.599999999999998, -27.89999999999996, -5.2, -80.3, -12.3, -11.3, -12.1, -16.299999999999997, -10.4, -11.299999999999999, -7.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.291809453109718, "mean_inference_ms": 3.9686504910175073, "mean_action_processing_ms": 0.10830335704834805, "mean_env_wait_ms": 26.126587093769377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1732000, "timesteps_this_iter": 0, "agent_timesteps_total": 1732000, "timers": {"sample_time_ms": 52092.35, "sample_throughput": 76.787, "load_time_ms": 1.271, "load_throughput": 3147222.931, "learn_time_ms": 26476.568, "learn_throughput": 151.077, "update_time_ms": 4.749}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.2473142479135785, "policy_loss": -0.011703595765415699, "vf_loss": 25.870831182182474, "vf_explained_var": 0.12218569613272144, "kl": 0.011438563071866083, "entropy": 0.25263335908292445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1732000, "num_agent_steps_sampled": 1732000, "num_steps_trained": 1732000, "num_agent_steps_trained": 1732000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17320, "training_iteration": 433, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-40-24", "timestamp": 1643694024, "time_this_iter_s": 53.40004897117615, "time_total_s": 28687.51626753807, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28687.51626753807, "timesteps_since_restore": 0, "iterations_since_restore": 433, "perf": {"cpu_util_percent": 30.093333333333334, "ram_util_percent": 71.012}}
{"episode_reward_max": -1.2, "episode_reward_min": -89.4, "episode_reward_mean": -13.993999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.500000000000004, -67.09999999999997, -10.9, -11.5, -5.8999999999999995, -89.4, -5.4, -13.299999999999997, -12.2, -9.5, -7.099999999999999, -10.899999999999999, -18.7, -10.5, -8.8, -11.999999999999998, -4.4, -10.9, -11.799999999999999, -3.3, -15.199999999999996, -11.999999999999998, -8.3, -18.199999999999996, -19.299999999999997, -11.2, -17.2, -16.4, -23.00000000000001, -6.0, -10.3, -22.4, -11.3, -7.300000000000001, -1.2, -7.2, -12.4, -10.2, -15.3, -3.1, -11.2, -12.699999999999998, -7.1, -14.899999999999999, -24.0, -8.4, -18.4, -11.399999999999999, -4.2, -15.599999999999998, -27.89999999999996, -5.2, -80.3, -12.3, -11.3, -12.1, -16.299999999999997, -10.4, -11.299999999999999, -7.5, -5.8999999999999995, -13.399999999999999, -7.2, -9.3, -13.299999999999999, -9.6, -8.899999999999999, -9.3, -16.9, -10.3, -8.4, -32.199999999999996, -4.6000000000000005, -13.599999999999998, -21.60000000000002, -3.8000000000000007, -6.2, -7.300000000000001, -4.300000000000001, -13.3, -15.099999999999998, -14.49999999999999, -3.2, -9.4, -10.3, -29.3, -9.2, -6.4, -22.40000000000001, -15.5, -8.2, -12.4, -21.199999999999996, -12.5, -14.4, -10.699999999999998, -11.2, -14.699999999999998, -9.3, -11.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.286293741062219, "mean_inference_ms": 3.9679368263698915, "mean_action_processing_ms": 0.1085307314804584, "mean_env_wait_ms": 26.109826694114172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1736000, "timesteps_this_iter": 0, "agent_timesteps_total": 1736000, "timers": {"sample_time_ms": 52800.514, "sample_throughput": 75.757, "load_time_ms": 1.293, "load_throughput": 3093144.543, "learn_time_ms": 26569.301, "learn_throughput": 150.55, "update_time_ms": 4.753}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.08894014206028954, "policy_loss": -0.01121640537054308, "vf_loss": 9.991787928663275, "vf_explained_var": 0.15187811659228417, "kl": 0.008819669194839067, "entropy": 0.24342919757930181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1736000, "num_agent_steps_sampled": 1736000, "num_steps_trained": 1736000, "num_agent_steps_trained": 1736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17360, "training_iteration": 434, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-41-18", "timestamp": 1643694078, "time_this_iter_s": 53.61453318595886, "time_total_s": 28741.13080072403, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28741.13080072403, "timesteps_since_restore": 0, "iterations_since_restore": 434, "perf": {"cpu_util_percent": 27.07894736842105, "ram_util_percent": 70.97236842105262}}
{"episode_reward_max": -3.2, "episode_reward_min": -80.3, "episode_reward_mean": -12.767000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -12.699999999999998, -7.1, -14.899999999999999, -24.0, -8.4, -18.4, -11.399999999999999, -4.2, -15.599999999999998, -27.89999999999996, -5.2, -80.3, -12.3, -11.3, -12.1, -16.299999999999997, -10.4, -11.299999999999999, -7.5, -5.8999999999999995, -13.399999999999999, -7.2, -9.3, -13.299999999999999, -9.6, -8.899999999999999, -9.3, -16.9, -10.3, -8.4, -32.199999999999996, -4.6000000000000005, -13.599999999999998, -21.60000000000002, -3.8000000000000007, -6.2, -7.300000000000001, -4.300000000000001, -13.3, -15.099999999999998, -14.49999999999999, -3.2, -9.4, -10.3, -29.3, -9.2, -6.4, -22.40000000000001, -15.5, -8.2, -12.4, -21.199999999999996, -12.5, -14.4, -10.699999999999998, -11.2, -14.699999999999998, -9.3, -11.999999999999998, -11.6, -8.3, -10.3, -8.2, -8.4, -9.3, -11.1, -15.399999999999999, -8.2, -16.1, -5.5, -18.19999999999997, -5.3, -7.4, -19.4, -13.499999999999998, -14.0, -12.600000000000001, -13.299999999999999, -11.199999999999998, -16.5, -6.4, -23.800000000000004, -7.4, -12.8, -17.3, -7.699999999999999, -11.499999999999998, -15.199999999999998, -21.2, -8.999999999999996, -14.2, -11.2, -8.499999999999998, -10.4, -5.2, -14.700000000000001, -11.3, -8.3, -12.999999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.280819779328707, "mean_inference_ms": 3.967276346403114, "mean_action_processing_ms": 0.10875982262346051, "mean_env_wait_ms": 26.09343469808651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1740000, "timesteps_this_iter": 0, "agent_timesteps_total": 1740000, "timers": {"sample_time_ms": 52928.016, "sample_throughput": 75.574, "load_time_ms": 1.292, "load_throughput": 3095084.677, "learn_time_ms": 26561.046, "learn_throughput": 150.596, "update_time_ms": 4.745}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.08455090514053741, "policy_loss": -0.007906100596551613, "vf_loss": 9.212919358284243, "vf_explained_var": 0.3282854297468739, "kl": 0.012113902678212348, "entropy": 0.2504759233805441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1740000, "num_agent_steps_sampled": 1740000, "num_steps_trained": 1740000, "num_agent_steps_trained": 1740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17400, "training_iteration": 435, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-42-11", "timestamp": 1643694131, "time_this_iter_s": 53.58437991142273, "time_total_s": 28794.715180635452, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28794.715180635452, "timesteps_since_restore": 0, "iterations_since_restore": 435, "perf": {"cpu_util_percent": 29.890789473684208, "ram_util_percent": 71.00394736842105}}
{"episode_reward_max": -2.3, "episode_reward_min": -29.3, "episode_reward_mean": -11.835, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.099999999999998, -14.49999999999999, -3.2, -9.4, -10.3, -29.3, -9.2, -6.4, -22.40000000000001, -15.5, -8.2, -12.4, -21.199999999999996, -12.5, -14.4, -10.699999999999998, -11.2, -14.699999999999998, -9.3, -11.999999999999998, -11.6, -8.3, -10.3, -8.2, -8.4, -9.3, -11.1, -15.399999999999999, -8.2, -16.1, -5.5, -18.19999999999997, -5.3, -7.4, -19.4, -13.499999999999998, -14.0, -12.600000000000001, -13.299999999999999, -11.199999999999998, -16.5, -6.4, -23.800000000000004, -7.4, -12.8, -17.3, -7.699999999999999, -11.499999999999998, -15.199999999999998, -21.2, -8.999999999999996, -14.2, -11.2, -8.499999999999998, -10.4, -5.2, -14.700000000000001, -11.3, -8.3, -12.999999999999998, -4.3, -8.9, -23.0, -12.299999999999999, -6.2, -17.799999999999997, -11.3, -2.3, -8.1, -12.3, -17.0, -6.9, -18.3, -6.1, -6.399999999999999, -12.699999999999998, -18.299999999999997, -3.5, -9.2, -27.4, -6.999999999999998, -6.8999999999999995, -24.6, -5.000000000000001, -4.4, -9.3, -8.2, -6.300000000000001, -15.2, -16.2, -8.000000000000002, -9.2, -8.2, -26.699999999999996, -12.599999999999985, -17.599999999999994, -12.399999999999999, -5.499999999999999, -6.3, -6.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.275336899081654, "mean_inference_ms": 3.9665935932327274, "mean_action_processing_ms": 0.10898701397284363, "mean_env_wait_ms": 26.076860335279534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1744000, "timesteps_this_iter": 0, "agent_timesteps_total": 1744000, "timers": {"sample_time_ms": 52859.553, "sample_throughput": 75.672, "load_time_ms": 1.313, "load_throughput": 3045751.216, "learn_time_ms": 26532.496, "learn_throughput": 150.759, "update_time_ms": 4.83}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.11224859385420718, "policy_loss": -0.007795124761359666, "vf_loss": 11.97381712672531, "vf_explained_var": 0.1326991650366014, "kl": 0.011291150698787835, "entropy": 0.28234513426820435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1744000, "num_agent_steps_sampled": 1744000, "num_steps_trained": 1744000, "num_agent_steps_trained": 1744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17440, "training_iteration": 436, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-43-04", "timestamp": 1643694184, "time_this_iter_s": 52.657954931259155, "time_total_s": 28847.37313556671, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28847.37313556671, "timesteps_since_restore": 0, "iterations_since_restore": 436, "perf": {"cpu_util_percent": 25.392, "ram_util_percent": 71.004}}
{"episode_reward_max": -2.3, "episode_reward_min": -44.3, "episode_reward_mean": -11.607000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.5, -6.4, -23.800000000000004, -7.4, -12.8, -17.3, -7.699999999999999, -11.499999999999998, -15.199999999999998, -21.2, -8.999999999999996, -14.2, -11.2, -8.499999999999998, -10.4, -5.2, -14.700000000000001, -11.3, -8.3, -12.999999999999998, -4.3, -8.9, -23.0, -12.299999999999999, -6.2, -17.799999999999997, -11.3, -2.3, -8.1, -12.3, -17.0, -6.9, -18.3, -6.1, -6.399999999999999, -12.699999999999998, -18.299999999999997, -3.5, -9.2, -27.4, -6.999999999999998, -6.8999999999999995, -24.6, -5.000000000000001, -4.4, -9.3, -8.2, -6.300000000000001, -15.2, -16.2, -8.000000000000002, -9.2, -8.2, -26.699999999999996, -12.599999999999985, -17.599999999999994, -12.399999999999999, -5.499999999999999, -6.3, -6.799999999999999, -6.5, -4.300000000000001, -13.4, -5.300000000000001, -9.799999999999999, -19.3, -14.999999999999998, -5.2, -13.3, -7.300000000000001, -10.4, -5.9, -14.49999999999999, -6.4, -44.3, -13.799999999999999, -17.19999999999999, -9.5, -5.4, -26.4, -9.8, -4.6000000000000005, -12.2, -5.799999999999999, -21.4, -4.3, -7.4, -14.799999999999997, -25.3, -4.700000000000001, -19.599999999999994, -6.3, -14.6, -6.3, -12.2, -5.2, -9.2, -8.7, -10.6, -10.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.269726170653419, "mean_inference_ms": 3.9659504648109407, "mean_action_processing_ms": 0.10921379812613705, "mean_env_wait_ms": 26.060448386072895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1748000, "timesteps_this_iter": 0, "agent_timesteps_total": 1748000, "timers": {"sample_time_ms": 52874.012, "sample_throughput": 75.652, "load_time_ms": 1.32, "load_throughput": 3031442.613, "learn_time_ms": 26662.903, "learn_throughput": 150.021, "update_time_ms": 5.017}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.10774575831388594, "policy_loss": -0.01633483282020015, "vf_loss": 12.37671549192039, "vf_explained_var": 0.3068371618947675, "kl": 0.011582718638626872, "entropy": 0.2543186876081651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1748000, "num_agent_steps_sampled": 1748000, "num_steps_trained": 1748000, "num_agent_steps_trained": 1748000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17480, "training_iteration": 437, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-43-58", "timestamp": 1643694238, "time_this_iter_s": 53.52712392807007, "time_total_s": 28900.90025949478, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28900.90025949478, "timesteps_since_restore": 0, "iterations_since_restore": 437, "perf": {"cpu_util_percent": 28.800000000000008, "ram_util_percent": 71.03815789473684}}
{"episode_reward_max": -3.3, "episode_reward_min": -44.3, "episode_reward_mean": -11.405, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999998, -6.8999999999999995, -24.6, -5.000000000000001, -4.4, -9.3, -8.2, -6.300000000000001, -15.2, -16.2, -8.000000000000002, -9.2, -8.2, -26.699999999999996, -12.599999999999985, -17.599999999999994, -12.399999999999999, -5.499999999999999, -6.3, -6.799999999999999, -6.5, -4.300000000000001, -13.4, -5.300000000000001, -9.799999999999999, -19.3, -14.999999999999998, -5.2, -13.3, -7.300000000000001, -10.4, -5.9, -14.49999999999999, -6.4, -44.3, -13.799999999999999, -17.19999999999999, -9.5, -5.4, -26.4, -9.8, -4.6000000000000005, -12.2, -5.799999999999999, -21.4, -4.3, -7.4, -14.799999999999997, -25.3, -4.700000000000001, -19.599999999999994, -6.3, -14.6, -6.3, -12.2, -5.2, -9.2, -8.7, -10.6, -10.2, -7.300000000000001, -6.4, -14.999999999999993, -13.599999999999998, -10.3, -19.0, -6.3, -19.6, -15.899999999999999, -12.199999999999998, -11.4, -18.3, -4.3, -8.4, -7.3, -9.4, -11.4, -12.2, -12.199999999999998, -30.2, -3.3, -23.6, -9.399999999999999, -5.3, -22.6, -8.1, -15.599999999999998, -15.0, -14.199999999999994, -6.5, -6.899999999999999, -5.300000000000001, -6.3, -17.0, -7.300000000000001, -9.100000000000001, -9.7, -12.1, -5.4, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.264209400421207, "mean_inference_ms": 3.965287392518013, "mean_action_processing_ms": 0.10944124862980584, "mean_env_wait_ms": 26.044086414136654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1752000, "timesteps_this_iter": 0, "agent_timesteps_total": 1752000, "timers": {"sample_time_ms": 53377.666, "sample_throughput": 74.938, "load_time_ms": 1.317, "load_throughput": 3037919.82, "learn_time_ms": 26679.536, "learn_throughput": 149.928, "update_time_ms": 5.02}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.0793799414549784, "policy_loss": -0.01462747463355622, "vf_loss": 9.37078611440556, "vf_explained_var": 0.3250066950116106, "kl": 0.0110697084336588, "entropy": 0.21723468590487716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1752000, "num_agent_steps_sampled": 1752000, "num_steps_trained": 1752000, "num_agent_steps_trained": 1752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17520, "training_iteration": 438, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-44-50", "timestamp": 1643694290, "time_this_iter_s": 52.715482234954834, "time_total_s": 28953.615741729736, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28953.615741729736, "timesteps_since_restore": 0, "iterations_since_restore": 438, "perf": {"cpu_util_percent": 27.624324324324323, "ram_util_percent": 71.00405405405404}}
{"episode_reward_max": -3.2, "episode_reward_min": -30.2, "episode_reward_mean": -10.816999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.8, -4.6000000000000005, -12.2, -5.799999999999999, -21.4, -4.3, -7.4, -14.799999999999997, -25.3, -4.700000000000001, -19.599999999999994, -6.3, -14.6, -6.3, -12.2, -5.2, -9.2, -8.7, -10.6, -10.2, -7.300000000000001, -6.4, -14.999999999999993, -13.599999999999998, -10.3, -19.0, -6.3, -19.6, -15.899999999999999, -12.199999999999998, -11.4, -18.3, -4.3, -8.4, -7.3, -9.4, -11.4, -12.2, -12.199999999999998, -30.2, -3.3, -23.6, -9.399999999999999, -5.3, -22.6, -8.1, -15.599999999999998, -15.0, -14.199999999999994, -6.5, -6.899999999999999, -5.300000000000001, -6.3, -17.0, -7.300000000000001, -9.100000000000001, -9.7, -12.1, -5.4, -4.300000000000001, -5.4, -6.2, -12.29999999999999, -7.4, -7.2, -5.2, -21.600000000000005, -7.1, -14.399999999999999, -7.4, -8.5, -12.5, -8.3, -18.800000000000004, -18.4, -14.399999999999999, -16.3, -14.7, -3.2, -10.0, -9.500000000000002, -5.4, -5.2, -5.300000000000001, -5.300000000000001, -4.4, -4.4, -6.300000000000001, -12.299999999999999, -10.899999999999999, -5.300000000000001, -26.2, -12.399999999999997, -17.2, -9.3, -3.2, -5.4, -22.600000000000016, -5.300000000000001, -15.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.258659245630229, "mean_inference_ms": 3.964675248749258, "mean_action_processing_ms": 0.10967456080389049, "mean_env_wait_ms": 26.028164781473375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1756000, "timesteps_this_iter": 0, "agent_timesteps_total": 1756000, "timers": {"sample_time_ms": 53392.165, "sample_throughput": 74.917, "load_time_ms": 1.316, "load_throughput": 3039791.274, "learn_time_ms": 26691.586, "learn_throughput": 149.86, "update_time_ms": 4.999}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.057078675328884075, "policy_loss": -0.018176012430139766, "vf_loss": 7.504291506928782, "vf_explained_var": 0.32603525609098455, "kl": 0.007825873155004789, "entropy": 0.2032937230362046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1756000, "num_agent_steps_sampled": 1756000, "num_steps_trained": 1756000, "num_agent_steps_trained": 1756000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17560, "training_iteration": 439, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-45-44", "timestamp": 1643694344, "time_this_iter_s": 53.55152726173401, "time_total_s": 29007.16726899147, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29007.16726899147, "timesteps_since_restore": 0, "iterations_since_restore": 439, "perf": {"cpu_util_percent": 26.705263157894738, "ram_util_percent": 71.01842105263158}}
{"episode_reward_max": -3.2, "episode_reward_min": -34.3, "episode_reward_mean": -10.700999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -23.6, -9.399999999999999, -5.3, -22.6, -8.1, -15.599999999999998, -15.0, -14.199999999999994, -6.5, -6.899999999999999, -5.300000000000001, -6.3, -17.0, -7.300000000000001, -9.100000000000001, -9.7, -12.1, -5.4, -4.300000000000001, -5.4, -6.2, -12.29999999999999, -7.4, -7.2, -5.2, -21.600000000000005, -7.1, -14.399999999999999, -7.4, -8.5, -12.5, -8.3, -18.800000000000004, -18.4, -14.399999999999999, -16.3, -14.7, -3.2, -10.0, -9.500000000000002, -5.4, -5.2, -5.300000000000001, -5.300000000000001, -4.4, -4.4, -6.300000000000001, -12.299999999999999, -10.899999999999999, -5.300000000000001, -26.2, -12.399999999999997, -17.2, -9.3, -3.2, -5.4, -22.600000000000016, -5.300000000000001, -15.6, -16.4, -15.3, -18.3, -6.199999999999999, -9.900000000000002, -6.3, -8.5, -6.499999999999999, -19.099999999999998, -12.5, -13.0, -10.099999999999996, -6.2, -9.299999999999997, -12.899999999999999, -26.0, -3.8000000000000007, -5.4, -15.899999999999997, -18.3, -5.800000000000001, -3.8000000000000003, -34.3, -7.199999999999999, -5.2, -4.3, -13.1, -8.299999999999997, -3.3, -13.199999999999996, -26.1, -9.7, -17.700000000000003, -5.3, -10.1, -4.4, -13.3, -4.300000000000001, -18.699999999999996, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.253353102187731, "mean_inference_ms": 3.9645454264422866, "mean_action_processing_ms": 0.10991658967838883, "mean_env_wait_ms": 26.013798081289814, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1760000, "timesteps_this_iter": 0, "agent_timesteps_total": 1760000, "timers": {"sample_time_ms": 53621.176, "sample_throughput": 74.597, "load_time_ms": 1.318, "load_throughput": 3035940.791, "learn_time_ms": 26708.228, "learn_throughput": 149.767, "update_time_ms": 4.915}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.11121439220989623, "policy_loss": -0.010895695550347207, "vf_loss": 12.187466792489893, "vf_explained_var": 0.13307327858863338, "kl": 0.00869977199224849, "entropy": 0.2261951249613557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1760000, "num_agent_steps_sampled": 1760000, "num_steps_trained": 1760000, "num_agent_steps_trained": 1760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17600, "training_iteration": 440, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-46-39", "timestamp": 1643694399, "time_this_iter_s": 55.013121128082275, "time_total_s": 29062.180390119553, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29062.180390119553, "timesteps_since_restore": 0, "iterations_since_restore": 440, "perf": {"cpu_util_percent": 29.825641025641023, "ram_util_percent": 71.07307692307695}}
{"episode_reward_max": -3.2, "episode_reward_min": -34.3, "episode_reward_mean": -10.27, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.500000000000002, -5.4, -5.2, -5.300000000000001, -5.300000000000001, -4.4, -4.4, -6.300000000000001, -12.299999999999999, -10.899999999999999, -5.300000000000001, -26.2, -12.399999999999997, -17.2, -9.3, -3.2, -5.4, -22.600000000000016, -5.300000000000001, -15.6, -16.4, -15.3, -18.3, -6.199999999999999, -9.900000000000002, -6.3, -8.5, -6.499999999999999, -19.099999999999998, -12.5, -13.0, -10.099999999999996, -6.2, -9.299999999999997, -12.899999999999999, -26.0, -3.8000000000000007, -5.4, -15.899999999999997, -18.3, -5.800000000000001, -3.8000000000000003, -34.3, -7.199999999999999, -5.2, -4.3, -13.1, -8.299999999999997, -3.3, -13.199999999999996, -26.1, -9.7, -17.700000000000003, -5.3, -10.1, -4.4, -13.3, -4.300000000000001, -18.699999999999996, -4.3, -10.4, -3.3, -4.800000000000001, -5.4, -12.299999999999997, -9.6, -19.0, -5.2, -6.2, -9.5, -15.4, -6.299999999999999, -3.2, -13.899999999999999, -5.2, -11.499999999999996, -4.4, -9.3, -10.399999999999999, -17.499999999999986, -19.2, -6.3, -6.300000000000001, -5.4, -9.399999999999999, -12.7, -8.299999999999999, -10.199999999999996, -6.700000000000001, -15.5, -16.4, -13.099999999999998, -4.2, -8.4, -14.3, -7.0, -7.4, -5.300000000000001, -11.2, -13.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.247999647274473, "mean_inference_ms": 3.964375695648169, "mean_action_processing_ms": 0.11014965661094006, "mean_env_wait_ms": 25.99926284129841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1764000, "timesteps_this_iter": 0, "agent_timesteps_total": 1764000, "timers": {"sample_time_ms": 53511.294, "sample_throughput": 74.751, "load_time_ms": 1.321, "load_throughput": 3027176.212, "learn_time_ms": 26770.363, "learn_throughput": 149.419, "update_time_ms": 4.878}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.06275896726436513, "policy_loss": -0.0010217081955684129, "vf_loss": 6.3564861878592485, "vf_explained_var": 0.22053581149347368, "kl": 0.007975255095408805, "entropy": 0.2134873897317917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1764000, "num_agent_steps_sampled": 1764000, "num_steps_trained": 1764000, "num_agent_steps_trained": 1764000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17640, "training_iteration": 441, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-47-32", "timestamp": 1643694452, "time_this_iter_s": 53.12198305130005, "time_total_s": 29115.302373170853, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29115.302373170853, "timesteps_since_restore": 0, "iterations_since_restore": 441, "perf": {"cpu_util_percent": 28.793333333333333, "ram_util_percent": 71.11866666666668}}
{"episode_reward_max": -3.2, "episode_reward_min": -34.3, "episode_reward_mean": -9.854999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.800000000000001, -3.8000000000000003, -34.3, -7.199999999999999, -5.2, -4.3, -13.1, -8.299999999999997, -3.3, -13.199999999999996, -26.1, -9.7, -17.700000000000003, -5.3, -10.1, -4.4, -13.3, -4.300000000000001, -18.699999999999996, -4.3, -10.4, -3.3, -4.800000000000001, -5.4, -12.299999999999997, -9.6, -19.0, -5.2, -6.2, -9.5, -15.4, -6.299999999999999, -3.2, -13.899999999999999, -5.2, -11.499999999999996, -4.4, -9.3, -10.399999999999999, -17.499999999999986, -19.2, -6.3, -6.300000000000001, -5.4, -9.399999999999999, -12.7, -8.299999999999999, -10.199999999999996, -6.700000000000001, -15.5, -16.4, -13.099999999999998, -4.2, -8.4, -14.3, -7.0, -7.4, -5.300000000000001, -11.2, -13.099999999999998, -16.5, -17.3, -4.4, -7.2, -14.2, -8.2, -6.499999999999999, -21.299999999999997, -9.2, -21.3, -6.999999999999998, -5.4, -5.2, -4.300000000000001, -6.300000000000001, -5.300000000000001, -9.2, -5.2, -5.300000000000001, -15.3, -5.4, -12.2, -13.499999999999996, -23.3, -9.899999999999999, -6.300000000000001, -10.2, -18.60000000000001, -4.300000000000001, -9.3, -22.9, -5.4, -9.8, -3.4, -6.2, -18.3, -3.3, -5.300000000000001, -4.4, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.242626778607454, "mean_inference_ms": 3.963928108956643, "mean_action_processing_ms": 0.11037554698590188, "mean_env_wait_ms": 25.983896195509995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1768000, "timesteps_this_iter": 0, "agent_timesteps_total": 1768000, "timers": {"sample_time_ms": 53579.937, "sample_throughput": 74.655, "load_time_ms": 1.316, "load_throughput": 3038635.104, "learn_time_ms": 26737.477, "learn_throughput": 149.603, "update_time_ms": 4.948}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.06316259180205644, "policy_loss": -0.013613021720240833, "vf_loss": 7.645034241644285, "vf_explained_var": 0.4638662881748651, "kl": 0.012019942187483014, "entropy": 0.18505786917703126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1768000, "num_agent_steps_sampled": 1768000, "num_steps_trained": 1768000, "num_agent_steps_trained": 1768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17680, "training_iteration": 442, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-48-26", "timestamp": 1643694506, "time_this_iter_s": 53.60040521621704, "time_total_s": 29168.90277838707, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29168.90277838707, "timesteps_since_restore": 0, "iterations_since_restore": 442, "perf": {"cpu_util_percent": 25.048684210526314, "ram_util_percent": 71.08552631578948}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -26.4, "episode_reward_mean": -9.874, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.2, -6.3, -6.300000000000001, -5.4, -9.399999999999999, -12.7, -8.299999999999999, -10.199999999999996, -6.700000000000001, -15.5, -16.4, -13.099999999999998, -4.2, -8.4, -14.3, -7.0, -7.4, -5.300000000000001, -11.2, -13.099999999999998, -16.5, -17.3, -4.4, -7.2, -14.2, -8.2, -6.499999999999999, -21.299999999999997, -9.2, -21.3, -6.999999999999998, -5.4, -5.2, -4.300000000000001, -6.300000000000001, -5.300000000000001, -9.2, -5.2, -5.300000000000001, -15.3, -5.4, -12.2, -13.499999999999996, -23.3, -9.899999999999999, -6.300000000000001, -10.2, -18.60000000000001, -4.300000000000001, -9.3, -22.9, -5.4, -9.8, -3.4, -6.2, -18.3, -3.3, -5.300000000000001, -4.4, -3.3, -7.6000000000000005, -3.2, -13.3, -11.8, -3.3, -14.5, -9.900000000000002, -3.2, -17.2, -5.2, -17.699999999999996, -4.2, -4.800000000000001, -13.5, -5.2, -6.499999999999999, -2.5, -4.300000000000001, -6.300000000000001, -23.2, -4.8, -26.4, -7.199999999999999, -15.299999999999997, -19.8, -13.999999999999998, -5.2, -4.300000000000001, -25.3, -2.3000000000000003, -17.0, -4.300000000000001, -10.299999999999999, -3.7000000000000006, -18.90000000000003, -10.8, -4.2, -9.2, -9.600000000000001, -7.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.237218991722381, "mean_inference_ms": 3.9633714115055807, "mean_action_processing_ms": 0.11060374507480418, "mean_env_wait_ms": 25.96866084755827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1772000, "timesteps_this_iter": 0, "agent_timesteps_total": 1772000, "timers": {"sample_time_ms": 53590.449, "sample_throughput": 74.64, "load_time_ms": 1.302, "load_throughput": 3072525.09, "learn_time_ms": 26725.8, "learn_throughput": 149.668, "update_time_ms": 5.001}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.09432814647093095, "policy_loss": -0.006216630315588367, "vf_loss": 10.03411298830022, "vf_explained_var": 0.1578893894149411, "kl": 0.007525658014032773, "entropy": 0.18861609890816672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1772000, "num_agent_steps_sampled": 1772000, "num_steps_trained": 1772000, "num_agent_steps_trained": 1772000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17720, "training_iteration": 443, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-49-20", "timestamp": 1643694560, "time_this_iter_s": 53.70653414726257, "time_total_s": 29222.609312534332, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29222.609312534332, "timesteps_since_restore": 0, "iterations_since_restore": 443, "perf": {"cpu_util_percent": 29.21973684210526, "ram_util_percent": 70.99999999999997}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -52.3, "episode_reward_mean": -10.309000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -12.2, -13.499999999999996, -23.3, -9.899999999999999, -6.300000000000001, -10.2, -18.60000000000001, -4.300000000000001, -9.3, -22.9, -5.4, -9.8, -3.4, -6.2, -18.3, -3.3, -5.300000000000001, -4.4, -3.3, -7.6000000000000005, -3.2, -13.3, -11.8, -3.3, -14.5, -9.900000000000002, -3.2, -17.2, -5.2, -17.699999999999996, -4.2, -4.800000000000001, -13.5, -5.2, -6.499999999999999, -2.5, -4.300000000000001, -6.300000000000001, -23.2, -4.8, -26.4, -7.199999999999999, -15.299999999999997, -19.8, -13.999999999999998, -5.2, -4.300000000000001, -25.3, -2.3000000000000003, -17.0, -4.300000000000001, -10.299999999999999, -3.7000000000000006, -18.90000000000003, -10.8, -4.2, -9.2, -9.600000000000001, -7.1, -6.4, -2.4000000000000004, -3.4, -13.899999999999997, -16.2, -6.4, -14.799999999999995, -4.2, -17.6, -4.300000000000001, -13.600000000000001, -5.799999999999999, -15.199999999999998, -7.6000000000000005, -13.59999999999999, -4.4, -6.4, -12.3, -9.499999999999995, -24.900000000000023, -16.9, -4.2, -11.2, -9.2, -4.300000000000001, -12.6, -52.3, -4.3, -4.4, -13.4, -12.2, -12.999999999999998, -4.3, -6.2, -14.699999999999998, -22.4, -8.7, -10.2, -5.799999999999999, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2320171593598, "mean_inference_ms": 3.962824613624498, "mean_action_processing_ms": 0.1108303362663078, "mean_env_wait_ms": 25.953528981153784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1776000, "timesteps_this_iter": 0, "agent_timesteps_total": 1776000, "timers": {"sample_time_ms": 53581.383, "sample_throughput": 74.653, "load_time_ms": 1.307, "load_throughput": 3061312.313, "learn_time_ms": 26748.307, "learn_throughput": 149.542, "update_time_ms": 5.064}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.1594222722413589, "policy_loss": -0.015887065106121603, "vf_loss": 17.49690056225305, "vf_explained_var": 0.15709543952377894, "kl": 0.012576571154417357, "entropy": 0.18332030816424277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1776000, "num_agent_steps_sampled": 1776000, "num_steps_trained": 1776000, "num_agent_steps_trained": 1776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17760, "training_iteration": 444, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-50-14", "timestamp": 1643694614, "time_this_iter_s": 53.86363410949707, "time_total_s": 29276.47294664383, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29276.47294664383, "timesteps_since_restore": 0, "iterations_since_restore": 444, "perf": {"cpu_util_percent": 26.814473684210526, "ram_util_percent": 70.94342105263159}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -52.3, "episode_reward_mean": -11.177999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.8, -26.4, -7.199999999999999, -15.299999999999997, -19.8, -13.999999999999998, -5.2, -4.300000000000001, -25.3, -2.3000000000000003, -17.0, -4.300000000000001, -10.299999999999999, -3.7000000000000006, -18.90000000000003, -10.8, -4.2, -9.2, -9.600000000000001, -7.1, -6.4, -2.4000000000000004, -3.4, -13.899999999999997, -16.2, -6.4, -14.799999999999995, -4.2, -17.6, -4.300000000000001, -13.600000000000001, -5.799999999999999, -15.199999999999998, -7.6000000000000005, -13.59999999999999, -4.4, -6.4, -12.3, -9.499999999999995, -24.900000000000023, -16.9, -4.2, -11.2, -9.2, -4.300000000000001, -12.6, -52.3, -4.3, -4.4, -13.4, -12.2, -12.999999999999998, -4.3, -6.2, -14.699999999999998, -22.4, -8.7, -10.2, -5.799999999999999, -5.300000000000001, -27.2, -12.199999999999996, -13.799999999999988, -5.2, -15.099999999999998, -10.099999999999998, -9.2, -12.599999999999994, -5.0, -20.200000000000003, -11.999999999999998, -35.00000000000004, -6.1, -5.300000000000001, -8.2, -4.9, -3.2, -15.099999999999998, -4.300000000000001, -21.799999999999986, -5.300000000000001, -15.099999999999996, -19.9, -4.3, -14.0, -3.4, -6.9, -4.700000000000001, -16.1, -13.6, -16.9, -3.7, -8.4, -5.1000000000000005, -11.3, -13.799999999999999, -5.300000000000001, -25.6, -4.2, -15.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.226773193585571, "mean_inference_ms": 3.9621749697502713, "mean_action_processing_ms": 0.11104894004233565, "mean_env_wait_ms": 25.937796125586228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1780000, "timesteps_this_iter": 0, "agent_timesteps_total": 1780000, "timers": {"sample_time_ms": 53530.904, "sample_throughput": 74.723, "load_time_ms": 1.308, "load_throughput": 3058633.414, "learn_time_ms": 26690.783, "learn_throughput": 149.864, "update_time_ms": 5.079}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.11514470820385282, "policy_loss": -0.009287220579121382, "vf_loss": 12.418738555010929, "vf_explained_var": 0.11446257272074299, "kl": 0.009036786767206881, "entropy": 0.2154985334363676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1780000, "num_agent_steps_sampled": 1780000, "num_steps_trained": 1780000, "num_agent_steps_trained": 1780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17800, "training_iteration": 445, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-51-06", "timestamp": 1643694666, "time_this_iter_s": 52.268226861953735, "time_total_s": 29328.741173505783, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29328.741173505783, "timesteps_since_restore": 0, "iterations_since_restore": 445, "perf": {"cpu_util_percent": 26.86081081081081, "ram_util_percent": 71.0}}
{"episode_reward_max": -3.2, "episode_reward_min": -52.3, "episode_reward_mean": -11.390999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.9, -4.2, -11.2, -9.2, -4.300000000000001, -12.6, -52.3, -4.3, -4.4, -13.4, -12.2, -12.999999999999998, -4.3, -6.2, -14.699999999999998, -22.4, -8.7, -10.2, -5.799999999999999, -5.300000000000001, -27.2, -12.199999999999996, -13.799999999999988, -5.2, -15.099999999999998, -10.099999999999998, -9.2, -12.599999999999994, -5.0, -20.200000000000003, -11.999999999999998, -35.00000000000004, -6.1, -5.300000000000001, -8.2, -4.9, -3.2, -15.099999999999998, -4.300000000000001, -21.799999999999986, -5.300000000000001, -15.099999999999996, -19.9, -4.3, -14.0, -3.4, -6.9, -4.700000000000001, -16.1, -13.6, -16.9, -3.7, -8.4, -5.1000000000000005, -11.3, -13.799999999999999, -5.300000000000001, -25.6, -4.2, -15.5, -25.500000000000004, -11.2, -5.1, -17.299999999999997, -6.5, -11.899999999999995, -3.3, -9.299999999999997, -6.300000000000001, -4.300000000000001, -13.799999999999999, -4.2, -18.9, -20.0, -22.8, -15.4, -4.4, -9.5, -25.40000000000004, -17.4, -5.4, -7.699999999999998, -17.4, -3.2, -31.2, -5.2, -11.3, -11.299999999999999, -9.3, -9.200000000000001, -10.6, -13.2, -4.300000000000001, -19.5, -4.300000000000001, -5.300000000000001, -5.300000000000001, -4.2, -4.800000000000001, -8.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.221551226183865, "mean_inference_ms": 3.961487599643452, "mean_action_processing_ms": 0.111263176575715, "mean_env_wait_ms": 25.92175205002408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1784000, "timesteps_this_iter": 0, "agent_timesteps_total": 1784000, "timers": {"sample_time_ms": 53526.289, "sample_throughput": 74.73, "load_time_ms": 1.291, "load_throughput": 3097999.446, "learn_time_ms": 26696.452, "learn_throughput": 149.833, "update_time_ms": 5.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.10438722434543794, "policy_loss": -0.005478243073148112, "vf_loss": 10.961758812204485, "vf_explained_var": 0.2048504710838359, "kl": 0.009160122938789943, "entropy": 0.20104484888975338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1784000, "num_agent_steps_sampled": 1784000, "num_steps_trained": 1784000, "num_agent_steps_trained": 1784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17840, "training_iteration": 446, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-51-59", "timestamp": 1643694719, "time_this_iter_s": 53.22695183753967, "time_total_s": 29381.968125343323, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29381.968125343323, "timesteps_since_restore": 0, "iterations_since_restore": 446, "perf": {"cpu_util_percent": 28.77368421052632, "ram_util_percent": 70.875}}
{"episode_reward_max": -2.5, "episode_reward_min": -31.2, "episode_reward_mean": -10.643999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.300000000000001, -15.099999999999996, -19.9, -4.3, -14.0, -3.4, -6.9, -4.700000000000001, -16.1, -13.6, -16.9, -3.7, -8.4, -5.1000000000000005, -11.3, -13.799999999999999, -5.300000000000001, -25.6, -4.2, -15.5, -25.500000000000004, -11.2, -5.1, -17.299999999999997, -6.5, -11.899999999999995, -3.3, -9.299999999999997, -6.300000000000001, -4.300000000000001, -13.799999999999999, -4.2, -18.9, -20.0, -22.8, -15.4, -4.4, -9.5, -25.40000000000004, -17.4, -5.4, -7.699999999999998, -17.4, -3.2, -31.2, -5.2, -11.3, -11.299999999999999, -9.3, -9.200000000000001, -10.6, -13.2, -4.300000000000001, -19.5, -4.300000000000001, -5.300000000000001, -5.300000000000001, -4.2, -4.800000000000001, -8.7, -15.8, -7.699999999999998, -9.5, -4.300000000000001, -4.2, -4.300000000000001, -4.300000000000001, -6.1, -17.099999999999998, -12.3, -11.3, -3.3, -5.300000000000001, -6.4, -6.3999999999999995, -15.399999999999997, -2.5, -27.3, -5.2, -8.8, -6.2, -6.4, -4.800000000000001, -3.3, -8.2, -27.799999999999976, -3.4, -4.2, -15.4, -11.999999999999973, -19.2, -13.599999999999998, -11.799999999999997, -19.100000000000005, -17.3, -12.2, -19.799999999999997, -4.9, -4.3, -16.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.216206126202673, "mean_inference_ms": 3.960855366234049, "mean_action_processing_ms": 0.11148689367779738, "mean_env_wait_ms": 25.90630243019988, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1788000, "timesteps_this_iter": 0, "agent_timesteps_total": 1788000, "timers": {"sample_time_ms": 53565.514, "sample_throughput": 74.675, "load_time_ms": 1.285, "load_throughput": 3113927.02, "learn_time_ms": 26611.364, "learn_throughput": 150.312, "update_time_ms": 4.963}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.09200813103046629, "policy_loss": -0.009932036713887286, "vf_loss": 10.171038318962179, "vf_explained_var": 0.15373262115704117, "kl": 0.008491454083908256, "entropy": 0.1831388567964877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1788000, "num_agent_steps_sampled": 1788000, "num_steps_trained": 1788000, "num_agent_steps_trained": 1788000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17880, "training_iteration": 447, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-52-52", "timestamp": 1643694772, "time_this_iter_s": 53.00116300582886, "time_total_s": 29434.96928834915, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29434.96928834915, "timesteps_since_restore": 0, "iterations_since_restore": 447, "perf": {"cpu_util_percent": 28.032000000000007, "ram_util_percent": 70.88799999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -31.2, "episode_reward_mean": -10.306, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.4, -7.699999999999998, -17.4, -3.2, -31.2, -5.2, -11.3, -11.299999999999999, -9.3, -9.200000000000001, -10.6, -13.2, -4.300000000000001, -19.5, -4.300000000000001, -5.300000000000001, -5.300000000000001, -4.2, -4.800000000000001, -8.7, -15.8, -7.699999999999998, -9.5, -4.300000000000001, -4.2, -4.300000000000001, -4.300000000000001, -6.1, -17.099999999999998, -12.3, -11.3, -3.3, -5.300000000000001, -6.4, -6.3999999999999995, -15.399999999999997, -2.5, -27.3, -5.2, -8.8, -6.2, -6.4, -4.800000000000001, -3.3, -8.2, -27.799999999999976, -3.4, -4.2, -15.4, -11.999999999999973, -19.2, -13.599999999999998, -11.799999999999997, -19.100000000000005, -17.3, -12.2, -19.799999999999997, -4.9, -4.3, -16.0, -10.0, -12.899999999999997, -23.5, -10.3, -6.3, -11.699999999999987, -15.2, -4.3, -13.9, -3.3, -5.0, -4.3, -22.0, -16.3, -12.2, -7.299999999999999, -10.0, -5.699999999999999, -12.2, -10.099999999999998, -6.999999999999998, -4.2, -18.3, -21.2, -2.2, -8.999999999999996, -11.399999999999988, -12.5, -9.899999999999995, -4.4, -11.599999999999998, -22.9, -7.3, -3.2, -11.2, -14.899999999999999, -12.899999999999997, -10.599999999999996, -8.8, -11.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.211094431731231, "mean_inference_ms": 3.9602504959075118, "mean_action_processing_ms": 0.11170865860970797, "mean_env_wait_ms": 25.890886108938286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1792000, "timesteps_this_iter": 0, "agent_timesteps_total": 1792000, "timers": {"sample_time_ms": 53529.314, "sample_throughput": 74.725, "load_time_ms": 1.286, "load_throughput": 3110809.167, "learn_time_ms": 26561.9, "learn_throughput": 150.592, "update_time_ms": 5.033}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.07916345208262404, "policy_loss": -0.0022128419429864933, "vf_loss": 8.115856518540332, "vf_explained_var": 0.3076700775213139, "kl": 0.008045996837303513, "entropy": 0.21393657807380922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1792000, "num_agent_steps_sampled": 1792000, "num_steps_trained": 1792000, "num_agent_steps_trained": 1792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17920, "training_iteration": 448, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-53-45", "timestamp": 1643694825, "time_this_iter_s": 52.71526479721069, "time_total_s": 29487.684553146362, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29487.684553146362, "timesteps_since_restore": 0, "iterations_since_restore": 448, "perf": {"cpu_util_percent": 26.721621621621622, "ram_util_percent": 70.89999999999998}}
{"episode_reward_max": -2.2, "episode_reward_min": -50.4, "episode_reward_mean": -11.585999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.2, -6.4, -4.800000000000001, -3.3, -8.2, -27.799999999999976, -3.4, -4.2, -15.4, -11.999999999999973, -19.2, -13.599999999999998, -11.799999999999997, -19.100000000000005, -17.3, -12.2, -19.799999999999997, -4.9, -4.3, -16.0, -10.0, -12.899999999999997, -23.5, -10.3, -6.3, -11.699999999999987, -15.2, -4.3, -13.9, -3.3, -5.0, -4.3, -22.0, -16.3, -12.2, -7.299999999999999, -10.0, -5.699999999999999, -12.2, -10.099999999999998, -6.999999999999998, -4.2, -18.3, -21.2, -2.2, -8.999999999999996, -11.399999999999988, -12.5, -9.899999999999995, -4.4, -11.599999999999998, -22.9, -7.3, -3.2, -11.2, -14.899999999999999, -12.899999999999997, -10.599999999999996, -8.8, -11.799999999999999, -9.7, -4.300000000000001, -18.9, -26.300000000000004, -4.7, -21.000000000000014, -43.30000000000011, -12.199999999999996, -3.2, -3.2, -15.399999999999997, -3.3, -4.300000000000001, -10.2, -4.2, -13.399999999999975, -4.2, -6.300000000000001, -17.2, -6.2, -4.300000000000001, -4.4, -15.600000000000001, -5.0, -17.1, -4.300000000000001, -14.999999999999998, -13.399999999999999, -19.5, -12.9, -14.799999999999997, -8.899999999999999, -10.399999999999999, -11.299999999999999, -50.4, -19.3, -15.299999999999988, -4.3, -3.6000000000000005, -15.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2059858711550415, "mean_inference_ms": 3.9597065920176595, "mean_action_processing_ms": 0.11193294379182361, "mean_env_wait_ms": 25.875790098109718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1796000, "timesteps_this_iter": 0, "agent_timesteps_total": 1796000, "timers": {"sample_time_ms": 53501.726, "sample_throughput": 74.764, "load_time_ms": 1.29, "load_throughput": 3100403.969, "learn_time_ms": 26549.867, "learn_throughput": 150.66, "update_time_ms": 4.947}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.027061008545570083, "cur_lr": 0.00010000000000000003, "total_loss": 0.18834061813265365, "policy_loss": -0.02256111608798145, "vf_loss": 21.01931773372876, "vf_explained_var": 0.1521378800433169, "kl": 0.026183954157839674, "entropy": 0.20261724586448362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1796000, "num_agent_steps_sampled": 1796000, "num_steps_trained": 1796000, "num_agent_steps_trained": 1796000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 17960, "training_iteration": 449, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-54-39", "timestamp": 1643694879, "time_this_iter_s": 53.64813995361328, "time_total_s": 29541.332693099976, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29541.332693099976, "timesteps_since_restore": 0, "iterations_since_restore": 449, "perf": {"cpu_util_percent": 31.100000000000005, "ram_util_percent": 70.90921052631576}}
{"episode_reward_max": -2.2, "episode_reward_min": -50.4, "episode_reward_mean": -11.927, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999998, -4.2, -18.3, -21.2, -2.2, -8.999999999999996, -11.399999999999988, -12.5, -9.899999999999995, -4.4, -11.599999999999998, -22.9, -7.3, -3.2, -11.2, -14.899999999999999, -12.899999999999997, -10.599999999999996, -8.8, -11.799999999999999, -9.7, -4.300000000000001, -18.9, -26.300000000000004, -4.7, -21.000000000000014, -43.30000000000011, -12.199999999999996, -3.2, -3.2, -15.399999999999997, -3.3, -4.300000000000001, -10.2, -4.2, -13.399999999999975, -4.2, -6.300000000000001, -17.2, -6.2, -4.300000000000001, -4.4, -15.600000000000001, -5.0, -17.1, -4.300000000000001, -14.999999999999998, -13.399999999999999, -19.5, -12.9, -14.799999999999997, -8.899999999999999, -10.399999999999999, -11.299999999999999, -50.4, -19.3, -15.299999999999988, -4.3, -3.6000000000000005, -15.599999999999998, -12.3, -4.2, -11.100000000000001, -4.300000000000001, -16.3, -9.1, -4.2, -10.3, -20.4, -2.6000000000000005, -3.3, -7.300000000000001, -20.2, -9.0, -8.2, -15.3, -10.899999999999999, -16.799999999999997, -24.9, -12.5, -12.499999999999998, -14.499999999999998, -3.2, -15.1, -10.8, -9.8, -5.3, -25.000000000000007, -10.3, -14.699999999999998, -14.2, -3.3, -4.2, -9.4, -8.2, -23.900000000000006, -20.1, -6.2, -10.4, -36.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.200916711273656, "mean_inference_ms": 3.9590996983510354, "mean_action_processing_ms": 0.11214746015531979, "mean_env_wait_ms": 25.860437082495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1800000, "timesteps_this_iter": 0, "agent_timesteps_total": 1800000, "timers": {"sample_time_ms": 53273.118, "sample_throughput": 75.085, "load_time_ms": 1.286, "load_throughput": 3109771.27, "learn_time_ms": 26564.167, "learn_throughput": 150.579, "update_time_ms": 4.963}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.13279888816853805, "policy_loss": -0.007715688201208269, "vf_loss": 14.016400255631375, "vf_explained_var": 0.18696010856218234, "kl": 0.008636748985228418, "entropy": 0.19313088584170546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1800000, "num_agent_steps_sampled": 1800000, "num_steps_trained": 1800000, "num_agent_steps_trained": 1800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18000, "training_iteration": 450, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-55-32", "timestamp": 1643694932, "time_this_iter_s": 53.00092530250549, "time_total_s": 29594.33361840248, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29594.33361840248, "timesteps_since_restore": 0, "iterations_since_restore": 450, "perf": {"cpu_util_percent": 27.454666666666665, "ram_util_percent": 70.96933333333332}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -50.4, "episode_reward_mean": -11.307, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.4, -15.600000000000001, -5.0, -17.1, -4.300000000000001, -14.999999999999998, -13.399999999999999, -19.5, -12.9, -14.799999999999997, -8.899999999999999, -10.399999999999999, -11.299999999999999, -50.4, -19.3, -15.299999999999988, -4.3, -3.6000000000000005, -15.599999999999998, -12.3, -4.2, -11.100000000000001, -4.300000000000001, -16.3, -9.1, -4.2, -10.3, -20.4, -2.6000000000000005, -3.3, -7.300000000000001, -20.2, -9.0, -8.2, -15.3, -10.899999999999999, -16.799999999999997, -24.9, -12.5, -12.499999999999998, -14.499999999999998, -3.2, -15.1, -10.8, -9.8, -5.3, -25.000000000000007, -10.3, -14.699999999999998, -14.2, -3.3, -4.2, -9.4, -8.2, -23.900000000000006, -20.1, -6.2, -10.4, -36.2, -3.2, -4.4, -5.2, -4.2, -12.600000000000001, -20.999999999999996, -13.4, -14.1, -4.300000000000001, -4.1000000000000005, -19.799999999999997, -6.0, -3.4, -4.4, -4.300000000000001, -12.3, -21.300000000000022, -5.999999999999999, -2.3000000000000003, -23.2, -8.399999999999999, -16.7, -6.199999999999999, -15.7, -31.800000000000075, -7.3, -10.0, -6.3999999999999995, -15.099999999999994, -9.2, -5.300000000000001, -9.2, -8.2, -6.8999999999999995, -3.3, -6.999999999999999, -10.600000000000001, -4.9, -8.8, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.195705865286719, "mean_inference_ms": 3.958427448546429, "mean_action_processing_ms": 0.11235744280696817, "mean_env_wait_ms": 25.844853663209516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1804000, "timesteps_this_iter": 0, "agent_timesteps_total": 1804000, "timers": {"sample_time_ms": 53315.56, "sample_throughput": 75.025, "load_time_ms": 1.282, "load_throughput": 3119485.33, "learn_time_ms": 26589.954, "learn_throughput": 150.433, "update_time_ms": 5.073}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.07156589850583063, "policy_loss": -0.022575642883537278, "vf_loss": 9.344018411476124, "vf_explained_var": 0.27161828176949615, "kl": 0.017278466370013245, "entropy": 0.19499665127005628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1804000, "num_agent_steps_sampled": 1804000, "num_steps_trained": 1804000, "num_agent_steps_trained": 1804000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18040, "training_iteration": 451, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_05-56-26", "timestamp": 1643694986, "time_this_iter_s": 53.68002390861511, "time_total_s": 29648.013642311096, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29648.013642311096, "timesteps_since_restore": 0, "iterations_since_restore": 451, "perf": {"cpu_util_percent": 29.2328947368421, "ram_util_percent": 71.02631578947371}}
{"episode_reward_max": -2.3000000000000003, "episode_reward_min": -36.2, "episode_reward_mean": -10.757000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.499999999999998, -14.499999999999998, -3.2, -15.1, -10.8, -9.8, -5.3, -25.000000000000007, -10.3, -14.699999999999998, -14.2, -3.3, -4.2, -9.4, -8.2, -23.900000000000006, -20.1, -6.2, -10.4, -36.2, -3.2, -4.4, -5.2, -4.2, -12.600000000000001, -20.999999999999996, -13.4, -14.1, -4.300000000000001, -4.1000000000000005, -19.799999999999997, -6.0, -3.4, -4.4, -4.300000000000001, -12.3, -21.300000000000022, -5.999999999999999, -2.3000000000000003, -23.2, -8.399999999999999, -16.7, -6.199999999999999, -15.7, -31.800000000000075, -7.3, -10.0, -6.3999999999999995, -15.099999999999994, -9.2, -5.300000000000001, -9.2, -8.2, -6.8999999999999995, -3.3, -6.999999999999999, -10.600000000000001, -4.9, -8.8, -4.300000000000001, -8.8, -5.0, -21.5, -6.2, -5.4, -8.5, -21.600000000000005, -4.4, -10.2, -21.2, -8.099999999999998, -8.1, -13.8, -10.2, -8.299999999999999, -5.4, -4.700000000000001, -13.4, -20.3, -9.200000000000001, -8.2, -3.900000000000001, -3.3, -17.9, -3.2, -13.9, -21.500000000000004, -3.7, -16.5, -16.799999999999997, -12.899999999999995, -8.5, -10.5, -13.299999999999999, -6.2, -11.0, -10.199999999999998, -6.2, -22.3, -9.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.189676094349773, "mean_inference_ms": 7.141859806845519, "mean_action_processing_ms": 0.11250738391085675, "mean_env_wait_ms": 29.008874606823152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1808000, "timesteps_this_iter": 0, "agent_timesteps_total": 1808000, "timers": {"sample_time_ms": 52635.413, "sample_throughput": 75.994, "load_time_ms": 1.206, "load_throughput": 3315393.25, "learn_time_ms": 25845.622, "learn_throughput": 154.765, "update_time_ms": 5.066}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.08974254264506282, "policy_loss": -0.010028049562086342, "vf_loss": 9.93724482021024, "vf_explained_var": 0.17429823362699118, "kl": 0.009808611731432588, "entropy": 0.21518285806461046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1808000, "num_agent_steps_sampled": 1808000, "num_steps_trained": 1808000, "num_agent_steps_trained": 1808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18080, "training_iteration": 452, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_07-57-02", "timestamp": 1643702222, "time_this_iter_s": 7235.799587011337, "time_total_s": 36883.81322932243, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 36883.81322932243, "timesteps_since_restore": 0, "iterations_since_restore": 452, "perf": {"cpu_util_percent": 41.685185185185176, "ram_util_percent": 71.22962962962961}}
{"episode_reward_max": -3.2, "episode_reward_min": -33.3, "episode_reward_mean": -10.787, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.399999999999999, -16.7, -6.199999999999999, -15.7, -31.800000000000075, -7.3, -10.0, -6.3999999999999995, -15.099999999999994, -9.2, -5.300000000000001, -9.2, -8.2, -6.8999999999999995, -3.3, -6.999999999999999, -10.600000000000001, -4.9, -8.8, -4.300000000000001, -8.8, -5.0, -21.5, -6.2, -5.4, -8.5, -21.600000000000005, -4.4, -10.2, -21.2, -8.099999999999998, -8.1, -13.8, -10.2, -8.299999999999999, -5.4, -4.700000000000001, -13.4, -20.3, -9.200000000000001, -8.2, -3.900000000000001, -3.3, -17.9, -3.2, -13.9, -21.500000000000004, -3.7, -16.5, -16.799999999999997, -12.899999999999995, -8.5, -10.5, -13.299999999999999, -6.2, -11.0, -10.199999999999998, -6.2, -22.3, -9.3, -4.3, -4.700000000000001, -4.300000000000001, -18.199999999999996, -4.800000000000001, -5.4, -14.8, -5.300000000000001, -11.0, -8.8, -3.3, -13.5, -14.499999999999998, -12.2, -4.4, -23.2, -4.2, -14.299999999999988, -4.300000000000001, -33.3, -3.2, -5.300000000000001, -22.2, -11.0, -20.3, -4.2, -9.3, -30.600000000000005, -3.2, -7.1, -22.3, -13.699999999999998, -13.899999999999999, -18.999999999999996, -5.3, -5.2, -7.300000000000001, -13.799999999999999, -20.700000000000006, -3.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.183851117352078, "mean_inference_ms": 10.31827107897501, "mean_action_processing_ms": 0.11265756286245153, "mean_env_wait_ms": 32.16584193474984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1812000, "timesteps_this_iter": 0, "agent_timesteps_total": 1812000, "timers": {"sample_time_ms": 51807.453, "sample_throughput": 77.209, "load_time_ms": 1.192, "load_throughput": 3354571.012, "learn_time_ms": 25859.522, "learn_throughput": 154.682, "update_time_ms": 5.051}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.10077662592533455, "policy_loss": -0.009930573112421459, "vf_loss": 11.040135141854645, "vf_explained_var": 0.199672455364658, "kl": 0.007534813098841032, "entropy": 0.15997613467356211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1812000, "num_agent_steps_sampled": 1812000, "num_steps_trained": 1812000, "num_agent_steps_trained": 1812000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18120, "training_iteration": 453, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_07-57-55", "timestamp": 1643702275, "time_this_iter_s": 53.0487380027771, "time_total_s": 36936.86196732521, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 36936.86196732521, "timesteps_since_restore": 0, "iterations_since_restore": 453, "perf": {"cpu_util_percent": 29.670666666666662, "ram_util_percent": 70.92933333333335}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -33.3, "episode_reward_mean": -11.14, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.2, -3.900000000000001, -3.3, -17.9, -3.2, -13.9, -21.500000000000004, -3.7, -16.5, -16.799999999999997, -12.899999999999995, -8.5, -10.5, -13.299999999999999, -6.2, -11.0, -10.199999999999998, -6.2, -22.3, -9.3, -4.3, -4.700000000000001, -4.300000000000001, -18.199999999999996, -4.800000000000001, -5.4, -14.8, -5.300000000000001, -11.0, -8.8, -3.3, -13.5, -14.499999999999998, -12.2, -4.4, -23.2, -4.2, -14.299999999999988, -4.300000000000001, -33.3, -3.2, -5.300000000000001, -22.2, -11.0, -20.3, -4.2, -9.3, -30.600000000000005, -3.2, -7.1, -22.3, -13.699999999999998, -13.899999999999999, -18.999999999999996, -5.3, -5.2, -7.300000000000001, -13.799999999999999, -20.700000000000006, -3.4, -16.3, -5.2, -15.999999999999998, -4.3, -9.499999999999998, -7.3, -22.500000000000007, -9.8, -23.3, -5.2, -5.0, -8.7, -9.0, -4.2, -15.299999999999999, -17.9, -4.300000000000001, -8.9, -11.9, -19.0, -7.199999999999999, -19.2, -9.399999999999999, -9.999999999999996, -4.3, -4.2, -16.9, -15.699999999999998, -4.2, -10.9, -12.3, -18.40000000000001, -2.6000000000000005, -17.400000000000006, -16.3, -17.3, -3.2, -10.799999999999999, -11.1, -9.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.178458586027995, "mean_inference_ms": 13.488154004989683, "mean_action_processing_ms": 0.11283878397137835, "mean_env_wait_ms": 32.134003394141764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1816000, "timesteps_this_iter": 0, "agent_timesteps_total": 1816000, "timers": {"sample_time_ms": 51833.29, "sample_throughput": 77.17, "load_time_ms": 1.189, "load_throughput": 3364459.953, "learn_time_ms": 25796.647, "learn_throughput": 155.059, "update_time_ms": 5.007}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.10494015249674038, "policy_loss": -0.003229858373762459, "vf_loss": 10.774465475287489, "vf_explained_var": 0.15909404773865976, "kl": 0.010478991832498034, "entropy": 0.19195999159447608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1816000, "num_agent_steps_sampled": 1816000, "num_steps_trained": 1816000, "num_agent_steps_trained": 1816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18160, "training_iteration": 454, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_07-58-48", "timestamp": 1643702328, "time_this_iter_s": 53.35882306098938, "time_total_s": 36990.2207903862, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 36990.2207903862, "timesteps_since_restore": 0, "iterations_since_restore": 454, "perf": {"cpu_util_percent": 28.968421052631577, "ram_util_percent": 70.94342105263158}}
{"episode_reward_max": -2.6000000000000005, "episode_reward_min": -40.70000000000005, "episode_reward_mean": -11.23, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -5.300000000000001, -22.2, -11.0, -20.3, -4.2, -9.3, -30.600000000000005, -3.2, -7.1, -22.3, -13.699999999999998, -13.899999999999999, -18.999999999999996, -5.3, -5.2, -7.300000000000001, -13.799999999999999, -20.700000000000006, -3.4, -16.3, -5.2, -15.999999999999998, -4.3, -9.499999999999998, -7.3, -22.500000000000007, -9.8, -23.3, -5.2, -5.0, -8.7, -9.0, -4.2, -15.299999999999999, -17.9, -4.300000000000001, -8.9, -11.9, -19.0, -7.199999999999999, -19.2, -9.399999999999999, -9.999999999999996, -4.3, -4.2, -16.9, -15.699999999999998, -4.2, -10.9, -12.3, -18.40000000000001, -2.6000000000000005, -17.400000000000006, -16.3, -17.3, -3.2, -10.799999999999999, -11.1, -9.9, -12.9, -11.5, -16.199999999999996, -4.2, -5.2, -6.300000000000001, -5.3, -13.399999999999999, -5.300000000000001, -20.4, -5.300000000000001, -9.699999999999994, -25.2, -5.300000000000001, -8.799999999999999, -8.2, -13.3, -10.3, -7.2, -26.499999999999968, -9.7, -4.2, -3.9000000000000004, -12.600000000000001, -9.3, -5.300000000000001, -14.8, -6.199999999999999, -11.9, -12.600000000000001, -12.2, -4.300000000000001, -40.70000000000005, -11.299999999999985, -11.799999999999999, -4.3, -12.2, -4.2, -19.799999999999997, -5.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.17351537973148, "mean_inference_ms": 13.466496868385166, "mean_action_processing_ms": 0.11304579339966414, "mean_env_wait_ms": 32.10445979646083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1820000, "timesteps_this_iter": 0, "agent_timesteps_total": 1820000, "timers": {"sample_time_ms": 51743.866, "sample_throughput": 77.304, "load_time_ms": 1.19, "load_throughput": 3360551.238, "learn_time_ms": 25849.713, "learn_throughput": 154.741, "update_time_ms": 5.051}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.11876790370111183, "policy_loss": -0.015371363485852878, "vf_loss": 13.364580430907587, "vf_explained_var": 0.2395760282393425, "kl": 0.012156879044077572, "entropy": 0.1768030550771503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1820000, "num_agent_steps_sampled": 1820000, "num_steps_trained": 1820000, "num_agent_steps_trained": 1820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18200, "training_iteration": 455, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_07-59-41", "timestamp": 1643702381, "time_this_iter_s": 52.54886507987976, "time_total_s": 37042.76965546608, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37042.76965546608, "timesteps_since_restore": 0, "iterations_since_restore": 455, "perf": {"cpu_util_percent": 23.16351351351351, "ram_util_percent": 71.01081081081081}}
{"episode_reward_max": -1.3, "episode_reward_min": -40.70000000000005, "episode_reward_mean": -10.879999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.199999999999999, -19.2, -9.399999999999999, -9.999999999999996, -4.3, -4.2, -16.9, -15.699999999999998, -4.2, -10.9, -12.3, -18.40000000000001, -2.6000000000000005, -17.400000000000006, -16.3, -17.3, -3.2, -10.799999999999999, -11.1, -9.9, -12.9, -11.5, -16.199999999999996, -4.2, -5.2, -6.300000000000001, -5.3, -13.399999999999999, -5.300000000000001, -20.4, -5.300000000000001, -9.699999999999994, -25.2, -5.300000000000001, -8.799999999999999, -8.2, -13.3, -10.3, -7.2, -26.499999999999968, -9.7, -4.2, -3.9000000000000004, -12.600000000000001, -9.3, -5.300000000000001, -14.8, -6.199999999999999, -11.9, -12.600000000000001, -12.2, -4.300000000000001, -40.70000000000005, -11.299999999999985, -11.799999999999999, -4.3, -12.2, -4.2, -19.799999999999997, -5.300000000000001, -7.299999999999999, -15.2, -15.299999999999999, -5.4, -27.700000000000003, -16.1, -6.2, -5.300000000000001, -8.8, -4.300000000000001, -13.7, -5.899999999999999, -5.8999999999999995, -11.8, -3.2, -4.300000000000001, -17.099999999999998, -9.799999999999999, -3.8000000000000003, -3.2, -24.2, -8.7, -11.5, -9.4, -31.2, -6.799999999999999, -4.4, -19.000000000000004, -4.300000000000001, -30.29999999999995, -11.9, -12.299999999999999, -18.200000000000003, -4.4, -4.300000000000001, -13.7, -5.300000000000001, -4.300000000000001, -13.8, -1.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.168585542933735, "mean_inference_ms": 13.445039153812235, "mean_action_processing_ms": 0.11325861231933726, "mean_env_wait_ms": 32.07575909564302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1824000, "timesteps_this_iter": 0, "agent_timesteps_total": 1824000, "timers": {"sample_time_ms": 51890.214, "sample_throughput": 77.086, "load_time_ms": 1.184, "load_throughput": 3377600.258, "learn_time_ms": 25805.09, "learn_throughput": 155.008, "update_time_ms": 5.117}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.1279529492681225, "policy_loss": -0.0018333425089436513, "vf_loss": 12.951297793978004, "vf_explained_var": 0.11074416893784718, "kl": 0.006733307882692752, "entropy": 0.19050940072504424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1824000, "num_agent_steps_sampled": 1824000, "num_steps_trained": 1824000, "num_agent_steps_trained": 1824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18240, "training_iteration": 456, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-00-34", "timestamp": 1643702434, "time_this_iter_s": 53.735532999038696, "time_total_s": 37096.50518846512, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37096.50518846512, "timesteps_since_restore": 0, "iterations_since_restore": 456, "perf": {"cpu_util_percent": 27.835526315789473, "ram_util_percent": 71.05131578947366}}
{"episode_reward_max": -1.3, "episode_reward_min": -42.4, "episode_reward_mean": -11.150000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.7, -4.2, -3.9000000000000004, -12.600000000000001, -9.3, -5.300000000000001, -14.8, -6.199999999999999, -11.9, -12.600000000000001, -12.2, -4.300000000000001, -40.70000000000005, -11.299999999999985, -11.799999999999999, -4.3, -12.2, -4.2, -19.799999999999997, -5.300000000000001, -7.299999999999999, -15.2, -15.299999999999999, -5.4, -27.700000000000003, -16.1, -6.2, -5.300000000000001, -8.8, -4.300000000000001, -13.7, -5.899999999999999, -5.8999999999999995, -11.8, -3.2, -4.300000000000001, -17.099999999999998, -9.799999999999999, -3.8000000000000003, -3.2, -24.2, -8.7, -11.5, -9.4, -31.2, -6.799999999999999, -4.4, -19.000000000000004, -4.300000000000001, -30.29999999999995, -11.9, -12.299999999999999, -18.200000000000003, -4.4, -4.300000000000001, -13.7, -5.300000000000001, -4.300000000000001, -13.8, -1.3, -4.300000000000001, -14.299999999999999, -14.199999999999996, -10.2, -17.199999999999996, -3.3, -9.600000000000001, -19.2, -21.400000000000002, -6.2, -17.600000000000005, -3.2, -7.300000000000001, -7.299999999999999, -12.6, -13.7, -4.700000000000001, -3.7, -7.899999999999999, -15.6, -13.700000000000001, -11.099999999999998, -16.5, -20.0, -5.2, -8.7, -13.799999999999999, -14.999999999999998, -3.4, -14.799999999999999, -20.300000000000004, -3.3, -21.800000000000004, -5.3, -42.4, -5.300000000000001, -12.8, -8.199999999999998, -9.5, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1641009731925065, "mean_inference_ms": 13.424502148043894, "mean_action_processing_ms": 0.11350500526946095, "mean_env_wait_ms": 32.051531847220346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1828000, "timesteps_this_iter": 0, "agent_timesteps_total": 1828000, "timers": {"sample_time_ms": 52424.637, "sample_throughput": 76.3, "load_time_ms": 3.225, "load_throughput": 1240358.714, "learn_time_ms": 26061.642, "learn_throughput": 153.482, "update_time_ms": 5.069}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.10778518055755926, "policy_loss": -0.010320460722250964, "vf_loss": 11.786785814198115, "vf_explained_var": 0.26548320420326726, "kl": 0.005858071009710252, "entropy": 0.18020260239881214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1828000, "num_agent_steps_sampled": 1828000, "num_steps_trained": 1828000, "num_agent_steps_trained": 1828000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18280, "training_iteration": 457, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-01-36", "timestamp": 1643702496, "time_this_iter_s": 61.398273944854736, "time_total_s": 37157.90346240997, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37157.90346240997, "timesteps_since_restore": 0, "iterations_since_restore": 457, "perf": {"cpu_util_percent": 48.03333333333334, "ram_util_percent": 71.46206896551723}}
{"episode_reward_max": -1.3, "episode_reward_min": -42.4, "episode_reward_mean": -11.814, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.2, -8.7, -11.5, -9.4, -31.2, -6.799999999999999, -4.4, -19.000000000000004, -4.300000000000001, -30.29999999999995, -11.9, -12.299999999999999, -18.200000000000003, -4.4, -4.300000000000001, -13.7, -5.300000000000001, -4.300000000000001, -13.8, -1.3, -4.300000000000001, -14.299999999999999, -14.199999999999996, -10.2, -17.199999999999996, -3.3, -9.600000000000001, -19.2, -21.400000000000002, -6.2, -17.600000000000005, -3.2, -7.300000000000001, -7.299999999999999, -12.6, -13.7, -4.700000000000001, -3.7, -7.899999999999999, -15.6, -13.700000000000001, -11.099999999999998, -16.5, -20.0, -5.2, -8.7, -13.799999999999999, -14.999999999999998, -3.4, -14.799999999999999, -20.300000000000004, -3.3, -21.800000000000004, -5.3, -42.4, -5.300000000000001, -12.8, -8.199999999999998, -9.5, -4.2, -6.2, -21.2, -9.999999999999998, -6.2, -4.2, -4.4, -9.700000000000001, -11.1, -3.3, -18.000000000000004, -8.4, -13.899999999999997, -14.6, -16.4, -7.800000000000001, -25.3, -3.3, -8.3, -18.4, -10.499999999999998, -4.3, -34.2, -10.399999999999999, -13.0, -14.899999999999999, -13.799999999999999, -21.200000000000003, -14.799999999999999, -4.4, -4.2, -9.799999999999999, -3.3, -14.6, -16.1, -5.6000000000000005, -11.999999999999998, -17.2, -19.4, -12.599999999999998, -6.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.160327468581767, "mean_inference_ms": 13.404967413170901, "mean_action_processing_ms": 0.11379737825724084, "mean_env_wait_ms": 32.0327690857967, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1832000, "timesteps_this_iter": 0, "agent_timesteps_total": 1832000, "timers": {"sample_time_ms": 53469.847, "sample_throughput": 74.809, "load_time_ms": 3.224, "load_throughput": 1240578.836, "learn_time_ms": 26246.149, "learn_throughput": 152.403, "update_time_ms": 5.078}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.09173032499359099, "policy_loss": -0.006099957689362508, "vf_loss": 9.747766807643316, "vf_explained_var": 0.2857363658566629, "kl": 0.00868696936521453, "entropy": 0.1806112171381071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1832000, "num_agent_steps_sampled": 1832000, "num_steps_trained": 1832000, "num_agent_steps_trained": 1832000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18320, "training_iteration": 458, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-02-38", "timestamp": 1643702558, "time_this_iter_s": 62.423686027526855, "time_total_s": 37220.3271484375, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37220.3271484375, "timesteps_since_restore": 0, "iterations_since_restore": 458, "perf": {"cpu_util_percent": 50.85795454545455, "ram_util_percent": 70.88636363636363}}
{"episode_reward_max": -3.3, "episode_reward_min": -42.4, "episode_reward_mean": -11.944, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.700000000000001, -11.099999999999998, -16.5, -20.0, -5.2, -8.7, -13.799999999999999, -14.999999999999998, -3.4, -14.799999999999999, -20.300000000000004, -3.3, -21.800000000000004, -5.3, -42.4, -5.300000000000001, -12.8, -8.199999999999998, -9.5, -4.2, -6.2, -21.2, -9.999999999999998, -6.2, -4.2, -4.4, -9.700000000000001, -11.1, -3.3, -18.000000000000004, -8.4, -13.899999999999997, -14.6, -16.4, -7.800000000000001, -25.3, -3.3, -8.3, -18.4, -10.499999999999998, -4.3, -34.2, -10.399999999999999, -13.0, -14.899999999999999, -13.799999999999999, -21.200000000000003, -14.799999999999999, -4.4, -4.2, -9.799999999999999, -3.3, -14.6, -16.1, -5.6000000000000005, -11.999999999999998, -17.2, -19.4, -12.599999999999998, -6.299999999999999, -8.1, -19.200000000000003, -25.3, -5.2, -8.499999999999996, -4.2, -12.399999999999995, -3.4, -7.399999999999999, -17.4, -3.7000000000000006, -5.1000000000000005, -6.300000000000001, -4.300000000000001, -19.6, -6.4, -12.5, -21.5, -8.3, -5.2, -9.8, -11.1, -18.3, -11.2, -14.099999999999996, -7.999999999999998, -27.3, -14.8, -19.5, -5.300000000000001, -4.4, -5.2, -10.5, -13.1, -18.9, -21.100000000000048, -5.2, -15.799999999999999, -24.000000000000025, -4.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.156656246393035, "mean_inference_ms": 13.385555119739779, "mean_action_processing_ms": 0.11409941733098637, "mean_env_wait_ms": 32.01512580806113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1836000, "timesteps_this_iter": 0, "agent_timesteps_total": 1836000, "timers": {"sample_time_ms": 54121.682, "sample_throughput": 73.908, "load_time_ms": 3.262, "load_throughput": 1226135.789, "learn_time_ms": 26342.378, "learn_throughput": 151.847, "update_time_ms": 5.187}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.040591512818355116, "cur_lr": 0.00010000000000000003, "total_loss": 0.10724809338108346, "policy_loss": -0.01037896827504199, "vf_loss": 11.74387291516027, "vf_explained_var": 0.1612521456774845, "kl": 0.0046397352972239875, "entropy": 0.14181789541917464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1836000, "num_agent_steps_sampled": 1836000, "num_steps_trained": 1836000, "num_agent_steps_trained": 1836000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18360, "training_iteration": 459, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-03-38", "timestamp": 1643702618, "time_this_iter_s": 59.009968996047974, "time_total_s": 37279.33711743355, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37279.33711743355, "timesteps_since_restore": 0, "iterations_since_restore": 459, "perf": {"cpu_util_percent": 44.34047619047619, "ram_util_percent": 70.8547619047619}}
{"episode_reward_max": -3.3, "episode_reward_min": -57.50000000000007, "episode_reward_mean": -12.147, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -34.2, -10.399999999999999, -13.0, -14.899999999999999, -13.799999999999999, -21.200000000000003, -14.799999999999999, -4.4, -4.2, -9.799999999999999, -3.3, -14.6, -16.1, -5.6000000000000005, -11.999999999999998, -17.2, -19.4, -12.599999999999998, -6.299999999999999, -8.1, -19.200000000000003, -25.3, -5.2, -8.499999999999996, -4.2, -12.399999999999995, -3.4, -7.399999999999999, -17.4, -3.7000000000000006, -5.1000000000000005, -6.300000000000001, -4.300000000000001, -19.6, -6.4, -12.5, -21.5, -8.3, -5.2, -9.8, -11.1, -18.3, -11.2, -14.099999999999996, -7.999999999999998, -27.3, -14.8, -19.5, -5.300000000000001, -4.4, -5.2, -10.5, -13.1, -18.9, -21.100000000000048, -5.2, -15.799999999999999, -24.000000000000025, -4.2, -8.999999999999996, -5.300000000000001, -17.0, -11.1, -16.099999999999998, -20.3, -21.000000000000004, -3.3, -23.699999999999996, -14.9, -12.5, -4.300000000000001, -12.099999999999985, -5.4, -4.300000000000001, -4.4, -15.499999999999998, -10.1, -57.50000000000007, -9.799999999999997, -8.1, -8.9, -9.799999999999999, -3.3, -9.2, -8.2, -6.300000000000001, -13.2, -16.999999999999993, -13.899999999999999, -9.2, -4.9, -16.099999999999994, -4.3, -11.199999999999998, -26.800000000000008, -10.0, -6.2, -12.3, -20.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.152938126095267, "mean_inference_ms": 13.36605874817266, "mean_action_processing_ms": 0.1144029992578467, "mean_env_wait_ms": 31.996277440616314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1840000, "timesteps_this_iter": 0, "agent_timesteps_total": 1840000, "timers": {"sample_time_ms": 54845.381, "sample_throughput": 72.932, "load_time_ms": 3.261, "load_throughput": 1226584.004, "learn_time_ms": 26395.07, "learn_throughput": 151.543, "update_time_ms": 5.178}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 0.1490419381939035, "policy_loss": -0.012646093026244191, "vf_loss": 16.15344031395451, "vf_explained_var": 0.2746022288517285, "kl": 0.0075697817047187445, "entropy": 0.1695580567804075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1840000, "num_agent_steps_sampled": 1840000, "num_steps_trained": 1840000, "num_agent_steps_trained": 1840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18400, "training_iteration": 460, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-04-38", "timestamp": 1643702678, "time_this_iter_s": 59.792490005493164, "time_total_s": 37339.12960743904, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37339.12960743904, "timesteps_since_restore": 0, "iterations_since_restore": 460, "perf": {"cpu_util_percent": 45.20588235294118, "ram_util_percent": 70.71176470588239}}
{"episode_reward_max": -3.2, "episode_reward_min": -57.50000000000007, "episode_reward_mean": -12.733000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.8, -11.1, -18.3, -11.2, -14.099999999999996, -7.999999999999998, -27.3, -14.8, -19.5, -5.300000000000001, -4.4, -5.2, -10.5, -13.1, -18.9, -21.100000000000048, -5.2, -15.799999999999999, -24.000000000000025, -4.2, -8.999999999999996, -5.300000000000001, -17.0, -11.1, -16.099999999999998, -20.3, -21.000000000000004, -3.3, -23.699999999999996, -14.9, -12.5, -4.300000000000001, -12.099999999999985, -5.4, -4.300000000000001, -4.4, -15.499999999999998, -10.1, -57.50000000000007, -9.799999999999997, -8.1, -8.9, -9.799999999999999, -3.3, -9.2, -8.2, -6.300000000000001, -13.2, -16.999999999999993, -13.899999999999999, -9.2, -4.9, -16.099999999999994, -4.3, -11.199999999999998, -26.800000000000008, -10.0, -6.2, -12.3, -20.3, -12.3, -5.4, -10.7, -15.7, -11.399999999999999, -6.0, -5.2, -5.2, -17.099999999999998, -5.4, -10.0, -4.4, -14.699999999999992, -10.1, -20.3, -22.99999999999997, -11.6, -14.2, -6.3, -14.7, -20.100000000000012, -12.100000000000001, -3.2, -7.3999999999999995, -5.2, -6.300000000000001, -8.8, -4.2, -13.6, -44.90000000000002, -18.5, -6.999999999999999, -7.199999999999999, -24.9, -4.4, -15.299999999999999, -4.2, -53.2, -9.399999999999999, -21.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1489449838737515, "mean_inference_ms": 13.346415230437996, "mean_action_processing_ms": 0.11469307380581986, "mean_env_wait_ms": 31.97608253088548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1844000, "timesteps_this_iter": 0, "agent_timesteps_total": 1844000, "timers": {"sample_time_ms": 55354.411, "sample_throughput": 72.262, "load_time_ms": 3.262, "load_throughput": 1226386.749, "learn_time_ms": 26377.081, "learn_throughput": 151.647, "update_time_ms": 5.186}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 0.2522713099924287, "policy_loss": -0.013599946281762533, "vf_loss": 26.561322336491717, "vf_explained_var": 0.023808539746910013, "kl": 0.012713930003121746, "entropy": 0.19365665777235902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1844000, "num_agent_steps_sampled": 1844000, "num_steps_trained": 1844000, "num_agent_steps_trained": 1844000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18440, "training_iteration": 461, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-05-36", "timestamp": 1643702736, "time_this_iter_s": 58.06017184257507, "time_total_s": 37397.189779281616, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37397.189779281616, "timesteps_since_restore": 0, "iterations_since_restore": 461, "perf": {"cpu_util_percent": 44.765853658536585, "ram_util_percent": 70.84146341463415}}
{"episode_reward_max": -2.3, "episode_reward_min": -53.2, "episode_reward_mean": -11.675999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.1, -8.9, -9.799999999999999, -3.3, -9.2, -8.2, -6.300000000000001, -13.2, -16.999999999999993, -13.899999999999999, -9.2, -4.9, -16.099999999999994, -4.3, -11.199999999999998, -26.800000000000008, -10.0, -6.2, -12.3, -20.3, -12.3, -5.4, -10.7, -15.7, -11.399999999999999, -6.0, -5.2, -5.2, -17.099999999999998, -5.4, -10.0, -4.4, -14.699999999999992, -10.1, -20.3, -22.99999999999997, -11.6, -14.2, -6.3, -14.7, -20.100000000000012, -12.100000000000001, -3.2, -7.3999999999999995, -5.2, -6.300000000000001, -8.8, -4.2, -13.6, -44.90000000000002, -18.5, -6.999999999999999, -7.199999999999999, -24.9, -4.4, -15.299999999999999, -4.2, -53.2, -9.399999999999999, -21.099999999999998, -10.7, -8.2, -14.6, -12.5, -4.4, -7.099999999999998, -19.799999999999972, -6.6, -3.3, -11.2, -7.2, -5.300000000000001, -6.2, -7.300000000000001, -18.8, -2.3, -4.4, -10.6, -2.6000000000000005, -5.300000000000001, -8.3, -11.3, -15.69999999999999, -9.2, -19.4, -12.3, -23.3, -8.7, -42.5, -3.3, -25.700000000000003, -8.3, -5.4, -14.799999999999999, -14.899999999999993, -15.3, -6.1, -5.9, -4.300000000000001, -10.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.145132957063088, "mean_inference_ms": 13.327033047201763, "mean_action_processing_ms": 0.1149816829059967, "mean_env_wait_ms": 31.957169985013255, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1848000, "timesteps_this_iter": 0, "agent_timesteps_total": 1848000, "timers": {"sample_time_ms": 56745.664, "sample_throughput": 70.49, "load_time_ms": 3.34, "load_throughput": 1197713.829, "learn_time_ms": 27205.986, "learn_throughput": 147.026, "update_time_ms": 5.166}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.020295756409177558, "cur_lr": 0.00010000000000000003, "total_loss": 0.10355518628312375, "policy_loss": -0.018236918923675374, "vf_loss": 12.132950395345688, "vf_explained_var": 0.14001688425258924, "kl": 0.022793254380208305, "entropy": 0.19516221358571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1848000, "num_agent_steps_sampled": 1848000, "num_steps_trained": 1848000, "num_agent_steps_trained": 1848000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18480, "training_iteration": 462, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-06-37", "timestamp": 1643702797, "time_this_iter_s": 61.46573090553284, "time_total_s": 37458.65551018715, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37458.65551018715, "timesteps_since_restore": 0, "iterations_since_restore": 462, "perf": {"cpu_util_percent": 46.132183908045974, "ram_util_percent": 70.88045977011491}}
{"episode_reward_max": -2.2, "episode_reward_min": -53.2, "episode_reward_mean": -11.749, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.100000000000012, -12.100000000000001, -3.2, -7.3999999999999995, -5.2, -6.300000000000001, -8.8, -4.2, -13.6, -44.90000000000002, -18.5, -6.999999999999999, -7.199999999999999, -24.9, -4.4, -15.299999999999999, -4.2, -53.2, -9.399999999999999, -21.099999999999998, -10.7, -8.2, -14.6, -12.5, -4.4, -7.099999999999998, -19.799999999999972, -6.6, -3.3, -11.2, -7.2, -5.300000000000001, -6.2, -7.300000000000001, -18.8, -2.3, -4.4, -10.6, -2.6000000000000005, -5.300000000000001, -8.3, -11.3, -15.69999999999999, -9.2, -19.4, -12.3, -23.3, -8.7, -42.5, -3.3, -25.700000000000003, -8.3, -5.4, -14.799999999999999, -14.899999999999993, -15.3, -6.1, -5.9, -4.300000000000001, -10.599999999999998, -16.9, -17.2, -20.100000000000005, -21.099999999999998, -2.2, -11.799999999999997, -19.700000000000003, -11.3, -4.2, -16.599999999999998, -5.300000000000001, -9.4, -13.0, -9.899999999999999, -13.999999999999991, -16.1, -10.099999999999998, -7.4, -13.0, -4.300000000000001, -15.4, -6.8999999999999995, -4.2, -6.2, -8.399999999999999, -4.2, -16.9, -10.9, -15.8, -16.3, -9.299999999999999, -11.8, -4.9, -8.3, -14.399999999999995, -13.3, -5.2, -7.2, -12.2, -14.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.141275133103239, "mean_inference_ms": 13.307670078227794, "mean_action_processing_ms": 0.11526566454203056, "mean_env_wait_ms": 31.937789440664037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1852000, "timesteps_this_iter": 0, "agent_timesteps_total": 1852000, "timers": {"sample_time_ms": 58008.362, "sample_throughput": 68.956, "load_time_ms": 3.369, "load_throughput": 1187296.789, "learn_time_ms": 27247.841, "learn_throughput": 146.801, "update_time_ms": 5.272}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.07176917056723307, "policy_loss": -0.008513380575083917, "vf_loss": 7.99459562634909, "vf_explained_var": 0.2554597767450476, "kl": 0.011056441834477529, "entropy": 0.19853686653478173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1852000, "num_agent_steps_sampled": 1852000, "num_steps_trained": 1852000, "num_agent_steps_trained": 1852000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18520, "training_iteration": 463, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-07-35", "timestamp": 1643702855, "time_this_iter_s": 57.76315498352051, "time_total_s": 37516.41866517067, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37516.41866517067, "timesteps_since_restore": 0, "iterations_since_restore": 463, "perf": {"cpu_util_percent": 45.828048780487805, "ram_util_percent": 70.57317073170732}}
{"episode_reward_max": -2.2, "episode_reward_min": -88.0, "episode_reward_mean": -11.671, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.3, -11.3, -15.69999999999999, -9.2, -19.4, -12.3, -23.3, -8.7, -42.5, -3.3, -25.700000000000003, -8.3, -5.4, -14.799999999999999, -14.899999999999993, -15.3, -6.1, -5.9, -4.300000000000001, -10.599999999999998, -16.9, -17.2, -20.100000000000005, -21.099999999999998, -2.2, -11.799999999999997, -19.700000000000003, -11.3, -4.2, -16.599999999999998, -5.300000000000001, -9.4, -13.0, -9.899999999999999, -13.999999999999991, -16.1, -10.099999999999998, -7.4, -13.0, -4.300000000000001, -15.4, -6.8999999999999995, -4.2, -6.2, -8.399999999999999, -4.2, -16.9, -10.9, -15.8, -16.3, -9.299999999999999, -11.8, -4.9, -8.3, -14.399999999999995, -13.3, -5.2, -7.2, -12.2, -14.8, -4.2, -14.599999999999998, -17.2, -6.5, -9.0, -4.300000000000001, -19.0, -4.300000000000001, -14.600000000000001, -9.7, -6.300000000000001, -20.400000000000002, -28.2, -14.799999999999999, -9.5, -20.3, -5.300000000000001, -10.9, -6.5, -6.2, -4.300000000000001, -7.300000000000001, -4.6000000000000005, -5.2, -11.899999999999999, -4.4, -7.2, -7.300000000000001, -88.0, -8.2, -5.1000000000000005, -4.300000000000001, -4.300000000000001, -6.2, -19.20000000000003, -5.300000000000001, -4.300000000000001, -5.4, -12.999999999999998, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.137298948791082, "mean_inference_ms": 13.288363684678515, "mean_action_processing_ms": 0.11555675227495854, "mean_env_wait_ms": 31.91871030878742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1856000, "timesteps_this_iter": 0, "agent_timesteps_total": 1856000, "timers": {"sample_time_ms": 58573.52, "sample_throughput": 68.29, "load_time_ms": 3.374, "load_throughput": 1185635.459, "learn_time_ms": 27307.326, "learn_throughput": 146.481, "update_time_ms": 5.381}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.3783024963997905, "policy_loss": -0.012099833756945627, "vf_loss": 39.010423748083014, "vf_explained_var": 0.11065767080553117, "kl": 0.009792014126187716, "entropy": 0.1988899264124132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1856000, "num_agent_steps_sampled": 1856000, "num_steps_trained": 1856000, "num_agent_steps_trained": 1856000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18560, "training_iteration": 464, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-08-34", "timestamp": 1643702914, "time_this_iter_s": 59.15412139892578, "time_total_s": 37575.572786569595, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37575.572786569595, "timesteps_since_restore": 0, "iterations_since_restore": 464, "perf": {"cpu_util_percent": 44.24939759036145, "ram_util_percent": 70.70843373493976}}
{"episode_reward_max": -3.3, "episode_reward_min": -88.0, "episode_reward_mean": -12.032, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.4, -6.8999999999999995, -4.2, -6.2, -8.399999999999999, -4.2, -16.9, -10.9, -15.8, -16.3, -9.299999999999999, -11.8, -4.9, -8.3, -14.399999999999995, -13.3, -5.2, -7.2, -12.2, -14.8, -4.2, -14.599999999999998, -17.2, -6.5, -9.0, -4.300000000000001, -19.0, -4.300000000000001, -14.600000000000001, -9.7, -6.300000000000001, -20.400000000000002, -28.2, -14.799999999999999, -9.5, -20.3, -5.300000000000001, -10.9, -6.5, -6.2, -4.300000000000001, -7.300000000000001, -4.6000000000000005, -5.2, -11.899999999999999, -4.4, -7.2, -7.300000000000001, -88.0, -8.2, -5.1000000000000005, -4.300000000000001, -4.300000000000001, -6.2, -19.20000000000003, -5.300000000000001, -4.300000000000001, -5.4, -12.999999999999998, -4.300000000000001, -13.799999999999999, -8.599999999999998, -11.999999999999998, -14.2, -6.8, -15.7, -15.5, -6.2, -14.2, -13.0, -9.899999999999999, -3.3, -8.499999999999998, -6.1, -15.7, -14.599999999999998, -15.099999999999998, -14.4, -8.8, -5.000000000000001, -10.1, -21.799999999999997, -81.59999999999997, -15.3, -11.999999999999998, -6.1000000000000005, -7.1, -19.500000000000004, -10.0, -4.300000000000001, -11.799999999999999, -13.899999999999999, -4.4, -7.2, -18.400000000000002, -26.500000000000004, -28.200000000000024, -4.2, -16.9, -4.300000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.133003114275493, "mean_inference_ms": 13.268986082419278, "mean_action_processing_ms": 0.11583822393572998, "mean_env_wait_ms": 31.89885184977217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1860000, "timesteps_this_iter": 0, "agent_timesteps_total": 1860000, "timers": {"sample_time_ms": 59075.507, "sample_throughput": 67.71, "load_time_ms": 3.375, "load_throughput": 1185283.653, "learn_time_ms": 27357.548, "learn_throughput": 146.212, "update_time_ms": 5.479}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.3574862267075968, "policy_loss": -0.016973470706212263, "vf_loss": 37.396011213333374, "vf_explained_var": 0.06188208576171629, "kl": 0.016410414473738918, "entropy": 0.21237011625561664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1860000, "num_agent_steps_sampled": 1860000, "num_steps_trained": 1860000, "num_agent_steps_trained": 1860000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18600, "training_iteration": 465, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-09-32", "timestamp": 1643702972, "time_this_iter_s": 57.49274706840515, "time_total_s": 37633.065533638, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37633.065533638, "timesteps_since_restore": 0, "iterations_since_restore": 465, "perf": {"cpu_util_percent": 45.03536585365854, "ram_util_percent": 70.71707317073172}}
{"episode_reward_max": -2.2, "episode_reward_min": -88.0, "episode_reward_mean": -12.443000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -7.300000000000001, -4.6000000000000005, -5.2, -11.899999999999999, -4.4, -7.2, -7.300000000000001, -88.0, -8.2, -5.1000000000000005, -4.300000000000001, -4.300000000000001, -6.2, -19.20000000000003, -5.300000000000001, -4.300000000000001, -5.4, -12.999999999999998, -4.300000000000001, -13.799999999999999, -8.599999999999998, -11.999999999999998, -14.2, -6.8, -15.7, -15.5, -6.2, -14.2, -13.0, -9.899999999999999, -3.3, -8.499999999999998, -6.1, -15.7, -14.599999999999998, -15.099999999999998, -14.4, -8.8, -5.000000000000001, -10.1, -21.799999999999997, -81.59999999999997, -15.3, -11.999999999999998, -6.1000000000000005, -7.1, -19.500000000000004, -10.0, -4.300000000000001, -11.799999999999999, -13.899999999999999, -4.4, -7.2, -18.400000000000002, -26.500000000000004, -28.200000000000024, -4.2, -16.9, -4.300000000000001, -4.700000000000001, -6.5, -15.799999999999997, -3.2, -5.4, -15.599999999999998, -15.6, -5.4, -18.2, -11.600000000000001, -3.2, -34.4, -7.1999999999999975, -9.499999999999998, -8.899999999999999, -15.4, -13.700000000000001, -4.300000000000001, -3.3, -16.6, -23.000000000000025, -3.3, -16.5, -18.900000000000006, -26.9, -11.7, -19.999999999999996, -17.599999999999998, -5.799999999999999, -23.6, -19.2, -4.3, -4.4, -11.6, -19.199999999999996, -11.3, -4.300000000000001, -7.300000000000001, -2.2, -9.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.129309655899337, "mean_inference_ms": 13.249842457104142, "mean_action_processing_ms": 0.11612343428609324, "mean_env_wait_ms": 31.879805299764886, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1864000, "timesteps_this_iter": 0, "agent_timesteps_total": 1864000, "timers": {"sample_time_ms": 59643.783, "sample_throughput": 67.065, "load_time_ms": 3.377, "load_throughput": 1184513.76, "learn_time_ms": 27512.72, "learn_throughput": 145.387, "update_time_ms": 5.409}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.11803828432194648, "policy_loss": -0.012471443233430706, "vf_loss": 13.014689466132912, "vf_explained_var": 0.23261813502157888, "kl": 0.011918247240525703, "entropy": 0.19653515975962402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1864000, "num_agent_steps_sampled": 1864000, "num_steps_trained": 1864000, "num_agent_steps_trained": 1864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18640, "training_iteration": 466, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-10-32", "timestamp": 1643703032, "time_this_iter_s": 60.46565508842468, "time_total_s": 37693.531188726425, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37693.531188726425, "timesteps_since_restore": 0, "iterations_since_restore": 466, "perf": {"cpu_util_percent": 41.424418604651166, "ram_util_percent": 70.57209302325582}}
{"episode_reward_max": -2.2, "episode_reward_min": -81.59999999999997, "episode_reward_mean": -12.525, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -21.799999999999997, -81.59999999999997, -15.3, -11.999999999999998, -6.1000000000000005, -7.1, -19.500000000000004, -10.0, -4.300000000000001, -11.799999999999999, -13.899999999999999, -4.4, -7.2, -18.400000000000002, -26.500000000000004, -28.200000000000024, -4.2, -16.9, -4.300000000000001, -4.700000000000001, -6.5, -15.799999999999997, -3.2, -5.4, -15.599999999999998, -15.6, -5.4, -18.2, -11.600000000000001, -3.2, -34.4, -7.1999999999999975, -9.499999999999998, -8.899999999999999, -15.4, -13.700000000000001, -4.300000000000001, -3.3, -16.6, -23.000000000000025, -3.3, -16.5, -18.900000000000006, -26.9, -11.7, -19.999999999999996, -17.599999999999998, -5.799999999999999, -23.6, -19.2, -4.3, -4.4, -11.6, -19.199999999999996, -11.3, -4.300000000000001, -7.300000000000001, -2.2, -9.9, -5.6, -8.799999999999999, -10.4, -6.4, -13.9, -9.2, -14.3, -12.700000000000001, -5.1, -3.3, -5.5, -15.499999999999998, -7.2, -22.4, -8.700000000000001, -5.2, -11.299999999999999, -22.799999999999997, -7.9, -12.099999999999998, -11.799999999999997, -13.1, -4.2, -10.3, -11.2, -9.899999999999997, -20.799999999999997, -3.2, -13.2, -4.8999999999999995, -10.600000000000001, -6.499999999999999, -12.2, -19.100000000000016, -18.0, -12.1, -7.4, -13.3, -12.699999999999998, -26.59999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.126225545565967, "mean_inference_ms": 13.230822295311196, "mean_action_processing_ms": 0.11640291499211958, "mean_env_wait_ms": 31.860747427860197, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1868000, "timesteps_this_iter": 0, "agent_timesteps_total": 1868000, "timers": {"sample_time_ms": 59753.823, "sample_throughput": 66.941, "load_time_ms": 1.335, "load_throughput": 2996466.512, "learn_time_ms": 27363.527, "learn_throughput": 146.18, "update_time_ms": 5.42}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.09502206451650108, "policy_loss": 0.0023153962787761484, "vf_loss": 9.232416564418424, "vf_explained_var": 0.2601534369812217, "kl": 0.012564370076502015, "entropy": 0.21167638652747678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1868000, "num_agent_steps_sampled": 1868000, "num_steps_trained": 1868000, "num_agent_steps_trained": 1868000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18680, "training_iteration": 467, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-11-32", "timestamp": 1643703092, "time_this_iter_s": 59.41068983078003, "time_total_s": 37752.941878557205, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37752.941878557205, "timesteps_since_restore": 0, "iterations_since_restore": 467, "perf": {"cpu_util_percent": 45.61547619047619, "ram_util_percent": 70.58452380952382}}
{"episode_reward_max": -2.2, "episode_reward_min": -26.9, "episode_reward_mean": -11.210999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.000000000000025, -3.3, -16.5, -18.900000000000006, -26.9, -11.7, -19.999999999999996, -17.599999999999998, -5.799999999999999, -23.6, -19.2, -4.3, -4.4, -11.6, -19.199999999999996, -11.3, -4.300000000000001, -7.300000000000001, -2.2, -9.9, -5.6, -8.799999999999999, -10.4, -6.4, -13.9, -9.2, -14.3, -12.700000000000001, -5.1, -3.3, -5.5, -15.499999999999998, -7.2, -22.4, -8.700000000000001, -5.2, -11.299999999999999, -22.799999999999997, -7.9, -12.099999999999998, -11.799999999999997, -13.1, -4.2, -10.3, -11.2, -9.899999999999997, -20.799999999999997, -3.2, -13.2, -4.8999999999999995, -10.600000000000001, -6.499999999999999, -12.2, -19.100000000000016, -18.0, -12.1, -7.4, -13.3, -12.699999999999998, -26.59999999999997, -6.2, -4.3, -13.59999999999999, -5.2, -12.2, -6.300000000000001, -3.2, -20.800000000000004, -20.300000000000004, -25.3, -12.899999999999999, -18.3, -8.3, -3.3, -10.3, -3.3, -10.2, -3.3, -5.2, -4.2, -4.300000000000001, -19.400000000000002, -10.2, -13.899999999999993, -10.2, -11.3, -12.799999999999999, -17.7, -16.3, -13.3, -23.30000000000002, -3.2, -14.3, -4.700000000000001, -6.1, -5.2, -9.8, -3.7, -5.300000000000001, -9.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.122948988956958, "mean_inference_ms": 13.211903931898666, "mean_action_processing_ms": 0.11668202750983285, "mean_env_wait_ms": 31.84224051481819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1872000, "timesteps_this_iter": 0, "agent_timesteps_total": 1872000, "timers": {"sample_time_ms": 59414.531, "sample_throughput": 67.324, "load_time_ms": 1.338, "load_throughput": 2990644.397, "learn_time_ms": 27221.112, "learn_throughput": 146.945, "update_time_ms": 5.432}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.07765474624103136, "policy_loss": -0.010376770517999127, "vf_loss": 8.776563007729028, "vf_explained_var": 0.3880173926712364, "kl": 0.008733788813748918, "entropy": 0.19842990535081073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1872000, "num_agent_steps_sampled": 1872000, "num_steps_trained": 1872000, "num_agent_steps_trained": 1872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18720, "training_iteration": 468, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-12-31", "timestamp": 1643703151, "time_this_iter_s": 59.09745693206787, "time_total_s": 37812.03933548927, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37812.03933548927, "timesteps_since_restore": 0, "iterations_since_restore": 468, "perf": {"cpu_util_percent": 44.159036144578316, "ram_util_percent": 70.48313253012046}}
{"episode_reward_max": -3.2, "episode_reward_min": -26.59999999999997, "episode_reward_mean": -10.98, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.799999999999997, -13.1, -4.2, -10.3, -11.2, -9.899999999999997, -20.799999999999997, -3.2, -13.2, -4.8999999999999995, -10.600000000000001, -6.499999999999999, -12.2, -19.100000000000016, -18.0, -12.1, -7.4, -13.3, -12.699999999999998, -26.59999999999997, -6.2, -4.3, -13.59999999999999, -5.2, -12.2, -6.300000000000001, -3.2, -20.800000000000004, -20.300000000000004, -25.3, -12.899999999999999, -18.3, -8.3, -3.3, -10.3, -3.3, -10.2, -3.3, -5.2, -4.2, -4.300000000000001, -19.400000000000002, -10.2, -13.899999999999993, -10.2, -11.3, -12.799999999999999, -17.7, -16.3, -13.3, -23.30000000000002, -3.2, -14.3, -4.700000000000001, -6.1, -5.2, -9.8, -3.7, -5.300000000000001, -9.0, -3.2, -8.1, -16.099999999999998, -16.3, -8.7, -4.4, -14.1, -10.0, -15.199999999999998, -3.2, -12.799999999999999, -12.0, -12.3, -14.699999999999994, -9.499999999999998, -15.1, -13.199999999999996, -3.2, -7.099999999999998, -3.3, -18.800000000000004, -6.300000000000001, -7.6, -17.700000000000003, -9.2, -9.2, -21.699999999999996, -8.799999999999999, -12.2, -4.4, -12.299999999999995, -9.3, -14.299999999999997, -19.400000000000002, -14.3, -4.2, -23.3, -10.2, -5.1, -15.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.118913453716885, "mean_inference_ms": 13.19260591586553, "mean_action_processing_ms": 0.11693498613190144, "mean_env_wait_ms": 31.821126513551558, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1876000, "timesteps_this_iter": 0, "agent_timesteps_total": 1876000, "timers": {"sample_time_ms": 58855.724, "sample_throughput": 67.963, "load_time_ms": 1.299, "load_throughput": 3078275.293, "learn_time_ms": 27108.127, "learn_throughput": 147.557, "update_time_ms": 5.313}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.08861633534893713, "policy_loss": 0.0033186977268547142, "vf_loss": 8.509916232990962, "vf_explained_var": 0.3441968081458922, "kl": 0.006519477160433096, "entropy": 0.20482691478344703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1876000, "num_agent_steps_sampled": 1876000, "num_steps_trained": 1876000, "num_agent_steps_trained": 1876000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18760, "training_iteration": 469, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-13-25", "timestamp": 1643703205, "time_this_iter_s": 54.00436997413635, "time_total_s": 37866.04370546341, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37866.04370546341, "timesteps_since_restore": 0, "iterations_since_restore": 469, "perf": {"cpu_util_percent": 31.483116883116885, "ram_util_percent": 70.46493506493506}}
{"episode_reward_max": -3.2, "episode_reward_min": -132.3, "episode_reward_mean": -12.524000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -19.400000000000002, -10.2, -13.899999999999993, -10.2, -11.3, -12.799999999999999, -17.7, -16.3, -13.3, -23.30000000000002, -3.2, -14.3, -4.700000000000001, -6.1, -5.2, -9.8, -3.7, -5.300000000000001, -9.0, -3.2, -8.1, -16.099999999999998, -16.3, -8.7, -4.4, -14.1, -10.0, -15.199999999999998, -3.2, -12.799999999999999, -12.0, -12.3, -14.699999999999994, -9.499999999999998, -15.1, -13.199999999999996, -3.2, -7.099999999999998, -3.3, -18.800000000000004, -6.300000000000001, -7.6, -17.700000000000003, -9.2, -9.2, -21.699999999999996, -8.799999999999999, -12.2, -4.4, -12.299999999999995, -9.3, -14.299999999999997, -19.400000000000002, -14.3, -4.2, -23.3, -10.2, -5.1, -15.4, -14.999999999999996, -19.5, -8.2, -8.2, -4.300000000000001, -18.3, -10.499999999999996, -12.8, -6.8, -7.2, -12.099999999999998, -7.099999999999998, -12.7, -5.800000000000001, -4.300000000000001, -3.2, -14.1, -11.2, -5.5, -5.2, -9.9, -3.3, -10.2, -10.899999999999999, -5.000000000000001, -17.2, -32.50000000000001, -12.600000000000001, -15.299999999999999, -3.4, -5.300000000000001, -132.3, -10.599999999999987, -16.0, -10.1, -53.1, -24.00000000000001, -9.2, -9.099999999999996, -10.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.114583818598848, "mean_inference_ms": 13.172919538123402, "mean_action_processing_ms": 0.11716576952233172, "mean_env_wait_ms": 31.7974027375191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1880000, "timesteps_this_iter": 0, "agent_timesteps_total": 1880000, "timers": {"sample_time_ms": 58280.78, "sample_throughput": 68.633, "load_time_ms": 1.303, "load_throughput": 3068815.804, "learn_time_ms": 27124.273, "learn_throughput": 147.469, "update_time_ms": 5.298}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.9475485151883976, "policy_loss": -0.013640323094522922, "vf_loss": 96.08676800381753, "vf_explained_var": 0.12705807890943302, "kl": 0.010550263146347362, "entropy": 0.24821313452977006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1880000, "num_agent_steps_sampled": 1880000, "num_steps_trained": 1880000, "num_agent_steps_trained": 1880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18800, "training_iteration": 470, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-14-21", "timestamp": 1643703261, "time_this_iter_s": 55.31071996688843, "time_total_s": 37921.3544254303, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37921.3544254303, "timesteps_since_restore": 0, "iterations_since_restore": 470, "perf": {"cpu_util_percent": 37.59871794871794, "ram_util_percent": 70.524358974359}}
{"episode_reward_max": -2.2, "episode_reward_min": -132.3, "episode_reward_mean": -12.491, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.800000000000004, -6.300000000000001, -7.6, -17.700000000000003, -9.2, -9.2, -21.699999999999996, -8.799999999999999, -12.2, -4.4, -12.299999999999995, -9.3, -14.299999999999997, -19.400000000000002, -14.3, -4.2, -23.3, -10.2, -5.1, -15.4, -14.999999999999996, -19.5, -8.2, -8.2, -4.300000000000001, -18.3, -10.499999999999996, -12.8, -6.8, -7.2, -12.099999999999998, -7.099999999999998, -12.7, -5.800000000000001, -4.300000000000001, -3.2, -14.1, -11.2, -5.5, -5.2, -9.9, -3.3, -10.2, -10.899999999999999, -5.000000000000001, -17.2, -32.50000000000001, -12.600000000000001, -15.299999999999999, -3.4, -5.300000000000001, -132.3, -10.599999999999987, -16.0, -10.1, -53.1, -24.00000000000001, -9.2, -9.099999999999996, -10.2, -3.3, -4.300000000000001, -20.6, -3.3, -5.300000000000001, -9.7, -10.2, -12.5, -13.399999999999999, -9.0, -4.4, -13.099999999999985, -14.3, -16.4, -11.299999999999999, -2.2, -3.3, -3.3, -15.299999999999999, -2.2, -4.300000000000001, -11.2, -11.2, -3.7000000000000006, -11.899999999999999, -30.800000000000004, -4.3, -7.8, -4.2, -17.700000000000003, -23.800000000000008, -4.2, -16.9, -3.1, -22.4, -11.899999999999999, -10.2, -6.2, -7.3, -22.700000000000017], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.110009429951095, "mean_inference_ms": 13.153000794067252, "mean_action_processing_ms": 0.11737629554586404, "mean_env_wait_ms": 31.772095921208784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1884000, "timesteps_this_iter": 0, "agent_timesteps_total": 1884000, "timers": {"sample_time_ms": 57964.554, "sample_throughput": 69.008, "load_time_ms": 1.306, "load_throughput": 3063044.931, "learn_time_ms": 27079.095, "learn_throughput": 147.715, "update_time_ms": 5.258}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.1176198401318122, "policy_loss": -0.016273907451860366, "vf_loss": 13.350999742393853, "vf_explained_var": 0.28121097709542964, "kl": 0.012605504651012234, "entropy": 0.21295733402973863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1884000, "num_agent_steps_sampled": 1884000, "num_steps_trained": 1884000, "num_agent_steps_trained": 1884000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18840, "training_iteration": 471, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-15-15", "timestamp": 1643703315, "time_this_iter_s": 54.29231309890747, "time_total_s": 37975.646738529205, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37975.646738529205, "timesteps_since_restore": 0, "iterations_since_restore": 471, "perf": {"cpu_util_percent": 33.419480519480516, "ram_util_percent": 70.61038961038963}}
{"episode_reward_max": -2.2, "episode_reward_min": -132.3, "episode_reward_mean": -12.135999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.9, -3.3, -10.2, -10.899999999999999, -5.000000000000001, -17.2, -32.50000000000001, -12.600000000000001, -15.299999999999999, -3.4, -5.300000000000001, -132.3, -10.599999999999987, -16.0, -10.1, -53.1, -24.00000000000001, -9.2, -9.099999999999996, -10.2, -3.3, -4.300000000000001, -20.6, -3.3, -5.300000000000001, -9.7, -10.2, -12.5, -13.399999999999999, -9.0, -4.4, -13.099999999999985, -14.3, -16.4, -11.299999999999999, -2.2, -3.3, -3.3, -15.299999999999999, -2.2, -4.300000000000001, -11.2, -11.2, -3.7000000000000006, -11.899999999999999, -30.800000000000004, -4.3, -7.8, -4.2, -17.700000000000003, -23.800000000000008, -4.2, -16.9, -3.1, -22.4, -11.899999999999999, -10.2, -6.2, -7.3, -22.700000000000017, -11.5, -16.1, -8.3, -21.5, -3.4, -12.3, -7.0, -11.2, -14.899999999999984, -19.400000000000006, -7.9, -8.7, -5.4, -11.2, -13.0, -7.2, -15.799999999999997, -16.799999999999986, -9.699999999999998, -8.2, -3.9000000000000004, -4.2, -13.8, -15.2, -7.5, -5.3, -11.3, -7.3, -12.2, -9.3, -3.3, -4.300000000000001, -13.9, -6.1, -6.3, -7.3, -4.6000000000000005, -7.499999999999998, -23.1, -4.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.105319391857636, "mean_inference_ms": 13.133091615426403, "mean_action_processing_ms": 0.1175822960635791, "mean_env_wait_ms": 31.74633930816448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1888000, "timesteps_this_iter": 0, "agent_timesteps_total": 1888000, "timers": {"sample_time_ms": 57276.023, "sample_throughput": 69.837, "load_time_ms": 1.308, "load_throughput": 3059079.571, "learn_time_ms": 27019.745, "learn_throughput": 148.04, "update_time_ms": 5.187}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.053954226643808424, "policy_loss": -0.013003118332195026, "vf_loss": 6.667772140105566, "vf_explained_var": 0.2842893106963045, "kl": 0.009185090986305893, "entropy": 0.2475507264376007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1888000, "num_agent_steps_sampled": 1888000, "num_steps_trained": 1888000, "num_agent_steps_trained": 1888000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18880, "training_iteration": 472, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-16-09", "timestamp": 1643703369, "time_this_iter_s": 54.46175003051758, "time_total_s": 38030.10848855972, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38030.10848855972, "timesteps_since_restore": 0, "iterations_since_restore": 472, "perf": {"cpu_util_percent": 32.871428571428574, "ram_util_percent": 70.60909090909092}}
{"episode_reward_max": -1.3, "episode_reward_min": -30.800000000000004, "episode_reward_mean": -10.576999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -11.2, -11.2, -3.7000000000000006, -11.899999999999999, -30.800000000000004, -4.3, -7.8, -4.2, -17.700000000000003, -23.800000000000008, -4.2, -16.9, -3.1, -22.4, -11.899999999999999, -10.2, -6.2, -7.3, -22.700000000000017, -11.5, -16.1, -8.3, -21.5, -3.4, -12.3, -7.0, -11.2, -14.899999999999984, -19.400000000000006, -7.9, -8.7, -5.4, -11.2, -13.0, -7.2, -15.799999999999997, -16.799999999999986, -9.699999999999998, -8.2, -3.9000000000000004, -4.2, -13.8, -15.2, -7.5, -5.3, -11.3, -7.3, -12.2, -9.3, -3.3, -4.300000000000001, -13.9, -6.1, -6.3, -7.3, -4.6000000000000005, -7.499999999999998, -23.1, -4.3, -9.2, -12.5, -22.7, -3.4, -4.6000000000000005, -3.4, -12.2, -5.800000000000001, -22.099999999999998, -13.099999999999998, -25.1, -11.3, -2.5, -8.2, -4.300000000000001, -20.699999999999996, -15.999999999999998, -4.2, -8.599999999999998, -7.4, -7.2, -5.3, -4.300000000000001, -23.099999999999998, -3.2, -23.399999999999995, -15.2, -1.3, -21.200000000000003, -5.3, -10.100000000000001, -9.099999999999998, -14.0, -19.200000000000003, -7.4, -15.099999999999996, -6.1, -5.1000000000000005, -4.1, -4.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.100503264232962, "mean_inference_ms": 13.113291177115894, "mean_action_processing_ms": 0.11778353042763351, "mean_env_wait_ms": 31.720467332214472, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1892000, "timesteps_this_iter": 0, "agent_timesteps_total": 1892000, "timers": {"sample_time_ms": 56897.295, "sample_throughput": 70.302, "load_time_ms": 1.279, "load_throughput": 3127218.774, "learn_time_ms": 27031.928, "learn_throughput": 147.973, "update_time_ms": 5.099}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.107026254602768, "policy_loss": 0.0007219052573125209, "vf_loss": 10.604852900902431, "vf_explained_var": -0.010980106297359672, "kl": 0.008403198482842447, "entropy": 0.23250662770162348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1892000, "num_agent_steps_sampled": 1892000, "num_steps_trained": 1892000, "num_agent_steps_trained": 1892000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18920, "training_iteration": 473, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-17-04", "timestamp": 1643703424, "time_this_iter_s": 54.707733154296875, "time_total_s": 38084.81622171402, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38084.81622171402, "timesteps_since_restore": 0, "iterations_since_restore": 473, "perf": {"cpu_util_percent": 30.389743589743592, "ram_util_percent": 70.62948717948721}}
{"episode_reward_max": 0.0, "episode_reward_min": -25.1, "episode_reward_mean": -10.054, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -4.2, -13.8, -15.2, -7.5, -5.3, -11.3, -7.3, -12.2, -9.3, -3.3, -4.300000000000001, -13.9, -6.1, -6.3, -7.3, -4.6000000000000005, -7.499999999999998, -23.1, -4.3, -9.2, -12.5, -22.7, -3.4, -4.6000000000000005, -3.4, -12.2, -5.800000000000001, -22.099999999999998, -13.099999999999998, -25.1, -11.3, -2.5, -8.2, -4.300000000000001, -20.699999999999996, -15.999999999999998, -4.2, -8.599999999999998, -7.4, -7.2, -5.3, -4.300000000000001, -23.099999999999998, -3.2, -23.399999999999995, -15.2, -1.3, -21.200000000000003, -5.3, -10.100000000000001, -9.099999999999998, -14.0, -19.200000000000003, -7.4, -15.099999999999996, -6.1, -5.1000000000000005, -4.1, -4.7, -2.5, -18.900000000000006, -12.6, -3.3, -20.199999999999996, -18.9, -6.1000000000000005, -6.199999999999999, -15.799999999999999, -18.7, -18.800000000000004, -7.5, -4.4, -7.2, -8.099999999999998, 0.0, -13.099999999999998, -4.2, -7.2, -11.3, -4.200000000000001, -15.5, -17.199999999999996, -17.200000000000003, -5.300000000000001, -4.4, -7.3999999999999995, -10.2, -3.3, -5.2, -18.299999999999994, -4.300000000000001, -22.2, -6.300000000000001, -13.2, -6.2, -6.2, -14.099999999999998, -7.3, -20.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.095728356503434, "mean_inference_ms": 13.093536339318817, "mean_action_processing_ms": 0.11798183607532459, "mean_env_wait_ms": 31.694253925357334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1896000, "timesteps_this_iter": 0, "agent_timesteps_total": 1896000, "timers": {"sample_time_ms": 56336.33, "sample_throughput": 71.002, "load_time_ms": 1.272, "load_throughput": 3143979.162, "learn_time_ms": 27049.884, "learn_throughput": 147.875, "update_time_ms": 5.035}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.08720851999104164, "policy_loss": -0.0024076777790743176, "vf_loss": 8.927908875673047, "vf_explained_var": 0.3003633581182008, "kl": 0.01107330535269699, "entropy": 0.20735870412280483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1896000, "num_agent_steps_sampled": 1896000, "num_steps_trained": 1896000, "num_agent_steps_trained": 1896000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 18960, "training_iteration": 474, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-17-58", "timestamp": 1643703478, "time_this_iter_s": 53.637004137039185, "time_total_s": 38138.45322585106, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38138.45322585106, "timesteps_since_restore": 0, "iterations_since_restore": 474, "perf": {"cpu_util_percent": 26.082666666666665, "ram_util_percent": 70.7}}
{"episode_reward_max": 0.0, "episode_reward_min": -28.4, "episode_reward_mean": -10.516999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.2, -5.3, -4.300000000000001, -23.099999999999998, -3.2, -23.399999999999995, -15.2, -1.3, -21.200000000000003, -5.3, -10.100000000000001, -9.099999999999998, -14.0, -19.200000000000003, -7.4, -15.099999999999996, -6.1, -5.1000000000000005, -4.1, -4.7, -2.5, -18.900000000000006, -12.6, -3.3, -20.199999999999996, -18.9, -6.1000000000000005, -6.199999999999999, -15.799999999999999, -18.7, -18.800000000000004, -7.5, -4.4, -7.2, -8.099999999999998, 0.0, -13.099999999999998, -4.2, -7.2, -11.3, -4.200000000000001, -15.5, -17.199999999999996, -17.200000000000003, -5.300000000000001, -4.4, -7.3999999999999995, -10.2, -3.3, -5.2, -18.299999999999994, -4.300000000000001, -22.2, -6.300000000000001, -13.2, -6.2, -6.2, -14.099999999999998, -7.3, -20.0, -21.799999999999997, -14.999999999999998, -7.3, -17.7, -11.6, -10.8, -15.099999999999975, -12.799999999999997, -4.300000000000001, -19.500000000000004, -18.6, -4.3, -5.4, -5.8, -6.3, -5.000000000000001, -9.8, -8.100000000000001, -12.999999999999998, -7.2, -18.3, -3.6000000000000005, -5.3, -9.4, -12.5, -8.2, -4.3, -17.2, -28.4, -4.2, -11.5, -17.8, -3.4, -19.900000000000013, -10.399999999999999, -4.2, -12.499999999999998, -5.2, -4.700000000000001, -13.899999999999975], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.091200276870171, "mean_inference_ms": 13.073928670751474, "mean_action_processing_ms": 0.1181905957121546, "mean_env_wait_ms": 31.668801585267875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1900000, "timesteps_this_iter": 0, "agent_timesteps_total": 1900000, "timers": {"sample_time_ms": 56160.624, "sample_throughput": 71.224, "load_time_ms": 1.27, "load_throughput": 3150650.892, "learn_time_ms": 27039.845, "learn_throughput": 147.93, "update_time_ms": 4.889}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.08810281069093054, "policy_loss": -0.009222452856740483, "vf_loss": 9.701888037881544, "vf_explained_var": 0.2268062481316187, "kl": 0.010064053758479177, "entropy": 0.21987061397202554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1900000, "num_agent_steps_sampled": 1900000, "num_steps_trained": 1900000, "num_agent_steps_trained": 1900000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19000, "training_iteration": 475, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-18-53", "timestamp": 1643703533, "time_this_iter_s": 55.451606035232544, "time_total_s": 38193.90483188629, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38193.90483188629, "timesteps_since_restore": 0, "iterations_since_restore": 475, "perf": {"cpu_util_percent": 34.04683544303798, "ram_util_percent": 70.69873417721519}}
{"episode_reward_max": -3.2, "episode_reward_min": -51.2, "episode_reward_mean": -11.326999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -15.5, -17.199999999999996, -17.200000000000003, -5.300000000000001, -4.4, -7.3999999999999995, -10.2, -3.3, -5.2, -18.299999999999994, -4.300000000000001, -22.2, -6.300000000000001, -13.2, -6.2, -6.2, -14.099999999999998, -7.3, -20.0, -21.799999999999997, -14.999999999999998, -7.3, -17.7, -11.6, -10.8, -15.099999999999975, -12.799999999999997, -4.300000000000001, -19.500000000000004, -18.6, -4.3, -5.4, -5.8, -6.3, -5.000000000000001, -9.8, -8.100000000000001, -12.999999999999998, -7.2, -18.3, -3.6000000000000005, -5.3, -9.4, -12.5, -8.2, -4.3, -17.2, -28.4, -4.2, -11.5, -17.8, -3.4, -19.900000000000013, -10.399999999999999, -4.2, -12.499999999999998, -5.2, -4.700000000000001, -13.899999999999975, -3.4, -24.2, -12.2, -51.2, -5.300000000000001, -3.2, -8.299999999999999, -7.3, -20.999999999999993, -10.799999999999999, -18.3, -3.3, -11.3, -5.5, -8.3, -9.499999999999996, -3.6000000000000005, -19.799999999999997, -10.499999999999995, -4.2, -34.60000000000001, -14.7, -13.0, -15.299999999999999, -8.8, -4.2, -14.499999999999998, -13.2, -5.000000000000001, -15.799999999999999, -7.2, -11.399999999999997, -19.1, -15.799999999999999, -4.300000000000001, -4.2, -4.300000000000001, -17.800000000000004, -13.699999999999985, -12.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.086810999873444, "mean_inference_ms": 13.054435077637033, "mean_action_processing_ms": 0.11840145518039741, "mean_env_wait_ms": 31.64349837492884, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1904000, "timesteps_this_iter": 0, "agent_timesteps_total": 1904000, "timers": {"sample_time_ms": 55568.441, "sample_throughput": 71.983, "load_time_ms": 1.266, "load_throughput": 3159848.573, "learn_time_ms": 27071.881, "learn_throughput": 147.755, "update_time_ms": 4.904}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.2020858183070036, "policy_loss": -0.003114616434260081, "vf_loss": 20.499776187955693, "vf_explained_var": 0.12224173648383027, "kl": 0.00665739387794881, "entropy": 0.21374149378989973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1904000, "num_agent_steps_sampled": 1904000, "num_steps_trained": 1904000, "num_agent_steps_trained": 1904000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19040, "training_iteration": 476, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-19-48", "timestamp": 1643703588, "time_this_iter_s": 54.9336941242218, "time_total_s": 38248.83852601051, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38248.83852601051, "timesteps_since_restore": 0, "iterations_since_restore": 476, "perf": {"cpu_util_percent": 33.72435897435897, "ram_util_percent": 70.57179487179488}}
{"episode_reward_max": -2.2, "episode_reward_min": -167.89999999999975, "episode_reward_mean": -14.242999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.3, -3.6000000000000005, -5.3, -9.4, -12.5, -8.2, -4.3, -17.2, -28.4, -4.2, -11.5, -17.8, -3.4, -19.900000000000013, -10.399999999999999, -4.2, -12.499999999999998, -5.2, -4.700000000000001, -13.899999999999975, -3.4, -24.2, -12.2, -51.2, -5.300000000000001, -3.2, -8.299999999999999, -7.3, -20.999999999999993, -10.799999999999999, -18.3, -3.3, -11.3, -5.5, -8.3, -9.499999999999996, -3.6000000000000005, -19.799999999999997, -10.499999999999995, -4.2, -34.60000000000001, -14.7, -13.0, -15.299999999999999, -8.8, -4.2, -14.499999999999998, -13.2, -5.000000000000001, -15.799999999999999, -7.2, -11.399999999999997, -19.1, -15.799999999999999, -4.300000000000001, -4.2, -4.300000000000001, -17.800000000000004, -13.699999999999985, -12.299999999999999, -13.2, -11.399999999999999, -10.099999999999996, -3.8000000000000003, -3.8000000000000003, -22.399999999999977, -66.2, -10.799999999999999, -10.499999999999998, -16.4, -15.399999999999997, -11.1, -5.700000000000001, -11.9, -2.2, -11.699999999999996, -10.8, -4.700000000000001, -13.699999999999998, -74.50000000000006, -167.89999999999975, -7.899999999999998, -15.3, -7.699999999999999, -11.6, -11.3, -24.2, -7.2, -4.5, -14.4, -10.3, -13.999999999999977, -15.099999999999987, -3.2, -6.0, -4.300000000000001, -3.2, -16.3, -25.799999999999997, -18.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0826886581552655, "mean_inference_ms": 13.035092455349188, "mean_action_processing_ms": 0.1186113631782921, "mean_env_wait_ms": 31.618516118210128, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1908000, "timesteps_this_iter": 0, "agent_timesteps_total": 1908000, "timers": {"sample_time_ms": 55207.905, "sample_throughput": 72.453, "load_time_ms": 1.267, "load_throughput": 3158123.635, "learn_time_ms": 27053.015, "learn_throughput": 147.858, "update_time_ms": 4.875}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 1.7929912111829587, "policy_loss": -0.01250987880893292, "vf_loss": 180.50707379348816, "vf_explained_var": -0.18959443139773544, "kl": 0.014137324826016488, "entropy": 0.2467233753973438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1908000, "num_agent_steps_sampled": 1908000, "num_steps_trained": 1908000, "num_agent_steps_trained": 1908000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19080, "training_iteration": 477, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-20-44", "timestamp": 1643703644, "time_this_iter_s": 55.3086359500885, "time_total_s": 38304.1471619606, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38304.1471619606, "timesteps_since_restore": 0, "iterations_since_restore": 477, "perf": {"cpu_util_percent": 32.43589743589744, "ram_util_percent": 70.46153846153847}}
{"episode_reward_max": -2.2, "episode_reward_min": -167.89999999999975, "episode_reward_mean": -14.381999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.60000000000001, -14.7, -13.0, -15.299999999999999, -8.8, -4.2, -14.499999999999998, -13.2, -5.000000000000001, -15.799999999999999, -7.2, -11.399999999999997, -19.1, -15.799999999999999, -4.300000000000001, -4.2, -4.300000000000001, -17.800000000000004, -13.699999999999985, -12.299999999999999, -13.2, -11.399999999999999, -10.099999999999996, -3.8000000000000003, -3.8000000000000003, -22.399999999999977, -66.2, -10.799999999999999, -10.499999999999998, -16.4, -15.399999999999997, -11.1, -5.700000000000001, -11.9, -2.2, -11.699999999999996, -10.8, -4.700000000000001, -13.699999999999998, -74.50000000000006, -167.89999999999975, -7.899999999999998, -15.3, -7.699999999999999, -11.6, -11.3, -24.2, -7.2, -4.5, -14.4, -10.3, -13.999999999999977, -15.099999999999987, -3.2, -6.0, -4.300000000000001, -3.2, -16.3, -25.799999999999997, -18.5, -5.2, -8.499999999999998, -15.799999999999995, -12.7, -6.2, -7.199999999999998, -13.3, -9.3, -8.3, -5.2, -8.399999999999999, -9.2, -7.5, -15.3, -3.4, -10.3, -4.4, -4.2, -24.100000000000012, -4.2, -13.7, -3.3, -12.5, -8.899999999999999, -13.0, -13.799999999999999, -39.3, -46.69999999999996, -17.799999999999997, -14.0, -17.700000000000003, -4.2, -18.1, -8.1, -4.3, -9.599999999999998, -16.999999999999993, -11.2, -7.0, -7.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.07867211882541, "mean_inference_ms": 13.015853836648384, "mean_action_processing_ms": 0.11882313437095782, "mean_env_wait_ms": 31.593818009961137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1912000, "timesteps_this_iter": 0, "agent_timesteps_total": 1912000, "timers": {"sample_time_ms": 54721.393, "sample_throughput": 73.098, "load_time_ms": 1.264, "load_throughput": 3165333.283, "learn_time_ms": 27121.55, "learn_throughput": 147.484, "update_time_ms": 5.242}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.18537400869141904, "policy_loss": -0.01130391529320629, "vf_loss": 19.613798251972405, "vf_explained_var": 0.03027008714214448, "kl": 0.017735969715415436, "entropy": 0.24423529969187835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1912000, "num_agent_steps_sampled": 1912000, "num_steps_trained": 1912000, "num_agent_steps_trained": 1912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19120, "training_iteration": 478, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-21-39", "timestamp": 1643703699, "time_this_iter_s": 55.11359620094299, "time_total_s": 38359.260758161545, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38359.260758161545, "timesteps_since_restore": 0, "iterations_since_restore": 478, "perf": {"cpu_util_percent": 34.30128205128205, "ram_util_percent": 70.37435897435898}}
{"episode_reward_max": -3.2, "episode_reward_min": -167.89999999999975, "episode_reward_mean": -13.006999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.89999999999975, -7.899999999999998, -15.3, -7.699999999999999, -11.6, -11.3, -24.2, -7.2, -4.5, -14.4, -10.3, -13.999999999999977, -15.099999999999987, -3.2, -6.0, -4.300000000000001, -3.2, -16.3, -25.799999999999997, -18.5, -5.2, -8.499999999999998, -15.799999999999995, -12.7, -6.2, -7.199999999999998, -13.3, -9.3, -8.3, -5.2, -8.399999999999999, -9.2, -7.5, -15.3, -3.4, -10.3, -4.4, -4.2, -24.100000000000012, -4.2, -13.7, -3.3, -12.5, -8.899999999999999, -13.0, -13.799999999999999, -39.3, -46.69999999999996, -17.799999999999997, -14.0, -17.700000000000003, -4.2, -18.1, -8.1, -4.3, -9.599999999999998, -16.999999999999993, -11.2, -7.0, -7.1, -12.0, -14.6, -5.700000000000001, -14.999999999999972, -14.999999999999998, -4.2, -13.799999999999999, -6.8999999999999995, -20.900000000000045, -7.7, -31.400000000000002, -3.8000000000000003, -10.0, -4.3, -12.2, -8.9, -4.300000000000001, -8.3, -3.9000000000000004, -7.299999999999999, -33.4, -9.600000000000001, -13.5, -29.4, -4.3, -18.799999999999997, -6.300000000000001, -6.300000000000001, -10.3, -12.2, -8.3, -3.3, -3.4, -21.2, -3.4000000000000004, -11.199999999999996, -6.300000000000001, -21.900000000000016, -3.3, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.074735177271988, "mean_inference_ms": 12.996765360870452, "mean_action_processing_ms": 0.11903726176792723, "mean_env_wait_ms": 31.56996093924069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1916000, "timesteps_this_iter": 0, "agent_timesteps_total": 1916000, "timers": {"sample_time_ms": 54897.248, "sample_throughput": 72.863, "load_time_ms": 1.26, "load_throughput": 3174196.576, "learn_time_ms": 27201.905, "learn_throughput": 147.049, "update_time_ms": 5.301}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.13215223875707915, "policy_loss": -0.01492080740149944, "vf_loss": 14.670576762383984, "vf_explained_var": 0.14046063602611583, "kl": 0.012064220759242322, "entropy": 0.21644823693780488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1916000, "num_agent_steps_sampled": 1916000, "num_steps_trained": 1916000, "num_agent_steps_trained": 1916000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19160, "training_iteration": 479, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-22-35", "timestamp": 1643703755, "time_this_iter_s": 55.83187770843506, "time_total_s": 38415.09263586998, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38415.09263586998, "timesteps_since_restore": 0, "iterations_since_restore": 479, "perf": {"cpu_util_percent": 37.85443037974684, "ram_util_percent": 70.17848101265822}}
{"episode_reward_max": -1.3, "episode_reward_min": -107.2, "episode_reward_mean": -13.065999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.7, -3.3, -12.5, -8.899999999999999, -13.0, -13.799999999999999, -39.3, -46.69999999999996, -17.799999999999997, -14.0, -17.700000000000003, -4.2, -18.1, -8.1, -4.3, -9.599999999999998, -16.999999999999993, -11.2, -7.0, -7.1, -12.0, -14.6, -5.700000000000001, -14.999999999999972, -14.999999999999998, -4.2, -13.799999999999999, -6.8999999999999995, -20.900000000000045, -7.7, -31.400000000000002, -3.8000000000000003, -10.0, -4.3, -12.2, -8.9, -4.300000000000001, -8.3, -3.9000000000000004, -7.299999999999999, -33.4, -9.600000000000001, -13.5, -29.4, -4.3, -18.799999999999997, -6.300000000000001, -6.300000000000001, -10.3, -12.2, -8.3, -3.3, -3.4, -21.2, -3.4000000000000004, -11.199999999999996, -6.300000000000001, -21.900000000000016, -3.3, -5.4, -5.2, -19.800000000000004, -9.3, -12.499999999999998, -17.5, -20.299999999999986, -4.2, -15.999999999999998, -1.3, -91.8, -15.599999999999977, -3.3, -4.3, -12.600000000000001, -9.0, -4.2, -16.499999999999982, -19.20000000000003, -17.199999999999996, -14.0, -6.3, -5.2, -5.300000000000001, -3.3, -11.8, -4.2, -3.3, -11.599999999999998, -8.399999999999997, -6.8999999999999995, -25.69999999999999, -107.2, -3.4, -4.3, -5.300000000000001, -4.300000000000001, -10.199999999999998, -13.1, -11.599999999999998, -12.099999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.070572544510571, "mean_inference_ms": 12.97772011030505, "mean_action_processing_ms": 0.1192470576654107, "mean_env_wait_ms": 31.5462071605709, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1920000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 54974.914, "sample_throughput": 72.76, "load_time_ms": 1.257, "load_throughput": 3182747.33, "learn_time_ms": 27137.095, "learn_throughput": 147.4, "update_time_ms": 5.321}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 1.0382369888868803, "policy_loss": -0.013261459519465764, "vf_loss": 105.11063434462393, "vf_explained_var": 0.033457815326670165, "kl": 0.012880176507148997, "entropy": 0.21919084802189823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1920000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 1920000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19200, "training_iteration": 480, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-23-30", "timestamp": 1643703810, "time_this_iter_s": 54.6644606590271, "time_total_s": 38469.75709652901, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38469.75709652901, "timesteps_since_restore": 0, "iterations_since_restore": 480, "perf": {"cpu_util_percent": 34.506410256410255, "ram_util_percent": 70.34999999999997}}
{"episode_reward_max": -1.3, "episode_reward_min": -107.2, "episode_reward_mean": -12.133999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.4, -9.600000000000001, -13.5, -29.4, -4.3, -18.799999999999997, -6.300000000000001, -6.300000000000001, -10.3, -12.2, -8.3, -3.3, -3.4, -21.2, -3.4000000000000004, -11.199999999999996, -6.300000000000001, -21.900000000000016, -3.3, -5.4, -5.2, -19.800000000000004, -9.3, -12.499999999999998, -17.5, -20.299999999999986, -4.2, -15.999999999999998, -1.3, -91.8, -15.599999999999977, -3.3, -4.3, -12.600000000000001, -9.0, -4.2, -16.499999999999982, -19.20000000000003, -17.199999999999996, -14.0, -6.3, -5.2, -5.300000000000001, -3.3, -11.8, -4.2, -3.3, -11.599999999999998, -8.399999999999997, -6.8999999999999995, -25.69999999999999, -107.2, -3.4, -4.3, -5.300000000000001, -4.300000000000001, -10.199999999999998, -13.1, -11.599999999999998, -12.099999999999996, -2.6000000000000005, -15.799999999999997, -12.09999999999999, -5.0, -9.999999999999998, -4.2, -4.300000000000001, -13.499999999999998, -7.700000000000001, -6.1, -13.2, -4.3, -5.8999999999999995, -27.3, -11.899999999999995, -7.4, -3.2, -7.3, -23.900000000000006, -10.6, -5.1, -13.399999999999999, -8.2, -8.099999999999998, -7.699999999999999, -15.699999999999994, -17.1, -11.999999999999998, -19.6, -4.2, -20.1, -4.4, -18.400000000000002, -9.2, -5.300000000000001, -3.2, -5.0, -6.300000000000001, -8.3, -16.69999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.066371446708157, "mean_inference_ms": 12.958844646943458, "mean_action_processing_ms": 0.1194591978824739, "mean_env_wait_ms": 31.522994044065513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1924000, "timesteps_this_iter": 0, "agent_timesteps_total": 1924000, "timers": {"sample_time_ms": 55045.375, "sample_throughput": 72.667, "load_time_ms": 1.254, "load_throughput": 3188978.521, "learn_time_ms": 27238.303, "learn_throughput": 146.852, "update_time_ms": 5.218}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.08062705763024829, "policy_loss": -0.019952430817428778, "vf_loss": 10.012065511461227, "vf_explained_var": 0.14193563525394726, "kl": 0.015071693867344955, "entropy": 0.2381658571942519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1924000, "num_agent_steps_sampled": 1924000, "num_steps_trained": 1924000, "num_agent_steps_trained": 1924000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19240, "training_iteration": 481, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-24-26", "timestamp": 1643703866, "time_this_iter_s": 56.61533784866333, "time_total_s": 38526.37243437767, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38526.37243437767, "timesteps_since_restore": 0, "iterations_since_restore": 481, "perf": {"cpu_util_percent": 36.33125, "ram_util_percent": 70.42999999999999}}
{"episode_reward_max": -2.5, "episode_reward_min": -107.2, "episode_reward_mean": -11.143000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.3, -5.2, -5.300000000000001, -3.3, -11.8, -4.2, -3.3, -11.599999999999998, -8.399999999999997, -6.8999999999999995, -25.69999999999999, -107.2, -3.4, -4.3, -5.300000000000001, -4.300000000000001, -10.199999999999998, -13.1, -11.599999999999998, -12.099999999999996, -2.6000000000000005, -15.799999999999997, -12.09999999999999, -5.0, -9.999999999999998, -4.2, -4.300000000000001, -13.499999999999998, -7.700000000000001, -6.1, -13.2, -4.3, -5.8999999999999995, -27.3, -11.899999999999995, -7.4, -3.2, -7.3, -23.900000000000006, -10.6, -5.1, -13.399999999999999, -8.2, -8.099999999999998, -7.699999999999999, -15.699999999999994, -17.1, -11.999999999999998, -19.6, -4.2, -20.1, -4.4, -18.400000000000002, -9.2, -5.300000000000001, -3.2, -5.0, -6.300000000000001, -8.3, -16.69999999999999, -12.7, -11.2, -4.3, -4.2, -15.099999999999996, -10.5, -11.999999999999995, -6.2, -26.900000000000034, -10.3, -15.799999999999997, -4.3, -13.3, -6.5, -12.600000000000001, -2.5, -4.4, -11.799999999999997, -14.6, -7.3, -15.399999999999997, -3.3, -23.5, -20.599999999999998, -9.200000000000001, -17.1, -5.2, -3.3, -8.699999999999998, -20.799999999999997, -12.899999999999999, -3.7000000000000006, -10.9, -4.300000000000001, -11.4, -15.600000000000001, -5.2, -27.3, -10.4, -11.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.062124452425781, "mean_inference_ms": 12.939953323662344, "mean_action_processing_ms": 0.11966388764649911, "mean_env_wait_ms": 31.499279377936247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1928000, "timesteps_this_iter": 0, "agent_timesteps_total": 1928000, "timers": {"sample_time_ms": 55163.62, "sample_throughput": 72.512, "load_time_ms": 1.284, "load_throughput": 3115430.439, "learn_time_ms": 27207.105, "learn_throughput": 147.02, "update_time_ms": 5.253}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.08159824906477844, "policy_loss": -0.0109042687121258, "vf_loss": 9.218597230411344, "vf_explained_var": 0.2208609353470546, "kl": 0.0103977803798466, "entropy": 0.2276366254495036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1928000, "num_agent_steps_sampled": 1928000, "num_steps_trained": 1928000, "num_agent_steps_trained": 1928000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19280, "training_iteration": 482, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-25-21", "timestamp": 1643703921, "time_this_iter_s": 54.30366086959839, "time_total_s": 38580.67609524727, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38580.67609524727, "timesteps_since_restore": 0, "iterations_since_restore": 482, "perf": {"cpu_util_percent": 32.82987012987013, "ram_util_percent": 70.41558441558442}}
{"episode_reward_max": -2.5, "episode_reward_min": -117.5, "episode_reward_mean": -11.793000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.1, -13.399999999999999, -8.2, -8.099999999999998, -7.699999999999999, -15.699999999999994, -17.1, -11.999999999999998, -19.6, -4.2, -20.1, -4.4, -18.400000000000002, -9.2, -5.300000000000001, -3.2, -5.0, -6.300000000000001, -8.3, -16.69999999999999, -12.7, -11.2, -4.3, -4.2, -15.099999999999996, -10.5, -11.999999999999995, -6.2, -26.900000000000034, -10.3, -15.799999999999997, -4.3, -13.3, -6.5, -12.600000000000001, -2.5, -4.4, -11.799999999999997, -14.6, -7.3, -15.399999999999997, -3.3, -23.5, -20.599999999999998, -9.200000000000001, -17.1, -5.2, -3.3, -8.699999999999998, -20.799999999999997, -12.899999999999999, -3.7000000000000006, -10.9, -4.300000000000001, -11.4, -15.600000000000001, -5.2, -27.3, -10.4, -11.199999999999998, -14.399999999999997, -4.300000000000001, -10.9, -6.5, -12.999999999999998, -8.2, -8.2, -13.6, -4.300000000000001, -19.700000000000006, -117.5, -10.2, -14.3, -12.2, -16.299999999999997, -18.600000000000005, -4.2, -6.2, -15.099999999999998, -19.499999999999993, -6.999999999999998, -15.899999999999999, -17.6, -9.199999999999998, -5.1, -15.599999999999998, -17.700000000000003, -18.1, -3.5, -18.8, -6.5, -8.9, -4.2, -6.300000000000001, -7.300000000000001, -10.5, -3.3, -3.5, -3.2, -5.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.057767581358224, "mean_inference_ms": 12.921058731807312, "mean_action_processing_ms": 0.11986335885920937, "mean_env_wait_ms": 31.47510801433028, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1932000, "timesteps_this_iter": 0, "agent_timesteps_total": 1932000, "timers": {"sample_time_ms": 55178.671, "sample_throughput": 72.492, "load_time_ms": 1.283, "load_throughput": 3117398.64, "learn_time_ms": 27577.298, "learn_throughput": 145.047, "update_time_ms": 5.26}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.529182018312846, "policy_loss": -0.011421727365188261, "vf_loss": 54.041063456509704, "vf_explained_var": 0.12192768396869783, "kl": 0.006343333876322863, "entropy": 0.21451995762926276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1932000, "num_agent_steps_sampled": 1932000, "num_steps_trained": 1932000, "num_agent_steps_trained": 1932000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19320, "training_iteration": 483, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-26-20", "timestamp": 1643703980, "time_this_iter_s": 58.889551877975464, "time_total_s": 38639.565647125244, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38639.565647125244, "timesteps_since_restore": 0, "iterations_since_restore": 483, "perf": {"cpu_util_percent": 43.20240963855422, "ram_util_percent": 70.944578313253}}
{"episode_reward_max": -3.1, "episode_reward_min": -117.5, "episode_reward_mean": -12.933000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.399999999999997, -3.3, -23.5, -20.599999999999998, -9.200000000000001, -17.1, -5.2, -3.3, -8.699999999999998, -20.799999999999997, -12.899999999999999, -3.7000000000000006, -10.9, -4.300000000000001, -11.4, -15.600000000000001, -5.2, -27.3, -10.4, -11.199999999999998, -14.399999999999997, -4.300000000000001, -10.9, -6.5, -12.999999999999998, -8.2, -8.2, -13.6, -4.300000000000001, -19.700000000000006, -117.5, -10.2, -14.3, -12.2, -16.299999999999997, -18.600000000000005, -4.2, -6.2, -15.099999999999998, -19.499999999999993, -6.999999999999998, -15.899999999999999, -17.6, -9.199999999999998, -5.1, -15.599999999999998, -17.700000000000003, -18.1, -3.5, -18.8, -6.5, -8.9, -4.2, -6.300000000000001, -7.300000000000001, -10.5, -3.3, -3.5, -3.2, -5.4, -99.5, -3.4, -6.999999999999999, -7.1, -13.5, -18.599999999999966, -3.3, -3.3, -3.2, -6.2, -6.2, -17.2, -16.099999999999994, -28.2, -8.2, -4.2, -3.4, -24.50000000000001, -8.8, -28.2, -16.299999999999997, -12.299999999999999, -3.4, -17.2, -5.300000000000001, -5.4, -6.199999999999999, -3.1, -13.7, -13.599999999999998, -3.2, -4.300000000000001, -19.199999999999996, -5.800000000000001, -25.500000000000004, -9.5, -3.4, -3.8000000000000003, -15.799999999999999, -31.400000000000055], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.053800989948637, "mean_inference_ms": 12.902543734801995, "mean_action_processing_ms": 0.12007778358153995, "mean_env_wait_ms": 31.45344057702393, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1936000, "timesteps_this_iter": 0, "agent_timesteps_total": 1936000, "timers": {"sample_time_ms": 56104.345, "sample_throughput": 71.296, "load_time_ms": 1.285, "load_throughput": 3113695.854, "learn_time_ms": 27752.579, "learn_throughput": 144.131, "update_time_ms": 5.256}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.030443634613766327, "cur_lr": 0.00010000000000000003, "total_loss": 0.544392882716111, "policy_loss": -0.010529232552895944, "vf_loss": 55.42103941334832, "vf_explained_var": 0.05487314763889518, "kl": 0.023378781331217915, "entropy": 0.19475265125673946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1936000, "num_agent_steps_sampled": 1936000, "num_steps_trained": 1936000, "num_agent_steps_trained": 1936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19360, "training_iteration": 484, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-27-21", "timestamp": 1643704041, "time_this_iter_s": 60.83265995979309, "time_total_s": 38700.39830708504, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38700.39830708504, "timesteps_since_restore": 0, "iterations_since_restore": 484, "perf": {"cpu_util_percent": 46.65930232558139, "ram_util_percent": 70.47790697674417}}
{"episode_reward_max": -3.1, "episode_reward_min": -99.5, "episode_reward_mean": -11.424000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.999999999999998, -15.899999999999999, -17.6, -9.199999999999998, -5.1, -15.599999999999998, -17.700000000000003, -18.1, -3.5, -18.8, -6.5, -8.9, -4.2, -6.300000000000001, -7.300000000000001, -10.5, -3.3, -3.5, -3.2, -5.4, -99.5, -3.4, -6.999999999999999, -7.1, -13.5, -18.599999999999966, -3.3, -3.3, -3.2, -6.2, -6.2, -17.2, -16.099999999999994, -28.2, -8.2, -4.2, -3.4, -24.50000000000001, -8.8, -28.2, -16.299999999999997, -12.299999999999999, -3.4, -17.2, -5.300000000000001, -5.4, -6.199999999999999, -3.1, -13.7, -13.599999999999998, -3.2, -4.300000000000001, -19.199999999999996, -5.800000000000001, -25.500000000000004, -9.5, -3.4, -3.8000000000000003, -15.799999999999999, -31.400000000000055, -10.5, -4.300000000000001, -7.899999999999999, -15.399999999999999, -12.0, -21.3, -11.699999999999998, -3.4, -3.3, -3.3, -13.9, -3.2, -4.4, -4.2, -4.4, -7.599999999999998, -17.2, -3.8000000000000003, -7.3, -4.4, -17.9, -18.900000000000002, -9.0, -5.4, -4.3, -8.3, -19.4, -28.3, -5.4, -3.3, -9.799999999999999, -12.5, -12.6, -24.900000000000006, -18.3, -13.399999999999999, -7.399999999999999, -12.100000000000001, -15.7, -15.899999999999993], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.050361492136723, "mean_inference_ms": 12.884515405940544, "mean_action_processing_ms": 0.12031063697910643, "mean_env_wait_ms": 31.434424894193295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1940000, "timesteps_this_iter": 0, "agent_timesteps_total": 1940000, "timers": {"sample_time_ms": 56647.116, "sample_throughput": 70.613, "load_time_ms": 1.285, "load_throughput": 3113984.817, "learn_time_ms": 28081.774, "learn_throughput": 142.441, "update_time_ms": 5.252}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.09216885248659759, "policy_loss": -0.004379646510126129, "vf_loss": 9.593706821978733, "vf_explained_var": 0.19571140786652924, "kl": 0.013389418187580932, "entropy": 0.2173811501753266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1940000, "num_agent_steps_sampled": 1940000, "num_steps_trained": 1940000, "num_agent_steps_trained": 1940000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19400, "training_iteration": 485, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-28-23", "timestamp": 1643704103, "time_this_iter_s": 62.41792583465576, "time_total_s": 38762.81623291969, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38762.81623291969, "timesteps_since_restore": 0, "iterations_since_restore": 485, "perf": {"cpu_util_percent": 51.13483146067416, "ram_util_percent": 71.01348314606743}}
{"episode_reward_max": -3.1, "episode_reward_min": -42.3, "episode_reward_mean": -11.812999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.299999999999997, -12.299999999999999, -3.4, -17.2, -5.300000000000001, -5.4, -6.199999999999999, -3.1, -13.7, -13.599999999999998, -3.2, -4.300000000000001, -19.199999999999996, -5.800000000000001, -25.500000000000004, -9.5, -3.4, -3.8000000000000003, -15.799999999999999, -31.400000000000055, -10.5, -4.300000000000001, -7.899999999999999, -15.399999999999999, -12.0, -21.3, -11.699999999999998, -3.4, -3.3, -3.3, -13.9, -3.2, -4.4, -4.2, -4.4, -7.599999999999998, -17.2, -3.8000000000000003, -7.3, -4.4, -17.9, -18.900000000000002, -9.0, -5.4, -4.3, -8.3, -19.4, -28.3, -5.4, -3.3, -9.799999999999999, -12.5, -12.6, -24.900000000000006, -18.3, -13.399999999999999, -7.399999999999999, -12.100000000000001, -15.7, -15.899999999999993, -22.10000000000001, -6.299999999999999, -4.1, -5.800000000000001, -31.600000000000005, -23.5, -3.2, -16.9, -9.0, -17.799999999999997, -15.700000000000001, -11.2, -12.1, -13.5, -4.2, -11.199999999999976, -10.199999999999996, -4.3, -29.6, -24.1, -22.299999999999997, -15.899999999999979, -21.199999999999996, -18.0, -12.999999999999996, -42.3, -3.2, -4.300000000000001, -16.3, -9.0, -14.299999999999997, -13.399999999999999, -11.3, -3.3, -10.399999999999999, -21.600000000000005, -3.8000000000000007, -3.3, -4.2, -9.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0468937025045895, "mean_inference_ms": 12.866878027078496, "mean_action_processing_ms": 0.12055790495560119, "mean_env_wait_ms": 31.41714371955677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1944000, "timesteps_this_iter": 0, "agent_timesteps_total": 1944000, "timers": {"sample_time_ms": 57458.428, "sample_throughput": 69.616, "load_time_ms": 1.292, "load_throughput": 3095655.768, "learn_time_ms": 28155.613, "learn_throughput": 142.068, "update_time_ms": 5.267}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.17560609786380682, "policy_loss": -0.006440170470785389, "vf_loss": 18.163759234996252, "vf_explained_var": 0.10947099853587407, "kl": 0.008949449751610524, "entropy": 0.2266570155899371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1944000, "num_agent_steps_sampled": 1944000, "num_steps_trained": 1944000, "num_agent_steps_trained": 1944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19440, "training_iteration": 486, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-29-24", "timestamp": 1643704164, "time_this_iter_s": 60.51113319396973, "time_total_s": 38823.32736611366, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38823.32736611366, "timesteps_since_restore": 0, "iterations_since_restore": 486, "perf": {"cpu_util_percent": 38.34823529411764, "ram_util_percent": 71.21176470588236}}
{"episode_reward_max": -3.2, "episode_reward_min": -42.3, "episode_reward_mean": -11.72, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.9, -18.900000000000002, -9.0, -5.4, -4.3, -8.3, -19.4, -28.3, -5.4, -3.3, -9.799999999999999, -12.5, -12.6, -24.900000000000006, -18.3, -13.399999999999999, -7.399999999999999, -12.100000000000001, -15.7, -15.899999999999993, -22.10000000000001, -6.299999999999999, -4.1, -5.800000000000001, -31.600000000000005, -23.5, -3.2, -16.9, -9.0, -17.799999999999997, -15.700000000000001, -11.2, -12.1, -13.5, -4.2, -11.199999999999976, -10.199999999999996, -4.3, -29.6, -24.1, -22.299999999999997, -15.899999999999979, -21.199999999999996, -18.0, -12.999999999999996, -42.3, -3.2, -4.300000000000001, -16.3, -9.0, -14.299999999999997, -13.399999999999999, -11.3, -3.3, -10.399999999999999, -21.600000000000005, -3.8000000000000007, -3.3, -4.2, -9.1, -8.0, -12.3, -17.599999999999998, -7.1, -4.3, -10.799999999999999, -9.2, -26.400000000000002, -11.5, -3.3, -10.399999999999999, -3.3, -12.600000000000001, -3.4, -4.300000000000001, -3.2, -21.300000000000022, -9.8, -4.2, -3.3, -9.2, -5.6000000000000005, -12.099999999999998, -4.4, -16.199999999999996, -12.600000000000001, -9.3, -3.3, -8.2, -5.800000000000001, -3.2, -14.7, -4.300000000000001, -20.799999999999997, -12.7, -14.2, -4.300000000000001, -4.300000000000001, -4.2, -16.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0436497896631645, "mean_inference_ms": 12.849583889436017, "mean_action_processing_ms": 0.12082024099481835, "mean_env_wait_ms": 31.4014471037525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1948000, "timesteps_this_iter": 0, "agent_timesteps_total": 1948000, "timers": {"sample_time_ms": 58143.757, "sample_throughput": 68.795, "load_time_ms": 1.396, "load_throughput": 2865989.511, "learn_time_ms": 28238.876, "learn_throughput": 141.649, "update_time_ms": 5.344}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.07072692726468367, "policy_loss": -0.004273798533525037, "vf_loss": 7.455158398901262, "vf_explained_var": 0.31033388677463736, "kl": 0.009835542490362066, "entropy": 0.20663553950607136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1948000, "num_agent_steps_sampled": 1948000, "num_steps_trained": 1948000, "num_agent_steps_trained": 1948000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19480, "training_iteration": 487, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-30-26", "timestamp": 1643704226, "time_this_iter_s": 62.23265624046326, "time_total_s": 38885.560022354126, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38885.560022354126, "timesteps_since_restore": 0, "iterations_since_restore": 487, "perf": {"cpu_util_percent": 46.34431818181818, "ram_util_percent": 70.7215909090909}}
{"episode_reward_max": -2.900000000000001, "episode_reward_min": -72.4, "episode_reward_mean": -11.583999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.299999999999997, -15.899999999999979, -21.199999999999996, -18.0, -12.999999999999996, -42.3, -3.2, -4.300000000000001, -16.3, -9.0, -14.299999999999997, -13.399999999999999, -11.3, -3.3, -10.399999999999999, -21.600000000000005, -3.8000000000000007, -3.3, -4.2, -9.1, -8.0, -12.3, -17.599999999999998, -7.1, -4.3, -10.799999999999999, -9.2, -26.400000000000002, -11.5, -3.3, -10.399999999999999, -3.3, -12.600000000000001, -3.4, -4.300000000000001, -3.2, -21.300000000000022, -9.8, -4.2, -3.3, -9.2, -5.6000000000000005, -12.099999999999998, -4.4, -16.199999999999996, -12.600000000000001, -9.3, -3.3, -8.2, -5.800000000000001, -3.2, -14.7, -4.300000000000001, -20.799999999999997, -12.7, -14.2, -4.300000000000001, -4.300000000000001, -4.2, -16.9, -4.2, -10.399999999999997, -72.4, -3.2, -3.2, -7.700000000000001, -11.9, -14.600000000000001, -10.7, -7.3, -15.899999999999997, -7.300000000000001, -20.3, -9.899999999999997, -4.2, -13.399999999999999, -11.700000000000001, -14.099999999999987, -11.5, -3.3, -27.500000000000018, -7.300000000000001, -28.300000000000004, -3.2, -21.3, -5.2, -3.2, -8.3, -6.3, -59.39999999999997, -4.3, -10.0, -3.3, -11.2, -11.3, -11.499999999999998, -17.099999999999998, -2.900000000000001, -23.5, -3.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0393876568518206, "mean_inference_ms": 12.833439890851068, "mean_action_processing_ms": 0.12099690455366155, "mean_env_wait_ms": 31.385054311159447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1952000, "timesteps_this_iter": 0, "agent_timesteps_total": 1952000, "timers": {"sample_time_ms": 57378.088, "sample_throughput": 69.713, "load_time_ms": 1.303, "load_throughput": 3069433.396, "learn_time_ms": 26177.401, "learn_throughput": 152.804, "update_time_ms": 4.577}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.37901393934803945, "policy_loss": -0.013043503439234149, "vf_loss": 39.15768338967395, "vf_explained_var": 0.07157601348815426, "kl": 0.01052471651736777, "entropy": 0.2232087406339825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1952000, "num_agent_steps_sampled": 1952000, "num_steps_trained": 1952000, "num_agent_steps_trained": 1952000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19520, "training_iteration": 488, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-31-03", "timestamp": 1643704263, "time_this_iter_s": 37.006401777267456, "time_total_s": 38922.56642413139, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38922.56642413139, "timesteps_since_restore": 0, "iterations_since_restore": 488, "perf": {"cpu_util_percent": 51.22777777777778, "ram_util_percent": 70.89166666666665}}
{"episode_reward_max": -2.900000000000001, "episode_reward_min": -72.4, "episode_reward_mean": -10.712, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.2, -5.6000000000000005, -12.099999999999998, -4.4, -16.199999999999996, -12.600000000000001, -9.3, -3.3, -8.2, -5.800000000000001, -3.2, -14.7, -4.300000000000001, -20.799999999999997, -12.7, -14.2, -4.300000000000001, -4.300000000000001, -4.2, -16.9, -4.2, -10.399999999999997, -72.4, -3.2, -3.2, -7.700000000000001, -11.9, -14.600000000000001, -10.7, -7.3, -15.899999999999997, -7.300000000000001, -20.3, -9.899999999999997, -4.2, -13.399999999999999, -11.700000000000001, -14.099999999999987, -11.5, -3.3, -27.500000000000018, -7.300000000000001, -28.300000000000004, -3.2, -21.3, -5.2, -3.2, -8.3, -6.3, -59.39999999999997, -4.3, -10.0, -3.3, -11.2, -11.3, -11.499999999999998, -17.099999999999998, -2.900000000000001, -23.5, -3.3, -4.2, -10.099999999999998, -9.9, -7.700000000000001, -9.2, -11.599999999999994, -3.2, -6.300000000000001, -9.600000000000001, -3.3, -3.5000000000000004, -8.2, -14.3, -20.799999999999997, -5.0, -17.2, -3.4, -3.2, -5.2, -14.299999999999997, -3.4, -13.099999999999998, -3.2, -4.300000000000001, -8.3, -20.0, -6.300000000000001, -16.2, -10.2, -8.700000000000001, -12.599999999999998, -11.2, -4.4, -15.499999999999995, -23.0, -7.300000000000001, -4.2, -7.699999999999999, -4.300000000000001, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0331157455241815, "mean_inference_ms": 12.814580438449509, "mean_action_processing_ms": 0.1210178882855758, "mean_env_wait_ms": 31.35327863098338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1956000, "timesteps_this_iter": 0, "agent_timesteps_total": 1956000, "timers": {"sample_time_ms": 53198.828, "sample_throughput": 75.19, "load_time_ms": 1.21, "load_throughput": 3305529.702, "learn_time_ms": 24112.623, "learn_throughput": 165.888, "update_time_ms": 4.236}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.07446340874478381, "policy_loss": -0.013971660907069841, "vf_loss": 8.804646285919732, "vf_explained_var": 0.2847025590558206, "kl": 0.008509969466547588, "entropy": 0.21440647615380184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1956000, "num_agent_steps_sampled": 1956000, "num_steps_trained": 1956000, "num_agent_steps_trained": 1956000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19560, "training_iteration": 489, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-31-17", "timestamp": 1643704277, "time_this_iter_s": 14.096243858337402, "time_total_s": 38936.66266798973, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38936.66266798973, "timesteps_since_restore": 0, "iterations_since_restore": 489, "perf": {"cpu_util_percent": 28.32, "ram_util_percent": 71.355}}
{"episode_reward_max": -2.900000000000001, "episode_reward_min": -59.39999999999997, "episode_reward_mean": -10.108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.500000000000018, -7.300000000000001, -28.300000000000004, -3.2, -21.3, -5.2, -3.2, -8.3, -6.3, -59.39999999999997, -4.3, -10.0, -3.3, -11.2, -11.3, -11.499999999999998, -17.099999999999998, -2.900000000000001, -23.5, -3.3, -4.2, -10.099999999999998, -9.9, -7.700000000000001, -9.2, -11.599999999999994, -3.2, -6.300000000000001, -9.600000000000001, -3.3, -3.5000000000000004, -8.2, -14.3, -20.799999999999997, -5.0, -17.2, -3.4, -3.2, -5.2, -14.299999999999997, -3.4, -13.099999999999998, -3.2, -4.300000000000001, -8.3, -20.0, -6.300000000000001, -16.2, -10.2, -8.700000000000001, -12.599999999999998, -11.2, -4.4, -15.499999999999995, -23.0, -7.300000000000001, -4.2, -7.699999999999999, -4.300000000000001, -5.2, -13.199999999999998, -4.300000000000001, -7.1999999999999975, -8.700000000000001, -10.0, -5.2, -4.4, -11.899999999999997, -13.299999999999999, -10.899999999999999, -5.2, -10.499999999999998, -16.900000000000006, -8.3, -8.299999999999999, -9.8, -27.2, -27.4, -8.400000000000002, -15.799999999999999, -8.999999999999998, -7.2, -15.700000000000001, -4.3, -10.4, -4.300000000000001, -8.3, -5.2, -7.2, -4.300000000000001, -7.499999999999998, -12.600000000000001, -4.800000000000001, -3.4, -14.1, -9.799999999999999, -4.2, -8.9, -10.200000000000001, -4.800000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.025239510347847, "mean_inference_ms": 12.793790888220588, "mean_action_processing_ms": 0.12092816764965089, "mean_env_wait_ms": 31.305522580682236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1960000, "timesteps_this_iter": 0, "agent_timesteps_total": 1960000, "timers": {"sample_time_ms": 49076.694, "sample_throughput": 81.505, "load_time_ms": 1.116, "load_throughput": 3584951.815, "learn_time_ms": 22099.533, "learn_throughput": 180.999, "update_time_ms": 3.882}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.07782807454807303, "policy_loss": -0.005817614768141059, "vf_loss": 8.306547837488113, "vf_explained_var": 0.23972821793248578, "kl": 0.012705711174437142, "entropy": 0.2294095132299649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1960000, "num_agent_steps_sampled": 1960000, "num_steps_trained": 1960000, "num_agent_steps_trained": 1960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19600, "training_iteration": 490, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-31-31", "timestamp": 1643704291, "time_this_iter_s": 14.002769947052002, "time_total_s": 38950.66543793678, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38950.66543793678, "timesteps_since_restore": 0, "iterations_since_restore": 490, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 70.44}}
{"episode_reward_max": -3.2, "episode_reward_min": -27.4, "episode_reward_mean": -10.018, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4, -13.099999999999998, -3.2, -4.300000000000001, -8.3, -20.0, -6.300000000000001, -16.2, -10.2, -8.700000000000001, -12.599999999999998, -11.2, -4.4, -15.499999999999995, -23.0, -7.300000000000001, -4.2, -7.699999999999999, -4.300000000000001, -5.2, -13.199999999999998, -4.300000000000001, -7.1999999999999975, -8.700000000000001, -10.0, -5.2, -4.4, -11.899999999999997, -13.299999999999999, -10.899999999999999, -5.2, -10.499999999999998, -16.900000000000006, -8.3, -8.299999999999999, -9.8, -27.2, -27.4, -8.400000000000002, -15.799999999999999, -8.999999999999998, -7.2, -15.700000000000001, -4.3, -10.4, -4.300000000000001, -8.3, -5.2, -7.2, -4.300000000000001, -7.499999999999998, -12.600000000000001, -4.800000000000001, -3.4, -14.1, -9.799999999999999, -4.2, -8.9, -10.200000000000001, -4.800000000000001, -6.199999999999999, -16.6, -9.100000000000001, -7.2, -11.999999999999998, -13.5, -8.3, -6.300000000000001, -6.3, -5.4, -22.5, -9.4, -7.3, -19.9, -16.099999999999998, -10.7, -5.4, -9.3, -8.6, -7.6000000000000005, -18.099999999999998, -6.2, -19.8, -4.3, -12.5, -7.2, -26.800000000000033, -8.3, -9.2, -10.899999999999999, -13.899999999999997, -6.3, -6.2, -8.8, -16.599999999999987, -5.699999999999999, -7.3, -15.899999999999999, -4.700000000000001, -13.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.016849925556355, "mean_inference_ms": 12.769955150694509, "mean_action_processing_ms": 0.1208067566714897, "mean_env_wait_ms": 31.252189058585426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1964000, "timesteps_this_iter": 0, "agent_timesteps_total": 1964000, "timers": {"sample_time_ms": 44899.637, "sample_throughput": 89.088, "load_time_ms": 1.026, "load_throughput": 3898414.351, "learn_time_ms": 19983.643, "learn_throughput": 200.164, "update_time_ms": 3.549}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.07365071926746637, "policy_loss": -0.002682384608253356, "vf_loss": 7.5831626170425, "vf_explained_var": 0.3626295709481803, "kl": 0.010981597577350073, "entropy": 0.22750528553320515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1964000, "num_agent_steps_sampled": 1964000, "num_steps_trained": 1964000, "num_agent_steps_trained": 1964000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19640, "training_iteration": 491, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-31-45", "timestamp": 1643704305, "time_this_iter_s": 13.895830154418945, "time_total_s": 38964.5612680912, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38964.5612680912, "timesteps_since_restore": 0, "iterations_since_restore": 491, "perf": {"cpu_util_percent": 24.36, "ram_util_percent": 70.13499999999999}}
{"episode_reward_max": -3.2, "episode_reward_min": -107.3, "episode_reward_mean": -11.559000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.999999999999998, -7.2, -15.700000000000001, -4.3, -10.4, -4.300000000000001, -8.3, -5.2, -7.2, -4.300000000000001, -7.499999999999998, -12.600000000000001, -4.800000000000001, -3.4, -14.1, -9.799999999999999, -4.2, -8.9, -10.200000000000001, -4.800000000000001, -6.199999999999999, -16.6, -9.100000000000001, -7.2, -11.999999999999998, -13.5, -8.3, -6.300000000000001, -6.3, -5.4, -22.5, -9.4, -7.3, -19.9, -16.099999999999998, -10.7, -5.4, -9.3, -8.6, -7.6000000000000005, -18.099999999999998, -6.2, -19.8, -4.3, -12.5, -7.2, -26.800000000000033, -8.3, -9.2, -10.899999999999999, -13.899999999999997, -6.3, -6.2, -8.8, -16.599999999999987, -5.699999999999999, -7.3, -15.899999999999999, -4.700000000000001, -13.199999999999996, -13.1, -9.2, -14.099999999999998, -14.6, -5.2, -4.700000000000001, -11.0, -16.799999999999997, -4.2, -4.2, -3.3, -6.899999999999999, -3.3, -21.6, -12.399999999999995, -12.999999999999996, -9.3, -6.300000000000001, -7.6000000000000005, -6.300000000000001, -16.2, -6.5, -4.2, -19.6, -29.4, -19.000000000000004, -3.4, -15.599999999999998, -4.4, -20.8, -10.299999999999997, -3.2, -107.3, -16.599999999999984, -31.400000000000016, -3.3, -9.2, -22.500000000000007, -19.900000000000002, -20.200000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0084608996566224, "mean_inference_ms": 12.746242954217061, "mean_action_processing_ms": 0.12068673370119429, "mean_env_wait_ms": 31.199116252278973, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1968000, "timesteps_this_iter": 0, "agent_timesteps_total": 1968000, "timers": {"sample_time_ms": 40833.951, "sample_throughput": 97.958, "load_time_ms": 0.902, "load_throughput": 4434662.719, "learn_time_ms": 18002.969, "learn_throughput": 222.186, "update_time_ms": 3.249}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.6517348909870125, "policy_loss": -0.006531679178137452, "vf_loss": 65.77778982513695, "vf_explained_var": 0.05060949780607736, "kl": 0.01070159051452642, "entropy": 0.23823593408670476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1968000, "num_agent_steps_sampled": 1968000, "num_steps_trained": 1968000, "num_agent_steps_trained": 1968000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19680, "training_iteration": 492, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-32-00", "timestamp": 1643704320, "time_this_iter_s": 15.067930221557617, "time_total_s": 38979.62919831276, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38979.62919831276, "timesteps_since_restore": 0, "iterations_since_restore": 492, "perf": {"cpu_util_percent": 28.276190476190475, "ram_util_percent": 70.23333333333333}}
{"episode_reward_max": -1.3, "episode_reward_min": -107.3, "episode_reward_mean": -12.004999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.099999999999998, -6.2, -19.8, -4.3, -12.5, -7.2, -26.800000000000033, -8.3, -9.2, -10.899999999999999, -13.899999999999997, -6.3, -6.2, -8.8, -16.599999999999987, -5.699999999999999, -7.3, -15.899999999999999, -4.700000000000001, -13.199999999999996, -13.1, -9.2, -14.099999999999998, -14.6, -5.2, -4.700000000000001, -11.0, -16.799999999999997, -4.2, -4.2, -3.3, -6.899999999999999, -3.3, -21.6, -12.399999999999995, -12.999999999999996, -9.3, -6.300000000000001, -7.6000000000000005, -6.300000000000001, -16.2, -6.5, -4.2, -19.6, -29.4, -19.000000000000004, -3.4, -15.599999999999998, -4.4, -20.8, -10.299999999999997, -3.2, -107.3, -16.599999999999984, -31.400000000000016, -3.3, -9.2, -22.500000000000007, -19.900000000000002, -20.200000000000003, -13.400000000000002, -13.699999999999998, -7.5, -3.3, -4.4, -18.2, -3.3, -10.399999999999984, -6.8, -13.599999999999998, -14.7, -8.8, -3.3, -13.699999999999996, -4.3, -17.299999999999997, -5.2, -10.3, -4.4, -4.3, -12.899999999999999, -4.2, -14.999999999999996, -4.1000000000000005, -16.2, -6.4, -15.099999999999998, -4.3, -30.3, -5.2, -18.900000000000002, -12.999999999999996, -19.6, -5.4, -17.3, -8.4, -7.3, -1.3, -7.4, -15.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.000130881684475, "mean_inference_ms": 12.722645488242849, "mean_action_processing_ms": 0.12056824574071605, "mean_env_wait_ms": 31.14635731218148, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1972000, "timesteps_this_iter": 0, "agent_timesteps_total": 1972000, "timers": {"sample_time_ms": 36838.279, "sample_throughput": 108.583, "load_time_ms": 0.811, "load_throughput": 4930849.669, "learn_time_ms": 15578.554, "learn_throughput": 256.763, "update_time_ms": 2.888}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.0784139430030219, "policy_loss": -0.009431456286780616, "vf_loss": 8.72944528729685, "vf_explained_var": 0.2551912752530908, "kl": 0.012064964467512087, "entropy": 0.2274129074587617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1972000, "num_agent_steps_sampled": 1972000, "num_steps_trained": 1972000, "num_agent_steps_trained": 1972000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19720, "training_iteration": 493, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-32-15", "timestamp": 1643704335, "time_this_iter_s": 14.525790214538574, "time_total_s": 38994.1549885273, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38994.1549885273, "timesteps_since_restore": 0, "iterations_since_restore": 493, "perf": {"cpu_util_percent": 27.485714285714288, "ram_util_percent": 70.47619047619048}}
{"episode_reward_max": -1.3, "episode_reward_min": -107.3, "episode_reward_mean": -13.115999999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.2, -6.5, -4.2, -19.6, -29.4, -19.000000000000004, -3.4, -15.599999999999998, -4.4, -20.8, -10.299999999999997, -3.2, -107.3, -16.599999999999984, -31.400000000000016, -3.3, -9.2, -22.500000000000007, -19.900000000000002, -20.200000000000003, -13.400000000000002, -13.699999999999998, -7.5, -3.3, -4.4, -18.2, -3.3, -10.399999999999984, -6.8, -13.599999999999998, -14.7, -8.8, -3.3, -13.699999999999996, -4.3, -17.299999999999997, -5.2, -10.3, -4.4, -4.3, -12.899999999999999, -4.2, -14.999999999999996, -4.1000000000000005, -16.2, -6.4, -15.099999999999998, -4.3, -30.3, -5.2, -18.900000000000002, -12.999999999999996, -19.6, -5.4, -17.3, -8.4, -7.3, -1.3, -7.4, -15.3, -7.000000000000002, -4.3, -4.300000000000001, -4.9, -6.300000000000001, -11.3, -12.1, -15.899999999999999, -14.499999999999996, -4.3, -24.299999999999997, -20.8, -20.700000000000003, -31.3, -16.099999999999998, -15.2, -1.3, -27.1, -19.6, -19.3, -17.2, -7.699999999999999, -11.299999999999999, -7.2, -8.2, -12.9, -10.2, -30.5, -11.899999999999999, -4.2, -5.300000000000001, -16.3, -9.5, -14.499999999999998, -19.500000000000004, -4.4, -6.199999999999999, -7.600000000000001, -11.299999999999999, -23.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.991838992025888, "mean_inference_ms": 12.699126156499483, "mean_action_processing_ms": 0.12044982844499756, "mean_env_wait_ms": 31.0937711998947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1976000, "timesteps_this_iter": 0, "agent_timesteps_total": 1976000, "timers": {"sample_time_ms": 31975.856, "sample_throughput": 125.094, "load_time_ms": 0.721, "load_throughput": 5547837.704, "learn_time_ms": 13310.131, "learn_throughput": 300.523, "update_time_ms": 3.461}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.1445579549688245, "policy_loss": -0.011328288861700604, "vf_loss": 15.53436109583865, "vf_explained_var": 0.2868241858097815, "kl": 0.011882893985957169, "entropy": 0.27239732995469085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1976000, "num_agent_steps_sampled": 1976000, "num_steps_trained": 1976000, "num_agent_steps_trained": 1976000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19760, "training_iteration": 494, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-32-29", "timestamp": 1643704349, "time_this_iter_s": 13.944895029067993, "time_total_s": 39008.099883556366, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39008.099883556366, "timesteps_since_restore": 0, "iterations_since_restore": 494, "perf": {"cpu_util_percent": 25.01, "ram_util_percent": 70.47999999999999}}
{"episode_reward_max": -1.3, "episode_reward_min": -34.2, "episode_reward_mean": -11.533000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999999, -4.2, -14.999999999999996, -4.1000000000000005, -16.2, -6.4, -15.099999999999998, -4.3, -30.3, -5.2, -18.900000000000002, -12.999999999999996, -19.6, -5.4, -17.3, -8.4, -7.3, -1.3, -7.4, -15.3, -7.000000000000002, -4.3, -4.300000000000001, -4.9, -6.300000000000001, -11.3, -12.1, -15.899999999999999, -14.499999999999996, -4.3, -24.299999999999997, -20.8, -20.700000000000003, -31.3, -16.099999999999998, -15.2, -1.3, -27.1, -19.6, -19.3, -17.2, -7.699999999999999, -11.299999999999999, -7.2, -8.2, -12.9, -10.2, -30.5, -11.899999999999999, -4.2, -5.300000000000001, -16.3, -9.5, -14.499999999999998, -19.500000000000004, -4.4, -6.199999999999999, -7.600000000000001, -11.299999999999999, -23.599999999999998, -34.2, -22.5, -4.4, -20.2, -4.300000000000001, -4.700000000000001, -11.299999999999997, -19.799999999999997, -19.7, -5.0, -7.2, -3.4, -15.299999999999999, -4.2, -3.3, -6.300000000000001, -3.7, -12.0, -7.999999999999993, -4.2, -5.2, -14.899999999999997, -4.2, -4.300000000000001, -13.2, -3.3, -12.799999999999999, -11.8, -4.2, -9.4, -24.900000000000006, -13.5, -5.3, -5.1, -10.0, -4.4, -10.1, -3.2, -20.199999999999996, -11.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.983552524263133, "mean_inference_ms": 12.675675882017286, "mean_action_processing_ms": 0.12033058025389982, "mean_env_wait_ms": 31.041310387339035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1980000, "timesteps_this_iter": 0, "agent_timesteps_total": 1980000, "timers": {"sample_time_ms": 27261.986, "sample_throughput": 146.724, "load_time_ms": 0.632, "load_throughput": 6332936.736, "learn_time_ms": 10920.551, "learn_throughput": 366.282, "update_time_ms": 3.171}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.11288988891192862, "policy_loss": -0.005847134026110433, "vf_loss": 11.83050807195325, "vf_explained_var": 0.0989945666123462, "kl": 0.009458883720678777, "entropy": 0.22496259436011315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1980000, "num_agent_steps_sampled": 1980000, "num_steps_trained": 1980000, "num_agent_steps_trained": 1980000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19800, "training_iteration": 495, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-32-43", "timestamp": 1643704363, "time_this_iter_s": 14.081534147262573, "time_total_s": 39022.18141770363, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39022.18141770363, "timesteps_since_restore": 0, "iterations_since_restore": 495, "perf": {"cpu_util_percent": 26.26, "ram_util_percent": 70.57999999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -34.2, "episode_reward_mean": -10.914000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.2, -7.699999999999999, -11.299999999999999, -7.2, -8.2, -12.9, -10.2, -30.5, -11.899999999999999, -4.2, -5.300000000000001, -16.3, -9.5, -14.499999999999998, -19.500000000000004, -4.4, -6.199999999999999, -7.600000000000001, -11.299999999999999, -23.599999999999998, -34.2, -22.5, -4.4, -20.2, -4.300000000000001, -4.700000000000001, -11.299999999999997, -19.799999999999997, -19.7, -5.0, -7.2, -3.4, -15.299999999999999, -4.2, -3.3, -6.300000000000001, -3.7, -12.0, -7.999999999999993, -4.2, -5.2, -14.899999999999997, -4.2, -4.300000000000001, -13.2, -3.3, -12.799999999999999, -11.8, -4.2, -9.4, -24.900000000000006, -13.5, -5.3, -5.1, -10.0, -4.4, -10.1, -3.2, -20.199999999999996, -11.899999999999999, -4.4, -13.7, -19.400000000000002, -8.799999999999997, -16.799999999999976, -8.799999999999999, -3.4, -5.2, -11.099999999999998, -18.89999999999999, -13.19999999999997, -5.3, -10.5, -9.3, -22.90000000000001, -13.100000000000001, -8.2, -25.199999999999996, -23.700000000000003, -12.1, -7.3, -14.5, -3.5, -11.499999999999998, -14.499999999999998, -14.5, -3.3, -24.90000000000001, -14.2, -10.399999999999999, -13.5, -8.2, -5.4, -4.300000000000001, -3.3, -3.4, -9.2, -6.300000000000001, -5.8999999999999995, -14.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.975229177903593, "mean_inference_ms": 12.652258828646046, "mean_action_processing_ms": 0.12020849663831555, "mean_env_wait_ms": 30.988736977728387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1984000, "timesteps_this_iter": 0, "agent_timesteps_total": 1984000, "timers": {"sample_time_ms": 22385.364, "sample_throughput": 178.688, "load_time_ms": 0.529, "load_throughput": 7568213.641, "learn_time_ms": 8765.003, "learn_throughput": 456.36, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.08082893588029409, "policy_loss": -0.0050943573553776066, "vf_loss": 8.553144734360838, "vf_explained_var": 0.17419140114579149, "kl": 0.008580867502446674, "entropy": 0.22654471222751885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1984000, "num_agent_steps_sampled": 1984000, "num_steps_trained": 1984000, "num_agent_steps_trained": 1984000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19840, "training_iteration": 496, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-32-57", "timestamp": 1643704377, "time_this_iter_s": 14.141886949539185, "time_total_s": 39036.32330465317, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39036.32330465317, "timesteps_since_restore": 0, "iterations_since_restore": 496, "perf": {"cpu_util_percent": 29.410000000000004, "ram_util_percent": 71.17999999999999}}
{"episode_reward_max": -2.3, "episode_reward_min": -25.400000000000002, "episode_reward_mean": -10.473999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.2, -14.899999999999997, -4.2, -4.300000000000001, -13.2, -3.3, -12.799999999999999, -11.8, -4.2, -9.4, -24.900000000000006, -13.5, -5.3, -5.1, -10.0, -4.4, -10.1, -3.2, -20.199999999999996, -11.899999999999999, -4.4, -13.7, -19.400000000000002, -8.799999999999997, -16.799999999999976, -8.799999999999999, -3.4, -5.2, -11.099999999999998, -18.89999999999999, -13.19999999999997, -5.3, -10.5, -9.3, -22.90000000000001, -13.100000000000001, -8.2, -25.199999999999996, -23.700000000000003, -12.1, -7.3, -14.5, -3.5, -11.499999999999998, -14.499999999999998, -14.5, -3.3, -24.90000000000001, -14.2, -10.399999999999999, -13.5, -8.2, -5.4, -4.300000000000001, -3.3, -3.4, -9.2, -6.300000000000001, -5.8999999999999995, -14.2, -5.800000000000001, -16.199999999999978, -7.6, -6.199999999999999, -3.3, -3.4, -4.4, -17.2, -3.4, -8.2, -4.3, -14.2, -14.999999999999996, -4.2, -15.099999999999998, -10.999999999999977, -4.4, -25.400000000000002, -11.599999999999998, -10.2, -3.3, -18.5, -7.3, -9.3, -2.3, -4.2, -4.2, -11.2, -17.199999999999996, -4.3, -18.4, -16.8, -9.6, -12.099999999999998, -23.20000000000001, -19.700000000000006, -6.799999999999998, -3.4, -16.099999999999998, -10.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.967082069011455, "mean_inference_ms": 12.629095512474908, "mean_action_processing_ms": 0.12009605804800078, "mean_env_wait_ms": 30.93712553332169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1988000, "timesteps_this_iter": 0, "agent_timesteps_total": 1988000, "timers": {"sample_time_ms": 17645.038, "sample_throughput": 226.693, "load_time_ms": 0.338, "load_throughput": 11819102.501, "learn_time_ms": 6690.122, "learn_throughput": 597.896, "update_time_ms": 2.357}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.08537986628030257, "policy_loss": 0.0007152412762685168, "vf_loss": 8.434155436036407, "vf_explained_var": 0.2883706586335295, "kl": 0.007074752288424062, "entropy": 0.19642543530752582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1988000, "num_agent_steps_sampled": 1988000, "num_steps_trained": 1988000, "num_agent_steps_trained": 1988000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19880, "training_iteration": 497, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-33-13", "timestamp": 1643704393, "time_this_iter_s": 15.699828147888184, "time_total_s": 39052.023132801056, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39052.023132801056, "timesteps_since_restore": 0, "iterations_since_restore": 497, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 74.62272727272727}}
{"episode_reward_max": -2.3, "episode_reward_min": -34.2, "episode_reward_mean": -10.821000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.3, -14.5, -3.5, -11.499999999999998, -14.499999999999998, -14.5, -3.3, -24.90000000000001, -14.2, -10.399999999999999, -13.5, -8.2, -5.4, -4.300000000000001, -3.3, -3.4, -9.2, -6.300000000000001, -5.8999999999999995, -14.2, -5.800000000000001, -16.199999999999978, -7.6, -6.199999999999999, -3.3, -3.4, -4.4, -17.2, -3.4, -8.2, -4.3, -14.2, -14.999999999999996, -4.2, -15.099999999999998, -10.999999999999977, -4.4, -25.400000000000002, -11.599999999999998, -10.2, -3.3, -18.5, -7.3, -9.3, -2.3, -4.2, -4.2, -11.2, -17.199999999999996, -4.3, -18.4, -16.8, -9.6, -12.099999999999998, -23.20000000000001, -19.700000000000006, -6.799999999999998, -3.4, -16.099999999999998, -10.2, -2.6000000000000005, -26.099999999999998, -9.399999999999999, -4.4, -25.3, -6.300000000000001, -13.799999999999999, -12.099999999999998, -22.799999999999997, -3.3, -4.4, -27.3, -10.3, -5.4, -3.6000000000000005, -7.800000000000001, -10.0, -3.3, -4.5, -17.1, -25.099999999999998, -14.499999999999998, -3.3, -4.4, -24.600000000000005, -14.699999999999985, -4.3, -19.9, -18.7, -3.3, -14.999999999999998, -9.599999999999998, -34.2, -4.300000000000001, -14.499999999999995, -15.7, -13.299999999999997, -12.0, -4.2, -5.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.95900333417422, "mean_inference_ms": 12.606111941093317, "mean_action_processing_ms": 0.11998894680119325, "mean_env_wait_ms": 30.88610226027846, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1992000, "timesteps_this_iter": 0, "agent_timesteps_total": 1992000, "timers": {"sample_time_ms": 14377.183, "sample_throughput": 278.219, "load_time_ms": 0.338, "load_throughput": 11851664.312, "learn_time_ms": 6840.182, "learn_throughput": 584.78, "update_time_ms": 2.501}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.14469351455799595, "policy_loss": -0.007167208759534744, "vf_loss": 15.156363014700592, "vf_explained_var": 0.12800584095780568, "kl": 0.006505983138049596, "entropy": 0.2165887142221133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1992000, "num_agent_steps_sampled": 1992000, "num_steps_trained": 1992000, "num_agent_steps_trained": 1992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19920, "training_iteration": 498, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-33-28", "timestamp": 1643704408, "time_this_iter_s": 15.64783787727356, "time_total_s": 39067.67097067833, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39067.67097067833, "timesteps_since_restore": 0, "iterations_since_restore": 498, "perf": {"cpu_util_percent": 34.25454545454545, "ram_util_percent": 74.19545454545457}}
{"episode_reward_max": -2.3, "episode_reward_min": -45.3, "episode_reward_mean": -11.190999999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3, -18.5, -7.3, -9.3, -2.3, -4.2, -4.2, -11.2, -17.199999999999996, -4.3, -18.4, -16.8, -9.6, -12.099999999999998, -23.20000000000001, -19.700000000000006, -6.799999999999998, -3.4, -16.099999999999998, -10.2, -2.6000000000000005, -26.099999999999998, -9.399999999999999, -4.4, -25.3, -6.300000000000001, -13.799999999999999, -12.099999999999998, -22.799999999999997, -3.3, -4.4, -27.3, -10.3, -5.4, -3.6000000000000005, -7.800000000000001, -10.0, -3.3, -4.5, -17.1, -25.099999999999998, -14.499999999999998, -3.3, -4.4, -24.600000000000005, -14.699999999999985, -4.3, -19.9, -18.7, -3.3, -14.999999999999998, -9.599999999999998, -34.2, -4.300000000000001, -14.499999999999995, -15.7, -13.299999999999997, -12.0, -4.2, -5.2, -4.9, -3.3, -4.300000000000001, -4.2, -9.299999999999999, -2.5, -10.3, -20.5, -22.3, -17.2, -12.2, -14.5, -4.2, -5.699999999999999, -9.6, -8.3, -4.4, -25.500000000000018, -45.3, -3.3, -18.3, -10.2, -17.800000000000004, -11.4, -9.6, -8.299999999999999, -7.299999999999999, -7.7, -10.699999999999998, -4.2, -11.700000000000001, -12.799999999999999, -8.399999999999999, -3.2, -4.800000000000001, -6.4, -12.6, -3.3, -4.3, -15.599999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9508936675384305, "mean_inference_ms": 12.583185104375524, "mean_action_processing_ms": 0.11987991162347296, "mean_env_wait_ms": 30.83516214437129, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 1996000, "timesteps_this_iter": 0, "agent_timesteps_total": 1996000, "timers": {"sample_time_ms": 14524.783, "sample_throughput": 275.391, "load_time_ms": 0.334, "load_throughput": 11972608.292, "learn_time_ms": 6886.595, "learn_throughput": 580.839, "update_time_ms": 2.481}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.12509940234713898, "policy_loss": -0.01365609584696671, "vf_loss": 13.83220400944833, "vf_explained_var": 0.07112766190241741, "kl": 0.0094921665522776, "entropy": 0.23098863003555165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1996000, "num_agent_steps_sampled": 1996000, "num_steps_trained": 1996000, "num_agent_steps_trained": 1996000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 19960, "training_iteration": 499, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-33-43", "timestamp": 1643704423, "time_this_iter_s": 14.535986185073853, "time_total_s": 39082.2069568634, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39082.2069568634, "timesteps_since_restore": 0, "iterations_since_restore": 499, "perf": {"cpu_util_percent": 25.714285714285708, "ram_util_percent": 73.84761904761906}}
{"episode_reward_max": -2.5, "episode_reward_min": -45.3, "episode_reward_mean": -10.747000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.099999999999998, -14.499999999999998, -3.3, -4.4, -24.600000000000005, -14.699999999999985, -4.3, -19.9, -18.7, -3.3, -14.999999999999998, -9.599999999999998, -34.2, -4.300000000000001, -14.499999999999995, -15.7, -13.299999999999997, -12.0, -4.2, -5.2, -4.9, -3.3, -4.300000000000001, -4.2, -9.299999999999999, -2.5, -10.3, -20.5, -22.3, -17.2, -12.2, -14.5, -4.2, -5.699999999999999, -9.6, -8.3, -4.4, -25.500000000000018, -45.3, -3.3, -18.3, -10.2, -17.800000000000004, -11.4, -9.6, -8.299999999999999, -7.299999999999999, -7.7, -10.699999999999998, -4.2, -11.700000000000001, -12.799999999999999, -8.399999999999999, -3.2, -4.800000000000001, -6.4, -12.6, -3.3, -4.3, -15.599999999999996, -20.9, -14.399999999999997, -9.899999999999999, -17.5, -4.300000000000001, -5.5, -12.9, -15.6, -10.5, -6.2, -4.2, -13.499999999999998, -11.999999999999991, -4.3, -18.600000000000023, -10.2, -13.799999999999997, -19.4, -12.699999999999998, -4.2, -4.4, -3.2, -9.9, -14.099999999999998, -5.2, -4.4, -7.2, -6.3, -8.2, -9.3, -10.1, -11.799999999999999, -3.3, -12.699999999999998, -5.3, -3.4, -18.699999999999996, -3.4, -4.700000000000001, -17.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.942718247634299, "mean_inference_ms": 12.560231547041896, "mean_action_processing_ms": 0.11976514393638166, "mean_env_wait_ms": 30.78390252511036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2000000, "timesteps_this_iter": 0, "agent_timesteps_total": 2000000, "timers": {"sample_time_ms": 14566.833, "sample_throughput": 274.596, "load_time_ms": 0.336, "load_throughput": 11901266.936, "learn_time_ms": 6940.201, "learn_throughput": 576.352, "update_time_ms": 2.569}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.06969714941787383, "policy_loss": -0.001078419317240997, "vf_loss": 7.02992205683903, "vf_explained_var": 0.22659030197769084, "kl": 0.010431313955382715, "entropy": 0.20258244402225942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2000000, "num_agent_steps_sampled": 2000000, "num_steps_trained": 2000000, "num_agent_steps_trained": 2000000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20000, "training_iteration": 500, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-33-58", "timestamp": 1643704438, "time_this_iter_s": 14.503404140472412, "time_total_s": 39096.710361003876, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39096.710361003876, "timesteps_since_restore": 0, "iterations_since_restore": 500, "perf": {"cpu_util_percent": 26.071428571428573, "ram_util_percent": 73.5}}
{"episode_reward_max": -3.2, "episode_reward_min": -59.0, "episode_reward_mean": -10.992000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.3, -10.2, -17.800000000000004, -11.4, -9.6, -8.299999999999999, -7.299999999999999, -7.7, -10.699999999999998, -4.2, -11.700000000000001, -12.799999999999999, -8.399999999999999, -3.2, -4.800000000000001, -6.4, -12.6, -3.3, -4.3, -15.599999999999996, -20.9, -14.399999999999997, -9.899999999999999, -17.5, -4.300000000000001, -5.5, -12.9, -15.6, -10.5, -6.2, -4.2, -13.499999999999998, -11.999999999999991, -4.3, -18.600000000000023, -10.2, -13.799999999999997, -19.4, -12.699999999999998, -4.2, -4.4, -3.2, -9.9, -14.099999999999998, -5.2, -4.4, -7.2, -6.3, -8.2, -9.3, -10.1, -11.799999999999999, -3.3, -12.699999999999998, -5.3, -3.4, -18.699999999999996, -3.4, -4.700000000000001, -17.3, -13.3, -9.799999999999999, -12.699999999999998, -11.099999999999998, -24.200000000000017, -8.999999999999998, -59.0, -5.2, -10.2, -19.5, -25.3, -21.2, -3.2, -5.300000000000001, -7.5, -3.2, -19.400000000000006, -3.4, -9.2, -5.300000000000001, -18.5, -3.3, -19.2, -34.3, -7.299999999999999, -5.800000000000001, -6.9, -21.9, -4.3, -7.6, -8.9, -15.4, -19.100000000000005, -10.0, -19.60000000000004, -3.2, -15.999999999999998, -7.2, -3.4, -8.199999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.934640368755173, "mean_inference_ms": 12.537401713992146, "mean_action_processing_ms": 0.11965267494034766, "mean_env_wait_ms": 30.732980409437342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2004000, "timesteps_this_iter": 0, "agent_timesteps_total": 2004000, "timers": {"sample_time_ms": 14678.858, "sample_throughput": 272.501, "load_time_ms": 0.334, "load_throughput": 11964923.691, "learn_time_ms": 7027.71, "learn_throughput": 569.175, "update_time_ms": 2.593}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.23475186471121326, "policy_loss": -0.0023507485005964516, "vf_loss": 23.68175192853456, "vf_explained_var": 0.21438338429697099, "kl": 0.00624329398789682, "entropy": 0.20920108589594083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2004000, "num_agent_steps_sampled": 2004000, "num_steps_trained": 2004000, "num_agent_steps_trained": 2004000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20040, "training_iteration": 501, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-34-13", "timestamp": 1643704453, "time_this_iter_s": 15.33786392211914, "time_total_s": 39112.048224925995, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39112.048224925995, "timesteps_since_restore": 0, "iterations_since_restore": 501, "perf": {"cpu_util_percent": 28.9, "ram_util_percent": 73.26363636363637}}
{"episode_reward_max": -3.2, "episode_reward_min": -59.0, "episode_reward_mean": -10.970999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.4, -3.2, -9.9, -14.099999999999998, -5.2, -4.4, -7.2, -6.3, -8.2, -9.3, -10.1, -11.799999999999999, -3.3, -12.699999999999998, -5.3, -3.4, -18.699999999999996, -3.4, -4.700000000000001, -17.3, -13.3, -9.799999999999999, -12.699999999999998, -11.099999999999998, -24.200000000000017, -8.999999999999998, -59.0, -5.2, -10.2, -19.5, -25.3, -21.2, -3.2, -5.300000000000001, -7.5, -3.2, -19.400000000000006, -3.4, -9.2, -5.300000000000001, -18.5, -3.3, -19.2, -34.3, -7.299999999999999, -5.800000000000001, -6.9, -21.9, -4.3, -7.6, -8.9, -15.4, -19.100000000000005, -10.0, -19.60000000000004, -3.2, -15.999999999999998, -7.2, -3.4, -8.199999999999998, -12.699999999999996, -16.099999999999998, -11.3, -15.099999999999998, -14.299999999999999, -5.1000000000000005, -11.3, -3.3, -11.0, -12.700000000000001, -20.4, -7.299999999999999, -8.099999999999998, -5.3, -3.3, -5.2, -6.199999999999999, -7.2, -5.2, -15.299999999999995, -16.5, -19.2, -3.7000000000000006, -10.4, -10.999999999999991, -3.3, -11.5, -16.8, -18.0, -26.3, -3.2, -11.5, -6.3, -3.2, -4.300000000000001, -16.2, -15.3, -4.300000000000001, -5.9, -13.799999999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.926623788093536, "mean_inference_ms": 12.51468495461494, "mean_action_processing_ms": 0.11954141389533848, "mean_env_wait_ms": 30.6823199209614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2008000, "timesteps_this_iter": 0, "agent_timesteps_total": 2008000, "timers": {"sample_time_ms": 14750.593, "sample_throughput": 271.176, "load_time_ms": 0.336, "load_throughput": 11912252.201, "learn_time_ms": 6963.377, "learn_throughput": 574.434, "update_time_ms": 2.569}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.08460048698890273, "policy_loss": -0.011916222380003541, "vf_loss": 9.579216413664561, "vf_explained_var": 0.10737003472543531, "kl": 0.015866466537454087, "entropy": 0.22568387852240634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2008000, "num_agent_steps_sampled": 2008000, "num_steps_trained": 2008000, "num_agent_steps_trained": 2008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20080, "training_iteration": 502, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-34-27", "timestamp": 1643704467, "time_this_iter_s": 14.261868000030518, "time_total_s": 39126.310092926025, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39126.310092926025, "timesteps_since_restore": 0, "iterations_since_restore": 502, "perf": {"cpu_util_percent": 26.645, "ram_util_percent": 72.56499999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.1, "episode_reward_mean": -11.504000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.5, -3.3, -19.2, -34.3, -7.299999999999999, -5.800000000000001, -6.9, -21.9, -4.3, -7.6, -8.9, -15.4, -19.100000000000005, -10.0, -19.60000000000004, -3.2, -15.999999999999998, -7.2, -3.4, -8.199999999999998, -12.699999999999996, -16.099999999999998, -11.3, -15.099999999999998, -14.299999999999999, -5.1000000000000005, -11.3, -3.3, -11.0, -12.700000000000001, -20.4, -7.299999999999999, -8.099999999999998, -5.3, -3.3, -5.2, -6.199999999999999, -7.2, -5.2, -15.299999999999995, -16.5, -19.2, -3.7000000000000006, -10.4, -10.999999999999991, -3.3, -11.5, -16.8, -18.0, -26.3, -3.2, -11.5, -6.3, -3.2, -4.300000000000001, -16.2, -15.3, -4.300000000000001, -5.9, -13.799999999999992, -6.2, -22.19999999999999, -5.2, -12.2, -8.2, -4.4, -7.3, -15.399999999999999, -6.300000000000001, -9.3, -17.099999999999998, -43.1, -6.000000000000001, -17.3, -10.4, -20.8, -7.2, -15.7, -16.5, -13.09999999999999, -11.3, -8.6, -6.4, -14.399999999999999, -5.3, -14.9, -12.4, -11.4, -8.3, -10.3, -3.4, -14.3, -17.799999999999997, -21.3, -3.3, -8.2, -18.9, -12.0, -15.6, -11.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.918578403482927, "mean_inference_ms": 12.492055957782636, "mean_action_processing_ms": 0.11942935600523721, "mean_env_wait_ms": 30.631707887190117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2012000, "timesteps_this_iter": 0, "agent_timesteps_total": 2012000, "timers": {"sample_time_ms": 14672.023, "sample_throughput": 272.628, "load_time_ms": 0.338, "load_throughput": 11829102.447, "learn_time_ms": 6932.868, "learn_throughput": 576.962, "update_time_ms": 2.553}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.04566545192064952, "cur_lr": 0.00010000000000000003, "total_loss": 0.09930906902237605, "policy_loss": -0.010688299405318435, "vf_loss": 10.888017721073602, "vf_explained_var": 0.356850367464045, "kl": 0.02446472798109691, "entropy": 0.2624549770066815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2012000, "num_agent_steps_sampled": 2012000, "num_steps_trained": 2012000, "num_agent_steps_trained": 2012000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20120, "training_iteration": 503, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-34-41", "timestamp": 1643704481, "time_this_iter_s": 14.084206819534302, "time_total_s": 39140.39429974556, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39140.39429974556, "timesteps_since_restore": 0, "iterations_since_restore": 503, "perf": {"cpu_util_percent": 27.814999999999998, "ram_util_percent": 72.59499999999998}}
{"episode_reward_max": -3.2, "episode_reward_min": -43.1, "episode_reward_mean": -11.751999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.5, -19.2, -3.7000000000000006, -10.4, -10.999999999999991, -3.3, -11.5, -16.8, -18.0, -26.3, -3.2, -11.5, -6.3, -3.2, -4.300000000000001, -16.2, -15.3, -4.300000000000001, -5.9, -13.799999999999992, -6.2, -22.19999999999999, -5.2, -12.2, -8.2, -4.4, -7.3, -15.399999999999999, -6.300000000000001, -9.3, -17.099999999999998, -43.1, -6.000000000000001, -17.3, -10.4, -20.8, -7.2, -15.7, -16.5, -13.09999999999999, -11.3, -8.6, -6.4, -14.399999999999999, -5.3, -14.9, -12.4, -11.4, -8.3, -10.3, -3.4, -14.3, -17.799999999999997, -21.3, -3.3, -8.2, -18.9, -12.0, -15.6, -11.2, -8.6, -4.3, -20.4, -33.4, -8.399999999999999, -15.7, -10.2, -10.299999999999999, -8.2, -4.2, -13.3, -4.4, -25.5, -11.1, -10.5, -4.2, -15.899999999999999, -10.399999999999999, -10.999999999999998, -8.5, -7.300000000000001, -11.3, -17.6, -11.3, -7.3, -19.7, -6.6000000000000005, -21.100000000000012, -8.3, -7.300000000000001, -12.600000000000001, -5.2, -10.199999999999998, -23.4, -18.0, -10.999999999999975, -10.799999999999999, -7.3, -3.3, -3.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.91051377169953, "mean_inference_ms": 12.469457707625615, "mean_action_processing_ms": 0.11931427743831485, "mean_env_wait_ms": 30.581047585742454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2016000, "timesteps_this_iter": 0, "agent_timesteps_total": 2016000, "timers": {"sample_time_ms": 14627.884, "sample_throughput": 273.45, "load_time_ms": 0.337, "load_throughput": 11881039.586, "learn_time_ms": 6949.096, "learn_throughput": 575.614, "update_time_ms": 1.617}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06849817788097423, "cur_lr": 0.00010000000000000003, "total_loss": 0.11279767829504224, "policy_loss": -0.01313730376341971, "vf_loss": 12.535973303356478, "vf_explained_var": 0.2526524711680669, "kl": 0.008398028446334289, "entropy": 0.22931358339164848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2016000, "num_agent_steps_sampled": 2016000, "num_steps_trained": 2016000, "num_agent_steps_trained": 2016000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20160, "training_iteration": 504, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-34-55", "timestamp": 1643704495, "time_this_iter_s": 13.943541049957275, "time_total_s": 39154.33784079552, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39154.33784079552, "timesteps_since_restore": 0, "iterations_since_restore": 504, "perf": {"cpu_util_percent": 25.014999999999997, "ram_util_percent": 72.57}}
{"episode_reward_max": -3.2, "episode_reward_min": -38.3, "episode_reward_mean": -11.232000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -8.6, -6.4, -14.399999999999999, -5.3, -14.9, -12.4, -11.4, -8.3, -10.3, -3.4, -14.3, -17.799999999999997, -21.3, -3.3, -8.2, -18.9, -12.0, -15.6, -11.2, -8.6, -4.3, -20.4, -33.4, -8.399999999999999, -15.7, -10.2, -10.299999999999999, -8.2, -4.2, -13.3, -4.4, -25.5, -11.1, -10.5, -4.2, -15.899999999999999, -10.399999999999999, -10.999999999999998, -8.5, -7.300000000000001, -11.3, -17.6, -11.3, -7.3, -19.7, -6.6000000000000005, -21.100000000000012, -8.3, -7.300000000000001, -12.600000000000001, -5.2, -10.199999999999998, -23.4, -18.0, -10.999999999999975, -10.799999999999999, -7.3, -3.3, -3.2, -20.10000000000001, -6.5, -7.800000000000001, -7.300000000000001, -5.300000000000001, -14.9, -7.300000000000001, -4.300000000000001, -7.300000000000001, -6.599999999999999, -14.600000000000001, -11.2, -9.7, -10.2, -3.5000000000000004, -8.3, -22.9, -5.3, -20.70000000000002, -14.4, -12.399999999999997, -5.4, -10.200000000000001, -5.300000000000001, -7.2, -9.2, -12.499999999999998, -5.3, -38.3, -5.9, -10.3, -20.200000000000003, -13.399999999999999, -18.1, -6.3, -7.2, -14.499999999999998, -7.8999999999999995, -9.499999999999998, -5.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.902527577192192, "mean_inference_ms": 12.446921300956852, "mean_action_processing_ms": 0.11919920306285285, "mean_env_wait_ms": 30.530543807670348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2020000, "timesteps_this_iter": 0, "agent_timesteps_total": 2020000, "timers": {"sample_time_ms": 14649.692, "sample_throughput": 273.043, "load_time_ms": 0.337, "load_throughput": 11881881.02, "learn_time_ms": 6937.884, "learn_throughput": 576.545, "update_time_ms": 1.617}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06849817788097423, "cur_lr": 0.00010000000000000003, "total_loss": 0.08323847976893747, "policy_loss": -0.013761739639104695, "vf_loss": 9.62592772674817, "vf_explained_var": 0.4324111213607173, "kl": 0.010816989427375088, "entropy": 0.24071963023274176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2020000, "num_agent_steps_sampled": 2020000, "num_steps_trained": 2020000, "num_agent_steps_trained": 2020000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20200, "training_iteration": 505, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-35-09", "timestamp": 1643704509, "time_this_iter_s": 14.059810161590576, "time_total_s": 39168.39765095711, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39168.39765095711, "timesteps_since_restore": 0, "iterations_since_restore": 505, "perf": {"cpu_util_percent": 22.79, "ram_util_percent": 72.78}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -81.3, "episode_reward_mean": -11.353000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.300000000000001, -11.3, -17.6, -11.3, -7.3, -19.7, -6.6000000000000005, -21.100000000000012, -8.3, -7.300000000000001, -12.600000000000001, -5.2, -10.199999999999998, -23.4, -18.0, -10.999999999999975, -10.799999999999999, -7.3, -3.3, -3.2, -20.10000000000001, -6.5, -7.800000000000001, -7.300000000000001, -5.300000000000001, -14.9, -7.300000000000001, -4.300000000000001, -7.300000000000001, -6.599999999999999, -14.600000000000001, -11.2, -9.7, -10.2, -3.5000000000000004, -8.3, -22.9, -5.3, -20.70000000000002, -14.4, -12.399999999999997, -5.4, -10.200000000000001, -5.300000000000001, -7.2, -9.2, -12.499999999999998, -5.3, -38.3, -5.9, -10.3, -20.200000000000003, -13.399999999999999, -18.1, -6.3, -7.2, -14.499999999999998, -7.8999999999999995, -9.499999999999998, -5.3, -13.3, -6.3, -6.3, -7.2, -6.5, -4.300000000000001, -7.2, -5.2, -13.2, -8.7, -2.4000000000000004, -27.90000000000004, -15.2, -5.2, -3.2, -11.600000000000001, -12.700000000000001, -14.799999999999999, -7.3, -13.899999999999999, -4.3, -18.099999999999998, -11.699999999999998, -6.3, -6.9, -24.9, -4.3, -15.299999999999997, -81.3, -5.4, -15.9, -9.3, -9.999999999999982, -7.7, -5.2, -14.6, -16.9, -5.2, -9.4, -14.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.894579085461945, "mean_inference_ms": 12.424436892922612, "mean_action_processing_ms": 0.11908277592214864, "mean_env_wait_ms": 30.48013558193788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2024000, "timesteps_this_iter": 0, "agent_timesteps_total": 2024000, "timers": {"sample_time_ms": 14653.229, "sample_throughput": 272.977, "load_time_ms": 0.343, "load_throughput": 11674355.299, "learn_time_ms": 6889.709, "learn_throughput": 580.576, "update_time_ms": 1.622}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06849817788097423, "cur_lr": 0.00010000000000000003, "total_loss": 0.37611081754120307, "policy_loss": -0.008392388837396979, "vf_loss": 38.38988919463209, "vf_explained_var": 0.1466762187019471, "kl": 0.008822562936207659, "entropy": 0.24497545741258128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2024000, "num_agent_steps_sampled": 2024000, "num_steps_trained": 2024000, "num_agent_steps_trained": 2024000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20240, "training_iteration": 506, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-35-23", "timestamp": 1643704523, "time_this_iter_s": 13.809404134750366, "time_total_s": 39182.20705509186, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39182.20705509186, "timesteps_since_restore": 0, "iterations_since_restore": 506, "perf": {"cpu_util_percent": 18.700000000000003, "ram_util_percent": 72.8}}
{"episode_reward_max": -2.4000000000000004, "episode_reward_min": -81.3, "episode_reward_mean": -11.227, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.399999999999997, -5.4, -10.200000000000001, -5.300000000000001, -7.2, -9.2, -12.499999999999998, -5.3, -38.3, -5.9, -10.3, -20.200000000000003, -13.399999999999999, -18.1, -6.3, -7.2, -14.499999999999998, -7.8999999999999995, -9.499999999999998, -5.3, -13.3, -6.3, -6.3, -7.2, -6.5, -4.300000000000001, -7.2, -5.2, -13.2, -8.7, -2.4000000000000004, -27.90000000000004, -15.2, -5.2, -3.2, -11.600000000000001, -12.700000000000001, -14.799999999999999, -7.3, -13.899999999999999, -4.3, -18.099999999999998, -11.699999999999998, -6.3, -6.9, -24.9, -4.3, -15.299999999999997, -81.3, -5.4, -15.9, -9.3, -9.999999999999982, -7.7, -5.2, -14.6, -16.9, -5.2, -9.4, -14.799999999999999, -8.499999999999998, -8.3, -6.199999999999999, -6.3999999999999995, -7.299999999999999, -20.4, -20.3, -7.2, -7.300000000000001, -15.2, -7.399999999999999, -13.5, -12.2, -7.3, -23.6, -7.2, -18.3, -5.3, -13.5, -8.2, -14.399999999999999, -6.699999999999999, -6.3, -14.6, -3.900000000000001, -5.2, -11.8, -6.0, -7.1, -5.9, -14.7, -6.3, -6.4, -10.2, -7.3, -3.6000000000000005, -14.799999999999997, -23.099999999999998, -11.3, -15.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.88663802083601, "mean_inference_ms": 12.402028740179091, "mean_action_processing_ms": 0.11896593346783556, "mean_env_wait_ms": 30.42989244219344, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2028000, "timesteps_this_iter": 0, "agent_timesteps_total": 2028000, "timers": {"sample_time_ms": 14462.982, "sample_throughput": 276.568, "load_time_ms": 0.351, "load_throughput": 11389054.375, "learn_time_ms": 6897.946, "learn_throughput": 579.883, "update_time_ms": 1.642}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06849817788097423, "cur_lr": 0.00010000000000000003, "total_loss": 0.07642977466726655, "policy_loss": -0.007654643080808142, "vf_loss": 8.327681670458086, "vf_explained_var": 0.2124378481859802, "kl": 0.011790145350070507, "entropy": 0.22889851725870564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2028000, "num_agent_steps_sampled": 2028000, "num_steps_trained": 2028000, "num_agent_steps_trained": 2028000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20280, "training_iteration": 507, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-35-38", "timestamp": 1643704538, "time_this_iter_s": 14.360243320465088, "time_total_s": 39196.56729841232, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39196.56729841232, "timesteps_since_restore": 0, "iterations_since_restore": 507, "perf": {"cpu_util_percent": 23.119047619047617, "ram_util_percent": 72.86666666666667}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -81.3, "episode_reward_mean": -11.589999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.3, -18.099999999999998, -11.699999999999998, -6.3, -6.9, -24.9, -4.3, -15.299999999999997, -81.3, -5.4, -15.9, -9.3, -9.999999999999982, -7.7, -5.2, -14.6, -16.9, -5.2, -9.4, -14.799999999999999, -8.499999999999998, -8.3, -6.199999999999999, -6.3999999999999995, -7.299999999999999, -20.4, -20.3, -7.2, -7.300000000000001, -15.2, -7.399999999999999, -13.5, -12.2, -7.3, -23.6, -7.2, -18.3, -5.3, -13.5, -8.2, -14.399999999999999, -6.699999999999999, -6.3, -14.6, -3.900000000000001, -5.2, -11.8, -6.0, -7.1, -5.9, -14.7, -6.3, -6.4, -10.2, -7.3, -3.6000000000000005, -14.799999999999997, -23.099999999999998, -11.3, -15.199999999999996, -11.0, -3.3, -11.399999999999986, -2.7000000000000006, -7.3, -11.600000000000001, -7.399999999999999, -23.1, -23.20000000000001, -10.2, -10.3, -19.700000000000003, -18.500000000000004, -5.2, -17.3, -4.3, -10.3, -26.700000000000017, -5.2, -6.2, -6.2, -10.2, -4.2, -14.7, -13.299999999999972, -3.9000000000000004, -13.799999999999995, -9.7, -10.1, -29.5, -5.3, -15.399999999999999, -5.3, -8.2, -6.300000000000001, -12.199999999999998, -23.800000000000004, -4.3, -10.3, -11.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.878664292393092, "mean_inference_ms": 12.379705311614819, "mean_action_processing_ms": 0.11884929504137005, "mean_env_wait_ms": 30.37982242589209, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2032000, "timesteps_this_iter": 0, "agent_timesteps_total": 2032000, "timers": {"sample_time_ms": 14424.842, "sample_throughput": 277.299, "load_time_ms": 0.365, "load_throughput": 10969085.322, "learn_time_ms": 6770.471, "learn_throughput": 590.801, "update_time_ms": 1.527}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06849817788097423, "cur_lr": 0.00010000000000000003, "total_loss": 0.10411713271832435, "policy_loss": -0.00445734466355975, "vf_loss": 10.745128744327895, "vf_explained_var": 0.3144264463455446, "kl": 0.01639743929683001, "entropy": 0.25353954487269925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2032000, "num_agent_steps_sampled": 2032000, "num_steps_trained": 2032000, "num_agent_steps_trained": 2032000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20320, "training_iteration": 508, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-35-51", "timestamp": 1643704551, "time_this_iter_s": 13.911411046981812, "time_total_s": 39210.478709459305, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39210.478709459305, "timesteps_since_restore": 0, "iterations_since_restore": 508, "perf": {"cpu_util_percent": 24.195, "ram_util_percent": 72.99499999999999}}
{"episode_reward_max": -2.7000000000000006, "episode_reward_min": -35.19999999999999, "episode_reward_mean": -10.819, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.399999999999999, -6.699999999999999, -6.3, -14.6, -3.900000000000001, -5.2, -11.8, -6.0, -7.1, -5.9, -14.7, -6.3, -6.4, -10.2, -7.3, -3.6000000000000005, -14.799999999999997, -23.099999999999998, -11.3, -15.199999999999996, -11.0, -3.3, -11.399999999999986, -2.7000000000000006, -7.3, -11.600000000000001, -7.399999999999999, -23.1, -23.20000000000001, -10.2, -10.3, -19.700000000000003, -18.500000000000004, -5.2, -17.3, -4.3, -10.3, -26.700000000000017, -5.2, -6.2, -6.2, -10.2, -4.2, -14.7, -13.299999999999972, -3.9000000000000004, -13.799999999999995, -9.7, -10.1, -29.5, -5.3, -15.399999999999999, -5.3, -8.2, -6.300000000000001, -12.199999999999998, -23.800000000000004, -4.3, -10.3, -11.5, -14.499999999999998, -4.300000000000001, -13.499999999999986, -7.3, -12.6, -35.19999999999999, -20.700000000000006, -10.2, -6.4, -12.299999999999999, -8.3, -6.2, -5.2, -5.599999999999999, -4.800000000000001, -22.0, -6.2, -24.500000000000007, -9.2, -28.3, -12.999999999999998, -3.6000000000000005, -6.3, -21.4, -6.3, -16.7, -5.3, -4.300000000000001, -4.300000000000001, -6.0, -11.599999999999994, -12.2, -5.799999999999999, -9.2, -8.4, -17.699999999999992, -5.4, -8.8, -4.2, -6.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.870718891308211, "mean_inference_ms": 12.357509407833813, "mean_action_processing_ms": 0.11873491050365793, "mean_env_wait_ms": 30.330216672092785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 4, "timesteps_total": 2036000, "timesteps_this_iter": 0, "agent_timesteps_total": 2036000, "timers": {"sample_time_ms": 14295.069, "sample_throughput": 279.817, "load_time_ms": 0.372, "load_throughput": 10750490.837, "learn_time_ms": 6739.936, "learn_throughput": 593.477, "update_time_ms": 1.527}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.06849817788097423, "cur_lr": 0.00010000000000000003, "total_loss": 0.10955392616170068, "policy_loss": -0.008699987644469866, "vf_loss": 11.775227026849665, "vf_explained_var": 0.2573599779477683, "kl": 0.007323498199516563, "entropy": 0.22361077056616865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 2036000, "num_agent_steps_sampled": 2036000, "num_steps_trained": 2036000, "num_agent_steps_trained": 2036000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20360, "training_iteration": 509, "trial_id": "950d4_00000", "experiment_id": "52237c0be750450f96078cb9b670c7da", "date": "2022-02-01_08-36-06", "timestamp": 1643704566, "time_this_iter_s": 14.211150884628296, "time_total_s": 39224.68986034393, "pid": 50746, "hostname": "Nara.local", "node_ip": "127.0.0.1", "config": {"num_workers": 4, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.agents.ppo.ppo_torch_policy.PPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 39224.68986034393, "timesteps_since_restore": 0, "iterations_since_restore": 509, "perf": {"cpu_util_percent": 23.705000000000002, "ram_util_percent": 73.15500000000002}}
